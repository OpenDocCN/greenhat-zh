# 引言

![无标题图片](img/httpatomoreillycomsourcenostarchimages860138.png.jpg)

由于你现在正在阅读一本关于 Ruby 的书，我认为可以假设你不需要我向你证明 Ruby 语言的优点。相反，我将采取一种多少有些非传统的步骤，从警告开始：许多人被 Ruby 的简单语法和易用性所吸引。他们错了。Ruby 的语法乍一看可能 *看起来* 很简单，但随着你对语言的了解越来越深，你将越来越意识到它实际上是非常复杂的。简单的事实是，Ruby 有许多陷阱等待着粗心大意的程序员跌入。

在本书中，我的目标是引导你安全地越过陷阱，带领你穿越 Ruby 语法和类库的波涛汹涌的水域。在这个过程中，我将探索 Ruby 的平坦、铺好的高速公路和崎岖不平的小路。到旅程结束时，你应该能够安全有效地使用 Ruby，而不会在途中遇到意外的危险。

*《Ruby 编程宝典》* 描述了 Ruby 语言的 1.8.*x* 和 1.9.*x* 版本。在大多数方面，Ruby 1.8 和 1.9 非常相似，为其中一个版本编写的程序在另一个版本中无需修改即可运行。然而，这个规则有一些重要的例外，这些例外在文本中都有说明。Ruby 1.9 可以看作是通往 Ruby 2.0 的一个过渡。在撰写本文时，Ruby 2.0 的发布日期尚未公布。即便如此，基于目前可用的信息，我预计本书中关于 Ruby 1.9 的大部分（或全部）信息也应适用于 Ruby 2.0。

# 什么是 Ruby？

Ruby 是一种跨平台的解释型语言，它具有与其他“脚本”语言（如 Perl 和 Python）许多共同特征。它的语法易于阅读，乍一看有点像 Pascal 语言。它是彻底面向对象的，并且与“纯”面向对象语言的鼻祖 Smalltalk 有很多共同之处。据说，对 Ruby 的发展影响最大的语言是 Perl、Smalltalk、Eiffel、Ada 和 Lisp。Ruby 语言是由 Yukihiro Matsumoto（通常被称为 Matz）创建的，并于 1995 年首次发布。

# 什么是 Rails？

在过去几年中，围绕 Ruby 的许多兴奋之处可以归因于一个名为 Rails 的 Web 开发框架——通常被称为 *Ruby on Rails*。Rails 是一个令人印象深刻的框架，但它并不是 Ruby 的全部。实际上，如果你在没有首先掌握 Ruby 的情况下直接跳入 Rails 开发，你可能会发现你最终创建的应用程序连你自己都不理解。（这在 Ruby on Rails 新手中非常普遍。）理解 Ruby 是理解 Rails 的必要前提。你将在第十九章（ch19.html "第十九章。Ruby on Rails"）中了解 Rails。

# Ruby 风格问题

一些 Ruby 程序员对“Ruby 风格”编程的构成有着非常固定——甚至可以说是强迫性的——看法。例如，有些人热情地坚持认为`method_names_use_underscores`而`variableNamesDoNot`。将单词分开表示的命名风格被称为*驼峰式*——而且这是这本书中最后一次提到这一点。

我从未理解为什么人们对命名约定如此激动。你喜欢下划线，我无法忍受；你说 po_ta_toes，我说 poTaToes。在我看来，你选择在 Ruby 中编写标识符名称的方式对任何人都没有兴趣，除了你或你的编程同事。

这并不是说我对编程风格没有看法。相反，我有着非常强烈的看法。在我看来，良好的编程风格与命名约定无关，而与良好的代码结构和清晰度有关。例如，括号这样的语言元素很重要。括号可以澄清代码，避免在像 Ruby 这样的高度动态语言中可能意味着程序按预期工作或充满惊喜（也称为*错误*）的歧义。关于这一点，请参阅“歧义”和“括号”的索引条目。

在超过二十年的编程生涯中，我通过痛苦的教训学到的一点是，编写良好代码最重要的特性是清晰性和缺乏歧义。易于理解和调试的代码也更有可能易于*维护*。如果你通过采用某些命名约定来实现这一目标，那很好。如果你做不到，那也很好。“Ruby 圣经”并不宣扬风格问题。

# 如何阅读这本书

本书分为小块。每一章介绍一个主题，该主题被细分为子主题。每个编程主题都伴随着一个或多个小型、自包含、可立即运行的 Ruby 程序。

如果你想要遵循一个结构良好的“课程”，请按顺序阅读每一章。如果你更喜欢更实用的方法，可以先运行程序，并在需要解释时参考文本。如果你已经有一些 Ruby 经验，你可以自由地按任何你认为有用的顺序挑选主题。这本书中没有庞大的应用程序，所以你不必担心如果你不按顺序阅读章节可能会迷失方向！

# 深入挖掘

除了第一章之外，本书每一章都包含一个名为深入挖掘的部分。这是您将更深入地探索 Ruby 特定方面（包括我刚才提到的一些复杂路径）的地方。在许多情况下，您可以跳过“深入挖掘”部分，仍然可以学习到您需要的所有 Ruby 知识。另一方面，您通常在这些部分中会接近 Ruby 的内部工作原理，所以如果您跳过它们，您可能会错过一些相当有趣的内容。

# 理解文本

在《Ruby 编程秘籍》中，Ruby 源代码的编写方式如下：

```
def saysomething
    puts( "Hello" )
end
```

通常代码会带有*注释*。Ruby 注释是单行中跟随井号(`#`)的任何文本。注释会被 Ruby 解释器忽略。当我想要引起对 Ruby 显示的某些输出或代码返回的某个值（即使该值没有显示）的注意时，我会用这种类型的注释来表示：`# =>`。偶尔，当我想引起对用户应输入的某些输入的注意时，我会使用这种类型的注释：`# <=`。以下是一个示例，以说明这些注释约定：

```
puts("Enter a calculation:" ) # Prompt user        this is a simple comment
exp = gets().chomp()          # <= Enter 2*4    comment shows data to enter
puts( eval( exp ))            # => 8     comment shows result of evaluation
```

当一段代码返回或显示的数据太多，无法在单行注释中显示时，输出可能如下所示：

```
This is the data returned from method #1
This is the data returned from method #2
This is the data returned from method #3
```

*helloname.rb*

当一个示例程序伴随代码时，程序名称在此处以边注形式显示。

提供提示或额外信息的说明性注释如下所示：

### 注意

这是一个说明性注释。

对文本中提到的点的更深入解释可能如下所示：

进一步解释

这是一些额外的信息。如果您愿意，可以跳过它——但是如果您这样做，可能会错过一些有趣的内容！

# 下载 Ruby

您可以在[`www.ruby-lang.org/en/downloads/`](http://www.ruby-lang.org/en/downloads/)下载最新的 Ruby 版本。请确保下载二进制文件（而不仅仅是源代码）。Windows 用户可以选择使用 Ruby Installer 安装 Ruby，该安装器可在[`www.rubyinstaller.org/`](http://www.rubyinstaller.org/)找到。Ruby 还有几种替代实现，其中最著名的是 JRuby。您可以在附录 D 中找到有关下载这些实现的信息。

# 获取示例程序的源代码

本书每一章的所有程序都可以作为*.zip*存档在[`www.nostarch.com/boruby.htm`](http://www.nostarch.com/boruby.htm)下载。

当您解压程序时，您会发现它们被分组到一个目录集中——每个章节一个目录。

# 运行 Ruby 程序

在包含你的 Ruby 程序文件的源目录中保持一个命令窗口通常是很有用的。假设 Ruby 解释器在你的系统上正确配置了路径，那么你将能够通过输入`ruby` *`程序名`*来运行程序。例如，运行*helloworld.rb*程序的命令如下：

```
ruby helloworld.rb
```

如果你使用 Ruby IDE，你可能能够将 Ruby 程序加载到 IDE 中，并使用该 IDE 的集成工具运行它们。

# Ruby 库文档

《Ruby 编程宝典》涵盖了标准 Ruby 库中的许多类和方法——但绝不是全部！因此，在某个阶段，你将需要参考 Ruby 所使用的所有类的完整文档。幸运的是，Ruby 类库包含了嵌入的文档，这些文档已经被提取并编译成易于浏览的参考，并且以多种格式提供。例如，你可以找到 Ruby 1.9 的在线文档，网址为[`www.ruby-doc.org/ruby-1.9/index.html`](http://www.ruby-doc.org/ruby-1.9/index.html)。对于 Ruby 1.8，请访问[`www.ruby-doc.org/ruby-1.8/index.html`](http://www.ruby-doc.org/ruby-1.8/index.html)。

好的，前言就到这里——让我们开始工作吧。
