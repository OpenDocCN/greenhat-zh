# 附录 B. 为 Ruby on Rails 安装 MySQL

![无标题图片](img/httpatomoreillycomsourcenostarchimages860138.png.jpg)

如果你正在使用 Rails，你需要安装一个数据库。尽管有许多选择可供你选择，但最广泛使用的是 MySQL。如果你以前从未使用过 MySQL，你可能会发现一些设置选项令人困惑。在这里，我将尝试引导你通过这个过程，以避免潜在的问题。MySQL 主网站是[`www.mysql.com/`](http://www.mysql.com/)，你可以导航到各种版本的下载页面。

### 注意

本附录基于在 Windows 下安装 MySQL 5.0。在其他操作系统上安装其他版本时可能会有所不同。请参考 MySQL 网站以获取更多指导。

# 下载 MySQL

我将假设你将使用 MySQL 的免费版。这可以从[`dev.mysql.com/downloads/`](http://dev.mysql.com/downloads/)下载。在撰写本文时，当前版本是 MySQL 5 Community Server。名称和版本号当然会随时间而变化。下载当前（不是即将发布的、alpha 或 beta）版本。选择为你操作系统推荐的特定版本（例如，Win32 和 Win64 可能有不同的版本）。

你需要找到适合你操作系统的安装程序。对于 Windows，你可以下载完整的 MySQL 包，或者如果可用，较小的 Windows Essentials 包。完整的包包含数据库开发人员的一些额外工具，但这些对于简单的 Rails 开发不是必需的。因此，对于大多数人来说，较小的 Windows Essentials 下载文件是首选。你可能需要选择镜像站点，也可能会有一个问卷调查，如果你想填写的话。

# 安装 MySQL

下载完成后，通过选择下载对话框中的**打开**或**运行**（如果此对话框仍然可见）或通过例如 Windows 资源管理器双击安装文件来运行程序。

### 注意

在安装 MySQL 期间，可能会出现一些广告屏幕。点击按钮以浏览屏幕。一些安全警告也可能提示你验证安装软件的意图。当提示时，你应该点击必要的选项以继续安装。

设置向导的第一页现在将出现。点击**下一步**按钮。如果你愿意将软件安装到默认的 MySQL 目录中——在 Windows 上是在 *C:\Program Files\* 之下，你可以选择典型设置选项。但是，如果你想安装到其他目录，请选择**自定义**。然后点击**下一步**。点击**更改**以更改目录。

当你准备好继续时，点击**下一步**。

你将看到显示“准备安装程序”的屏幕。请确认目标文件夹是否正确，然后点击**安装**按钮。

根据 MySQL 的版本，你现在可能会看到一些促销屏幕，或者可能会提示你创建一个新的 MySQL 账户，这将让你能够接收有关更改和更新的消息。这些不是软件安装的必要部分，你可以点击“下一步”或“跳过”按钮继续安装过程。

现在会显示**向导完成**对话框。

点击**完成**按钮。

# 配置 MySQL

事实上，这并不是安装的结束。在一些安装程序中，会出现一个新窗口，欢迎你进入 MySQL 服务器实例配置向导。如果这种情况没有发生，你需要自己加载它。在 Windows 上，点击**开始**菜单，然后通过你的程序组导航到**MySQL ▸ MySQL 服务器 5.0**（或你正在使用的任何版本号）▸ **MySQL 服务器实例配置向导**。点击**下一步**。

假设这是你第一次在这台机器上安装 MySQL，你可以选择**标准配置**（如果你是从较旧版本的 MySQL 升级，你需要选择详细配置，但这超出了本简单设置指南的范围）。点击**下一步**。在下一个对话框中，保留默认选项（即作为 Windows 服务安装，服务名称为“MySQL”，并自动启动 MySQL 服务器）。然后点击**下一步**。

在下一屏，保留修改安全设置复选框选中，并将你选择的相同密码输入到前两个文本框中。你稍后需要这个密码，所以请记住它或将其写在安全的地方。如果你需要从另一台计算机访问 MySQL，可以勾选“启用从远程机器的 root 访问。”然后点击**下一步**。

### 注意

默认的 MySQL 用户名是“root”。密码是你刚刚输入的那个。你稍后创建 Rails 应用程序时需要这两项信息。

下一屏只是提供了即将执行的任务的一些信息。点击**执行**按钮。

如果你之前已安装或配置过 MySQL，你可能会看到一个错误消息，告诉你跳过安装。你可以点击**重试**以查看是否可以绕过此问题。如果不能，点击**跳过**，然后重新启动 MySQL 配置过程，当提示时选择重新配置实例和标准实例。

当一切安装完成后，点击**完成**。

就这样！

# 找不到数据库？

当使用 Rails 与 MySQL 一起使用时，即使 MySQL 安装成功，当你尝试运行应用程序时，Rails 也可能会显示类似于以下错误消息：

```
no such file to load -- mysql
```

一些版本的 Rails（Rails 2.2 及更高版本）要求将 MySQL 晶石（gem）作为单独的操作安装。为此，请在系统提示符下输入以下内容：

```
gem install mysql
```

在 Windows 上还可能出现另一个问题。当你运行应用程序时，你可能会看到类似于以下错误消息：

```
The specified module could not be found.
c:/ruby/lib/ruby/gems/1.8/gems/mysql-2.7.3-x86-mswin32/ext/mysql.so
```

如果遇到这个问题，你应该能够通过从 MySQL 二进制目录（例如，*C:\Program Files\MySQL\MySQL Server 5.0\bin*）复制一个名为 *libmySQL.dll* 的文件到 Ruby 二进制目录（例如，*C:\ruby\bin*）来修复它。重启你的应用程序（关闭并重新启动服务器），然后再次尝试运行它。
