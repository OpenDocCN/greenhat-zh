**引言**

![](img/as.jpg)

烤面包机、烤箱和洗碗机是我们日常生活中常见的设备。尽管我们对它们的使用非常熟悉，但很少有人停下来思考这些设备内部是如何工作的，甚至是什么让设备成为设备。这本书将*设备*定义为主要执行单一功能的设备。如果你考虑一下刚才提到的设备，你会发现这个定义是正确的——烤面包机烤面包，烤箱烘焙，洗碗机洗碗。与能够根据安装的硬件和软件执行数千种不同功能的 PC 相比，传统设备显得无聊且简单。

这与 Linux 有什么关系？首先，传统的设备不再那么简单。曾经只是电动但仍然机械的设备，如吸尘器，现在不仅电子化，还包括处理器、电路板和复杂的用户界面。随着这些变化，需要在设备上运行操作系统来管理新特性。Linux 是这一领域的自然选择，因为它成本低（在大多数情况下，它是免费的）且开源（这意味着你可以修改它以更好地满足你的需求）。然而，Linux 真正适合的地方是随着新类型设备的出现。数字视频录像机（DVR）几年前还闻所未闻，但第一个也是最流行的 DVR 设备，TiVo，运行在 Linux 上，许多其他家庭网络和娱乐设备也是如此。

如果你要构建下一个伟大的家用清洁机器人系统，你将希望避免从头开始设计它。你会尽可能多地重用你早期机器人中的部件，并在可能的情况下使用现成的组件。同样的*重用*理念也适用于 Linux 设备，这正是这本书能帮到你的地方。

**本书涉及的内容**

这本书展示了如何构建一个 Linux 设备，并包括一个原型设备，你可以将其作为你设备的起点，如果你愿意的话。我们将设备分为守护进程和用户界面，并展示了如何创建和管理守护进程，以及如何构建五种不同类型的用户界面。

我们涵盖了以下主题：

• 设备架构

• 如何与运行中的守护进程通信

• 如何构建和保障守护进程

• Laddie，我们的示例设备

• 记录和事件处理

• 基于 Web 的用户界面

• 命令行界面（CLIs）

• 前面板接口

• 帧缓冲接口，包括红外遥控

• SNMP 接口，包括工具、MIBs 和代理

大多数章节都有相同的基本布局。我们定义并解释为什么这个特性是必要的，我们描述了特性的挑战和常见方法，以及我们如何在我们的示例设备中实现这个特性。

**本书不涉及的内容**

本书不涵盖 C 编程、Linux 操作系统或定义特定 Linux 设备的主要应用程序。此外，本书也不是关于嵌入式 Linux 的。我们相信您会发现以下关于嵌入式 Linux 的书籍很有用：

• 《嵌入式 Linux》，作者 John Lombardo（SAMS/New Riders，2001 年）

• 《嵌入式 Linux：硬件、软件和接口》，作者 Craig Hollabaugh（Addison-Wesley，2002 年）

• 《嵌入式和实时应用的 Linux，第二版》，作者 Doug Abbott（Newnes，2006 年）

• 《嵌入式 Linux 系统设计与开发》，作者 P. Raghavan、Amol Lad 和 Sriram Neelakandan（Auerbach Publications，2005 年）

**谁应该阅读这本书**

这本书是为想要构建定制 Linux 设备并支持多个用户界面、构建安全的守护进程、提供日志和事件管理的 Linux 程序员而写的。这本书也可能对任何希望将守护进程的用户界面移植到不同的操作系统或不同的编程语言的开发者有所帮助。我们唯一的重大假设是，读者在 Linux 平台上对 C 语言编程感到舒适。

**为什么使用 Linux？**

在深入探讨大多数 Linux 设备上常见的架构之前，我们应该回答一个问题，“为什么要在设备上使用 Linux？”虽然具体的论点各不相同，但我们发现以下观点适用于我们构建的设备。

**源代码的可用性**

源代码的可用性使得根据特定设备的需要定制操作系统成为可能。当使用专有、封闭源代码的操作系统时，这种定制是不可能的。

**支持的硬件范围**

Linux 内核支持广泛的处理器，从用于消费电子的低端嵌入式处理器到用于超级计算机的高端 64 位处理器。例如，Linux 运行在 Marvell 的基于 ARM 的 XScale 处理器（用于 Palm 手持电脑）、德州仪器的基于 ARM 的 OMAP 处理器（用于 E28 智能手机）、IBM 的 PowerPC（用于 TiVo 和 PlayStation 3）、日立的 H8/300 处理器，以及 Compaq Alpha AXP、Sun SPARC、IBM S/390、MIPS、HP PA-RISC、Intel IA-64 和 AMD *x*86-64 处理器。

**Linux 开发者的可用性**

Linux、C 和 C++是美国许多计算机科学毕业生的核心能力，实际上，在全球范围内也是如此。确切的估计各不相同，但共识是，全球有数百万名具备 Linux 能力的开发者。

**可靠性**

Linux 的可靠性足够高，以至于在数据中心得到广泛应用。Linux 的运行时间以年为单位，并不罕见，而且蓝屏死机从未成为问题。

**高质量的编译器**

GNU 编译器集合是一套综合的编译器、汇编器、链接器和调试器，支持在多个平台上使用多种语言。它是 Linux 上 C 和 C++ 开发的首选编译器。此外，它是免费的。更多信息请访问 http://gcc.gnu.org。

***良好的文档***

在互联网上可以找到大量关于 Linux 的文档。Linux 文档项目（见 http://en.tldp.org）是一个很好的文档起点。该网站包括特定主题的 HOWTO、FAQ 和深入指南。

***现有的软件包***

有数千个软件包可供帮助您在 Linux 上开发设备。例如，有 Net-SNMP 用于简单网络管理协议（SNMP）支持，lm_sensors 用于监控设备硬件环境，以及 lighttpd 用于 Web 支持。

***低开发成本***

Linux 设备程序员通常可以使用他们的桌面机器进行大部分软件开发，因为设备用户界面和服务很少需要在目标硬件上开发。因此，软件开发可以并行进行，一个团队为设备开发嵌入式 Linux，另一个团队开发主要应用程序和用户界面。

***部署无需许可费用***

设备制造商通常可以构建基于 Linux 的设备，而无需支付分发设备软件的许可费用，尽管有一些例外。例如，Trolltech 的 Qt 库和 MySQL 数据库的许可证可能需要支付商业使用费。

***安全***

Linux 设备开发者使用如 grsecurity 和 systrace 等软件包来加强安全性，达到 Windows 开发者难以想象的水平。设备还有额外的优势，即多用途的桌面或服务器永远无法像经过良好加固的单用途设备那样安全。

**Linux 设备设计**

我们试图编写这本书和配套的光盘，以便用作一种“零件箱”，您可以在组装设备时从中取用。第一章提供了我们零件箱中组件的精彩概述，它展示了大多数 Linux 设备共有的架构的高级视图。
