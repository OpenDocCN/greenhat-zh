# 附录 A. Ruby 与其他语言如何比较？

描述某物的最佳方式之一就是谈论它不是什么。本附录描述了 Ruby 与其他一些流行语言之间的相似之处和不同之处。

# C

尽管它不是最古老的语言，但在许多程序员的脑海中，*C*是语言的鼻祖。为了讨论的目的，我们将更多地关注 Ruby 和 C 之间的差异，而不是相似之处。C 是*过程式*的，这意味着其程序被设想为一系列按时间顺序逐步执行的指令：*这样做，然后这样做，然后那样做*。C 既不是面向对象的，也不是函数式的，尽管与之密切相关的语言 C++和 Objective C 是面向对象的。C 无疑有*函数*，这些是可重用的代码片段，接受各种输入并返回各种输出，但它们通常不是*纯函数式*的。C 函数通常依赖于除了函数严格输入之外的其他信息，并且它们有副作用，这意味着对给定函数的第二次调用不一定会产生与第一次调用相同的结果。C 函数通常返回表示其成功的值，依靠副作用来完成其主要目的。

C 语言相较于 Ruby 的优势包括执行速度更快、更被更多人熟悉、更广泛的部署，以及其代码编译而非解释带来的额外好处。（注意，编译与解释之争是其自身的圣战。）当一个 C 程序编译时，你知道它至少通过了可靠性方面的一个特定基准。

Ruby 相较于 C 的优势包括更快的开发周期、灵活性、概念上的优雅性和可配置性。如果你对结合 Ruby 和 C 的优势感兴趣，可以从探索 RubyInline 项目开始，该项目作为`rubyinline`gem 提供，或通过[`www.zenspider.com/ZSS/Products/RubyInline`](http://www.zenspider.com/ZSS/Products/RubyInline)获取.^([38])

C 还有所谓的*强静态类型*。这意味着 C 中的变量被定义为某种数据类型（例如整数 42），并且它们将始终保持这种类型。这就是静态部分。如果你想要将整数 42 表示为浮点数，例如 42.0，你需要通过类型转换函数来传递它。Ruby 也是强类型（要求程序员在使用之前将整数转换为浮点数），尽管它是*动态的*，这意味着变量可以改变类型。C 缺乏类似 Ruby 的 irb。

* * *

^([38]) 我很幸运在 2005 年的 RubyConf 上看到了 RubyInline 的作者 Ryan Davis 的演示。这是一段非常令人印象深刻的代码，我强烈推荐给任何对结合 Ruby 和 C 感兴趣的人。

# Haskell

Haskell 被列入这些语言列表中，表明函数范式对这本书来说是多么重要。*Haskell* 是一个由委员会设计并于 1998 年发布的纯函数语言。它有几个迷人的特性，最值得注意的是 *惰性求值*，这意味着给定数据的值不需要在需要使用之前（甚至有意义）就知道。这允许程序员用无限序列来定义事物，例如所有整数的集合。

Haskell 是用于 *Pugs* 的语言，它是新 Perl 6 语言的实现，有些人认为这比 Perl 本身更能吸引人们对 Haskell 的注意。Haskell 有一个类似于 Ruby 的 irb 的交互式环境，但它不允许在导入的外部文件中定义函数，而 irb 允许对类、方法和函数进行完整定义。像 C 语言一样，Haskell 既有强类型也有静态类型。Haskell 是一种非常适合教授纯函数技术的优秀语言，也适合通用编程。你可以在 [`haskell.org`](http://haskell.org) 上了解更多关于它的信息。

# Java

为了这次讨论的目的，Sun Microsystems 的 *Java* 是一种中等复杂性的面向对象语言，类似于 C 语言。Java 既有强类型也有静态类型。在某种程度上，Java 比 Ruby 更面向对象：在 Java 中编码的程序员必须为自己的程序使用面向对象范式。另一方面，Java 在实现其内置功能方面比 Ruby 更少面向对象。例如，要在 Java 中获取整数 100 的绝对值，你会这样做：

```
Math.abs(100)
```

这意味着程序员想要使用一个与 Math 相关的名为 `abs` 的方法，对整数 100 执行该方法的功能。在 Ruby 中，等效的操作如下所示：

```
100.abs
```

使用 Ruby 的方法，程序员只需让数字 100 报告其自身的绝对值。这种方法在 Ruby 中很常见，它假设每份数据都知道如何最好地处理对其自身的操作。这种方法的优点是，相同的符号可以用于不同的（但概念上相关的）操作。例如，`+` 符号表示数字的简单加法，而对于字符串，则表示连接，如第一章所述（Chapter 1）。

Java 通常也是编译的，而不是解释的，一般使用一种称为 *字节码* 的特殊编译类型，这与 Parrot、Python 和 Ruby 2.0 等项目使用的方法相同.^([39]) 还有一个有趣的项目叫做 JRuby ([`jruby.codehaus.org`](http://jruby.codehaus.org))，这是一个用 Java 编写的 Ruby 实现。Java 的详细信息可以在 [`java.sun.com`](http://java.sun.com) 上找到。Java 规范是由 Guy Steele 编写的，尽管他没有创建这种语言本身（Lisp 同行 James Gosling 创建了它）。当他编写 Java 规范时，Steele 已经是 Scheme 的共同创造者，而 Scheme 被认为是 Lisp 最概念上纯粹的版本。

* * *

^([39]) 你可以在 [`www.parrotcode.org`](http://www.parrotcode.org) 上了解更多关于 Parrot 的信息；我将在附录的后面部分介绍 Python。

# Lisp

作为 Ruby 最显赫的祖先之一，*Lisp* 在本节中应占有一席之地。Lisp 被称为“最聪明的滥用计算机的方式。”^([40]) 它应该被正确理解为一系列语言或语言规范，而不是单一的语言。它也足够多样化，足以抵抗许多分类尝试，但就我们的目的而言，Lisp 可以主要被视为具有弱、动态类型的函数式语言。著名的 Lisp 程序员 Paul Graham 在 [`paulgraham.com/diff.html`](http://paulgraham.com/diff.html) 描述了“Lisp 的不同之处”，值得注意的是，Ruby 与 Lisp 共享所有这些特性，除了 Lisp 的独特语法。

Lisp 的语法（或者说是其缺乏语法）可能是它最引人注目的特征，乍一看。Lisp 代码由被括号包围的数据块组成。这些数据块被称为 *列表*，它们赋予了 Lisp 这个名字（这个名字来源于 *LISt Processing*).^([41]) 语法能够以语言内部的数据结构表示，这是 Lisp 最具定义性的特征。可以说，如果另一种语言实现了这一相同功能，那么它本身可能不是一个独特的语言，而仅仅是 Lisp 的另一种方言.^([42]) 可以提出一个很好的论点，Ruby 尝试从 Lisp 中汲取概念，并在一个更用户友好的框架中呈现它们，同时利用面向对象的好想法以及良好的文本处理。Matz 说：“有些人可能会说 Ruby 是 Lisp 或 Smalltalk 的拙劣模仿，我承认这一点。但 Ruby 对普通人来说更友好。”^([43]) Ruby 在很大程度上得益于 Lisp，以及许多其他语言，它强大的文本处理能力很大程度上归功于接下来的这种语言，Perl。

* * *

^([40]) 荷兰计算机科学 Edsger Dijkstra 说的是这句话；你可以在 Paul Graham 编译的这些以及其他有趣的引语中找到 [`www.paulgraham.com/quo.html`](http://www.paulgraham.com/quo.html)。

^([41]) 批评者认为这个特性使得 Lisp 成为了 *Lots of Irritating Superfluous Parentheses* 的更合适的缩写。Perl 的创造者 Larry Wall 建议 Lisp 代码的美学吸引力就像“燕麦粥里夹杂着指甲剪屑”。显然，Lisp 在公共关系方面存在一些问题。

^([42]) 相关联，Philip Greenspun 在 [`philip.greenspun.com/`](http://philip.greenspun.com/) 的第十条编程规则是：“任何足够复杂的 C 或 Fortran 程序都包含了一个临时、非正式指定的、充满错误且运行缓慢的半 Common Lisp 实现。”

^([43]) 这句话也来自 Paul Graham 的网站，[`www.paulgraham.com/quotes.html`](http://www.paulgraham.com/quotes.html)。

# Perl

*Perl* 以其口号 TMTOWTDI 而闻名，这是一种极其灵活且实用的语言——它无疑对 Ruby 和编程，总体上产生了影响。*TMTOWTDI* 代表 *There’s More Than One Way To Do It*，这是一种设计哲学，Perl 确实体现了这一点。它在强调正则表达式的重要性方面的作用足以让它获得历史地位。Perl 由 Larry Wall 于 1987 年发明，其主要目的是执行类似于 shell、awk 和 sed 等以 Unix 为中心的语言的职能。Perl 专注于 Unix 系统管理这类任务的易用性，并且在网络应用中也得到了广泛的使用。Perl 的初始设计是过程式的，但近年来它越来越多地朝着函数式方向发展。它也可以用于面向对象编程，这并不是它原本的设计目的，也不是它最理想的应用场景——但即便在 Perl 中这种可能性都存在，这也证明了其灵活性。

Perl 正在开发新版本（参见 Haskell 下的 Pugs 讨论），这让我想起了 Ruby。对我来说，这算是一种赞扬。Perl 具有弱动态类型，和 Ruby 一样，它是解释型的。它被称为 *瑞士军刀链锯* 和编程语言的 *吉普车*，可以在 [`perl.com`](http://perl.com) 找到。

# PHP

*PHP* 是另一种流行的解释型语言，它使用弱动态类型，非常适合网络应用。事实上，有些人错误地认为 PHP 只能用于网络应用。从技术上讲，它是一个完整、通用的编程语言，尽管它有几个特性使其在网页开发中更为流行。这里讨论的许多语言都可以在网页内嵌入代码，只要代码用适当的标签与页面其他部分区分开来。PHP 的不同之处在于，即使它用于命令行任务，这些任务永远不会接近 web 服务器，它也必须用这样的标签来界定。它具有弱动态类型和解释性。

PHP 和 Ruby 都具有相对较多的内置函数这一特点。尽管 PHP 具有广泛的适用性，但其主要焦点无疑是让相对缺乏经验的程序员能够快速生成动态网页内容。PHP 的网络集成是其最频繁使用（如果不是其设计）的一个重要部分，因此当与它们自己的网络集成系统（如 Perl 和 Mason，或 Ruby 和 eRuby 或 Rails）结合使用时，通常最好将其与其他编程语言进行比较。PHP 的创造者拉斯马斯·勒德夫（Rasmus Lerdorf）于 1995 年开始着手开发最终成为 PHP 的项目。你可以在 [`php.net`](http://php.net) 上了解更多信息。

# Python

*Python* 是一种与 Ruby 非常相似的语言。其创造者，“终身仁慈独裁者”吉多·范罗苏姆（Guido van Rossum）在 1990 年代初发明它时，以英国喜剧团体蒙提·派森（Monty Python）的名字命名。它具有与 Ruby 非常相似的强大动态类型和类似的简洁语法，这得益于其使用具有语义意义的空白。在 Python 中，函数、代码块或语句不需要有显式的行尾标记（通常是分号）。Ruby 使用结束标记的方式也相当少，尽管不如 Python 的程度。

Python 和 Ruby 在一个领域中的差异非常显著，那就是灵活性。Python 明确拥抱了“应该只有一个——最好是只有一个——明显的方法来做这件事”的想法，当输入命令 `import this` 时，Python 的交互式提示符会报告这一想法以及其他想法。

Python 和 Ruby 之间有一种有趣的关系。Python 最近添加了几个新功能，这些功能大量借鉴了 Ruby 和 Lisp 的思想，并且在此写作时，与 Ruby 相关的书籍销量也普遍超过与 Python 相关的书籍销量。显然，我希望能继续看到与 *这本书* 相关的趋势。Python 和 Ruby 好像是一对有争议的兄弟姐妹，希望他们能继续相互挑战和激励，取得卓越的成就。Python 主义者居住在 [`python.org`](http://python.org)。

# Smalltalk

*Smalltalk* 是一种由艾伦·凯（Alan Kay）领导的团队在施乐帕克研究中心（Xerox PARC）发明的完全面向对象的编程语言。虽然 Simula 通常被认为是第一种面向对象的编程语言，但 Smalltalk 在推广面向对象方面发挥了重要作用。Ruby 在两个主要领域大量借鉴了 Smalltalk：一切皆对象的概念，以及方法作为传递给对象的信使的概念。

说什么“一切都是对象”是什么意思？我们在 Java 讨论中简要地提到了这一点。在许多语言中，真正的“对象”状态是为更大或更复杂的事物保留的，而语言的基本部分不被视为对象。这就是为什么在 Java 中，编码者必须从 Math 命名空间内部调用`abs`方法来获取整数 100 的绝对值。Ruby 从 Smalltalk 继承的“一切都是对象”的理念，使得询问整数 100 报告其自己的绝对值的方法更加一致。我们还在第十章的`to_lang.rb`脚本中探讨了将方法实现为消息的好处。第十章。

查看 Smalltalk 的更多信息，请访问[`smalltalk.org`](http://smalltalk.org)和[`squeak.org`](http://squeak.org)。

# Ruby 与其他语言的比较总结

总结来说，Ruby 是解释型语言，而不是编译型语言，这使得它在开发时快速，但在运行时较慢。它是面向对象和函数式的，而不是过程式的。它具有强大的动态类型，而不是弱类型或静态类型，并且它只为布尔测试自动转换类型。它内置了正则表达式支持，并且语法清晰易读。在理论和实践中，它都是一种通用编程语言。它拥有大量的内置方法，并且允许你轻松地添加、修改和扩展这些方法。像其祖先 Lisp 一样，Ruby 有一个真实且可用的`nil`值，并且它将除了`nil`和`false`之外的所有值视为`true`。Ruby 编程也非常有趣，并且不会妨碍你。
