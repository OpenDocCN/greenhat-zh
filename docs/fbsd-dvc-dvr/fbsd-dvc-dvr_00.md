# 简介

![无标题图片](img/httpatomoreillycomsourcenostarchimages1137497.png.jpg)

欢迎来到《*FreeBSD 设备驱动程序*》！本书的目标是帮助您提高对 FreeBSD 下设备驱动程序的理解。完成本书后，您应该能够构建、配置和管理自己的 FreeBSD 设备驱动程序。

本书涵盖 FreeBSD 版本 8，这是截至本书撰写时推荐的用于生产使用的版本。尽管如此，您将学到的大部分内容也将适用于早期版本，并且应该适用于后续版本。

# 这本书是为谁写的？

我作为程序员为程序员写了这本书。因此，您会发现本书对编程的重视程度很高，而不是理论，您将检查真实的设备驱动程序（即控制硬件的驱动程序）。想象一下，如果不曾读过任何一本书就尝试写一本书。这是不可想象的！对于设备驱动程序来说，也是如此。

# 预备知识

为了充分利用本书，您应该熟悉 C 编程语言。您还应该了解一些操作系统设计方面的知识；例如，进程和线程之间的区别。

如果您缺乏必要的背景知识，我建议在阅读这本书之前先阅读以下三本书，或者只是将它们作为参考资料保留：

+   《*C 程序设计语言*》，作者：Brian W. Kernighan 和 Dennis M. Ritchie（Prentice Hall PTR，1988 年）

+   《*专家 C 编程*》，作者：Peter van der Linden（Prentice Hall，1994 年）

+   《*FreeBSD 操作系统的设计和实现*》，作者：Marshall Kirk McKusick 和 George V. Neville-Neil（Addison-Wesley Professional，2005 年）

# 概述内容

《*FreeBSD 设备驱动程序*》包含以下章节。

第一章

提供了基本设备驱动程序编程概念和术语的概述和介绍。

第二章

描述了 FreeBSD 内核内存管理例程。

第三章

教您如何从用户空间与设备驱动程序进行通信和控制。

第四章

讨论了与多线程编程和并发执行相关的问题和解决方案。

第五章

描述了延迟代码执行和异步代码执行，并解释了为什么这些任务是必要的。

第六章

包含了几个场合中的第一个，我在这些场合中会向您介绍一个真实的设备驱动程序。

第七章

介绍了 FreeBSD 用于管理系统硬件设备的底层基础设施。从现在开始，我将专门处理真实硬件。

第八章

讨论了 FreeBSD 中的中断处理。

第九章

完整地介绍了`lpt(4)`，并行端口打印机驱动程序。

第十章

涵盖了端口映射 I/O 和内存映射 I/O。

第十一章

审查了`ipmi(4)`，智能平台管理接口驱动程序的部分，它使用端口映射 I/O 和内存映射 I/O。

第十二章

解释了如何在 FreeBSD 中使用直接内存访问（DMA）。

第十三章

教您如何管理存储设备，例如硬盘驱动器、闪存等。

第十四章

提供了关于常见访问方法（CAM）的概述和介绍，您将使用它来管理主机总线适配器。

第十五章

教您如何管理 USB 设备。还完整地介绍了`ulpt(4)`，USB 打印机驱动程序。

第十六章

描述了网络驱动程序使用的数据结构。还介绍了消息信号中断（MSI）。

第十七章

分析了`em(4)`，英特尔 PCI 千兆以太网适配器驱动程序的包接收和传输组件。

# 欢迎加入！

希望您觉得这本书有用且有趣。一如既往，我欢迎您通过评论或错误修复提供反馈，发送至 joe@thestackframe.org。

好的，介绍性的内容就到这里。让我们开始吧。
