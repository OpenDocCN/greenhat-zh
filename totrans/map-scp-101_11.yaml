- en: Appendix A. JAVASCRIPT QUICK START
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '![image with no caption](httpatomoreillycomsourcenostarchimages671943.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: All the mapping APIs covered in this book are based on JavaScript. To use them,
    you need to program JavaScript from your web page to interact with the maps. However,
    as you'll see in this appendix, it's a programming language that is easy to learn.
  prefs: []
  type: TYPE_NORMAL
- en: I'll cover a very basic approach to JavaScript—enough not to be confused by
    the examples elsewhere in the book. If you're looking to learn the complete ins
    and outs, pick up *The Book of JavaScript* (thau!, No Starch Press, 2000).
  prefs: []
  type: TYPE_NORMAL
- en: Where JavaScript Goes
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: JavaScript is added to HTML pages via the `<script>` tag. Sometimes code is
    placed between this tag and its closing tag. Other times, the tag calls to an
    external file from the attributes. I'll show both versions in this section.
  prefs: []
  type: TYPE_NORMAL
- en: Technically, you can put your `<script>` tag anywhere within an HTML document.
    For analytics services the bottom of a page may be optimal. JavaScript for widgets
    may need to be placed at the exact location where you want the widgets to appear.
    With the JavaScript you write, however, including it in the `<head>` of your document
    whenever possible makes sense from a standards compliance and best practice point
    of view.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here''s an example of some very basic JavaScript on an even more basic web
    page:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: JavaScript code goes between the `<script>` tags. Here I've used `alert`, a
    JavaScript function that will create a message window in your web browser using
    the text inside the parentheses. Using an alert is a handy way to show simple
    examples and to debug, but moving beyond it is best for more complex scripts and
    for public-facing web pages.
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Want to send a special message to browsers without JavaScript? Include `<noscript>`
    tags and the browser will display any content within.
  prefs: []
  type: TYPE_NORMAL
- en: 'A `<script>` tag can include as many lines of JavaScript as you want, though
    too much can start to weigh down your HTML file, so most scripts that are more
    than a few lines are stored in external files. Consider the following, slightly
    altered example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Here, I've loaded the JavaScript via the `src` attribute of the `<script>` tag,
    which is similar to the way images are referenced in HTML. By convention, the
    file has a *.js* extension. Also, to keep things organized, most developers keep
    JavaScript files in a directory off the web root. In this example, I have used
    a directory named `js`.
  prefs: []
  type: TYPE_NORMAL
- en: 'The contents of the file are the same as when you include the JavaScript directly
    on the page. But you do not need the `<script>` tags. Continuing the previous
    example, *test.js* would contain only a single line:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Using this method has the distinct advantage that the script file is cached
    separately by the user's browser. If you use the same script on many pages, as
    the user navigates around your site, the script will only have been downloaded
    once.
  prefs: []
  type: TYPE_NORMAL
- en: As in the first example, this code runs as soon as it is loaded. To run code
    at different times, you'll need to use functions, described later in this appendix.
    But first, let's get a feel for other pieces of JavaScript syntax, such as variables,
    conditionals, and loops.
  prefs: []
  type: TYPE_NORMAL
- en: Variables
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Variables store values that can be changed or accessed later. You can hold numbers,
    text, and more inside variables. In this section, I'll show some simple values,
    as well as more complex structures like arrays and objects.
  prefs: []
  type: TYPE_NORMAL
- en: 'First, you need to be able to identify variables. They look like ordinary words.
    Sometimes variables are more than one word, though they can''t include spaces.
    Often the first time a variable is used it will be set to a value, for example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Here I have created a new variable using JavaScript's `var` keyword. This variable
    is called `age`, but you can use just about any name you want, as long as it isn't
    one of the words reserved by the language. Like most lines of JavaScript code,
    this one ends with a semicolon.
  prefs: []
  type: TYPE_NORMAL
- en: The equals sign declares that the variable on the left side will now be set
    to the value on the right side. In this case, I've used a literal number. You
    could also use text, another variable, or even a combination of other variables
    and literal values.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here is an example using multiple variables, one dependent on the others:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'The `var` keyword should only be used the first time you reference a variable.
    In fact, you do not even need to use it at all, though if you don''t, the variable
    is then assumed to be *global*. [Variable Scope](apas05.html#variable_scope "Variable
    Scope") in [Variable Scope](apas05.html#variable_scope "Variable Scope") will
    explain what this means and why it''s a good idea to declare your variables explicitly.
    You can even do so without creating a value:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'When setting variables that hold text, you need to use quotes on each end of
    the value, for example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: You can use either single (`'`) or double (`"`) quotes to define your text literals,
    but you can't mix them. If you want to include the quote within your string, you
    need to escape it with a backslash.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: Another idiosyncrasy about text variables is covered in the next section.
  prefs: []
  type: TYPE_NORMAL
- en: Arithmetic
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In the previous section, I showed an example that calculated the `total_cost`
    by multiplying one variable times another, using an asterisk (`*`) character.
  prefs: []
  type: TYPE_NORMAL
- en: The `+`, `−`, `*`, `/`, and `=` signs are your tools when it comes to changing
    variable values. We've already seen that `=` sets a variable as *equal* to a value.
    Addition uses the plus sign, `+`. Subtraction uses the minus, `-`. Multiplication
    and division are accomplished by the asterisk, `*`, and slash, `/`, respectively.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here''s a more complex example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'The *mathematical order of operations* is followed, which means multiplication
    and division is performed first and everything is calculated left to right. You
    can force ordering by enclosing some operations within parentheses:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: To save you some typing, a few shorthand arithmetic conventions are shown in
    Table A-1\. Use these when you need to alter a variable's value by some amount
    relative to its current value.
  prefs: []
  type: TYPE_NORMAL
- en: Table A-1. Arithmetic Shorthand
  prefs: []
  type: TYPE_NORMAL
- en: '| Shorthand | Long Version |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| `num += 3;` | `num = num + 3;` |'
  prefs: []
  type: TYPE_TB
- en: '| `num++;` | `num = num + 1;` |'
  prefs: []
  type: TYPE_TB
- en: '| `num -= anothernum;` | `num = num − anothernum;` |'
  prefs: []
  type: TYPE_TB
- en: '| `num--;` | `num = num − 1;` |'
  prefs: []
  type: TYPE_TB
- en: '| `num *= 2;` | `num = num * 2;` |'
  prefs: []
  type: TYPE_TB
- en: '| `num /= 4;` | `num = num / 4;` |'
  prefs: []
  type: TYPE_TB
- en: 'The plus sign, `+`, can also be used to *concatenate*—add together—text strings,
    for example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: Three separate strings are all combined here. The first and last are the `him`
    and `her` variables. The middle one is a literal string, which begins and ends
    with a space. If you were to `alert` the `together` variable, it would read *Adam
    and Eve*.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'You can also use the `+=` shorthand to concatenate strings. For example: `name
    += '' Smith''` will add the string to the end of the text in the `name` variable.'
  prefs: []
  type: TYPE_NORMAL
- en: Arrays
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: So far I've covered two types of variables—numbers and text. Here I'll introduce
    a special kind of variable that holds multiple values. Or, put another way, it
    can contain an *array* of values.
  prefs: []
  type: TYPE_NORMAL
- en: 'The values can be numbers, text, or a combination. You can also include other
    arrays or even objects (covered in the next section) within an array. Here is
    an example of an array declaration:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: 'The values are separated by commas. The list is surrounded by square brackets,
    `[` and `]`. The same brackets are used to access the individual values according
    to where they appear in the list. For example, to pull `Rosemary` from the `herbs`
    variable, you use the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: In JavaScript, as in most programming languages, array indexes begin at zero.
    Therefore, even though `Rosemary` is the third item in the list, you access it
    with number `2`.
  prefs: []
  type: TYPE_NORMAL
- en: 'To determine how many items are in a list, you use the `length` attribute:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: In [Loops](apas04.html "Loops") in [Loops](apas04.html "Loops"), I'll show how
    to access each item in the array.
  prefs: []
  type: TYPE_NORMAL
- en: Objects
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Like arrays, objects hold multiple values. The difference is that you can express
    more structured data than a simple list. To do this, objects contain key and value
    pairs. Keys are word-like labels, but values can be numbers, text, arrays, or
    other objects.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here''s a simple example representing a car:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: 'To access the values within the object, you use dot notation:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: Now that you have seen the different ways of expressing data in JavaScript,
    let's do something with it.
  prefs: []
  type: TYPE_NORMAL
- en: Conditionals
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Conditionals help you compare variables to other values (including other variables).
    This comparison happens in a *conditional statement*. Using conditionals is the
    basis of much programming, because they contain the logic that helps a computer
    "make decisions."
  prefs: []
  type: TYPE_NORMAL
- en: 'The most common conditional is an `if` statement. You use it to provide code
    that is only used in a situation where the condition is true, for example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: The code inside the `{` and `}` braces will only run if the `num` variable is
    exactly `5`. The `==` operator is used to provide the *equals* comparison—in contrast
    to the single equals, which is used to *assign* a value.
  prefs: []
  type: TYPE_NORMAL
- en: You can use other comparison operators, as shown in Table A-2, for cases where
    you don't want the values to be exactly equal.
  prefs: []
  type: TYPE_NORMAL
- en: Table A-2. Conditional Operators
  prefs: []
  type: TYPE_NORMAL
- en: '| Operator | Description |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| `==` | Equal |'
  prefs: []
  type: TYPE_TB
- en: '| `!=` | Not equal |'
  prefs: []
  type: TYPE_TB
- en: '| `>` | Greater than |'
  prefs: []
  type: TYPE_TB
- en: '| `<` | Less than |'
  prefs: []
  type: TYPE_TB
- en: '| `>=` | Greater than or equal |'
  prefs: []
  type: TYPE_TB
- en: '| `<=` | Less than or equal |'
  prefs: []
  type: TYPE_TB
- en: 'If you want to do something else if the condition is false, you can include
    an `else` statement immediately after an `if`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: The code within the `{` and `}` after the `else` statement only runs if the
    condition in the `if` statement is not true. In this example, the `else` code
    runs when `num` is zero or less. The `if` code runs in the other case (where `num`
    is greater than zero). You won't encounter an occasion where both `if` and `else`
    code runs.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: An `else` statement cannot exist without an accompanying `if` statement. You
    can, however, have `if` statements without `else` statements.
  prefs: []
  type: TYPE_NORMAL
- en: 'You can also have an `if` statement without any operator. In those cases, the
    variable within the statement is called a *boolean*, which is either `true` or
    `false`. Here''s an example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: 'The `if (is_cool)` code is shorthand for the much longer `if (is_cool == true)`.
    You can also compare a variable to false in shorthand, using an exclamation point
    to mean "not," as in this example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: Sometimes a non-boolean variable can be a conditional, too. In that case, *empty*
    values are considered false. Empty values are `0` for numbers, `""` (empty string)
    for text, and `null` for objects. Also, any undefined variable is false.
  prefs: []
  type: TYPE_NORMAL
- en: Loops
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Loops are like special conditionals that run the code over and over until the
    condition is no longer true. I will cover two types of loops in this section:
    `for` loops and `while` loops.'
  prefs: []
  type: TYPE_NORMAL
- en: 'In most cases, a loop has a number to count how many times you have used the
    loop. Here''s an example that runs 10 times:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: Three pieces are included inside the parentheses of the `for` statement. The
    initial value ❶, the condition under which the loop continues ❷, and the increment
    portion ❸. The first time through the loop, `i` is 0\. Then 1 and so on, as long
    as `i` is *less than* 10\. When `i` equals 10, the loop stops. But since we started
    at 0, the loop will have run 10 times.
  prefs: []
  type: TYPE_NORMAL
- en: 'The same can be achieved with a `while` loop using the following code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: In fact, if you look at the segments of the code in bold, you'll notice they
    match with the three pieces of a `for` statement. This `while` loop is logically
    equivalent.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: When you know how many times a loop will run, using `for` is probably easiest.
    When you don't know in advance the number of iterations needed (such as when you're
    searching for a value), use `while`.
  prefs: []
  type: TYPE_NORMAL
- en: 'Remember the `herbs` variable from the array section? To refresh your memory,
    we declared it like so:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: 'Now let''s use a loop to do something with each value in the array. Because
    we know the total number of *iterations* (the length of the array), we''ll use
    a `for` loop. Here''s the code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE23]'
  prefs: []
  type: TYPE_PRE
- en: 'Each time through the loop, we tack the current herb (the one in the index
    determined by the number `i`) to the end of the `allherbs` string. At the end
    of the loop, this is what is stored in that variable:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE24]'
  prefs: []
  type: TYPE_PRE
- en: We've used a loop to concatenate the four values held in our array. This concept
    is used throughout the book, only not usually for adding strings together; instead,
    we use it to create hundreds of map markers in just a few lines or output all
    the results of a search.
  prefs: []
  type: TYPE_NORMAL
- en: Loops are an important tool in limiting the code you need to write. But functions
    are perhaps the best tool to achieve simple, reusable code. Read on to see what
    I mean.
  prefs: []
  type: TYPE_NORMAL
- en: Functions
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: If you're ready to upgrade your JavaScript programming abilities, writing functions
    is a good place to start. A function is a packaged-up piece of code for performing
    a particular operation. They can accept one or more variables and return a value
    if necessary. With functions, you can make your code more reusable and break your
    application into smaller pieces.
  prefs: []
  type: TYPE_NORMAL
- en: 'For a basic example, we''ll create a function that outputs the greater of two
    numbers. This function already exists as `Math.max` (which can accept many values
    to compare), but it''s still a good example. Here''s the entire code for the function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE25]'
  prefs: []
  type: TYPE_PRE
- en: Every function begins with the `function` declaration, followed by the name
    of the function. Then, within parentheses, you declare the parameters—variables—that
    your function will accept. In this case, we have two that I've named `num` and
    `another`.
  prefs: []
  type: TYPE_NORMAL
- en: The rest of the function, which resides inside `{` and `}` braces, should look
    familiar; it's just ordinary JavaScript code. When the function is called, you
    pass two variables, and the code runs based on that input. When you're ready to
    send a value back, you use the `return` statement to immediately exit the function
    and make its output equal to the variable (or literal value) you put after `return`.
  prefs: []
  type: TYPE_NORMAL
- en: 'I can probably explain it best with an example. Here''s how you might call
    the new `biggest` function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE26]'
  prefs: []
  type: TYPE_PRE
- en: I've passed a variable (`somenum`) and a literal number to the function. I can
    use any combination of literal or variable values. And the names of my variables
    don't need to match those used within the function. They have different *scope*,
    as I'll explain in the next section.
  prefs: []
  type: TYPE_NORMAL
- en: For normal boolean, number, and text variables, JavaScript makes a copy of the
    value and sends it to the function. That means if you make any changes to the
    values within the function, the original variables outside are unaffected. The
    same is not true of objects and arrays; in these cases you will be modifying the
    value of the original variable—even if the variable is not in the return.
  prefs: []
  type: TYPE_NORMAL
- en: 'At the very beginning of this section, I mentioned that a function does not
    need to take parameters. In these instances, the function needs empty parentheses.
    Here''s a mapping-related example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE27]'
  prefs: []
  type: TYPE_PRE
- en: 'This function would be used to set the map to a stored center point, as long
    as you have the variable in memory. I used a similar approach in [#34: Return
    to the Center When the Message Box Is Closed](ch05s09.html "#34: Return to the
    Center When the Message Box Is Closed") in [#34: Return to the Center When the
    Message Box Is Closed](ch05s09.html "#34: Return to the Center When the Message
    Box Is Closed"). The only way for it to work as shown is if `stored_center` is
    a global variable, visible from any JavaScript on the page.'
  prefs: []
  type: TYPE_NORMAL
- en: Variable Scope
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In the previous sections, I demonstrated how to create variables. I also explained
    that the `var` keyword, although optional, is recommended. The reason behind this
    advice has to do with a variable's visibility—or its scope.
  prefs: []
  type: TYPE_NORMAL
- en: If you use a variable without including the `var` statement, the variable will
    automatically be considered *global*, as opposed to *local*. Global variables
    can be seen from any JavaScript on the page, including other functions. You can
    also explicitly make a variable global by declaring it outside a function, usually
    at the beginning of your JavaScript section.
  prefs: []
  type: TYPE_NORMAL
- en: 'Consider this example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE28]'
  prefs: []
  type: TYPE_PRE
- en: What will the values of the three variables be when the JavaScript `alert` shows
    them? Let's walk through the code. When the page loads, we create a global variable
    ❶ and then we call the `call_first` function.
  prefs: []
  type: TYPE_NORMAL
- en: Within the first function, we set a variable's value without using the `var`
    keyword ❷, making the variable, implicitly, a global variable. The third variable
    ❸ we create is a local variable because the `var` keyword is used within a function.
  prefs: []
  type: TYPE_NORMAL
- en: With these three variables created in different ways, we then call our second
    function from within the first function. In this new function, we reset a global
    variable ❹, create a new local variable ❺, and create a new global variable ❻.
  prefs: []
  type: TYPE_NORMAL
- en: When we return to our spot in the first function, the only variable that has
    changed for this scope is `firstvar`. The `secondvar` variable within the `then_me`
    function is local, so it does not alter the global `secondvar`. And even though
    `then_me`'s `thirdvar` is global, that does not alter a local variable with the
    same name inside the `call_first` function.
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: To make things easier on yourself, be clear and always use the `var` keyword
    to declare variables explicitly.
  prefs: []
  type: TYPE_NORMAL
- en: It's okay if it seems confusing. The good news is the process is logical, if
    you can follow it.
  prefs: []
  type: TYPE_NORMAL
- en: Anonymous Functions
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A special kind of function gets used often in modern JavaScript, especially
    when reading in data (as you often do with maps). This function is called an anonymous
    function because it has no name. These functions are often passed as parameters
    to other functions.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here''s a very basic example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE29]'
  prefs: []
  type: TYPE_PRE
- en: The portion in bold is the anonymous function. It looks exactly like any other
    function, except a name is missing. Another strange thing is that here the function
    is slapped inside the parentheses of a call to another function, `call_another`.
    In that second function, we have one variable ❶, which holds the *reference* to
    our anonymous function. Then we can call it with the name of the reference variable
    ❷.
  prefs: []
  type: TYPE_NORMAL
- en: Sure enough, if you load that up and call the `start_here` function, you'll
    see an alert message from your anonymous function—via the second function.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here''s an example of a more common use for an anonymous function, reading
    JSON in from a web service using jQuery:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE30]'
  prefs: []
  type: TYPE_PRE
- en: 'We''re passing two values to jQuery''s `getJSON` function. The first is the
    URL of the JSON we want to retrieve. The second is our anonymous function—this
    time with a variable being passed to it. When evaluating the JSON data (see [#53:
    Use JSON](ch08s02.html "#53: Use JSON") in [#53: Use JSON](ch08s02.html "#53:
    Use JSON")), jQuery puts it into a JavaScript object, which is then passed to
    our anonymous function.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Using anonymous functions is, in a way, shorthand. Here''s a longer version
    of this jQuery example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE31]'
  prefs: []
  type: TYPE_PRE
- en: Sure, you don't save *that much* time typing, but your code is often more readable.
    Littering your JavaScript with single-purpose functions isn't very clean. But
    perhaps the best reason to understand anonymous functions is that you'll probably
    see many of them in other people's code—including in this book.
  prefs: []
  type: TYPE_NORMAL
- en: 'Anonymous functions should only be used in the situations where they''re most
    useful, however. If you find yourself writing a lot of code in an anonymous function,
    you might make it a named function. Also, watch out for creating anonymous functions
    inside a long loop. You''re essentially creating new functions every time through
    the loop, which is inefficient. And doing this is also counter to the purpose
    of functions: to write code once and run it many times.'
  prefs: []
  type: TYPE_NORMAL
- en: Using jQuery
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In several places in this book, I make use of the JavaScript framework, jQuery.
    jQuery simplifies common tasks and provides a single interface to actions that
    are implemented inconsistently in different browsers. Perhaps the most common
    use of jQuery, especially in this book, is reading in files or other data from
    web services. This section is meant to give a quick introduction to using jQuery.
  prefs: []
  type: TYPE_NORMAL
- en: 'Before you can use jQuery, you need to include it in your web page. You can
    do so by downloading the latest version at [http://jquery.com/](http://jquery.com/)
    or by grabbing a Google-hosted version by adding the following to the `<head>`
    section of your HTML file:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE32]'
  prefs: []
  type: TYPE_PRE
- en: One advantage to using the Google-hosted version is that many other sites do
    as well. That means when people come to your site, they may already have jQuery
    stored in their browser's cache. Even if they don't, they can download it quickly—currently
    the file is under 20KB.
  prefs: []
  type: TYPE_NORMAL
- en: 'Once you have included jQuery in your document, you can use its functions via
    two global variables: `jQuery` and its shorthand, `$`.'
  prefs: []
  type: TYPE_NORMAL
- en: Query Document Objects
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Among its many uses, jQuery is very good at quickly and easily extracting elements
    from your HTML page into JavaScript code. You can query by `id`, tag name, CSS
    class, or combinations of these factors. jQuery makes this task easier, so you
    can focus on what you want to do with those elements.
  prefs: []
  type: TYPE_NORMAL
- en: 'To grab a single piece of the page, such as the map `<div>`, you call it by
    its `id`. Much of jQuery''s syntax is borrowed from CSS, which may look familiar.
    Here is how you would call an object with an `id` of `mymap`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE33]'
  prefs: []
  type: TYPE_PRE
- en: Notice I'm using the dollar-sign shorthand. Then I add parentheses because `$`
    is a variable and a function (jQuery stretches the bounds of JavaScript in ways
    that you and I probably won't). Inside the function, we pass a string with the
    CSS we'd use to style the map div, `#mymap`.
  prefs: []
  type: TYPE_NORMAL
- en: You've now used your first jQuery function to query for a specific element.
    You can achieve the same result with JavaScript's standard `document.getElementById`
    function, but jQuery's method is faster to type. Plus, the result using `$` allows
    you to chain other jQuery functions, such as visual effects.
  prefs: []
  type: TYPE_NORMAL
- en: 'jQuery can also do more than just query individual elements; it can gather
    multiple elements in a single call. Here are a few examples:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE34]'
  prefs: []
  type: TYPE_PRE
- en: Each of these examples shows a different type of querying—and many more are
    possible. You can learn about what jQuery calls *selectors* at [http://api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/).
  prefs: []
  type: TYPE_NORMAL
- en: Insert and Hide Content
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Once you have one or more elements from the page using jQuery, you'll want to
    do something to them. In this section, I'll show you a way to add or replace the
    content inside a page element. And I'll also demonstrate an effect that will hide
    the content, so later, you can make it reappear.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s say you want an element on your page where you can show the results
    of some calculation. You can add the element with HTML using something like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE35]'
  prefs: []
  type: TYPE_PRE
- en: 'When you''re ready to add the results, you can use jQuery to find the element
    and then display the results. If you want to display the content of a variable
    called `total`, you could use this single line of jQuery:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE36]'
  prefs: []
  type: TYPE_PRE
- en: 'This line will find the element on the page with the `id` of `results` and
    then replace its inner HTML with the value in the `total` variable. If you just
    want to add additional content to the element, use this line instead:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE37]'
  prefs: []
  type: TYPE_PRE
- en: 'Now the results section will look something like this (if the `total` variable
    is `42`):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE38]'
  prefs: []
  type: TYPE_PRE
- en: 'You''ve seen how to insert content, but what about making that same content
    disappear? For example, before adding the results, a page with just `Results:`
    without anything after it looks a bit funny. So when the page loads (you''ll learn
    how in the next section), run the following code to hide the results element:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE39]'
  prefs: []
  type: TYPE_PRE
- en: 'And when you''re ready to display the results to the user, include this code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE40]'
  prefs: []
  type: TYPE_PRE
- en: These two functions are simple (and very useful) examples of jQuery effects.
    Many more effects are listed on the jQuery website at [http://api.jquery.com/category/effects/](http://api.jquery.com/category/effects/).
  prefs: []
  type: TYPE_NORMAL
- en: Use Browser Events
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Earlier in this book, I spent an entire chapter on events that happen on maps,
    such as clicking or dragging. You can also react to events anywhere in the browser,
    and jQuery makes reacting a simple process.
  prefs: []
  type: TYPE_NORMAL
- en: To respond to an event, you first need to be listening for it. When your page
    first loads, you register your intention to react to an event. You can do this
    by adding a JavaScript function to the `onload` attribute of your `<body>` tag.
    Or you can do this with a special jQuery event.
  prefs: []
  type: TYPE_NORMAL
- en: 'Although creating an event to register other events may seem counterintuitive,
    it works. Here''s an example that waits until the page is ready:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE41]'
  prefs: []
  type: TYPE_PRE
- en: 'Notice that the element we''re querying for is a little different than in the
    past. Instead of a string inside the parentheses, we''ve inserted a standard JavaScript
    object, `document`. When enough of the page has loaded that the browser knows
    all the objects it contains, we call the `register_events` function. That function
    doesn''t exist, however, so we need to write it. Or, instead, we could react to
    the same event with an anonymous function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE42]'
  prefs: []
  type: TYPE_PRE
- en: As with most anonymous functions, you usually want to keep it to just a few
    lines. If you have many events to register, you are probably best served with
    a named function.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: A big difference exists between using your browser's `onload` attribute and
    jQuery's `ready` event. With `onload`, you wait until the entire page is loaded,
    including images and other external files. With `$(document).ready`, you can run
    code, such as registering events and hiding objects, the moment the browser is
    ready. Using jQuery here often translates to a better user experience.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now that you''ve waited for the browser to be ready to register other events,
    let''s register them. Here''s the basic pattern for jQuery events:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE43]'
  prefs: []
  type: TYPE_PRE
- en: The *`element`* portion is usually a selector, such as an element's `id` (though
    it can also be any browser object, as shown in the `ready` example). The *`event`*
    piece is the name of the function, as declared by jQuery. Finally, *`function`*
    is the function reference, either an anonymous function or the name of the function
    to call.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here''s how you''d listen for a particular element to be clicked:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE44]'
  prefs: []
  type: TYPE_PRE
- en: If you're familiar with JavaScript events included in HTML, you might be wondering
    where the `on`, as in `onClick`, went. In jQuery, events are referenced with only
    the action.
  prefs: []
  type: TYPE_NORMAL
- en: 'You can also get additional information about the event. The information available
    may be a little different depending on the event. Here''s how you find out where
    the user has double-clicked on a page:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE45]'
  prefs: []
  type: TYPE_PRE
- en: 'Instead of a `click` event, I used a `dblclick` event. Because we want more
    information about the event, I included an optional parameter ❶ to the anonymous
    function. Within the function, I can use that variable to get information, such
    as where the user clicked. This data comes in two pieces: the number of pixels
    from the left side of the page ❷ and the number from the top of the page ❸.'
  prefs: []
  type: TYPE_NORMAL
- en: You can see a sampling of available events in Table A-3, along with the additional
    information that is passed in the optional parameter to each event.
  prefs: []
  type: TYPE_NORMAL
- en: Table A-3. Some Useful jQuery Events
  prefs: []
  type: TYPE_NORMAL
- en: '| Event Name | Objects Available | Additional Information |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| `click` | Any | Page location: `pageX`, `pageY` |'
  prefs: []
  type: TYPE_TB
- en: '| `dblclick` | Any | Page location: `pageX`, `pageY` |'
  prefs: []
  type: TYPE_TB
- en: '| `mousemove` | Any | Page location: `pageX`, `pageY` |'
  prefs: []
  type: TYPE_TB
- en: '| `keydown` | `document`, `window` | Key code: `which` |'
  prefs: []
  type: TYPE_TB
- en: '| `focus` | Form elements |   |'
  prefs: []
  type: TYPE_TB
- en: Events will make your web pages much more interactive, whether or not they contain
    maps. For a full list of events (and additional event information available),
    see jQuery's documentation at [http://api.jquery.com/category/events/](http://api.jquery.com/category/events/).
  prefs: []
  type: TYPE_NORMAL
- en: Load Files and Data
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: If you want to interact with data outside of your current HTML file, jQuery
    has some excellent tools for doing these sorts of Ajax calls. Though Ajax is short
    for *Asynchronous JavaScript And XML*, you can access any type of data with Ajax.
  prefs: []
  type: TYPE_NORMAL
- en: 'To load a file with jQuery, you use the `get` function. `get` needs at least
    two parameters: the URL you want to load and the function to which you want jQuery
    to send the results. Here''s a simple example for loading a text file:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE46]'
  prefs: []
  type: TYPE_PRE
- en: 'The URL ❶ I provided is just the name of a file. In this case, the file is
    text, but it could be a bit of HTML code or another type of content. In [#52:
    Use XML](ch08.html#number_symble_52_colon_use_xml "#52: Use XML") in [#52: Use
    XML](ch08.html#number_symble_52_colon_use_xml "#52: Use XML"), I show how to parse
    XML results with the `get` function.'
  prefs: []
  type: TYPE_NORMAL
- en: 'You aren''t restricted to only loading simple files. You could include directory
    names or even a full URL. Whatever you load needs to be on the same domain that
    you are making the call on. For security reasons, browsers will not let you retrieve
    data from someone else''s site, even if that data is meant to be public. You can
    get around this by loading the file server-side (as shown in [#61: Retrieve a
    Web Page](ch09s03.html "#61: Retrieve a Web Page") in [#61: Retrieve a Web Page](ch09s03.html
    "#61: Retrieve a Web Page")) and then accessing the local copy.'
  prefs: []
  type: TYPE_NORMAL
- en: 'A special case exists that allows you to load data from another site. If the
    site provides JSON data and it allows you to specify a callback function in the
    URL, then you can load the data remotely using jQuery''s `getJSON` function. Here''s
    the basic structure:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE47]'
  prefs: []
  type: TYPE_PRE
- en: The URL you send to the `getJSON` function ❷ needs to contain a question mark
    in place of the name of a function. Then jQuery will create a function and call
    your anonymous function (or named function, if you choose) from its new function.
  prefs: []
  type: TYPE_NORMAL
- en: Another way `getJSON` is different from `get` is in the type of data passed
    in the parameters to your callback function. Rather than the plain text returned
    to the URL, jQuery passes you parsed JSON in the form of a JavaScript object.
  prefs: []
  type: TYPE_NORMAL
- en: 'You''ll find a more complete example of `getJSON` in [#53: Use JSON](ch08s02.html
    "#53: Use JSON") in [#53: Use JSON](ch08s02.html "#53: Use JSON"). Also, you can
    see examples of the function used in a real project in several of the mashups
    in [Chapter 10](ch10.html "Chapter 10. MASHUP PROJECTS").'
  prefs: []
  type: TYPE_NORMAL
