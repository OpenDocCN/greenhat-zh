- en: Appendix A. XM REFERENCE
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 附录 A. XM 参考
- en: '![image with no caption](httpatomoreillycomsourcenostarchimages333191.png.jpg)'
  id: totrans-1
  prefs: []
  type: TYPE_IMG
  zh: '![无标题图片](httpatomoreillycomsourcenostarchimages333191.png.jpg)'
- en: The `xm` command is probably the first thing to know about Xen. It's your primary
    interface to Xen's control-plane functionality. Using `xm`, you can create, query,
    and destroy domains. You can send certain instructions (e.g., shut down) to guest
    domains. You can attach and detach storage and network devices and dynamically
    adjust resource consumption.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '`xm` 命令可能是你需要了解的第一个 Xen 相关的内容。它是你访问 Xen 控制平面功能的主要接口。使用 `xm`，你可以创建、查询和销毁域。你可以向客户域发送某些指令（例如，关闭）。你可以连接和断开存储和网络设备，并动态调整资源消耗。'
- en: In short, knowing `xm` is *important*. That's why we've documented `xm` 's subcommands
    here, with references to the rest of the book.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 简而言之，了解 `xm` 是*重要的*。这就是为什么我们在本节中记录了 `xm` 的子命令，并提供了对本书其他部分的参考。
- en: Note
  id: totrans-4
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*Some of these commands—the ones introduced with Xen 3.1 or later—may not work
    with the Xen version included in RHEL 5*.x *because Red Hat''s priority is to
    maintain compatibility within major releases, rather than support new features.
    These commands are marked with an asterisk*.'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '*其中一些命令（从 Xen 3.1 或更高版本引入的）可能不与 RHEL 5 中包含的 Xen 版本兼容*.*x*，因为 Red Hat 的优先级是保持主要版本之间的兼容性，而不是支持新功能。这些命令带有星号*。'
- en: All of `xm`'s commands work by sending instructions to `xend`, the Xen control
    daemon. This is a Python program that runs in domain 0\. It receives requests
    and sends replies to client applications, like `xm`.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 所有 `xm` 命令都通过向 `xend` 发送指令来工作，`xend` 是 Xen 控制守护进程。这是一个在域 0 上运行的 Python 程序。它接收请求并向客户端应用程序（如
    `xm`）发送回复。
- en: If `xend` isn't running, `xm` will return an error and exit. Much of `xm`'s
    functionality relies on the XenBus, which is a shared communication channel between
    all domains on the machine, and the XenStore, which is a centralized configuration
    database that `xend` uses to hold domain configuration information and states.
    For more information on the XenStore and XenBus, take a look at [Chapter 14](ch14.html
    "Chapter 14. TIPS").
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 `xend` 没有运行，`xm` 将返回错误并退出。`xm` 的许多功能依赖于 XenBus，这是一个在机器上所有域之间的共享通信通道，以及 XenStore，这是一个集中式配置数据库，`xend`
    使用它来保存域配置信息和状态。有关 XenStore 和 XenBus 的更多信息，请参阅[第 14 章](ch14.html "第 14 章。技巧")。
- en: That said, let's look at the general form of an `xm` command.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 话虽如此，让我们看看 `xm` 命令的一般形式。
- en: xm's Syntax
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '`xm` 的语法'
- en: '`xm`''s syntax is fairly simple and consistent:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '`xm` 的语法相当简单且一致：'
- en: '[PRE0]'
  id: totrans-11
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Options can go either before or after the domain specifier, but we usually
    put them at the end. For example, to order domain 10 to shut down cleanly:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 选项可以放在域指定符之前或之后，但我们通常将它们放在末尾。例如，要干净地关闭域 10：
- en: '[PRE1]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Here we're not specifying any options, and we're referring to the domain by
    numeric ID rather than name. The domain specifier may be either a domain number
    or domain name—the names will be internally translated to numbers. (Note that
    this won't work if the XenStore isn't up, but in that case, you have bigger problems.)
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们没有指定任何选项，并且我们通过数字 ID 而不是名称来引用域。域指定符可以是域编号或域名称——名称将内部转换为数字。（注意，如果 XenStore
    没有启动，则此操作将不会工作，但那种情况下，你面临的问题更大。）
- en: '`xm` commands are usually asynchronous, which means that the command may return
    before it''s actually completed. In the case of a command like `xm shutdown`,
    it may take the domain several minutes to actually shut down. In that case, we
    ordinarily poll `xm list` to make sure that the domain has stopped running.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '`xm` 命令通常是异步的，这意味着命令可能在实际上完成之前就返回了。对于像 `xm shutdown` 这样的命令，域可能需要几分钟才能真正关闭。在这种情况下，我们通常会轮询
    `xm list` 来确保域已经停止运行。'
- en: xm Subcommands
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '`xm` 子命令'
- en: Here's a list of the various `xm` subcommands. We use some of them frequently,
    and we don't use some of them at all. New commands with version 3.1 are marked
    with an asterisk (*) because version 3.1 marks a substantial change in Xen's approach
    to domain management. As we mentioned earlier, this means they might also not
    work with RHEL 5.*x*. Although RHEL 5.2, for example, uses the 3.1 version of
    the Xen hypervisor, it uses the 3.0.3 versions of the userspace tools, such as
    `xend`.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 这里列出了各种 `xm` 子命令。我们经常使用其中的一些，而完全不使用其中的一些。带有版本 3.1 的新命令带有星号 (*)，因为 3.1 标志着 Xen
    在域管理方法上的重大变化。正如我们之前提到的，这意味着它们也可能不与 RHEL 5.*x* 兼容。例如，尽管 RHEL 5.2 使用 Xen 虚拟机的 3.1
    版本，但它使用的是 `xend` 等用户空间工具的 3.0.3 版本。
- en: '**`addlabel`**, **`cfgbootpolicy`**, **`dumppolicy`**, **`getlabel`**, **`labels`**,
    **`loadpolicy`**, **`makepolicy`**, **`resources`**, **and** **`rmlabel`**'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '**`addlabel`**, **`cfgbootpolicy`**, **`dumppolicy`**, **`getlabel`**, **`labels`**,
    **`loadpolicy`**, **`makepolicy`**, **`resources`**, **以及** **`rmlabel`**'
- en: These subcommands interface with Xen's security policy infrastructure. As we
    mention in [Chapter 14](ch14.html "Chapter 14. TIPS"), we haven't seen any practical
    use for Xen's security policies. If you're interested in more information about
    the security modules (which are themselves the subject of ongoing work), we suggest
    looking at the sample policies included with the Xen source distribution.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 这些子命令与 Xen 的安全策略基础设施交互。正如我们在[第 14 章](ch14.html "第 14 章。技巧")中提到的，我们没有看到 Xen 安全策略的任何实际用途。如果您对安全模块（它们本身也是正在进行的工作的主题）感兴趣，我们建议查看
    Xen 源代码分发中包含的示例策略。
- en: '**`block-attach`**, **`block-configure`**, **`block-detach`**, **and** **`block-list`**'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '**`block-attach`**, **`block-configure`**, **`block-detach`**, **以及** **`block-list`**'
- en: The various `block` subcommands manage storage devices that are attached to
    domains. These commands are handled in more detail in [Chapter 4](ch04.html "Chapter 4. STORAGE
    WITH XEN").
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 各种 `block` 子命令管理附加到域的存储设备。这些命令在[第 4 章](ch04.html "第 4 章。使用 Xen 的存储")中有更详细的说明。
- en: '**`console`**'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '**`console`**'
- en: The console subcommand attaches to the given domain's console. Note that this
    is only useful if the domain is set up to use Xen's virtual console.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 控制台子命令连接到指定域的控制台。请注意，这只有在域设置为使用 Xen 的虚拟控制台时才有用。
- en: Even if everything is set up correctly, you may need to press ENTER to make
    it give you a login prompt. (This can be puzzling for new users, who type `xm
    console` and see a blank screen, because nothing's been added to the console buffer
    since the last time they used it.)
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 即使一切设置正确，您可能也需要按 ENTER 键来使其显示登录提示。这对新用户来说可能有些令人困惑，因为他们输入 `xm console` 并看到空白屏幕，因为自上次使用以来控制台缓冲区中没有任何内容被添加。
- en: '**`create`**'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '**`create`**'
- en: The `xm create` subcommand, in recent versions of Xen, is a synonym for `xm
    new` followed by `xm start`. It's the subcommand we use throughout the book to
    make domains go.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Xen 的最新版本中，`xm create` 子命令是 `xm new` 后跟 `xm start` 的同义词。这是我们全书用来启动域的子命令。
- en: '`Create` expects the name of a config file. If you don''t specify a file, it
    uses the default, */etc/xen/xmdefconfig*.'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '`Create` 需要配置文件的名称。如果您没有指定文件，它将使用默认值，*/etc/xen/xmdefconfig*。'
- en: 'The `create` subcommand takes these options:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '`create` 子命令接受以下选项：'
- en: '`-h`: Prints help.'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-h`: 打印帮助信息。'
- en: '`-q`: Quiet mode.'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-q`: 静默模式。'
- en: '`--path`: Base path for domain configuration files (*/etc/xen* by default).'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`--path`: 域配置文件的基本路径（默认为 */etc/xen*）。'
- en: '`-n`: Dry-run mode. Prints the configuration that would be generated. This
    is used to debug Python code in domain configurations. If you''re autogenerating
    a domain config, it''s nice to have some way to test it.'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-n`: 干运行模式。打印将要生成的配置。这用于调试域配置中的 Python 代码。如果您正在自动生成域配置，有某种方式来测试它将是非常好的。'
- en: '`-x`: Similar to `-n` but outputs a domain definition in XML. Note that, as
    of Xen 3.3, this option still relies on the deprecated `xml.dom.ext` module and
    thus does not work with many Python installations.'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-x`: 与 `-n` 类似，但输出 XML 格式的域定义。请注意，截至 Xen 3.3，此选项仍然依赖于已弃用的 `xml.dom.ext` 模块，因此不适用于许多
    Python 安装。'
- en: '`-c`: Connect automatically to the console. This is necessary to interact with
    PyGRUB.'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-c`: 自动连接到控制台。这是与 PyGRUB 交互所必需的。'
- en: '`-s`: Skip DTD checking for XML domain configurations.'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-s`: 跳过 XML 域配置的 DTD 检查。'
- en: If you don't give `xm create` a full path, it will default to looking for the
    config file in */etc/xen*. You can change that with the `--path` option.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您没有为 `xm create` 提供完整路径，它将默认在 */etc/xen* 中查找配置文件。您可以使用 `--path` 选项更改这一点。
- en: '**`debug-keys *`**'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: '**`debug-keys *`**'
- en: The `debug-keys` subcommand interacts with the GDB stub built into Xen, enabling
    you to send magic keystrokes to control the stub's output. It is likely to be
    useful only if you're hacking Xen's internals.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '`debug-keys` 子命令与 Xen 内置的 GDB stub 交互，使您能够发送魔法按键来控制 stub 的输出。这可能在您修改 Xen 内部时非常有用。'
- en: Note that this will only have an effect if you've built Xen with the GDB stub.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，这只有在您使用 GDB stub 构建Xen时才会生效。
- en: '**`delete *`**'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: '**`delete *`**'
- en: The `xm delete` subcommand removes a domain from Xen's management. If the domain
    is running, the delete subcommand shuts it down, then removes its definition.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '`xm delete` 子命令从 Xen 的管理中删除一个域。如果该域正在运行，删除子命令会将其关闭，然后删除其定义。'
- en: '**`destroy`**'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '**`destroy`**'
- en: Before you think UNIX is family oriented, note that all children must die.
  id: totrans-43
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 在你认为 UNIX 是家庭导向之前，请注意，所有孩子都必须死去。
- en: ''
  id: totrans-44
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: —Eric Foster-Johnson, *Cross-Platform Perl*
  id: totrans-45
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: —埃里克·福斯特-约翰逊，*跨平台Perl*
- en: The `xm destroy` command is the equivalent of yanking the power plug on a physical
    machine. If the domU has locked up completely, it may be necessary to ask `xend`
    to terminate it forcefully. All resources are immediately returned to the hypervisor.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '`xm destroy` 命令相当于在物理机器上拔掉电源插头。如果 domU 完全锁定，可能需要请求 `xend` 强制终止它。所有资源将立即返回给虚拟机管理程序。'
- en: '**`dmesg`**'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '**`dmesg`**'
- en: Like the `dmesg` system command, the `xm dmesg` subcommand prints out diagnostic
    messages from the kernel boot. We talk more about these messages in [Chapter 15](ch15.html
    "Chapter 15. TROUBLESHOOTING").
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 类似于 `dmesg` 系统命令，`xm dmesg` 子命令会打印出内核启动的诊断信息。我们将在 [第15章](ch15.html "第15章。故障排除")
    中更多地讨论这些信息。
- en: '**`domid`** **and** **`domname`**'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '**`domid`** **和** **`domname`**'
- en: The `domid` and `domname` commands look up a domain's ID when you have its name,
    or vice versa. Each subcommand takes a single argument, the domain name or ID
    respectively, and returns the ID or name as appropriate. They're handy if you've
    got a lot of domains floating around.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '`domid` 和 `domname` 命令在你知道域的名称时查找域的 ID，反之亦然。每个子命令接受一个单一参数，即域名称或 ID，并返回相应的 ID
    或名称。如果你有很多域在浮动，它们会很有用。'
- en: '**`dry-run`**'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '**`dry-run`**'
- en: Although the `dry-run` subcommand, in theory, tests whether Xen can successfully
    find and use its virtual devices, we've had mixed luck because it's not very good
    at predicting whether we'll be successful in starting a domain. One important
    use for it is to debug Python code that is included in domain configurations,
    as described in [Chapter 14](ch14.html "Chapter 14. TIPS").
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然 `dry-run` 子命令在理论上测试 Xen 是否能成功找到并使用其虚拟设备，但我们运气不佳，因为它不太擅长预测我们是否能在启动域时成功。它的一个重要用途是调试包含在域配置中的
    Python 代码，如 [第14章](ch14.html "第14章。技巧") 中所述。
- en: This subcommand is also a suboption for `xm create`, which creates the domain
    in dry-run mode.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 此子命令也是 `xm create` 的子选项，它以 dry-run 模式创建域。
- en: '**`dump-core`**'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '**`dump-core`**'
- en: The `dump-core` subcommand triggers an immediate memory dump.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: '`dump-core` 子命令会触发立即的内存转储。'
- en: Ordinarily, it pauses the domain, dumps its memory to the specified file, and
    then unpauses. You can, however, specify the `-L (--live)` option to make it dump
    in a fashion similar to live migration, without pausing and unpausing the domain
    (or, at least, without pausing it for any noticeable amount of time).
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，它会暂停域，将其内存转储到指定的文件，然后解除暂停。然而，你可以指定 `-L (--live)` 选项，使其以类似实时迁移的方式转储，而无需暂停和解除暂停（或者至少不需要暂停任何明显的时间）。
- en: '**`info`**'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '**`info`**'
- en: The `info` subcommand prints a lot of useful information about the Xen host,
    including the precise version of Xen you're using, the capabilities of the processor,
    and the memory that's available for domUs.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '`info` 子命令会打印出关于 Xen 主机的大量有用信息，包括你使用的 Xen 的精确版本、处理器的功能以及可用于 domUs 的内存。'
- en: '**`list`**'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '**`list`**'
- en: The `xm list` subcommand, in its simplest form, just lists domains in a table.
    However, it can also print out general information about domains, including a
    complete `s-`expression (if given the `--long` option).
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '`xm list` 子命令在最简单的形式下，只是列出域的表格。然而，它也可以打印出有关域的一般信息，包括完整的 `s-` 表达式（如果提供了 `--long`
    选项）。'
- en: The short form of the `list` subcommand will also show the state for each domain.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '`list` 子命令的简短形式也会显示每个域的状态。'
- en: '`''b''` (blocked): The domain is waiting for something, either for I/O or scheduling
    reasons. Idle domains will show up in a blocked state. This is normal; when they
    have something to do, they''ll be unblocked.'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`''b''` (阻塞): 域正在等待某些事情，无论是 I/O 还是调度原因。空闲域将显示为阻塞状态。这是正常的；当它们有事情要做时，它们将被解除阻塞。'
- en: '`''p''` (paused): This state means that the domain''s been paused by `xm pause`.'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`''p''` (暂停): 此状态表示该域已被 `xm pause` 暂停。'
- en: '`''c''` (crashed): The domain has crashed.'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`''c''` (崩溃): 域已崩溃。'
- en: '`''d''` (dying): The domain is in shutdown and in the process of being destroyed
    by the hypervisor. If a domain remains in this state, the odds are good that it''s
    a bug.'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`''d''` (死亡): 域正在关闭，并且正在由虚拟机管理程序销毁的过程中。如果一个域保持在此状态，那么它很可能是存在一个错误。'
- en: '`''s''` (shutdown): The domain is in the process of shutting down, whether
    because of a command issued from within the domain (e.g., `halt`) or from dom0
    (e.g., `xm shutdown`). This state is also used for domains that are known to Xen
    but are not started. If you use `xm new`, the imported domain definition will
    show in `xm list` as `shutdown` until you start it with `xm start`.'
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`''s''`（关闭）：域正在关闭过程中，无论是由于域内发出的命令（例如，`halt`）还是来自 dom0（例如，`xm shutdown`）。此状态还用于已知于
    Xen 但尚未启动的域。如果您使用 `xm new`，导入的域定义将在 `xm list` 中显示为 `shutdown`，直到您使用 `xm start`
    启动它。'
- en: '`''r''` (running): The domain is presently executing on the physical computer.
    Note that, on a single-processor machine, `xm list` will always show dom0 as the
    only running domain because dom0 is generating and displaying the `xm list` output.'
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`''r''`（运行）：域目前正在物理计算机上执行。请注意，在单处理器机器上，`xm list` 总是会显示 dom0 作为唯一的运行域，因为 dom0
    正在生成和显示 `xm list` 输出。'
- en: '**`log`**'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: '**`log`**'
- en: The `xm log` command simply prints out */var/log/xend.log*. We go into more
    detail about Xen's various log files in [Chapter 15](ch15.html "Chapter 15. TROUBLESHOOTING").
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '`xm log` 命令简单地打印出 */var/log/xend.log*。我们将在 [第 15 章](ch15.html "第 15 章。故障排除")
    中更详细地介绍 Xen 的各种日志文件。'
- en: '**`mem-max`**'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '**`mem-max`**'
- en: The `mem-max` subcommand specifies the maximum amount of memory that the domain
    can use in megabytes. This is identical to the maxmem directive in the domain
    config file. Right now, this subcommand has no effect on running domains; changes
    take effect when the domain reboots.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: '`mem-max` 子命令指定域可以使用的最大内存量（以兆字节为单位）。这与域配置文件中的 maxmem 指令相同。目前，此子命令对正在运行的域没有影响；更改将在域重新启动时生效。'
- en: '**`mem-set`**'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: '**`mem-set`**'
- en: The `xm mem-set` subcommand works by sending messages to the balloon driver
    in the target domU. Altering the domain's memory allocation in this way requires
    cooperation from the domU's operating system and thus is not guaranteed. It also
    raises the possibility of taking too much memory from the domain, which will make
    it unstable.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: '`xm mem-set` 子命令通过向目标 domU 中的气球驱动程序发送消息来工作。以这种方式更改域的内存分配需要 domU 操作系统的合作，因此不能保证。这也提出了从域中获取过多内存的可能性，这将使其变得不稳定。'
- en: We prefer to avoid using this subcommand. However, for more information about
    the balloon driver, see the relevant discussion in [Chapter 14](ch14.html "Chapter 14. TIPS").
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 我们更喜欢避免使用此子命令。然而，有关气球驱动程序的更多信息，请参阅 [第 14 章](ch14.html "第 14 章。技巧") 中的相关讨论。
- en: '**`migrate`**'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '**`migrate`**'
- en: The `migrate` subcommand, as one might suppose, migrates domains. Migration
    is fairly complicated. [Chapter 9](ch09.html "Chapter 9. XEN MIGRATION") is devoted
    entirely to the subject.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '`migrate` 子命令，正如您所猜测的，用于迁移域。迁移相当复杂。[第 9 章](ch09.html "第 9 章。XEN 迁移") 完全致力于此主题。'
- en: '**`network-attach`**, **`network-detach`**, **and** **`network-list`**'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: '**`network-attach`**、**`network-detach`** 和 **`network-list`**'
- en: As you might guess, these subcommands manage virtual network devices (*vifs*,
    in Xen parlance, rather than networks per se). With these subcommands, you can
    attach, detach, and list vifs. We address these subcommands in [Chapter 5](ch05.html
    "Chapter 5. NETWORKING").
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所猜测，这些子命令管理虚拟网络设备（在 Xen 术语中为 *vifs*，而不是网络本身）。使用这些子命令，您可以连接、断开连接和列出 vifs。我们将在
    [第 5 章](ch05.html "第 5 章。网络") 中讨论这些子命令。
- en: '**`new *`**'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: '**`new *`**'
- en: The `new` subcommand adds a domain to Xen's management; that is, it defines
    the domain but doesn't actually allocate resources or run it. Having imported
    the domain into Xen, you can start it with the `xm start` subcommand.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 新增的 `new` 子命令将域添加到 Xen 的管理中；也就是说，它定义了域，但实际上并不分配资源或运行它。将域导入 Xen 后，您可以使用 `xm start`
    子命令启动它。
- en: You'll probably want to run `new` with the `-f` option, specifying a file that
    describes the domain. This can be XML or the standard Python config format.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能希望使用 `-f` 选项运行 `new`，指定描述域的文件。这可以是 XML 或标准的 Python 配置格式。
- en: '**`pause`**'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: '**`pause`**'
- en: This subcommand pauses the domain. While paused, the domain continues to occupy
    memory and hold a lock on its devices, but it won't be scheduled to run on the
    CPU.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 此子命令暂停域。在暂停期间，域将继续占用内存并锁定其设备，但不会被调度在 CPU 上运行。
- en: '**`reboot`**'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: '**`reboot`**'
- en: The `reboot` subcommand orders the domain to reboot itself cleanly. Note that,
    if you're using PyGRUB, `xm reboot` will not load a new kernel; for that you'll
    need to shut down and re-create the domain. The same applies to, for example,
    `shutdown -r` from within the domU.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: '`reboot`子命令命令域干净地重启自己。请注意，如果您使用PyGRUB，`xm reboot`不会加载新的内核；为此您需要关闭并重新创建域。例如，`shutdown
    -r`在domU内部也是如此。'
- en: '**`rename`**'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: '**`rename`**'
- en: The `xm rename` subcommand allows the administrator to change the human-readable
    name associated with the domain ID.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: '`xm rename`子命令允许管理员更改与域ID相关联的可读名称。'
- en: '**`restore`** **and** **`save`**'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '**`restore`** **和** **`save`**'
- en: The `xm restore` and `save` subcommands complement each other. As we describe
    in [Chapter 9](ch09.html "Chapter 9. XEN MIGRATION"), `xm save` causes a domain
    to relinquish its resources and save state to a save file, and `xm restore` causes
    it to restore itself from a previously created save file. This is very much like
    hibernation.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: '`xm restore`和`save`子命令相互补充。正如我们在[第9章](ch09.html "第9章。XEN迁移")中描述的，`xm save`使域释放其资源并将状态保存到保存文件中，而`xm
    restore`则使其从先前创建的保存文件中恢复。这非常类似于休眠。'
- en: '**`resume *`**'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: '**`resume *`**'
- en: The resume subcommand instructs a domain to return from a suspended state. Note
    that this only applies to domains managed by `xend` *lifecycle support*, which
    is essentially the ability to have `xend` manage inactive domains.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: '`resume`子命令指示一个域从挂起状态返回。请注意，这仅适用于由`xend` *生命周期支持*管理的域，这本质上是指`xend`管理非活动域的能力。'
- en: '**`sched-credit`**'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '**`sched-credit`**'
- en: 'The credit scheduler is the default scheduler for Xen. The `sched-credit` subcommand
    configures the credit scheduler, allowing you to display or adjust a domain''s
    weight and cap. We describe its use at some length in [Chapter 7](ch07.html "Chapter 7. HOSTING
    UNTRUSTED USERS UNDER XEN: LESSONS FROM THE TRENCHES").'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 信用调度器是Xen的默认调度器。`sched-credit`子命令配置信用调度器，允许您显示或调整域的权重和上限。我们在[第7章](ch07.html
    "第7章。在XEN下托管不受信任的用户：来自战壕的经验教训")中详细描述了其用法。
- en: '**`sched-sedf`**'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: '**`sched-sedf`**'
- en: The sedf scheduler, of course, is obsolete. However, if you find yourself using
    it, you can use the `sched-sedf` subcommand to adjust the scheduling parameters
    for a domain.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，sedf调度器已经过时。但是，如果您发现自己在使用它，您可以使用`sched-sedf`子命令调整域的调度参数。
- en: '**`shell *`**'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: '**`shell *`**'
- en: The `shell` subcommand is a bit interesting. It starts an interactive shell,
    nicknamed *The Xen Master*, from which you can issue the various `xm` subcommands.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: '`shell`子命令有点有趣。它从一个交互式shell启动，被称为*The Xen Master*，您可以从该shell中发出各种`xm`子命令。'
- en: '**`shutdown`**'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '**`shutdown`**'
- en: Like `xm reboot`, the `shutdown` subcommand orders the domain to shut down,
    with the difference that it doesn't immediately restart it. This subcommand requires
    domU cooperation; if the domain doesn't shut down, `xend` won't forcefully terminate
    it. If `xm shutdown` doesn't work, you may want to try `xm destroy`.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 与`xm reboot`类似，`shutdown`子命令命令域关闭，不同之处在于它不会立即重启。此子命令需要domU合作；如果域没有关闭，`xend`不会强制终止它。如果`xm
    shutdown`不起作用，您可能想尝试`xm destroy`。
- en: '**`start *`**'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: '**`start *`**'
- en: The `start` subcommand starts a managed domain. Note that this subcommand, like
    `new` and `suspend`, only exists as of Xen 3.1, which adds `xend` lifecycle support.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '`start`子命令启动一个受管理的域。请注意，此子命令，就像`new`和`suspend`一样，仅存在于Xen 3.1中，它添加了`xend`生命周期支持。'
- en: '**`suspend *`**'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: '**`suspend *`**'
- en: The `xm suspend` subcommand suspends a managed domain.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '`xm suspend`子命令挂起一个受管理的域。'
- en: '**`sysrq`**'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: '**`sysrq`**'
- en: The `sysrq` subcommand sends one of the magic sysrq keys to the domU. Note that
    this can't be done via `xm` console because the dom0 won't pass a sysrq through
    to the domU. It's a useful last resort if the domain seems catatonic. For more
    information about sysrq, see the kernel documentation (*Documentation/sysrq.txt*
    in the Linux kernel source tree).
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '`sysrq`子命令将一个魔法sysrq键发送到domU。请注意，这不能通过`xm`控制台完成，因为dom0不会将sysrq传递给domU。如果域似乎处于昏迷状态，这是一个有用的最后手段。有关sysrq的更多信息，请参阅内核文档（Linux内核源树中的*Documentation/sysrq.txt*）。'
- en: '**`top`**'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: '**`top`**'
- en: The `xm top` subcommand presents status information for the running Xen domains
    in a format similar to that of the `top(1)` subcommand.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: '`xm top`子命令以类似于`top(1)`子命令的格式显示正在运行的Xen域的状态信息。'
- en: '**`trigger *`**'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '**`trigger *`**'
- en: The `trigger` subcommand sends a CPU event to a domain. It can trigger a Non-Maskable
    Interrupt (NMI), reset, or init event (although the latter two fail with a `function
    not implemented` message on Xen 3.2/i386). This subcommand is useful mostly for
    debugging.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: '`trigger` 子命令向域发送 CPU 事件。它可以触发不可屏蔽中断 (NMI)、复位或 init 事件（尽管后两个在 Xen 3.2/i386
    上会失败，显示“未实现功能”消息）。这个子命令主要用于调试。'
- en: '**`unpause`**'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: '**`unpause`**'
- en: The `xm unpause` subcommand resumes a domain that's been paused with `xm pause`.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '`xm unpause` 子命令将使用 `xm pause` 暂停的域恢复运行。'
- en: '**`uptime`**'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: '**`uptime`**'
- en: The `xm uptime` subcommand will print the uptime for the selected domain or
    for all VMs if no domain is specified.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: '`xm uptime` 子命令将打印所选域的运行时间，如果没有指定域，则为所有虚拟机打印。'
- en: '**`vcpu-list`**, **`vcpu-pin`**, **and** **`vcpu-set`**'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: '**`vcpu-list`**、**`vcpu-pin`** 和 **`vcpu-set`**'
- en: 'The `vcpu-` subcommands control which `cpus` a domain will use in an SMP system.
    For more information, see [Chapter 7](ch07.html "Chapter 7. HOSTING UNTRUSTED
    USERS UNDER XEN: LESSONS FROM THE TRENCHES").'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: '`vcpu-` 子命令控制域在 SMP 系统中将使用哪些 `cpus`。有关更多信息，请参阅 [第 7 章](ch07.html "第 7 章。在 Xen
    下托管不受信任的用户：来自战壕的经验")。'
- en: '**`vnet-create`**, **`vnet-delete`**, and **`vnet-list`**'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '**`vnet-create`**、**`vnet-delete`** 和 **`vnet-list`**'
- en: These three `vnet-` subcommands interact with Xen's VLAN support. We don't cover
    the VLAN support because we've never had occasion to use it and we've never seen
    anyone else use it. If you're finding it useful, drop us an email.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 这三个 `vnet-` 子命令与 Xen 的 VLAN 支持交互。我们没有涵盖 VLAN 支持，因为我们从未有机会使用它，也从未见过其他人使用它。如果你觉得它很有用，请给我们发一封电子邮件。
- en: '**`vtpm-list`**'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: '**`vtpm-list`**'
- en: The `vtpm-list` subcommand allows you to list the virtual TPMs (trusted platform
    modules) that are attached to a domain. Although we don't go into much detail
    about the TPM, we do refer to it a bit in [Chapter 14](ch14.html "Chapter 14. TIPS").
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: '`vtpm-list` 子命令允许你列出附加到域的虚拟 TPM（可信平台模块）。尽管我们没有详细介绍 TPM，但我们确实在 [第 14 章](ch14.html
    "第 14 章。技巧") 中提到了它。'
