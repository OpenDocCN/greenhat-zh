["```\n\n// key initialization routine\n  unsigned char K[256]; // 0xFFFFC80 in flash\n  unsigned char S[256]; // 0x10000 in SDRAM\n\n  for( i = 0; i < 256; i++ ) {\n    S[i] = i;\n  }\n  j = 0;\n  for( i = 0; i < 256; i++ ) {\n    // RC-4 would do j = (j + K[i] + S[i]) % 256\n    j = (j + K[i] + S[j]) % 256;\n    // swap S[i], S[j]\n    temp = S[i];\n    S[i] = S[j];\n    S[j] = temp;\n  }\n\n  // decryption routine\n  unsigned char cipherText[16384]; // 0xFFFFA000 in FLASH\n  unsigned char plainText[16384];  // 0x400000   in SDRAM\n\n  for( index = 0x4000, i = 0, k = 0; index > 0; indexâ€” ) {\n    // xbox version\n    t = (S[i] ^ cipherText[k]) % 256;\n    plainText[k] = t;\n\n    // swap( S[i], S[t] );\n    temp = S[i];\n    S[i] = S[t];\n    S[t] = temp;\n    i = (i + 1) % 256;\n    k++;\n  }\n\n```"]