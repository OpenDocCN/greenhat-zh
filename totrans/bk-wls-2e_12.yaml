- en: Chapter 12. WIRELESS NETWORK SECURITY
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '![WIRELESS NETWORK SECURITY](tagoreillycom20090210nostarchimages255004.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Wireless networks are not secure. Let me repeat that: Wireless networks are
    not secure. They are safe enough for many users most of the time, but it''s just
    not possible to make a network that uses radio to exchange data absolutely private.'
  prefs: []
  type: TYPE_NORMAL
- en: Wireless networks are a trade-off between security and convenience. The obvious
    benefits of a wireless network connection—fast and easy access to the network
    from a portable computer or an isolated location—come at a cost. For most users,
    the convenience of wireless operation outweighs the potential security threats.
    But just as you lock the doors of your car when you park it on the street, you
    should take similar steps to protect your network and your data.
  prefs: []
  type: TYPE_NORMAL
- en: The simple truth is that a wireless network uses radio signals with a well-defined
    set of characteristics, so somebody who wants to dedicate enough time and effort
    to monitoring those signals can probably find a way to intercept and read the
    data contained in them. If you send confidential information through a wireless
    link, an eavesdropper can copy it. Credit card numbers, account passwords, and
    other personal information are all vulnerable.
  prefs: []
  type: TYPE_NORMAL
- en: An entire catalog of tools for cracking Wi-Fi encryption methods is easy to
    find on the Internet. 3G broadband and WiMAX networks might be more secure than
    Wi-Fi ones (primarily because capturing data from them is more difficult), and
    WPA encryption is better than WEP encryption, but no wireless security is perfect.
    Encryption and other security methods can make data a little more difficult to
    steal, but they don't provide complete protection against a really dedicated snoop.
    As any policeman will tell you, locks are great for keeping out honest people,
    but serious thieves know how to get past them.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '*Wireless network encryption (such as WPA or WEP) takes place at the data layer
    of the OSI model (discussed in [Chapter 1](ch01.html "Chapter 1. INTRODUCTION
    TO NETWORKING")). The encryption is performed on all data that is sent across
    the network. Other encryption methods are also available: VPNs (virtual private
    networks) operate above the TCP layer and can provide additional encryption, and
    SSL (which secures HTTPS website traffic) is specific to the application*.'
  prefs: []
  type: TYPE_NORMAL
- en: To make things even more dangerous, many network managers and home wireless
    users leave the doors and windows to their networks wide open to intruders by
    failing to use encryption and the other security features that are built into
    every Wi-Fi access point and network node. "Drive-by logins" to unprotected private
    networks are possible in many urban and suburban business districts and in a surprising
    number of residential neighborhoods. When Wi-Fi was still a new technology, the
    *San Francisco Chronicle* reported that a network security expert with a directional
    antenna mounted on the roof of a van in downtown San Francisco could log in to
    an average of half a dozen wireless networks *per block*. That number would be
    much greater today. A year later, a group of Microsoft employees who ran an "unofficial"
    test found more than 200 unprotected access points in a suburban neighborhood
    outside Seattle. Today, most people have gotten the message about using encryption
    on their home and office networks, but too many of them are still using the older
    WEP encryption system rather than the much more secure WPA method. The technical
    support people at one major telephone company, Qwest, were still advising their
    DSL customers to use WEP encryption as late as mid-2007.
  prefs: []
  type: TYPE_NORMAL
- en: If you're located in a city center or a suburb, you can probably see this for
    yourself. When you use your Wi-Fi control program to scan the networks in your
    neighborhood, you will probably see a list of nearby networks in addition to your
    own access point. The control program will also tell you what kind of encryption
    (if any) each network is using. In the example shown in [Figure 12-1](ch12.html#four_of_the_networks_in_this_neighborhoo
    "Figure 12-1. Four of the networks in this neighborhood require an encryption
    key before they will connect."), one network (RedGoldandGreen) is wide open, and
    four others are encrypted; two of the encrypted networks use WPA, and the two
    that are listed as "security-enabled" without an encryption type use WEP.
  prefs: []
  type: TYPE_NORMAL
- en: 'Do the math: your access point has a range of 150 feet or more in all directions,
    so the signal probably extends beyond your own property lines (or the walls of
    your apartment or office). A network device in the building next door or across
    the street can probably detect your network. And so can a laptop or PDA inside
    a car parked on the street. If you don''t take some precautions to prevent it,
    the operator of that device can log in to your LAN, steal files from your servers,
    and tie up your Internet connection with streaming videos or multiplayer games.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Four of the networks in this neighborhood require an encryption key before
    they will connect.](tagoreillycom20090210nostarchimages254511.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 12-1. Four of the networks in this neighborhood require an encryption
    key before they will connect.**'
  prefs: []
  type: TYPE_NORMAL
- en: It's important to understand that we're talking about two different kinds of
    security threats to a wireless network. The first is the danger of an outsider
    connecting to your network without your knowledge or permission; the second is
    the possibility that a dedicated eavesdropper can steal or modify data as you
    send and receive it. Each represents a different potential problem, and each requires
    a different approach to prevention and protection. While it's certainly true that
    none of the encryption tools currently available can provide complete protection,
    they can make life more difficult for most casual intruders. And as long as they're
    out there, you might as well use them.
  prefs: []
  type: TYPE_NORMAL
- en: An unsecured wireless network presents many opportunities to an attacker. Not
    only are the network crackers able to monitor any data that moves through the
    network, but they might also be able to modify it. If, for example, there is a
    vulnerability in your web browser, an attacker can replace images as you view
    them with an image that exploits that vulnerability and installs a trojan on your
    computer, allowing the attacker to steal data stored on the computer that *you
    never sent over the wireless network*. This type of attack might be relatively
    rare (casual snoopers are unlikely to take the time on the chance you have something
    interesting), but it still presents a serious risk. Also, many popular websites
    encrypt the login page with SSL encryption via HTTPS, but they don't encrypt subsequent
    pages to reduce the drain on processing power—your password might be secure, but
    any email you read via the webmail interface might not be, and attackers might
    be able to steal the cookie (a unique piece of data included with web information)
    that identifies your login and access your mailbox directly.
  prefs: []
  type: TYPE_NORMAL
- en: Protecting Your Network and Your Data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As the operator of a Wi-Fi network, what can you do to discourage intruders?
    There are a few techniques that can make things difficult for them. First, you
    can accept the fact that wireless networks are not completely secure and use the
    built-in network security features to slow down would-be intruders; second, you
    can supplement your wireless router's built-in tools with a hardware or software
    firewall (or both) to isolate the wireless network; and third, you can deploy
    additional encryption such as a VPN to secure traffic to the network.
  prefs: []
  type: TYPE_NORMAL
- en: The security features of the early Wi-Fi protocols (WEP encryption) were not
    adequate to protect data. The WEP protocol was flawed in several ways. The basic
    encryption method (the RC4 algorithm) was known to have weaknesses in certain
    applications, it required all users to know the key, and provided no secure mechanisms
    for distributing new keys. Most of these shortcomings were acknowledged and dismissed
    as being outside the scope of the goal of providing the same protection that a
    user on a standard wired network would receive, but, in fact, the result was that
    wireless equivalent privacy was little better than no protection at all. Recent
    attacks (such as those performed by the aircrack-ptw tool) have further undermined
    WEP because they've often been able to disclose an encryption key in a matter
    of minutes by analyzing a limited amount of traffic. With these developments,
    WEP should be treated more as a "do not disturb" sign than as a real means of
    protection.
  prefs: []
  type: TYPE_NORMAL
- en: The WPA and WPA2 standards attempt to fix the shortcomings of WEP, but they
    only work when all of the users of a network have modern cards and drivers. Most,
    if not all, cards made in the last few years will support WPA or WPA2.
  prefs: []
  type: TYPE_NORMAL
- en: For most of us, the more serious danger is not that people will eavesdrop on
    our messages, but that they will create their own connection to our network and
    either read files stored on computers on the LAN or steal the broadband connection
    to the Internet without our knowledge. However, business networks must take extra
    precautions to protect their (and their customers') data. Several high-profile
    compromises of customer credit card data in major retail chains have been traced
    to inadequate network protection.
  prefs: []
  type: TYPE_NORMAL
- en: 'It''s essential to maintain control of your network. Here are some specific
    steps to take:'
  prefs: []
  type: TYPE_NORMAL
- en: Don't use your access point's default SSID. Those defaults are well known to
    network crackers.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Change the SSID to something that doesn't identify your business or your location.
    If an intruder detects something called BigCorpNet and they look around to see
    BigCorp headquarters across the street, they'll home right in on that network.
    Same thing for a home network; don't use your family name or the street address
    or anything else that makes it easy to figure out where the signal is coming from.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Don't use an SSID that makes your network sound like it contains some kind of
    fascinating content—use a boring name like, oh, *network5*, or even a string of
    gibberish, such as *W24rnQ*. If a would-be cracker sees a list of nearby networks,
    yours should look like it's the least interesting of the lot.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Change your access point''s IP address and password. The factory default passwords
    for most access point configuration tools are easy to find (and they''re often
    the same from one manufacturer to another—hint: don''t use *admin*), so they''re
    not even good enough to keep out your own users, let alone unknown intruders who
    want to use your network for their own benefit. If an outsider gets into the access
    point''s software, they could lock you out of your own network by changing the
    password and the encryption key.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If possible, place your indoor access point in the middle of the building rather
    than close to a window. This will reduce the distance that your network signals
    will extend beyond your own walls.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Use WPA encryption rather than WEP. WPA encryption is a lot more difficult to
    break, especially if you use a complex encryption key.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Change your encryption keys often. It takes time to sniff encryption keys out
    of a data stream; every time the keys change, the miscreants trying to steal your
    data are forced to start again from scratch. Once or twice every month is not
    too often to change keys in a home network. An office LAN should change keys at
    least once a week.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Don't store your encryption keys in plaintext on the network where they are
    used. This seems obvious, but in a widespread network, it might be tempting to
    distribute them on a private web page or in a text file. Don't do it.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Don't use email to distribute encryption keys. Even if you're not sending emails
    in plaintext, an intruder who has stolen account names and passwords will receive
    the messages with your new codes before your legitimate users get them.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Add another layer of encryption, such as Kerberos, on top of the encryption
    built into the wireless network. See [http://web.mit.edu/kerberos/www](http://web.mit.edu/kerberos/www)
    and [http://www.isi.edu/~brian/security/kerberos.html](http://www.isi.edu/~brian/security/kerberos.html)
    for downloads and more information about Kerberos.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If it's practical on your network, turn on the access control feature in your
    access point. Access control restricts network connections to network clients
    with specified MAC addresses. The access point will refuse to associate with any
    adapter whose address is not on the list. This might not be practical if you want
    to allow visitors to use your network, but it's a useful tool in a home or small
    business network where you know all of your potential users. MAC address filtering
    will not prevent a determined attacker from copying the address of an authenticated
    user, but it could provide an additional layer of protection.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Test your network's security by trying to find and use your network from outside
    your own building. Take a laptop computer running a sniffer program, such as NetStumbler
    or your network adapter's control program, and start walking away from the building.
    If you can detect your network from a block away, so can an intruder.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Turn on the security features, but treat the network as if it was wide open
    to public access. Make sure everybody using the network understands that they're
    using a nonsecure system.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Limit file shares to the files that you really want to share; don't share entire
    drives. Use password protection on every share.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Use the same firewall and other security tools that you would use on a wired
    network. At best, the wireless portion of your LAN is no more secure than the
    wired part, so you should take all the same precautions.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Consider using a VPN for added security.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Protecting Your Computer
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Network security goes both ways—the network manager doesn't want unauthorized
    users messing with the network, and individual users don't want anybody to get
    to their personal files. When you're logged in to a public network, you should
    take some precautions to prevent anybody else on the network from reading your
    files.
  prefs: []
  type: TYPE_NORMAL
- en: 'In Windows Vista and Windows XP, there isn''t a central place to turn off file
    shares, so you must turn off each share separately. Follow these steps to turn
    off sharing:'
  prefs: []
  type: TYPE_NORMAL
- en: Open the **My Computer** window.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The icons for some or all of your shared drives and folders might appear with
    a hand "serving" the icon. To turn off sharing, right-click the icon and choose
    **Sharing and Security** from the menu.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Turn off the **Share this folder on the network** option.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the **OK** button to close the dialog box. When the My Computer window
    appears, the sharing hand will no longer be under the name of the folder or drive
    letter.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Repeat the process for every shared folder or file. Don't forget the Shared
    Documents folder.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: When you get back to your own office or home network, you'll have to reverse
    the procedure to start sharing your files again.
  prefs: []
  type: TYPE_NORMAL
- en: What about the danger of somebody grabbing your data as it passes through the
    radio link? It can be done, even if you're using encryption. You have to assume
    that any data transmitted through a wireless network is not secure. A determined
    eavesdropper with the right equipment and software can copy your data packets
    as they move through the air. It's possible, but it's not likely unless you are
    a target of government surveillance or industrial espionage.
  prefs: []
  type: TYPE_NORMAL
- en: The only way to be absolutely sure that nobody is monitoring your wireless network
    is to stop using it. But it's even easier to monitor the cordless phone in your
    kitchen. In general, you can assume that a connection through a public network
    is no more or less secure than a link to your own network. If somebody is serious
    about stealing your network packets, they will probably find a way to do it.
  prefs: []
  type: TYPE_NORMAL
- en: Wi-Fi Security Tools
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The security tools in the Wi-Fi specifications aren't perfect, but they're better
    than nothing. Even if you choose not to use them, it's essential to understand
    what they are and how they work, if only to turn them off.
  prefs: []
  type: TYPE_NORMAL
- en: Network Name (SSID)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As you learned in [Chapter 3](ch03.html "Chapter 3. HOW WI-FI WORKS"), every
    wireless network has a name. In a network with just one access point, the name
    is the basic service set ID (BSSID). When the network has more than one access
    point, the name becomes the extended service set ID (ESSID), but your computer's
    control program displays both types in the same list. The generic designation
    for all network names is the SSID, which is the term you will see most often in
    wireless access point and client configuration utility programs.
  prefs: []
  type: TYPE_NORMAL
- en: When you configure the access points for a network, you must specify the SSID
    for that network. Every access point and network client in a network must use
    the same SSID.
  prefs: []
  type: TYPE_NORMAL
- en: When a network client detects two or more access points with the same SSID,
    it assumes that they are all part of the same network (even if the access points
    are operating on different radio channels), and it associates with the access
    point that provides the strongest or cleanest signal. If that signal deteriorates
    due to interference or fading, the client will try to shift to another access
    point on what it thinks is the same network. This transfer is called a *hand off*.
  prefs: []
  type: TYPE_NORMAL
- en: If two different networks with overlapping signals have the same name, a client
    will assume that they're both parts of a single network, and it might try to perform
    a hand off from one network to the other. From the user's point of view, this
    misdirected hand off will look as if the network has completely dropped its connection.
    Therefore, every wireless network that could possibly overlap with another network
    must have a unique SSID.
  prefs: []
  type: TYPE_NORMAL
- en: The exceptions to the unique SSID rule are public and community networks that
    only provide access to the Internet but not to other computers or other devices
    on a LAN. Those networks often have a common SSID, so subscribers can detect and
    connect to them from more than one location. In other words, if you have an Internet
    access account at your local coffee shop, you might find and use exactly the same
    SSID when you visit another shop owned by the same company.
  prefs: []
  type: TYPE_NORMAL
- en: A network's SSID provides a very limited form of access control because it's
    necessary to specify the SSID when you set up a wireless connection. The SSID
    option in an access point is always a text field that will accept any name you
    care to assign, but many network configuration programs (including the wireless
    network tools in Windows XP and those supplied with several major brands of network
    adapters) automatically detect and display the SSIDs of every active network within
    their signal range.
  prefs: []
  type: TYPE_NORMAL
- en: It's not always necessary to know the SSID of a network before you try to connect;
    the configuration utility (or a network monitor or sniffer program like NetStumbler)
    will show you the names of every nearby network in a list or a menu (the exceptions
    are networks in which the Broadcast SSID feature has been turned off). For example,
    [Figure 12-2](ch12s02.html#netstumbler_and_many_configuration_utili "Figure 12-2. NetStumbler
    and many configuration utilities display the SSIDs of every nearby wireless network.")
    shows the result of a NetStumbler scan at Seattle-Tacoma Airport, where Wayport
    served the passenger terminal and MobileStar provided coverage in the American
    Airlines VIP club.
  prefs: []
  type: TYPE_NORMAL
- en: '![NetStumbler and many configuration utilities display the SSIDs of every nearby
    wireless network.](tagoreillycom20090210nostarchimages254581.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 12-2. NetStumbler and many configuration utilities display the SSIDs
    of every nearby wireless network.**'
  prefs: []
  type: TYPE_NORMAL
- en: Warning
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '*Every access point comes with a default SSID setting. These defaults are well
    known and documented within the community of network snoops (see, for example,
    the lists of access points and defaults compiled by members of* [SeattleWireless.net](http://SeattleWireless.net)
    *at* [http://seattlewireless.net/arlan/ssid_defaults-1.0.5.txt](http://seattlewireless.net/arlan/ssid_defaults-1.0.5.txt)).
    *Obviously, the defaults should never be used in any active network. Make sure
    you change the access point''s administrative login and password while you''re
    at it*.'
  prefs: []
  type: TYPE_NORMAL
- en: Normally, most Wi-Fi access points send out beacon signals that broadcast the
    network's SSID. When a network adapter performs a radio scan, it detects those
    beacon signals and displays a list of nearby SSIDs in its control program.
  prefs: []
  type: TYPE_NORMAL
- en: However, it's possible to disable the SSID broadcast so the network doesn't
    show up on most control program scans. To connect a computer to a network whose
    name is not visible, you must instruct your control program to search for the
    relevant SSID.
  prefs: []
  type: TYPE_NORMAL
- en: Nonbroadcast SSIDs are not completely invisible. A sniffer program (such as
    NetStumbler) can still detect it and display the SSID, and every time a user connects
    to the network, the network adapter sends the SSID in a packet that can easily
    be sniffed. Disabling the SSID broadcast might, in some cases, make it easier
    for an intruder to later attack the laptop of one of your users (this is a more
    serious issue for businesses or corporate network administrators than for people
    running home networks). Because the laptop cannot know if the hidden network is
    available, it must constantly probe for it, announcing its presence and giving
    an attacker much of the information needed to spoof the hidden network. Because
    a hidden network must be in a laptop's Preferred Networks list, it will automatically
    connect to the spoofed network.
  prefs: []
  type: TYPE_NORMAL
- en: WEP Encryption
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: WEP encryption is an option in every Wi-Fi system, so it's important to know
    how it works, even if you choose not to use it. As the name suggests, the original
    intent of the wired equivalent privacy (WEP) protocol was to provide a level of
    security on wireless networks that was comparable to that of a wired network.
    That was the goal, but a network that depends on WEP encryption is almost as vulnerable
    to intrusion as a network with no protection at all. It will keep out the casual
    snoops (and your freeloading neighbors, if they're not particularly adept at cracking
    encryption), but it's not particularly effective against a dedicated intruder.
    The more recent WPA encryption is *always* the better choice.
  prefs: []
  type: TYPE_NORMAL
- en: 'WEP encryption is intended to serve three functions: it prevents unauthorized
    access to the network, it performs an integrity check on each packet, and it protects
    the data from eavesdroppers. WEP uses a secret encryption key to encode data packets
    before a network client or an access point transmits them, and it uses the same
    key to decode the packets after they have been received. The original standard
    used shared authentication, in which the access point sends a challenge packet
    that a client must encrypt with the proper WEP key and send back. However, this
    technique opens a significant vulnerability by allowing a snooper to watch both
    parts of the exchange and figure out the key. The "open" authentication method,
    which should be used by any network using WEP (not that any network should use
    it), simply discards packets that cannot be decrypted by the network''s WEP key.'
  prefs: []
  type: TYPE_NORMAL
- en: Therefore, the WEP settings must be exactly the same on every access point and
    client adapter in the network. This sounds simple enough, but it gets confusing
    because manufacturers use different methods to identify the size and format of
    a WEP key. The functions don't change from one brand to another, but identical
    settings don't always have identical descriptions.
  prefs: []
  type: TYPE_NORMAL
- en: How Many Bits in Your Encryption Key?
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: A WEP key can have either 64 bits or 128 bits. Although 128-bit keys are more
    difficult to crack (but they are still pretty insecure), they also increase the
    amount of time needed to transmit each packet. However, confusion arises because
    a 40-bit WEP key is the same as a 64-bit WEP key, and a 104-bit key is the same
    as a 128-bit key. The standard 64-bit WEP key is a string that includes an internally
    generated 24-bit initialization vector and a 40-bit secret key assigned by the
    network manager. Some manufacturers' specifications and configuration programs
    call this *64-bit encryption*, but others describe it as *40-bit encryption*.
    Either way, the encryption scheme is the same, so an adapter that uses 40-bit
    encryption is fully compatible with an access point or another adapter that uses
    64-bit encryption.
  prefs: []
  type: TYPE_NORMAL
- en: Many network adapters and access points also include a *strong encryption* option
    that uses a 128-bit key. Devices that support strong encryption are downward compatible
    with 64-bit encryption, but it's not automatic, so all of the devices on a mixed
    network of 128-bit and 64-bit devices will operate at 64 bits. If your access
    point and all of your adapters accept 128-bit encryption, use a 128-bit key. But
    if you want your network to be compatible with adapters and access points that
    only recognize 64-bit encryption, configure the entire network to use 64-bit keys.
  prefs: []
  type: TYPE_NORMAL
- en: In practice, the choice of 64- or 128-bit WEP encryption doesn't make much difference.
    Tools are easily available that can crack both types, although cracking a 128-bit
    key might take a bit longer.
  prefs: []
  type: TYPE_NORMAL
- en: Is Your Key ASCII or Hex?
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The length of the key is not the only confusing thing about setting WEP encryption.
    Some programs request the key as a string of ASCII characters, but many others
    want the key in hexadecimal (hex) numbers. Still others can generate the key from
    an optional passphrase.
  prefs: []
  type: TYPE_NORMAL
- en: Each ASCII character has 8 bits, so a 40-bit (or 64-bit) WEP key contains 5
    characters, and a 104-bit (or 128-bit) key has 13 characters. In hex, each character
    uses 4 bits, so a 40-bit key has 10 hex characters, and a 128-bit key has 26 characters.
    In [Figure 12-3](ch12s02.html#the_configuration_utility_for_a_d-link_a "Figure 12-3. The
    configuration utility for a D-Link access point accepts WEP keys in hex format."),
    the Wireless Setting screen for a D-Link access point, the 40-bit Shared Key Security
    field uses hex characters, so it has space for 10 characters. The D-Link program
    runs all 10 characters together in a single string, but some others split them
    into 5 sets of 2 digits or 2 sets of 5\. The key looks the same to the computer
    either way, but it's easier to copy the string when it's broken apart.
  prefs: []
  type: TYPE_NORMAL
- en: '![The configuration utility for a D-Link access point accepts WEP keys in hex
    format.](tagoreillycom20090210nostarchimages254411.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 12-3. The configuration utility for a D-Link access point accepts
    WEP keys in hex format.**'
  prefs: []
  type: TYPE_NORMAL
- en: A passphrase is a string of text that the adapters and access points automatically
    convert to a string of hex characters. Because humans can generally remember actual
    words or phrases more easily than hex gibberish, a passphrase can be easier to
    distribute than a hex string. However, a passphrase is only useful when all the
    adapters and access points in a network come from the same manufacturer.
  prefs: []
  type: TYPE_NORMAL
- en: What Are the Options?
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Like just about everything else in a Wi-Fi configuration utility, the names
    of the encryption options are not consistent from one program to the next. Some
    use a straightforward set of options such as "enable WEP (or WPA) encryption,"
    but others use technical language taken from the formal 802.11 specification.
  prefs: []
  type: TYPE_NORMAL
- en: Some access points also offer an optional shared key authentication option that
    uses encryption when a network client has the key, but uses unencrypted data with
    other network nodes.
  prefs: []
  type: TYPE_NORMAL
- en: Mixing Hex and ASCII Keys
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Setting up a mixed network becomes more complicated when some network nodes
    use hex only and others require ASCII keys. If that''s the situation in your network,
    you will want to follow these rules for setting the encryption keys:'
  prefs: []
  type: TYPE_NORMAL
- en: Convert all your ASCII keys to hex. If a configuration program demands an ASCII
    key, enter the characters *0x* (zero followed by lowercase letter *x*), followed
    by the hex string. If you're using Apple's AirPort software, you'll have to enter
    a dollar sign ($) at the beginning of a hex key.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Make sure all your encryption keys have exactly the right number of characters.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If all else fails, read the security sections of the manuals for your network
    adapters and access points. It's possible that one or more of the devices in your
    network has some obscure proprietary feature that you don't know about.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Is WEP Secure Enough To Use?
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Several academic computer scientists have published reports about WEP encryption
    that argue against trusting it to protect confidential data. They all point to
    serious flaws in the cryptographic theory and practice that were used to define
    the WEP encryption algorithms. These experts are unanimous in their recommendations:
    If you use an 802.11 wireless network, you cannot rely on WEP for security; you
    should employ WPA to protect your networks.'
  prefs: []
  type: TYPE_NORMAL
- en: 'A group at the University of California, Berkeley has identified numerous flaws
    in the WEP algorithm that make it vulnerable to at least four different kinds
    of attacks:'
  prefs: []
  type: TYPE_NORMAL
- en: Passive attacks that use statistical analysis to decrypt data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Active attacks that construct encrypted packets to mislead the access point
    into accepting false commands
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Attacks that analyze encrypted packets to construct a dictionary that can be
    used to automatically decrypt data in real time
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Attacks that alter packet headers to divert data to a destination controlled
    by the attacker
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The Berkeley report, which you can read online at [http://www.isaac.cs.berkeley.edu/isaac/wep-faq.html](http://www.isaac.cs.berkeley.edu/isaac/wep-faq.html),
    concludes with an unequivocal statement: "Wired Equivalent Privacy (WEP) isn''t.
    The protocol''s problems are a result of misunderstanding of some cryptographic
    primitives and therefore combining them in insecure ways."'
  prefs: []
  type: TYPE_NORMAL
- en: 'Researchers at Rice University and AT&T Labs published a description of their
    attack against WEP encrypted networks ([http://www.securitytechnet.com/resource/hot-topic/wlan/wep_attack.pdf](http://www.securitytechnet.com/resource/hot-topic/wlan/wep_attack.pdf))
    that led them to a similar opinion: "802.11 WEP is totally insecure." They were
    able to order and receive the necessary hardware, set up a network for testing,
    design their attack tool, and successfully capture a 128-bit WEP key in less than
    a week.'
  prefs: []
  type: TYPE_NORMAL
- en: Both the Berkeley and the AT&T Labs reports are written by and for technical
    experts who have a background in cryptography. Their conclusions are clear, but
    their methods assume that an intruder has some serious technical knowledge. However,
    it doesn't take a network expert to crack WEP encryption; tools for less sophisticated
    code breakers are also easy to find. Both AirSnort (from the Shmoo Group, [http://airsnort.shmoo.com](http://airsnort.shmoo.com))
    and WEPCrack ([http://sourceforge.net/projects/wepcrack](http://sourceforge.net/projects/wepcrack))
    are Linux programs that monitor wireless network signals and exploit the weaknesses
    in the WEP algorithm to extract the encryption key. There are dozens of others.
    Just a few minutes with Google or any other Internet search tool is all it takes
    to find WEP cracking tools and detailed instructions for using them.
  prefs: []
  type: TYPE_NORMAL
- en: Recently announced attacks against WEP, implemented in tools such as aircrack-ptw,
    can break WEP keys in a matter of minutes using a very limited amount of data—sometimes
    as little as 10 megabytes of data gathered from a single network user and a few
    seconds of processing on a modern laptop.
  prefs: []
  type: TYPE_NORMAL
- en: 'Bottom line: Go ahead and encrypt your network data, but use WPA rather than
    WEP if you possibly can. Encrypted data is more secure than plaintext transmission,
    and it takes time to crack a WEP key, so WEP does add another (extremely weak)
    layer of security, especially if you change keys frequently. WEP encryption might
    not do much to protect you against serious attackers, but it will probably keep
    out the casual network eavesdropper who stumbles onto your network from across
    the street and the drive-by network snoop. It''s a lot easier to break into an
    unencrypted network (and there are still plenty of them out there), so a cracker
    who detects your encrypted signal will probably move on to a target with less
    protection.'
  prefs: []
  type: TYPE_NORMAL
- en: WPA Encryption
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: WPA encryption was developed as a partial solution to the security problems
    that make WEP encryption less than totally secure. WPA is much safer than WEP,
    but cracking WPA is still possible.
  prefs: []
  type: TYPE_NORMAL
- en: WPA is more secure because it uses a method called *Temporal Key Integrity Protocol
    (TKIP)* to automatically change the encryption key after a specified period of
    time or after the system exchanges a specific number of packets. Because WPA changes
    the key frequently, it's a lot more difficult for a cracker to gather enough information
    to decipher its encryption code.
  prefs: []
  type: TYPE_NORMAL
- en: In large networks, WPA uses an authentication server to verify the identity
    of each network user. The server uses Remote Authentication Dial-in User Service
    (RADIUS) and the Extensible Authentication Protocol (EAP) to exchange encryption
    keys with the computers and other devices that are connected to the wireless network.
  prefs: []
  type: TYPE_NORMAL
- en: In home networks and smaller business networks that don't have a server, a method
    called *pre-shared key (PSK) mode* uses a passphrase stored in the access point
    in place of the authentication server. To connect to the network, users must enter
    the same passphrase on their computers or other network devices (or set their
    devices to automatically enter the passphrase). When you set up WPA encryption,
    you must specify whether the network uses a server or PSK mode.
  prefs: []
  type: TYPE_NORMAL
- en: Any access point and network adapter that supports 802.11g or 802.11n should
    also recognize WPA encryption. If you're using an older 802.11b or 802.11a access
    point, it might still be possible to add WPA encryption by installing the latest
    versions of firmware and drivers. Look in the support or downloads section of
    the manufacturer's website for free upgrade instructions and software.
  prefs: []
  type: TYPE_NORMAL
- en: PSK Passphrases
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: A WPA-PSK passphrase can be a string of either 8 to 63 ASCII characters or 64
    hexadecimal digits. The passphrase that you enter into a network device must be
    exactly the same as the one stored in the access point. Obviously, typing 64 digits
    correctly is not something that you want to do frequently, so the ASCII alternative
    is the better choice for most users. For optimal security, the ASCII passphrase
    you assign to your network should be a random mixture of at least 20 characters
    including letters (capitals and lower case), numbers, and punctuation marks.
  prefs: []
  type: TYPE_NORMAL
- en: A PSK network uses the passphrase to set up the initial connection between a
    client (such as a computer or PDA) and the access point. After the connection
    is in place, the TKIP assigns new encryption keys to every packet or group of
    packets.
  prefs: []
  type: TYPE_NORMAL
- en: The PSK combines with your network SSID to calculate the final key value. It
    is important to choose a unique SSID and a strong passphrase. Attackers can build
    large tables of SSID and PSK pairs for common network names and dictionary words,
    performing weeks of calculation once with the payoff of nearly instantly determining
    the key of any network that matches that pair of values. Choosing strong passphrases
    and unique SSIDs can mitigate this type of attack.
  prefs: []
  type: TYPE_NORMAL
- en: Using WPA Encryption
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: When you set up a new network, the security section of the access point's configuration
    software will ask if you want to use encryption, and if so, whether you want WEP
    or WPA encryption. Unless you're planning to run an open-access network, you should
    choose WPA.
  prefs: []
  type: TYPE_NORMAL
- en: In many cases, the access point will offer two or more types of WPA encryption.
    If your network includes a RADIUS server, choose EAP. If the network has no encryption
    server, use the WPA-TKIP option.
  prefs: []
  type: TYPE_NORMAL
- en: For a network user, providing a WPA key is just as easy as providing a WEP key.
    Most network adapters made in the last few years automatically recognize the type
    of encryption embedded in each Wi-Fi signal that they detect, so the control program
    might ask for an encryption key without specifying whether it's a WEP key or a
    WPA key.
  prefs: []
  type: TYPE_NORMAL
- en: WPA Security
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: It was probably inevitable that somebody would take the added security features
    in WPA encryption as a challenge and develop a WPA cracking tool. Several such
    tools are out there, so WPA does not provide the impenetrable protection that
    some of its proponents might want you to believe. In particular, programs called
    coWPAtty and Aircrack-ng both use *dictionary attacks* on WPA-TKIP networks to
    try thousands or millions of possible keys until it finds the correct ones. Because
    each additional letter, number, or other character in a key increases the key's
    complexity, a long key takes much longer to crack than a short one. This kind
    of cracking technique takes time because the programs can only try about 50 different
    encryption keys per second, but eventually, they will find the right passphrase
    and connect to the target network.
  prefs: []
  type: TYPE_NORMAL
- en: Fortunately, neither of these programs or any of the others aimed at cracking
    WPA encryption are easy to use, and they can take a lot of time to crack a network,
    so successful attacks on WPA are not particularly common. It might not be possible
    or practical to completely protect yourself against attacks, but a long passphrase
    that includes random numbers and punctuation marks in odd places is usually a
    better choice than a string of words or numbers alone. In other words, something
    like *hdt%mzx33wolf$fgilxxq&#smedbxor* is a better passphrase than *nostarchpressbooks*.
  prefs: []
  type: TYPE_NORMAL
- en: Access Control (MAC Authentication)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Most access points include an option that permits the network manager to restrict
    access to a specific list of client adapters. If a network device with a MAC address
    that does not appear on the list of authorized users tries to connect, the access
    point will not accept the request to associate with the network. This can keep
    intruders from connecting to a wireless LAN, but it forces the network administrator
    to keep a complete list of users' adapters and their MAC addresses. Every time
    a new user wants to join the network, and every time an established user swaps
    adapters or gets a new laptop, PDA, or other device with a built-in adapter, the
    network manager must add one more MAC address to the list. This is probably manageable
    in a home or small office network, but it could be a major undertaking for a larger
    corporate or campus-wide system, if it's practical at all.
  prefs: []
  type: TYPE_NORMAL
- en: MAC authentication does not provide unbreakable protection against unauthorized
    users because a determined cracker could monitor radio signals from approved users,
    intercept their adapters' MAC addresses, and load an approved address onto a different
    adapter. But combined with encryption and other security tools, authentication
    adds one more impediment in the path of a network cracker.
  prefs: []
  type: TYPE_NORMAL
- en: Every access point configuration utility uses a different format for its access
    lists. The manual and online documentation supplied with your access point should
    provide detailed instructions for creating and maintaining an access control list.
  prefs: []
  type: TYPE_NORMAL
- en: The Wi-Fi standards do not specify a maximum size for an access point's access
    control list, so the numbers are all over the map. Some access points limit the
    list to a few dozen entries, but others, such as the Proxim Harmony AP Controller,
    will support as many as 10,000 separate addresses. Still others accept an unlimited
    number. If you plan to use a list of addresses to control access to your network,
    make sure your access point will work with a large enough list to support all
    of your users, with enough expansion space for future growth. As a rule of thumb,
    the access point should accept at least twice as many MAC addresses as the number
    of users on your network today.
  prefs: []
  type: TYPE_NORMAL
- en: Some access points also include a MAC address exclusion feature that allows
    the network manager to block one or more MAC addresses from access to the network.
  prefs: []
  type: TYPE_NORMAL
- en: Virtual Private Networks
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Virtual private networks can add one more layer of useful security by isolating
    the connection between network nodes from other network traffic. A VPN is an encrypted
    transmission channel that connects two network endpoints through a "data tunnel."
    Many network security experts recommend a VPN as an effective way to protect a
    wireless network from eavesdroppers and unauthorized users. You can find more
    detailed information about setting up and using a VPN in [Chapter 15](ch15.html
    "Chapter 15. VIRTUAL PRIVATE NETWORKS").
  prefs: []
  type: TYPE_NORMAL
- en: 'Authentication: The 802.1x Standard'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Because of the security gaps in the WEP encryption specification, many wireless
    network equipment manufacturers and software developers have adopted yet another
    IEEE standard, 802.1x, to add another layer of security to their networks. The
    802.1x standard defines a structure that can support several additional forms
    of authentication, including certificates, smart cards, and one-time passwords,
    all of which offer more protection than the access control built into 802.11\.
    In 802.11 networks, a technique called the Robust Security Network builds upon
    the 802.1x framework to restrict network access to authorized devices.
  prefs: []
  type: TYPE_NORMAL
- en: 'Most end users need to know two things about 802.1x: First, it''s built into
    some (but not all) Wi-Fi hardware and software, including the wireless configuration
    utility supplied with Windows XP and many recent access point products, so it
    can provide one more potential layer of security; and second, it has serious flaws
    that a dedicated network cracker can exploit to break into a wireless network.
    The ugly technical details are in an analysis prepared by two researchers at the
    University of Maryland, available online at [http://www.cs.umd.edu/~waa/1x.pdf](http://www.cs.umd.edu/~waa/1x.pdf).'
  prefs: []
  type: TYPE_NORMAL
- en: Firewalls
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: If you accept the idea that encryption and 802.1x do not provide adequate protection
    for a wireless LAN, the next logical step is to find another way to keep intruders
    out of your network. You also need a firewall.
  prefs: []
  type: TYPE_NORMAL
- en: A firewall is a proxy server that filters all the data that passes through it
    on the way to or from a network, based on a set of rules established by the network
    manager. For example, a firewall might reject data from an unknown source or files
    that match a particular source (such as a virus). Or it might pass all data moving
    from the LAN *to* the Internet, but only allow certain types of data *from* the
    Internet. The most common use of a firewall in a LAN is at the gateway to the
    Internet, as shown in [Figure 12-4](ch12s03.html#a_network_firewall_isolates_a_lan_from_t
    "Figure 12-4. A network firewall isolates a LAN from the Internet."). The firewall
    monitors all inbound and outbound data between the computers on the local network
    on one side and the Internet on the other. This kind of firewall is intended to
    protect the computers on the LAN from unauthorized access from the Internet.
  prefs: []
  type: TYPE_NORMAL
- en: '![A network firewall isolates a LAN from the Internet.](tagoreillycom20090210nostarchimages254013.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 12-4. A network firewall isolates a LAN from the Internet.**'
  prefs: []
  type: TYPE_NORMAL
- en: In a wireless network, a firewall can also be placed at the gateway between
    the wireless access points and the wired network. This firewall isolates the wireless
    portion of the network from the wired LAN, so intruders who have connected their
    computers to the network without permission can't use the wireless connection
    to reach the Internet or the wired part of the LAN. [Figure 12-5](ch12s03.html#a_firewall_in_a_wireless_lan_can_act_as_
    "Figure 12-5. A firewall in a wireless LAN can act as a protected gateway to the
    wired portion of the same network.") shows the location of a firewall in a wireless
    network.
  prefs: []
  type: TYPE_NORMAL
- en: '![A firewall in a wireless LAN can act as a protected gateway to the wired
    portion of the same network.](tagoreillycom20090210nostarchimages254059.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 12-5. A firewall in a wireless LAN can act as a protected gateway
    to the wired portion of the same network.**'
  prefs: []
  type: TYPE_NORMAL
- en: Keep Wireless Intruders at Bay
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Most people who try to tap into a wireless network don't care about the other
    computers on the local network; they're looking for free high-speed access to
    the Internet. If they can't use your network to download files or connect to their
    favorite web pages, they'll probably move on to find some other unprotected wireless
    hot spot. That doesn't mean you should store confidential data in file shares
    on unprotected computers, but if you can limit or restrict access to the Internet,
    it will make your wireless network a lot less attractive to intruders.
  prefs: []
  type: TYPE_NORMAL
- en: 'A firewall in a wireless network can perform several functions: It acts as
    a gateway router between the wireless network and a wired LAN or a direct connection
    to the Internet, blocking all traffic moving from the wireless side to the wired
    network that doesn''t come from an authenticated user, but it does not interfere
    with commands, messages, and file transfers from trusted users. Therefore, a legitimate
    user can connect to network nodes on the wired part of a mixed LAN or onto the
    Internet, but an intruder would be cut off at the firewall.'
  prefs: []
  type: TYPE_NORMAL
- en: Because authorized users and intruders are both on the unprotected side of the
    firewall, it does not isolate wireless nodes from one another. An intruder can
    still gain access to another computer on the same wireless network and read shared
    files, so it's a good idea to turn off file sharing in any computer connected
    to a wireless network.
  prefs: []
  type: TYPE_NORMAL
- en: A firewall for a wireless network should use some kind of authentication to
    allow legitimate users through the gateway, but it should reject everybody else.
    If the access control based on MAC addresses is built into Wi-Fi networks, and
    the added authentication in 802.1x is not adequate, then an outboard firewall
    should require each user to enter a login and password before they can connect
    to the Internet.
  prefs: []
  type: TYPE_NORMAL
- en: If your wireless network includes computers running more than one operating
    system, your firewall must use a login tool that works on any platform. The easiest
    way to accomplish this is with a web-based authentication server, such as the
    one included in the Apache webserver ([http://httpd.apache.org](http://httpd.apache.org)).
  prefs: []
  type: TYPE_NORMAL
- en: The Apache webserver is available as a Unix application that can run on an old,
    slow computer with an early Pentium, or even a 486 CPU, so it's often possible
    to recycle an old junker that is no longer in daily service and use it as a firewall.
    Both the Apache application and a Unix operating system are available as open
    source software, so it ought to be possible to build an Apache firewall at extremely
    low cost.
  prefs: []
  type: TYPE_NORMAL
- en: If you prefer to use Windows rather than Unix, or if you don't want to assemble
    your own firewall, you have several options. You can use the Windows version of
    Apache, or you can use a commercial utility such as the ones listed at [http://www.thegild.com/firewall](http://www.thegild.com/firewall).
  prefs: []
  type: TYPE_NORMAL
- en: Isolate Your Network from the Internet
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Attacks on a wireless LAN don''t all come through the air. A wireless network
    also requires the same kind of firewall protection against attacks from the Internet
    as every other network. Many access points include configurable firewall features,
    but if yours does not, the network should include one or more of these firewalls:'
  prefs: []
  type: TYPE_NORMAL
- en: A firewall program on each computer
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A separate router or a dedicated computer acting as a network firewall
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Client firewall programs provide another line of defense against attacks through
    the Internet from outside your own network. Some of these attacks come from miscreants
    who are looking for a way to read your files and other resources that you don't
    want the entire world to see. Others might want to use your computer as a relay
    point for spam or attempts to break into some other computer halfway around the
    world in order to make the real source more difficult to identify. Still others
    spread viruses or use Really Unpleasant programs that take over control of a PC
    and display threatening messages. An unprotected system with a lot of unused storage
    space can be an attractive target for hackers who want to distribute pirated software,
    music, or video files (you don't think they store that stuff on their own computers,
    do you?).
  prefs: []
  type: TYPE_NORMAL
- en: The number of such idiots and creeps out on the Internet is surprisingly large;
    if you install a firewall that notifies you when an outside computer tries to
    connect to your network, you will probably see several break-in attempts every
    day.
  prefs: []
  type: TYPE_NORMAL
- en: Access Points with Firewalls
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The easiest firewall to use with a wireless network is one that's built into
    an access point, such as the D-Link DI-524 Wireless Router (shown in [Figure 12-6](ch12s03.html#the_d-link_di-524_wireless_broadband_rou
    "Figure 12-6. The D-Link DI-524 Wireless Broadband Router contains configurable
    firewall firmware.")) and similar products from other manufacturers. This model
    combines the functions of a wireless access point with a broadband router and
    an Ethernet switch, so it supports both wired and wireless network clients.
  prefs: []
  type: TYPE_NORMAL
- en: '![The D-Link DI-524 Wireless Broadband Router contains configurable firewall
    firmware.](tagoreillycom20090210nostarchimages254967.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 12-6. The D-Link DI-524 Wireless Broadband Router contains configurable
    firewall firmware.**'
  prefs: []
  type: TYPE_NORMAL
- en: As you know, a network router provides translation services between the numeric
    IP address that identifies the LAN to the Internet and the internal IP addresses
    that identify individual computers within the local network. The firewall normally
    blocks all incoming requests for data to network hosts, but this creates problems
    when you want to use one or more of the computers on the local network as fileservers.
    So the firewall includes a virtual server that redirects certain types of requests
    to the appropriate computer inside the firewall.
  prefs: []
  type: TYPE_NORMAL
- en: Each request for connection to a server includes a specific port number that
    identifies the type of server. For example, webservers operate on port 80, and
    FTP servers use port 21, so those port numbers are part of the request for access.
    To accept requests for access to a server, you must instruct the firewall's Network
    Address Translation (NAT) function to forward those requests to a specific computer
    within the LAN. In [Figure 12-7](ch12s03.html#the_d-link_access_point_directs_requests
    "Figure 12-7. The D-Link access point directs requests for access to fileservers
    to specific computers within the network."), the virtual server is configured
    to use the computer with the local IP address 192.168.0.177 as a webserver and
    192.168.0.164 as an FTP fileserver. [Table 12-1](ch12s03.html#common_tcpip_service_port_numbers
    "Table 12-1. Common TCP/IP Service Port Numbers") lists the most common service
    port numbers.
  prefs: []
  type: TYPE_NORMAL
- en: '![The D-Link access point directs requests for access to fileservers to specific
    computers within the network.](tagoreillycom20090210nostarchimages254272.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 12-7. The D-Link access point directs requests for access to fileservers
    to specific computers within the network.**'
  prefs: []
  type: TYPE_NORMAL
- en: Hundreds of other port numbers have been assigned, but you will never see most
    of them in actual use. The official list of port assignments is online at [http://www.iana.org/assignments/port-numbers](http://www.iana.org/assignments/port-numbers).
  prefs: []
  type: TYPE_NORMAL
- en: NAT translation assumes that the IP addresses of each virtual server don't change
    from one request to the next. A webserver on 192.168.0.23 today won't migrate
    to 192.168.0.47 next week. That's generally not a problem on a wired network,
    but in a wireless setting where network clients join and depart the network all
    the time, the DHCP server automatically assigns the next available address to
    each new client. If one of those clients is also the home of one of the network's
    service ports, the NAT probably won't find it. This is not a common problem because
    most networks don't use portable computers as servers, but it can happen. The
    solution is either to turn off the DHCP server and assign a permanent IP address
    to each client or move the service port to a computer than has a wired connection
    to the network and assign a fixed IP address with a number at the high end of
    the DHCP range (for example, if the range of addresses assigned by the DHCP is
    from 192.168.1.100 to 192.168.1.200, set the server's address as 192.168.1.199).
  prefs: []
  type: TYPE_NORMAL
- en: '**Table 12-1. Common TCP/IP Service Port Numbers**'
  prefs: []
  type: TYPE_NORMAL
- en: '| Port Number | Internet Service |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 20 | FTP-Data (FTP Default Data) |'
  prefs: []
  type: TYPE_TB
- en: '| 21 | FTP (File Transfer) |'
  prefs: []
  type: TYPE_TB
- en: '| 23 | Telnet |'
  prefs: []
  type: TYPE_TB
- en: '| 25 | SMTP (Outgoing Mail) |'
  prefs: []
  type: TYPE_TB
- en: '| 37 | Time |'
  prefs: []
  type: TYPE_TB
- en: '| 53 | DNS (Domain Name System) |'
  prefs: []
  type: TYPE_TB
- en: '| 70 | Gopher |'
  prefs: []
  type: TYPE_TB
- en: '| 79 | Finger |'
  prefs: []
  type: TYPE_TB
- en: '| 80 | HTTP (Webserver) |'
  prefs: []
  type: TYPE_TB
- en: '| 88 | Kerberos |'
  prefs: []
  type: TYPE_TB
- en: '| 110 | POP 3 (Incoming Mail) |'
  prefs: []
  type: TYPE_TB
- en: '| 119 | NNTP (Network News) |'
  prefs: []
  type: TYPE_TB
- en: '| 1863 | Microsoft MSN Messenger |'
  prefs: []
  type: TYPE_TB
- en: '| 5190 | AOL Instant Messenger |'
  prefs: []
  type: TYPE_TB
- en: '| 7070 | Real Audio and Video |'
  prefs: []
  type: TYPE_TB
- en: Firewall Software
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A wireless gateway firewall at the interface between the access point and the
    wired part of your LAN will keep intruders from using your network to reach the
    Internet, and a firewall at the Internet connection will turn away attempts to
    connect to your network *from* the Internet, but there's still one more form of
    protection necessary in a wireless network. If somebody gains access to your wireless
    LAN without permission, you want to keep him out of the other legitimate computers
    on the same network, so you need to install a client firewall program on each
    network node.
  prefs: []
  type: TYPE_NORMAL
- en: Client firewalls perform the same functions at a computer's network interface
    that a LAN or enterprise firewall performs for the entire network; it detects
    attempts to connect to TCP service ports and rejects them unless they match one
    or more of the firewall program's configuration settings.
  prefs: []
  type: TYPE_NORMAL
- en: Several good firewall products are available as shareware, and others are free
    to noncommercial users. It's easy to try them on your own system and choose the
    one you like best. There's also a firewall built into Windows XP and Windows Vista
    that is adequate for most home and small-business networks.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here are some Windows programs:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **ZoneAlarm** [http://www.zonealarm.com](http://www.zonealarm.com) |'
  prefs: []
  type: TYPE_TB
- en: '| **LANguard** [http://www.languard.com](http://www.languard.com) |'
  prefs: []
  type: TYPE_TB
- en: Unix and Linux users also have plenty of firewall options. Most of them were
    written for use on stand-alone firewall computers that are commonly used as network
    gateways, but they could be equally appropriate as protection for individual network
    clients.
  prefs: []
  type: TYPE_NORMAL
- en: In Linux, the iptables firewall is part of the kernel. It is well documented
    at [http://www.netfilter.org/projects/iptables/index.html](http://www.netfilter.org/projects/iptables/index.html).
    Portsentry is a port scan detection tool that is integrated into several widely
    used Linux distributions. It's available for download from [http://linux.cudeso.be/linuxdoc/portsentry.php](http://linux.cudeso.be/linuxdoc/portsentry.php).
  prefs: []
  type: TYPE_NORMAL
- en: IP Filter is a software package that provides firewall services to FreeBSD and
    NetBSD systems. The official IP Filter website is [http://coombs.anu.edu.au/~avalon](http://coombs.anu.edu.au/~avalon),
    and there's an excellent HOWTO document at [http://www.obfuscation.org/ipf/ipf-howto.txt](http://www.obfuscation.org/ipf/ipf-howto.txt).
    The program can deny or permit any packet from passing through the firewall, and
    it can filter by net mask or host address, establish service port restrictions,
    and provide NAT translation services.
  prefs: []
  type: TYPE_NORMAL
- en: OpenBSD, FreeBSD, and NetBSD can all use the PF, or Packet Filter, facility
    to perform firewalling functions. More information is available at [http://www.openbsd.org/faq/pf.](http://www.openbsd.org/faq/pf.)
  prefs: []
  type: TYPE_NORMAL
- en: NetBSD/i386 Firewall is another free Unix firewall. It will operate on any PC
    with a 486 or later CPU and uses as little as 8MB of memory. The NetBSD/i386 Firewall
    Project home page is [http://www.dubbele.com](http://www.dubbele.com).
  prefs: []
  type: TYPE_NORMAL
- en: Turn Off DHCP
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The DHCP server in an access point or router automatically assigns a numeric
    IP address to each computer that is connected to the network. Therefore, it will
    also assign an IP address to an unauthorized computer that makes it through your
    encryption and other security tools.
  prefs: []
  type: TYPE_NORMAL
- en: On the other hand, if your network uses fixed IP addresses for each computer,
    and the access point or router is set to only recognize those particular addresses,
    the access point or router will reject a connection attempt unless the computer
    or other device is set to the correct address.
  prefs: []
  type: TYPE_NORMAL
- en: 'The most common ranges of IP addresses for a LAN are:'
  prefs: []
  type: TYPE_NORMAL
- en: 192.168.0.0 to 192.168.0.255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 192.168.1.0 to 192.168.1.255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'If you use a less common range of fixed IP addresses, it will be more difficult
    for an outsider to guess a correct address. Several other ranges are also reserved
    for LANs, including:'
  prefs: []
  type: TYPE_NORMAL
- en: 10.0.0.0 to 10.255.255.255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 172.16.0.0 to 176.31.255.255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 192.168.0.0 to 192.168.255.255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 169.254.0.0 to 169.254.25.255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If, for example, you have 10 computers on your home network, you could set the
    range of acceptable IP addresses to 172.16.234.20 through 172.16.234.40 and assign
    a static IP address within that range to each computer.
  prefs: []
  type: TYPE_NORMAL
- en: Of course, this is not as practical for a public network where many users come
    and go, but it's useful in a home network in which you control all the network
    nodes.
  prefs: []
  type: TYPE_NORMAL
- en: Don't confuse using static IP addresses with MAC authentication. Both methods
    restrict access to a specific set of computers, but they use different parts of
    the connection process to accomplish that goal. While both offer an additional
    layer of security, they are imperfect. Neither method should be your only means
    of securing your network.
  prefs: []
  type: TYPE_NORMAL
- en: Turn Off the Power
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: An intruder can't break into your wireless network if the access point and all
    of your computers are turned off. If you and your family, or the people in your
    office are not using your Wi-Fi network, there's usually no reason to let anybody
    else use it, especially without your permission or knowledge. When you leave home
    for a few days, or even a few hours, or when you are done with your computers
    for the night, you can shut down your wireless network by disconnecting the power
    connector on the access point or using a power strip to turn off power to all
    of your computers and peripheral devices, including the network access point.
    When you want to use the computer and the network again, reconnect the power connector
    or turn on the power strip. Remember to wait until the lights on your DSL or cable
    modem and wireless access point stop flashing before you try to use the network.
  prefs: []
  type: TYPE_NORMAL
- en: This technique has the added benefit of reducing the amount of electric power
    the access point and other devices consume. Neither the access point nor any of
    your other equipment uses more than a watt or two when they're idle, but if you
    reduce that number to zero, you might see a small reduction in your monthly electric
    bill.
  prefs: []
  type: TYPE_NORMAL
- en: Physical Security
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Up until now, we've been talking about keeping electronic intruders out of your
    wireless network. It's easy enough to gain access to a network using off-the-shelf
    equipment that hasn't already been configured for that network; it's even easier
    when the intruder has stolen a laptop from an authorized user. Losing a laptop
    computer to a thief is bad enough. Letting the thief use a stolen computer to
    log in to a network is even worse. As a network operator, you should remind your
    users that their portables are attractive targets for thieves, and offer some
    guidelines for protecting them. As a user yourself, you should follow the same
    precautions.
  prefs: []
  type: TYPE_NORMAL
- en: 'The first rule is simple: Don''t forget that you''re carrying a computer. It
    seems obvious, but London taxi drivers found about 2,900 laptops (and 62,000 mobile
    phones!) left in their cabs during a six-month period. Uncounted others have been
    abandoned in airplanes, hotel rooms, commuter trains, and conference centers.
    It doesn''t take a thief to separate a computer from its owner if the owner just
    walks away.'
  prefs: []
  type: TYPE_NORMAL
- en: Don't advertise the fact that you're carrying a computer. Those nylon bags that
    say *IBM* or *COMPAQ* on the side in great big letters might be handy, but they're
    not as safe as an ordinary briefcase or a conservative carrier bag.
  prefs: []
  type: TYPE_NORMAL
- en: Next, keep your laptop in your hands or on your shoulder whenever it's not locked
    in a closet or storage locker. Look away for a minute, and a skilled thief can
    make it disappear. Airport terminals, railway stations, and hotel lobbies are
    common places for quick snatch-and-grabs. If you have to use the computer in a
    public space, use a lock with a steel cable to secure it to an immovable object.
  prefs: []
  type: TYPE_NORMAL
- en: Don't leave an unsecured laptop computer in an office overnight.
  prefs: []
  type: TYPE_NORMAL
- en: Watch out for airport scanners. Make sure you're able to retrieve the computer
    as soon as it comes off the conveyor belt. Two people working together can do
    a fine job of delaying you and grabbing the computer before you can get to it.
    If somebody tries to steal your computer from a security check, make some noise
    and get help from the security guards.
  prefs: []
  type: TYPE_NORMAL
- en: Make sure your computers and loose components like PC Cards have property labels
    both inside and out. Engrave your name or company name and telephone number on
    network interface cards and other removable parts. A company called Security Tracking
    of Office Property ([http://www.stoptheft.com](http://www.stoptheft.com)) offers
    registered security plate labels with a cyanoacrylate adhesive that requires something
    like 800 pounds of pressure to remove and an indelible chemical tattoo marked
    "Stolen Property" that appears if somebody removes the label.
  prefs: []
  type: TYPE_NORMAL
- en: If you can convince your users to use alarm devices on their computers, that
    might improve the chances of recovering them. Caveo Anti-Theft PC Cards ([http://www.caveo.com/products/anti-theft.htm](http://www.caveo.com/products/anti-theft.htm))
    are motion detectors that analyze a computer's motion and both sound a loud alarm
    and prevent access to the computer's operating system when the computer has been
    carried beyond a preset distance. Similar alarm products are available from other
    manufacturers.
  prefs: []
  type: TYPE_NORMAL
- en: Tracking software is another approach to laptop security. Subscription services
    such as LoJack for Laptops ([http://www.lojackforlaptops.com](http://www.lojackforlaptops.com)),
    Computrace ([http://www.absolute.com](http://www.absolute.com)), CyberAngel ([http://thecyberangel.com](http://thecyberangel.com)),
    and XTool Laptop Tracker ([http://www.stealthsignal.com](http://www.stealthsignal.com))
    use the computer's communications software to send a "Here I am" signal back to
    the service. When a subscriber reports that a computer has been stolen, the service
    uses the locator signal to assist law enforcement authorities in finding it.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, keep a list of models and serial numbers separately from the devices
    themselves. You'll need that information for your police report and your insurance
    claim.
  prefs: []
  type: TYPE_NORMAL
- en: When you discover that one of the computers that uses your wireless network
    has been lost or stolen, it's essential to protect the rest of the network. If
    possible, change the network's passwords and encryption keys as soon as you can.
    If your network uses a list of MAC addresses to control access, remove the stolen
    device's MAC address from the list of authorized connections. Some tools (such
    as ArpWatch for Linux) provide a mechanism for watching for specific MAC addresses
    and raising an alert when it detects one of those addresses.
  prefs: []
  type: TYPE_NORMAL
- en: Sharing Your Network with the World
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: If you use your wireless network to provide public access to the Internet to
    your neighborhood or campus, or if you want to allow customers and other visitors
    to connect to your wireless net, you won't want to use encryption or other security
    tools to limit access to known users, but you should still give some thought to
    security. Just because you want to give people a direct connection to the Internet,
    that doesn't mean you want to let them poke around in the other computers connected
    to your network, so it's necessary to isolate the wireless access points from
    the rest of the network.
  prefs: []
  type: TYPE_NORMAL
- en: If all of the local nodes on your LAN are connected through wires, the best
    approach is to place a firewall between the wireless access point and the wired
    LAN that only allows the access point (and the computers connected to it through
    wireless links) to communicate with the Internet but not with any local nodes
    on the wired LAN, as shown in [Figure 12-8](ch12s07.html#the_firewall_isolates_the_wireless_segme
    "Figure 12-8. The firewall isolates the wireless segment from the rest of the
    network.").
  prefs: []
  type: TYPE_NORMAL
- en: '![The firewall isolates the wireless segment from the rest of the network.](tagoreillycom20090210nostarchimages254001.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 12-8. The firewall isolates the wireless segment from the rest of
    the network.**'
  prefs: []
  type: TYPE_NORMAL
- en: 'If one or more of your in-house computers uses wireless connections, you must
    protect them from access by outsiders who are using the public portion of your
    network. There are several ways to do that: [Figure 12-9](ch12s07.html#every_in-house_computer_includes_a_softw
    "Figure 12-9. Every in-house computer includes a software firewall.") shows a
    wireless network with a software firewall in each in-house computer; [Figure 12-10](ch12s07.html#the_public_wireless_access_point_has_a_d
    "Figure 12-10. The public wireless access point has a different SSID from the
    access point for in-house users.") shows a system that uses two separate wireless
    networks with different SSIDs that are both connected to the same Internet hookup.
    In general, the basic rule is to use one or more firewalls to isolate the public
    portion of your network from the computers that you don''t want open to everybody
    in the world.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Every in-house computer includes a software firewall.](tagoreillycom20090210nostarchimages254155.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 12-9. Every in-house computer includes a software firewall.**'
  prefs: []
  type: TYPE_NORMAL
- en: '![The public wireless access point has a different SSID from the access point
    for in-house users.](tagoreillycom20090210nostarchimages254467.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 12-10. The public wireless access point has a different SSID from
    the access point for in-house users.**'
  prefs: []
  type: TYPE_NORMAL
- en: Some Final Thoughts About Wi-Fi Security
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: It seems as if a pattern is emerging, doesn't it? Engineers from interested
    hardware and software companies gather under the flag of an IEEE task force to
    develop yet another new set of network security tools to make their products safe
    from hackers, crackers, eavesdroppers, and other miscreants—and a few months later,
    an independent researcher at some university or government agency discovers that
    the new tools have their own serious problems that expose the "protected" data
    to break-ins and leaks, and yet another cracking program shows up on the Internet,
    "just to demonstrate the concept." In the meantime, the poor end users of the
    world are running as fast as they can to keep up, but their wireless networks
    still aren't completely secure.
  prefs: []
  type: TYPE_NORMAL
- en: If you look at wireless security as a cat-and-mouse game, it's pretty clear
    that the mice (or is it the cats?) need some sophisticated knowledge and equipment
    to work around the existing encryption and authentication tools. On the other
    hand, some of the most advanced tools are freely available to anyone with an Internet
    connection.
  prefs: []
  type: TYPE_NORMAL
- en: What to do? Is a secure wireless network an unreachable goal? Don't give up
    hope. WPA encryption is secure enough to keep most intruders out of the vast majority
    of Wi-Fi networks, and the additional security features included in the new 802.11n
    specification will provide even more protection. If that's not good enough, you
    can add a VPN to provide yet another layer of security for your data.
  prefs: []
  type: TYPE_NORMAL
- en: 'Think of wireless security like the front door to your house: If you leave
    the door wide open, anybody can walk in and steal your stuff. But when you lock
    the door and latch all the windows, it will be *much* more difficult for a burglar
    to enter. An expert can pick the lock, but that takes a lot of time and trouble,
    and most thieves will look for an unprotected house instead.'
  prefs: []
  type: TYPE_NORMAL
