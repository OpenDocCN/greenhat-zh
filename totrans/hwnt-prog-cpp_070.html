<html><head></head><body>

<div class="calibre21" id="calibre_pb_0"/><div class="calibre1" id="calibre_toc_77">
<a name="ch05" class="calibre6" id="ch05"/>
<div class="calibre1">
<h2 class="lot-title" id="calibre_pb_1"><a name="80" class="calibre16" id="80"/><a name="ch05lev1sec6" class="calibre16" id="ch05lev1sec6"/><span class="chapter-titlelabel">Program 68: </span>Miscalculating</h2><p class="b24-bookeditorial">The assignment here is to make a four-function calculator. The user is supposed to type in an operator and a number, and the calculator goes to work. For example:</p>
<div class="calibre1">
<pre class="literallayout-normal">
         Enter operator and value: <span class="underline" style="text-decoration:underline">+ 10</span>
         Total: 10
</pre>
</div>
<p class="b24-bookeditorial">But things don't go as expected.</p>
<div class="calibre1">
<pre class="literallayout-normal">
  1 /************************************************
  2  * calc -- Simple 4 function calculator.        *
  3  *                                              *
  4  * Usage:                                       *
  5  *      $ calc                                  *
  6  *      Enter operator and value: + 5           *
  7  *                                              *
  8  * At the end of each operation the accumulated *
  9  * results are printed.                         *
 10  ************************************************/
 11 #include &lt;stdio.h&gt;
 12 int main() {
 13     char oper;  /* Operator for our calculator */
 14     int  result;/* Current result */
 15     int value;  /* Value for the operation */
 16
 17     result = 0;
 18     while (1)
 19     {
 20         char line[100]; // Line from the user
 21         printf("Enter operator and value:");
 22
 23         fgets(line, sizeof(line), stdin);
 24         sscanf(line, "%c %d", oper, value);
 25
 26         switch (oper) {
 27             case '+':
 28                 result += value; break;
 29             case '-':
 30                 result -= value; break;
 31             case '*':
 32                 result *= value; break;
 33             case '/':
 34                 if (value == 0)
 35                     printf("Divide by 0 error\n");
 36                 else
 37                     result /= value;
 38                 break;
 39             case 'q':
 40                 exit (0);
 41             default:
 42                 printf("Bad operator entered\n"); break;
 43         }
 44         printf("Total: %d\n", result);
 45     }
 46 }
</pre>
</div>
<p class="b24-bookeditorial">(Next <a href="LiB0120.html#209" target="_parent" class="calibre2">Hint 73</a>. <a href="LiB0121.html#593" target="_parent" class="calibre2">Answer 95</a>.)</p>
<div class="calibre1">
<table class="calibre3" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr class="calibre4">
<td class="bluecell"><span class="calibre22"><b class="calibre13"><img src="_1.gif" alt="Start Sidebar" border="0" class="calibre23"/></b></span></td>
</tr>
</table>
<p class="b24-bookeditorial">One company had a problem. Some of its customers were deleting the company name and copyright from its software. The programmers were asked to come up with a way to prevent this. So they put in some code to checksum the copyright, and if it came out wrong, they would issue an error message:</p>
<div class="calibre1">
<pre class="literallayout-normal">
    Fatal error:
             Water buffalos need immediate feeding
    Call 1-800-555-1234 for technical support.
</pre>
</div>
<p class="b24-bookeditorial">The idea was that this error message would be so strange that the miscreant would call technical support to find out what it meant. (What it really meant was, "I modified your program illegally.")</p>
<table class="calibre3" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr class="calibre4">
<td class="bluecell"><span class="calibre22"><b class="calibre13"><img src="_1.gif" alt="End Sidebar" border="0" class="calibre23"/></b></span></td>
</tr>
</table>
</div>
<table class="calibre3" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr class="calibre4">
<td height="16" class="calibre8"/>
</tr>
</table>
</div>
</div>



</body></html>