<html><head></head><body><div class="chapter" title="Chapter&#xA0;17.&#xA0;Filters"><div class="titlepage"><div><div><h1 class="title"><a id="filters"/>Chapter 17. Filters</h1></div></div></div><p><a id="iddle2164" class="indexterm"/><a id="iddle2186" class="indexterm"/><a id="iddle2192" class="indexterm"/><a id="iddle2208" class="indexterm"/><a id="iddle2222" class="indexterm"/><a id="iddle4480" class="indexterm"/>Inkscape filters are a way to apply complex bitmap processing algorithms to the objects in your drawing. True to the vector spirit, filters are nondestructive: You can always change the parameters of any filter, and the original vector object remains fully editable. Examples of what filters can do include blurring, sharpening, color adjustments, adding texture, various distortions, 3D-like effects such as bevels, and many others. Moreover, you can combine filters into arbitrarily complex <span class="emphasis"><em>filter stacks</em></span>.</p><p>SVG filters (as defined by the SVG standard and implemented by Inkscape) are extremely powerful; a whole book could be written on their uses and capabilities. Unfortunately, they can also be quite technical, especially if you’re trying to compose your own filter stacks. Therefore, in this chapter, we will start by looking at some simple ways to use filters, such as the <span class="strong"><strong>Blur</strong></span> control (<span class="strong"><strong><a class="xref" href="ch17s01.html" title="17.1 Blur">17.1 Blur</a></strong></span>) and preset filter effects (<span class="strong"><strong><a class="xref" href="ch17s03.html" title="17.3 Preset Filters">17.3 Preset Filters</a></strong></span>). Then, for those who seek more flexibility and are not afraid to go technical, we will discuss the powerful <span class="strong"><strong>Filter Editor</strong></span> dialog (<span class="strong"><strong><a class="xref" href="ch17s04.html" title="17.4 The Filter Editor Dialog">17.4 The Filter Editor Dialog</a></strong></span>), which enables you to create your own filter stacks from standard filter primitives.</p></div>
<div class="sect1" title="17.1 Blur"><div class="titlepage"><div><div><h1 class="title"><a id="one7dot1_blur"/>17.1 Blur</h1></div></div></div><p><a id="iddle1188" class="indexterm"/><a id="iddle1327" class="indexterm"/><a id="iddle1329" class="indexterm"/><a id="iddle1361" class="indexterm"/><a id="iddle2275" class="indexterm"/><a id="iddle2278" class="indexterm"/>We have seen blurring used many times throughout this book. Properly called <span class="emphasis"><em>Gaussian blur</em></span> (named after Carl Friedrich Gauss, a German mathematician), this effect smoothly “dissolves” the object, as if viewing it through an out-of-focus lens. <span class="strong"><strong>Blur</strong></span> is only one of the 14 filter primitives that Inkscape supports—but of all these primitives, <span class="strong"><strong>Blur</strong></span> has by far the most user-friendly interface: You can adjust it, for any object at any time, with a simple slider in the <span class="strong"><strong>Fill and Stroke</strong></span> dialog:</p><div class="figure"><a id="blur_slider_in_the_fill_and_stroke_dialo"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00315"/><img src="httpatomoreillycomsourcenostarchimages1736286.png.jpg" alt="The Blur slider in the Fill and Stroke dialog"/></div></div><p class="title">Figure 17-1. The Blur slider in the Fill and Stroke dialog</p></div><p>One might thus say that Inkscape treats blur as a fundamental property of an object, just like its opacity. Why this special treatment? On one hand, it is because blurring an object is such a natural, basic operation. Blurring is everywhere in the physical world: Non-crisp shadows, glows, and things viewed out of focus or in motion are all renderable with blur. This filter is therefore absolutely essential if you want to draw anything photorealistic. On the other hand, blur is not something you can easily imitate with regular vector shapes or gradients. So, by adding just one easily accessible slider, Inkscape’s capabilities expand enormously.</p><p>The <span class="strong"><strong>Blur</strong></span> slider controls the <span class="emphasis"><em>amount</em></span> of blur in a range from 0 to 100 percent; the setting of 1 percent barely changes the appearance of an object, and 100 percent turns any object into a shapeless puff. The percentage makes sure that this scale works the same for objects of any size; in other words, a large object blurred by 10% has a larger <span class="emphasis"><em>absolute</em></span> amount of blur (larger <span class="emphasis"><em>blur radius</em></span>), but it looks exactly proportional to a small object that is also blurred by 10 percent. If you want to get the same blur radius in objects of different sizes, you need to use different blur amounts.</p><div class="figure"><a id="blur_amount_left_parenthesissame_in_a_an"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00316"/><img src="httpatomoreillycomsourcenostarchimages1736288.png.jpg" alt="Blur amount (same in A and B) and blur radius (same in A and C)"/></div></div><p class="title">Figure 17-2. Blur amount (same in A and B) and blur radius (same in A and C)</p></div><p>As you will notice, blurring an object affects its bounding box (only if the visual bounding box type is used, <span class="strong"><strong><a class="xref" href="ch04s02.html" title="4.2 The Bounding Box">4.2 The Bounding Box</a></strong></span>). The expanded bounding box will cover all of the blurred fringe of the object.</p><p>Each blurred object is processed separately, as if on its own, fully transparent layer, and thus it never “smears” any adjacent nonblurred objects. Since that <a id="iddle1333" class="indexterm"/><a id="iddle1334" class="indexterm"/><a id="iddle1346" class="indexterm"/><a id="iddle2119" class="indexterm"/><a id="iddle2216" class="indexterm"/><a id="iddle2433" class="indexterm"/><a id="iddle3100" class="indexterm"/>per-object layer is by itself transparent, the edges of a blurred object become partially translucent. However, you can blur a group, and in that case, all members of the group are blurred together, as if placed on a single layer that is blurred as a whole. In <a class="xref" href="ch17s01.html#blurring_separate_objects_vsdot_blurring" title="Figure 17-3. Blurring separate objects vs. blurring a group">Figure 17-3</a>, on the left there are two adjacent rectangles with no gap between them and no blur. In the middle, each rectangle is blurred by 20 percent separately; as you can see, the striped background can be seen through the blurry gap between the objects. On the right, however, the same two rectangles are first grouped and then the group is blurred by 20 percent; now there is no gap—blurring only adds transparency at the edges, but it cannot reveal what was completely covered by the center of the opaque group.</p><div class="figure"><a id="blurring_separate_objects_vsdot_blurring"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00317"/><img src="httpatomoreillycomsourcenostarchimages1736290.png.jpg" alt="Blurring separate objects vs. blurring a group"/></div></div><p class="title">Figure 17-3. Blurring separate objects vs. blurring a group</p></div><p>Also, grouping allows you to apply several layers of blurring to the same object. For example, you can blur the object itself, then group it (possibly even just with itself, that is, placing a single object into the group) and blur the group. Naturally, by blurring a group, you can make any member objects <span class="emphasis"><em>more</em></span> blurred than they were before, but not <span class="emphasis"><em>less</em></span>. (Similarly, as we saw in <span class="strong"><strong><a class="xref" href="ch16s03.html" title="16.3 Styling Clones">16.3 Styling Clones</a></strong></span>, you can blur a clone more than its original object was blurred, but not less.)</p><div class="note" title="Note"><h3 class="title"><a id="ch17note01"/>Note</h3><p><span class="emphasis"><em>Blur is not the same as</em></span> feathering<span class="emphasis"><em>. Blur affects all of the object; in particular, the lines on a bitmap object or the object boundaries inside a complex group are all blurred. Feathering, on the other hand, is simply blurred transparency that masks out the outermost edges of an object (such as a photo). Inkscape can do feathering as well, using a predefined composite filter (<span class="strong"><strong><a class="xref" href="ch17s03.html" title="17.3 Preset Filters">17.3 Preset Filters</a></strong></span>).</em></span></p></div><div class="figure"><a id="blurring_vsdot_feathering"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00318"/><img src="httpatomoreillycomsourcenostarchimages1736292.png.jpg" alt="Blurring vs. feathering"/></div></div><p class="title">Figure 17-4. Blurring vs. feathering</p></div><div class="sect2" title="17.1.1 Blur and Transformations"><div class="titlepage"><div><div><h2 class="title"><a id="one7dot1dot1_blur_and_transformations"/>17.1.1 Blur and Transformations</h2></div></div></div><p>What happens if you transform a blurred object?</p><p>Moving a blurred object is not very interesting: The object just moves as a whole, remaining as blurred as ever. Proportional (uniform) scaling also scales the object as a whole, including the blur radius, so that the amount of blur stays the same as it is relative to the object size (i.e., the percentage indicator in the <span class="strong"><strong>Fill and Stroke</strong></span> dialog does not change).</p><p><a id="iddle1341" class="indexterm"/><a id="iddle2187" class="indexterm"/><a id="iddle2196" class="indexterm"/><a id="iddle2219" class="indexterm"/><a id="iddle2279" class="indexterm"/><a id="iddle2869" class="indexterm"/><a id="iddle3854" class="indexterm"/><a id="iddle4590" class="indexterm"/><a id="iddle4740" class="indexterm"/>Nonuniform scaling is more interesting. For example, if you squeeze a blurred object vertically, its blur will squeeze with it and become <span class="emphasis"><em>nonuniform</em></span>—now the object is more blurred horizontally than vertically. Such nonuniform blur is sometimes called <span class="emphasis"><em>motion blur</em></span> because it approximates the way the object would look on a photo when captured in fast motion (in this case, horizontal). So, if you want to apply a motion blur to the original nonsqueezed object, simply start by stretching it in the opposite direction, then blur it, and squeeze it back into shape (this only works for paths and bitmaps):</p><div class="figure"><a id="motion_blurcomma_step-by-step"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00319"/><img src="httpatomoreillycomsourcenostarchimages1736294.png.jpg" alt="Motion blur, step-by-step"/></div></div><p class="title">Figure 17-5. Motion blur, step-by-step</p></div><p>Another way to create nonuniform motion blur is by adjusting the parameters of the <span class="strong"><strong>Gaussian Blur</strong></span> filter in the <span class="strong"><strong>Filter Editor</strong></span> dialog (<span class="strong"><strong><a class="xref" href="ch17s04.html" title="17.4 The Filter Editor Dialog">17.4 The Filter Editor Dialog</a></strong></span>), but the stretch/squeeze method described here is usually easier.</p><div class="note" title="Note"><h3 class="title"><a id="ch17note02"/>Note</h3><p><span class="emphasis"><em>If you’re interested in how this works at the SVG level, the trick is to make sure the blur is applied to an object with a</em></span> <code class="literal">transform</code> <span class="emphasis"><em>attribute (<span class="strong"><strong><a class="xref" href="apas07.html" title="A.7 Transformations">A.7 Transformations</a></strong></span>), which assures that the blur will be affected by that transform as well. When you stretch a path object without blur, this stretching is by default embedded into the points of the path (<span class="strong"><strong><a class="xref" href="ch12s05.html#one2dot5dot7dot3_transforming_nodes" title="12.5.7.3 Transforming Nodes">12.5.7.3 Transforming Nodes</a></strong></span>); but once you apply the blur, reverse squeezing will instead add the</em></span> <code class="literal">transform</code> <span class="emphasis"><em>attribute, affecting the blur as well.</em></span></p></div><p>To create motion blur on a group or text object (i.e., not a path or bitmap), use this trick: Stretch the object, then group it (<span class="inlinemediaobject"><a id="inline_id00778"/><img src="httpatomoreillycomsourcenostarchimages1735504.png.jpg" alt=""/></span>, <span class="strong"><strong><a class="xref" href="ch04s05.html" title="4.5 Groups">4.5 Groups</a></strong></span>), apply a blur to the group, and squeeze it back. The grouping step makes sure that in the end, you get an object with the correct proportions but also with the squeezing <code class="literal">transform</code> attribute affecting the blur.</p><p>Similar remarks apply to the way many other filters behave when transformed. For example, squeezing and/or rotating objects allows you to create perspective-distorted variants of the texture filters (<span class="strong"><strong><a class="xref" href="ch17s03.html" title="17.3 Preset Filters">17.3 Preset Filters</a></strong></span>) for applying to walls and floors in 3D scenes (<span class="strong"><strong><a class="xref" href="ch11s03.html" title="11.3 3D Boxes">11.3 3D Boxes</a></strong></span>). Of course, transforming filters by stretching and squeezing objects is not as convenient as dragging handles on canvas would be—but it works.</p><div class="note" title="Note"><h3 class="title"><a id="ch17note03"/>Note</h3><p><span class="emphasis"><em>Filters work on the rendered image of the object on your screen—that is, they are always given as input a bitmap that is created for the current zoom level. This is why filters may be so slow: Every time you zoom in or out, the filter is reapplied to the new rendering of the object. This also explains why some filters may look somewhat different depending on zoom. For example, a sharpening filter, when applied to a bitmap object at 100 percent zoom, works on the image features as you would expect it to. However, if you zoom in close enough, you will see the pixels of the bitmap object as rectangles (<span class="strong"><strong><a class="xref" href="ch01s01.html" title="1.1 What Vector Graphics Is and Why It Matters">1.1 What Vector Graphics Is and Why It Matters</a></strong></span>), and the sharpening will now apply to the borders of these pixel rectangles!</em></span></p></div></div><div class="sect2" title="17.1.2 Tweaking for Blur"><div class="titlepage"><div><div><h2 class="title"><a id="one7dot1dot2_tweaking_for_blur"/>17.1.2 Tweaking for Blur</h2></div></div></div><p><a id="iddle1316" class="indexterm"/><a id="iddle1323" class="indexterm"/><a id="iddle2775" class="indexterm"/><a id="iddle4541" class="indexterm"/><a id="iddle4554" class="indexterm"/><a id="iddle4790" class="indexterm"/>The Blur mode of the Tweak tool blurs the selected objects under the brush more (by default) or less (with <span class="inlinemediaobject"><a id="inline_id00779"/><img src="httpatomoreillycomsourcenostarchimages1735338.png.jpg" alt=""/></span> pressed). The amount of blur added or removed depends on <span class="strong"><strong>Force</strong></span>, pen pressure (if you’re using a tablet pen), the closeness of the object to the center of brush, and how long you apply the brush.</p></div></div>
<div class="sect1" title="17.2 Blend Modes"><div class="titlepage"><div><div><h1 class="title"><a id="one7dot2_blend_modes"/>17.2 Blend Modes</h1></div></div></div><p>Blend modes are another type of filter for which Inkscape has a dedicated control. Choosing a blend mode affects how the colors of an object <span class="emphasis"><em>blend</em></span> (i.e., mix) with those of the background objects beneath it.</p><p>However, unlike blur, which can be applied to any single object, Inkscape allows you to assign blend modes only to layers (<span class="strong"><strong><a class="xref" href="ch04s06.html" title="4.6 Layers">4.6 Layers</a></strong></span>); the corresponding control is in the <span class="strong"><strong>Layers</strong></span> dialog. This has its reasons in the way SVG treats these filters; for you, this means that you can only change the blending mode of all objects in a layer at once, and that blending mode will affect how the objects in this layer blend with those in layers below, not between themselves.</p><p>The five blend modes are: Normal (default; switch to this option to remove any unusual blending), Multiply, Screen, Darken, and Lighten. In Normal mode, only non-100 percent opacity allows the objects in the top layer to be translucent; in all other modes, bottom-layer objects can “show through” even without any transparency. Here is a demonstration:</p><div class="figure"><a id="all_large_rectangles_are_in_the_backgrou"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00320"/><img src="httpatomoreillycomsourcenostarchimages1736296.png.jpg" alt="All large rectangles are in the background layer, all small rectangles are in foreground layers with various blend modes set; opacity is 100% everywhere."/></div></div><p class="title">Figure 17-6. All large rectangles are in the background layer, all small rectangles are in foreground layers with various blend modes set; opacity is 100% everywhere.</p></div><p>Perhaps the most common application of blend modes is for tinting bitmaps. For example, imagine you have a color photo but want to render it completely or nearly monochrome, for example, in sepia or blue tones, to match the color scheme of your composition.</p><p>Of course, you can just overlay a semi-transparent rectangle of the target color over your bitmap, but that does not entirely get rid of the bitmap’s own color; worse, the bitmap fades out and loses contrast. You can also adjust the colors of the bitmap in an external bitmap editor (if it’s not yet embedded into your SVG, <span class="strong"><strong><a class="xref" href="ch18s02.html" title="18.2 Linking vs. Embedding">18.2 Linking vs. Embedding</a></strong></span>), or you can use a predefined composite filter such as Sepia, but these options are not as flexible. Instead, place the photo on one layer and the colored rectangle on its own layer above, and change the blend mode of that top layer (see Figure 13 on the color insert).</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>The <span class="strong"><strong>Multiply</strong></span> and <span class="strong"><strong>Darken</strong></span> modes apply tinting primarily to the <span class="emphasis"><em>light</em></span> areas of the photo. Therefore, if the tint color is itself light, it will nicely color your <a id="iddle2209" class="indexterm"/><a id="iddle2223" class="indexterm"/><a id="iddle4324" class="indexterm"/>photo while preserving its contrast; if the tint color is dark, the result will likely be too dark.</p><p>The difference between Multiply and Darken is that for each pixel, Darken just chooses whichever of the background and foreground colors is darker, whereas Multiply actually combines the two colors. Try both and choose whichever suits your photo.</p></li><li class="listitem"><p>The <span class="strong"><strong>Screen</strong></span> and <span class="strong"><strong>Lighten</strong></span> modes apply tinting primarily to the <span class="emphasis"><em>dark</em></span> areas of the photo. Therefore, if the tint color is itself dark, it will nicely color the photo while preserving its contrast; if the tint color is light, it will just “bleach out” the photo, making it too light overall.</p><p>Again, the difference between Screen and Lighten is that for each pixel, Lighten just chooses whichever of the background and foreground colors is lighter, whereas Screen actually combines the two colors. Try both and choose whichever suits your photo.</p></li></ul></div><p>Summarizing, if your tint color is dark, use the Screen or Lighten modes; if it is light, use Multiply or Darken. Change the opacity of the tint layer object to adjust the amount of tinting.</p></div>
<div class="sect1" title="17.3 Preset Filters"><div class="titlepage"><div><div><h1 class="title"><a id="one7dot3_preset_filters"/>17.3 Preset Filters</h1></div></div></div><p>Inkscape comes with an extensive collection of preset composite filters. To apply a preset filter to any number of selected objects, just choose a command from the submenus of the <span class="strong"><strong>Filters</strong></span> menu. Most filters will apply immediately; a few will first display a simple dialog where you can adjust their parameters, similar to any other extension effects (see <span class="strong"><strong><a class="xref" href="ch13s03.html" title="13.3 Path Extensions">13.3 Path Extensions</a></strong></span>; such filters have an “. . .” at the end of their names in the menu):</p><div class="figure"><a id="preset_filter_effects"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00321"/><img src="httpatomoreillycomsourcenostarchimages1736298.png.jpg" alt="Preset filter effects"/></div></div><p class="title">Figure 17-7. Preset filter effects</p></div><p>To get a brief description of an individual preset filter (or of any menu command, for that matter), just hover the mouse over its command in the menu and read the status bar. I will not describe all preset filters here; there are <a id="iddle1085" class="indexterm"/><a id="iddle1223" class="indexterm"/><a id="iddle1224" class="indexterm"/><a id="iddle1342" class="indexterm"/><a id="iddle1347" class="indexterm"/><a id="iddle1349" class="indexterm"/><a id="iddle1741" class="indexterm"/><a id="iddle1800" class="indexterm"/><a id="iddle2048" class="indexterm"/><a id="iddle2120" class="indexterm"/><a id="iddle2188" class="indexterm"/><a id="iddle2198" class="indexterm"/><a id="iddle2870" class="indexterm"/><a id="iddle3057" class="indexterm"/><a id="iddle3058" class="indexterm"/><a id="iddle3059" class="indexterm"/><a id="iddle3101" class="indexterm"/><a id="iddle3776" class="indexterm"/><a id="iddle4133" class="indexterm"/><a id="iddle4212" class="indexterm"/>dozens of them, and more are added with each Inkscape version. Instead, here is a brief description of the submenus that group together similar filters:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>The <span class="strong"><strong>ABCs</strong></span> submenu collects the most used, simple, basic filters that typically contain just one or two primitives. They include:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Smoke-like “fractal noise” texture applied either to fill (<span class="strong"><strong>Noise Fill</strong></span>) or to transparency (<span class="strong"><strong>Noise Transparency</strong></span>).</p></li><li class="listitem"><p>3D bevel with gloss (<span class="strong"><strong>Specular Light</strong></span>) or without gloss (<span class="strong"><strong>Diffuse Light</strong></span>).</p></li><li class="listitem"><p><span class="strong"><strong>Feather</strong></span> (<a class="xref" href="ch17s01.html#blurring_vsdot_feathering" title="Figure 17-4. Blurring vs. feathering">Figure 17-4</a>) applies a blurred opacity mask to the edges of the object.</p></li><li class="listitem"><p><span class="strong"><strong>Roughen</strong></span> randomly distorts the shape of the object.</p></li><li class="listitem"><p><span class="strong"><strong>Simple Blur</strong></span> adds a small amount of Gaussian blur (<span class="strong"><strong><a class="xref" href="ch17s01.html" title="17.1 Blur">17.1 Blur</a></strong></span>).</p></li></ul></div><p>Most often, these filters are used not on their own but as components in more complex filters that you can build just by layering multiple preset filters on top of one another. You can even roughly adjust the amount of a filter by applying it multiple times to the same object (for more precise adjustments of filter parameters, you will need to visit the <span class="strong"><strong>Filter Editor</strong></span>, <span class="strong"><strong><a class="xref" href="ch17s04.html" title="17.4 The Filter Editor Dialog">17.4 The Filter Editor Dialog</a></strong></span>).</p><div class="figure"><a id="filters_from_the_abcs_submenu"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00322"/><img src="httpatomoreillycomsourcenostarchimages1736300.png.jpg" alt="Filters from the ABCs submenu"/></div></div><p class="title">Figure 17-8. Filters from the ABCs submenu</p></div></li><li class="listitem"><p>The <span class="strong"><strong>Bevels</strong></span> submenu presents many variations on the theme of bevels (pseudo-3D raised edges): Here you will find opaque and translucent materials, glossy and matte finishes, bevels lit by multiple sources of light, with and without shadows, with depressions in the middle and with raised border, and so on. All these filters mostly preserve the original color of the object, though they may make it lighter or darker in places for the 3D effect.</p><div class="figure"><a id="filters_from_the_bevels_submenu"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00323"/><img src="httpatomoreillycomsourcenostarchimages1736302.png.jpg" alt="Filters from the Bevels submenu"/></div></div><p class="title">Figure 17-9. Filters from the Bevels submenu</p></div><div class="note" title="Note"><h3 class="title"><a id="ch17note04"/>Note</h3><p><span class="emphasis"><em>If you want to change the direction of the light cast upon a bevelled object, open the <span class="strong"><strong>Filter Editor</strong></span>, select the <span class="strong"><strong>Specular Light</strong></span> or <span class="strong"><strong>Diffuse Light</strong></span> primitive in the filter stack applied to the object, and adjust the <span class="strong"><strong>Azimuth</strong></span> parameter.</em></span></p></div></li><li class="listitem"><p>The <span class="strong"><strong>Blurs</strong></span> submenu offers horizontal and vertical motion blur, soft blurry glow behind an object, different approaches to blurring the inside color boundary of the object while keeping its outline crisp (<span class="strong"><strong>Evanescence</strong></span>, <span class="strong"><strong>Blur Content</strong></span>, and <span class="strong"><strong>Cross-Smooth</strong></span>), <span class="strong"><strong>Noisy Blur</strong></span> that combines shape distortion with blurring, and some other filters (<a class="xref" href="ch17s03.html#filters_from_the_blurs_submenu" title="Figure 17-10. Filters from the Blurs submenu">Figure 17-10</a>).</p><div class="figure"><a id="filters_from_the_blurs_submenu"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00324"/><img src="httpatomoreillycomsourcenostarchimages1736304.png.jpg" alt="Filters from the Blurs submenu"/></div></div><p class="title">Figure 17-10. Filters from the Blurs submenu</p></div></li><li class="listitem"><p><a id="iddle1462" class="indexterm"/><a id="iddle1577" class="indexterm"/><a id="iddle1589" class="indexterm"/><a id="iddle1780" class="indexterm"/><a id="iddle1808" class="indexterm"/><a id="iddle1961" class="indexterm"/><a id="iddle2019" class="indexterm"/><a id="iddle2042" class="indexterm"/><a id="iddle2527" class="indexterm"/><a id="iddle2697" class="indexterm"/><a id="iddle2698" class="indexterm"/><a id="iddle2840" class="indexterm"/><a id="iddle2852" class="indexterm"/><a id="iddle2864" class="indexterm"/><a id="iddle3159" class="indexterm"/><a id="iddle3524" class="indexterm"/><a id="iddle3732" class="indexterm"/><a id="iddle3775" class="indexterm"/><a id="iddle4103" class="indexterm"/><a id="iddle4128" class="indexterm"/><a id="iddle4201" class="indexterm"/><a id="iddle4684" class="indexterm"/><a id="iddle4708" class="indexterm"/><span class="strong"><strong>Color</strong></span> submenu contains filters that only modify the colors of the object they apply to. Here you will find <span class="strong"><strong>Desaturate</strong></span> for turning any object to grayscale, <span class="strong"><strong>Sepia</strong></span>, <span class="strong"><strong>Invert</strong></span> and <span class="strong"><strong>Invert Hue</strong></span>, various colorization filters (<span class="strong"><strong>Colorize</strong></span>, <span class="strong"><strong>Solarize</strong></span>, <span class="strong"><strong>Moonarize</strong></span>), and others.</p></li><li class="listitem"><p><span class="strong"><strong>Distort</strong></span> filters distort the shape of the object using horizontally stretched jitter, like a reflection in water (<span class="strong"><strong>Ripple</strong></span>), random roughening of edges (<span class="strong"><strong>Torn Edges</strong></span>), scattering of disconnected bits (<span class="strong"><strong>Chalk and Sponge</strong></span>), or edge distortion in combination with uneven texture (<span class="strong"><strong>Pixel Smear</strong></span>). The <span class="strong"><strong>Roughen Inside</strong></span> filter leaves the outline intact but roughens any color boundaries inside the object.</p><div class="figure"><a id="filters_from_the_distort_submenu"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00325"/><img src="httpatomoreillycomsourcenostarchimages1736306.png.jpg" alt="Filters from the Distort submenu"/></div></div><p class="title">Figure 17-11. Filters from the Distort submenu</p></div></li><li class="listitem"><p><span class="strong"><strong>Image Effects</strong></span> are the filters that largely make sense for bitmaps, such as <span class="strong"><strong>Sharpen</strong></span>, <span class="strong"><strong>Edge Detect</strong></span>, <span class="strong"><strong>Emboss</strong></span>, or <span class="strong"><strong>Oil Painting</strong></span>.</p><div class="figure"><a id="filters_from_the_image_effects_submenu"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00326"/><img src="httpatomoreillycomsourcenostarchimages1736308.png.jpg" alt="Filters from the Image Effects submenu"/></div></div><p class="title">Figure 17-12. Filters from the Image Effects submenu</p></div></li><li class="listitem"><p>The <span class="strong"><strong>Masking Tools</strong></span> submenu contains several effects that make parts of objects transparent. The most basic of these, <span class="strong"><strong>Eraser</strong></span>, makes every white area in the object transparent. For example, if you overlay a small white circle over a black rectangle, group them together, and apply <span class="strong"><strong>Eraser</strong></span> to the group, the white circle will turn into a hole through which the background will show.</p></li><li class="listitem"><p>The <span class="strong"><strong>Materials</strong></span> submenu presents a gallery of imitations of various materials: wood, gold splatter, marble, wax, leopard fur, and many others. Most these filters discard the original color of the object and use their own color.</p><div class="figure"><a id="filters_from_the_materials_submenu"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00327"/><img src="httpatomoreillycomsourcenostarchimages1736310.png.jpg" alt="Filters from the Materials submenu"/></div></div><p class="title">Figure 17-13. Filters from the Materials submenu</p></div></li><li class="listitem"><p><a id="iddle1915" class="indexterm"/><a id="iddle1916" class="indexterm"/><a id="iddle2868" class="indexterm"/><a id="iddle3060" class="indexterm"/><a id="iddle3204" class="indexterm"/><a id="iddle3730" class="indexterm"/><a id="iddle3867" class="indexterm"/><a id="iddle4108" class="indexterm"/>The <span class="strong"><strong>Morphology</strong></span> submenu contains filters that deal with the shape of the object by cutting holes in it, adding outlines, and so on.</p></li><li class="listitem"><p>The <span class="strong"><strong>Non Realistic Shaders</strong></span> submenu filters take a flat-colored object and add soft or crisp shading to it, highlighting some areas and darkening others, as may be useful for cartoons. This is a bit similar to thick bevels, but it goes deeper and produces more interesting and believable shapes.</p></li><li class="listitem"><p><span class="strong"><strong>Overlays</strong></span> do not change the object itself, but treat it as a pad for displaying some kind of texture, adding it as an overlay on the object’s original color.</p><div class="figure"><a id="filters_from_the_overlays_submenu"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00328"/><img src="httpatomoreillycomsourcenostarchimages1736312.png.jpg" alt="Filters from the Overlays submenu"/></div></div><p class="title">Figure 17-14. Filters from the Overlays submenu</p></div></li><li class="listitem"><p>The <span class="strong"><strong>Ridges</strong></span> submenu filters turn an object into a narrow ridge along the edge and treat this ridge in various ways.</p><div class="figure"><a id="filters_from_the_ridges_submenu"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00329"/><img src="httpatomoreillycomsourcenostarchimages1736314.png.jpg" alt="Filters from the Ridges submenu"/></div></div><p class="title">Figure 17-15. Filters from the Ridges submenu</p></div></li><li class="listitem"><p>The <span class="strong"><strong>Scatter</strong></span> submenu filters explode an object into variously shaped fragments—tree leaves, cubes (looking more like squares), random spray splotches—and scatter these fragments randomly around.</p></li><li class="listitem"><p>The <span class="strong"><strong>Shadows and Glows</strong></span> submenu filters treat the edges of the object in some way, usually making use of Gaussian blur. Perhaps the most widely used filters in this category are <span class="strong"><strong>Drop Shadow</strong></span> and <span class="strong"><strong>Drop Glow</strong></span>, which are identical except that the former creates a black shadow and the latter, a white glow (invisible unless you have dark background under your object). For these two filters, you can adjust the amount of blur, the opacity of the shadow or glow, and its offset.</p><div class="figure"><a id="filters_from_the_shadows_and_glows_subme"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00330"/><img src="httpatomoreillycomsourcenostarchimages1736316.png.jpg" alt="Filters from the Shadows and Glows submenu"/></div></div><p class="title">Figure 17-16. Filters from the Shadows and Glows submenu</p></div></li><li class="listitem"><p><a id="iddle2189" class="indexterm"/><a id="iddle2193" class="indexterm"/><a id="iddle2200" class="indexterm"/><a id="iddle2215" class="indexterm"/><a id="iddle2217" class="indexterm"/><a id="iddle2224" class="indexterm"/><a id="iddle3510" class="indexterm"/><a id="iddle3708" class="indexterm"/><a id="iddle4687" class="indexterm"/>The <span class="strong"><strong>Textures</strong></span> submenu contains all kinds of naturalistic textures: crumpled plastic, jam spread, bark, horizontally striped carpet, and many others (see <a class="xref" href="ch17s03.html#filters_from_the_textures_submenu" title="Figure 17-17. Filters from the Textures submenu">Figure 17-17</a>).</p><div class="figure"><a id="filters_from_the_textures_submenu"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00331"/><img src="httpatomoreillycomsourcenostarchimages1736318.png.jpg" alt="Filters from the Textures submenu"/></div></div><p class="title">Figure 17-17. Filters from the Textures submenu</p></div></li></ul></div><p>To remove any filters applied to the selected objects, use the <span class="strong"><strong>Filters</strong></span> ▸ <span class="strong"><strong>Remove Filters</strong></span> command. You can also combine preset filters in any order just by applying them on top of one another; for example, after you change the texture of an object, you can add a drop shadow to it. The <span class="strong"><strong>Remove Filters</strong></span> command will remove all filters you have applied, not just the one you added last.</p><p>If the scale of the applied filter is not what you need (e.g., the bubbles or the feathered edges are too large or too small for your object) and the filter does not allow you to adjust that with a dialog, you can use this simple trick: Scale your object up (or down), for example by pressing <span class="inlinemediaobject"><a id="inline_id00780"/><img src="httpatomoreillycomsourcenostarchimages1736320.png.jpg" alt=""/></span> or <span class="inlinemediaobject"><a id="inline_id00781"/><img src="httpatomoreillycomsourcenostarchimages1735600.png.jpg" alt=""/></span> a few times, then apply the filter, and scale the result back down (or up) by the same multiplier.</p><p>The illustrations and descriptions here cover only a subset of the preset filters available. If you want to review all of the preset filters, load the file <span class="emphasis"><em>filters.svg</em></span> from the <span class="emphasis"><em>share/examples</em></span> directory of your Inkscape installation.</p><div class="note" title="Note"><h3 class="title"><a id="ch17note05"/>Note</h3><p><span class="emphasis"><em>You can easily add your own preset filters to the menu—no programming required! Once you have an SVG file with the filters you’d like to be able to reuse, simply place that file in the</em></span> Filters <span class="emphasis"><em>subdirectory of your Inkscape’s profile directory (</em></span>~/.config/inkscape <span class="emphasis"><em>on Linux,</em></span> Documents and Settings\&lt;your username&gt;\Application Data\Inkscape <span class="emphasis"><em>on Windows; create the</em></span> Filters <span class="emphasis"><em>subdirectory there if it does not yet exist). After that, any filters defined in that file will be listed in a <span class="strong"><strong>Personal</strong></span> submenu under <span class="strong"><strong>Filters</strong></span>. (All these filters will apply immediately; unfortunately, you cannot at this time create a filter with an adjustment dialog without doing some programming.)</em></span></p></div><div class="note" title="Note"><h3 class="title"><a id="ch17note06"/>Note</h3><p><span class="emphasis"><em>The preset filters that come with Inkscape are useful not only by themselves but also as starting points for your own derivative filters. Once you are familiar with filter primitives and the <span class="strong"><strong>Filter Editor</strong></span> dialog, choosing one of the preset filters—closest to what you want to get—and working from it is usally much easier than starting from scratch.</em></span></p></div></div>
<div class="sect1" title="17.4 The Filter Editor Dialog"><div class="titlepage"><div><div><h1 class="title"><a id="one7dot4_the_filter_editor_dialog"/>17.4 The Filter Editor Dialog</h1></div></div></div><p>Now, let’s have a look at the principal filter powerhouse of Inkscape: the <span class="strong"><strong>Filter Editor</strong></span> dialog (shown in <a class="xref" href="ch17s04.html#major_areas_of_the_filter_editor_dialog" title="Figure 17-18. Major areas of the Filter Editor dialog">Figure 17-18</a>). Open it with the <span class="strong"><strong>Filters</strong></span> ▸ <span class="strong"><strong>Filter Editor . . .</strong></span> command.</p><div class="figure"><a id="major_areas_of_the_filter_editor_dialog"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00332"/><img src="httpatomoreillycomsourcenostarchimages1736322.png.jpg" alt="Major areas of the Filter Editor dialog"/></div></div><p class="title">Figure 17-18. Major areas of the Filter Editor dialog</p></div><div class="sect2" title="17.4.1 The Filters List"><div class="titlepage"><div><div><h2 class="title"><a id="one7dot4dot1_the_filters_list"/>17.4.1 The Filters List</h2></div></div></div><p><a id="iddle2197" class="indexterm"/><a id="iddle2212" class="indexterm"/><a id="iddle4898" class="indexterm"/>The list in the top-left corner of the dialog contains all filters defined in your document. You can highlight any filter and edit its structure and parameters in the dialog. If the currently selected object has a filter applied, that filter will have a checkmark in the list; so, by setting or removing the checkmark, you can apply or unapply any filter to any object. (Note that even unused filters remain in the list; to remove them from the document, use the <span class="strong"><strong>File</strong></span> ▸ <span class="strong"><strong>Vacuum Defs</strong></span> command.)</p><p>Under the list, there is a <span class="strong"><strong>New</strong></span> button for adding a new filter. If you opened this dialog in an empty document, the list of filters is also empty; now, press <span class="strong"><strong>New</strong></span> to create a new empty filter, usually called <code class="literal">filter1</code> (to rename it to something else, just click the selected name in the list and type). You can also duplicate or delete a filter in the list by right-clicking it and using the corresponding pop-up menu commands.</p><p>After that, you can create or select some object in the document and check the checkbox for your new filter. Nothing changes—an empty filter does not affect the rendering of an object. For the filter to actually do something, we need to add some primitives to it.</p></div><div class="sect2" title="17.4.2 The Stack of Primitives"><div class="titlepage"><div><div><h2 class="title"><a id="one7dot4dot2_the_stack_of_primitives"/>17.4.2 The Stack of Primitives</h2></div></div></div><p>Turn your attention to the area to the right of the filter list. This is the main filter construction board where you list, arrange, and connect the stack of <span class="emphasis"><em>primitives</em></span> that constitute a filter. Initially, it is empty because we haven’t yet added any primitives to our filter.</p><p><a id="iddle2280" class="indexterm"/><a id="iddle3803" class="indexterm"/><a id="iddle4509" class="indexterm"/><a id="iddle4780" class="indexterm"/><a id="iddle4925" class="indexterm"/>The 14 different primitives supported by Inkscape are listed in a drop-down list below the construction board. When you choose a primitive in the list, it displays a brief description and illustration below. You can read the description in the dialog to get an initial idea of what each primitive does. A detailed explanation of all primitives is beyond the scope of this book; if you want all the gory technical details, refer to the SVG specification (<span class="emphasis"><em><a class="ulink" href="http://w3.org/TR/SVG11">http://w3.org/TR/SVG11</a></em></span>).</p><p>Instead, let’s go through the step-by-step process of creating a fairly complex filter that uses several different primitives to get an integral idea of how it all works. The filter we’ll construct is called Sandy Blur; I designed it for the background coloring of the Rose image (see <a class="xref" href="ch24.html#building_up_the_quotation_markrealistic" title="Figure 24-5. Building up the “realistic watercolor” filter for the background">Figure 24-5</a>). This filter aims to imitate blurry watercolor strokes on a rough paper.</p><p>Plain Gaussian blur is not satisfactory: It is too smooth, too computer-generated, too boring. For an acceptable watercolor imitation, we need to model both the small-scale roughness of the paper texture and the larger-scale “blotches” resulting from the watercolor paint flowing and sticking differently in different places. For both these sources of unevenness, we will use the <span class="strong"><strong>Turbulence</strong></span> primitive, which creates random fractal “noise” at the given scale.</p><div class="figure"><a id="two_turbulence_primitives"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00333"/><img src="httpatomoreillycomsourcenostarchimages1736324.png.jpg" alt="The two Turbulence primitives"/></div></div><p class="title">Figure 17-19. The two Turbulence primitives</p></div><p>The two <span class="strong"><strong>Turbulence</strong></span> primitives are the first two components of our filter—the two topmost boxes in the stack. Each filter primitive has one or more <span class="emphasis"><em>inputs</em></span> and one <span class="emphasis"><em>output</em></span>; in the list, the input is depicted by a line coming into the primitive box horizontally from the right, and the output is the line going from the box vertically downward. As you can see, the outputs of some primitives are the inputs for others.</p><p>You can wire the connections yourself by dragging; start by dragging from the input triangle at the right-hand edge of a primitive’s box. Generally, information flows from top to bottom in the stack of primitives; the output of the bottommost primitive is what you see rendered in the document window. You can also rearrange the primitives by dragging; a right-click menu allows you to duplicate or delete a primitive.</p><p>What are the vertically stacked boxes on the right? These are the predefined sources that any primitive can use as input. The most useful (and, as of version 0.47, the only ones fully implemented) are <span class="strong"><strong>Source Graphic</strong></span> and <span class="strong"><strong>Source Alpha</strong></span>. <span class="strong"><strong>Source Graphic</strong></span>, as the name implies, supplies the original rendered image of the object we’re filtering, at the current zoom’s resolution. The <span class="strong"><strong>Source Alpha</strong></span> is different in that it provides a grayscale representation of the original object’s opacity (alpha) mask; so, points that are fully opaque (regardless of color) in the <span class="strong"><strong>Source Graphic</strong></span> will be opaque black on the <span class="strong"><strong>Source Alpha</strong></span> image, and points that are transparent will be transparent black.</p></div><div class="sect2" title="17.4.3 The Parameters of a Primitive"><div class="titlepage"><div><div><h2 class="title"><a id="one7dot4dot3_the_parameters_of_a_primiti"/>17.4.3 The Parameters of a Primitive</h2></div></div></div><p><a id="iddle1664" class="indexterm"/>Let’s look again at the two <span class="strong"><strong>Turbulence</strong></span> primitives at the top of the stack. They both take <span class="strong"><strong>Source Alpha</strong></span> as input and pass their result—random noise—down to other primitives. What differentiates them are the parameters of these filters.</p><p>When you select a filter primitive in the stack, its parameters are displayed in the bottom area of the dialog. Here are the parameters of the two <span class="strong"><strong>Turbulence</strong></span> primitives:</p><div class="figure"><a id="parameters_of_the_two_turbulence_primiti"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00334"/><img src="httpatomoreillycomsourcenostarchimages1736326.png.jpg" alt="The parameters of the two Turbulence primitives"/></div></div><p class="title">Figure 17-20. The parameters of the two Turbulence primitives</p></div><p>As you see, these two primitives have the same <span class="strong"><strong>Type</strong></span> (<span class="strong"><strong>Fractal Noise</strong></span>, which looks better in our case than the other option, <span class="strong"><strong>Turbulence</strong></span>) but differ in <span class="strong"><strong>Base Frequency</strong></span> and <span class="strong"><strong>Octaves</strong></span>. The <span class="strong"><strong>Base Frequency</strong></span> parameter determines the scale of the turbulence; higher frequency results in smaller, sand-like texture, while lower frequency produces larger clouds. The number of <span class="strong"><strong>Octaves</strong></span> specifies, in fractal terminology, how deep is the recursion in the algorithm: Increasing <span class="strong"><strong>Octaves</strong></span> produces sharper unevenness with more small details; decreasing this value gives a smoother, more nebulous image.</p><p>Now, we need to composite our turbulence outputs together. For this, we will use another primitive, aptly named <span class="strong"><strong>Composite</strong></span>:</p><div class="figure"><a id="composite_primitive"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00335"/><img src="httpatomoreillycomsourcenostarchimages1736328.png.jpg" alt="The Composite primitive"/></div></div><p class="title">Figure 17-21. The Composite primitive</p></div><p><a id="iddle2281" class="indexterm"/><a id="iddle4510" class="indexterm"/>It has two inputs and combines them, pixel by pixel, using one of a number of methods. Here, I used the <span class="strong"><strong>Arithmetic</strong></span> method; with the provided numeric values for the coefficients (<span class="strong"><strong>K1</strong></span> to <span class="strong"><strong>K4</strong></span>), it results in the large-scale wave and small-scale ripples being combined into a composite with somewhat increased contrast, as shown in <a class="xref" href="ch17s04.html#result_of_compositing_two_turbulences" title="Figure 17-22. The result of compositing two turbulences">Figure 17-22</a>.</p><div class="figure"><a id="result_of_compositing_two_turbulences"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00336"/><img src="httpatomoreillycomsourcenostarchimages1736330.png.jpg" alt="The result of compositing two turbulences"/></div></div><p class="title">Figure 17-22. The result of compositing two turbulences</p></div><div class="note" title="Note"><h3 class="title"><a id="ch17note07"/>Note</h3><p><span class="emphasis"><em>Refer to the SVG specification</em></span> (<a class="ulink" href="http://w3.org/TR/SVG11">http://w3.org/TR/SVG11</a>) <span class="emphasis"><em>for the detailed formulas used by the <span class="strong"><strong>Composite</strong></span> filter in various modes.</em></span></p></div><p>So far, we didn’t use the image of the object itself to which we will apply the filter—that is, didn’t use the <span class="strong"><strong>Source Graphic</strong></span>. Supposedly, that object would be some kind of broad brush-like path, likely created with the Calligraphic pen tool (<span class="strong"><strong><a class="xref" href="ch14s03.html" title="14.3 The Calligraphic Pen Tool">14.3 The Calligraphic Pen Tool</a></strong></span>). Of course, the first thing we need do to a flat-color, crisp-edged path to make it more like a watercolor stroke is to blur it:</p><div class="figure"><a id="gaussian_blur_primitive"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00337"/><img src="httpatomoreillycomsourcenostarchimages1736332.png.jpg" alt="The Gaussian Blur primitive"/></div></div><p class="title">Figure 17-23. The Gaussian Blur primitive</p></div><p>The <span class="strong"><strong>Standard Deviation</strong></span> parameter of <span class="strong"><strong>Gaussian Blur</strong></span> is similar to the blur amount you would adjust in the <span class="strong"><strong>Fill and Stroke</strong></span> dialog (<a class="xref" href="ch17s01.html#blur_slider_in_the_fill_and_stroke_dialo" title="Figure 17-1. The Blur slider in the Fill and Stroke dialog">Figure 17-1</a>), except that here it is measured in absolute <code class="literal">px</code> units (<span class="strong"><strong><a class="xref" href="apas06.html" title="A.6 Coordinates and Units">A.6 Coordinates and Units</a></strong></span>) instead of percentages of the object’s size.</p><p>How do we combine the blurred stroke with the turbulence? <span class="strong"><strong>Composite</strong></span> won’t work here. Any of its modes will just result in a smooth blur being <span class="emphasis"><em>overlaid</em></span> with the turbulent ripples, but the underlying smoothness will not go anywhere (try it). It won’t look like watercolor on a rough paper at all—it will look more like computer-produced blur viewed through a spotted glass.</p><p>Let’s consider what happens when you paint with a real brush on a real paper. The blurriness of your stroke results from the softness of the brush—you apply more pressure in the middle than on the edges of the brush. When a brush meets a dimple in the paper, that pressure is changed; if this area of the paper <a id="iddle1804" class="indexterm"/>is a rise, it will get painted more intensively, as if it were closer to the maximum-pressure point of the brush; if it is a depression, it will get less paint. In other words, the roughness of the paper jitters the blurred stroke <span class="emphasis"><em>in the plane of the drawing</em></span>, as if randomly displacing parts of the stroke sideways. How do we achieve this with filters?</p><p>The <span class="strong"><strong>Displacement Map</strong></span> primitive is a perfect match for the job. It takes its first input and moves its pixels around according to its second input. You can choose which of the channels (Red, Green, Blue, or Alpha) of the second input will move the first in each of the two axis directions (X and Y), as well as scale this displacement. In our case, the first input is the blurred object, and the second input is the composite turbulence field, of which we take the Alpha channel for both axes:</p><div class="figure"><a id="displacement_map_primitive"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00338"/><img src="httpatomoreillycomsourcenostarchimages1736334.png.jpg" alt="The Displacement Map primitive"/></div></div><p class="title">Figure 17-24. The Displacement Map primitive</p></div><p>As an added bonus, the result looks rougher in some areas and smoother in others. This is because in the smooth areas, the displacement map hits the almost-flat inner parts of the blurred stroke, and there, the high-frequency jitter just moves around pixels of almost the same color without disturbing the smoothness. On the edges of the stroke, however, different-color pixels are mixed and jittered, producing visible roughness. All this is additionally modulated by the low-frequency noise, producing a very convincing watercolor simulation.</p><p>However, if you apply this filter to a light-colored stroke (and not black as in <a class="xref" href="ch17s04.html#displacement_map_primitive" title="Figure 17-24. The Displacement Map primitive">Figure 17-24</a>), the result is still not quite perfect. When you’re looking at a real rough paper with watercolor strokes on it, what you see is not just the distribution of the paint; you also see the roughness itself, which looks like a pattern of shades. Without this shading, light-colored strokes with our filter still look too unnaturally flat. Fortunately, that is easy to fix; we already have the high-frequency turbulence source, which will work nicely as shading if we just compose it with our displacement-mapped blur, as shown in <a class="xref" href="ch17s04.html#final_filter_and_the_parameters_of_the_l" title="Figure 17-25. The final filter and the parameters of the last Composite primitive which overlays the shading">Figure 17-25</a>.</p><p><a id="iddle1362" class="indexterm"/><a id="iddle1585" class="indexterm"/><a id="iddle2195" class="indexterm"/>Now the filter looks pretty decent, and we can declare it complete. You could continue working on it, adding various smears, water leaks, diffusion, and so on; however, since my demo image used this filter only for the background, I thought it was already good enough for the purpose.</p><div class="figure"><a id="final_filter_and_the_parameters_of_the_l"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00339"/><img src="httpatomoreillycomsourcenostarchimages1736336.png.jpg" alt="The final filter and the parameters of the last Composite primitive which overlays the shading"/></div></div><p class="title">Figure 17-25. The final filter and the parameters of the last Composite primitive which overlays the shading</p></div></div><div class="sect2" title="17.4.4 The Filter Area"><div class="titlepage"><div><div><h2 class="title"><a id="one7dot4dot4_the_filter_area"/>17.4.4 The Filter Area</h2></div></div></div><p>The second tab in the filter parameter area in the <span class="strong"><strong>Filter Editor</strong></span> dialog is called <span class="strong"><strong>Filter General Settings</strong></span>. It contains parameters that apply to the entire filter stack, not any single primitive. Currently, the only thing you can change here is the <span class="emphasis"><em>filter area</em></span>—the area which the filter will render into, measured in the units of the bounding box of the object to which the filter is applied.</p><p>The <span class="strong"><strong>Coordinates</strong></span> line specifies the top-left corner of the area, and the <span class="strong"><strong>Dimensions</strong></span> line specifies the bottom-right corner. For example, if you set the <span class="strong"><strong>Coordinates</strong></span> to 0/0 in and the <span class="strong"><strong>Dimensions</strong></span> to 1/1, the area will be exactly equal to the bounding box. This will work fine if your filter does not reach beyond the object in any way—for example, if you’re just performing a color change with a <span class="strong"><strong>Color Matrix</strong></span> primitive. However, if you are using something like blur in your filter, it will need to paint outside the bounding box, and you must provide sufficient margins for this to prevent cropping. When you apply blur via the <span class="strong"><strong>Fill and Stroke</strong></span> dialog, these margins are set for you automatically; however, when <a id="iddle1366" class="indexterm"/><a id="iddle2030" class="indexterm"/><a id="iddle2031" class="indexterm"/><a id="iddle2064" class="indexterm"/><a id="iddle2069" class="indexterm"/><a id="iddle2073" class="indexterm"/><a id="iddle2078" class="indexterm"/><a id="iddle2084" class="indexterm"/><a id="iddle2202" class="indexterm"/><a id="iddle2213" class="indexterm"/><a id="iddle2220" class="indexterm"/><a id="iddle2602" class="indexterm"/><a id="iddle2638" class="indexterm"/><a id="iddle2926" class="indexterm"/><a id="iddle3196" class="indexterm"/><a id="iddle3426" class="indexterm"/><a id="iddle3430" class="indexterm"/><a id="iddle3535" class="indexterm"/><a id="iddle3561" class="indexterm"/><a id="iddle3563" class="indexterm"/>creating a new filter stack from scratch, you must take care of it yourself. The default is 0.1/0.1 for <span class="strong"><strong>Coordinates</strong></span> and 1.2/1.2 for <span class="strong"><strong>Dimensions</strong></span>, which results in 10 percent margins on all sides of the object, as shown in <a class="xref" href="ch17s04.html#specifying_the_filter_area" title="Figure 17-26. Specifying the filter area">Figure 17-26</a>.</p><div class="figure"><a id="specifying_the_filter_area"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00340"/><img src="httpatomoreillycomsourcenostarchimages1736338.png.jpg" alt="Specifying the filter area"/></div></div><p class="title">Figure 17-26. Specifying the filter area</p></div><p>If the visual bounding box option is used (which is the default, see <span class="strong"><strong><a class="xref" href="ch04s02.html" title="4.2 The Bounding Box">4.2 The Bounding Box</a></strong></span>), the bounding box of a filtered object—the frame you see when you select it in Selector—is the enlarged filter area. Among other things, this means that, when exporting a selected object to bitmap (<span class="strong"><strong><a class="xref" href="ch18s09.html" title="18.9 Bitmap Export">18.9 Bitmap Export</a></strong></span>), Inkscape will make sure the bitmap contains the blurred edges without cropping.</p></div></div>
<div class="sect1" title="17.5 Filter Rendering Options"><div class="titlepage"><div><div><h1 class="title"><a id="one7dot5_filter_rendering_options"/>17.5 Filter Rendering Options</h1></div></div></div><p>As you may have noticed by now, for all their power, filters in Inkscape have a significant drawback: They are <span class="emphasis"><em>slow</em></span>. Sometimes, very slow. While future versions of the program may to some extent address this (most likely, by enabling Inkscape to use the graphics card processor for filter calculations), there’s something you can do right now.</p><p>First of all, recall that you can always switch to the Outline mode (<span class="strong"><strong><a class="xref" href="ch03s11.html" title="3.11 Rendering Modes">3.11 Rendering Modes</a></strong></span>) to speed up rendering while working on a document. There is also the No Filters mode, which is the same as normal mode except that no filters are rendered; this is perhaps the best option if filters are the main source of slowness for you.</p><p>Also, the <span class="strong"><strong>Filters</strong></span> tab of the <span class="strong"><strong>Inkscape Preferences</strong></span> dialog (<a class="xref" href="ch17s05.html#filters_tab_of_the_inkscape_preferences" title="Figure 17-27. The Filters tab of the Inkscape Preferences dialog">Figure 17-27</a>) has some settings that you can try to tweak to speed up rendering. The first group of radio buttons applies to blur and allows you to choose your desired level of the speed/quality tradeoff. The default, <span class="strong"><strong>Average quality</strong></span>, looks <span class="emphasis"><em>almost</em></span> perfect and renders reasonably fast. At lower quality settings, visible defects appears, but rendering becomes even faster; the higher settings bring little quality improvement but are significantly slower.</p><div class="note" title="Note"><h3 class="title"><a id="ch17note08"/>Note</h3><p><span class="emphasis"><em>Bitmap export (<span class="strong"><strong><a class="xref" href="ch18s09.html" title="18.9 Bitmap Export">18.9 Bitmap Export</a></strong></span>) as well as rasterization of filters for PS/EPS/PDF export always use the highest quality of blur, which is why exporting is typically slower that rendering the same image on screen at the same resolution.</em></span></p></div><p><a id="iddle1301" class="indexterm"/><a id="iddle1646" class="indexterm"/><a id="iddle2087" class="indexterm"/>The second set of radio buttons applies to all filters (including blur). It also offers to trade an improvement in rendering speed for worse rendering quality, but its speed advantage is less significant, so here the <span class="strong"><strong>Best quality</strong></span> option is probably optimal.</p><div class="figure"><a id="filters_tab_of_the_inkscape_preferences"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00341"/><img src="httpatomoreillycomsourcenostarchimages1736340.png.jpg" alt="The Filters tab of the Inkscape Preferences dialog"/></div></div><p class="title">Figure 17-27. The Filters tab of the Inkscape Preferences dialog</p></div></div>
<div class="sect1" title="17.6 Exporting Filters to PS and PDF"><div class="titlepage"><div><div><h1 class="title"><a id="one7dot6_exporting_filters_to_ps_and_pdf"/>17.6 Exporting Filters to PS and PDF</h1></div></div></div><p>Since version 0.47, Inkscape no longer ignores filters when exporting to PostScript and PDF formats (which, while being vector, do not support anything like SVG’s filters). Now, any object with a filter applied will be by default rasterized (i.e., converted into a bitmap object) in the exported file, fully preserving the appearance it had in Inkscape (but, potentially, increasing the file size). In the export options dialog, you can specify the resolution of the bitmaps, as well as turn rasterization off, in which case objects will remain vector but will lose any filtering.</p><div class="figure"><a id="specifying_the_treatment_of_filters_when"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00342"/><img src="httpatomoreillycomsourcenostarchimages1736342.png.jpg" alt="Specifying the treatment of filters when exporting"/></div></div><p class="title">Figure 17-28. Specifying the treatment of filters when exporting</p></div><p>When performing export via the command line (<span class="strong"><strong><a class="xref" href="apcs02.html" title="C.2 Export">C.2 Export</a></strong></span>), the corresponding options are <code class="literal">--export-dpi</code> to specify the resolution and <code class="literal">--export-ignore-filters</code> to turn off rasterization.</p></div></body></html>