<html><head></head><body>

<div class="calibre21" id="calibre_pb_0"/><div class="calibre1" id="calibre_toc_67">
<a name="ch04" class="calibre6" id="ch04"/>
<div class="calibre1">
<h2 class="lot-title" id="calibre_pb_1"><a name="69" class="calibre16" id="69"/><a name="ch04lev1sec33" class="calibre16" id="ch04lev1sec33"/><span class="chapter-titlelabel">Program 59: </span>Son of Weird Names</h2><p class="b24-bookeditorial">This program is designed to generate unique names every time <span>tmp_name</span> is called. To test it, we decided to print a couple of names. Yet our test isn't working. Why?</p>
<div class="calibre1">
<pre class="literallayout-normal">
  1 /************************************************
  2  * test the tmp_name function.                  *
  3  ************************************************/
  4 #include &lt;iostream&gt;
  5 #include &lt;cstdio&gt;
  6 #include &lt;cstring&gt;
  7 #include &lt;sys/param.h&gt;
  8 /************************************************
  9  * tmp_name -- return a temporary file name.    *
 10  *                                              *
 11  * Each time this function is called, a new     *
 12  *      name will be returned.                  *
 13  *                                              *
 14  * Returns                                      *
 15  *      Pointer to the new file name.           *
 16  ************************************************/
 17 char *tmp_name(void)
 18 {
 19     // The name we are generating
 20     static char name[MAXPATHLEN];
 21
 22     // The directory to put the temporary file in
 23     const char DIR[] = "/var/tmp/tmp";
 24
 25     // Sequence number for last digit
 26     static int sequence = 0;
 27
 28     ++sequence; /* Move to the next file name */
 29
 30     std::sprintf(name, "%s.%d", DIR, sequence);
 31     return(name);
 32 }
 33
 34 int main()
 35 {
 36     // The first temporary name
 37     char *a_name = tmp_name();
 38
 39     // The second temporary name
 40     char *b_name = tmp_name();
 41
 42     std::cout &lt;&lt; "Name (a): " &lt;&lt; a_name &lt;&lt; endl;
 43     std::cout &lt;&lt; "Name (b): " &lt;&lt; b_name &lt;&lt; endl;
 44     return(0);
 45 }
</pre>
</div>
<p class="b24-bookeditorial">(Next <a href="LiB0120.html#458" target="_parent" class="calibre2">Hint 322</a>. <a href="LiB0121.html#562" target="_parent" class="calibre2">Answer 64</a>.)</p>
<div class="calibre1">
<table class="calibre3" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr class="calibre4">
<td class="bluecell"><span class="calibre22"><b class="calibre13"><img src="_1.gif" alt="Start Sidebar" border="0" class="calibre23"/></b></span></td>
</tr>
</table>
<p class="b24-bookeditorial">I was assigned to program a newly built light panel. Light #1 was supposed to be "Data Fail," light #2 "Change Filter," light #3 "Oil Pressure Low" and so on.</p>
<p class="b24-bookeditorial">A short test revealed that the panel was wired wrong. Light #1 was "Oil Pressure Low," Light #2 "Oil Pressure Low," and so on.</p>
<p class="b24-bookeditorial">I carefully copied down the numbers for the lights and then hunted up the hardware designer.</p>
<p class="b24-bookeditorial">"Woody," I said, "the lights are wired up wrong."</p>
<p class="b24-bookeditorial">"Do you know how they are wired up now?"</p>
<p class="b24-bookeditorial">I handed him my list. He took it from my hands, looked it over quickly, walked over to the copier and made a copy. Then he gave me a copy (not even the original) and said, "Here's the new specification."</p>
<table class="calibre3" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr class="calibre4">
<td class="bluecell"><span class="calibre22"><b class="calibre13"><img src="_1.gif" alt="End Sidebar" border="0" class="calibre23"/></b></span></td>
</tr>
</table>
</div>
<table class="calibre3" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr class="calibre4">
<td height="16" class="calibre8"/>
</tr>
</table>
</div>
</div>



</body></html>