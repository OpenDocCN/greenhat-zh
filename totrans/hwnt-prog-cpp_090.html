<html><head></head><body>

<div class="calibre21" id="calibre_pb_0"/><div class="calibre1" id="calibre_toc_99">
<a name="ch07" class="calibre6" id="ch07"/>
<div class="calibre1">
<h2 class="lot-title" id="calibre_pb_1"><a name="103" class="calibre16" id="103"/><a name="ch07lev1sec8" class="calibre16" id="ch07lev1sec8"/><span class="chapter-titlelabel">Program 88: </span>File This!</h2><p class="b24-bookeditorial">Due to some brain-damaged program requirements, the following function must copy from a <span>FILE</span> to an <span>ostream.</span> Why does it fail to work?</p>
<div class="calibre1">
<pre class="literallayout-normal">
  1 /************************************************
  2  * copy -- Copy the input file to the output    *
  3  *      file.                                   *
  4  ************************************************/
  5 #include &lt;cstdio&gt;
  6 #include &lt;iostream&gt;
  7 #include &lt;fstream&gt;
  8
  9 /************************************************
 10  * copy_it -- Copy the data                     *
 12 void copy_it(
 13     FILE *in_file,      // Input file
 14     std::ostream &amp;out_file   // Output file
 15 )
 16 {
 17     int ch;      // Current char
 18
 19     while (1) {
 20         ch = std::fgetc(in_file);
 21         if (ch == EOF)
 22             break;
 23         out_file &lt;&lt; ch;
 24     }
 25 }
 26
 27 int main()
 28 {
 29     // The input file
 30     FILE *in_file = std::fopen("in.txt", "r");
 31     // The output file
 32     std::ofstream out_file("out.txt");
 33
 34     // Check for errors
 35     if (in_file == NULL) {
 36         std::cerr &lt;&lt;
 37             "Error: Could not open input\n";
 38         exit (8);
 39     }
 40     if (out_file.bad()) {
 41         std::cerr &lt;&lt;
 42             "Error: Could not open output\n";
 43         exit (8);
 44     }
 45     // Copy data
 46     copy_it(in_file, out_file);
 47
 48     // Finish output file
 49     std::fclose(in_file);
 50     return (o);
 51 }
</pre>
</div>
<p class="b24-bookeditorial">(Next <a href="LiB0120.html#146" target="_parent" class="calibre2">Hint 10</a>. <a href="LiB0121.html#597" target="_parent" class="calibre2">Answer 99</a>.)</p>
<div class="calibre1">
<table class="calibre3" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr class="calibre4">
<td class="bluecell"><span class="calibre22"><b class="calibre13"><img src="_1.gif" alt="Start Sidebar" border="0" class="calibre23"/></b></span></td>
</tr>
</table>
<p class="b24-bookeditorial">Error messages from an old Apple C compiler:</p>
<p class="b24-bookeditorial">"Symbol table full - fatal heap error; please go buy a RAM upgrade from your local Apple dealer"</p>
<p class="b24-bookeditorial">"String literal too long (I let you have 512 characters, that's 3 more than ANSI said I should)"</p>
<p class="b24-bookeditorial">"Type in (cast) must be scalar; ANSI 3.3.4; page 39, lines 10-11 (I know you don't care, I'm just trying to annoy you)"</p>
<p class="b24-bookeditorial">"Too many errors on one line (make fewer)"</p>
<p class="b24-bookeditorial">"Can't cast a void type to type void (because the ANSI spec. says so, that's why)"</p>
<p class="b24-bookeditorial">"... And the lord said, 'lo, there shall only be case or default labels inside a switch statement'"</p>
<p class="b24-bookeditorial">"A typedef name was a complete surprise to me at this point in your program"</p>
<p class="b24-bookeditorial">"'Volatile' and 'Register' are not miscible"</p>
<p class="b24-bookeditorial">"You can't modify a constant, float upstream, win an argument with the IRS, or satisfy this compiler"</p>
<p class="b24-bookeditorial">"This union already has a perfectly good definition"</p>
<p class="b24-bookeditorial">"Huh?"</p>
<p class="b24-bookeditorial">"Can't go mucking with a 'void *'"</p>
<p class="b24-bookeditorial">"This struct already has a perfectly good definition"</p>
<p class="b24-bookeditorial">"We already did this function"</p>
<p class="b24-bookeditorial">"This label is the target of a goto from outside of the block containing this label AND this block has an automatic variable with an initializer AND your window wasn't wide enough to read this whole error message"</p>
<p class="b24-bookeditorial">"Call me paranoid but finding '/*' inside this comment makes me suspicious"</p>
<table class="calibre3" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr class="calibre4">
<td class="bluecell"><span class="calibre22"><b class="calibre13"><img src="_1.gif" alt="End Sidebar" border="0" class="calibre23"/></b></span></td>
</tr>
</table>
</div>
<table class="calibre3" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr class="calibre4">
<td height="16" class="calibre8"/>
</tr>
</table>
</div>
</div>



</body></html>