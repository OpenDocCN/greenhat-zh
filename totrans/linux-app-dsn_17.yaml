- en: '![](../images/333-1.jpg)'
  id: totrans-0
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/333-1.jpg)'
- en: '[**REVIEW OF SNMP**](toc.html#app2)'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '[**SNMP综述**](toc.html#app2)'
- en: '![](../images/as.jpg)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/as.jpg)'
- en: This appendix is supplied for those who would like additional details or background
    information on SNMP.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本附录提供了一些人希望了解SNMP的额外详细信息或背景信息。
- en: 'In this appendix, we will cover the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在本附录中，我们将涵盖以下主题：
- en: Why SNMP
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为什么选择SNMP
- en: Agents and managers
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 代理和管理员
- en: Namespace, grammar, and protocol
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 命名空间、语法和协议
- en: The MIB
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MIB
- en: The OID
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: OID
- en: MIB-2
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MIB-2
- en: The SMI
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SMI
- en: The SNMP protocol
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SNMP协议
- en: SNMPv1, SNMPv2, and SNMPv3
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SNMPv1、SNMPv2和SNMPv3
- en: SNMP data types
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SNMP数据类型
- en: Defining new types
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定义新类型
- en: Structure of an MIB file
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MIB文件的结构
- en: '[**Why SNMP?**](toc.html#app2.1)'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: '[**为什么选择SNMP？**](toc.html#app2.1)'
- en: In the early 1970s, computers and their I/O devices were large enough to need
    air-conditioned rooms of their own. Most large companies performed their computing
    tasks on stand-alone systems. It wasn’t hard to tell when something went wrong—an
    error would print on the system console, and the front panel lights would stop
    blinking.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在20世纪70年代初，计算机及其I/O设备足够大，需要自己的空调房间。大多数大型公司在其独立的系统上执行计算任务。当出现问题时并不难发现——错误会打印在系统控制台上，前面板的指示灯会停止闪烁。
- en: Today, even small technology companies have a server room with racks of computers
    and network appliances from multiple vendors, including switches, routers, print
    servers, webservers, RAID servers, and so forth. Network printers are distributed
    at convenient locations around the site, and each desk has a desktop or laptop
    computer. In fact, high-tech firms typically have more computers than employees.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 今天，即使是小型科技公司也有一个服务器室，里面摆满了来自多个供应商的计算机和网络设备，包括交换机、路由器、打印服务器、Web服务器、RAID服务器等等。网络打印机分布在站点周围的便利位置，每个办公桌都有一台桌面或笔记本电脑。实际上，高科技公司通常拥有的计算机比员工还多。
- en: Unlike those large computers of yore, the failure of any single component in
    this network of devices is not so easy to detect. IT managers need some form of
    automation to help them manage all these devices.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 与那些古老的计算机不同，这个设备网络中任何单个组件的故障并不容易检测。IT经理需要某种形式的自动化来帮助他们管理所有这些设备。
- en: The automation may be as simple as a roll-your-own script that performs periodic
    ping sweeps, but larger networks are likely to rely on a Network Management System
    (NMS) that uses SNMP, such as Hewlett Packard’s OpenView. Such a system can tell
    much more than when a device breaks down. It can record performance statistics,
    keep a restart history, and maintain a log of notifications sent from the devices
    themselves about impending problems. Devices may report excessive packet drops
    or retransmissions; connectivity failures; a fan running slowly or a CPU running
    too hot; excessive CPU, memory, or disk utilization; as well as system restarts.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 自动化可能只是执行定期ping扫描的自定义脚本，但大型网络可能更倾向于依赖使用SNMP的网络管理系统（NMS），例如惠普的OpenView。这样的系统可以提供比设备故障更多的信息。它可以记录性能统计信息，保持重启历史记录，并维护设备自身发送的关于即将出现问题的通知日志。设备可能会报告过量的数据包丢失或重传；连接故障；风扇运行缓慢或CPU过热；过度的CPU、内存或磁盘利用率；以及系统重启。
- en: '[**Agents and Managers**](toc.html#app2.2)'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '[**代理和管理员**](toc.html#app2.2)'
- en: The managed devices (routers, switches, web hosts, desktop computers, network
    printers, and so on) each run a server process (daemon) called an SNMP agent.
    This *agent* listens on a particular UDP port (usually, but not always, port 161)
    for read (GET) and write (SET) commands. It’s the agent’s responsibility to fetch
    the requested data and return it. This agent, as well as other monitoring software
    on the device, may also send spontaneous notifications called *traps* or *informs*
    to one or more configured target systems.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 管理设备（路由器、交换机、Web主机、桌面计算机、网络打印机等）每个都运行一个名为SNMP代理的服务器进程（守护进程）。这个*代理*监听特定的UDP端口（通常是，但不总是，端口161）以接收读（GET）和写（SET）命令。获取请求的数据并返回是代理的责任。这个代理以及其他设备上的监控软件还可以向一个或多个配置的目标系统发送自发的通知，称为*陷阱*或*通知*。
- en: Management applications (*managers*) poll the agents for information. They may
    keep historical information, generate reports, or create graphical maps of the
    devices in your network. Some management applications are just simple command-line
    tools (like the snmpwalk, snmpget, and snmpset commands supplied with Net-SNMP).
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 管理应用程序（*管理员*）轮询代理以获取信息。它们可以保留历史信息，生成报告，或创建网络中设备的图形映射。一些管理应用程序只是简单的命令行工具（如Net-SNMP提供的snmpwalk、snmpget和snmpset命令）。
- en: '[**Namespace, Grammar, and Protocol**](toc.html#app2.3)'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '[**命名空间、语法和协议**](toc.html#app2.3)'
- en: SNMP stands for Simple Network Management Protocol, but it is actually more
    than just a protocol—it’s a way of naming data, a grammar for describing data,
    and a protocol for exchanging data over a network. These components are called
    the *MIB* (the naming scheme), *SMI* (the grammar) and the *SNMP protocol*. The
    RFCs that describe SNMP include a common set of information useful in managing
    networked devices. This is called called *MIB-2* (it took two tries to get it
    right). We’ll be discussing more about MIB-2 later.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: SNMP 代表简单网络管理协议，但实际上它不仅仅是一个协议——它是一种命名数据的方式，是描述数据的语法，以及在网络中交换数据的协议。这些组件被称为 *MIB*（命名方案）、*SMI*（语法）和
    *SNMP 协议*。描述 SNMP 的 RFC 包含一组有用的信息，用于管理网络设备。这被称为 *MIB-2*（需要两次尝试才能正确）。我们将在稍后讨论更多关于
    MIB-2 的内容。
- en: '[**The MIB**](toc.html#app2.4)'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '[**MIB**](toc.html#app2.4)'
- en: MIB stands for *Management Information Base.* That’s a mouthful, but you can
    just think of it as a hierarchical naming scheme for a virtual database. This
    is a “virtual” database because the data may not exist anywhere in storage until
    the agent receives a request to read the data. When asked for an object (think
    of this as a field in a record in the database) the agent retrieves the information
    and returns it in a process that may involve getting multiple pieces of information
    from the managed system and computing the value to be returned. (You might think
    of this as a just-in-time database.) The very act of requesting a piece of information
    may trigger the creation of the value.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: MIB 代表 *管理信息库*。这个词听起来有点复杂，但你可以把它想象成一个虚拟数据库的分层命名方案。这是一个“虚拟”数据库，因为数据可能不存在存储的任何地方，直到代理收到读取数据的请求。当请求一个对象（可以将其视为数据库记录中的一个字段）时，代理检索信息，并在可能涉及从管理系统获取多个信息片段并计算返回值的处理过程中返回信息。（你可以将其视为即时数据库。）请求信息本身的行为可能会触发值的创建。
- en: Although there is one universal addressing scheme, we break it down into subdivisions,
    which we also call MIBs. Normally, when people use the word *MIB,* they are referring
    not to the overall namespace, but to one of these subdivisions. MIB-2 is one of
    them, and many others are defined by different groups for different purposes.
    Some are produced by standards groups, while others are defined by private companies
    to describe proprietary data furnished by their networked products. (In Chapter
    14 we describe how you can define a private MIB for your own appliance and find
    a place for it in the namespace.)
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然有一个通用的寻址方案，但我们将其细分为子集，我们也将它们称为 MIB。通常，当人们使用“MIB”这个词时，他们不是指整体命名空间，而是指这些子集之一。MIB-2
    就是其中之一，还有许多其他由不同的小组为不同的目的定义。有些是由标准组织生产的，而有些则是由私人公司定义的，以描述其网络产品提供的专有数据。（在第 14 章中，我们描述了如何为你的设备定义一个私有的
    MIB，并在命名空间中为其找到一个位置。）
- en: '[**The OID**](toc.html#app2.5)'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '[**OID**](toc.html#app2.5)'
- en: 'Every object in every MIB has an object identifier (OID). An *OID* is a unique
    name consisting of a sequence of decimal digits separated by periods, or dots,
    like this:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 每个 MIB 中的每个对象都有一个对象标识符（OID）。*OID* 是一个由点或句点分隔的十进制数字序列的唯一名称，如下所示：
- en: .1.3.6.1.2.1.1.2.0
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: .1.3.6.1.2.1.1.2.0
- en: This name represents the object’s location in the namespace. The first dot represents
    the root of the tree, and each number represents a *node* (the base of a branch)
    in the tree. Everything nameable in SNMP is located somewhere in this OID tree,
    and every name (OID) contains the entire path to that object from the root of
    the tree.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 这个名称表示对象在命名空间中的位置。第一个点表示树的根，每个数字表示树中的一个 *节点*（分支的基）。SNMP 中可命名的所有内容都位于这个 OID 树的某个位置，每个名称（OID）都包含从树根到该对象的整个路径。
- en: This may look strange at first, but it works in the same way as the Unix filesystem,
    with which you should be familiar. Paths to files start at root, indicated by
    an initial slash (/), proceed through a number of named nodes *(directories)*
    separated by more slashes, and end with the name of the file itself.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 这一开始可能看起来有点奇怪，但它与你应该熟悉的 Unix 文件系统以相同的方式工作。文件的路径从根开始，由一个初始斜杠（/）表示，通过多个由斜杠分隔的命名节点（目录）进行，并以文件本身的名称结束。
- en: 'Let’s take the example of a file on a Unix filesystem:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们以 Unix 文件系统中的一个文件为例：
- en: /usr/local/bin/myprog
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/local/bin/myprog
- en: 'If we use a dot to separate directories instead of a slash, the path to the
    file would look like this:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们用点而不是斜杠来分隔目录，文件的路径将看起来像这样：
- en: .usr.local.bin.myprog
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: .usr.local.bin.myprog
- en: 'Suppose the following table defined a map between the directory names and a
    set of numbers:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 假设以下表定义了目录名称和一组数字之间的映射：
- en: '![](../images/336-1.jpg)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/336-1.jpg)'
- en: 'If we use the numbers in place of the names, the path would look like this:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们用数字代替名称，路径将看起来像这样：
- en: .1.3.6.1
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: .1.3.6.1
- en: 'Figure B-1 shows part of the OID tree (or namespace). Note that some nodes
    in the tree are named for organizations: ISO is the International Standards Organization,
    and DOD is the US Department of Defense. (The DOD is in this structure because
    it was instrumental in the creation of DARPANet, which originally consisted of
    a four-computer network. By 1972, DARPANet had grown to a network of 37 computers
    and was renamed ARPANet, which led to today’s Internet. End of history lesson.)'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 图 B-1 展示了 OID 树（或命名空间）的一部分。请注意，树中的一些节点是以组织命名的：ISO 是国际标准化组织，DOD 是美国国防部。（DOD 在这个结构中是因为它在
    DARPANet 的创建中发挥了重要作用，DARPANet 最初由一个四台计算机的网络组成。到 1972 年，DARPANet 已增长到 37 台计算机的网络，并更名为
    ARPANet，这导致了今天的互联网。历史课到此结束。）
- en: '![](../images/336-2.jpg)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/336-2.jpg)'
- en: '*Figure B-1: The OID tree*'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 B-1：OID 树*'
- en: The Internet Assigned Numbers Authority (IANA) is responsible for assigning
    numbers to companies and organizations under the *enterprises node*, giving the
    company or organization the authority to administer the OIDs in their own subtrees.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 互联网数字分配机构（IANA）负责在 *enterprises 节点*下分配数字给公司和组织，赋予公司或组织在其自己的子树中管理 OID 的权限。
- en: The part of the tree that we’re most interested in is under .1.3.6.1 (.iso.org
    .dod.internet). Beneath this node are the mgmt.mib-2 (.1.3.6.1.2.1) subtree and
    the private.enterprises (.1.3.6.1.4.1) subtree. MIB-2 is the common set of objects
    that we mentioned earlier; it is supported by all networked devices that are manageable
    by SNMP. The enterprises OID is where organizations register their private MIBs.
    (For more on this topic, see Chapter 14.)
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 我们最感兴趣的树的部分位于 .1.3.6.1 (.iso.org .dod.internet) 之下。在这个节点之下是 mgmt.mib-2 (.1.3.6.1.2.1)
    子树和 private.enterprises (.1.3.6.1.4.1) 子树。MIB-2 是我们之前提到的公共对象集合；它被所有可由 SNMP 管理的网络设备支持。enterprises
    OID 是组织注册其私有 MIB 的地方。（关于这个主题的更多信息，请参阅第 14 章。）
- en: '[**MIB-2**](toc.html#app2.6)'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: '[**MIB-2**](toc.html#app2.6)'
- en: MIB-2, defined in RFC 1213,¹ describes a core set of information that is helpful
    for managing networked devices. MIB-2 is organized into the ten groups shown below.
    Not all groups are supported on all networked devices, but you can generally expect
    to find most of them.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: MIB-2，定义在 RFC 1213 中，¹ 描述了一组有助于管理网络设备的核心信息。MIB-2 组织成下面显示的十个组。并非所有组都支持所有网络设备，但你可以普遍期望找到大多数组。
- en: '**System**'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '**系统**'
- en: This group contains objects such as sysDescr (a printable description of the
    operating system, hardware, networking software, etc.), sysContact (typically
    the email address of the person administering this system), sysLocation (a printable
    description of where the system is located), and sysObjectID (an OID that can
    be used to determine the type of device).
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 这个组包含诸如 sysDescr（操作系统的可打印描述，硬件，网络软件等）、sysContact（通常是管理此系统的人员的电子邮件地址）、sysLocation（系统的可打印位置描述）和
    sysObjectID（可以用来确定设备类型的 OID）等对象。
- en: '**Interfaces**'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '**接口**'
- en: This group is a table describing the network interfaces available on the system.
    The interfaces table contains information on the speed of each interface and the
    activity on the interface (octets in and out). By polling the in and out octets
    periodically, you can tell what percent of the bandwidth available in the interface
    is being used. This can help you monitor the capacity of routers in a network.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 这个组是一个描述系统上可用的网络接口的表。接口表包含每个接口的速度和接口上的活动（输入和输出的字节数）。通过定期轮询输入和输出的字节数，你可以知道接口上可用带宽的百分比正在被使用。这可以帮助你监控网络中路由器的容量。
- en: '**AT**'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '**AT**'
- en: This is the Address Translation group. MIB-2 deprecates this group and includes
    it only for compatibility with devices implementing MIB-1\. You should ignore
    this group unless you have a particular interest in SNMP history.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 这是地址转换组。MIB-2 废弃了这个组，但为了与实现 MIB-1 的设备兼容而包含它。除非你对 SNMP 历史有特别兴趣，否则你应该忽略这个组。
- en: '**IP**'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: '**IP**'
- en: This group includes information related to the IP (network) layer, including
    ipAddrTable (IP Address Table), which describes the IP address of the interfaces
    available on the system.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 这个组包括与 IP（网络）层相关的信息，包括 ipAddrTable（IP 地址表），它描述了系统上可用的接口的 IP 地址。
- en: '**ICMP**'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '**ICMP**'
- en: This group includes various Internet Control Message Protocol (ICMP) statistics.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 这个组包含了各种互联网控制消息协议（ICMP）的统计数据。
- en: '**TCP**'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '**TCP**'
- en: This group includes various TCP layer statistics, including the tcpConnTable
    (TCP Connection Table) describing the current TCP connections between this and
    other systems in the network. This table is often used in network discovery. Once
    you have the address of this system, you can find out the addresses of other systems
    that are in contact with it.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 这个组包含了各种 TCP 层的统计数据，包括 tcpConnTable（TCP 连接表），描述了与网络中其他系统之间的当前 TCP 连接。这个表常用于网络发现。一旦你有了这个系统的地址，你就可以找到与之联系的其他系统的地址。
- en: '**UDP**'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: '**UDP**'
- en: This group includes various User Datagram Protocol (UDP) datagram statistics.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 这个组包含了各种用户数据报协议（UDP）数据报的统计数据。
- en: '**EGP**'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: '**EGP**'
- en: This group contains Exterior Gateway Protocol (EGP) statistics for those systems
    supporting the EGP protocol.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 这个组包含支持 EGP 协议的系统的外部网关协议（EGP）统计数据。
- en: '**Transmission**'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '**传输**'
- en: This group contains information related to managing transmission media.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 这个组包含与传输媒体管理相关的信息。
- en: '**SNMP**'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: '**SNMP**'
- en: This group includes various statistics related to the SNMP protocol, itself.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 这个组包含了与 SNMP 协议本身相关的各种统计数据。
- en: '[**The SMI**](toc.html#app2.7)'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '[**SMI**](toc.html#app2.7)'
- en: MIBs are described using a grammar defined by the Structure of Management Information
    (SMI), which is a subset of Abstract Syntax Notation One (ASN.1). ASN.1 was created
    to allow description of data in a way independent of machine architecture (for
    example, no assumptions about endian-ness or word size). The SNMP SMI adopted
    a subset of the object types definable under ASN.1 and then simplified the notation.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: MIBs 使用结构化管理信息（SMI）定义的语法进行描述，SMI 是抽象语法表示法一（ASN.1）的一个子集。ASN.1 的创建是为了允许以与机器架构无关的方式描述数据（例如，不假设字节序或字大小）。SNMP
    SMI 采用了 ASN.1 下可定义的对象类型的一个子集，并简化了表示法。
- en: All you really need to know about all this is how to read and write the notation
    used to describe a MIB. This is best accomplished with minimal notation definitions
    illustrated by examples. You can create a new MIB largely by cutting and pasting
    from other MIBs.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 你真正需要了解的所有关于这些的信息是如何读取和写入用于描述 MIB 的表示法。这最好通过示例中的最小符号定义来实现。你可以通过从其他 MIB 中剪切和粘贴来创建一个新的
    MIB。
- en: '**NOTE**'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*We’ve attempted to keep our discussion of MIBs as simple as possible. For
    more in-depth coverage, pick up a copy of* Understanding SNMP MIBs *by David Perkins
    and Evan McGinnis (Prentice Hall, 1996).*'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '*我们尽量使对 MIB 的讨论尽可能简单。要深入了解，请参阅大卫·珀金斯和伊万·麦金尼斯（Prentice Hall，1996）所著的《理解 SNMP
    MIBs》。*'
- en: 'Here is an example of an object definition using the grammar described in the
    SMI:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是使用 SMI 中描述的语法的一个对象定义示例：
- en: '![](../images/338-1.jpg)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/338-1.jpg)'
- en: The ::= reads *is defined as*, and {mib-2 1} means that if mib-2 is .1.3.6.1.2.1,
    then system is .1.3.6.1.2.1.1\. Therefore, sysDescr is .1.3.6.1.2.1.1.1\. Each
    definition describes a single step in the OID tree.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: The ::= 读取 *定义为*，而 {mib-2 1} 表示如果 mib-2 是 .1.3.6.1.2.1，那么 system 是 .1.3.6.1.2.1.1。因此，sysDescr
    是 .1.3.6.1.2.1.1.1。每个定义描述了 OID 树中的单个步骤。
- en: Note that some object identifiers simply describe nodes in the tree structure
    and others describe objects you may actually read (leaf nodes). These are like
    directories and files in a filesystem. In fact, when you try to read sysDescr,
    you must ask for .1.3.6.1.4.1.1.1.0\. This is where we diverge a bit from the
    filesystem analogy. The ending zero says you are retrieving an *instance* of the
    object. Scalar object instances (scalars are just stand-alone objects not in a
    table) are always .0 (dot zero). In object-oriented terminology, it’s like .1.3.6.1.2.1.1.1
    is the *class*, while .0 describes an object that is an instance of the class.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，一些对象标识符仅仅描述了树结构中的节点，而另一些则描述了你可能实际读取的对象（叶节点）。这些就像文件系统中的目录和文件。实际上，当你尝试读取 sysDescr
    时，你必须请求 .1.3.6.1.4.1.1.1.0。这就是我们与文件系统类比有所不同的地方。结尾的零表示你正在检索对象的 *实例*。标量对象实例（标量是独立于表的独立对象）总是
    .0（点零）。在面向对象术语中，.1.3.6.1.2.1.1.1 是 *类*，而 .0 描述的是类的实例。
- en: This may make more sense if you think of objects as fields in a table structure
    that must be retrieved by a row index. The table row number would replace the
    zero. For example, ifDescr is a field in a table whose rows each describe information
    about a particular network interface on the machine. Another node under mib-2,
    interfaces, is described as
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你将对象视为表格结构中的字段，并且必须通过行索引检索它们，这可能会更有意义。表行号将替换零。例如，ifDescr是描述机器上特定网络接口信息的表格中的一个字段。mib-2下的另一个节点interfaces被描述为
- en: interfaces OBJECT IDENTIFIER ::= { mib-2 2 }
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: interfaces OBJECT IDENTIFIER ::= { mib-2 2 }
- en: 'If you retrieved the ifDescr field for the first two interfaces on a system,
    you might get this:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你检索了一个系统前两个接口的ifDescr字段，你可能会得到这个：
- en: interfaces.ifTable.ifEntry.ifDescr.1 = lo
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: interfaces.ifTable.ifEntry.ifDescr.1 = lo
- en: interfaces.ifTable.ifEntry.ifDescr.2 = eth0
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: interfaces.ifTable.ifEntry.ifDescr.2 = eth0
- en: 'Contrast this with what you might retrieve when asking for sysDescr:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 与请求sysDescr时可能检索到的内容进行对比：
- en: 'system.sysDescr.0 = Linux localhost.localdomain 2.4.18-27.8.0 #1 Fri Mar 14
    06:45:49 EST 2003 i686'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 'system.sysDescr.0 = Linux localhost.localdomain 2.4.18-27.8.0 #1 Fri Mar 14
    06:45:49 EST 2003 i686'
- en: The .1 and .2 at the end of the ifDescr OIDs indicate the table row from which
    they were retrieved. In SNMP table rows are numbered from 1, which leaves 0 to
    indicate a scalar.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: ifDescr OIDs结尾的.1和.2表示检索它们的表行。在SNMP中，表行从1开始编号，0用来表示标量。
- en: The SMI description of a MIB is normally distributed in a *MIB file.* This is
    a text file containing the unambiguous description of a portion of the universal
    MIB.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: MIB的SMI描述通常以*MIB文件*的形式分发。这是一个包含对通用MIB一部分无歧义描述的文本文件。
- en: 'Sometimes descriptions of individual tables are placed in separate files. Other
    files just contain common objects or definitions, such as textual conventions,
    used by a set of other MIB files. Generally, a private MIB for a particular product
    is described in a single file or a small set of files, importing types and conventions
    as needed from other files, much like the use of the #include statement in the
    C language.'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，单个表的描述会放在单独的文件中。其他文件可能只包含一组其他MIB文件使用的公共对象或定义，例如文本约定。通常，特定产品的私有MIB在一个文件或一组小文件中描述，根据需要从其他文件导入类型和约定，这与C语言中使用#include语句的使用方式类似。
- en: The MIB file is used as a formal definition of the MIB for humans, but it is
    also used programmatically to interpret SNMP responses for display to human beings.
    (We’ll see this below.) MIB files, therefore, must be as syntactically correct
    as any computer program. There are MIB compilers and checkers (the equivalent
    of the lint program for C) to help verify the correctness of a MIB file. (We discuss
    this further in Chapter 14, where we cover the creation and validation of our
    own MIB.)
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: MIB文件用作MIB的正式定义，供人类使用，但它也被程序化地用于解释SNMP响应以供人类显示。（我们将在下面看到这一点。）因此，MIB文件必须与任何计算机程序一样语法正确。有MIB编译器和检查器（类似于C语言的lint程序）来帮助验证MIB文件的正确性。（我们将在第14章中进一步讨论这一点，其中我们将涵盖创建和验证我们自己的MIB。）
- en: '[**The SNMP Protocol**](toc.html#app2.8)'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: '[**SNMP协议**](toc.html#app2.8)'
- en: Although worthy of a chapter all its own, we can understand most of what we
    need to know about the SNMP protocol from the Protocol Data Units (PDUs) it defines
    and their uses.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管值得单独成章，但我们可以从它定义的协议数据单元（PDUs）及其用途中了解关于SNMP协议的大部分内容。
- en: '[***The Basic Commands: GET, SET, GETNEXT***](toc.html#app2.9)'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '[***基本命令：GET, SET, GETNEXT***](toc.html#app2.9)'
- en: The SNMP protocol is used to exchange information between managed systems and
    the applications written to manage them. Managed systems host a daemon called
    an *agent,* usually named snmpd, which provides the ability to read information
    from or write information to one or more MIBs. The GET, SET, and GETNEXT PDUs
    are used to read from, write to, and walk a MIB.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: SNMP协议用于在受管理系统和用于管理它们的程序之间交换信息。受管理系统托管一个称为代理的守护进程，通常命名为snmpd，它提供了从MIB中读取信息或将信息写入MIB的能力。GET、SET和GETNEXT
    PDUs用于从MIB中读取、写入和遍历MIB。
- en: '[***Walking a MIB with GETNEXT***](toc.html#app2.10)'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: '[***使用GETNEXT遍历MIB***](toc.html#app2.10)'
- en: GETNEXT allows you to name one object and ask the agent to return the OID and
    value of the next object in the MIB tree. *Walking a MIB* means starting at some
    point in the OID tree and traversing the entire subtree below it with repeated
    use of the GETNEXT command. The walk is finished when the OID returned is not
    within the subtree defined by the first OID. An application can find out which
    MIBs are supported on a managed system by walking the entire MIB tree in this
    way.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: GETNEXT允许您指定一个对象，并要求代理返回MIB树中下一个对象的OID和值。*遍历MIB*意味着从OID树中的某个点开始，通过重复使用GETNEXT命令遍历其下的整个子树。当返回的OID不在由第一个OID定义的子树内时，遍历结束。通过以这种方式遍历整个MIB树，应用程序可以找出在受管系统中支持哪些MIB。
- en: '[***Traps and Informs***](toc.html#app2.11)'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: '[***陷阱和通知***](toc.html#app2.11)'
- en: Managed systems can also spontaneously send information to a configured target-management
    node, a process called sending an SNMP *trap* or *inform.* A trap is sent toward
    a target system, but the sender never knows if it got there. An inform is an improvement
    over a trap because it expects a reply from the receiver; it can be retried if
    the reply is not received in a reasonable amount of time.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 受管系统还可以自发地向配置的目标管理节点发送信息，这个过程称为发送SNMP *trap*或*inform*。trap是向目标系统发送的，但发送者永远不会知道它是否到达了那里。inform比trap有所改进，因为它期望接收者回复；如果未在合理的时间内收到回复，它可以重试。
- en: '[***Command-Line Tools: Examples***](toc.html#app2.12)'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '[***命令行工具：示例***](toc.html#app2.12)'
- en: Let’s look at some examples of using command-line tools that use the SNMP PDUs
    we have just discussed to achieve their function. These commands are supplied
    as part of the Net-SNMP package ([http://net-snmp.sourceforge.net](http://net-snmp.sourceforge.net/)),
    which we use throughout the SNMP chapters in this book.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看一些使用命令行工具的示例，这些工具使用我们刚刚讨论过的SNMP PDU来实现其功能。这些命令作为Net-SNMP包的一部分提供（[http://net-snmp.sourceforge.net](http://net-snmp.sourceforge.net/))，我们在本书的SNMP章节中一直使用它。
- en: To retrieve the sysDescr field shown in the previous section, you might issue
    the command
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 要检索上一节中显示的sysDescr字段，您可能需要发出以下命令
- en: snmpget -c public 10.1.1.21 .1.3.6.1.2.1.1.1.0
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: snmpget -c public 10.1.1.21 .1.3.6.1.2.1.1.1.0
- en: This asks for the instance of the sysDescr object from the system whose IP address
    is 10.1.1.21, using the community name public (think of this as a password). As
    you can guess from its name, the snmpget command generates an SNMP GET PDU.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 这要求从IP地址为10.1.1.21的系统获取sysDescr对象的实例，使用社区名称public（将其视为密码）。正如您从其名称中可以猜到的，snmpget命令生成一个SNMP
    GET PDU。
- en: 'Now let’s walk a subtree. The snmpwalk command uses a series of GETNEXT PDUs.
    If you issue the following command to retrieve the interface table from a system:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们遍历一个子树。snmpwalk命令使用一系列GETNEXT PDU。如果您发出以下命令以从一个系统中检索接口表：
- en: snmpwalk -c public 10.1.1.21 .1.3.6.1.2.1.2
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: snmpwalk -c public 10.1.1.21 .1.3.6.1.2.1.2
- en: 'This is what you might get back:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 这可能就是您会得到的结果：
- en: '![](../images/341-1.jpg)'
  id: totrans-106
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/341-1.jpg)'
- en: This output is a little awkward to read because it is a depth-first walk; that
    is, it walks down each column before going back to row one and starting down the
    next column. This is a result of the lexical ordering of the OIDs. For example,
    since ifDescr is ifEntry.1 and ifType is ifEntry.2, you see all ifDescr fields
    before any ifType fields.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 由于这是一个深度优先遍历；也就是说，它先遍历每一列，然后再回到第一行并开始下一列。这是OID的词法排序的结果。例如，由于ifDescr是ifEntry.1而ifType是ifEntry.2，所以在任何ifType字段之前，您都会看到所有ifDescr字段。
- en: '**KNOWING AN APPLIANCE BY ITS MIBS**'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '**通过MIB了解设备**'
- en: Walking can often identify the type of a machine by the MIBs it supports. For
    example, one of the authors was once assigned an IP address for a new workstation
    and found that someone else was already using this address. Since he had been
    assigned this address through proper channels, he assumed someone else was invalidly
    using it. He turned off his system and used another system to read system.sysContact
    from the offending system; this should have been set to the contact information
    for the administrator for that node, but it was not. He then tried walking all
    the MIBs supported by that system and found that it supported the printer MIB.
    Hmm . . . As it turned out, he had been incorrectly given the IP address of the
    department’s printer!
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 通过支持 MIBs 可以经常识别出机器的类型。例如，一位作者曾被分配了一个新工作站的 IP 地址，并发现有人已经在使用这个地址。由于他是通过正当渠道获得这个地址的，他假设其他人无效地使用了它。他关闭了自己的系统，并使用另一个系统从有问题的系统中读取
    system.sysContact；这应该设置为该节点的管理员联系信息，但并没有。然后他尝试遍历该系统支持的 MIBs，发现它支持打印机 MIB。嗯……结果证明，他被错误地分配了部门的打印机的
    IP 地址！
- en: '[**SNMPv1, SNMPv2, and SNMPv3**](toc.html#app2.13)'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: '[**SNMPv1、SNMPv2 和 SNMPv3**](toc.html#app2.13)'
- en: 'There are three main variants of SNMP. The original, SNMPv1 (version 1), is
    the simplest, but it has some drawbacks that newer versions seek to remedy. Its
    shortcomings include:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: SNMP 有三种主要变体。原始的 SNMPv1（版本 1）是最简单的，但它有一些缺点，新版本试图解决这些问题。其缺点包括：
- en: No support for integers larger than 32 bits.
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不支持大于 32 位的整数。
- en: No means to ask for bulk data (each object must be asked for by name).
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 没有请求批量数据的方法（每个对象都必须按名称请求）。
- en: No mechanism to ensure that a trap reaches its destination.
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 没有机制来确保陷阱到达其目的地。
- en: Security/authentication is accomplished using community names, which are like
    passwords, but are transmitted on the network in the clear (that is, unencrypted).
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安全/认证是通过使用社区名称来完成的，这些名称类似于密码，但在网络上以明文形式传输（即未加密）。
- en: SNMPv2c (community-based SNMPv2) addressed the first three of these problems,
    but reaching an agreement on a new security mechanism proved more difficult, so
    SNMPv2c still relies on community names for authentication. SNMPv2c includes 64-bit
    integers, the GETBULK command, and introduces informs, which are confirmed traps.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: SNMPv2c（基于社区的 SNMPv2）解决了上述前三个问题，但在就新的安全机制达成一致方面遇到了更大的困难，因此 SNMPv2c 仍然依赖于社区名称进行认证。SNMPv2c
    包括 64 位整数、GETBULK 命令，并引入了 informs，这是一种已确认的陷阱。
- en: SNMPv3 replaces the community-name authentication mechanism with more secure
    authentication and encryption, but in-depth discussion of it is beyond the scope
    of this book.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: SNMPv3 用更安全的认证和加密机制取代了社区名称认证机制，但对其的深入讨论超出了本书的范围。
- en: '**NOTE**'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*SNMPv1 has been moved to “historical” status, but many applications used by
    IT organizations still use it. Your network appliance may need to speak SNMPv1
    for compatibility with these older applications. Expect, however, that in the
    not-too-distant future, some of your customers will want to disable the older,
    less secure versions of SNMP.*'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: '*SNMPv1 已被移至“历史”状态，但许多 IT 组织使用的应用程序仍然在使用它。您的网络设备可能需要使用 SNMPv1 与这些较老的应用程序兼容。然而，预计在不久的将来，一些客户将希望禁用较旧、安全性较低的
    SNMP 版本。*'
- en: '[**SNMP Data Types**](toc.html#app2.14)'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: '[**SNMP 数据类型**](toc.html#app2.14)'
- en: 'SNMP data types are a subset of ASN.1 types. A complete description of the
    SNMP data types and their uses is beyond the scope of this brief introduction,
    but this section is a summary of the major types. SNMP defines three kinds of
    data types: primitive, defined, and constructor. We won’t dwell on the differences
    here, other than to say primitives are the basic types, defined types have special
    meanings but have underlying primitive types, and constructor types are the tables
    we will discuss below. Although it may look a little strange, we’ll try to stay
    consistent here with SNMP’s standard of using all capital letters in the names
    of primitive types, but just initial capitals for the defined types.'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: SNMP 数据类型是 ASN.1 类型的子集。SNMP 数据类型及其用途的完整描述超出了本简要介绍的范畴，但本节是对主要类型的总结。SNMP 定义了三种数据类型：原始类型、定义类型和构造类型。我们在此不深入探讨它们之间的区别，只是简单地说，原始类型是基本类型，定义类型具有特殊含义但基于原始类型，构造类型是我们下面将要讨论的表格。尽管这看起来可能有些奇怪，但我们将尽力保持与
    SNMP 的标准一致，即在原始类型名称中使用全部大写字母，而在定义类型名称中只使用首字母大写。
- en: '**INTEGER**'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: '**整数**'
- en: An INTEGER may be positive or negative. Its values may be enumerated, a range
    of legal values specified in the form of (lowValue..highValue), or a fixed size
    (e.g., Size(4)). In SNMPv2 INTEGER becomes Integer32, explicitly indicating the
    size as 32 bits. SNMPv2 also adds an Unsigned32 type for a 32-bit integer of only
    positive values.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: INTEGER 可以是正数或负数。它的值可以是枚举的，可以指定一个合法值范围（例如，(lowValue..highValue)），或者固定大小（例如，Size(4)）。在
    SNMPv2 中，INTEGER 变为 Integer32，明确表示大小为 32 位。SNMPv2 还添加了 Unsigned32 类型，用于只有正值的 32
    位整数。
- en: '**Gauge**'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: '**Gauge**'
- en: Gauges are integers that take only non-negative values and whose values rise
    or fall within a specified range (e.g., between 0 and 100 percent, or between
    0 and some maximum capacity). SNMPv2 redefines this as Gauge32.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: Gauges 是只取非负值的整数，其值在指定的范围内上升或下降（例如，在 0 到 100 百分比之间，或在 0 到某个最大容量之间）。SNMPv2 将其重新定义为
    Gauge32。
- en: '**Counter**'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: '**Counter**'
- en: Like Gauge, Counter is an integer that takes only non-negative values. Unlike
    Gauge, the value of a counter only increases until it wraps back to zero at its
    maximum limit. SNMPv2 replaced Counter with Counter32 and Counter64.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 与 Gauge 类似，Counter 是一个只取非负值的整数。与 Gauge 不同，计数器的值只会在达到最大限制时回绕到零。SNMPv2 用 Counter32
    和 Counter64 替换了 Counter。
- en: '**TimeTicks**'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '**TimeTicks**'
- en: TimeTicks are integers describing time in 1/100ths of a second. They are generally
    used to describe the time since some significant event or starting point, such
    as system boot or last configuration change.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: TimeTicks 是描述时间的整数，单位为 1/100 秒。它们通常用于描述自某个重要事件或起点以来的时间，例如系统启动或上次配置更改。
- en: '**OCTET STRING**'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: '**OCTET STRING**'
- en: An OCTET STRING is a string of eight-bit bytes. It is not necessarily a null-terminated
    C string; each octet can contain any value (0..255) at any position (i.e., there
    may be nulls in the middle). SNMPv2 added the restriction that an OCTET STRING
    may be no longer than 65,535 (i.e., its length must be expressible in 16 bits).
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: OCTET STRING 是一个八位字节的字符串。它不一定是 null-terminated 的 C 字符串；每个八位字节可以包含任何值（0..255）在任何位置（即，中间可能有空字符）。SNMPv2
    添加了限制，即 OCTET STRING 不能超过 65,535（即，其长度必须可以用 16 位表示）。
- en: '**OBJECT IDENTIFIER**'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: '**OBJECT IDENTIFIER**'
- en: This is used to contain SNMP OID values. SNMPv2 added the restriction that an
    OBJECT IDENTIFIER may contain no more than 128 components, each of which must
    be expressible in a maximum of 32 bits.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 这用于包含 SNMP OID 值。SNMPv2 添加了限制，即 OBJECT IDENTIFIER 不能包含超过 128 个组件，每个组件都必须可以用最多
    32 位表示。
- en: '**IpAddress**'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: '**IpAddress**'
- en: The IpAddress string is an octet string of length four. (Note that this allows
    expression only of Ipv4 addresses.)
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: IpAddress 字符串是长度为四的八位字节字符串。（注意，这仅允许表达 Ipv4 地址。）
- en: '**Opaque**'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: '**Opaque**'
- en: This type is much like OCTET STRING in that it is a string of octets with similar
    restrictions. Opaque was defined to allow extensions of the SMI. Defining new
    types based on the Opaque type is strongly discouraged.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 这种类型与 OCTET STRING 非常相似，因为它是一系列具有类似限制的字节字符串。Opaque 被定义为允许扩展 SMI。基于 Opaque 类型定义新类型被强烈建议不要这样做。
- en: '**BITS**'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: '**BITS**'
- en: BITS was added in SNMPv2 to provide a way to express bit fields of labeled bits
    (i.e., where each bit has a separate meaning).
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: BITS 在 SNMPv2 中被添加，以提供表达标记位字段（即，每个位都有单独的含义）的方法。
- en: '**NOTE**'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*Types that have been removed from the later revisions of SNMP are not shown
    in the above list.*'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: '*从 SNMP 后期修订中删除的类型在上面的列表中没有显示。*'
- en: '[**SNMP Tables**](toc.html#app2.15)'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: '[**SNMP 表**](toc.html#app2.15)'
- en: In addition to the simple types described above, tables may be described using
    SEQUENCE and SEQUENCE OF. A table in a MIB is described as a SEQUENCE OF a type
    that describes the entry. The table entry is then described as a SEQUENCE containing
    the individual fields of the entry. The entry type describes the columns that
    constitute each row in the table, while the table itself is described as an array
    of these entry structures.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 除了上述简单类型外，表格还可以使用 SEQUENCE 和 SEQUENCE OF 来描述。MIB 中的表格被描述为描述条目的类型的 SEQUENCE OF。然后，表条目被描述为包含条目各个字段的
    SEQUENCE。条目类型描述了构成表中每一行的列，而表本身被描述为这些条目结构的数组。
- en: 'For example, here’s the definition of the interfaces table from MIB-2:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，以下是 MIB-2 中接口表的定义：
- en: '![](../images/344-1.jpg)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/344-1.jpg)'
- en: '![](../images/345-1.jpg)'
  id: totrans-146
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/345-1.jpg)'
- en: Note the use of both if Entry and IfEntry, one initial-capped and the other
    not. All object names start with lowercase; for example, ifTable and if Entry.
    Because If Entry is initial-capped, we know that it describes a type, rather than
    an object.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 注意if Entry和IfEntry两种用法，一个首字母大写，一个没有。所有对象名称都以小写字母开头；例如，ifTable和if Entry。因为IfEntry首字母大写，我们知道它描述的是一个类型，而不是一个对象。
- en: 'The IfEntry type is like a struct in C; it describes the layout of each table
    row. The lowercase ifEntry is a node in the OID tree beneath which the column
    objects will be defined. Thus, the description of a particular interface will
    have an OID like this:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: IfEntry类型类似于C语言中的struct；它描述了每个表格行的布局。小写的ifEntry是OID树下的一个节点，在此节点下将定义列对象。因此，特定接口的描述将有一个类似于这样的OID：
- en: ifTable.ifEntry.ifDescr.*x*
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: ifTable.ifEntry.ifDescr.*x*
- en: where *x* is the row index.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 *x* 是行索引。
- en: Following the definition of the entry type will be the definitions of each of
    the objects that make up the entry sequence. You will see this format again and
    again in MIB definitions; much MIB information is organized into tables.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 在定义条目类型之后，将是组成条目序列的每个对象的定义。你将在MIB定义中反复看到这种格式；许多MIB信息都组织成表格。
- en: '[**Defining New Types**](toc.html#app2.16)'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: '[**定义新类型**](toc.html#app2.16)'
- en: Although the data types defined in the SMI are sufficient, it is sometimes convenient
    to be a bit more specific. For example, you may want to restrict the possible
    values in an OCTET STRING or the range covered by an Integer32; if your MIB uses
    the same restricted values repeatedly, it will become tedious to describe these
    same restrictions repeatedly.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管SMI中定义的数据类型已经足够，但有时更具体一点会更方便。例如，你可能想限制OCTET STRING中可能值的范围或Integer32覆盖的范围；如果你的MIB反复使用相同的限制值，重复描述这些相同的限制就会变得繁琐。
- en: RFC 1903 describes the *textual convention,* a macro that allows you to bind
    your clarifications together into a new type. The following textual convention
    is taken from the file SNMPv2-TC.txt distributed with Net-SNMP (version 5.0.8).
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: RFC 1903描述了*文本约定*，这是一个宏，允许你将你的澄清绑定到一个新的类型中。以下文本约定取自与Net-SNMP（版本5.0.8）一起分发的SNMPv2-TC.txt文件。
- en: '![](../images/345-2.jpg)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/345-2.jpg)'
- en: '![](../images/346-1.jpg)'
  id: totrans-156
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/346-1.jpg)'
- en: This describes a type called DisplayString that can take up to 255 octets whose
    values are restricted to those that correspond to displayable characters. The
    DISPLAY-HINT clause shows how a DisplayString may appear. *255a* means it can
    take the form of up to 255 ASCII characters. RFC 1903 describes the complete syntax
    for the display hint.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 这描述了一个名为DisplayString的类型，它可以占用多达255个八位字节，其值限制在对应可显示字符的范围内。DISPLAY-HINT子句显示了DisplayString可能的外观。"255a"表示它可以采用多达255个ASCII字符的形式。RFC
    1903描述了显示提示的完整语法。
- en: '[**Structure of a MIB File**](toc.html#app2.17)'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '[**MIB文件的结构**](toc.html#app2.17)'
- en: When you read a MIB file, you will notice that it is named and defined between
    BEGIN and END statements. It will describe what it includes from other MIB files,
    and it will name the module being defined in this MIB file, the contact information
    for the person responsible for the MIB, and the revision history. Next you will
    see the definition of the objects in the MIB.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 当你阅读MIB文件时，你会注意到它是在BEGIN和END语句之间命名和定义的。它将描述它从其他MIB文件中包含的内容，并命名在此MIB文件中定义的模块，负责MIB的人员的联系方式以及修订历史。接下来，你将看到MIB中对象的定义。
- en: If you look at the IF-MIB, again distributed with the Net-SNMP package, you
    can see all of these parts. The MIB is enclosed within these lines
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你再次查看随Net-SNMP包一起分发的IF-MIB，你可以看到所有这些部分。MIB被包含在这些行内
- en: IF-MIB DEFINITIONS ::= BEGIN
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: IF-MIB DEFINITIONS ::= BEGIN
- en: END
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: END
- en: The first section states the external dependencies.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 第一部分声明了外部依赖。
- en: '![](../images/346-2.jpg)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/346-2.jpg)'
- en: '![](../images/347-1.jpg)'
  id: totrans-165
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/347-1.jpg)'
- en: Then comes the definition of the module.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 然后是模块的定义。
- en: '![](../images/347-2.jpg)'
  id: totrans-167
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/347-2.jpg)'
- en: This describes the module ifMib, which takes the location { mib-2 31 } in the
    overall MIB address space. The organization and contact information are clearly
    identifiable, followed by the descriptions of the various revisions of this MIB
    in reverse chronological order. The time and date look pretty cryptic, but they
    are just a concatenation of year, month, day, hour, and minute in GMT (indicated
    by the *Z* for Zulu Time). Therefore, the most recent revision (200006140000Z)
    was made on June 14, 2000.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 这描述了 ifMib 模块，它在整体 MIB 地址空间中占据位置 { mib-2 31 }。组织机构和联系方式可以清楚地识别，随后以倒序排列的方式描述了该
    MIB 的各个版本。时间和日期看起来相当晦涩，但它们只是年、月、日、小时和分钟在 GMT（由 *Z* 表示为 Zulu 时间）的串联。因此，最近的修订版（200006140000Z）是在
    2000 年 6 月 14 日完成的。
- en: Next, you’ll see the definition of the actual structure of the MIB objects,
    along with any textual conventions new to this MIB.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，你将看到 MIB 对象的实际结构定义，以及任何对这个 MIB 新的文本约定。
- en: '[**Summary**](toc.html#app2.18)'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: '[**摘要**](toc.html#app2.18)'
- en: 'This has been a whirlwind tour of SNMP. We’ve covered the basic parts of SNMP:
    the protocol, the grammar, and the first group of managed objects. You should
    now understand the acronyms *SMI*, *MIB*, and *OID*, and the terms *object* and
    *trap*. You should also be familiar with the term MIB-2 and have an idea of what
    it contains. We have discussed the various data types, both scalars and tables.
    At this point, you should be able to take an unfamiliar MIB and read through it,
    understanding its basic structure and what it is trying to describe. We have also
    touched on a couple of the command-line utilities you may find useful to probe
    an SNMP-enabled device: snmpwalk and snmpget.'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 这是对 SNMP 的一次快速浏览。我们已经涵盖了 SNMP 的基本组成部分：协议、语法以及第一组管理对象。你现在应该理解了缩写词 *SMI*、*MIB*
    和 *OID*，以及术语 *对象* 和 *陷阱*。你也应该熟悉术语 MIB-2，并对其包含的内容有所了解。我们已经讨论了各种数据类型，包括标量和表格。到此为止，你应该能够阅读一个不熟悉的
    MIB，并理解其基本结构和它试图描述的内容。我们还简要介绍了几个可能对你有用的命令行实用工具，用于探测启用了 SNMP 的设备：snmpwalk 和 snmpget。
- en: With a little cut and paste and some judicious modifications, you may now be
    able to develop a simple MIB.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 经过一些剪切粘贴和适当的修改，你现在可能能够开发一个简单的 MIB。
- en: __________________
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: __________________
- en: '¹ Network Working Group, Request For Comments: 1213\. *Management Information
    Base for Network Management of TCP/IP-based internets: MIB-II*. K. McCloghrie
    and M. Rose, March 1991.'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: ¹ 网络工作组，请求评论：1213。*基于 TCP/IP 的互联网网络管理信息库：MIB-II*。K. McCloghrie 和 M. Rose，1991
    年 3 月。
