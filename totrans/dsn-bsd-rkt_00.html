<html><head></head><body><div class="preface" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="introduction"/>INTRODUCTION</h1></div></div></div><p>Welcome to <span class="emphasis"><em>Designing BSD Rootkits</em></span>! This book will introduce you to the fundamentals of programming and developing kernel-mode rootkits under the FreeBSD operating system. Through the "learn by example" method, I'll detail the different techniques that a rootkit can employ so that you can learn what makes up rootkit code at its simplest level. It should be noted that this book does not contain or diagnose any "full-fledged" rootkit code. In fact, most of this book concentrates on <span class="emphasis"><em>how</em></span> to employ a technique, rather than <span class="emphasis"><em>what</em></span> to do with it.</p><p>Note that this book has nothing to do with exploit writing or how to gain root access to a system; rather, it is about maintaining root access long after a successful break-in.</p><div class="sect1" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="what_is_a_rootkit_question"/>What Is a Rootkit?</h1></div></div></div><p>While there are a few varied definitions of what constitutes a rootkit, for the purpose of this book, a <span class="emphasis"><em>rootkit</em></span> is a set of code that allows someone to control certain aspects of the host operating system without revealing his or her presence. Fundamentally, that's what makes a rootkit—evasion of end user knowledge.</p><p>Put more simply, a rootkit is a "kit" that allows a user to maintain "root" access.</p></div></div>
<div class="sect1" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="why_freebsd_question"/>Why FreeBSD?</h1></div></div></div><p>FreeBSD is an advanced, open source operating system; with FreeBSD, you have full, uninhibited access to the kernel source, making it easier to learn systems programming—which is, essentially, what you'll be doing throughout this book.</p></div>
<div class="sect1" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="the_goals_of_this_book"/>The Goals of This Book</h1></div></div></div><p>The primary goal of this book is to expose you to rootkits and rootkit writing. By the time you finish this book, you should "theoretically" be able to rewrite the entire operating system, on the fly. You should also understand the theory and practicality behind rootkit detection and removal.</p><p>The secondary goal of this book is to provide you with a practical, hands-on look at parts of the FreeBSD kernel, with the extended goal of inspiring you to explore and hack the rest of it on your own. After all, getting your hands dirty is always the best way to learn.</p></div>
<div class="sect1" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="who_should_read_this_book_question"/>Who Should Read This Book?</h1></div></div></div><p>This book is aimed at programmers with an interest in introductory kernel hacking. As such, experience writing kernel code is not required or expected.</p><p>To get the most out of this book, you should have a good grasp of the C programming language (i.e., you understand pointers) as well as <span class="emphasis"><em>x</em></span>86 Assembly (AT&amp;T Syntax). You'll also need to have a decent understanding of operating system theory (i.e., you know the difference between a process and a thread).</p></div>
<div class="sect1" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="contents_overview"/>Contents Overview</h1></div></div></div><p>This book is (unofficially) divided into three sections. The first section (<a class="xref" href="ch01.html" title="Chapter 1. LOADABLE KERNEL MODULES">Chapter 1</a>) is essentially a whirlwind tour of kernel hacking, designed to bring a novice up to speed. The next section (<a class="xref" href="ch02.html" title="Chapter 2. HOOKING">Chapter 2</a> through <a class="xref" href="ch06.html" title="Chapter 6. PUTTING IT ALL TOGETHER">Chapter 6</a>) covers the gamut of current, popular rootkit techniques (i.e., what you would find in "the wild"); while the last section (<a class="xref" href="ch07.html" title="Chapter 7. DETECTION">Chapter 7</a>) focuses on rootkit detection and removal.</p></div>
<div class="sect1" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="conventions_used_in_this_book"/>Conventions Used in This Book</h1></div></div></div><p>Throughout this book, I have used a boldface font in code listings to indicate commands or other text that I have typed in, unless otherwise specifically noted.</p></div>
<div class="sect1" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="concluding_remarks"/>Concluding Remarks</h1></div></div></div><p>Although this book concentrates on the FreeBSD operating system, most (if not all) of the concepts can be applied to other OSes, such as Linux or Windows. In fact, I learned half of the techniques in this book on those very systems.<a id="IDX-PREFACE-0001" class="indexterm"/><a id="IDX-PREFACE-0002" class="indexterm"/></p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>All of the code examples in this book were tested on an IA-32-based computer running FreeBSD 6.0-STABLE.</p></div></div></body></html>