<html><head></head><body><div class="chapter" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="network_security"/>Chapter 13. NETWORK SECURITY</h1></div></div></div><p>Any time you operate a network, you must protect it against intrusions from outsiders and damage caused by intentional or accidental misuse or abuse by internal network users. Computer networks are vulnerable to several forms of attack, including unauthorized access to files, theft of service, and denial of service caused by excessive network-connection requests. Strictly speaking, attacks on individual computers, such as viruses, worms, and Trojan horses, are a separate issue from network vulnerabilities, but a good network security plan will include firewalls and other tools that also protect the computers connected to the network.</p><p>This chapter describes the basic steps that every home and small business network manager must take to keep his or her network secure.</p><div class="sect1" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="keeping_intruders_out"/>Keeping Intruders Out</h1></div></div></div><p>Intruders break into networks for several reasons:<a class="indexterm" id="IDX-CHP-13-1408"/><a class="indexterm" id="IDX-CHP-13-1409"/><a class="indexterm" id="IDX-CHP-13-1410"/><a class="indexterm" id="IDX-CHP-13-1411"/></p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>They want to open files and read documents, either to steal confidential information or just to overcome the challenge of "cracking" protected files.</p></li><li class="listitem"><p>They want to use the network to obtain a high-speed Internet connection.</p></li><li class="listitem"><p>They want to use the network to forward unsavory or illegal data (such as spam or pornography) to the Internet or download similar material.</p></li><li class="listitem"><p>They want to steal passwords, credit card numbers, bank account information, and other forms of data that they can either sell or use to order items of value.<a class="indexterm" id="IDX-CHP-13-1412"/><a class="indexterm" id="IDX-CHP-13-1413"/></p></li><li class="listitem"><p>They want to interfere with normal network operation by overloading the network's ability to handle data, altering or deleting essential software, or causing hardware to break down.</p></li></ul></div><p>Two important objectives of network security are to limit access to authorized users and to keep those same users away from configuration settings and confidential data. The most important tools for maintaining a secure network include different access levels for different users, passwords, and firewalls. If they're not adequate, more complex methods are also possible, including kernel-level mandatory access control systems, authentication and authorization mechanisms, and data encryption.<a class="indexterm" id="IDX-CHP-13-1414"/></p><div class="sect2" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="user_accounts_and_access_levels"/>User Accounts and Access Levels</h2></div></div></div><p>Almost all computer operating systems have at least two levels of user accounts: administrators and users. <span class="emphasis"><em>Administrators</em></span> have access to all of the computer's configuration settings, such as installing or removing printers, joining a network, and so forth. <span class="emphasis"><em>Users</em></span> can read and write programs and data files assigned to their own accounts and to resources whose owners allow other people to use them. On a network, a <span class="emphasis"><em>guest</em></span> account has its own access settings for those who use a computer's resources through the network rather than through the keyboard and other input devices connected directly to each computer.<a class="indexterm" id="IDX-CHP-13-1415"/><a class="indexterm" id="IDX-CHP-13-1416"/><a class="indexterm" id="IDX-CHP-13-1417"/><a class="indexterm" id="IDX-CHP-13-1418"/></p><p>Each user has exclusive control of his or her files. The owner of every account can set access controls on files that keep them either private and confidential or public and accessible to other users. Even if other users have accounts on the same computer, they can't read somebody else's private files. The exception is a system administrator account that provides access and control to almost all files.</p></div><div class="sect2" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="passwords"/>Passwords</h2></div></div></div><p>Passwords are the first line of defense against unwanted access to a computer or a network. If a would-be intruder can't get the computer to start the operating system, opening data files or using the network is a lot more difficult (but not impossible—a determined intruder with enough time and resources can often get around a password to open and read unencrypted files).<a class="indexterm" id="IDX-CHP-13-1419"/></p><p>You may be tempted to set up your computer without a startup password, but that completely defeats most of the computer's security features and those of the network connected to it. Unless you're absolutely certain that no strangers will ever get close enough to turn on your computer or gain access through a wired or wireless network, and you trust everybody else in the house or office to respect your privacy, it's worth the extra time needed to enter a password every time you turn on the computer or connect to it through a network.</p><p>An effective password should be difficult to guess and long enough to make it hard to find with a brute-force program (a program that applies massive computing resources to trying one password after another until it stumbles upon the right one).</p><p>Too many people use one of these items as a password:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Your own first name or middle name</p></li><li class="listitem"><p>The name of your spouse, child, or pet</p></li><li class="listitem"><p>Your mother's maiden name or any other family name</p></li><li class="listitem"><p>Your favorite entertainer, band, team, or song</p></li><li class="listitem"><p>Your own first initial and last name (such as <span class="emphasis"><em>JSmith</em></span>)</p></li><li class="listitem"><p>An obvious string of numbers, letters, or both (such as <span class="emphasis"><em>123456</em></span>, <span class="emphasis"><em>abcxyz</em></span>, or <span class="emphasis"><em>abc123</em></span>)</p></li><li class="listitem"><p>Your birthday or some other significant date</p></li><li class="listitem"><p>Your home town or country</p></li><li class="listitem"><p>A string of characters from your keyboard (such as <span class="emphasis"><em>qwerty</em></span> or <span class="emphasis"><em>!@#$%</em></span>)</p></li><li class="listitem"><p>The word <span class="emphasis"><em>password</em></span></p></li><li class="listitem"><p>The phrase <span class="emphasis"><em>letmein</em></span> (that is, <span class="emphasis"><em>let me in</em></span>, not the name of a Chinese noodle dish)</p></li><li class="listitem"><p>The phrase <span class="emphasis"><em>trustno1</em></span> (Fox Mulder's password on <span class="emphasis"><em>The X-Files</em></span> TV series)</p></li><li class="listitem"><p>The word <span class="emphasis"><em>swordfish</em></span> (originally used in the Marx Brothers' <span class="emphasis"><em>Horse Feathers</em></span> and in many subsequent movies, books, and computer games)</p></li><li class="listitem"><p>The word <span class="emphasis"><em>sex</em></span> or any common curse or obscenity</p></li><li class="listitem"><p>The word <span class="emphasis"><em>God</em></span> or <span class="emphasis"><em>Jesus</em></span> (or any other deity of your choice)</p></li><li class="listitem"><p>Any of these words or phrases spelled backward</p></li></ul></div><p>When a "computer security expert" in a movie or TV show finds the right password to break into the bad guy's computer on the third try, he probably tried some of the passwords on this list.</p><p>Many network routers, modems, and other hardware come with default passwords preset at the factory. These passwords are well known by crackers and easy to find in equipment manuals and on the Internet.</p><p>The best passwords are random strings of letters, numbers, and other characters, at least seven or eight characters in length. One expert tested a brute-force password-cracking program; <a class="xref" href="ch13.html#time_to_test_all_possible_passwords" title="Table 13-1. Time to Test All Possible Passwords">Table 13-1</a> shows the amount of time that one programmer (Jimmy Ruska) needed to discover passwords of different lengths by creating and testing every possible combination. (The specific numbers in this table apply only to his particular program. You should pay attention to how the amount of time increases as you add more characters to a password rather than the exact times.) The time to crack is even greater if your password includes one or more symbols, such as !, @, #, $, &amp;, and +.<a class="indexterm" id="IDX-CHP-13-1420"/><a class="indexterm" id="IDX-CHP-13-1421"/></p><div class="table"><a id="time_to_test_all_possible_passwords"/><p class="title"><b>Table 13-1. Time to Test All Possible Passwords<sup>[<a class="footnoteref" href="ch13.html#ftn.CHP-13-TFN-1">a</a>]</sup></b></p><div class="table-contents"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; " summary="Time to Test All Possible Passwords"><colgroup><col/><col/><col/></colgroup><thead><tr><th style="text-align: left" valign="bottom"><p>Password Length</p></th><th style="text-align: left" valign="bottom"><p>Letters Only</p></th><th style="text-align: left" valign="bottom"><p>Letters and Numbers</p></th></tr></thead><tfoot><tr><th colspan="3" style="text-align: left" valign="top"><sup>[<a class="footnote" href="#ftn.CHP-13-TFN-1" id="CHP-13-TFN-1">a</a>]</sup></th></tr></tfoot><tbody><tr><td style="text-align: left" valign="top"><p>3 characters</p></td><td style="text-align: left" valign="top"><p>1 second</p></td><td style="text-align: left" valign="top"><p>2 seconds</p></td></tr><tr><td style="text-align: left" valign="top"><p>4 characters</p></td><td style="text-align: left" valign="top"><p>3 seconds</p></td><td style="text-align: left" valign="top"><p>10 seconds</p></td></tr><tr><td style="text-align: left" valign="top"><p>5 characters</p></td><td style="text-align: left" valign="top"><p>1 minute, 17 seconds</p></td><td style="text-align: left" valign="top"><p>6 minutes</p></td></tr><tr><td style="text-align: left" valign="top"><p>6 characters</p></td><td style="text-align: left" valign="top"><p>26 minutes</p></td><td style="text-align: left" valign="top"><p>3 hours, 30 minutes</p></td></tr><tr><td style="text-align: left" valign="top"><p>7 characters</p></td><td style="text-align: left" valign="top"><p>14 hours</p></td><td style="text-align: left" valign="top"><p>6 days</p></td></tr><tr><td style="text-align: left" valign="top"><p>8 characters</p></td><td style="text-align: left" valign="top"><p>15 days</p></td><td style="text-align: left" valign="top"><p>205 days</p></td></tr></tbody><tbody class="footnotes"><tr><td colspan="3"><div class="footnote"><p><sup>[<a class="para" href="#CHP-13-TFN-1" id="ftn.CHP-13-TFN-1">a</a>] </sup>Source: <a class="ulink" href="http://blog.jimmyr.com/Most_Common_Passwords_20_2008.php">http://blog.jimmyr.com/Most_Common_Passwords_20_2008.php</a></p></div></td></tr></tbody></table></div></div><br class="table-break"/><p>Other cracking methods can be slower or faster, but the general point—that longer passwords are more difficult to crack—still applies.</p></div><div class="sect2" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="firewalls"/>Firewalls</h2></div></div></div><p>A <span class="emphasis"><em>firewall</em></span> is a server that uses a set of rules established by the network manager to inspect incoming data and to block data from a source that isn't on a list or files that match a particular description (such as a virus). Or the firewall might pass all data moving from the LAN <span class="emphasis"><em>to</em></span> the Internet but only allow certain types of data <span class="emphasis"><em>from</em></span> the Internet. The most common use of a firewall in a LAN is at the gateway to the Internet, as shown in <a class="xref" href="ch13.html#a_network_firewall_isolates_a_lan_from" title="Figure 13-1. A network firewall isolates a LAN from the Internet.">Figure 13-1</a>. The firewall monitors all inbound and outbound data between the computers on the local network on one side and the Internet on the other. This kind of firewall is intended to protect the computers on the LAN from unauthorized intrusion from the Internet.<a class="indexterm" id="IDX-CHP-13-1428"/><a class="indexterm" id="IDX-CHP-13-1429"/><a class="indexterm" id="IDX-CHP-13-1422"/><a class="indexterm" id="IDX-CHP-13-1423"/><a class="indexterm" id="IDX-CHP-13-1424"/><a class="indexterm" id="IDX-CHP-13-1425"/><a class="indexterm" id="IDX-CHP-13-1426"/><a class="indexterm" id="IDX-CHP-13-1427"/></p><div class="sect3" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="firewalls_in_wireless_networks"/>Firewalls in Wireless Networks</h3></div></div></div><p>In a wireless network, a firewall can also be placed at the gateway between the wireless access points and the wired network. This firewall isolates the wireless portion of the network from the wired LAN, so intruders who have connected their computer to the network without permission can't use the wireless connection to reach the Internet or the wired part of the LAN. <a class="xref" href="ch13.html#a_firewall_can_also_protect_the_wired_p" title="Figure 13-2. A firewall can also protect the wired portion of a LAN from wireless intruders.">Figure 13-2</a> shows the location of a firewall in a mixed network that includes both wired and wireless connections.<a class="indexterm" id="IDX-CHP-13-1430"/><a class="indexterm" id="IDX-CHP-13-1431"/><a class="indexterm" id="IDX-CHP-13-1432"/><a class="indexterm" id="IDX-CHP-13-1433"/><a class="indexterm" id="IDX-CHP-13-1434"/><a class="indexterm" id="IDX-CHP-13-1435"/><a class="indexterm" id="IDX-CHP-13-1436"/></p><div class="figure"><a id="a_network_firewall_isolates_a_lan_from"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e12392"/><img alt="A network firewall isolates a LAN from the Internet." src="tagoreillycom20090324nostarchimages266394.png.jpg"/></div></div><p class="title"><b>Figure 13-1. A network firewall isolates a LAN from the Internet.</b></p></div><br class="figure-break"/><div class="figure"><a id="a_firewall_can_also_protect_the_wired_p"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e12400"/><img alt="A firewall can also protect the wired portion of a LAN from wireless intruders." src="tagoreillycom20090324nostarchimages266396.png.jpg"/></div></div><p class="title"><b>Figure 13-2. A firewall can also protect the wired portion of a LAN from wireless intruders.</b></p></div><br class="figure-break"/><p>A firewall in a wireless network can perform several functions:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>It can act as a gateway router between the wireless network and a wired LAN.</p></li><li class="listitem"><p>It can protect a direct connection from a single computer to the Internet.</p></li><li class="listitem"><p>It can block all traffic moving from the wireless side to the wired network that doesn't come from an authenticated user.</p></li><li class="listitem"><p>It passes commands, messages, and file transfers from trusted users to the Internet.</p></li></ul></div><p>Therefore, a legitimate user can connect to network nodes on the wired part of a mixed LAN or on the Internet, but an intruder would be cut off at the firewall.</p><p>Because authorized wireless users and intruders are both on the unprotected side of the firewall, it does not isolate the wireless nodes from one another. An intruder can still gain access to another computer on the same wireless network and read shared files, so it's a good idea to turn off file sharing on any computer connected to a wireless network and to use firewall software on individual computers.</p><p>A firewall for a wireless network should use some kind of authentication to allow legitimate users through the gateway, but it should reject everybody else. If access control based on MAC addresses is built into Wi-Fi networks and the added authentication in 802.1<span class="emphasis"><em>x</em></span> are not adequate, then an outboard firewall should require all users to enter a login and password before they can connect to the Internet.</p><p>If your wireless network includes computers running more than one operating system, your firewall must use a login tool that works on any platform. The easiest way to accomplish this is with a web-based authentication server, such as the one included with the Apache web server (<a class="ulink" href="http://httpd.apache.org/">http://httpd.apache.org/</a>).<a class="indexterm" id="IDX-CHP-13-1437"/><a class="indexterm" id="IDX-CHP-13-1438"/></p><p>The Apache web server is available as a Linux or Unix application that can run on an old, slow computer with an early Pentium or even an antique 486 CPU, so you can often recycle an old junker and use it as a firewall. Both the Apache application and the operating system are available as open source software, so it ought to be possible to build an extremely low-cost Apache firewall.</p><p>If you prefer to use Windows, or if you don't want to assemble your own firewall, you have several options. You can use the Windows version of Apache, or you can use a commercial utility such as the ones listed at <a class="ulink" href="http://www.thegild.com/firewall/">http://www.thegild.com/firewall/</a>.</p><p>Attacks on a wireless LAN don't all come through the air. A wireless network also requires the same kind of firewall protection against attacks from the Internet as an entirely wired network. Many wireless access points include configurable firewall features, but if yours does not, the network should include a firewall program on each computer, along with a separate router or a dedicated computer acting as a network firewall.</p></div><div class="sect3" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="protecting_individual_computers"/>Protecting Individual Computers</h3></div></div></div><p>Client firewall programs provide another line of defense against attacks coming from the Internet. Some of these attacks come from miscreants who are looking for a way to read your files and other resources that you don't want the entire world to see. Others might want to use your computer as a relay point for spam or attempts to break into some other computer halfway around the world in order to make the real source more difficult to identify. Still others spread viruses or use <span class="emphasis"><em>really</em></span> unpleasant programs called rootkits that take control of a PC or display threatening messages.<a class="indexterm" id="IDX-CHP-13-1439"/><a class="indexterm" id="IDX-CHP-13-1440"/><a class="indexterm" id="IDX-CHP-13-1441"/><a class="indexterm" id="IDX-CHP-13-1442"/><a class="indexterm" id="IDX-CHP-13-1443"/><a class="indexterm" id="IDX-CHP-13-1444"/><a class="indexterm" id="IDX-CHP-13-1445"/><a class="indexterm" id="IDX-CHP-13-1446"/><a class="indexterm" id="IDX-CHP-13-1447"/></p><p>An unprotected system with a lot of unused storage space can be an attractive target for hackers who want to distribute pirated software, music, or video files (you didn't think they store that stuff on their own computers, did you?).<a class="indexterm" id="IDX-CHP-13-1448"/></p><p>The number of such idiots and creeps on the Internet is surprisingly large; if you install a firewall that notifies you when an outside computer tries to connect to your network, your firewall log will probably list several break-in attempts every day.</p></div><div class="sect3" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="wireless_access_points_with_firewalls"/>Wireless Access Points with Firewalls</h3></div></div></div><p>The easiest firewall to use with a wireless network is one that's built into an access point. Many wireless access points combine the functions of a wireless access point with a broadband router and an Ethernet switch, so they support both wired and wireless network clients.</p><p>As you know, a network router translates addresses between the numeric IP address that identifies the LAN to the Internet and the internal IP addresses that identify individual computers within the local network. The firewall normally blocks all incoming requests for data to network hosts, but this creates problems when you want to use one or more of the computers on the local network as file servers. So the firewall redirects certain types of requests to the appropriate computer inside the firewall.<a class="indexterm" id="IDX-CHP-13-1449"/></p><p>Each request to connect to a server includes a specific port number that identifies the type of server. For example, web servers operate on port 80, and FTP servers use port 21, so those port numbers are part of the request for access. To accept access requests to a server, you must instruct the firewall's <span class="emphasis"><em>Network Address Translation (NAT)</em></span> function to forward those requests to a specific computer within the LAN. <a class="xref" href="ch13.html#common_tcp_solidus_ip_service_port_numb" title="Table 13-2. Common TCP/IP Service Port Numbers">Table 13-2</a> lists the most common service port numbers.<a class="indexterm" id="IDX-CHP-13-1450"/></p><p>Hundreds of other port numbers have been assigned, but you will never see most of them in actual use. The official list of port assignments is available online at <a class="ulink" href="http://www.iana.org/assignments/port-numbers">http://www.iana.org/assignments/port-numbers</a>.</p><p>NAT assumes that each internal server's IP address doesn't change from one request to the next. A web server on 192.168.0.23 today won't migrate to 192.168.0.47 next week. That's generally not a problem on a wired network, but in a wireless setting where network clients join and leave the network all the time, the DHCP server automatically assigns the next available address to each new client. If one of those clients is the home of one of the network's service ports, the NAT probably won't find it. This problem is not common, because most networks don't use portable computers as servers, but it can happen. The solution is to turn off the DHCP server and assign a permanent IP address to each client.<a class="indexterm" id="IDX-CHP-13-1451"/><a class="indexterm" id="IDX-CHP-13-1452"/></p><div class="table"><a id="common_tcp_solidus_ip_service_port_numb"/><p class="title"><b>Table 13-2. Common TCP/IP Service Port Numbers</b></p><div class="table-contents"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; " summary="Common TCP/IP Service Port Numbers"><colgroup><col/><col/></colgroup><thead><tr><th style="text-align: left" valign="bottom"><p>Port Number<a class="indexterm" id="IDX-CHP-13-1453"/><a class="indexterm" id="IDX-CHP-13-1454"/></p></th><th style="text-align: left" valign="bottom"><p>Internet Service</p></th></tr></thead><tbody><tr><td style="text-align: left" valign="top"><p>20</p></td><td style="text-align: left" valign="top"><p>FTP-Data (FTP default data)</p></td></tr><tr><td style="text-align: left" valign="top"><p>21</p></td><td style="text-align: left" valign="top"><p>FTP (File Transfer Protocol)<a class="indexterm" id="IDX-CHP-13-1455"/></p></td></tr><tr><td style="text-align: left" valign="top"><p>23</p></td><td style="text-align: left" valign="top"><p>Telnet</p></td></tr><tr><td style="text-align: left" valign="top"><p>25</p></td><td style="text-align: left" valign="top"><p>SMTP (outgoing mail)</p></td></tr><tr><td style="text-align: left" valign="top"><p>37</p></td><td style="text-align: left" valign="top"><p>Time</p></td></tr><tr><td style="text-align: left" valign="top"><p>53</p></td><td style="text-align: left" valign="top"><p>DNS (Domain Name System)</p></td></tr><tr><td style="text-align: left" valign="top"><p>70</p></td><td style="text-align: left" valign="top"><p>Gopher<a class="indexterm" id="IDX-CHP-13-1456"/></p></td></tr><tr><td style="text-align: left" valign="top"><p>79</p></td><td style="text-align: left" valign="top"><p>Finger<a class="indexterm" id="IDX-CHP-13-1457"/></p></td></tr><tr><td style="text-align: left" valign="top"><p>80</p></td><td style="text-align: left" valign="top"><p>HTTP (web server)</p></td></tr><tr><td style="text-align: left" valign="top"><p>88</p></td><td style="text-align: left" valign="top"><p>Kerberos<a class="indexterm" id="IDX-CHP-13-1458"/></p></td></tr><tr><td style="text-align: left" valign="top"><p>110</p></td><td style="text-align: left" valign="top"><p>POP3 (incoming mail)</p></td></tr><tr><td style="text-align: left" valign="top"><p>119</p></td><td style="text-align: left" valign="top"><p>NNTP (network news)<a class="indexterm" id="IDX-CHP-13-1459"/></p></td></tr><tr><td style="text-align: left" valign="top"><p>1863</p></td><td style="text-align: left" valign="top"><p>Microsoft MSN Messenger<a class="indexterm" id="IDX-CHP-13-1460"/><a class="indexterm" id="IDX-CHP-13-1461"/></p></td></tr><tr><td style="text-align: left" valign="top"><p>5190</p></td><td style="text-align: left" valign="top"><p>AOL Instant Messenger</p></td></tr><tr><td style="text-align: left" valign="top"><p>7070</p></td><td style="text-align: left" valign="top"><p>Real Audio and Video<a class="indexterm" id="IDX-CHP-13-1462"/></p></td></tr></tbody></table></div></div><br class="table-break"/></div><div class="sect3" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="firewall_software"/>Firewall Software</h3></div></div></div><p>A wireless gateway firewall at the interface between the access point and the wired part of your LAN will keep intruders from using your network to reach the Internet, and a firewall at the Internet connection will turn away attempts to connect to your network <span class="emphasis"><em>from</em></span> the Internet, but a wireless network still needs one more form of protection. If somebody gains access to your wireless LAN without permission, you want to keep them away from the other legitimate computers on the same network, so each network node needs a client firewall program.<a class="indexterm" id="IDX-CHP-13-1463"/><a class="indexterm" id="IDX-CHP-13-1464"/><a class="indexterm" id="IDX-CHP-13-1465"/><a class="indexterm" id="IDX-CHP-13-1466"/><a class="indexterm" id="IDX-CHP-13-1467"/><a class="indexterm" id="IDX-CHP-13-1468"/><a class="indexterm" id="IDX-CHP-13-1469"/><a class="indexterm" id="IDX-CHP-13-1470"/><a class="indexterm" id="IDX-CHP-13-1471"/><a class="indexterm" id="IDX-CHP-13-1472"/><a class="indexterm" id="IDX-CHP-13-1473"/><a class="indexterm" id="IDX-CHP-13-1474"/><a class="indexterm" id="IDX-CHP-13-1475"/><a class="indexterm" id="IDX-CHP-13-1476"/><a class="indexterm" id="IDX-CHP-13-1477"/></p><p>Client firewalls perform the same functions at a computer's network interface that a LAN or enterprise firewall performs for the entire network; a client firewall detects attempts to connect to TCP service ports and rejects them unless they match one or more of the firewall program's configuration settings. Several good firewall products are available as shareware, and others are free to noncommercial users. It's easy to try them on your own system and choose the one you like best. ZoneAlarm (<a class="ulink" href="http://www.zonealarm.com/">http://www.zonealarm.com/</a>) and LANguard (<a class="ulink" href="http://www.languard.com/">http://www.languard.com/</a>) are both well-regarded Windows firewall software products. There's also a firewall built into Windows XP and Windows Vista that is adequate for most home and small business networks.<a class="indexterm" id="IDX-CHP-13-1478"/><a class="indexterm" id="IDX-CHP-13-1479"/><a class="indexterm" id="IDX-CHP-13-1480"/><a class="indexterm" id="IDX-CHP-13-1481"/><a class="indexterm" id="IDX-CHP-13-1482"/><a class="indexterm" id="IDX-CHP-13-1483"/><a class="indexterm" id="IDX-CHP-13-1484"/><a class="indexterm" id="IDX-CHP-13-1485"/><a class="indexterm" id="IDX-CHP-13-1486"/></p><p>Linux and Unix users also have plenty of firewall options. Most of them were written for stand-alone firewall computers that are commonly used as network gateways, but they could be equally appropriate as protection for individual network clients.</p><p>In Linux, the iptables firewall is part of the kernel. It's well-documented at <a class="ulink" href="http://www.netfilter.org/projects/iptables/index.html">http://www.netfilter.org/projects/iptables/index.html</a>. Port Scan Attack Detector (psad) is another set of tools that identify port scans and other intrusions on many Linux systems. For more information, see <a class="ulink" href="http://www.cipherdyne.org/psad/">http://www.cipherdyne.org/psad/</a>.<a class="indexterm" id="IDX-CHP-13-1487"/></p><p>IP Filter is a software package that provides firewall services to FreeBSD and NetBSD systems. The official IP Filter website is <a class="ulink" href="http://coombs.anu.edu.au/~avalon">http://coombs.anu.edu.au/~avalon</a>, and you can download an excellent HOWTO document at <a class="ulink" href="http://www.obfuscation.org/ipf/ipf-howto.txt">http://www.obfuscation.org/ipf/ipf-howto.txt</a>. The program can deny or permit any packet from passing through the firewall, and it can filter by netmask or host address, establish service port restrictions, and provide NAT services.<a class="indexterm" id="IDX-CHP-13-1488"/><a class="indexterm" id="IDX-CHP-13-1489"/></p><p>OpenBSD, FreeBSD, and NetBSD can all use the Packet Filter, or PF, facility to perform firewalling. More information is available at <a class="ulink" href="http://www.openbsd.org/faq/pf/">http://www.openbsd.org/faq/pf/</a>.<a class="indexterm" id="IDX-CHP-13-1490"/></p><p>NetBSD/i386 Firewall is another free Unix firewall. It will operate on any PC with a 486 or later CPU and as little as 8MB of memory. The NetBSD/i386 Firewall Project home page is <a class="ulink" href="http://firewall.dubbele.com/">http://firewall.dubbele.com/</a>.</p></div></div></div></div>
<div class="sect1" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="virtual_private_networks"/>Virtual Private Networks</h1></div></div></div><p>A virtual private network (VPN) can add another effective form of security to data that moves from a remote client to a host network that can be located anywhere with a connection to the Internet.<a class="indexterm" id="IDX-CHP-13-1491"/><a class="indexterm" id="IDX-CHP-13-1492"/><a class="indexterm" id="IDX-CHP-13-1493"/><a class="indexterm" id="IDX-CHP-13-1494"/><a class="indexterm" id="IDX-CHP-13-1495"/><a class="indexterm" id="IDX-CHP-13-1496"/><a class="indexterm" id="IDX-CHP-13-1497"/><a class="indexterm" id="IDX-CHP-13-1498"/><a class="indexterm" id="IDX-CHP-13-1499"/><a class="indexterm" id="IDX-CHP-13-1500"/><a class="indexterm" id="IDX-CHP-13-1501"/><a class="indexterm" id="IDX-CHP-13-1502"/><a class="indexterm" id="IDX-CHP-13-1503"/><a class="indexterm" id="IDX-CHP-13-1504"/><a class="indexterm" id="IDX-CHP-13-1505"/><a class="indexterm" id="IDX-CHP-13-1506"/><a class="indexterm" id="IDX-CHP-13-1507"/><a class="indexterm" id="IDX-CHP-13-1508"/><a class="indexterm" id="IDX-CHP-13-1509"/></p><p>A VPN uses a <span class="emphasis"><em>data tunnel</em></span> to connect two points on a network through an encrypted channel. The endpoints can be a single network client and a network server, a pair of client computers or other devices, or the gateway to a pair of LANs. Data that passes through a public network such as the Internet is completely isolated from other network traffic. VPNs use login and password authentication to restrict access to authorized users; they encrypt the data to make it unintelligible to intruders who intercept the data; and they use data authentication to maintain the integrity of each data packet and to assure that all data originates with legitimate network clients.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>VPN functions occur at the IP or network layer of the ISO model. Therefore, they can operate on top of the Wi-Fi or other wireless protocols, which operate at the physical layer. VPNs can also pass data across a network connection that includes more than one physical medium (for example, a wireless link that passes data onward to a wired Ethernet network). In other words, a VPN is an end-to-end service; the data can use a wireless link, an Ethernet cable, an ordinary telephone line, or some combination of those and other transmission media.<a class="indexterm" id="IDX-CHP-13-1510"/></p></div><p>In a traditional VPN, a remote user can log in to a distant LAN and obtain all the same network services that are available to local clients. VPNs are commonly used to extend corporate networks to branch offices and to connect users to the LAN from home or from off-site locations such as a client or customer's office.</p><p>A connection through a VPN server looks to the rest of the network exactly like a client device connected directly to the LAN. The only difference is the data from the VPN passes through a VPN driver and a public network instead of moving directly from the network adapter to the LAN. <a class="xref" href="ch13s02.html#a_remote_network_can_connect_to_a_lan_t" title="Figure 13-3. A remote network can connect to a LAN through a virtual private network.">Figure 13-3</a> shows a typical VPN connection to a remote network.</p><div class="figure"><a id="a_remote_network_can_connect_to_a_lan_t"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e12973"/><img alt="A remote network can connect to a LAN through a virtual private network." src="tagoreillycom20090324nostarchimages266398.png.jpg"/></div></div><p class="title"><b>Figure 13-3. A remote network can connect to a LAN through a virtual private network.</b></p></div><br class="figure-break"/><p>All of the same security benefits also apply to short-range VPNs that tunnel through a wireless link and longer-range VPNs that start on a wireless network and relay the data to a remote server. These are two different uses for a VPN: a <span class="emphasis"><em>local</em></span> VPN that only extends across the wireless portion of a network between the client devices and the access point, and an <span class="emphasis"><em>extended network</em></span> that carries VPN-encoded data beyond the access points to a VPN server through a public network, such as the Internet or a dial-up telephone connection. An extended network is a traditional VPN that happens to originate from a wireless network client. The same VPN can also support connections that don't include a wireless segment and logins from public wireless services, such as the ones at airports or coffee shops. This setup is conventional for a VPN.</p><p>Local, short-range VPNs are interesting to people who operate wireless networks because they add another layer of security to wireless links. Because the data moving between wireless clients and the network access point is encrypted (using an algorithm that is more secure than WPA encryption), it is unintelligible to any third party who might be monitoring the radio signal. Because the VPN server won't accept data links at the access point from wireless clients that are not using the correct VPN drivers and passwords, an intruder can't break into the network by associating a rogue client with the access point.<a class="indexterm" id="IDX-CHP-13-1511"/></p><p>The goal of a wireless VPN is to protect the wireless link between the clients and the access point and to lock out unauthorized users. Therefore, the isolated and encrypted data can only move across a single room rather than over hundreds or thousands of miles. Of course, the access point might also relay VPN-encoded data onward through the Internet to a network host in another location.<a class="indexterm" id="IDX-CHP-13-1512"/></p><p><a class="xref" href="ch13s02.html#a_vpn_provides_a_secure_connection_betw" title="Figure 13-4. A VPN provides a secure connection between a wireless network and an Internet gateway or a local LAN.">Figure 13-4</a> shows a wireless connection to a VPN. The VPN server is located between the wireless access point and the host LAN, so all of the packets that move through the wireless portion of the network are encoded. For clarity, the diagram shows the VPN server as a separate component, but the most practical way to add VPN security to a wireless LAN is to use a router or gateway that incorporates VPN support. VPN-enabled routers are available from several vendors, including Cisco, NETGEAR, and TRENDnet.<a class="indexterm" id="IDX-CHP-13-1513"/><a class="indexterm" id="IDX-CHP-13-1514"/></p><div class="figure"><a id="a_vpn_provides_a_secure_connection_betw"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e13016"/><img alt="A VPN provides a secure connection between a wireless network and an Internet gateway or a local LAN." src="tagoreillycom20090324nostarchimages266400.png.jpg"/></div></div><p class="title"><b>Figure 13-4. A VPN provides a secure connection between a wireless network and an Internet gateway or a local LAN.</b></p></div><br class="figure-break"/><div class="sect2" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="vpn_methods"/>VPN Methods</h2></div></div></div><p>A VPN moves data through one or more intermediate networks to a destination on another network. The VPN's tunneling client encapsulates the existing data packets or frames by adding a new header with the routing information that instructs the packets how to reach the VPN's endpoint. The transmission path through the intermediate networks is called a <span class="emphasis"><em>tunnel</em></span>. At the other end of the tunnel, the VPN server removes the tunneling header and forwards the data to the destination specified by the next layer of headers. The exact form of the tunnel doesn't make any difference to the data because the data treats the tunnel as a point-to-point connection.<a class="indexterm" id="IDX-CHP-13-1515"/><a class="indexterm" id="IDX-CHP-13-1516"/><a class="indexterm" id="IDX-CHP-13-1517"/><a class="indexterm" id="IDX-CHP-13-1518"/><a class="indexterm" id="IDX-CHP-13-1519"/><a class="indexterm" id="IDX-CHP-13-1520"/><a class="indexterm" id="IDX-CHP-13-1521"/><a class="indexterm" id="IDX-CHP-13-1522"/><a class="indexterm" id="IDX-CHP-13-1523"/></p><p>The tunneling headers can take several forms. The methods used most widely in VPNs are Point-to-Point Tunneling Protocol (PPTP), Layer Two Tunneling Protocol (L2TP), and IP Security (IPsec) mode. PPTP and L2TP can move data through IP, IPX, and NetBEUI networks; IPsec is limited to IP networks. Both the client and the server must use the same protocol.<a class="indexterm" id="IDX-CHP-13-1524"/><a class="indexterm" id="IDX-CHP-13-1525"/><a class="indexterm" id="IDX-CHP-13-1526"/><a class="indexterm" id="IDX-CHP-13-1527"/></p><p>In PPTP and L2TP, the client and server must configure the tunnel for each transmission before they begin to exchange data. The configuration parameters include the route through the intermediate network and the encryption and compression specifications. When the transmission is complete, the client and server terminate the connection and close the tunnel.</p><p>Unfortunately, several data security analysts have identified significant flaws in PPTP that allow intruders to break into a PPTP-based VPN and sniff passwords and then decode encryption, read data, or inflict damage to a network server. Therefore, PPTP headers are not secure and should not be used.<a class="indexterm" id="IDX-CHP-13-1528"/></p><p>In an IPsec network link, the client and server must establish the tunnel through the intermediate networks in a separate transaction before they begin to exchange data.</p><p>Both L2TP and IPsec offer specific advantages and disadvantages, but they're both good enough to create a secure link between a wireless network client and an access point. The differences among the three are technical rather than practical. You can find an excellent explanation of the internal operation of all three protocols in Microsoft's white paper entitled "Virtual Private Networking in Windows 2000: An Overview," which is available online at <a class="ulink" href="http://technet.microsoft.com/en-us/library/bb742566.aspx">http://technet.microsoft.com/en-us/library/bb742566.aspx</a> (but remember that the flaws in PPTP networks were identified <span class="emphasis"><em>after</em></span> that whitepaper was written).</p></div><div class="sect2" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="vpn_servers"/>VPN Servers</h2></div></div></div><p>A VPN server (or <span class="emphasis"><em>host</em></span>) can be part of a Linux/Unix or Windows server, or it can be built into a stand-alone network router or gateway. If your network already uses a separate computer as a dedicated server, you can use that computer as the VPN server. A separate piece of hardware might be a better choice if your network does not already have a full-blown network server.<a class="indexterm" id="IDX-CHP-13-1529"/><a class="indexterm" id="IDX-CHP-13-1530"/><a class="indexterm" id="IDX-CHP-13-1531"/><a class="indexterm" id="IDX-CHP-13-1532"/><a class="indexterm" id="IDX-CHP-13-1533"/><a class="indexterm" id="IDX-CHP-13-1534"/><a class="indexterm" id="IDX-CHP-13-1535"/></p><p>Dozens of VPN equipment makers offer routers, gateways, and other products that support one or more of the VPN protocols. Each of these products has a different feature set, so testing the specific combination of client and server that you intend to use on your own network before you commit to them is essential. The Virtual Private Network Consortium (VPNC) is moving toward a set of interoperability tests and certification standards (much like the Wi-Fi standards for wireless Ethernet equipment). The VPNC website (<a class="ulink" href="http://www.vpnc.org/">http://www.vpnc.org/</a>) lists the products that have passed the interoperability tests, and the site also provides links to information sources for a long list of VPN products.<a class="indexterm" id="IDX-CHP-13-1536"/></p><div class="sect3" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="configuring_a_windows_server_for_a_vpn"/>Configuring a Windows Server for a VPN</h3></div></div></div><p>If you're committed to using a Windows server, you can use either L2TP or IPsec with Windows Server 2003 or Windows Server 2008; if your server runs the older Windows NT Server 4.0 or Windows 2000 Server software, you're limited to L2TP (or the seriously flawed PPTP). The server also requires two network interface cards: one connected to the wired LAN or the Internet gateway and the other connected to the wireless network. The interface card that is connected to the wireless port normally connects directly to the wireless access point's Ethernet port. The exact process of installing an L2TP host on a Windows server is slightly different in each version of Windows, but the general steps are the same. For specific information about configuring a particular operating system, consult the online Help screens and Microsoft's Resource Kit and other online documentation for your server's operating system. The following sections describe the configuration steps in general terms.<a class="indexterm" id="IDX-CHP-13-1537"/><a class="indexterm" id="IDX-CHP-13-1538"/><a class="indexterm" id="IDX-CHP-13-1539"/><a class="indexterm" id="IDX-CHP-13-1540"/><a class="indexterm" id="IDX-CHP-13-1541"/><a class="indexterm" id="IDX-CHP-13-1542"/><a class="indexterm" id="IDX-CHP-13-1543"/><a class="indexterm" id="IDX-CHP-13-1544"/></p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>For more information about deploying and using VPNs with Microsoft servers, see the Microsoft TechNet articles at <a class="ulink" href="http://technet.microsoft.com/en-us/network/bb545442.aspx">http://technet.microsoft.com/en-us/network/bb545442.aspx</a>.<a class="indexterm" id="IDX-CHP-13-1545"/><a class="indexterm" id="IDX-CHP-13-1546"/><a class="indexterm" id="IDX-CHP-13-1547"/></p></div><div class="variablelist"><dl><dt><span class="term"><span class="strong"><strong>Configure the connection to the LAN</strong></span>.</span></dt><dd><p>The link to the LAN or other network is a dedicated connection through a network adapter. The network connection profile for this connection must include the IP address and subnet mask assigned to this connection and the default gateway address assigned to the network gateway.</p></dd><dt><span class="term"><span class="strong"><strong>Configure the VPN connection</strong></span>.</span></dt><dd><p>The VPN connection is usually an Ethernet link to one or more access points. The connection profile on the server for the VPN connection must include the IP address and subnet mask assigned to this port and the addresses of the DNS and WINS name servers used by this network.</p></dd><dt><span class="term"><span class="strong"><strong>Configure the remote-access server as a router</strong></span>.</span></dt><dd><p>The server must use either static routes or routing protocols that make each VPN client reachable from the wired network.</p></dd><dt><span class="term"><span class="strong"><strong>Enable and configure the server for L2TP clients</strong></span>.</span></dt><dd><p>Windows uses Remote Access Service (RAS) and point-to-point protocol (PPP) to establish VPN connections. The Routing and Remote Access service enables RAS. A VPN connection requires the following RAS configuration options:</p><div class="variablelist"><dl><dt><span class="term"><span class="strong"><strong>Authentication method</strong></span></span></dt><dd><p>Encrypted PPTP connections use the MS-CHAP or EAP-TLS authentication methods.</p></dd><dt><span class="term"><span class="strong"><strong>Authentication provider</strong></span></span></dt><dd><p>Either Windows 2000 security or an external RADIUS server can verify network clients.</p></dd><dt><span class="term"><span class="strong"><strong>IP routing</strong></span></span></dt><dd><p>IP routing and IP-based remote access must be active. If the wired network acts as a DHCP server for the wireless clients, DHCP must be active.<a class="indexterm" id="IDX-CHP-13-1548"/></p></dd></dl></div></dd><dt><span class="term"><span class="strong"><strong>Configure L2TP ports</strong></span>.</span></dt><dd><p>Set each L2TP port to accept remote access.</p></dd><dt><span class="term"><span class="strong"><strong>Configure network filters</strong></span>.</span></dt><dd><p>Input and output filters keep the remote-access server from sending and receiving data that does not originate at a VPN client. These filters will reject data to or from unauthorized users, so those intruders will not be able to obtain an Internet connection (or a connection to the wired LAN) through the wireless network.</p></dd><dt><span class="term"><span class="strong"><strong>Configure remote-access policies</strong></span>.</span></dt><dd><p>Set the remote-access permission for each VPN client to allow access to the RAS server. The port type must be set to the correct VPN protocol (for example, PPTP or L2TP), and the profile for each connection must include the type of encryption in use. Windows offers three encryption strength options:</p><div class="variablelist"><dl><dt><span class="term"><span class="strong"><strong>Basic</strong></span></span></dt><dd><p>Uses a 40-bit encryption key</p></dd><dt><span class="term"><span class="strong"><strong>Strong</strong></span></span></dt><dd><p>Uses a 56-bit encryption key</p></dd><dt><span class="term"><span class="strong"><strong>Strongest</strong></span></span></dt><dd><p>Uses a 128-bit encryption key</p></dd></dl></div></dd></dl></div></div><div class="sect3" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="vpn_servers_for_linux_solidus_unix"/>VPN Servers for Linux/Unix</h3></div></div></div><p>All of the BSD variations (including FreeBSD, NetBSD, OpenBSD, and Mac OS X) include an IPsec VPN client and server as part of the release package.<a class="indexterm" id="IDX-CHP-13-1549"/><a class="indexterm" id="IDX-CHP-13-1550"/><a class="indexterm" id="IDX-CHP-13-1551"/><a class="indexterm" id="IDX-CHP-13-1552"/><a class="indexterm" id="IDX-CHP-13-1553"/><a class="indexterm" id="IDX-CHP-13-1554"/><a class="indexterm" id="IDX-CHP-13-1555"/><a class="indexterm" id="IDX-CHP-13-1556"/><a class="indexterm" id="IDX-CHP-13-1557"/><a class="indexterm" id="IDX-CHP-13-1558"/><a class="indexterm" id="IDX-CHP-13-1559"/><a class="indexterm" id="IDX-CHP-13-1560"/><a class="indexterm" id="IDX-CHP-13-1561"/></p><p>Linux FreeS/WAN is the most popular implementation of IPsec for Linux. Go to <a class="ulink" href="http://www.freeswan.org/">http://www.freeswan.org/</a> for downloads, documentation, and access to the community of FreeS/WAN users.<a class="indexterm" id="IDX-CHP-13-1562"/></p><p>OpenVPN is an SSL-based VPN solution for Linux, BSD, OS X, and Windows. OpenVPN is easy to configure and offers both <span class="emphasis"><em>routed VPN</em></span> (traffic to specific destinations is sent through the VPN) and <span class="emphasis"><em>tunneled virtual interfaces</em></span> (emulating a physical layer Ethernet device, which can pass non-IP traffic through the VPN). OpenVPN can be found at <a class="ulink" href="http://openvpn.net/">http://openvpn.net/</a>.<a class="indexterm" id="IDX-CHP-13-1563"/><a class="indexterm" id="IDX-CHP-13-1564"/><a class="indexterm" id="IDX-CHP-13-1565"/></p><p>If you're using a Linux firewall, you might want to consider VPN Masquerade. Linux uses the IP Masquerade function in the Linux kernel to share a single connection to the Internet among multiple clients. VPN Masquerade is the section of IP Masquerade that supports IPsec clients. The HOWTO for Linux VPN Masquerade is at <a class="ulink" href="http://tldp.org/HOWTO/VPNMasquerade-HOWTO.html">http://tldp.org/HOWTO/VPNMasquerade-HOWTO.html</a>.<a class="indexterm" id="IDX-CHP-13-1566"/><a class="indexterm" id="IDX-CHP-13-1567"/><a class="indexterm" id="IDX-CHP-13-1568"/></p></div><div class="sect3" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="network_hardware_with_built-in_vpn_supp"/>Network Hardware with Built-In VPN Support</h3></div></div></div><p>A dedicated computer running Linux or one of the BSD versions of Unix can be an inexpensive VPN server. Or if you're using a Windows server for other purposes, a dedicated computer can also provide VPN support at little or no additional cost. But a full-size network server is often a bigger and more complicated solution to a relatively simple problem. They're not always the best choice. Many switches, routers, gateways, and firewall devices also include VPN support. Cisco, 3COM, Intel, and many other manufacturers make VPN products that are often easier to install and maintain than a separate computer.<a class="indexterm" id="IDX-CHP-13-1569"/><a class="indexterm" id="IDX-CHP-13-1570"/><a class="indexterm" id="IDX-CHP-13-1571"/><a class="indexterm" id="IDX-CHP-13-1572"/></p><p>In a wireless network, the VPN server does not need all the same bells and whistles as a server in a larger corporate network. As <a class="xref" href="ch13s02.html#a_network_router_can_also_act_as_a_vpn" title="Figure 13-5. A network router can also act as a VPN server for a wireless network.">Figure 13-5</a> shows, a router located between the wireless access point and the wired portion of an enterprise network can easily double as a VPN server. In a home network, the VPN server can operate between the access point and a DSL or cable modem.</p><div class="figure"><a id="a_network_router_can_also_act_as_a_vpn"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e13442"/><img alt="A network router can also act as a VPN server for a wireless network." src="tagoreillycom20090324nostarchimages266402.png.jpg"/></div></div><p class="title"><b>Figure 13-5. A network router can also act as a VPN server for a wireless network.</b></p></div><br class="figure-break"/><p>Stand-alone VPN client hardware that sits between the computer and the network is also available, but this setup isn't as practical in a wireless network because the wireless network adapter is almost always plugged directly into the computer itself.</p></div></div><div class="sect2" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="vpn_client_software"/>VPN Client Software</h2></div></div></div><p>A wireless client connects to a VPN server through its wireless Ethernet link to the network access point, which the operating system sees as a LAN connection. To set up a VPN tunnel through that connection, you must install the tunneling protocol as a network service.<a class="indexterm" id="IDX-CHP-13-1573"/><a class="indexterm" id="IDX-CHP-13-1574"/><a class="indexterm" id="IDX-CHP-13-1575"/><a class="indexterm" id="IDX-CHP-13-1576"/><a class="indexterm" id="IDX-CHP-13-1577"/><a class="indexterm" id="IDX-CHP-13-1578"/><a class="indexterm" id="IDX-CHP-13-1579"/></p><div class="sect3" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="configuring_windows_for_vpn"/>Configuring Windows for VPN</h3></div></div></div><p>Windows XP and Vista include support for virtual private networks, but this support is not part of the default installation, so the first step in setting up a VPN client is to install the protocol.<a class="indexterm" id="IDX-CHP-13-1580"/><a class="indexterm" id="IDX-CHP-13-1581"/><a class="indexterm" id="IDX-CHP-13-1582"/><a class="indexterm" id="IDX-CHP-13-1583"/><a class="indexterm" id="IDX-CHP-13-1584"/><a class="indexterm" id="IDX-CHP-13-1585"/><a class="indexterm" id="IDX-CHP-13-1586"/><a class="indexterm" id="IDX-CHP-13-1587"/></p><p>In Windows XP and Windows Vista, a wizard makes the whole process easy. In XP, follow these steps to set up a VPN connection:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>From the Control Panel, open Network Connections.</p></li><li class="listitem"><p>Double-click the <span class="strong"><strong>New Connection Wizard</strong></span> icon.</p></li><li class="listitem"><p>When the Network Connection Type window, shown in <a class="xref" href="ch13s02.html#the_option_for_creating_a_vpn_link_spec" title="Figure 13-6. The option for creating a VPN link specifies connecting to a workplace network, but this option also applies to a wireless VPN.">Figure 13-6</a>, appears, select the <span class="strong"><strong>Connect to the network at my workplace</strong></span> option and click the <span class="strong"><strong>Next</strong></span> button.</p><div class="figure"><a id="the_option_for_creating_a_vpn_link_spec"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e13560"/><img alt="The option for creating a VPN link specifies connecting to a workplace network, but this option also applies to a wireless VPN." src="tagoreillycom20090324nostarchimages266404.png.jpg"/></div></div><p class="title"><b>Figure 13-6. The option for creating a VPN link specifies connecting to a workplace network, but this option also applies to a wireless VPN.</b></p></div><br class="figure-break"/></li><li class="listitem"><p>In the Network Connection window (shown in <a class="xref" href="ch13s02.html#select_the_virtual_private_network_conn" title="Figure 13-7. Select the Virtual Private Network connection option to create a VPN connection.">Figure 13-7</a>), select the <span class="strong"><strong>Virtual Private Network connection</strong></span> option and click the <span class="strong"><strong>Next</strong></span> button.</p><div class="figure"><a id="select_the_virtual_private_network_conn"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e13579"/><img alt="Select the Virtual Private Network connection option to create a VPN connection." src="tagoreillycom20090324nostarchimages266406.png.jpg"/></div></div><p class="title"><b>Figure 13-7. Select the Virtual Private Network connection option to create a VPN connection.</b></p></div><br class="figure-break"/></li><li class="listitem"><p>In the Connection Name window, type a name for the wireless VPN connection. This name will appear on desktop shortcuts to this connection. Click the <span class="strong"><strong>Next</strong></span> button.</p></li><li class="listitem"><p>In the Public Network window (shown in <a class="xref" href="ch13s02.html#in_a_wireless_network_comma_the_vpn_doe" title="Figure 13-8. In a wireless network, the VPN does not require a dial-up connection.">Figure 13-8</a>), select the <span class="strong"><strong>Do not dial the initial connection</strong></span> option because you don't need to connect through a telephone line. Click the <span class="strong"><strong>Next</strong></span> button.</p><div class="figure"><a id="in_a_wireless_network_comma_the_vpn_doe"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e13604"/><img alt="In a wireless network, the VPN does not require a dial-up connection." src="tagoreillycom20090324nostarchimages266408.png.jpg"/></div></div><p class="title"><b>Figure 13-8. In a wireless network, the VPN does not require a dial-up connection.</b></p></div><br class="figure-break"/></li><li class="listitem"><p>In the VPN Server Selection window, shown in <a class="xref" href="ch13s02.html#the_host_name_or_ip_address_identifies" title="Figure 13-9. The host name or IP address identifies the VPN server at the other end of the wireless link.">Figure 13-9</a>, type the host name or IP address of the VPN server.<a class="indexterm" id="IDX-CHP-13-1588"/></p><div class="figure"><a id="the_host_name_or_ip_address_identifies"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e13625"/><img alt="The host name or IP address identifies the VPN server at the other end of the wireless link." src="tagoreillycom20090324nostarchimages266410.png.jpg"/></div></div><p class="title"><b>Figure 13-9. The host name or IP address identifies the VPN server at the other end of the wireless link.</b></p></div><br class="figure-break"/></li><li class="listitem"><p>Click the <span class="strong"><strong>Next</strong></span> button and then the <span class="strong"><strong>Finish</strong></span> button to complete the wizard.</p></li></ol></div><p>In Vista, follow these steps:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Open the Control Panel.</p></li><li class="listitem"><p>Select the <span class="strong"><strong>Network and Sharing Center</strong></span>.</p></li><li class="listitem"><p>In the Tasks list on the left side of the Network and Sharing Center, shown in <a class="xref" href="ch13s02.html#use_the_set_up_a_connection_or_network" title="Figure 13-10. Use the Set up a connection or network option to create a VPN link.">Figure 13-10</a>, select the <span class="strong"><strong>Set up a connection or network</strong></span> option. A Choose a Connection Option window will open.</p><div class="figure"><a id="use_the_set_up_a_connection_or_network"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e13662"/><img alt="Use the Set up a connection or network option to create a VPN link." src="tagoreillycom20090324nostarchimages266412.png.jpg"/></div></div><p class="title"><b>Figure 13-10. Use the Set up a connection or network option to create a VPN link.</b></p></div><br class="figure-break"/></li><li class="listitem"><p>Select the <span class="strong"><strong>Connect to a workplace</strong></span> option and click the <span class="strong"><strong>Next</strong></span> button. The wizard will ask if you want to use an existing connection.<a class="indexterm" id="IDX-CHP-13-1589"/></p></li><li class="listitem"><p>Select the <span class="strong"><strong>No, create a new connection</strong></span> option. The wizard will ask if you want to use a VPN or a dial-up connection.</p></li><li class="listitem"><p>Select the <span class="strong"><strong>Internet connection (VPN)</strong></span> option. The wizard will then ask for details in the screen shown in <a class="xref" href="ch13s02.html#use_this_screen_to_configure_your_vpn" title="Figure 13-11. Use this screen to configure your VPN.">Figure 13-11</a>.</p></li><li class="listitem"><p>Type the VPN server's address provided by the network manager in the Internet address field. This can be either a numeric address or a name.</p></li><li class="listitem"><p>Type the name you want to use on your own computer for this VPN connection in the Destination name field.</p></li><li class="listitem"><p>If you want to test the connection, click the Next button. If you don't want to connect, select the Don't connect now option and then click Next. The wizard will ask for your name and password.</p></li><li class="listitem"><p>Type the name and password you use for this VPN account. If you want your computer to automatically send your password, turn on the Remember this password option. Click the <span class="strong"><strong>Create</strong></span> button to establish the VPN connection and close the wizard.</p><div class="figure"><a id="use_this_screen_to_configure_your_vpn"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e13716"/><img alt="Use this screen to configure your VPN." src="tagoreillycom20090324nostarchimages266414.png.jpg"/></div></div><p class="title"><b>Figure 13-11. Use this screen to configure your VPN.</b></p></div><br class="figure-break"/></li></ol></div><p>To create a shortcut to a VPN on your desktop in Windows, follow these steps:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>In XP, open the Control Panel and select <span class="strong"><strong>Network Connections</strong></span>. In Vista, open the Control Panel, select the <span class="strong"><strong>Network and Sharing Center</strong></span>, and select <span class="strong"><strong>Manage Network Connections</strong></span> from the Tasks list.</p></li><li class="listitem"><p>From the Network Connections window, right-click the icon or listing for the VPN and select <span class="strong"><strong>Create Shortcut</strong></span> from the pop-up menu.<a class="indexterm" id="IDX-CHP-13-1590"/></p></li><li class="listitem"><p>A pop-up window will ask if you want to place the shortcut on the desktop. Click the <span class="strong"><strong>Yes</strong></span> button. A shortcut will now appear on the desktop.</p></li></ol></div></div><div class="sect3" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="the_microsoft_l2tp_solidus_ipsec_vpn_cl"/>The Microsoft L2TP/IPsec VPN Client</h3></div></div></div><p>Microsoft includes a client for L2TP connections with Internet Protocol security (IPsec) in Windows 2000, Windows XP, and Windows Vista. A similar client program for Windows 98, Windows Me, and Windows NT Workstation 4.0 is available for free download from <a class="ulink" href="http://download.microsoft.com/download/win98/Install/1.0/W9XNT4Me/EN-US/msl2tp.exe">http://download.microsoft.com/download/win98/Install/1.0/W9XNT4Me/EN-US/msl2tp.exe</a>.<a class="indexterm" id="IDX-CHP-13-1591"/><a class="indexterm" id="IDX-CHP-13-1592"/><a class="indexterm" id="IDX-CHP-13-1593"/><a class="indexterm" id="IDX-CHP-13-1594"/></p></div><div class="sect3" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="making_the_connection_in_windows"/>Making the Connection in Windows</h3></div></div></div><p>When the VPN connection profile is in place, it's easy to connect a Windows client to the host LAN or the Internet through the wireless VPN link: Just double-click the icon for the connection profile. Windows will ask for a login and password and then make the connection.</p><p>If you mostly use your wireless connection to connect to the Internet, you can make it the default connection, which will open whenever you run a network application such as a web browser or email client program. To make the VPN profile the default, follow these steps:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Open the <span class="strong"><strong>Internet Properties</strong></span> window from the Control Panel.</p></li><li class="listitem"><p>Select the <span class="strong"><strong>Connections</strong></span> tab.</p></li><li class="listitem"><p>In the Dial-Up Settings section, select the VPN connection profile from the list, and click the <span class="strong"><strong>Set Default</strong></span> button.</p></li><li class="listitem"><p>Click the <span class="strong"><strong>Settings</strong></span> button. In the Dial-Up Settings section, type your login and password on the VPN server.</p></li><li class="listitem"><p>Select the <span class="strong"><strong>Dial whenever a network connection is not present</strong></span> option.</p></li></ol></div></div><div class="sect3" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="selecting_windows_xp_and_vista_options"/>Selecting Windows XP and Vista Options</h3></div></div></div><p>Windows XP and Windows Vista offer many VPN options that were not available in earlier versions of Windows. To set these options, follow these steps:<a class="indexterm" id="IDX-CHP-13-1595"/><a class="indexterm" id="IDX-CHP-13-1596"/></p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Choose the <span class="strong"><strong>Network Connections</strong></span> window from the Control Panel. If you have a shortcut to your VPN connection on the desktop, you can skip this step.</p></li><li class="listitem"><p>Double-click the VPN icon. A Connect VPN to Internet window, like the one in <a class="xref" href="ch13s02.html#use_the_connect_vpn_to_internet_window" title="Figure 13-12. Use the Connect VPN to Internet window to configure a VPN in Windows XP.">Figure 13-12</a>, will appear.</p><div class="figure"><a id="use_the_connect_vpn_to_internet_window"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e13840"/><img alt="Use the Connect VPN to Internet window to configure a VPN in Windows XP." src="tagoreillycom20090324nostarchimages266416.png.jpg"/></div></div><p class="title"><b>Figure 13-12. Use the Connect VPN to Internet window to configure a VPN in Windows XP.</b></p></div><br class="figure-break"/></li><li class="listitem"><p>Click the <span class="strong"><strong>Properties</strong></span> button. The Properties window for your VPN client will appear. <a class="xref" href="ch13s02.html#the_general_tab_controls_the_destinatio" title="Figure 13-13. The General tab controls the destination of a VPN connection.">Figure 13-13</a> shows the General tab of the VPN to Internet Properties window.</p><div class="figure"><a id="the_general_tab_controls_the_destinatio"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e13856"/><img alt="The General tab controls the destination of a VPN connection." src="tagoreillycom20090324nostarchimages266418.png.jpg"/></div></div><p class="title"><b>Figure 13-13. The General tab controls the destination of a VPN connection.</b></p></div><br class="figure-break"/></li><li class="listitem"><p>The IP address of the VPN server should already be visible in the Host name or IP address of destination field. The <span class="strong"><strong>Dial another connection first</strong></span> option should be disabled. Click the <span class="strong"><strong>Networking</strong></span> tab to view the dialog shown in <a class="xref" href="ch13s02.html#the_networking_tab_controls_the_vpn_apo" title="Figure 13-14. The Networking tab controls the VPN's network configuration options.">Figure 13-14</a>.</p><div class="figure"><a id="the_networking_tab_controls_the_vpn_apo"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e13875"/><img alt="The Networking tab controls the VPN's network configuration options." src="tagoreillycom20090324nostarchimages266420.png.jpg"/></div></div><p class="title"><b>Figure 13-14. The Networking tab controls the VPN's network configuration options.</b></p></div><br class="figure-break"/></li><li class="listitem"><p>Select the type of VPN server your network will use from the Type of VPN menu. If you don't know the VPN type, select the Automatic option.</p></li><li class="listitem"><p>Select Internet Protocol (TCP/IP) or Internet Protocol Version 4 from the list of connection items, and click the <span class="strong"><strong>Properties</strong></span> button to change the network settings, including the use of a DHCP server or manual settings for IP address and DNS.</p></li><li class="listitem"><p>Click the <span class="strong"><strong>Advanced</strong></span> tab to open the dialog shown in <a class="xref" href="ch13s02.html#the_advanced_tab_controls_the_use_of_a" title="Figure 13-15. The Advanced tab controls the use of a firewall on the VPN.">Figure 13-15</a>. If your network is not already protected by a firewall, select the Internet Connection Firewall option. This will protect the wireless client from attacks coming through the Internet.</p><div class="figure"><a id="the_advanced_tab_controls_the_use_of_a"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e13900"/><img alt="The Advanced tab controls the use of a firewall on the VPN." src="tagoreillycom20090324nostarchimages266422.png.jpg"/></div></div><p class="title"><b>Figure 13-15. The Advanced tab controls the use of a firewall on the VPN.</b></p></div><br class="figure-break"/></li></ol></div><p>The Options and Security tabs in the VPN to Internet Properties window control connection options that normally don't change from the default settings. Network managers who want to change the security settings should instruct their users on how to configure these options to comply with the network's specific requirements.</p></div></div><div class="sect2" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="vpn_clients_for_linux_solidus_unix"/>VPN Clients for Linux/Unix</h2></div></div></div><p>Using a VPN client on a computer running Unix is more complicated than running a VPN from a Windows machine because the client is not integrated into the kernel. Therefore, you must find a client program that works with the version of Unix and the VPN protocol you're trying to use. No single program offers a universal VPN client, and some combinations, such as PPTP on BSD Unix versions, don't seem to exist at all.<a class="indexterm" id="IDX-CHP-13-1597"/><a class="indexterm" id="IDX-CHP-13-1598"/><a class="indexterm" id="IDX-CHP-13-1599"/><a class="indexterm" id="IDX-CHP-13-1600"/><a class="indexterm" id="IDX-CHP-13-1601"/><a class="indexterm" id="IDX-CHP-13-1602"/><a class="indexterm" id="IDX-CHP-13-1603"/><a class="indexterm" id="IDX-CHP-13-1604"/><a class="indexterm" id="IDX-CHP-13-1605"/></p><p>Linux users, however, can choose from several IPsec implementations:</p><table border="0" class="simplelist" summary="Simple list"><tr><td><span class="strong"><strong>FreeS/WAN</strong></span> <a class="ulink" href="http://www.freeswan.org/">http://www.freeswan.org/</a></td></tr><tr><td><span class="strong"><strong>pipsec</strong></span> <a class="ulink" href="http://perso.enst.fr/~beyssac/pipsec">http://perso.enst.fr/~beyssac/pipsec</a></td></tr><tr><td><span class="strong"><strong>NIST Cerberus</strong></span> <a class="ulink" href="http://w3.antd.nist.gov/tools/cerberus/">http://w3.antd.nist.gov/tools/cerberus/</a></td></tr></table><p>IPsec is included in the OpenBSD distribution. You can find a tutorial that explains how to use it at <a class="ulink" href="http://tutorials.papamike.ca/pub/obsd_ipsec.html">http://tutorials.papamike.ca/pub/obsd_ipsec.html</a>.<a class="indexterm" id="IDX-CHP-13-1609"/><a class="indexterm" id="IDX-CHP-13-1606"/><a class="indexterm" id="IDX-CHP-13-1607"/><a class="indexterm" id="IDX-CHP-13-1608"/></p><p>The IPsec implementation for FreeBSD is at <a class="ulink" href="http://www.r4k.net/ipsec/">http://www.r4k.net/ipsec/</a>. For information about NetBSD IPsec, take a look at <a class="ulink" href="http://www.netbsd.org/Documentation/network/ipsec/">http://www.netbsd.org/Documentation/network/ipsec/</a>.<a class="indexterm" id="IDX-CHP-13-1610"/><a class="indexterm" id="IDX-CHP-13-1611"/></p></div><div class="sect2" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="openvpn_colon_a_cross-platform_alternati"/>OpenVPN: A Cross-Platform Alternative</h2></div></div></div><p>OpenVPN (<a class="ulink" href="http://openvpn.net/">http://openvpn.net/</a>) is an open source VPN that does not use IPSec. It can operate on Windows, Mac OS X, Linux, and Unix. It's designed for ease of use and security, even through noisy or otherwise unreliable networks.<a class="indexterm" id="IDX-CHP-13-1614"/><a class="indexterm" id="IDX-CHP-13-1615"/><a class="indexterm" id="IDX-CHP-13-1616"/><a class="indexterm" id="IDX-CHP-13-1617"/><a class="indexterm" id="IDX-CHP-13-1618"/><a class="indexterm" id="IDX-CHP-13-1619"/><a class="indexterm" id="IDX-CHP-13-1620"/><a class="indexterm" id="IDX-CHP-13-1621"/><a class="indexterm" id="IDX-CHP-13-1622"/><a class="indexterm" id="IDX-CHP-13-1612"/><a class="indexterm" id="IDX-CHP-13-1613"/></p></div><div class="sect2" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="using_a_vpn_through_a_public_network"/>Using a VPN Through a Public Network</h2></div></div></div><p>When you connect your laptop to your corporate LAN through a public network at an airport or in a conference center, or if you're using a broadband wireless service, you can connect through that network to the Internet and onward to your corporate VPN server. Because you'll have to log in to the public network before you initiate the VPN connection, you should create a separate <span class="emphasis"><em>VPN via Public Network</em></span> connection profile in addition to the one you use from your own office. The profile should point to your corporate VPN server, but it should not be your default connection.</p><p>To connect through a public network on a computer running Windows, follow these steps:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Turn on the computer with the wireless network adapter in place.</p></li><li class="listitem"><p>Use your wireless configuration utility to select the public network you want to use.</p></li><li class="listitem"><p>Start Internet Explorer, Netscape Navigator, or another web browser. You will see the public network's login screen.</p></li><li class="listitem"><p>If the computer doesn't do it automatically, type your account name and password. The public network will acknowledge your login.</p></li><li class="listitem"><p>Minimize the browser window and open the <span class="strong"><strong>Network Connections</strong></span> window or find the VPN shortcut on your desktop.</p></li><li class="listitem"><p>Double-click the icon for your VPN via Public Network profile. The computer will connect through the Internet to your corporate LAN.</p></li><li class="listitem"><p>Type the login and password for your corporate network.</p></li></ol></div><p>VPNs are an important part of many networks' security plans for off-site users. With just a few keystrokes or mouse clicks, you can establish access to your network resources from anywhere with an Internet connection. If any Internet technique can eliminate the apparent distance between you and your LAN, your office, and your colleagues without sacrificing security, a virtual private network is that technique.<a class="indexterm" id="IDX-CHP-13-1623"/></p></div></div>
<div class="sect1" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="wireless_security"/>Wireless Security</h1></div></div></div><p>Wireless networks are not secure. They are safe enough for many users most of the time, but it's just not possible to make a network that uses radio to exchange data absolutely private.<a class="indexterm" id="IDX-CHP-13-1624"/><a class="indexterm" id="IDX-CHP-13-1625"/><a class="indexterm" id="IDX-CHP-13-1626"/><a class="indexterm" id="IDX-CHP-13-1627"/><a class="indexterm" id="IDX-CHP-13-1628"/><a class="indexterm" id="IDX-CHP-13-1629"/><a class="indexterm" id="IDX-CHP-13-1630"/><a class="indexterm" id="IDX-CHP-13-1631"/><a class="indexterm" id="IDX-CHP-13-1632"/><a class="indexterm" id="IDX-CHP-13-1633"/><a class="indexterm" id="IDX-CHP-13-1634"/><a class="indexterm" id="IDX-CHP-13-1635"/><a class="indexterm" id="IDX-CHP-13-1636"/><a class="indexterm" id="IDX-CHP-13-1637"/><a class="indexterm" id="IDX-CHP-13-1638"/></p><p>Wireless networks are a trade-off between security and convenience. The obvious benefits of a wireless network connection—fast and easy access to the network from a portable computer or an isolated location—come at a cost. For most users, the convenience of wireless operation outweighs the possible security threats. But just as you lock the doors of your car when you park it on the street, you should take similar steps to protect your network and your data.</p><p>The simple truth is that a wireless network uses radio signals with a well-defined set of characteristics, so somebody who wants to dedicate enough time and effort to monitoring those signals can probably find a way to intercept and read the data contained in them. If you send confidential information through a wireless link, an eavesdropper can copy them. Credit card numbers, account passwords, and other personal information are all vulnerable.<a class="indexterm" id="IDX-CHP-13-1639"/></p><p>An entire catalog of tools for cracking Wi-Fi encryption methods is easy to find on the Internet. Although 3G broadband and WiMAX networks might be more secure than Wi-Fi (primarily because capturing data from them is more difficult), and WPA encryption is better than WEP encryption, no wireless security is perfect. Encryption and other security methods can make data a little more difficult to steal, but these methods don't provide complete protection against a really dedicated snoop. As any police officer will tell you, locks are great for keeping out honest people, but serious thieves know how to get past them.<a class="indexterm" id="IDX-CHP-13-1640"/><a class="indexterm" id="IDX-CHP-13-1641"/><a class="indexterm" id="IDX-CHP-13-1642"/><a class="indexterm" id="IDX-CHP-13-1643"/><a class="indexterm" id="IDX-CHP-13-1644"/><a class="indexterm" id="IDX-CHP-13-1645"/></p><p>To make things even more dangerous, many network managers and home wireless users leave the doors and windows to their networks wide open to intruders by failing to use encryption and the other security features that are built into every Wi-Fi access point and network node. "Drive-by logins" to unprotected private networks are possible in many urban and suburban business districts and in a surprising number of residential neighborhoods.<a class="indexterm" id="IDX-CHP-13-1646"/></p><p>Most people have gotten the message about using encryption on their home and office networks, but too many of them are still using the older WEP encryption system rather than the much more secure WPA method. The technical support people at one major telephone company, Qwest, were still advising their DSL customers to use WEP encryption as late as mid-2007.<a class="indexterm" id="IDX-CHP-13-1647"/></p><p>If you're located in a city center or a suburb, you can probably see this for yourself. When you use your Wi-Fi control program to scan the networks in your neighborhood, you will probably see a list of nearby networks in addition to your own access point. The control program will also tell you what kind of encryption (if any) each network is using. In the example shown in <a class="xref" href="ch13s03.html#four_of_the_networks_in_this_neighborho" title="Figure 13-16. Four of the networks in this neighborhood require an encryption key before they will connect.">Figure 13-16</a>, one network (RedGoldandGreen) is wide open, and four others are encrypted; two of the encrypted networks use WPA, and the two that are listed as "security-enabled" without an encryption type use WEP.<a class="indexterm" id="IDX-CHP-13-1648"/></p><div class="figure"><a id="four_of_the_networks_in_this_neighborho"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e14242"/><img alt="Four of the networks in this neighborhood require an encryption key before they will connect." src="tagoreillycom20090324nostarchimages266424.png.jpg"/></div></div><p class="title"><b>Figure 13-16. Four of the networks in this neighborhood require an encryption key before they will connect.</b></p></div><br class="figure-break"/><p>Do the math: Your access point can reach 150 feet or more in all directions, so the signal probably extends beyond your own property lines (or the walls of your apartment or office). A network device in the building next door or across the street can probably detect your network. If you don't take some precautions to prevent it, your neighbor, or somebody using a laptop or PDA inside a car parked on the street, can log in to your LAN, steal files from your servers, and tie up your Internet connection with streaming videos, multiplayer games, or worse.</p><p>It's important to understand that we're talking about two different kinds of security threats. The first is the danger of an outsider connecting to your network without your knowledge or permission; the second is the possibility that a dedicated eavesdropper can steal or modify data as you send and receive it. Each represents a different potential problem, and each requires a different approach to prevention and protection. While it's certainly true that none of the encryption tools currently available can provide complete protection, they can make life more difficult for most casual intruders. And as long as the tools are out there, you might as well use them.</p><p>An unsecured wireless network presents many opportunities to an attacker. Not only are the network crackers able to monitor any data that moves through the network, but they might also be able to modify that data. If, for example, your web browser has a vulnerability, an attacker can replace images as you view them with an image that exploits that vulnerability and installs a Trojan horse program on your computer, allowing the attacker to steal data stored on the computer, <span class="emphasis"><em>even if you never sent that data over the wireless network</em></span>. This type of attack might be relatively rare (casual snoopers are unlikely to take the time to snoop around on the chance you have something interesting), but it still presents a real risk.</p><p>Also, many popular websites encrypt the login page with SSL encryption via HTTPS, but they don't encrypt subsequent pages to reduce the drain on processing power—your password might be secure, but any email you read via the web mail interface might not be, and attackers might be able to steal the <span class="emphasis"><em>cookie</em></span> (a unique piece of data passed with web data) that identifies your login and open your mailbox directly.</p><div class="sect2" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="protecting_your_network_and_your_data"/>Protecting Your Network and Your Data</h2></div></div></div><p>As the operator of a Wi-Fi network, what can you do to keep outsiders out? You can employ a few techniques that can discourage them. First, you can accept the fact that wireless networks are not completely secure and use the built-in network security features to slow down would-be intruders; second, you can supplement your wireless router's built-in tools with a hardware or software firewall (or both) to isolate the wireless network; and third, you can use additional encryption such as a VPN to secure traffic to the network.<a class="indexterm" id="IDX-CHP-13-1649"/><a class="indexterm" id="IDX-CHP-13-1650"/><a class="indexterm" id="IDX-CHP-13-1651"/><a class="indexterm" id="IDX-CHP-13-1652"/><a class="indexterm" id="IDX-CHP-13-1653"/><a class="indexterm" id="IDX-CHP-13-1654"/><a class="indexterm" id="IDX-CHP-13-1655"/></p><p>The security features of the early Wi-Fi protocols (WEP encryption) were not adequate to protect data. The wireless equivalent privacy (WEP) protocol had several serious flaws: The basic encryption method (the RC4 algorithm) was known to have weaknesses in certain applications, all users had to know the key, and no secure mechanisms for distributing new keys existed. Most of these shortcomings were acknowledged and dismissed as being outside the scope of providing the same protection that a user on a standard wired network would receive, but in fact, they meant that wireless equivalent privacy was little better than no protection at all. Recent attacks (such as those performed by the aircrack-ptw tool) have further undermined WEP because these tools have often been able to disclose an encryption key in a matter of minutes by analyzing a limited amount of traffic. With these developments, WEP should be treated more as a "do not disturb" sign than as a real means of protection.<a class="indexterm" id="IDX-CHP-13-1656"/></p><p>The WPA and WPA2 standards attempt to fix the shortcomings of WEP, but they only work when all of the users of your network have modern cards and drivers. Most, if not all, network interfaces made in the last few years support WPA or WPA2.<a class="indexterm" id="IDX-CHP-13-1657"/></p><p>For most of us, the more serious danger is not that people will eavesdrop on our messages but that they will create their own connection to your network and either read files stored on computers on the LAN or use your broadband connection to the Internet without your knowledge.</p><p>However, business networks must take extra precautions to protect their (and their customers') data. Several high-profile compromises of customer credit card data in major store chains have been traced to inadequate network protection.</p><p>Maintaining control of your network and keeping it secure is essential. "Wi-Fi Security" in <a class="xref" href="ch08s07.html" title="Wi-Fi Security">Wi-Fi Security</a> includes a list of specific actions you can use to keep intruders out of your wireless network.</p><p>The security tools in the Wi-Fi specifications aren't perfect, but they're better than nothing. Even if you choose not to use them, it's essential to understand what they are and how they work, if only to turn them off.</p></div><div class="sect2" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="network_name"/>Network Name</h2></div></div></div><p>Every wireless network has a name. In a network with just one access point, the name is the basic service set ID (BSSID). When the network has more than one access point, the name becomes the extended service set ID (ESSID), but your computer's control program displays both types in the same list. The generic designation for all network names is the <span class="emphasis"><em>service set ID (SSID)</em></span>, which is the term you will see most often in wireless access point and client configuration utility programs.<a class="indexterm" id="IDX-CHP-13-1658"/><a class="indexterm" id="IDX-CHP-13-1659"/><a class="indexterm" id="IDX-CHP-13-1660"/><a class="indexterm" id="IDX-CHP-13-1661"/><a class="indexterm" id="IDX-CHP-13-1662"/><a class="indexterm" id="IDX-CHP-13-1663"/><a class="indexterm" id="IDX-CHP-13-1664"/><a class="indexterm" id="IDX-CHP-13-1665"/><a class="indexterm" id="IDX-CHP-13-1666"/><a class="indexterm" id="IDX-CHP-13-1667"/><a class="indexterm" id="IDX-CHP-13-1668"/><a class="indexterm" id="IDX-CHP-13-1669"/><a class="indexterm" id="IDX-CHP-13-1670"/><a class="indexterm" id="IDX-CHP-13-1671"/><a class="indexterm" id="IDX-CHP-13-1672"/><a class="indexterm" id="IDX-CHP-13-1673"/></p><p>When you configure the access points for a network, you must specify the SSID for that network. Every access point and network client in a network must use the same SSID. When a network client detects two or more access points with the same SSID, it assumes that they are all part of the same network (even if the access points are operating on different radio channels), and the client associates with the access point that provides the strongest or cleanest signal. If that signal deteriorates due to interference or fading, the client will try to shift to another access point on what it thinks is the same network. This transfer is called a <span class="emphasis"><em>handoff</em></span>.</p><p>If two different networks with overlapping signals have the same name, a client will assume that they're both part of a single network, and it might try to perform a handoff from one network to the other. From the user's point of view, this misdirected handoff will look like the network has completely dropped its connection. Therefore, every wireless network that could possibly overlap with another network must have a unique SSID.</p><p>The exceptions to the unique SSID rule are public and community networks that only provide access to the Internet but not to other computers or other devices on a LAN. Those networks often have a common SSID, so subscribers can detect and connect to them from more than one location. In other words, if you have an Internet access account at your local coffee shop, you might find and use exactly the same SSID when you visit another shop owned by the same company.</p><p>A network's SSID provides a very limited form of access control because it's necessary to specify the SSID when you set up a wireless connection. The SSID option in an access point is always a text field that will accept any name you care to assign, but many network configuration programs (including the wireless network tools in Windows XP and those supplied with several major brands of network adapters) automatically detect and display the SSIDs of every active network within their signal range.</p><p>It's not always necessary to know the SSID of a network before you try to connect; the configuration utility (or a network monitor or sniffer program like Network Stumbler) will show you the names of every nearby network in a list or a menu (the exceptions are networks in which the broadcast SSID feature has been turned off). For example, <a class="xref" href="ch13s03.html#network_stumbler_and_many_configuration" title="Figure 13-17. Network Stumbler and many configuration utilities display the SSIDs of every nearby wireless network.">Figure 13-17</a> shows the result of a Network Stumbler scan at Seattle-Tacoma Airport, where Wayport served the passenger terminal and MobileStar provided coverage in the American Airlines VIP club.</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>Every access point comes with a default SSID setting and password. These defaults are well known and documented within the community of network snoops (run a web search for <span class="emphasis"><em>default SSID</em></span> to find several lists). Obviously, the defaults should never be used in any active network. Make sure you change the access point's administrative login and password while you're at it.</p></div><div class="figure"><a id="network_stumbler_and_many_configuration"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e14433"/><img alt="Network Stumbler and many configuration utilities display the SSIDs of every nearby wireless network." src="tagoreillycom20090324nostarchimages266426.png.jpg"/></div></div><p class="title"><b>Figure 13-17. Network Stumbler and many configuration utilities display the SSIDs of every nearby wireless network.</b></p></div><br class="figure-break"/><p>Normally, most Wi-Fi access points send out beacon signals that broadcast the network's SSID. When a network adapter performs a radio scan, it detects those beacon signals and displays a list of nearby SSIDs in its control program. However, you can disable the SSID broadcast so the network doesn't show up on most control program scans. To connect a computer to a network whose name is not visible, you must instruct your control program to search for the SSID.</p><p>A nonbroadcast SSID is not completely invisible. A sniffer program (such as Network Stumbler) can still detect it and display the SSID, and every time a user connects to the network, the network adapter sends the SSID in a packet that can be easily sniffed. Disabling the SSID broadcast might, in some cases, make it easier for an attacker to later attack the laptop of one of your users (this is a more serious issue for businesses or corporate network administrators than for people running home networks). Because the laptop cannot know if the hidden network is available, it must constantly probe for the network, announcing its presence and giving an attacker much of the information needed to spoof the hidden network. Because a hidden network must be in a laptop's Preferred Networks list, the laptop will automatically connect to the spoofed network.<a class="indexterm" id="IDX-CHP-13-1674"/></p></div><div class="sect2" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="wep_encryption"/>WEP Encryption</h2></div></div></div><p>WEP encryption is an option in every Wi-Fi system, so it's important to know how it works, even if you choose not to use it. As the name suggests, the original intent of the wired equivalent privacy (WEP) protocol was to provide a level of security on wireless networks that was comparable to the security of a wired network. That was the goal, but a network that depends on WEP encryption is almost as vulnerable to intrusion as a network with no protection at all. WEP will keep out the casual snoops (and your freeloading neighbors, if they're not particularly adept at cracking encryption), but WEP is not particularly effective against a dedicated intruder. The more recent WPA encryption is always the better choice.<a class="indexterm" id="IDX-CHP-13-1676"/><a class="indexterm" id="IDX-CHP-13-1677"/><a class="indexterm" id="IDX-CHP-13-1678"/><a class="indexterm" id="IDX-CHP-13-1679"/><a class="indexterm" id="IDX-CHP-13-1680"/><a class="indexterm" id="IDX-CHP-13-1681"/><a class="indexterm" id="IDX-CHP-13-1682"/><a class="indexterm" id="IDX-CHP-13-1675"/><a class="indexterm" id="IDX-CHP-13-1683"/></p><p>WEP encryption is intended to serve three functions: It prevents unauthorized access to the network; it performs an integrity check on each packet; and it protects the data from eavesdroppers. WEP uses a secret encryption key to encode data packets before a network client or an access point transmits them, and it uses the same key to decode packets after it receives them. The original standard used shared authentication, in which the access point sends a challenge packet that a client must encrypt with the proper WEP key and send back. However, this opens a significant vulnerability by allowing a snooper to watch both parts of the exchange and derive the key.</p><p>The "open" authentication method, which should be used by any network using WEP (not that any network should use WEP), simply discards packets that cannot be decrypted by the network's WEP key. Therefore, the WEP settings must be exactly the same on every access point and client adapter in the network. This sounds simple enough, but it can get confusing because manufacturers use different methods to identify the size and format of a WEP key. The functions don't change from one brand to another, but identical settings don't always have identical descriptions.</p><div class="sect3" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="how_many_bits_in_your_encryption_key_qu"/>How Many Bits in Your Encryption Key?</h3></div></div></div><p>A WEP key can have either 64 bits or 128 bits. Although 128-bit keys are more difficult to crack (but they are still pretty insecure), they also increase the amount of time needed to transmit each packet. However, confusion arises because a 40-bit WEP key is the same as a 64-bit WEP key, and a 104-bit key is the same as a 128-bit key. The standard 64-bit WEP key is a string that includes an internally generated 24-bit initialization vector and a 40-bit secret key assigned by the network manager. Some manufacturers' specifications and configuration programs call this <span class="emphasis"><em>64-bit encryption</em></span>, but others describe it as <span class="emphasis"><em>40-bit encryption</em></span>. Either way, the encryption scheme is the same, so an adapter that uses 40-bit encryption is fully compatible with an access point or another adapter that uses 64-bit encryption.<a class="indexterm" id="IDX-CHP-13-1684"/><a class="indexterm" id="IDX-CHP-13-1685"/><a class="indexterm" id="IDX-CHP-13-1686"/><a class="indexterm" id="IDX-CHP-13-1687"/><a class="indexterm" id="IDX-CHP-13-1688"/></p><p>Many network adapters and access points also include a <span class="emphasis"><em>strong encryption</em></span> option that uses a 128-bit key. Devices that support strong encryption are downward compatible with 64-bit encryption, but compatibility is not automatic, so all of the devices on a mixed network of 128-bit and 64-bit devices will operate at 64 bits. If your access point and all of your adapters accept 128-bit encryption, use a 128-bit key. But if you want your network to be compatible with adapters and access points that only recognize 64-bit encryption, set the entire network to use 64-bit keys.</p><p>In practice, the choice of 64- or 128-bit WEP encryption doesn't make much difference. Tools are easily available that can crack both types, although cracking a 128-bit key might take a bit longer.</p></div><div class="sect3" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="is_your_key_ascii_or_hex_question"/>Is Your Key ASCII or Hex?</h3></div></div></div><p>The length of the key is not the only confusing thing about setting WEP encryption. Some programs request the key as a string of ASCII characters, but many others want the key in hexadecimal (hex) numbers. Still others can generate the key from an optional passphrase.</p><p>Each ASCII character has 8 bits, so a 40-bit (or 64-bit) WEP key contains 5 characters, and a 104-bit (or 128-bit) key has 13 characters. In hex, each character uses 4 bits, so a 40-bit key has 10 hex characters, and a 128-bit key has 26 characters. In <a class="xref" href="ch13s03.html#the_configuration_utility_for_a_d-link" title="Figure 13-18. The configuration utility for a D-Link access point accepts WEP keys in hex format.">Figure 13-18</a>, the Wireless Setting screen for a D-Link access point, the 40-bit Shared Key Security field uses hex characters, so it has space for 10 characters. The D-Link program runs all 10 characters together in a single string, but some others split them into 5 sets of 2 digits or 2 sets of 5. The key looks the same to the computer either way, but copying the string when it's broken apart is easier.<a class="indexterm" id="IDX-CHP-13-1689"/></p><p>A passphrase is a string of text that the adapters and access points automatically convert to a string of hex characters. Because humans can generally remember actual words or phrases more easily than hex gibberish, a passphrase can be easier to distribute than a hex string. However, a passphrase is only useful when all the adapters and access points in a network come from the same manufacturer.</p><div class="figure"><a id="the_configuration_utility_for_a_d-link"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e14545"/><img alt="The configuration utility for a D-Link access point accepts WEP keys in hex format." src="tagoreillycom20090324nostarchimages266428.png"/></div></div><p class="title"><b>Figure 13-18. The configuration utility for a D-Link access point accepts WEP keys in hex format.</b></p></div><br class="figure-break"/></div><div class="sect3" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="what_are_the_options_question"/>What Are the Options?</h3></div></div></div><p>Like just about everything else in a Wi-Fi configuration utility, the names of the encryption options are not consistent from one program to the next. Some programs use a straightforward set of options such as "enable WEP (or WPA) encryption," but others use technical language taken from the formal 802.11 specification.<a class="indexterm" id="IDX-CHP-13-1691"/><a class="indexterm" id="IDX-CHP-13-1692"/><a class="indexterm" id="IDX-CHP-13-1693"/><a class="indexterm" id="IDX-CHP-13-1694"/><a class="indexterm" id="IDX-CHP-13-1695"/><a class="indexterm" id="IDX-CHP-13-1696"/><a class="indexterm" id="IDX-CHP-13-1697"/><a class="indexterm" id="IDX-CHP-13-1698"/><a class="indexterm" id="IDX-CHP-13-1699"/><a class="indexterm" id="IDX-CHP-13-1700"/><a class="indexterm" id="IDX-CHP-13-1701"/><a class="indexterm" id="IDX-CHP-13-1702"/><a class="indexterm" id="IDX-CHP-13-1703"/><a class="indexterm" id="IDX-CHP-13-1690"/><a class="indexterm" id="IDX-CHP-13-1704"/><a class="indexterm" id="IDX-CHP-13-1705"/></p><p>Some access points also offer a shared key authentication option that uses encryption when a network client has the key but uses unencrypted data with other network nodes.</p></div><div class="sect3" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="mixing_hex_and_ascii_keys"/>Mixing Hex and ASCII Keys</h3></div></div></div><p>Setting up a mixed network becomes more complicated when some network nodes use hex only and others require ASCII keys. If that's the situation on your network, you will want to follow these rules for setting the encryption keys:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Convert all your ASCII keys to hex. If a configuration program demands an ASCII key, enter the characters <span class="emphasis"><em>0x</em></span> (zero followed by lowercase letter <span class="emphasis"><em>x</em></span>), followed by the hex string. If you're using Apple's AirPort software, you'll have to enter a dollar sign (<span class="emphasis"><em>$</em></span>) at the beginning of a hex key.</p></li><li class="listitem"><p>Make sure all your encryption keys have exactly the right number of characters.</p></li><li class="listitem"><p>If all else fails, read the security sections of the manuals for your network adapters and access points. It's possible that one or more of the devices in your network might have some obscure proprietary feature that you don't know about.</p></li></ul></div></div></div><div class="sect2" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="wpa_encryption"/>WPA Encryption</h2></div></div></div><p>WPA encryption was developed as a partial solution to the security problems that make WEP encryption less than totally secure. WPA is much safer than WEP, but cracking WPA is still possible.<a class="indexterm" id="IDX-CHP-13-1707"/><a class="indexterm" id="IDX-CHP-13-1708"/><a class="indexterm" id="IDX-CHP-13-1709"/><a class="indexterm" id="IDX-CHP-13-1710"/><a class="indexterm" id="IDX-CHP-13-1711"/><a class="indexterm" id="IDX-CHP-13-1712"/><a class="indexterm" id="IDX-CHP-13-1706"/></p><p>WPA is more secure because it uses a method called <span class="emphasis"><em>Temporal Key Integrity Protocol (TKIP)</em></span> to automatically change the encryption key after a specified period of time or after the system exchanges a specific number of packets. Because WPA changes the key frequently, it's a lot more difficult for a cracker to gather enough information to decipher its encryption code.<a class="indexterm" id="IDX-CHP-13-1713"/></p><p>In large networks, WPA uses an authentication server to verify the identity of each network user. The server uses Remote Authentication Dial-in User Service (RADIUS) and Extensible Authentication Protocol (EAP) to exchange encryption keys with the computers and other devices that are connected to the wireless network.<a class="indexterm" id="IDX-CHP-13-1714"/><a class="indexterm" id="IDX-CHP-13-1715"/><a class="indexterm" id="IDX-CHP-13-1716"/></p><p>In home networks and smaller business networks that don't have a server, a method called <span class="emphasis"><em>pre-shared key (PSK) mode</em></span> uses a passphrase stored in the access point in place of the authentication server. To connect to the network, users must enter the same passphrase on their computer or other network device (or set their device to automatically enter the passphrase). When you set up WPA encryption, you must specify whether the network uses a server or PSK mode.<a class="indexterm" id="IDX-CHP-13-1717"/></p><p>Any access point and network adapter that supports 802.11g or 802.11n should also recognize WPA encryption. If you're using an older 802.11b or 802.11a access point, you might be able to add WPA encryption by installing the latest version of firmware and drivers. Look in the support or downloads section of the manufacturer's website for free upgrade instructions and software.</p><div class="sect3" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="psk_passphrases"/>PSK Passphrases</h3></div></div></div><p>A WPA-PSK passphrase can be a string of either 8 to 63 ASCII characters or 64 hexadecimal digits. The passphrase that you enter into a network device must be exactly the same as the one stored in the access point. Obviously, typing 64 digits correctly is not something that you want to do frequently, so the ASCII alternative is the better choice for most users. For optimal security, the ASCII passphrase you assign to your network should be a random mixture of at least 20 characters including letters (capitals and lowercase), numbers, and punctuation marks.</p><p>A PSK network uses the passphrase to set up the initial connection between a client (such as a computer or PDA) and the access point. After the connection is in place, the TKIP assigns new encryption keys to every packet or group of packets. The PSK combines with your network SSID to calculate the final key value. Choosing a unique SSID and a strong passphrase is important.</p><p>Attackers can build large tables of SSID and PSK pairs for common network names and dictionary words, performing weeks of calculation once with the payoff of nearly instantly determining the key of any network that matches that pair of values. Choosing strong passphrases and unique SSIDs can mitigate this attack.</p></div><div class="sect3" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="using_wpa_encryption"/>Using WPA Encryption</h3></div></div></div><p>When you set up a new network, the security section of the access point's configuration software will ask if you want to use encryption, and if so, whether you want WEP or WPA encryption. Unless you're planning to run an open access network, you should choose WPA.<a class="indexterm" id="IDX-CHP-13-1718"/><a class="indexterm" id="IDX-CHP-13-1719"/><a class="indexterm" id="IDX-CHP-13-1720"/><a class="indexterm" id="IDX-CHP-13-1721"/><a class="indexterm" id="IDX-CHP-13-1722"/><a class="indexterm" id="IDX-CHP-13-1723"/><a class="indexterm" id="IDX-CHP-13-1724"/></p><p>In many cases, the access point will offer two or more types of WPA encryption. If your network includes a RADIUS server, choose EAP. If the network has no encryption server, use the WPA-TKIP option.</p><p>For a network user, providing a WPA key is just as easy as providing a WEP key. Most network adapters made in the last couple of years automatically recognize the type of encryption embedded in each Wi-Fi signal that they detect, so the control program might ask for an encryption key without specifying whether it's a WEP key or a WPA key.</p></div><div class="sect3" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="attacking_wpa_security"/>Attacking WPA Security</h3></div></div></div><p>It was probably inevitable that somebody would take the added security features in WPA encryption as a challenge and develop a WPA cracking tool.</p><p>Several such tools are out there, so WPA does not provide the impenetrable protection that some of its proponents might want you to believe. In particular, programs called coWPAtty and Aircrack-ng both use <span class="emphasis"><em>dictionary attacks</em></span> on WPA-TKIP networks to try thousands or millions of possible keys until they find the correct one. Fortunately, neither of these programs nor any of the others aimed at cracking WPA encryption are easy to use, and cracking a network can take a lot of time, so successful attacks on WPA are not particularly common. This technique takes time because the programs can only try about 50 different encryption keys per second, but eventually they will find the right passphrase and connect to the target network. Because each additional letter, number, or other character in a key increases the key's complexity, a long key takes much longer to crack than a short one. However, a commercial product called Elcomsoft Distributed Password Recovery uses graphics processors on video cards to "break Wi-Fi encryption up to 100 times faster than by using CPU only," so even a relatively long key is not that secure.<a class="indexterm" id="IDX-CHP-13-1725"/><a class="indexterm" id="IDX-CHP-13-1726"/></p><p>Completely protecting yourself against attacks might not be possible or practical, but a long passphrase that includes random numbers and punctuation marks is still a better choice than a string of words or numbers alone. In other words, something like <span class="emphasis"><em>hdt%mzx33wolf$fgilxxq&amp;#smedbxor</em></span> is a better passphrase than <span class="emphasis"><em>nostarchpressbooks</em></span>. But the only truly secure way to use Wi-Fi is to combine it with VPN encryption.</p></div></div><div class="sect2" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="access_control_open_parenthesis_mac_aut"/>Access Control (MAC Authentication)</h2></div></div></div><p>Most access points include an option that permits the network manager to restrict access to a specific list of client adapters. If a network device with a MAC address that does not appear on the list of authorized users tries to connect, the access point will not accept the request to associate with the network. This option can keep intruders from connecting to a wireless LAN, but it forces the network administrator to keep a complete list of users' adapters and their MAC address. Every time a new user wants to join the network, and every time an established user swaps adapters or gets a new laptop, PDA, or other device with a built-in adapter, the network manager must add one more MAC address to the list. This task is probably manageable in a home or small office network, but it could be a major undertaking for a larger corporate or campus-wide system, if it's practical at all.<a class="indexterm" id="IDX-CHP-13-1727"/><a class="indexterm" id="IDX-CHP-13-1728"/></p><p>MAC authentication does not provide unbreakable protection against unauthorized users because a determined cracker could monitor radio signals from approved users, intercept their adapters' MAC addresses, and load an approved address onto a different adapter. But combined with encryption and other security tools, authentication adds one more impediment in the path of a network cracker.<a class="indexterm" id="IDX-CHP-13-1729"/><a class="indexterm" id="IDX-CHP-13-1730"/><a class="indexterm" id="IDX-CHP-13-1731"/><a class="indexterm" id="IDX-CHP-13-1732"/></p><p>Every access point configuration utility uses a different format for its access lists. The manual and online documentation supplied with your access point should provide detailed instructions for creating and maintaining an access control list.</p><p>The Wi-Fi standards do not specify a maximum size for an access point's access control list, so the numbers are all over the map. Some access points limit the list to a few dozen entries, but others, such as the Proxim Harmony AP Controller, will support as many as 10,000 separate addresses. Still others accept an effectively unlimited number. If you plan to use a list of addresses to control access to your network, make sure your access point will work with a large enough list to support all of your users, with enough expansion space for future growth. As a rule of thumb, the access point should accept at least twice as many MAC addresses as the number of users on your network today.</p><p>Some access points also include a MAC address exclusion feature that allows the network manager to block one or more MAC addresses from access to the network.</p></div></div>
<div class="sect1" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="physical_security"/>Physical Security</h1></div></div></div><p>Intruders don't always use technology to crack into a network. Sometimes they use brute-force methods. For example, if a thief steals your laptop computer, he can often use the "convenience" features of the computer's software to connect to the Internet through your network, read your email and other confidential files, and gain access to other computers connected to the same network. Other low-tech methods include <span class="emphasis"><em>shoulder surfing</em></span>, where the bad guy watches your screen or your keyboard as you type a login name and password, and <span class="emphasis"><em>social engineering</em></span>, in which the intruder convinces you to reveal your password or other information because she has convinced you that she has a legitimate use for it.<a class="indexterm" id="IDX-CHP-13-1733"/><a class="indexterm" id="IDX-CHP-13-1734"/></p><p>There are some things you can do to protect your computer and the data stored in it:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Think like a thief and do whatever might be necessary to make the computer difficult to steal. Don't leave your laptop in plain sight in an unattended car, or walk away from it in a public location such as a coffee shop, airport, or library. In an office with cubicles or "open plan" workspaces, use a chain and lock to secure the computer to a desk, file cabinet, or other large object if you can't store it in a locked drawer or cabinet.</p></li><li class="listitem"><p>Don't place your computer near a window where passers-by can see exactly what you have.</p></li><li class="listitem"><p>When you're away from home or work, keep track of your laptop computer at all times.</p></li><li class="listitem"><p>Log off your office computer whenever you are about to leave your desk. Don't allow other people to wander in and use your account when you're not there.</p></li><li class="listitem"><p>Keep the login and password active on your laptop, and use encryption for files that contain confidential data. If somebody does steal the computer, you want it to be as difficult as possible for the thief to open and read your files.</p></li><li class="listitem"><p>Install an antitheft alarm device on a PC card in your laptop or an internal card in a desktop system. If somebody tries to move the computer, disconnect cables, or open the case without entering a security code first, the alarm device will sound a very loud alarm.</p></li><li class="listitem"><p>Use a tracking program such as LostPC (<a class="ulink" href="http://www.lostpc.com/">http://www.lostpc.com/</a>) on your laptop computer. The tracking software will automatically send a "here I am" signal to a security center every time it connects to the Internet from a new location. Police and Internet service providers can sometimes use this information to locate and recover a stolen computer.<a class="indexterm" id="IDX-CHP-13-1735"/></p></li><li class="listitem"><p>Consider using full-disk encryption tools such as TrueCrypt for Windows or dm-crypt for Linux, so the data on it is useless if your laptop is stolen.<a class="indexterm" id="IDX-CHP-13-1736"/><a class="indexterm" id="IDX-CHP-13-1737"/></p></li></ul></div></div>
<div class="sect1" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="windows_update_and_patches"/>Windows Update and Patches</h1></div></div></div><p>Microsoft distributes security updates and patches through the Internet at least once every month that include fixes for newly discovered security problems. You can manually check for updates and select the ones that you want to install, but it's a lot easier to let Windows automatically check for newly released update packages and install them for you. As network manager, you will want to set all the Windows computers on your network to run Automatic Updates.<a class="indexterm" id="IDX-CHP-13-1738"/><a class="indexterm" id="IDX-CHP-13-1739"/><a class="indexterm" id="IDX-CHP-13-1740"/><a class="indexterm" id="IDX-CHP-13-1741"/><a class="indexterm" id="IDX-CHP-13-1742"/><a class="indexterm" id="IDX-CHP-13-1743"/><a class="indexterm" id="IDX-CHP-13-1744"/><a class="indexterm" id="IDX-CHP-13-1745"/><a class="indexterm" id="IDX-CHP-13-1746"/><a class="indexterm" id="IDX-CHP-13-1747"/></p><p>To run Automatic Updates, follow these steps:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Right-click <span class="strong"><strong>My Computer</strong></span> and select <span class="strong"><strong>Properties</strong></span> from the pop-up menu. The System Properties window will appear.</p></li><li class="listitem"><p>Choose the <span class="strong"><strong>Automatic Updates</strong></span> tab from the System Properties window. The dialog shown in <a class="xref" href="ch13s05.html#use_the_automatic_updates_tab_in_system" title="Figure 13-19. Use the Automatic Updates tab in System Properties to turn on Windows Update.">Figure 13-19</a> will appear.</p><div class="figure"><a id="use_the_automatic_updates_tab_in_system"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e14963"/><img alt="Use the Automatic Updates tab in System Properties to turn on Windows Update." src="tagoreillycom20090324nostarchimages266430.png.jpg"/></div></div><p class="title"><b>Figure 13-19. Use the Automatic Updates tab in System Properties to turn on Windows Update.</b></p></div><br class="figure-break"/></li><li class="listitem"><p>Choose an option to set the way your computer will handle new updates. In most cases, the Automatic option is the best choice, but if you're using this computer for programs that require most of the system's processing power, such as sound or video recording, select the Notify me but don't automatically download or install them option instead.</p></li><li class="listitem"><p>Click <span class="strong"><strong>OK</strong></span> to save your settings and close the System Properties window.</p></li></ol></div><p>Automatic Updates loads changes that somebody at Microsoft has flagged as essential to the computer's performance or security, but it ignores many others, including new versions of device drivers and updates that add or improve other features for Windows and some related programs. To find and select these programs, follow these steps:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>If you aren't already connected to the Internet, connect your computer now.</p></li><li class="listitem"><p>From the Start menu, choose <span class="strong"><strong>Windows Update</strong></span>. You can also find a link to this command in Internet Explorer's Tools menu.</p></li><li class="listitem"><p>After the Update website confirms that it has installed the software it uses to scan your computer, the site displays the Welcome screen shown in <a class="xref" href="ch13s05.html#use_the_custom_button_to_search_for_non" title="Figure 13-20. Use the Custom button to search for nonessential updates.">Figure 13-20</a>. Click the <span class="strong"><strong>Custom</strong></span> button.</p><div class="figure"><a id="use_the_custom_button_to_search_for_non"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e15000"/><img alt="Use the Custom button to search for nonessential updates." src="tagoreillycom20090324nostarchimages266432.png.jpg"/></div></div><p class="title"><b>Figure 13-20. Use the Custom button to search for nonessential updates.</b></p></div><br class="figure-break"/></li><li class="listitem"><p>After the program completes its search for new programs, it will display a list like the one shown in <a class="xref" href="ch13s05.html#the_list_of_update_types_open_parenthes" title="Figure 13-21. The list of update types (left) shows the number of updates available for each category.">Figure 13-21</a>. Use the list of update types in the left column to display a list of available updates in each category. Don't forget to scroll down the list to see all the categories.</p><div class="figure"><a id="the_list_of_update_types_open_parenthes"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e15013"/><img alt="The list of update types (left) shows the number of updates available for each category." src="tagoreillycom20090324nostarchimages266434.png.jpg"/></div></div><p class="title"><b>Figure 13-21. The list of update types (left) shows the number of updates available for each category.</b></p></div><br class="figure-break"/></li><li class="listitem"><p>Choose the updates you want to install in each category from the right panel. The number in parentheses next to <span class="emphasis"><em>Install Updates</em></span> in the left panel shows the number of updates you have selected.</p></li><li class="listitem"><p>Click <span class="strong"><strong>Install Updates</strong></span>. The Review and Install Updates panel will appear on the right side of the window.</p></li><li class="listitem"><p>Click the <span class="strong"><strong>Install Updates</strong></span> button. The update program will load the updates you have selected, one at a time. If necessary, the Update routine will restart the computer to complete one or more updates.</p></li></ol></div></div>
<div class="sect1" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="microsoft_baseline_security_analyzer"/>Microsoft Baseline Security Analyzer</h1></div></div></div><p>Microsoft's Baseline Security Analyzer is a free tool that scans computers running Windows XP and Windows Vista to identify security threats and vulnerable features and functions. You can download it from <a class="ulink" href="http://technet.microsoft.com/en-us/security/cc184924.aspx">http://technet.microsoft.com/en-us/security/cc184924.aspx</a>. You can use the Baseline Security Analyzer to scan your own computer, or as network manager, you can test other computers connected to yours through your LAN. Baseline Security Analyzer provides a quick and easy way to find and fix many common security issues.<a class="indexterm" id="IDX-CHP-13-1754"/><a class="indexterm" id="IDX-CHP-13-1755"/><a class="indexterm" id="IDX-CHP-13-1756"/><a class="indexterm" id="IDX-CHP-13-1757"/><a class="indexterm" id="IDX-CHP-13-1758"/><a class="indexterm" id="IDX-CHP-13-1759"/><a class="indexterm" id="IDX-CHP-13-1748"/><a class="indexterm" id="IDX-CHP-13-1749"/><a class="indexterm" id="IDX-CHP-13-1750"/><a class="indexterm" id="IDX-CHP-13-1751"/><a class="indexterm" id="IDX-CHP-13-1752"/><a class="indexterm" id="IDX-CHP-13-1753"/></p><p><a class="xref" href="ch13s06.html#microsoft_baseline_security_analyzer_fi" title="Figure 13-22. Microsoft Baseline Security Analyzer finds potential security problems and offers instructions for fixing them.">Figure 13-22</a> shows the result of a Baseline Security Analyzer scan. For each item it identifies, you can click a link to an explanation (What was scanned) and instructions for correcting the problem.</p><div class="figure"><a id="microsoft_baseline_security_analyzer_fi"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject13_d1e15118"/><img alt="Microsoft Baseline Security Analyzer finds potential security problems and offers instructions for fixing them." src="tagoreillycom20090324nostarchimages266436.png.jpg"/></div></div><p class="title"><b>Figure 13-22. Microsoft Baseline Security Analyzer finds potential security problems and offers instructions for fixing them.</b></p></div><br class="figure-break"/></div>
<div class="sect1" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="controlling_your_own_users"/>Controlling Your Own Users</h1></div></div></div><p>As manager of your home or business network, remember that you're responsible for the security of the whole network and all the computers connected to it. Whenever it's practical, do whatever you can to encourage all your users to pay attention to security. Even if it seems easier to run their computers "wide open" without proper security measures, you are responsible for convincing them to keep their computers safe.<a class="indexterm" id="IDX-CHP-13-1760"/></p></div>
<div class="sect1" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="denial_of_service_attacks"/>Denial of Service Attacks</h1></div></div></div><p>A <span class="emphasis"><em>denial of service (DoS)</em></span> attack occurs when your network receives a very large number of incoming connection attempts that overloads the network's capacity to respond. The volume of traffic forces the computers and routers in the network to operate at or beyond their capacity, which causes them to either flood the network with useless traffic, disrupt connections among machines, or completely disrupt network service. For example, a <span class="emphasis"><em>mail bomb</em></span> attack might generate tens of thousands of useless email messages.</p><p>A DoS attack can make it impossible to do anything else on the network, or it can block legitimate incoming traffic, such as requests for access to a web server or exchange of email. Most DoS attacks are aimed at large businesses, government agencies, and educational institutions, so they're not a common problem for home or small business networks. Even so, it's important to know how to recognize DoS attacks and how to deal with them.</p><p>US-CERT, the United States Computer Emergency Readiness Team, has identified three basic types of DoS attack: consumption of limited resources, destruction or alteration of configuration information, and physical destruction or alteration of network components. If your small network suffers a DoS attack, you're likely to see a significant deterioration of network performance—or even a complete breakdown.</p><p>If somebody decides to target your network with a DoS attack, you can't do much to discourage them. Therefore, your best protection is to turn on the built-in filters in your firewall and modem, install all the latest security patches to your software and network hardware, and work closely with your Internet service provider at the first sign that your network is under attack. Most ISPs have more sophisticated monitoring and filtering resources that can help them identify and interrupt an attack.</p><p>In the United States, DoS attacks are a violation of federal law, so it's appropriate to ask your local FBI field office for assistance in finding and prosecuting the source of an attack.</p></div>
<div class="sect1" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="conclusion"/>Conclusion</h1></div></div></div><p>As manager of a home or small business network, maintaining its safety and security is one of your primary responsibilities. The methods outlined in this chapter, combined with some commonsense attention, will allow you and your users to concentrate on the business (and recreational) use of your computer, your network, and the Internet.<a class="indexterm" id="IDX-CHP-13-1761"/></p></div></body></html>