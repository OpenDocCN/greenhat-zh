<html><head></head><body><section epub:type="chapter" id="the_absolute_basics_of_penetration_testi"><div class="titlepage"><div class="book"><div class="book"><h2 class="title1">Chapter 1. The Absolute Basics of Penetration Testing</h2></div></div></div><p class="calibre2">Penetration testing is a way for you to simulate the methods that an attacker might use to circumvent security controls and gain access to an organization’s systems. Penetration testing is more than running scanners and automated tools and then writing a report. And you won’t become an expert penetration tester overnight; it takes years of practice and real-world experience to become proficient.</p><p class="calibre2">Currently, there is a shift in the way people regard and define penetration testing within the security industry. The <span class="strong"><em class="calibre4">Penetration Testing Execution Standard (PTES)</em></span> is redefining the penetration test in ways that will affect both new and experienced penetration testers, and it has been adopted by several leading members of the security community. Its charter is to define and raise awareness about what a true penetration test means by establishing a baseline of fundamental principles required to conduct a penetration test. If you’re new to penetration testing or unfamiliar with PTES, visit <a class="xref" href="http://www.pentest-standard.org/" target="_top">http://www.pentest-standard.org/</a> to learn more about it.</p><div class="book"><div class="titlepage"><div class="book"><div class="book"><h2 class="title2" id="the_phases_of_the_ptes">The Phases of the PTES</h2></div></div></div><p class="calibre2">PTES phases are designed to define a penetration test and assure the client organization that a standardized level of effort will be expended in a penetration test by anyone conducting this type of assessment. The standard is divided into seven categories with different levels of effort required for each, depending on the organization under attack.<a id="IDX-CHP-1-0001" class="strong"/><a id="IDX-CHP-1-0002" class="strong"/><a id="IDX-CHP-1-0003" class="strong"/><a id="IDX-CHP-1-0004" class="strong"/><a id="IDX-CHP-1-0005" class="strong"/><a id="IDX-CHP-1-0006" class="strong"/></p><div class="book"><div class="titlepage"><div class="book"><div class="book"><h3 class="title3" id="pre-engagement_interactions">Pre-engagement Interactions</h3></div></div></div><p class="calibre2"><span class="strong"><em class="calibre4">Pre-engagement interactions</em></span> typically occur when you discuss the scope and terms of the penetration test with your client. It is critical during pre-engagement that you convey the goals of the engagement. This stage also serves as your opportunity to educate your customer about what is to be expected from a thorough, full-scope penetration test — one without restrictions regarding what can and will be tested during the engagement.<a id="IDX-CHP-1-0007" class="strong"/><a id="IDX-CHP-1-0008" class="strong"/></p></div><div class="book"><div class="titlepage"><div class="book"><div class="book"><h3 class="title3" id="intelligence_gathering">Intelligence Gathering</h3></div></div></div><p class="calibre2">In the <span class="strong"><em class="calibre4">intelligence gathering</em></span> phase, you will gather any information you can about the organization you are attacking by using social-media networks, Google hacking, footprinting the target, and so on. One of the most important skills a penetration tester can have is the ability to learn about a target, including how it behaves, how it operates, and how it ultimately can be attacked. The information that you gather about your target will give you valuable insight into the types of security controls in place.</p><p class="calibre2">During intelligence gathering, you attempt to identify what protection mechanisms are in place at the target by slowly starting to probe its systems. For example, an organization will often only allow traffic on a certain subset of ports on externally facing devices, and if you query the organization on anything other than a whitelisted port, you will be blocked. It is generally a good idea to test this blocking behavior by initially probing from an expendable IP address that you are willing to have blocked or detected. The same holds true when you’re testing web applications, where, after a certain threshold, the web application firewalls will block you from making further requests.</p><p class="calibre2">To remain undetected during these sorts of tests, you can perform your initial scans from IP address ranges that can’t be linked back to you and your team. Typically, organizations with an external presence on the Internet experience attacks every day, and your initial probing will likely be an undetected part of the background noise.</p><div class="book"><hr class="calibre5"/></div><div class="note"><h3 class="title4">Note</h3><p class="calibre2">In some cases, it might make sense to run very noisy scans from an entirely different IP range other than the one you will be using for the main attack. This will help you determine how well the organization responds to the tools you are using.</p></div><div class="book"><hr class="calibre5"/></div></div><div class="book"><div class="titlepage"><div class="book"><div class="book"><h3 class="title3" id="threat_modeling">Threat Modeling</h3></div></div></div><p class="calibre2"><span class="strong"><em class="calibre4">Threat modeling</em></span> uses the information you acquired in the intelligence-gathering phase to identify any existing vulnerabilities on a target system. When performing threat modeling, you will determine the most effective attack method, the type of information you are after, and how the organization might be attacked. Threat modeling involves looking at an organization as an adversary and attempting to exploit weaknesses as an attacker would.<a id="IDX-CHP-1-0009" class="strong"/><a id="IDX-CHP-1-0010" class="strong"/><a id="IDX-CHP-1-0011" class="strong"/><a id="IDX-CHP-1-0012" class="strong"/></p></div><div class="book"><div class="titlepage"><div class="book"><div class="book"><h3 class="title3" id="vulnerability_analysis">Vulnerability Analysis</h3></div></div></div><p class="calibre2">Having identified the most viable attack methods, you need to consider how you will access the target. During <span class="strong"><em class="calibre4">vulnerability analysis</em></span>, you combine the information that you’ve learned from the prior phases and use it to understand what attacks might be viable. Among other things, vulnerability analysis takes into account port and vulnerability scans, data gathered by banner grabbing, and information collected during intelligence gathering.<a id="IDX-CHP-1-0013" class="strong"/></p></div><div class="book"><div class="titlepage"><div class="book"><div class="book"><h3 class="title3" id="exploitation">Exploitation</h3></div></div></div><p class="calibre2"><span class="strong"><em class="calibre4">Exploitation</em></span> is probably one of the most glamorous parts of a penetration test, yet it is often done with brute force rather than with precision. An exploit should be performed only when you know almost beyond a shadow of a doubt that a particular exploit will be successful. Of course, unforeseen protective measures might be in place on the target that prevent a particular exploit from working — but before you trigger a vulnerability, you should know that the system is vulnerable. Blindly firing off a mass onslaught of exploits and praying for a shell isn’t productive; it is noisy and provides little if any value to you as a penetration tester or to your client. Do your homework first, and then launch well-researched exploits that are likely to succeed.</p></div><div class="book"><div class="titlepage"><div class="book"><div class="book"><h3 class="title3" id="post_exploitation">Post Exploitation</h3></div></div></div><p class="calibre2">The <span class="strong"><em class="calibre4">post exploitation</em></span> phase begins after you have compromised one or more systems — but you’re not even close to being done yet.<a id="IDX-CHP-1-0014" class="strong"/></p><p class="calibre2">Post exploitation is a critical component in any penetration test. This is where you differentiate yourself from the average, run-of-the-mill hacker and actually provide valuable information and intelligence from your penetration test. Post exploitation targets specific systems, identifies critical infrastructure, and targets information or data that the company values most and that it has attempted to secure. When you exploit one system after another, you are trying to demonstrate attacks that would have the greatest business impact.</p><p class="calibre2">When attacking systems in post exploitation, you should take the time to determine what the various systems do and their different user roles. For example, suppose you compromise a domain infrastructure system and you’re running as an enterprise administrator or have domain administrative-level rights. You might be king of the domain, but what about the systems that communicate with Active Directory? What about the main financial application that is used to pay employees? Could you compromise that system, and then, on the next pay cycle, have it route all the money out of the company to an offshore account? How about the target’s intellectual property?</p><p class="calibre2">Suppose, for example, that your client is a large software development shop that ships custom-coded applications to customers for use in manufacturing environments. Can you backdoor their source code and essentially compromise all of their customers? What would that do to harm their brand credibility?<a id="IDX-CHP-1-0015" class="strong"/><a id="IDX-CHP-1-0016" class="strong"/><a id="IDX-CHP-1-0017" class="strong"/><a id="IDX-CHP-1-0018" class="strong"/><a id="IDX-CHP-1-0019" class="strong"/><a id="IDX-CHP-1-0020" class="strong"/></p><p class="calibre2">Post exploitation is one of those tricky scenarios in which you must take the time to learn what information is available to you and then use that information to your benefit. An attacker would generally spend a significant amount of time in a compromised system doing the same. Think like a malicious attacker — be creative, adapt quickly, and rely on your wits instead of automated tools.</p></div><div class="book"><div class="titlepage"><div class="book"><div class="book"><h3 class="title3" id="reporting">Reporting</h3></div></div></div><p class="calibre2"><span class="strong"><em class="calibre4">Reporting</em></span> is by far the most important element of a penetration test. You will use reports to communicate what you did, how you did it, and, most important, how the organization should fix the vulnerabilities discovered during the penetration test.<a id="IDX-CHP-1-0021" class="strong"/></p><p class="calibre2">When performing a penetration test, you’re working from an attacker’s point of view, something that organizations rarely see. The information you obtain during a test is vital to the success of the organization’s information security program and in stopping future attacks. As you compile and report your findings, think about how the organization can use your findings to raise awareness, remediate the issues discovered, and improve overall security rather than just patch the technical vulnerabilities.</p><p class="calibre2">At a minimum, divide your report into an executive summary, executive presentation, and technical findings. The technical findings will be used by the client to remediate security holes, but this is also where the value lies in a penetration test. For example, if you find a SQL injection vulnerability in the client’s web-based applications, you might recommend that your client sanitize all user input, leverage parameterized SQL queries, run SQL as a limited user account, and turn on custom error messages.<a id="IDX-CHP-1-0022" class="strong"/></p><p class="calibre2">After the client implements your recommendations and fixes the one specific SQL injection vulnerability, are they really protected from SQL injection? No. An underlying problem likely caused the SQL injection vulnerability in the first place, such as a failure to ensure that third-party applications are secure. Those will need to be fixed as well.</p></div></div><div class="book"><div class="titlepage"><div class="book"><div class="book"><h2 class="title2" id="types_of_penetration_tests">Types of Penetration Tests</h2></div></div></div><p class="calibre2">Now that you have a basic understanding of the seven PTES categories, let’s examine the two main types of penetration tests: <span class="strong"><em class="calibre4">overt</em></span> and <span class="strong"><em class="calibre4">covert</em></span>. An overt pen test, or “white hat” test, occurs with the organization’s full knowledge; covert tests are designed to simulate the actions of an unknown and unannounced attacker. Both tests offer advantages and disadvantages.</p><div class="book"><div class="titlepage"><div class="book"><div class="book"><h3 class="title3" id="overt_penetration_testing">Overt Penetration Testing</h3></div></div></div><p class="calibre2">Using overt penetration testing, you work with the organization to identify potential security threats, and the organization’s IT or security team shows you the organization’s systems. The one main benefit of an overt test is that you have access to insider knowledge and can launch attacks without fear of being blocked. A potential downside to overt testing is that overt tests might not effectively test the client’s incident response program or identify how well the security program detects certain attacks. When time is limited and certain PTES steps such as intelligence gathering are out of scope, an overt test may be your best option.<a id="IDX-CHP-1-0023" class="strong"/><a id="IDX-CHP-1-0024" class="strong"/><a id="IDX-CHP-1-0025" class="strong"/></p></div><div class="book"><div class="titlepage"><div class="book"><div class="book"><h3 class="title3" id="covert_penetration_testing">Covert Penetration Testing</h3></div></div></div><p class="calibre2">Unlike overt testing, sanctioned covert penetration testing is designed to simulate the actions of an attacker and is performed without the knowledge of most of the organization. Covert tests are performed to test the internal security team’s ability to detect and respond to an attack.<a id="IDX-CHP-1-0026" class="strong"/></p><p class="calibre2">Covert tests can be costly and time consuming, and they require more skill than overt tests. In the eyes of penetration testers in the security industry, the covert scenario is often preferred because it most closely simulates a true attack. Covert attacks rely on your ability to gain information by reconnaissance. Therefore, as a covert tester, you will typically not attempt to find a large number of vulnerabilities in a target but will simply attempt to find the easiest way to gain access to a system, undetected.</p></div></div><div class="book"><div class="titlepage"><div class="book"><div class="book"><h2 class="title2" id="vulnerability_scanners">Vulnerability Scanners</h2></div></div></div><p class="calibre2">Vulnerability scanners are automated tools used to identify security flaws affecting a given system or application. Vulnerability scanners typically work by <span class="strong"><em class="calibre4">fingerprinting</em></span> a target’s operating system (that is, identifying the version and type) as well as any services that are running. Once you have fingerprinted the target’s operating system, you use the vulnerability scanner to execute specific checks to determine whether vulnerabilities exist. Of course, these checks are only as good as their creators, and, as with any fully automated solution, they can sometimes miss or misrepresent vulnerabilities on a system.</p><p class="calibre2">Most modern vulnerability scanners do an amazing job of minimizing false positives, and many organizations use them to identify out-of-date systems or potential new exposures that might be exploited by attackers.</p><p class="calibre2">Vulnerability scanners play a very important role in penetration testing, especially in the case of overt testing, which allows you to launch multiple attacks without having to worry about avoiding detection. The wealth of knowledge gleaned from vulnerability scanners can be invaluable, but beware of relying on them too heavily. The beauty of a penetration test is that it can’t be automated, and attacking systems successfully requires that you have knowledge and skills. In most cases, when you become a skilled penetration tester, you will rarely use a vulnerability scanner but will rely on your knowledge and expertise to compromise a system.</p></div><div class="book"><div class="titlepage"><div class="book"><div class="book"><h2 class="title2" id="pulling_it_all_together">Pulling It All Together</h2></div></div></div><p class="calibre2">If you’re new to penetration testing or haven’t really adopted a formal methodology, study the PTES. As with any experiment, when performing a penetration test, ensure that you have a refined and adaptable process that is also repeatable. As a penetration tester, you need to ensure that your intelligence gathering and vulnerability analysis are as expert as possible, to give you an advantage in adapting to scenarios as they present themselves.</p></div></section></body></html>