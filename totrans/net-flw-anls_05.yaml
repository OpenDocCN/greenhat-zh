- en: Chapter 5. REPORTING AND FOLLOW-UP ANALYSIS
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '![image with no caption](httpatomoreillycomsourcenostarchimages651574.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: The ability to view exactly what traffic passed over your network is a powerful
    tool, but what can anyone do with this data in its entirety? After all, very few
    people can eyeball a list of 15,000 flows and identify the 10 most active hosts,
    identify the most commonly used ports, or even rank them by IP. Carefully choosing
    flow files to examine and then filtering their contents can reduce the number
    of flows you have to read, but this still leaves you with a huge data set to integrate,
    aggregate, and analyze even on a small network. You need a tool to aggregate flow
    data, sort it, and display the cumulative results.
  prefs: []
  type: TYPE_NORMAL
- en: The `flow-report` program reads flows and produces totals, rankings, per-second
    and per-interface counts, and other reports. You can create carefully customized
    reports to run over and over again, or you can use the built-in ones to perform
    ad hoc analysis. `flow-report` lets you quickly answer basic questions such as
    "Which web server sends the most traffic?" and "Which host is spewing viruses?"
    In this chapter, you'll see how to use `flow-report`'s many options and how to
    quickly answer your most important questions about your network.
  prefs: []
  type: TYPE_NORMAL
- en: Default Report
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Everything `flow-report` produces is configured in the file *stat.cfg*. The
    default configuration includes one generic report, with options to override many
    settings on the command line, much as `flow-nfilter` lets you configure filtering
    on the command line. You'll start with the default report and see how far you
    can stretch it.
  prefs: []
  type: TYPE_NORMAL
- en: First you'll use the default report without any configuration. This produces
    the *summary-detail report*, a generic statistical analysis of the flow data.
    The summary-detail report is rather lengthy, so I'll break it up into several
    chunks.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Every line that starts with a hash mark is information about how the report
    was prepared or a comment about the actual flow files. This information includes
    the version of flow-tools used, the date and times of the first and last flows
    in the flow files, the current date and time, and so on.
  prefs: []
  type: TYPE_NORMAL
- en: At ❶ you see the report's name as defined in the report configuration file.
    I haven't created any custom reports yet, so I generated the default report.
  prefs: []
  type: TYPE_NORMAL
- en: Report types (❷) dictate how the flow data is arranged, searched, sorted, and
    presented. Report types include things such as "most common ports" and "most common
    addresses." I'll cover most of them in this chapter. This particular report is
    the summary-detail report.
  prefs: []
  type: TYPE_NORMAL
- en: Report options (❸) tell `flow-report` what to include in the report. For example,
    the `+header` and `+xheader` options tell `flow-report` to include the report
    meta-information you're looking at right now. You can override the default options
    on the command line or set them in a custom report.
  prefs: []
  type: TYPE_NORMAL
- en: The fields setting (❹) tells `flow-report` what information to include in the
    report. Fields are columns in the report, as you'll see later with other report
    types. Again, you can override the default fields on the command line or set them
    in a custom report.
  prefs: []
  type: TYPE_NORMAL
- en: The records field (❺) shows whether `flow-report` has limited its output to
    a certain number of lines. You can set a maximum number of lines on the command
    line or in a report definition. This feature is useful if you want to know, for
    example, the top 10 hosts generating a certain type of traffic.
  prefs: []
  type: TYPE_NORMAL
- en: Knowing the flow version (❻) in the flow files tells you what information the
    report includes. You won't get BGP information from NetFlow version 1, for example.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, at ❼ you see the command used to format the report. The `flow-report`
    program produces comma-separated value (CSV) reports only and relies on an outside
    program (`flow-rptfmt`) to create formatted text or HTML.
  prefs: []
  type: TYPE_NORMAL
- en: Timing and Totals
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The next section includes details about the data inside the flow records. The
    first six lines are presented only when the report definition includes the `+totals`
    option.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-report` (❶) ignores flows with zero packets. Zero-packet flows are normally
    errors, but including them in other calculations will throw off your averages.'
  prefs: []
  type: TYPE_NORMAL
- en: You then see the total number of flows, octets, and packets in these flows.
    I captured 54,286 flows, or 633Mb, in 996,238 packets.
  prefs: []
  type: TYPE_NORMAL
- en: The total duration (❷) is the sum of the total time that the flows lasted, in
    milliseconds. For example, 10 one-second flows would give a total duration of
    10 seconds, or 10,000 milliseconds, even if the flows ran simultaneously.
  prefs: []
  type: TYPE_NORMAL
- en: The remaining information is all part of the default summary-detail report.
  prefs: []
  type: TYPE_NORMAL
- en: The `Real Time` header (❸) tells when the flow data ends in Unix epochal time.
    1322719199 is Thursday, December 1, 2011, at 00:59:59 EST, or just short of 1
    **am**.
  prefs: []
  type: TYPE_NORMAL
- en: The average flow time (❹) is the average flow duration in milliseconds.
  prefs: []
  type: TYPE_NORMAL
- en: You then have averages at ❺ for packets per second, flows per second, and packets
    per flow.
  prefs: []
  type: TYPE_NORMAL
- en: The two `Flows/Second` values at ❻ can be confusing. The first, `Flows/Second`,
    gives the number of flows per second you would expect by dividing the number of
    flows by the number of seconds in the sample. The `Flows/Second (real)` value
    calculation is based on epochal time and is not useful for most network management
    purposes.
  prefs: []
  type: TYPE_NORMAL
- en: Packet Size Distribution
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The next section of the summary-detail report, packet size distribution, shows
    the size of the packets in these flows as a fraction of all the packets.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: The first entry at ❶ shows what fraction of the packets in these flows has a
    size between 1 and 32 bytes; in this case, there are zero, as you can see at ❷.
  prefs: []
  type: TYPE_NORMAL
- en: A little less than a quarter of the packets in these flows (.232 as shown at
    ❹) are 64 bytes long (as shown at ❸). (I took these samples from a network segment
    with a heavily used DNS server, so I would expect many small flows.) Almost half
    of the packets are 96 bytes.
  prefs: []
  type: TYPE_NORMAL
- en: Packets per Flow
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The next section of the summary-detail report is the packets per flow, formatted
    much like the packet size distribution table.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Here you see at ❷ that 0.307, or roughly 31 percent, of the flows include only
    one packet (as shown at ❶). As you saw earlier, one-packet flows are generally
    ICMP requests or UDP such as simple DNS queries. Almost a quarter of the flows
    contain five to eight packets per flow (as shown at ❸). The remaining flows are
    scattered widely among the packets per flow.
  prefs: []
  type: TYPE_NORMAL
- en: Octets in Each Flow
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The next section of the summary-detail report tells you how many octets are
    in each flow.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: As you can see at ❷, none of the flows in this file contains only 32 octets
    (shown at ❶). (Remember, even a ping packet is usually 64 bytes.) The most common
    size for a flow is 513 to 1280 octets, with 0.208 representing roughly 20 percent
    of the flows. Although large flows are rare, you can see at ❸ that 0.043, or about
    4 percent of the flows, are larger than 15,872 octets (as shown at ❹).
  prefs: []
  type: TYPE_NORMAL
- en: Flow Time Distribution
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The last part of the summary-detail report, flow time distribution, tells you
    how long flows last in milliseconds.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'As you can see at ❶, 0.158, or roughly 16 percent of the flows, lasted 10 milliseconds
    or less (as shown at ❷). A look at the data shows that this is the most common
    flow duration. As a general rule on this network, short flows are more common
    than longer ones: The long-running flows at the end (shown at ❸) stand out.'
  prefs: []
  type: TYPE_NORMAL
- en: HOW DO YOU USE THE SUMMARY-DETAIL REPORT?
  prefs: []
  type: TYPE_NORMAL
- en: If you get complaints that your network is behaving oddly, compare today's packets
    with last week's or last year's to quickly see anomalies. If you see that your
    traffic has changed in size, duration, or quantity during a network problem, you
    know something has changed. Filter on these characteristics to identify the host
    or connection that's changed.
  prefs: []
  type: TYPE_NORMAL
- en: Modifying the Default Report
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Much like with `flow-nfilter`, you can modify `flow-report`''s behavior from
    the command line. The program supports five variables: `TYPE`, `SORT`, `FIELDS`,
    `OPTIONS`, and `RPTOPT`. I''ll cover each with an example later in this chapter.
    For now, here''s a brief look at each variable:'
  prefs: []
  type: TYPE_NORMAL
- en: '`TYPE` tells `flow-report` which report to run. `flow-report` supports more
    than 70 report types. Much of this chapter is a discussion of the reports I find
    most useful. The `flow-report` manual page contains a complete list.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`SORT` controls the data display order. You can sort most reports by any field
    in the report.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`FIELDS` lets you adjust the fields that appear in a report.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`OPTIONS` activates or deactivates various report-wide features.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`RPTOPT` gives options to pass to the report formatting program, `flow-rptfmt`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'To set a variables, use `-v` and the variable name. For example, to set the
    `TYPE` variable, use the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]*`yourtype`*``'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=ip-source-address`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[''/usr/local/bin/flow-rptfmt'', ''-f'', ''ascii'']'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ip-source-address flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.37        12163 107898108 204514  159749392
  prefs: []
  type: TYPE_NORMAL
- en: 158.43.128.72     16389 1962766   16711   49357139
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.4         54280 127877204 785592  831419980
  prefs: []
  type: TYPE_NORMAL
- en: 198.6.1.1         7627  970898    7992    26371278
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'fields:               +key,+flows,+octets,+packets,+duration,+other'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: ip-source-address flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.4         54280 127877204 785592  831419980
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=ip-source-address -v SORT=+flows`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '#  [''/usr/local/bin/flow-rptfmt'', ''-f'', ''ascii'']'
  prefs: []
  type: TYPE_NORMAL
- en: ip-source-address flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: ❶ 192.0.2.4         54280 127877204 785592  831419980
  prefs: []
  type: TYPE_NORMAL
- en: 158.43.128.72     16389 1962766   16711   49357139
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.37        12163 107898108 204514  159749392
  prefs: []
  type: TYPE_NORMAL
- en: 198.6.1.5         8826  1425518   11339   24124445
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.36        8786  21773315  38616   44443605
  prefs: []
  type: TYPE_NORMAL
- en: 198.6.1.1         7627  970898    7992    26371278
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=ip-source-address -v SORT=+octets`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[''/usr/local/bin/flow-rptfmt'', ''-f'', ''ascii'']'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ip-source-address flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: 207.46.209.247    25    131391013 90275   2967322
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.4         54280 127877204 785592  831419980
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.37        12163 107898108 204514  159749392
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.7         116   72083511  55415   15057488
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.130       145   49604492  74852   36232749
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.8         88    48766466  36166   7181558
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-nfilter -F ip-src-addr -v ADDR=207.46.209.247 | flow-print`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: srcIP            dstIP            prot  srcPort  dstPort  octets      packets
  prefs: []
  type: TYPE_NORMAL
- en: 207.46.209.247   192.0.2.4     ❶ 6  ❷ 80       51538    16499752    11018
  prefs: []
  type: TYPE_NORMAL
- en: 207.46.209.247   192.0.2.4        6     80       51540    16104523    10756
  prefs: []
  type: TYPE_NORMAL
- en: 207.46.209.247   192.0.2.4        6     80       53410    20798       17
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-nfilter -F ip-dst-addr -v ADDR=207.46.209.247 | flow-print
    -f 5`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Start             End               SrcIPaddress  SrcP  DstIPaddress    DstP
  prefs: []
  type: TYPE_NORMAL
- en: ❶   1201.11:58:00.409 1201.12:01:55.917 192.0.2.4   51538 207.46.209.247  80
  prefs: []
  type: TYPE_NORMAL
- en: ❷   1201.11:58:00.451 1201.12:02:05.769 192.0.2.4   51540 207.46.209.247  80
  prefs: []
  type: TYPE_NORMAL
- en: ❸   1201.12:03:00.506 1201.12:04:10.916 192.0.2.4   53410 207.46.209.247  80
  prefs: []
  type: TYPE_NORMAL
- en: 1201.12:03:00.505 1201.12:04:16.805 192.0.2.4   53409 207.46.209.247  80
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: ❹   1201.12:08:00.457 1201.12:09:25.912 192.0.2.4   55190 207.46.209.247  80
  prefs: []
  type: TYPE_NORMAL
- en: 1201.12:08:00.457 1201.12:09:26.775 192.0.2.4   55191 207.46.209.247  80
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: ❺   1201.12:13:00.519 1201.12:14:11.891 192.0.2.4   57581 207.46.209.247  80
  prefs: []
  type: TYPE_NORMAL
- en: 1201.12:13:00.520 1201.12:16:30.907 192.0.2.4   57580 207.46.209.247  80
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=ip-source-address`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`-v SORT=+octets -v FIELDS=-duration`'
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: ip-source-address flows octets    packets
  prefs: []
  type: TYPE_NORMAL
- en: 207.46.209.247    25    131391013 90275
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.4        54280 127877204 785592
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.37       12163 107898108 204514
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`ip-source-address -v SORT=+octets -v FIELDS=-duration,-packets,-flows`'
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: ip-source-address octets
  prefs: []
  type: TYPE_NORMAL
- en: 207.46.209.247    131391013
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.4         127877204
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.37        107898108
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: 'options:              +percent-total,+header'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=ip-source-address -v SORT=+octets -v`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ❶ `OPTIONS=-header`
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=ip-source`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`-address -v SORT=+octets -v OPTIONS=+percent-total,+header,+xheader,+totals`'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=ip-source-address -v RPTOPT=-fhtml`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=ip-address -v SORT=+octets`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ip-address      flows  octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.4       107785 995021734 1656178 1659809423
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.37      24294  347444011 456952  322712670
  prefs: []
  type: TYPE_NORMAL
- en: 207.46.209.247  50     134705214 151227  5934644
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=ip-destination-address`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ip-destination-address flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: 158.43.128.72          16478 1090268   16816   49357139
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.37             12131 239545903 252438  162963278
  prefs: []
  type: TYPE_NORMAL
- en: 198.6.1.1              7630  588990    7997    26371278
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=ip-source-address-destination-count`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ip-source-address ip-destination-address-count flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: ❶ 192.0.2.37      ❷ 1298                         12163 107898108 204514  159749392
  prefs: []
  type: TYPE_NORMAL
- en: 158.43.128.72     5                            16389 1962766   16711   49357139
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.4         2016                         54280 127877204 785592  831419980
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE23]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=ip-destination-address-source-count`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ip-destination-address ip-source-address-count flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: 158.43.128.72          5                       16478 1090268   16816   49357139
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.37            1303                     12131 239545903 252438  162963278
  prefs: []
  type: TYPE_NORMAL
- en: 198.6.1.1              2                       7630  588990    7997    26371278
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE24]'
  prefs: []
  type: TYPE_PRE
- en: flow-cat | flow-report | sort -rnk 2
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE25]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=ip-port -v SORT=+octets`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ip-port flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: ❶   80 ❹ 63344 877141857 1298560 1444603541
  prefs: []
  type: TYPE_NORMAL
- en: ❷   25    8903  361725472 475912  139074162
  prefs: []
  type: TYPE_NORMAL
- en: ❸   443   10379 136012764 346935  324609472
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE26]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=ip-source-port -v SORT=-key`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ip-source-port flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: ❶ 0            215   4053775   23056   21289759
  prefs: []
  type: TYPE_NORMAL
- en: 22             111   1281556   15044   4816416
  prefs: []
  type: TYPE_NORMAL
- en: 25             4437  10489387  181655  69456345
  prefs: []
  type: TYPE_NORMAL
- en: 49             19    3922      79      5135
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE27]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=ip-destination-port -v SORT=-key`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ip-destination-port flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: 0                   91    3993212   22259   14707048
  prefs: []
  type: TYPE_NORMAL
- en: 22                  231   26563846  22155   5421745
  prefs: []
  type: TYPE_NORMAL
- en: 25                  4466  351236085 294257  69617817
  prefs: []
  type: TYPE_NORMAL
- en: 49                  19    6785      101     5135
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE28]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=ip-source/destination-port -v SORT=+octets`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ip-source-port ip-destination-port flows octets   packets duration
  prefs: []
  type: TYPE_NORMAL
- en: ❶ 80             15193               3     62721604 43920   620243
  prefs: []
  type: TYPE_NORMAL
- en: ❷ 4500           4500                115   57272960 101806  30176444
  prefs: []
  type: TYPE_NORMAL
- en: ❸ 14592          25                  2     28556024 19054   480319
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE29]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=ip-protocol -v OPTIONS=+names`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ip-protocol flows octets     packets duration
  prefs: []
  type: TYPE_NORMAL
- en: icmp        158   75123      965     6719987
  prefs: []
  type: TYPE_NORMAL
- en: tcp         83639 1516003823 2298691 1989109659
  prefs: []
  type: TYPE_NORMAL
- en: udp         76554 69321656   217741  296940177
  prefs: []
  type: TYPE_NORMAL
- en: esp         34    3820688    18720   8880078
  prefs: []
  type: TYPE_NORMAL
- en: vrrp        12    151708     3298    3491379
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE30]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=packet-size -v SORT=+key`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: packet size/flow flows octets   packets duration
  prefs: []
  type: TYPE_NORMAL
- en: 1500           ❶ 5   ❷ 2776500 ❸1851   1406780
  prefs: []
  type: TYPE_NORMAL
- en: 1499             2     14717980 9816    390603
  prefs: []
  type: TYPE_NORMAL
- en: 1498             5     60253559 40207   999167
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE31]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=octets -v SORT=-key`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: octets/flow flows octets   packets duration
  prefs: []
  type: TYPE_NORMAL
- en: 46        ❶ 367  ❷16882    367     1214778
  prefs: []
  type: TYPE_NORMAL
- en: 48        ❸ 59    2832   ❹ 59      272782
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: 168       ❺ 496   83328  ❻ 1311    5819361
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE32]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=packets -v SORT=-key`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: packets/flow flows octets   packets duration
  prefs: []
  type: TYPE_NORMAL
- en: 1          ❶ 74213 6978064  74213   19224735
  prefs: []
  type: TYPE_NORMAL
- en: 2            3411  551388   6822    190544194
  prefs: []
  type: TYPE_NORMAL
- en: 3            4764  2033952  14292   37130046
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE33]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=pps -v SORT=+key`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: pps/flow flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: ❶ 3000   1     231      ❷ 3    ❸ 1
  prefs: []
  type: TYPE_NORMAL
- en: 1000     70    4192      70      70
  prefs: []
  type: TYPE_NORMAL
- en: 833      1     403       5       6
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE34]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=linear-interpolated-flows-octets-packets`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: unix-secs  flows      octets        packets
  prefs: []
  type: TYPE_NORMAL
- en: 1334981479 35.605553  35334.016293  96.820015
  prefs: []
  type: TYPE_NORMAL
- en: 1334981480 63.780553  62865.828793  184.570015
  prefs: []
  type: TYPE_NORMAL
- en: 1334981481 38.702116  69297.703533  192.235604
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE35]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-nfilter -F router1-exports | flow-report -v TYPE=input-interface`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: input-interface flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: 1               22976 136933632 306843  58766984
  prefs: []
  type: TYPE_NORMAL
- en: 2               320   182048    1307    3214392
  prefs: []
  type: TYPE_NORMAL
- en: 7               4934  59690118  165408  46161632
  prefs: []
  type: TYPE_NORMAL
- en: 8               1316  7386629   11142   7592624
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE36]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-nfilter -F router1-exports | flow-report -v TYPE=output-interface`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: output-interface flows octets   packets duration
  prefs: []
  type: TYPE_NORMAL
- en: ❶ 0                1765  447958   5043    3599588
  prefs: []
  type: TYPE_NORMAL
- en: 1                5057  66979701 175073  52900988
  prefs: []
  type: TYPE_NORMAL
- en: 2                17545 20507633 56531   9440036
  prefs: []
  type: TYPE_NORMAL
- en: 7                111   43079633 34710   8266712
  prefs: []
  type: TYPE_NORMAL
- en: 8                5068  73177502 213343  41528308
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE37]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-nfilter -F router1-exports`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`| flow-report -v TYPE=input/output-interface -v SORT=+flows`'
  prefs: []
  type: TYPE_NORMAL
- en: input-interface output-interface flows octets   packets duration
  prefs: []
  type: TYPE_NORMAL
- en: ❶ 1            ❷  2                17539 20507195 56522   9438220
  prefs: []
  type: TYPE_NORMAL
- en: ❸ 1               8                4801  73147574 212806  41001424
  prefs: []
  type: TYPE_NORMAL
- en: 7               1                3888  59604956 164102  45390152
  prefs: []
  type: TYPE_NORMAL
- en: 8               1                1169  7374745  10971   7510836
  prefs: []
  type: TYPE_NORMAL
- en: 7               0                1040  84724    1297    769664
  prefs: []
  type: TYPE_NORMAL
- en: 1               0                525   199230   2805    60628
  prefs: []
  type: TYPE_NORMAL
- en: 2               8                267   29928    537     526884
  prefs: []
  type: TYPE_NORMAL
- en: 8               0                147   11884    171     81788
  prefs: []
  type: TYPE_NORMAL
- en: 1               7                111  ❹43079633 34710   8266712
  prefs: []
  type: TYPE_NORMAL
- en: 2               0                53    152120   770     2687508
  prefs: []
  type: TYPE_NORMAL
- en: 7               2                6     438      9       1816
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE38]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=ip-next-hop-address | -v SORT=+octets`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ip-next-hop-address flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: ❶ 192.0.2.4           2490  154742050 174836  31131852
  prefs: []
  type: TYPE_NORMAL
- en: ❷ 95.116.11.45        5068  73177502  213343  41528308
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.37          5944  65552868  73357   13692932
  prefs: []
  type: TYPE_NORMAL
- en: ❸ 12.119.119.161      111   43079633  34710   8266712
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.13          2370  21382159  21595   4996548
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.194         17545 20507633  56531   9440036
  prefs: []
  type: TYPE_NORMAL
- en: ❹ 66.125.104.149      17534 20506982  56521   9447180
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE39]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-nfilter -F router1-exports`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`| flow-nfilter -F ip-addr -v ADDR=192.0.2.4 | flow-report -v`'
  prefs: []
  type: TYPE_NORMAL
- en: '`TYPE=ip-source-address/output-interface`'
  prefs: []
  type: TYPE_NORMAL
- en: ip-source-address output-interface flows octets  packets duration
  prefs: []
  type: TYPE_NORMAL
- en: ❶ 192.0.2.4       2                3553  422428  5849    1881348
  prefs: []
  type: TYPE_NORMAL
- en: ❷ 192.0.2.4       8                324   3826147 69225   2851980
  prefs: []
  type: TYPE_NORMAL
- en: ❸ 198.22.63.8     1                137   56475   762     915472
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: ❹ 192.0.2.4       7                2     124     2       0
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE40]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-nfilter -F router1-exports`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`| flow-nfilter -F interface7 | flow-report -v TYPE=ip-dest`'
  prefs: []
  type: TYPE_NORMAL
- en: '`ination-address/input-interface -v SORT=+octets`'
  prefs: []
  type: TYPE_NORMAL
- en: ip-source-address input-interface flows octets   packets duration
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.7         7                2     27347244 22122   3601016
  prefs: []
  type: TYPE_NORMAL
- en: 69.147.97.45      1                2     19246168 12853   232400
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.8         7                2     15442834 11779   3600988
  prefs: []
  type: TYPE_NORMAL
- en: 76.122.146.90     1                2     14113638 56214   3601884
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE41]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -v TYPE=ip-exporter-address`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ip-exporter-address flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.3          29546 204192427 484700  115735632
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.12         36750 202920788 231118  39230288
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE42]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-nfilter -F router1-exports`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`| flow-report -v TYPE=source-as -v SORT=+octets`'
  prefs: []
  type: TYPE_NORMAL
- en: source-as flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: ❶ 0         23024 137077373 307572  61361020
  prefs: []
  type: TYPE_NORMAL
- en: ❷ 14779     2     19246168  12853   232400
  prefs: []
  type: TYPE_NORMAL
- en: 33668     136   15664027  64345   14486504
  prefs: []
  type: TYPE_NORMAL
- en: 21502     2     5087464   3450    47692
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE43]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-nfilter -F router1-exports`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`| flow-report -v TYPE=destination-as -v SORT=+flows`'
  prefs: []
  type: TYPE_NORMAL
- en: destination-as flows octets   packets duration
  prefs: []
  type: TYPE_NORMAL
- en: ❶ 702            11834 767610   11869   23248
  prefs: []
  type: TYPE_NORMAL
- en: ❷ 0              6828  67428097 180125  56502392
  prefs: []
  type: TYPE_NORMAL
- en: ❸ 701            4154  459973   6372    1893152
  prefs: []
  type: TYPE_NORMAL
- en: 3209           397   553003   9751    1220164
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE44]'
  prefs: []
  type: TYPE_PRE
- en: '`cat asn.txt | perl /usr/local/share/flow-tools/gasn > newasn.sym`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[PRE45]'
  prefs: []
  type: TYPE_PRE
- en: 0 IANA-RSVD-0
  prefs: []
  type: TYPE_NORMAL
- en: 1 LVLT-1
  prefs: []
  type: TYPE_NORMAL
- en: 2 DCN-AS
  prefs: []
  type: TYPE_NORMAL
- en: 3 MIT-GATEWAYS
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE46]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-nfilter -F router1-exports`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`| flow-report -v TYPE=source-as -v SORT=+octets -v OPTIONS=+names`'
  prefs: []
  type: TYPE_NORMAL
- en: source-as                     flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: IANA-RSVD-0                   23024 137077373 307572  61361020
  prefs: []
  type: TYPE_NORMAL
- en: INKTOMI-LAWSON                2     19246168  12853   232400
  prefs: []
  type: TYPE_NORMAL
- en: MICROSOFT-CORP---MSN-AS-BLOCK 64    4669359   3259    106792
  prefs: []
  type: TYPE_NORMAL
- en: GOOGLE                        130   4052114   3184    616152
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE47]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -S resets-only`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[PRE48]'
  prefs: []
  type: TYPE_PRE
- en: ❶ stat-report packets
  prefs: []
  type: TYPE_NORMAL
- en: ❷     type linear-interpolated-flows-octets-packets
  prefs: []
  type: TYPE_NORMAL
- en: ❸     output
  prefs: []
  type: TYPE_NORMAL
- en: ❹ stat-definition resets-only
  prefs: []
  type: TYPE_NORMAL
- en: report packets
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE49]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -S resets-only`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'recn: unix-secs*,flows,octets,packets'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 1228150499,35.605553,35334.016293,96.820015
  prefs: []
  type: TYPE_NORMAL
- en: 1228150500,63.780553,62865.828793,184.570015
  prefs: []
  type: TYPE_NORMAL
- en: 1228150501,38.702116,69297.703533,192.235604
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE50]'
  prefs: []
  type: TYPE_PRE
- en: stat-report packets
  prefs: []
  type: TYPE_NORMAL
- en: type linear-interpolated-flows-octets-packets
  prefs: []
  type: TYPE_NORMAL
- en: output
  prefs: []
  type: TYPE_NORMAL
- en: ❶  path |/usr/local/bin/flow-rptfmt
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE51]'
  prefs: []
  type: TYPE_PRE
- en: '[''/usr/local/bin/flow-rptfmt'']'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: unix-secs  flows      octets        packets
  prefs: []
  type: TYPE_NORMAL
- en: 1228150499 35.605553  35334.016293  96.820015
  prefs: []
  type: TYPE_NORMAL
- en: 1228150500 63.780553  62865.828793  184.570015
  prefs: []
  type: TYPE_NORMAL
- en: 1228150501 38.702116  69297.703533  192.235604
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE52]'
  prefs: []
  type: TYPE_PRE
- en: stat-report packets
  prefs: []
  type: TYPE_NORMAL
- en: type linear-interpolated-flows-octets-packets
  prefs: []
  type: TYPE_NORMAL
- en: output
  prefs: []
  type: TYPE_NORMAL
- en: ❶  fields -octets,-flows
  prefs: []
  type: TYPE_NORMAL
- en: path |/usr/local/bin/flow-rptfmt
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE53]'
  prefs: []
  type: TYPE_PRE
- en: '[''/usr/local/bin/flow-rptfmt'']'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: unix-secs  packets
  prefs: []
  type: TYPE_NORMAL
- en: 1228150499 96.820015
  prefs: []
  type: TYPE_NORMAL
- en: 1228150500 184.570015
  prefs: []
  type: TYPE_NORMAL
- en: 1228150501 192.235604
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE54]'
  prefs: []
  type: TYPE_PRE
- en: stat-definition reset-only
  prefs: []
  type: TYPE_NORMAL
- en: filter rst-only
  prefs: []
  type: TYPE_NORMAL
- en: report packets
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE55]'
  prefs: []
  type: TYPE_PRE
- en: unix-secs  packets
  prefs: []
  type: TYPE_NORMAL
- en: 1228150595 0.068702
  prefs: []
  type: TYPE_NORMAL
- en: 1228150596 0.068702
  prefs: []
  type: TYPE_NORMAL
- en: 1228150597 0.068702
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE56]'
  prefs: []
  type: TYPE_PRE
- en: stat-definition reset-only
  prefs: []
  type: TYPE_NORMAL
- en: filter rst-only
  prefs: []
  type: TYPE_NORMAL
- en: report packets
  prefs: []
  type: TYPE_NORMAL
- en: stat-definition syn-only
  prefs: []
  type: TYPE_NORMAL
- en: filter syn-only
  prefs: []
  type: TYPE_NORMAL
- en: report packets
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE57]'
  prefs: []
  type: TYPE_PRE
- en: stat-report subnets
  prefs: []
  type: TYPE_NORMAL
- en: type ip-source/destination-address
  prefs: []
  type: TYPE_NORMAL
- en: ❶  scale 10
  prefs: []
  type: TYPE_NORMAL
- en: output
  prefs: []
  type: TYPE_NORMAL
- en: path |/usr/local/bin/flow-rptfmt
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: stat-definition subnets
  prefs: []
  type: TYPE_NORMAL
- en: report subnets
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE58]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -S subnets`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[''/usr/local/bin/flow-rptfmt'']'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ip-source-address ip-destination-address flows octets     packets duration
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.37        158.43.128.72          8702  5760730    88840   30096122
  prefs: []
  type: TYPE_NORMAL
- en: 158.43.128.72     192.0.2.37             8649  10405130   88280   30096122
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.4         198.6.1.1              7625  5886410    79920   26370707
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE59]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-cat * | flow-report -S subnets-unscaled`'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[''/usr/local/bin/flow-rptfmt'']'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ip-source-address ip-destination-address flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.37        158.43.128.72          8702  576073    8884    30096122
  prefs: []
  type: TYPE_NORMAL
- en: 158.43.128.72     192.0.2.37             8649  1040513   8828    30096122
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.4         198.6.1.1              7625  588641    7992    26370707
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE60]'
  prefs: []
  type: TYPE_PRE
- en: stat-report subnets
  prefs: []
  type: TYPE_NORMAL
- en: type ip-source/destination-address
  prefs: []
  type: TYPE_NORMAL
- en: '`filter` web-traffic'
  prefs: []
  type: TYPE_NORMAL
- en: output
  prefs: []
  type: TYPE_NORMAL
- en: path |/usr/local/bin/flow-rptfmt
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE61]'
  prefs: []
  type: TYPE_PRE
- en: stat-report subnets
  prefs: []
  type: TYPE_NORMAL
- en: type ip-source/destination-address
  prefs: []
  type: TYPE_NORMAL
- en: ❶  ip-source-address-format prefix-len
  prefs: []
  type: TYPE_NORMAL
- en: ❷  ip-destination-address-format prefix-len
  prefs: []
  type: TYPE_NORMAL
- en: output
  prefs: []
  type: TYPE_NORMAL
- en: path |/usr/local/bin/flow-rptfmt
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE62]'
  prefs: []
  type: TYPE_PRE
- en: ip-source-address  ip-destination-address flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: 63.125.104.150/12  87.169.213.77/10       9     1008      18      23760
  prefs: []
  type: TYPE_NORMAL
- en: ❶ 192.0.2.37/25      158.43.128.72/16       8233  537169    8233    4
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2.4/25    ❷ 198.6.1.1/16           6634  485854    6658    168412
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE63]'
  prefs: []
  type: TYPE_PRE
- en: ip-source-address ip-destination-address flows octets    packets duration
  prefs: []
  type: TYPE_NORMAL
- en: ❶ 63.112/12         87.128/10              15    1792      32      58384
  prefs: []
  type: TYPE_NORMAL
- en: ❷ 192.0.2/25        158.43/16              23663 1532256   23707   17372
  prefs: []
  type: TYPE_NORMAL
- en: 192.0.2/25        198.6/16               8299  915307    12698   3711276
  prefs: []
  type: TYPE_NORMAL
- en: '...'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE64]'
  prefs: []
  type: TYPE_PRE
- en: path |/usr/local/bin/flow-rptfmt > /tmp/resets.txt
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE65]'
  prefs: []
  type: TYPE_PRE
- en: path |/usr/local/bin/flow-rptfmt -f html > /var/www/resets/today.html
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE66]'
  prefs: []
  type: TYPE_PRE
- en: path /tmp/reset.csv
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE67]'
  prefs: []
  type: TYPE_PRE
- en: stat-report subnets
  prefs: []
  type: TYPE_NORMAL
- en: type ip-source/destination-address
  prefs: []
  type: TYPE_NORMAL
- en: output
  prefs: []
  type: TYPE_NORMAL
- en: ❶  time end
  prefs: []
  type: TYPE_NORMAL
- en: ❷  path /tmp/%Y/%m/%d/%H/%M-report.csv
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE68]'
  prefs: []
  type: TYPE_PRE
- en: stat-report subnets
  prefs: []
  type: TYPE_NORMAL
- en: type ip-source/destination-address
  prefs: []
  type: TYPE_NORMAL
- en: output
  prefs: []
  type: TYPE_NORMAL
- en: time mid
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: path |flow-rptfmt -f html > /var/www/reports/report-%Y-%m-%d-%H-report.html
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE69]'
  prefs: []
  type: TYPE_PRE
- en: stat-report subnets
  prefs: []
  type: TYPE_NORMAL
- en: type ip-source/destination-address
  prefs: []
  type: TYPE_NORMAL
- en: ip-source-address-format prefix-len
  prefs: []
  type: TYPE_NORMAL
- en: ip-destination-address-format prefix-len
  prefs: []
  type: TYPE_NORMAL
- en: output
  prefs: []
  type: TYPE_NORMAL
- en: '`sort +octets`'
  prefs: []
  type: TYPE_NORMAL
- en: path |flow-rptfmt
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE70]'
  prefs: []
  type: TYPE_PRE
- en: output
  prefs: []
  type: TYPE_NORMAL
- en: '`records 5`'
  prefs: []
  type: TYPE_NORMAL
- en: sort +octets
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: path |flow-rptfmt
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE71]'
  prefs: []
  type: TYPE_PRE
- en: output
  prefs: []
  type: TYPE_NORMAL
- en: '`options +header`'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: path |flow-rptfmt
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE72]'
  prefs: []
  type: TYPE_PRE
- en: '`flow-report -s` ``*`test-stat.cfg`*`` `-S` ``*`newreport`*``'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '```'
  prefs: []
  type: TYPE_NORMAL
- en: Create, edit, and remove reports on a copy of the configuration file. When your
    changes are working the way you want, just copy your new configuration over the
    old one. Users won't notice unless you change a report that they're using.
  prefs: []
  type: TYPE_NORMAL
- en: Now that you can report on your traffic any way you like, you'll create graphical
    reports and even write your own flow analysis software in [Chapter 6](ch06.html
    "Chapter 6. PERL, FLOWSCAN, AND CFLOW.PM").
  prefs: []
  type: TYPE_NORMAL
