- en: Chapter 5. HANDLE MAP EVENTS
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '![image with no caption](httpatomoreillycomsourcenostarchimages671943.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Web-based maps are highly interactive. They make users want to drag them, click
    them, and zoom them. That's all part of the fun, but this interactivity also makes
    them more useful. By tapping into this interactivity, you can design those little
    user movements to provide an even better interface; for instance, changing the
    visible markers when users drag the map or changing the search radius along with
    the zoom level.
  prefs: []
  type: TYPE_NORMAL
- en: Events control all the potential ways a user can interact with your map. You
    can run special code any time a user drags the map, zooms in, or clicks. Events
    are also specific to markers, message boxes, and polylines. Read on for a quick
    introduction to the way Mapstraction organizes events and for examples of each.
  prefs: []
  type: TYPE_NORMAL
- en: Mapstraction's Event Model
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Events happen, regardless of whether we're paying attention. To be able to react
    to an event, we need to tell Mapstraction that we care about that particular event.
    We do this by setting a function for Mapstraction to call when an event happens.
    This function is called a *handler*.
  prefs: []
  type: TYPE_NORMAL
- en: 'To create an event handler, we need to know the event type we''re looking for
    and the object from which the event will be originating. We register our interest
    in the event using the following form:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: The potential events that can occur for each object are shown in [Table 5-1](ch05.html#objects_and_their_events
    "Table 5-1. Objects and Their Events"). The `addHandler` function accepts one
    argument—a reference to a function that will handle the event. In the case of
    the previous example, and most examples in this chapter, I'm using an anonymous,
    inline function. You can also use named functions, as I do in most examples that
    involve markers. If you are going to call the same function on many objects, you'll
    find it more memory efficient to use a named function.
  prefs: []
  type: TYPE_NORMAL
- en: 'Whether you use an anonymous or named function to handle events, however, the
    function accepts three arguments: an event name, an event source, and additional
    event arguments. Those values are passed automatically by Mapstraction. The name
    will always be the same as *event*, whereas the source will always be the *object*.
    Additional data, if it exists, is included in the arguments object.'
  prefs: []
  type: TYPE_NORMAL
- en: Table 5-1. Objects and Their Events
  prefs: []
  type: TYPE_NORMAL
- en: '| Object | Event |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| `Mapstraction` | `click` |'
  prefs: []
  type: TYPE_TB
- en: '| `Mapstraction` | `endPan` |'
  prefs: []
  type: TYPE_TB
- en: '| `Mapstraction` | `changeZoom` |'
  prefs: []
  type: TYPE_TB
- en: '| `Mapstraction` | `markerAdded` |'
  prefs: []
  type: TYPE_TB
- en: '| `Mapstraction` | `markerRemoved` |'
  prefs: []
  type: TYPE_TB
- en: '| `Mapstraction` | `polylineAdded` |'
  prefs: []
  type: TYPE_TB
- en: '| `Mapstraction` | `polylineRemoved` |'
  prefs: []
  type: TYPE_TB
- en: '| `Marker` | `click` |'
  prefs: []
  type: TYPE_TB
- en: '| `Marker` | `openInfoBubble` |'
  prefs: []
  type: TYPE_TB
- en: Each event is covered in depth in the sections of this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: '#27: The User Clicks the Map'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Out-of-the-box interactivity makes mapping APIs pretty special. Using built-in
    controls, users can drag and pan a map, zoom in, and change map types. Users can
    also click, but nothing will happen unless you help them out.
  prefs: []
  type: TYPE_NORMAL
- en: Mapstraction's click event is what reacts to a user's click. Unlike some other
    events shown in this chapter, knowing that your users clicked is not enough. You
    need to know *where* they clicked.
  prefs: []
  type: TYPE_NORMAL
- en: 'To find out when and where a user clicks, add the following code to your `create_map`
    function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Here, we add a handler for Mapstraction's `click` event. To react to this event,
    I've used an anonymous inline function. If you have more than a couple lines of
    code to run, you'll want to use a standard named function, because long anonymous
    functions are hard to read. I'm pushing the limits here.
  prefs: []
  type: TYPE_NORMAL
- en: 'When the user clicks anywhere within the map, Mapstraction calls our function
    with three pieces of data, the last of which contains the event arguments. The
    key piece of information we want is inside those arguments: the click location,
    which is stored as a `LatLonPoint`. The previous example uses that point to create
    a new marker.'
  prefs: []
  type: TYPE_NORMAL
- en: Each click adds another marker to the map. Do this a few times and your map
    will look something like [Figure 5-1](ch05s03.html#each_click_adds_a_new_marker
    "Figure 5-1. Each click adds a new marker.").
  prefs: []
  type: TYPE_NORMAL
- en: '#28: The User Drags the Map'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: If you're a developer who likes to be in control, you may not immediately appreciate
    the interactivity of maps. Users can move the viewable portion of a map to wherever
    they want, forgoing your perfectly designed experience. What a drag! In fact,
    literally a drag, as the user drags the map this way and that. You can use an
    event, however, to help you gain back a little of that control.
  prefs: []
  type: TYPE_NORMAL
- en: You can write code to react to a even the smallest movement of the map. You
    can use this to force the map back to where you put it, if that's what you prefer.
    A more friendly reaction is to find a way to recognize the area of the map where
    the user moved. For example, if you are showing search results, try reloading
    them with the new center.
  prefs: []
  type: TYPE_NORMAL
- en: '![Each click adds a new marker.](httpatomoreillycomsourcenostarchimages672037.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5-1. Each click adds a new marker.
  prefs: []
  type: TYPE_NORMAL
- en: 'For this example, we''ll merely create a JavaScript alert whenever we notice
    the map has moved. And how do we know when a map has moved? Add these lines to
    your basic map:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Here, we add a handler for Mapstraction's `endPan` event. To react to this event,
    I've used an anonymous inline function. If you have more than a couple lines of
    code to run, you'll want to use a standard named function.
  prefs: []
  type: TYPE_NORMAL
- en: With this code implemented, any time the user moves the map, this event will
    fire, and the alert box will pop up. Programmatically setting the center will
    also trigger the event because the map has been panned (just not directly by the
    user). The event does not fire when you initially set the center of the map, however,
    only because that code comes before Mapstraction knows to look out for map movement.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: With some providers, such as Google, the `endPan` event will also be triggered
    when the zoom level changes.
  prefs: []
  type: TYPE_NORMAL
- en: 'As soon as the `endPan` event fires, you''ll have access to the current map
    data, such as the center, via the Mapstraction object. Here''s an example that
    creates a new marker at the new center whenever the user drags the map:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Enter this into your basic map's `create_map` function, and load it into a browser.
    Try moving the map and each time you'll find a brand new marker at its center.
  prefs: []
  type: TYPE_NORMAL
- en: '#29: The Zoom Level Changes'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '"Let''s take a closer look," she thinks, clicking the plus-sign button to zoom
    closer into the map. Assuming you provide the interface to do so, your users will
    be doing a lot of zooming in and zooming out. In some maps, reacting to those
    sometimes drastic changes in the map''s bounds is important, which is where Mapstraction''s
    zoom event can be your best friend.'
  prefs: []
  type: TYPE_NORMAL
- en: You can make your map handle the zoom event and do something useful, such as
    reset your search radius. Or, as shown later in this chapter, determine whether
    the user moves the map outside preset bounds.
  prefs: []
  type: TYPE_NORMAL
- en: 'For this example, we''ll create a JavaScript alert whenever the map is zoomed,
    so you can get a feeling for when this event is triggered. Add the following code
    to your basic map''s `create_map` function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: Here, we add a handler for Mapstraction's `changeZoom` event. To react to this
    event, I've used an anonymous inline function. If you have more than a couple
    lines of code to run, you'll want to use a standard named function.
  prefs: []
  type: TYPE_NORMAL
- en: Try loading your map with this code included. Change the zoom on your map a
    few times, and watch it respond. If your provider interprets a double-click as
    a zoom in (and most do), try that, too. Your users won't be able to zoom in or
    out without you knowing about it!
  prefs: []
  type: TYPE_NORMAL
- en: 'Do you want to respond with something a little more useful? How about an alert
    displaying the new zoom level? Try the following code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: Now, each time your users zoom in or out, a message doesn't just say that the
    zoom level changed; it also shows the new zoom level. If your map has large zoom
    controls, try zooming in quickly from your current level to one very close in
    or try zooming extremely far out. An alert will pop up with the new zoom level
    number. If you'd like to make more sense of zoom levels, see [Set Zoom Level](ch01s07.html
    "Set Zoom Level") in [Set Zoom Level](ch01s07.html "Set Zoom Level").
  prefs: []
  type: TYPE_NORMAL
- en: '#30: A Marker Is Added to or Removed from the Map'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Markers, markers everywhere. Once your mapping application becomes large, you
    might be adding markers from many different areas of your code. The same could
    be true of removing markers. You can take advantage of two events that will call
    a function you specify when a marker is added or removed.
  prefs: []
  type: TYPE_NORMAL
- en: 'Add the following code to your basic map''s `create_map` function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: Of course, using a JavaScript alert to let the user know a marker has been added
    or removed is probably not that helpful. Instead, you might update your own metadata
    on markers or autocenter the map based on the new or remaining markers.
  prefs: []
  type: TYPE_NORMAL
- en: You can access the affected marker via the `event_args` object, which contains
    one property called `marker`. You may find it more intuitive to access the marker
    from the `event_source` object. Though these events are related to markers, they
    are initiated by the Mapstraction object, which is passed as the source.
  prefs: []
  type: TYPE_NORMAL
- en: Because the only way to add or remove markers is through your code, plenty of
    other non-event-based ways available to perform an action when a marker is added
    or removed. As mentioned, you might only find this useful if you have a large
    application.
  prefs: []
  type: TYPE_NORMAL
- en: '#31: A Polyline Is Added to or Removed from the Map'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Do you use lots of polylines on your maps? You can use an event to run a special
    function every time you add or remove a polyline. This feature is especially useful
    for large mapping applications, where many different places create new lines or
    when you need to nix unnecessary ones.
  prefs: []
  type: TYPE_NORMAL
- en: 'To create functions for the two Polyline events, add the following code to
    your `create_map` function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: I have created a JavaScript alert to show the first point of the polyline that
    has been added or removed. You'll want to include something more useful than JavaScript
    alerts, which users would see as overkill in most situations. You might choose
    to autocenter the map based on the new or removed polyline, for example.
  prefs: []
  type: TYPE_NORMAL
- en: You can access the affected polyline via the `event_args` object, which contains
    one property called `polyline`. You may find it more intuitive to access the polyline
    from the `event_source` object. Though these events are related to polylines,
    they are initiated by the Mapstraction object, which is passed as the source.
  prefs: []
  type: TYPE_NORMAL
- en: Like adding and removing markers, your code is the only way to add new polylines
    to (or remove unwanted ones from) the map. Due to this fact, other methods are
    available for running code in these events. For large applications, however, you
    may prefer this event-based approach.
  prefs: []
  type: TYPE_NORMAL
- en: '#32: The User Opens or Closes a Message Box'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Your map's markers can only do so much to communicate a location's meaning.
    The rest happens in a message box, which users can open by clicking a marker.
    If you want to react when a message box is opened or closed, you'll need to write
    event handlers for each marker.
  prefs: []
  type: TYPE_NORMAL
- en: A common use case is to update a section of the website outside the map when
    a message box is opened. For example, perhaps you want to highlight the result
    related to that marker in search results. Or you may want to hide each marker
    once its message box has been viewed. Here, we'll stick with our method of showing
    a JavaScript alert.
  prefs: []
  type: TYPE_NORMAL
- en: 'Add the following code to your basic map''s `create_map` function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'And include this function within the JavaScript section, but outside of other
    functions:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'Here, I''ve created a simple marker in the center of the map with a message
    box, similar to what we created in [#3: Show a Message Box When Your Marker Is
    Clicked](ch02s03.html "#3: Show a Message Box When Your Marker Is Clicked") in
    [#3: Show a Message Box When Your Marker Is Clicked](ch02s03.html "#3: Show a
    Message Box When Your Marker Is Clicked"). The events for opening and closing
    message boxes are shown in bold. For this particular marker, we''re waiting to
    react to either of these events.'
  prefs: []
  type: TYPE_NORMAL
- en: When the event fires, we call the named functions, either `myboxopened` or `myboxclosed`.
    You can name these functions anything you want. When the appropriate function
    is called, the marker is passed to the `event_source` variable ❶. At this point,
    we have access to any of this marker's attributes, including the location ❷. We
    can do anything with this marker that we can do with any other marker, including
    hide it, removing it, or setting new attributes (perhaps tracking which message
    boxes have been opened?).
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Unlike some of the previous examples, we add handlers for these events to the
    marker object, not the Mapstraction object. If you want to run similar code for
    every marker, you need to add an event to each marker.
  prefs: []
  type: TYPE_NORMAL
- en: As you can see from comparing the code for the two events, reacting to a closed
    message box uses almost identical code. You can see a more advanced example of
    the `closeInfoBubble` event later in this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: '#33: The User Clicks a Marker'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Your users see all those markers on the map and many will want to click them
    to learn more about a particular location. That's what the message box is for,
    right? Well, you may want to do a little more. In those cases, you'll need a way
    to tell when a marker has been clicked. As you might have guessed, Mapstraction
    has an event for just this occasion.
  prefs: []
  type: TYPE_NORMAL
- en: The marker click event, like the other marker events, is attached to the marker
    itself. So, if you want to perform the same action for every marker, you'll need
    to add a handler individually.
  prefs: []
  type: TYPE_NORMAL
- en: 'For this example, we''ll simply use a single marker and create a JavaScript
    alert to share its location. Add the following code to the `create_map` function
    of your basic map:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: 'And include this function within the JavaScript section but outside of other
    functions:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: When the event fires, the `mymarkerclicked` function is called with three arguments.
    The marker is then passed to the `event_source` variable ❶. At this point, we
    have access to any of this marker's attributes, including the location ❷. We can
    do anything with this marker that we can do with any other marker, but here we've
    just created a JavaScript alert.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: This event is different than Mapstraction's main click event, which fires whenever
    the map is clicked. In this case, the event is attached to a particular marker,
    and your code only runs when that marker is clicked.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here''s the truth: You won''t use this event very often because a message box
    is the best way to show information about a marker. The marker click event is
    a useful tool, however, for the times when you want to do something a bit different.'
  prefs: []
  type: TYPE_NORMAL
- en: '#34: Return to the Center When the Message Box Is Closed'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Have I sung the praises of message boxes enough yet? They help explain what
    your markers represent. They provide additional information about a location yet
    only at the moment the user wants it. They make your maps more informative and
    more interactive. But they can also get in the way, as shown in [Figure 5-2](ch05s09.html#opening_a_message_box_can_move_your_map
    "Figure 5-2. Opening a message box can move your map.").
  prefs: []
  type: TYPE_NORMAL
- en: Depending on your provider, opening a message box can cause your map to pan
    ungracefully, leaving a messy map when the user has closed the message box. A
    little code and the help of an event already covered in this chapter can improve
    the user's experience. Re-enter the `closeInfoBubble` event.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s say you''ve laid out your markers so they fit perfectly within the map,
    as shown in [#8: Determine the Correct Zoom Level to Use Based on Markers](ch02s08.html
    "#8: Determine the Correct Zoom Level to Use Based on Markers") in [#7: Loop Through
    All Markers](ch02s07.html "#7: Loop Through All Markers"). If you make that code
    run again whenever the user closes a message box and after each new marker is
    added, your map will always look organized.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Add this code after creating a marker:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: 'And add the function to handle the event:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: This code assumes a marker named `mk`, but you'll want to change that to match
    whatever variable name you choose for your marker. Also remember that the `closeInfoBubble`
    event is set for a single marker. In order for the event to fire for every marker,
    you need to set it for every marker.
  prefs: []
  type: TYPE_NORMAL
- en: Preserve the Previous Center
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Re-autocentering code might be very useful for most situations because users
    can still see every marker. In some cases, however, you might want to give the
    user a little more control, while still maintaining the benefit of reorganizing
    your map when a message box is closed. Here, you want to remember where the map
    was before the user opened the message box.
  prefs: []
  type: TYPE_NORMAL
- en: 'To achieve this result, you''ll need to use the two message box events in tandem.
    This method is a simple and effective way to preserve the map''s center. Add the
    following code after creating each marker:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: 'And then include these handler functions:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: As with the previous example, I'm assuming a marker named `mk`. Additionally,
    I've added a global variable named `mapcenter` to hold the `LatLonPoint` of the
    map's center.
  prefs: []
  type: TYPE_NORMAL
- en: 'Whenever a message box is opened, the `openInfoBubble` event fires *before*
    the provider moves the map to make room for the message box. This is important:
    Now we have a chance to record the map''s center ❶, which will allow us to reset
    it later.'
  prefs: []
  type: TYPE_NORMAL
- en: When the message box is closed, the `closeInfoBubble` event fires. Instead of
    autocentering, we set the center to the one stored when the message box was opened,
    as shown in [Figure 5-3](ch05s09.html#return_to_the_previous_center_when_the_m
    "Figure 5-3. Return to the previous center when the message box is closed.").
    To be extra kind to the user's eyes, we pan the map ❷ instead of setting the center
    directly.
  prefs: []
  type: TYPE_NORMAL
- en: Now you've used events to subtly improve your users' interactions with your
    maps.
  prefs: []
  type: TYPE_NORMAL
- en: '![Opening a message box can move your map.](httpatomoreillycomsourcenostarchimages672039.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5-2. Opening a message box can move your map.
  prefs: []
  type: TYPE_NORMAL
- en: '![Return to the previous center when the message box is closed.](httpatomoreillycomsourcenostarchimages672041.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5-3. Return to the previous center when the message box is closed.
  prefs: []
  type: TYPE_NORMAL
- en: '#35: The User Moves the Map Outside Preset Bounds'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Drag that map all you want, users. But don't drag it too far or we won't have
    anything else to show you. Providers have mapped the whole earth, but your map
    may only contain data for a particular neighborhood or city. You can use events
    to let you know when the user has moved outside of a predetermined area.
  prefs: []
  type: TYPE_NORMAL
- en: Let's say you're creating a sightseeing map of Yellowstone National Park. You'd
    include Old Faithful geyser and Mammoth Hot Springs because they're both within
    Yellowstone. You wouldn't include the Statue of Liberty because that's thousands
    of miles away. We want to warn users that if they drag the map away from Yellowstone,
    they won't find anything there.
  prefs: []
  type: TYPE_NORMAL
- en: 'To start, let''s get a basic map centered on Yellowstone. Add the following
    code to your JavaScript, replacing any other map code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: First, we make a global variable to hold the `BoundingBox` to describe Yellowstone
    ❶. We'll use these bounds in the next step. Within the `create_map` function,
    you'll see a marker for each of the two sights I mentioned. After that, the map
    is automatically centered to show just those locations. I left two lines to indicate
    where we'll soon be adding additional code. One spot ❷ is for event code, and
    the other ❸ is for functions we'll use to determine whether the map is outside
    of Yellowstone.
  prefs: []
  type: TYPE_NORMAL
- en: Save the code and load it into a browser. Your map should look something like
    [Figure 5-4](ch05s10.html#yellowstone_national_park_with_markers_f "Figure 5-4. Yellowstone
    National Park with markers for two sights"). Try dragging the map to show more
    area to the north. Drag far enough and the map will be in Canada, far away from
    Yellowstone. Let's see what we can do to provide users with a warning.
  prefs: []
  type: TYPE_NORMAL
- en: 'The act of dragging the map is what moves users far from Yellowstone, so we
    need to handle the `endPan` event, as described earlier in this chapter. Add the
    following within the `create_map` function in the section we set aside for event
    code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: '![Yellowstone National Park with markers for two sights](httpatomoreillycomsourcenostarchimages672043.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5-4. Yellowstone National Park with markers for two sights
  prefs: []
  type: TYPE_NORMAL
- en: Here we've created code that runs each time the user finishes dragging the map.
    It uses the global `yellowstone` variable, which is the `BoundingBox` that describes
    Yellowstone. The bounds is only data and not visible on the map. [Figure 5-5](ch05s10.html#bounds_of_yellowstone
    "Figure 5-5. Bounds of Yellowstone") shows the area our bounds cover, however.
    You can see I've made the bounds big enough to include a reasonable buffer around
    Yellowstone. We want users to be able to see what's nearby. We only want to warn
    them when they're obviously off course.
  prefs: []
  type: TYPE_NORMAL
- en: To check if our map is still within our Yellowstone bounds, we need to compare
    the new variable to the map's bounds. To do so, we pass each of these to a function
    called `boundsInBounds`, which we still need to write. If that function returns
    false ❹ (the exclamation point in the code is read as "not"), then we create a
    JavaScript alert to warn the user.
  prefs: []
  type: TYPE_NORMAL
- en: '![Bounds of Yellowstone](httpatomoreillycomsourcenostarchimages672045.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5-5. Bounds of Yellowstone
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s include the new function outside of `create_map`, in the section we
    set aside for function code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: The function accepts two `BoundingBox` variables as arguments. The first is
    the one we *expect* to be smaller, in this case the map's bounds. The second is
    the bounds we're checking, in this case Yellowstone. Because a `BoundingBox` is
    made up of two points (its southwest and northeast corners), we know that one
    `BoundingBox` is inside another only if the larger bounds contains both points.
  prefs: []
  type: TYPE_NORMAL
- en: The event code that we wrote previously will only create an alert if this function
    returns false, meaning the user has dragged the map outside of Yellowstone. Try
    it yourself. Drag the map north. Once you leave Yellowstone, you'll receive a
    warning after each drag of the map, as shown in [Figure 5-6](ch05s10.html#javascript_alert_triggered_when_the_user
    "Figure 5-6. JavaScript alert triggered when the user moves outside of Yellowstone
    bounds").
  prefs: []
  type: TYPE_NORMAL
- en: '![JavaScript alert triggered when the user moves outside of Yellowstone bounds](httpatomoreillycomsourcenostarchimages672047.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5-6. JavaScript alert triggered when the user moves outside of Yellowstone
    bounds
  prefs: []
  type: TYPE_NORMAL
