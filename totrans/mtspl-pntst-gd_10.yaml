- en: Chapter 10. The Social-Engineer Toolkit
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The Social-Engineer Toolkit (SET) was developed to coincide with the release
    of Social-Engineer.org, a set of resources conceived by Chris Hadnagy (loganWHD)
    and written by one of this book’s authors, David Kennedy. The site offers a centralized
    location for social-engineering tutorials and explains terminologies, definitions,
    and scenarios that can help prepare you for hacking the human mind.
  prefs: []
  type: TYPE_NORMAL
- en: The purpose of SET is to fill a gap in the penetration testing community and
    bring awareness to social-engineering attacks. And it has succeeded — SET has
    been downloaded 1 million times and is now an industry standard for deploying
    social-engineering attacks. The toolkit attacks human weaknesses, exploiting curiosity,
    credibility, avarice, and simple human stupidity. Social-engineering attacks are
    at an all-time high and have always been a large risk for many organizations.
  prefs: []
  type: TYPE_NORMAL
- en: Of course, social engineering is nothing new. One person trying to coax another
    to perform acts that he normally wouldn’t do is as old as time itself. Many in
    the security community believe that social engineering is one of the biggest risks
    organizations face, because it’s extremely difficult to protect organizations
    from being attacked in this way. (You might remember the ultrasophisticated Operation
    Aurora attack, for example, in which social-engineering was used to attack Gmail
    and other sources of Google data.)
  prefs: []
  type: TYPE_NORMAL
- en: An *attack vector* is the avenue used to gain information or access to a system.
    SET categorizes attacks by attack vector (such as web, email, and USB-based attacks).
    It uses email, spoofed websites, and other vectors to reach human targets, typically
    tricking individuals into compromising the target or releasing sensitive information.
    Naturally, each vector can have a different success rate depending on its target
    and the communication used. SET also comes prebuilt with email and website templates
    that can be used for social-engineering attacks. SET heavily uses the Metasploit
    Framework.
  prefs: []
  type: TYPE_NORMAL
- en: Because of the social nature of the attacks themselves, each example in this
    chapter is coupled with a brief story.
  prefs: []
  type: TYPE_NORMAL
- en: Configuring the Social-Engineer Toolkit
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: By default, in Back|Track, SET is located in the */pentest/exploits/set/* directory.
    Before you begin, make sure that you are running the latest version of SET.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Next, configure your SET configuration file according to what you’re attempting
    to accomplish. We’ll cover a couple of simple features within the configuration
    file *config/set_config* within the root SET directory.
  prefs: []
  type: TYPE_NORMAL
- en: When using the SET web-based attack vectors, you can turn `ON` the `WEBATTACK_EMAIL`
    flag to perform email phishing in conjunction with the web attack. This flag is
    turned `OFF` by default, which means that you will configure SET and use the web
    attack vector without the support of email phishing.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: One of the web-based attacks available in SET is the *Java applet attack*, which
    uses self-signed Java applets. By default, this attack uses *Microsoft* as the
    publisher name; however, if the Java Development Kit (JDK) has been installed,
    you can turn this option `ON` and sign the applet with whatever name you want.
    When you turn this flag `ON`, additional options will be available through the
    interface.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: The `AUTO_DETECT` setting is one of the most important flags and is turned `ON`
    by default. It tells SET to detect your local IP address automatically and to
    use that as the address for the reverse connection and web servers. If you are
    using multiple interfaces or your reverse payload listener is housed at a different
    location, turn this flag `OFF`. When this option is `OFF`, SET will allow you
    to specify multiple scenarios to ensure that the proper IP address scheme is used,
    for example, in a scenario that includes NAT and port forwarding. These options
    are reflected within the SET interface.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: When you use the toolkit, by default it uses a built-in Python web-based server.
    To optimize performance, set the `APACHE_SERVER` flag to `ON`, and SET will use
    Apache for the attacks.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: Those are the basics of the configuration file. As you can see, you can significantly
    change SET’s behavior depending on which flags are set in the tool. Now let’s
    run the tool.
  prefs: []
  type: TYPE_NORMAL
- en: Spear-Phishing Attack Vector
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The *spear-phishing attack vector* specially crafts file-format exploits (such
    as Adobe PDF exploits) and primarily sends email attacks containing attachments
    to a target, which, when opened, compromise the target’s machine. SET can use
    Simple Mail Transport Protocol (SMTP) open relays (both anonymous and credentialed),
    Gmail, and Sendmail to send email. SET can also use standard email or HTML-based
    email to perform the phishing attack.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s consider a real-world penetration test targeting the company CompanyXYZ.
    You register a domain name similar to Company XYZ, say *coompanyxyz.com*. You
    then register the subdomain *coom.panyXYZ.com*. Next, you send a spear-phishing
    attack to the target organization, knowing that most employees only glance at
    email and will open any attachment that appears to be legitimate. In this case,
    we will send a PDF file format bug to our target, like so.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: From the SET main menu, select `Spear-Phishing Attack Vectors` ![](../images/00002.gif)
    followed by `Perform a Mass Email Attack` ![](../images/00004.gif). This attack
    infects a PDF file using the Adobe `Collab.collectEmailInfo` vulnerability ![](../images/00005.gif),
    a Metasploit Meterpreter reverse payload ![](../images/00006.gif) that is the
    SET default. `Collab.collectEmailInfo` is a heap-based exploit that, if opened
    (and if the target’s version of Adobe Acrobat is vulnerable to this exploit),
    will connect to the attacking workstation on port 443, which usually allows outbound
    traffic from most networks.
  prefs: []
  type: TYPE_NORMAL
- en: You are also given the option of renaming the malicious file to make it more
    enticing for the target to open. The default name (*template.pdf*) is selected
    ![](../images/00007.gif) in this scenario for demonstration purposes.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: Next we email this attack to a single email address ![](../images/00002.gif)
    using the SET predefined email template ![](../images/00004.gif) `Status Report`
    ![](../images/00005.gif). Finally, we enter the email address (**`ihazomgsecurity@secmaniac.com`**)
    ![](../images/00006.gif) to send the malicious file to and have SET use a Gmail
    account ![](../images/00007.gif) to send the message.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, create a Metasploit listener for the payload to connect back to ![](../images/00002.gif).
    When SET launches Metasploit, it configures all the necessary options and starts
    to listen on your attacking IP address on port 443 ![](../images/00004.gif), as
    configured earlier.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: We’ve just set up an attack against [ihazomgsecurity@secmaniac.com](mailto:ihazomgsecurity@secmaniac.com),
    crafted an email to the recipient, and used an Adobe file format exploit. SET
    allowed us to create templates and have them dynamically imported when we use
    the tool. When the target opens the email and double-clicks the Adobe file, he’ll
    see something like [Figure 10-1](part0014.html#the_targetas_view_of_the_infected_pdf_fi).
  prefs: []
  type: TYPE_NORMAL
- en: '![The target’s view of the infected PDF file](../images/00039.jpeg)Figure 10-1. The
    target’s view of the infected PDF file'
  prefs: []
  type: TYPE_NORMAL
- en: 'The target opens the PDF thinking it’s legitimate, and his system is instantly
    compromised. On the attacker’s side, you see the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: This example used a spear-phishing attack to target one user, but SET can also
    be used to attack multiple targets using the “mass email” option. You can also
    create customized templates that can be reused, instead of using the prebuilt
    templates included in SET.
  prefs: []
  type: TYPE_NORMAL
- en: Web Attack Vectors
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Web attack vectors are probably one of the most advanced and exciting aspects
    of SET, because they are specifically crafted to be believable and enticing to
    the target. SET can clone websites that look identical to trusted sites, helping
    to ensure that the target will think he is visiting a legitimate site.
  prefs: []
  type: TYPE_NORMAL
- en: Java Applet
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The Java applet attack is one of the most successful attack vectors in SET.
    The applet itself was created by one of the SET developers, Thomas Werth. This
    attack introduces a malicious Java applet that does smart browser detection (so
    your exploit works) and delivers a payload to a target’s machine. The Java applet
    attack is not considered a vulnerability by Java. When a target browses the malicious
    site, he is presented with a warning asking if he wants to run an untrusted Java
    applet. Because Java allows you to sign an applet with any name you choose, you
    could call the publisher Google, Microsoft, or any other string you choose. By
    editing the *set_config* file and setting `WEBATTACK_EMAIL` to `ON`, you can also
    incorporate mass emails with this attack.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s walk through a real-world example — a penetration test performed for a
    Fortune 1000 company. First, a copycat domain name, similar to that of the actual
    company website, was registered. Next, the attacker scraped the Internet looking
    for *@<company>.com* email addresses using the harvester module within Metasploit.
    After extracting 200 email addresses from public websites, mass emails were sent
    to these addresses. The attack email claimed to be from the company’s communications
    department and asked the employee to look at the newly designed corporate website.
    Each email was personalized with the recipient’s name and claimed that the employee
    could click a link to see a picture of himself on the corporate home page. The
    email said that this new website displayed the employee’s photograph as a testimony
    to his hard work. Curiosity and fear were the prime motivators in getting each
    target to click the URL immediately.
  prefs: []
  type: TYPE_NORMAL
- en: 'After the target clicked the link, a Java applet notification popped up, signed
    by the employee’s corporation. The target clicked the run command because the
    notification looked legitimate; however, the command was based on the cloned site
    under the fake domain. Even though the employees didn’t see their pictures, they
    were presented with a website that looked legitimate, not realizing that their
    machines had been compromised: When the user clicked Run on the Java applet security
    prompt, a payload was executed and a shell delivered to the attacker. Once the
    payload was executed, the target was redirected back to the legitimate site.'
  prefs: []
  type: TYPE_NORMAL
- en: 'SET can be used to clone a website and rewrite portions of it so that when
    a target visits the malicious site it looks identical to the original site. Let’s
    see how we could set up this attack on a fictitious site, [http://www.secmaniac.com/](http://www.secmaniac.com/),
    in SET:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: To begin this attack scenario, select `Website Attack Vectors` ![](../images/00002.gif)
    from the SET main menu. Use the `Java Applet Attack Method` ![](../images/00004.gif),
    and then choose `Site Cloner` ![](../images/00005.gif) from the subsequent menu.
    Finally, tell SET to clone the SecManiac website ![](../images/00006.gif).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: As with other SET attack methods, attackers can use a variety of payloads. The
    default reverse Meterpreter payload ![](../images/00002.gif) is usually an excellent
    selection. For this scenario, you can simply select the defaults when prompted
    for the encoder to use ![](../images/00004.gif) and the port to use to reconnect.
  prefs: []
  type: TYPE_NORMAL
- en: 'With the configuration complete, SET launches Metasploit:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: SET passes all necessary options to Metasploit, which then sets up the reverse
    Meterpreter listener on port 443 ![](../images/00002.gif).
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: You have created a web server housing a cloned instance of [http://www.secmaniac.com/](http://www.secmaniac.com/).
    If you had changed the configuration file to include `WEBATTACK_EMAIL=ON`, you
    would have been prompted to send an email using the spear-phishing attack vector
    (minus attachments).
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Now that everything is set up, you simply need to get a target to browse to
    the malicious site. Upon reaching the website, the target sees a pop-up warning
    from the publisher, Microsoft, as shown in [Figure 10-2](part0014.html#java_applet_prompt).
    If the target clicks Run, and most users will, the payload will be executed, and
    you gain full control of the user’s system.
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Recall that SET’s configuration can self-sign the Java applet with whatever
    you want. Remember, too, that when the target clicks Run and the payload is executed
    and delivered, the target is redirected to the legitimate SecManiac website.
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: '![Java applet prompt](../images/00040.jpeg)Figure 10-2. Java applet prompt'
  prefs: []
  type: TYPE_NORMAL
- en: Back at our attacker machine, the Meterpreter session is successfully established,
    and we now have access to the target’s machine as shown here.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: Client-Side Web Exploits
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'SET can also use client-side web exploits. In this case, instead of a Java
    applet being presented to the target, a client-side exploit imported directly
    from Metasploit is used to attack the system. To use client-side exploits, you
    must rely on your prior reconnaissance or hope that the user is susceptible to
    a specific vulnerability. This method is particularly satisfying if a zero-day
    vulnerability is discovered: As soon as an exploit is released from Metasploit,
    it is typically tested and published through SET within the hour.'
  prefs: []
  type: TYPE_NORMAL
- en: 'In this example, we will repeat the previous scenario, but we’ll use a client-side
    attack. Client-side attacks specifically target (mostly) browser flaws. Most exploits
    in SET target Internet Explorer; however, Firefox exploits are also used. In this
    scenario, we’ll use the Aurora attack vector that was used to compromise Google.
    To begin, do the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: Select `Website Attack Vectors` ![](../images/00002.gif) from the SET main menu,
    and then select `The Metasploit Browser Exploit Method` ![](../images/00004.gif).
    Then select the `Site Cloner` ![](../images/00005.gif) option, and enter [http://www.secmaniac.com](http://www.secmaniac.com)
    ![](../images/00006.gif) as the website you want to use for cloning.
  prefs: []
  type: TYPE_NORMAL
- en: Once the site is cloned, we’ll set up the exploit to trigger when a target browses
    the site.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: To complete the attack setup, select the client-side exploit you wish to use.
    Above, we choose the infamous Internet Explorer Aurora exploit ![](../images/00002.gif)
    and accept the default reverse Meterpreter payload by pressing enter ![](../images/00004.gif).
  prefs: []
  type: TYPE_NORMAL
- en: When the target reaches [http://www.secmaniac.com/](http://www.secmaniac.com/),
    the site looks normal, but his system is compromised through an *iframe injection*.
    SET automatically rewrites the site to contain the iframe that houses the Metasploit
    client-side attack.
  prefs: []
  type: TYPE_NORMAL
- en: Back at the attacking machine, we see that the attack is successful. The Meterpreter
    session has established the connection from the target to the attacking machine,
    and we have full access to the system, as shown here.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: Username and Password Harvesting
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In the preceding examples, the goal was to obtain access to the individual system.
    Relatively new within SET is the ability to clone a website and harvest visitors’
    credentials when they access the site, as we’ll demonstrate using Gmail in this
    next example. SET can create a clone of the Gmail website and then automatically
    rewrite the POST parameters of that website to post to the SET web server and
    then redirect the user to the legitimately cloned website.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: After you select `Website Attack Vectors` and the `Credential Harvester` ![](../images/00002.gif),
    choose `Site Cloner` ![](../images/00004.gif). The configuration for this attack
    is minimal and requires only that you pass a URL ([http://www.secmaniac.com](http://www.secmaniac.com))
    ![](../images/00005.gif) to SET that contains a login form.
  prefs: []
  type: TYPE_NORMAL
- en: 'The web server runs and waits for the target’s response. As mentioned previously,
    you could in this instance set `WEBATTACK_CONFIG=ON`, and SET would prompt you
    to attempt mass emails to coax targets into clicking the link. The target would
    be presented with a web page that looks identical to Gmail’s website and initial
    login page. When the target enters his password, the browser automatically redirects
    to the original Gmail website, while the following information is presented to
    the attacker:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: SET uses a built-in dictionary to mark form fields and parameters on sites that
    might contain sensitive information. It red-highlights potential username and
    password parameters to indicate that they could be sensitive parameters that are
    worth investigating.
  prefs: []
  type: TYPE_NORMAL
- en: Once you’ve finished harvesting all of the target’s credentials, press ctrl-C
    to generate a report, as shown in [Figure 10-3](part0014.html#credential_harvester_report).
    The report uses XML and HTML formatting.
  prefs: []
  type: TYPE_NORMAL
- en: SET’s web server is multithreaded and can handle as many requests as your server
    can handle. When a number of targets enter their credentials into the site, SET
    will automatically parse those results into a report format that separates the
    form fields in a readable format.
  prefs: []
  type: TYPE_NORMAL
- en: You can also export the credential harvesting results in an XML-compliant format
    to later import into tools or parsers that you’re already using.
  prefs: []
  type: TYPE_NORMAL
- en: '![Credential harvester report](../images/00041.jpeg)Figure 10-3. Credential
    harvester report'
  prefs: []
  type: TYPE_NORMAL
- en: Tabnabbing
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In a *tabnabbing* scenario, a target is caught while accessing a website with
    multiple tabs open. When the target clicks a link, he is presented with a “Please
    wait while the page loads” message. When the target switches tabs, the website
    detects that a different tab has focus and rewrites the web page that presented
    the “Please wait . . . ” message with a website you specify.
  prefs: []
  type: TYPE_NORMAL
- en: Eventually, the target clicks the tabnabbed tab, and, believing he is being
    asked to sign in to his email program or business application, he enters his credentials
    into the malicious look-alike site. The credentials are harvested, and the target
    is redirected to the original website. You can access the tab-nabbing attack vector
    through SET’s web attack vector interface.
  prefs: []
  type: TYPE_NORMAL
- en: Man-Left-in-the-Middle
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: A *man-left-in-the-middle* attack uses HTTP referers on an already compromised
    site or a cross-site scripting (XSS) vulnerability to pass the target’s credentials
    back to the HTTP server. If you find an XSS vulnerability and send the URL to
    the target, who then clicks the link, the website will operate normally, but when
    the target logs into the system, his credentials are passed to the attacker. The
    man-left-in-the-middle attack vector can be accessed through SET’s web attack
    vector interface.
  prefs: []
  type: TYPE_NORMAL
- en: Web Jacking
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The *web jacking* attack method, new in SET version 0.7, allows you to create
    a website clone, where the target is presented with a link stating that the website
    has moved. When the target hovers over the link, the URL presented is the real
    URL, not the attacker’s URL. So, for example, if you’re cloning [https://gmail.com/](https://gmail.com/),
    the URL that would appear on the target’s machine when he hovers his mouse over
    the link would be [https://gmail.com/](https://gmail.com/). When the target clicks
    the link, Gmail opens but is quickly replaced with your malicious web server.
  prefs: []
  type: TYPE_NORMAL
- en: This attack uses a time-based iframe replacement. When the target hovers over
    the link, it points to whatever site you cloned. When the target clicks the link,
    the iframe replacement will initiate and replace the target’s browser with the
    malicious cloned site without the target’s knowledge. You can change the timing
    of a web jacking attack using the `config/set_config` flags.
  prefs: []
  type: TYPE_NORMAL
- en: To configure SET for the attack, select `Web Jacking Attack Method` ![](../images/00002.gif)
    and `Site Cloner` ![](../images/00004.gif), and then add the site you want to
    clone, [https://gmail.com](https://gmail.com) ![](../images/00005.gif), as shown
    below.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: When the target visits the cloned site, he will see the link shown in [Figure 10-4](part0014.html#initial_page_and_link_to_the_cloned_page).
    Notice that the URL at the lower-left corner shows [https://gmail.com/](https://gmail.com/).
  prefs: []
  type: TYPE_NORMAL
- en: '![Initial page and link to the cloned page](../images/00042.jpeg)Figure 10-4. Initial
    page and link to the cloned page'
  prefs: []
  type: TYPE_NORMAL
- en: When the target clicks the link, he is presented with the cloned web page shown
    in [Figure 10-5](part0014.html#cloned_gmail_welcome_page), which looks exactly
    like the real Gmail Welcome page.
  prefs: []
  type: TYPE_NORMAL
- en: '![Cloned Gmail Welcome page](../images/00043.jpeg)Figure 10-5. Cloned Gmail
    Welcome page'
  prefs: []
  type: TYPE_NORMAL
- en: Notice that the URL text at the top of [Figure 10-5](part0014.html#cloned_gmail_welcome_page)
    shows our malicious web server. As in preceding examples, you can register a similar
    domain name to avoid this issue. Once the target enters his username and password
    in the appropriate fields, you can intercept and harvest the credentials.
  prefs: []
  type: TYPE_NORMAL
- en: Putting It All Together with a Multipronged Attack
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The multi-attack web vector allows you to chain multiple web attack methods
    together to perform a single attack. The multi-attack vector allows you to turn
    on and off different vectors and combine the attacks into one web page. When the
    user clicks the link, he will be targeted by each of the attack vectors you specify.
    A multipronged attack is particularly useful because, in some cases, the Java
    applet might fail, while a client-side Internet Explorer exploit would succeed.
    Or, the Java applet and the Internet Explorer exploits might fail, but the credential
    harvester succeeds.
  prefs: []
  type: TYPE_NORMAL
- en: In the following example, we’ll use the Java applet attack, the Metasploit client-side
    exploit, and the web jacking attack. When the target browses the affected site,
    he will be enticed to click the link and will then be bombarded with a credential
    harvester, Metasploit exploits, and the Java applet attack. Here we’ll select
    an Internet Explorer 7 exploit and browse the target’s machine using Internet
    Explorer 6 just to demonstrate how if one method fails, others can be used.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: Begin configuring the attack by selecting `Multi-Attack Web Method` ![](../images/00002.gif)
    from the main menu, and then choose `Site Cloner` ![](../images/00004.gif) and
    enter the URL to clone, [https://gmail.com](https://gmail.com) ![](../images/00005.gif).
    Next, SET presents a menu of different attacks. Select `The Java Applet Attack
    Method` ![](../images/00006.gif), then `The Metasploit Browser Exploit Method`
    ![](../images/00007.gif), and finally, select `Web Jacking Attack Method` ![](../images/00026.gif).
    You could also select option 7, `Use them all - A.K.A. 'Tactical Nuke'` to enable
    all the attack vectors automatically.
  prefs: []
  type: TYPE_NORMAL
- en: In the preceding example, notice that the flags have changed and that the Java
    applet, Metasploit browser exploit, credential harvester, and web jacking attack
    methods have all been enabled. To proceed, press enter or choose option 8 (`I'm
    finished...`).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: To complete the attack setup, select the default reverse Meterpreter payload
    ![](../images/00002.gif) along with default encoding and listening port ![](../images/00004.gif).
    Choose not to configure a Linux and OS X payload ![](../images/00005.gif), and
    then set the browser exploit to `Internet Explorer 7 Uninitialized Memory Corruption
    (MS09-002)` ![](../images/00006.gif); then SET will launch the attack.
  prefs: []
  type: TYPE_NORMAL
- en: Once everything is running, you can browse to the website and see what’s going
    on there. A message URL tells you that the site has been moved. Please refer to
    [Figure 10-4](part0014.html#initial_page_and_link_to_the_cloned_page) to see what
    the target will see on his machine.
  prefs: []
  type: TYPE_NORMAL
- en: 'Click the link and the Metasploit exploit begins. Here’s the handler on the
    backend:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: This exploit fails, because we are using Internet Explorer 6\. The target’s
    screen is shown in [Figure 10-6](part0014.html#multi-attack_security_warning).
  prefs: []
  type: TYPE_NORMAL
- en: '![Multi-attack security warning](../images/00044.jpeg)Figure 10-6. Multi-attack
    security warning'
  prefs: []
  type: TYPE_NORMAL
- en: We have a backup attack, however. The target clicks Run on the malicious Java
    applet, a Meterpreter shell begins, and the target is redirected back to the original
    Gmail page. The attack is successful.
  prefs: []
  type: TYPE_NORMAL
- en: Notice that when using the Java applet, we automatically migrate to a separate
    thread (process) that happens to be *notepad.exe*. Because of this, if the target
    closes the browser, our attack will continue because the process won’t terminate
    our Meterpreter shell. Also, within the configuration file you can set the “Java
    Repeater” option, which will continue to prompt the target with the Java applet
    warning even if he clicks Cancel. This makes it more likely that the target will
    click the Run button.
  prefs: []
  type: TYPE_NORMAL
- en: The Meterpreter shell is presented to us once a successful exploit is performed,
    as shown below.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: 'Now let’s say that this attack fails, and the target clicks Cancel (without
    the repeater option enabled). He would then be prompted to enter his username
    and password into the username and password fields, allowing you to successfully
    harvest the credentials on the website and still have a successful attack. While
    you wouldn’t have a Meterpreter shell, because the target didn’t click Run, you
    would still be able to intercept the credentials:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE23]'
  prefs: []
  type: TYPE_PRE
- en: As you’ve seen in the preceding examples, you can see that SET offers a number
    of powerful web-based attack vectors in its arsenal. It can be difficult to persuade
    a target to think that a cloned site is legitimate. Most knowledgeable users are
    generally cautious about unfamiliar sites and try to avoid potential security
    issues as they browse the Internet. SET tries to leverage this cautiousness and,
    by letting you mimic a known website, fool even some of the savviest technical
    folks.
  prefs: []
  type: TYPE_NORMAL
- en: Infectious Media Generator
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The Infectious Media Generator is a relatively simple attack vector. With this
    vector, SET creates a folder for you that you can either burn to a CD/DVD or store
    on a USB thumb drive. The *autorun.inf* file is used, which, once inserted into
    a target’s machine, will execute whatever you specify during attack creation.
    Currently, SET supports executables (such as Meterpreter) as well as file-format
    bugs (such as Adobe exploits).
  prefs: []
  type: TYPE_NORMAL
- en: Teensy USB HID Attack Vector
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The Teensy USB HID (human interface device) attack vector is a remarkable combination
    of customized hardware and restriction bypass via keyboard emulation. Traditionally,
    when you insert a CD/DVD or USB into your computer, if autorun is disabled, *autorun.inf*
    isn’t called and you can’t execute your code automatically. However, using the
    Teensy USB HID, you can emulate a keyboard and mouse. When you insert the device,
    it will be detected as a keyboard, and using the microprocessor and onboard flash
    memory storage, you can send a very fast set of keystrokes to the target’s machine
    and completely compromise it, regardless of autorun. You can order a Teensy USB
    HID at [http://www.prjc.com/](http://www.prjc.com/).
  prefs: []
  type: TYPE_NORMAL
- en: Let’s set up a Teensy USB HID to perform a WScript download of a Metasploit
    payload. In the following example, a small WScript file will be written that will
    download an executable and execute it. This will be our Metasploit payload, and
    it’s all handled through SET.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE24]'
  prefs: []
  type: TYPE_PRE
- en: To begin setting up this attack, choose `Teensy USB HID Attack Vector` ![](../images/00002.gif)
    from the main menu, and then choose `WSCRIPT HTTP GET MSF Payload` ![](../images/00004.gif).
    Then tell SET to set up a payload and listener ![](../images/00005.gif), selecting
    the default Meterpreter payload ![](../images/00006.gif) and encoding method ![](../images/00007.gif).
  prefs: []
  type: TYPE_NORMAL
- en: Now that you have a *.pde* file, you will need to download and use the Arduino
    interface, which is a graphical user interface for compiling the *.pde* files
    to be uploaded to your Teensy device.
  prefs: []
  type: TYPE_NORMAL
- en: For this attack, follow the instructions at PJRC ([http://www.pjrc.com/](http://www.pjrc.com/))
    for uploading your code to the Teensy board. It’s relatively simple. You install
    the Teensy loader and libraries. Then you’ll see an IDE (Integrated Drive Electronics)
    interface called *Arduino*. (Arduino/Teensy is supported on Linux, Mac OS X, and
    Windows operating systems.) One of the *most* important aspects of this is that
    you ensure that you set your board to a Teensy USB keyboard/mouse, as show in
    [Figure 10-7](part0014.html#setting_up_the_teensy_device).
  prefs: []
  type: TYPE_NORMAL
- en: '![Setting up the Teensy device](../images/00045.jpeg)Figure 10-7. Setting up
    the Teensy device'
  prefs: []
  type: TYPE_NORMAL
- en: After you have this selected, drag your *.pde* file into the Arduino interface.
    Insert your USB device into the computer and upload your code. This will program
    your device with the SET-generated code. [Figure 10-8](part0014.html#teensy_attack_code_upload)
    shows the code being uploaded.
  prefs: []
  type: TYPE_NORMAL
- en: 'After the programmed USB device is inserted into the target’s machine and the
    code is installed, you should see a Meterpreter shell:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE25]'
  prefs: []
  type: TYPE_PRE
- en: '![Teensy attack code upload](../images/00046.jpeg)Figure 10-8. Teensy attack
    code upload'
  prefs: []
  type: TYPE_NORMAL
- en: Additional SET Features
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We won’t cover every aspect of the Social-Engineer Toolkit, but it does have
    some particularly notable aspects. One tool of note is the SET Interactive Shell:
    an interactive shell that can be selected as a payload instead of Meterpreter.
    Another feature is RATTE (Remote Administration Tool Tommy Edition), a full HTTP
    tunneling payload that was created by Thomas Werth. It relies on HTTP-based communications
    and piggybacks proxy settings on the target machine. RATTE is particularly useful
    when the target uses egress and packet inspection rules that can detect non-HTTP
    traffic. RATTE uses the Blowfish encryption algorithm for communications to allow
    full encryption over HTTP.'
  prefs: []
  type: TYPE_NORMAL
- en: Two other tools include the SET Web-GUI (a full-fledged web application that
    automates several of the attacks discussed above) and the wireless attack vector.
    To run the SET Web-GUI, simply enter **`./set-web`** from the SET home folder.
    The Web-GUI is written in Python and is a great way to perform attacks through
    a web interface. The wireless attack vector creates a rogue access point on the
    attacking machine. When the target connects to the access point, any website he
    visits is redirected to the attacker machine, which can then launch a number of
    SET attacks (such as harvester or the Java applet) on the target.
  prefs: []
  type: TYPE_NORMAL
- en: Looking Ahead
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Like Metasploit, SET is a work in progress. The security community has embraced
    the capabilities and potential of SET and continues to contribute to making it
    better. Social-engineering attacks are on the rise, so ensuring that you can properly
    test these attack vectors is imperative for any comprehensive security program.
  prefs: []
  type: TYPE_NORMAL
- en: As organizations and vendors get better at securing their network perimeters
    with software and hardware solutions, we often forget how easy it is to call or
    email a user and convince him to click or download something that can be used
    for an attack. Social engineering in general takes skill and practice, and a good
    attacker knows that he needs to ensure that the attack is specially crafted to
    target weaknesses in his targets’ company user awareness programs or systems.
    A skilled attacker knows that spending a few days researching an organization,
    looking at Facebook or Twitter pages, and determining what may trigger someone
    to click hastily is just as important as the tools used behind the attack.
  prefs: []
  type: TYPE_NORMAL
- en: Tools like SET are useful to attackers, but always remember that as a penetration
    tester, your skill is defined by your creativity and your ability to navigate
    difficult situations. SET will aid you in attacking your targets, but, ultimately,
    if you fail, it’s probably because you weren’t creative enough.
  prefs: []
  type: TYPE_NORMAL
