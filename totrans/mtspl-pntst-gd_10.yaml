- en: Chapter 10. The Social-Engineer Toolkit
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第10章. 社会工程工具包
- en: The Social-Engineer Toolkit (SET) was developed to coincide with the release
    of Social-Engineer.org, a set of resources conceived by Chris Hadnagy (loganWHD)
    and written by one of this book’s authors, David Kennedy. The site offers a centralized
    location for social-engineering tutorials and explains terminologies, definitions,
    and scenarios that can help prepare you for hacking the human mind.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 社会工程工具包（SET）是为了与Social-Engineer.org的发布相配合而开发的，Social-Engineer.org是由Chris Hadnagy（loganWHD）构思的一套资源，并由本书的一位作者David
    Kennedy编写。该网站提供了一个集中位置，用于社会工程教程，并解释了术语、定义和场景，这些可以帮助你为黑客攻击人类思维做好准备。
- en: The purpose of SET is to fill a gap in the penetration testing community and
    bring awareness to social-engineering attacks. And it has succeeded — SET has
    been downloaded 1 million times and is now an industry standard for deploying
    social-engineering attacks. The toolkit attacks human weaknesses, exploiting curiosity,
    credibility, avarice, and simple human stupidity. Social-engineering attacks are
    at an all-time high and have always been a large risk for many organizations.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: SET的目的在于填补渗透测试社区中的空白，并提高人们对社会工程攻击的认识。它已经取得了成功——SET已被下载了100万次，现在已成为部署社会工程攻击的行业标准。该工具包攻击人类的弱点，利用好奇心、可信度、贪婪和简单的人类愚蠢。社会工程攻击正处于历史最高水平，并且一直是许多组织面临的一大风险。
- en: Of course, social engineering is nothing new. One person trying to coax another
    to perform acts that he normally wouldn’t do is as old as time itself. Many in
    the security community believe that social engineering is one of the biggest risks
    organizations face, because it’s extremely difficult to protect organizations
    from being attacked in this way. (You might remember the ultrasophisticated Operation
    Aurora attack, for example, in which social-engineering was used to attack Gmail
    and other sources of Google data.)
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，社会工程并不是什么新鲜事。一个人试图说服另一个人去做他通常不会做的事情，就像时间一样古老。许多安全社区的人认为，社会工程是组织面临的最大风险之一，因为它极其困难保护组织免受这种方式的攻击。（例如，你可能还记得高度复杂的奥罗拉行动，其中使用了社会工程攻击Gmail和其他谷歌数据来源。）
- en: An *attack vector* is the avenue used to gain information or access to a system.
    SET categorizes attacks by attack vector (such as web, email, and USB-based attacks).
    It uses email, spoofed websites, and other vectors to reach human targets, typically
    tricking individuals into compromising the target or releasing sensitive information.
    Naturally, each vector can have a different success rate depending on its target
    and the communication used. SET also comes prebuilt with email and website templates
    that can be used for social-engineering attacks. SET heavily uses the Metasploit
    Framework.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '*攻击向量*是获取信息或访问系统的途径。SET根据攻击向量（如Web、电子邮件和基于USB的攻击）对攻击进行分类。它使用电子邮件、伪造网站和其他向量来接触人类目标，通常通过欺骗个人使目标妥协或泄露敏感信息。自然地，每个向量根据其目标和所使用的通信方式，可以有不同的成功率。SET还预装了可用于社会工程攻击的电子邮件和网站模板。SET大量使用Metasploit框架。'
- en: Because of the social nature of the attacks themselves, each example in this
    chapter is coupled with a brief story.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 由于攻击本身的社会性质，本章中的每个示例都附有一个简短的故事。
- en: Configuring the Social-Engineer Toolkit
  id: totrans-6
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置社会工程工具包
- en: By default, in Back|Track, SET is located in the */pentest/exploits/set/* directory.
    Before you begin, make sure that you are running the latest version of SET.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，在Back|Track中，SET位于*/pentest/exploits/set/*目录。在开始之前，请确保你正在运行SET的最新版本。
- en: '[PRE0]'
  id: totrans-8
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Next, configure your SET configuration file according to what you’re attempting
    to accomplish. We’ll cover a couple of simple features within the configuration
    file *config/set_config* within the root SET directory.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，根据你试图达成的目标配置你的SET配置文件。我们将在根SET目录下的*config/set_config*配置文件中介绍一些简单的功能。
- en: When using the SET web-based attack vectors, you can turn `ON` the `WEBATTACK_EMAIL`
    flag to perform email phishing in conjunction with the web attack. This flag is
    turned `OFF` by default, which means that you will configure SET and use the web
    attack vector without the support of email phishing.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 当使用SET基于Web的攻击向量时，你可以打开`WEBATTACK_EMAIL`标志，与Web攻击一起执行电子邮件钓鱼。默认情况下，此标志是关闭的，这意味着你将配置SET并使用Web攻击向量，而不使用电子邮件钓鱼的支持。
- en: '[PRE1]'
  id: totrans-11
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: One of the web-based attacks available in SET is the *Java applet attack*, which
    uses self-signed Java applets. By default, this attack uses *Microsoft* as the
    publisher name; however, if the Java Development Kit (JDK) has been installed,
    you can turn this option `ON` and sign the applet with whatever name you want.
    When you turn this flag `ON`, additional options will be available through the
    interface.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: SET中可用的基于Web的攻击之一是*Java小程序攻击*，它使用自签名的Java小程序。默认情况下，此攻击使用*Microsoft*作为发布者名称；然而，如果已安装Java开发工具包（JDK），您可以开启此选项并使用您想要的任何名称对小程序进行签名。当您开启此标志时，界面将通过额外的选项提供更多选项。
- en: '[PRE2]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: The `AUTO_DETECT` setting is one of the most important flags and is turned `ON`
    by default. It tells SET to detect your local IP address automatically and to
    use that as the address for the reverse connection and web servers. If you are
    using multiple interfaces or your reverse payload listener is housed at a different
    location, turn this flag `OFF`. When this option is `OFF`, SET will allow you
    to specify multiple scenarios to ensure that the proper IP address scheme is used,
    for example, in a scenario that includes NAT and port forwarding. These options
    are reflected within the SET interface.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '`AUTO_DETECT`设置是其中最重要的标志之一，默认情况下是开启的。它告诉SET自动检测您的本地IP地址，并将其用作反向连接和Web服务器的地址。如果您正在使用多个接口或您的反向有效负载监听器位于不同的位置，请关闭此标志。当此选项关闭时，SET将允许您指定多个场景以确保使用正确的IP地址方案，例如，在包含NAT和端口转发的场景中。这些选项在SET界面中体现出来。'
- en: '[PRE3]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: When you use the toolkit, by default it uses a built-in Python web-based server.
    To optimize performance, set the `APACHE_SERVER` flag to `ON`, and SET will use
    Apache for the attacks.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 当您使用工具包时，默认情况下它使用内置的Python基于Web的服务器。为了优化性能，将`APACHE_SERVER`标志设置为`ON`，SET将使用Apache进行攻击。
- en: '[PRE4]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Those are the basics of the configuration file. As you can see, you can significantly
    change SET’s behavior depending on which flags are set in the tool. Now let’s
    run the tool.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是配置文件的基本内容。正如您所看到的，您可以根据工具中设置的标志来显著改变SET的行为。现在让我们运行这个工具。
- en: Spear-Phishing Attack Vector
  id: totrans-19
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 鱼叉式网络钓鱼攻击向量
- en: The *spear-phishing attack vector* specially crafts file-format exploits (such
    as Adobe PDF exploits) and primarily sends email attacks containing attachments
    to a target, which, when opened, compromise the target’s machine. SET can use
    Simple Mail Transport Protocol (SMTP) open relays (both anonymous and credentialed),
    Gmail, and Sendmail to send email. SET can also use standard email or HTML-based
    email to perform the phishing attack.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '*鱼叉式网络钓鱼攻击向量*专门制作文件格式漏洞（如Adobe PDF漏洞）并主要发送包含附件的电子邮件攻击到目标，当打开时，会危害目标机器。SET可以使用简单邮件传输协议（SMTP）开放中继（匿名和认证的），Gmail和Sendmail来发送电子邮件。SET还可以使用标准电子邮件或基于HTML的电子邮件来执行网络钓鱼攻击。'
- en: Let’s consider a real-world penetration test targeting the company CompanyXYZ.
    You register a domain name similar to Company XYZ, say *coompanyxyz.com*. You
    then register the subdomain *coom.panyXYZ.com*. Next, you send a spear-phishing
    attack to the target organization, knowing that most employees only glance at
    email and will open any attachment that appears to be legitimate. In this case,
    we will send a PDF file format bug to our target, like so.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们考虑一个针对公司CompanyXYZ的现实世界渗透测试。您注册一个类似于Company XYZ的域名，比如*coompanyxyz.com*。然后，您注册子域名*coom.panyXYZ.com*。接下来，您向目标组织发送鱼叉式网络钓鱼攻击，知道大多数员工只是浏览电子邮件，并会打开任何看似合法的附件。在这种情况下，我们将发送一个PDF文件格式的漏洞到我们的目标，如下所示。
- en: '[PRE5]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: From the SET main menu, select `Spear-Phishing Attack Vectors` ![](../images/00002.gif)
    followed by `Perform a Mass Email Attack` ![](../images/00004.gif). This attack
    infects a PDF file using the Adobe `Collab.collectEmailInfo` vulnerability ![](../images/00005.gif),
    a Metasploit Meterpreter reverse payload ![](../images/00006.gif) that is the
    SET default. `Collab.collectEmailInfo` is a heap-based exploit that, if opened
    (and if the target’s version of Adobe Acrobat is vulnerable to this exploit),
    will connect to the attacking workstation on port 443, which usually allows outbound
    traffic from most networks.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 从SET主菜单中选择`Spear-Phishing Attack Vectors` ![](../images/00002.gif)，然后选择`Perform
    a Mass Email Attack` ![](../images/00004.gif)。此攻击使用Adobe `Collab.collectEmailInfo`漏洞
    ![](../images/00005.gif)感染PDF文件，这是一个SET默认的Metasploit Meterpreter反向有效负载 ![](../images/00006.gif)。"Collab.collectEmailInfo"是一个基于堆的漏洞，如果打开（并且如果目标版本的Adobe
    Acrobat容易受到此漏洞攻击），它将连接到攻击工作站的443端口，这通常允许大多数网络的外出流量。
- en: You are also given the option of renaming the malicious file to make it more
    enticing for the target to open. The default name (*template.pdf*) is selected
    ![](../images/00007.gif) in this scenario for demonstration purposes.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以选择重命名恶意文件，使其对目标更具吸引力以打开。在这个场景中，为了演示目的，默认名称(*template.pdf*)被选中[![](../images/00007.gif)]。
- en: '[PRE6]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Next we email this attack to a single email address ![](../images/00002.gif)
    using the SET predefined email template ![](../images/00004.gif) `Status Report`
    ![](../images/00005.gif). Finally, we enter the email address (**`ihazomgsecurity@secmaniac.com`**)
    ![](../images/00006.gif) to send the malicious file to and have SET use a Gmail
    account ![](../images/00007.gif) to send the message.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们使用SET预定义的电子邮件模板[![](../images/00002.gif)](../images/00004.gif) `状态报告`[![](../images/00005.gif)]将这次攻击发送到单个电子邮件地址(**`ihazomgsecurity@secmaniac.com`**)
    [![](../images/00006.gif)]，并将恶意文件发送到那里，让SET使用Gmail账户[![](../images/00007.gif)]发送消息。
- en: Finally, create a Metasploit listener for the payload to connect back to ![](../images/00002.gif).
    When SET launches Metasploit, it configures all the necessary options and starts
    to listen on your attacking IP address on port 443 ![](../images/00004.gif), as
    configured earlier.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，创建一个Metasploit监听器以连接回[![](../images/00002.gif)]。当SET启动Metasploit时，它会配置所有必要的选项，并开始在之前配置的443端口上监听你的攻击IP地址[![](../images/00004.gif)]。
- en: '[PRE7]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: We’ve just set up an attack against [ihazomgsecurity@secmaniac.com](mailto:ihazomgsecurity@secmaniac.com),
    crafted an email to the recipient, and used an Adobe file format exploit. SET
    allowed us to create templates and have them dynamically imported when we use
    the tool. When the target opens the email and double-clicks the Adobe file, he’ll
    see something like [Figure 10-1](part0014.html#the_targetas_view_of_the_infected_pdf_fi).
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 我们刚刚针对[ihazomgsecurity@secmaniac.com](mailto:ihazomgsecurity@secmaniac.com)设置了一次攻击，为收件人制作了一封电子邮件，并使用了Adobe文件格式漏洞。SET允许我们创建模板，并在使用工具时动态导入它们。当目标打开电子邮件并双击Adobe文件时，他将看到类似[图10-1](part0014.html#the_targetas_view_of_the_infected_pdf_fi)的内容。
- en: '![The target’s view of the infected PDF file](../images/00039.jpeg)Figure 10-1. The
    target’s view of the infected PDF file'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '![目标查看受感染的PDF文件](../images/00039.jpeg)图10-1. 目标查看受感染的PDF文件'
- en: 'The target opens the PDF thinking it’s legitimate, and his system is instantly
    compromised. On the attacker’s side, you see the following:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 目标打开PDF文件时认为它是合法的，但他的系统瞬间被破坏。在攻击者一方，你将看到以下情况：
- en: '[PRE8]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: This example used a spear-phishing attack to target one user, but SET can also
    be used to attack multiple targets using the “mass email” option. You can also
    create customized templates that can be reused, instead of using the prebuilt
    templates included in SET.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 这个例子使用了一次鱼叉式网络钓鱼攻击来针对一个用户，但SET也可以使用“群发邮件”选项来攻击多个目标。你还可以创建可重复使用的自定义模板，而不是使用SET中包含的预构建模板。
- en: Web Attack Vectors
  id: totrans-34
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Web攻击向量
- en: Web attack vectors are probably one of the most advanced and exciting aspects
    of SET, because they are specifically crafted to be believable and enticing to
    the target. SET can clone websites that look identical to trusted sites, helping
    to ensure that the target will think he is visiting a legitimate site.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: Web攻击向量可能是SET最先进和最令人兴奋的方面之一，因为它们被特别设计成对目标来说是可信和诱人的。SET可以克隆看起来与受信任站点完全相同的网站，从而确保目标会认为他正在访问一个合法网站。
- en: Java Applet
  id: totrans-36
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Java小程序
- en: The Java applet attack is one of the most successful attack vectors in SET.
    The applet itself was created by one of the SET developers, Thomas Werth. This
    attack introduces a malicious Java applet that does smart browser detection (so
    your exploit works) and delivers a payload to a target’s machine. The Java applet
    attack is not considered a vulnerability by Java. When a target browses the malicious
    site, he is presented with a warning asking if he wants to run an untrusted Java
    applet. Because Java allows you to sign an applet with any name you choose, you
    could call the publisher Google, Microsoft, or any other string you choose. By
    editing the *set_config* file and setting `WEBATTACK_EMAIL` to `ON`, you can also
    incorporate mass emails with this attack.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: Java小程序攻击是SET中最成功的攻击向量之一。小程序本身是由SET的开发者之一，托马斯·沃斯（Thomas Werth）创建的。这种攻击引入了一个恶意Java小程序，它可以智能地检测浏览器（因此你的漏洞可以利用）并将有效载荷发送到目标机器。Java小程序攻击不被视为Java的漏洞。当目标浏览恶意网站时，他会看到一个警告，询问他是否想要运行不受信任的Java小程序。因为Java允许你使用你选择的任何名称对小程序进行签名，你可以将发布者称为Google、Microsoft或任何其他字符串。通过编辑*set_config*文件并将`WEBATTACK_EMAIL`设置为`ON`，你还可以将群发电子邮件与这种攻击相结合。
- en: Let’s walk through a real-world example — a penetration test performed for a
    Fortune 1000 company. First, a copycat domain name, similar to that of the actual
    company website, was registered. Next, the attacker scraped the Internet looking
    for *@<company>.com* email addresses using the harvester module within Metasploit.
    After extracting 200 email addresses from public websites, mass emails were sent
    to these addresses. The attack email claimed to be from the company’s communications
    department and asked the employee to look at the newly designed corporate website.
    Each email was personalized with the recipient’s name and claimed that the employee
    could click a link to see a picture of himself on the corporate home page. The
    email said that this new website displayed the employee’s photograph as a testimony
    to his hard work. Curiosity and fear were the prime motivators in getting each
    target to click the URL immediately.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过一个现实世界的例子来了解——为一个财富 1000 强公司进行的渗透测试。首先，注册了一个与实际公司网站类似的仿冒域名。接下来，攻击者使用 Metasploit
    中的收割器模块在互联网上搜索使用 `<company>.com` 电子邮件地址。从公共网站上提取了 200 个电子邮件地址后，向这些地址发送了大量电子邮件。攻击电子邮件声称来自公司的通讯部门，要求员工查看新设计的公司网站。每封电子邮件都根据收件人的姓名进行了个性化处理，并声称员工可以点击链接查看公司主页上的自己的照片。电子邮件说，这个新网站展示了员工的照片，作为他辛勤工作的证明。好奇心和恐惧是促使每个目标立即点击
    URL 的主要动机。
- en: 'After the target clicked the link, a Java applet notification popped up, signed
    by the employee’s corporation. The target clicked the run command because the
    notification looked legitimate; however, the command was based on the cloned site
    under the fake domain. Even though the employees didn’t see their pictures, they
    were presented with a website that looked legitimate, not realizing that their
    machines had been compromised: When the user clicked Run on the Java applet security
    prompt, a payload was executed and a shell delivered to the attacker. Once the
    payload was executed, the target was redirected back to the legitimate site.'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 目标点击链接后，弹出一个 Java 小程序通知，由员工的公司签名。目标点击运行命令，因为通知看起来是合法的；然而，该命令基于虚假域名下的克隆网站。尽管员工没有看到他们的照片，但他们看到一个看起来合法的网站，没有意识到他们的机器已被入侵：当用户点击
    Java 小程序安全提示中的运行时，执行了一个有效载荷，并将 shell 传送给攻击者。一旦有效载荷执行完毕，目标被重定向回合法网站。
- en: 'SET can be used to clone a website and rewrite portions of it so that when
    a target visits the malicious site it looks identical to the original site. Let’s
    see how we could set up this attack on a fictitious site, [http://www.secmaniac.com/](http://www.secmaniac.com/),
    in SET:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: SET 可以用来克隆一个网站并重写其部分内容，使得当目标访问恶意网站时，它看起来与原始网站相同。让我们看看我们如何在 SET 中设置针对一个虚构网站 [http://www.secmaniac.com/](http://www.secmaniac.com/)
    的攻击：
- en: '[PRE9]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: To begin this attack scenario, select `Website Attack Vectors` ![](../images/00002.gif)
    from the SET main menu. Use the `Java Applet Attack Method` ![](../images/00004.gif),
    and then choose `Site Cloner` ![](../images/00005.gif) from the subsequent menu.
    Finally, tell SET to clone the SecManiac website ![](../images/00006.gif).
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始这个攻击场景，从 SET 主菜单中选择 `网站攻击向量` ![图片](../images/00002.gif)。使用 `Java Applet 攻击方法`
    ![图片](../images/00004.gif)，然后从后续菜单中选择 `网站克隆器` ![图片](../images/00005.gif)。最后，告诉
    SET 克隆 SecManiac 网站 ![图片](../images/00006.gif)。
- en: '[PRE10]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: As with other SET attack methods, attackers can use a variety of payloads. The
    default reverse Meterpreter payload ![](../images/00002.gif) is usually an excellent
    selection. For this scenario, you can simply select the defaults when prompted
    for the encoder to use ![](../images/00004.gif) and the port to use to reconnect.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 与其他 SET 攻击方法一样，攻击者可以使用各种有效载荷。默认的反向 Meterpreter 有效载荷 ![图片](../images/00002.gif)
    通常是一个很好的选择。对于这个场景，当被提示选择编码器和用于重新连接的端口时，您可以简单地选择默认设置 ![图片](../images/00004.gif)。
- en: 'With the configuration complete, SET launches Metasploit:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 配置完成后，SET 启动 Metasploit：
- en: '[PRE11]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: SET passes all necessary options to Metasploit, which then sets up the reverse
    Meterpreter listener on port 443 ![](../images/00002.gif).
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: SET 将所有必要的选项传递给 Metasploit，然后 Metasploit 在端口 443 上设置反向 Meterpreter 监听器 ![图片](../images/00002.gif)。
- en: '* * *'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: Note
  id: totrans-49
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: You have created a web server housing a cloned instance of [http://www.secmaniac.com/](http://www.secmaniac.com/).
    If you had changed the configuration file to include `WEBATTACK_EMAIL=ON`, you
    would have been prompted to send an email using the spear-phishing attack vector
    (minus attachments).
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 您已经创建了一个托管克隆实例的Web服务器[http://www.secmaniac.com/](http://www.secmaniac.com/)。如果您将配置文件更改以包含`WEBATTACK_EMAIL=ON`，您将提示使用鱼叉式网络钓鱼攻击向量（不包含附件）发送电子邮件。
- en: '* * *'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: Now that everything is set up, you simply need to get a target to browse to
    the malicious site. Upon reaching the website, the target sees a pop-up warning
    from the publisher, Microsoft, as shown in [Figure 10-2](part0014.html#java_applet_prompt).
    If the target clicks Run, and most users will, the payload will be executed, and
    you gain full control of the user’s system.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 现在一切准备就绪，您只需让目标浏览到恶意网站。当目标到达网站时，目标会看到来自发布者Microsoft的弹出警告，如图[图10-2](part0014.html#java_applet_prompt)所示。如果目标点击运行，大多数用户都会这样做，有效载荷将被执行，您将完全控制目标用户的系统。
- en: '* * *'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: Note
  id: totrans-54
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Recall that SET’s configuration can self-sign the Java applet with whatever
    you want. Remember, too, that when the target clicks Run and the payload is executed
    and delivered, the target is redirected to the legitimate SecManiac website.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 回想一下，SET的配置可以自行签名Java小程序，使其具有任何您想要的属性。记住，当目标点击运行并执行和交付有效载荷时，目标将被重定向到合法的SecManiac网站。
- en: '* * *'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: '![Java applet prompt](../images/00040.jpeg)Figure 10-2. Java applet prompt'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '![Java小程序提示](../images/00040.jpeg)图10-2. Java小程序提示'
- en: Back at our attacker machine, the Meterpreter session is successfully established,
    and we now have access to the target’s machine as shown here.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 返回到我们的攻击者机器，Meterpreter会话已成功建立，我们现在可以访问目标机器，如图所示。
- en: '[PRE12]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Client-Side Web Exploits
  id: totrans-60
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 客户端Web漏洞
- en: 'SET can also use client-side web exploits. In this case, instead of a Java
    applet being presented to the target, a client-side exploit imported directly
    from Metasploit is used to attack the system. To use client-side exploits, you
    must rely on your prior reconnaissance or hope that the user is susceptible to
    a specific vulnerability. This method is particularly satisfying if a zero-day
    vulnerability is discovered: As soon as an exploit is released from Metasploit,
    it is typically tested and published through SET within the hour.'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: SET还可以使用客户端Web漏洞。在这种情况下，不是向目标展示Java小程序，而是使用直接从Metasploit导入的客户端漏洞来攻击系统。要使用客户端漏洞，您必须依赖您之前的侦察或希望用户容易受到特定漏洞的影响。如果发现零日漏洞，这种方法尤其令人满意：一旦Metasploit发布漏洞利用，通常在小时内就会通过SET进行测试和发布。
- en: 'In this example, we will repeat the previous scenario, but we’ll use a client-side
    attack. Client-side attacks specifically target (mostly) browser flaws. Most exploits
    in SET target Internet Explorer; however, Firefox exploits are also used. In this
    scenario, we’ll use the Aurora attack vector that was used to compromise Google.
    To begin, do the following:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们将重复之前的场景，但我们将使用客户端攻击。客户端攻击特别针对（主要是）浏览器漏洞。SET中的大多数漏洞利用都针对Internet Explorer；然而，Firefox的漏洞利用也被使用。在这个场景中，我们将使用用于入侵Google的Aurora攻击向量。首先，执行以下操作：
- en: '[PRE13]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Select `Website Attack Vectors` ![](../images/00002.gif) from the SET main menu,
    and then select `The Metasploit Browser Exploit Method` ![](../images/00004.gif).
    Then select the `Site Cloner` ![](../images/00005.gif) option, and enter [http://www.secmaniac.com](http://www.secmaniac.com)
    ![](../images/00006.gif) as the website you want to use for cloning.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 从SET主菜单中选择`网站攻击向量` ![](../images/00002.gif)，然后选择`Metasploit浏览器漏洞利用方法` ![](../images/00004.gif)。然后选择`网站克隆器`
    ![](../images/00005.gif)选项，并输入[http://www.secmaniac.com](http://www.secmaniac.com)
    ![](../images/00006.gif)作为您想要用于克隆的网站。
- en: Once the site is cloned, we’ll set up the exploit to trigger when a target browses
    the site.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦网站被克隆，我们将设置漏洞，以便在目标浏览网站时触发。
- en: '[PRE14]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: To complete the attack setup, select the client-side exploit you wish to use.
    Above, we choose the infamous Internet Explorer Aurora exploit ![](../images/00002.gif)
    and accept the default reverse Meterpreter payload by pressing enter ![](../images/00004.gif).
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 要完成攻击设置，选择您希望使用的客户端漏洞。在上面的示例中，我们选择了臭名昭著的Internet Explorer Aurora漏洞 ![](../images/00002.gif)，并通过按回车键
    ![](../images/00004.gif)接受默认的逆向Meterpreter有效载荷。
- en: When the target reaches [http://www.secmaniac.com/](http://www.secmaniac.com/),
    the site looks normal, but his system is compromised through an *iframe injection*.
    SET automatically rewrites the site to contain the iframe that houses the Metasploit
    client-side attack.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 当目标达到[http://www.secmaniac.com/](http://www.secmaniac.com/)时，网站看起来正常，但他的系统通过*iframe注入*被破坏。SET自动重写网站以包含包含Metasploit客户端攻击的iframe。
- en: Back at the attacking machine, we see that the attack is successful. The Meterpreter
    session has established the connection from the target to the attacking machine,
    and we have full access to the system, as shown here.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 在攻击机器上，我们看到攻击成功。Meterpreter会话已从目标建立到攻击机器的连接，我们完全访问了系统，如图所示。
- en: '[PRE15]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Username and Password Harvesting
  id: totrans-71
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 用户名和密码收割
- en: In the preceding examples, the goal was to obtain access to the individual system.
    Relatively new within SET is the ability to clone a website and harvest visitors’
    credentials when they access the site, as we’ll demonstrate using Gmail in this
    next example. SET can create a clone of the Gmail website and then automatically
    rewrite the POST parameters of that website to post to the SET web server and
    then redirect the user to the legitimately cloned website.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的示例中，目标是获取对单个系统的访问权限。相对较新的SET功能是能够克隆网站并在访问者访问网站时收割他们的凭证，正如我们将在下一个示例中使用Gmail来展示的那样。SET可以创建Gmail网站的克隆，然后自动重写该网站的POST参数以发送到SET
    Web服务器，然后重定向用户到合法克隆的网站。
- en: '[PRE16]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: After you select `Website Attack Vectors` and the `Credential Harvester` ![](../images/00002.gif),
    choose `Site Cloner` ![](../images/00004.gif). The configuration for this attack
    is minimal and requires only that you pass a URL ([http://www.secmaniac.com](http://www.secmaniac.com))
    ![](../images/00005.gif) to SET that contains a login form.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在您选择“网站攻击向量”和“凭证收割机”![凭证收割机](../images/00002.gif)之后，选择“站点克隆器”![站点克隆器](../images/00004.gif)。此攻击的配置很简单，只需您提供一个包含登录表单的URL
    ([http://www.secmaniac.com](http://www.secmaniac.com))![URL](../images/00005.gif)给SET即可。
- en: 'The web server runs and waits for the target’s response. As mentioned previously,
    you could in this instance set `WEBATTACK_CONFIG=ON`, and SET would prompt you
    to attempt mass emails to coax targets into clicking the link. The target would
    be presented with a web page that looks identical to Gmail’s website and initial
    login page. When the target enters his password, the browser automatically redirects
    to the original Gmail website, while the following information is presented to
    the attacker:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: Web服务器运行并等待目标的响应。如前所述，在这种情况下，您可以设置`WEBATTACK_CONFIG=ON`，SET会提示您尝试群发邮件以诱使目标点击链接。目标将看到一个看起来与Gmail网站和初始登录页面完全相同的网页。当目标输入他的密码时，浏览器会自动重定向到原始Gmail网站，同时以下信息呈现给攻击者：
- en: '[PRE17]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: SET uses a built-in dictionary to mark form fields and parameters on sites that
    might contain sensitive information. It red-highlights potential username and
    password parameters to indicate that they could be sensitive parameters that are
    worth investigating.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: SET使用内置字典来标记可能包含敏感信息的网站上的表单字段和参数。它将潜在的用戶名和密码参数以红色高亮显示，以表明它们可能是值得调查的敏感参数。
- en: Once you’ve finished harvesting all of the target’s credentials, press ctrl-C
    to generate a report, as shown in [Figure 10-3](part0014.html#credential_harvester_report).
    The report uses XML and HTML formatting.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 在收割完所有目标凭据后，按ctrl-C生成报告，如图[图10-3](part0014.html#credential_harvester_report)所示。报告使用XML和HTML格式。
- en: SET’s web server is multithreaded and can handle as many requests as your server
    can handle. When a number of targets enter their credentials into the site, SET
    will automatically parse those results into a report format that separates the
    form fields in a readable format.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: SET的Web服务器是多线程的，可以处理与您的服务器相同数量的请求。当多个目标将凭据输入到网站时，SET将自动将这些结果解析成报告格式，以可读的格式分离表单字段。
- en: You can also export the credential harvesting results in an XML-compliant format
    to later import into tools or parsers that you’re already using.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以将凭证收割结果导出为符合XML格式的文件，以便稍后导入您已经使用的工具或解析器。
- en: '![Credential harvester report](../images/00041.jpeg)Figure 10-3. Credential
    harvester report'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: '![凭证收割机报告](../images/00041.jpeg)图10-3. 凭证收割机报告'
- en: Tabnabbing
  id: totrans-82
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Tabnabbing
- en: In a *tabnabbing* scenario, a target is caught while accessing a website with
    multiple tabs open. When the target clicks a link, he is presented with a “Please
    wait while the page loads” message. When the target switches tabs, the website
    detects that a different tab has focus and rewrites the web page that presented
    the “Please wait . . . ” message with a website you specify.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 在一个 *tabnabbing* 场景中，目标在打开多个标签页访问网站时被捕获。当目标点击一个链接时，他会看到一个“请等待页面加载”的消息。当目标切换标签页时，网站检测到不同的标签页获得了焦点，并用你指定的网站重写了显示“请等待……”消息的网页。
- en: Eventually, the target clicks the tabnabbed tab, and, believing he is being
    asked to sign in to his email program or business application, he enters his credentials
    into the malicious look-alike site. The credentials are harvested, and the target
    is redirected to the original website. You can access the tab-nabbing attack vector
    through SET’s web attack vector interface.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 最终，目标点击了tabnabbing标签页，并认为他被要求登录到他的电子邮件程序或商业应用，于是他在恶意的相似网站上输入了他的凭证。凭证被捕获，目标被重定向到原始网站。您可以通过SET的Web攻击向量界面访问tab-nabbing攻击向量。
- en: Man-Left-in-the-Middle
  id: totrans-85
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Man-Left-in-the-Middle
- en: A *man-left-in-the-middle* attack uses HTTP referers on an already compromised
    site or a cross-site scripting (XSS) vulnerability to pass the target’s credentials
    back to the HTTP server. If you find an XSS vulnerability and send the URL to
    the target, who then clicks the link, the website will operate normally, but when
    the target logs into the system, his credentials are passed to the attacker. The
    man-left-in-the-middle attack vector can be accessed through SET’s web attack
    vector interface.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: '*Man-left-in-the-Middle* 攻击使用已受损害的网站或跨站脚本（XSS）漏洞上的HTTP referers将目标的凭证传递回HTTP服务器。如果您发现一个XSS漏洞并将URL发送给目标，目标点击链接后，网站将正常运行，但当目标登录系统时，他的凭证会被传递给攻击者。Man-left-in-the-Middle攻击向量可以通过SET的Web攻击向量界面访问。'
- en: Web Jacking
  id: totrans-87
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Web Jacking
- en: The *web jacking* attack method, new in SET version 0.7, allows you to create
    a website clone, where the target is presented with a link stating that the website
    has moved. When the target hovers over the link, the URL presented is the real
    URL, not the attacker’s URL. So, for example, if you’re cloning [https://gmail.com/](https://gmail.com/),
    the URL that would appear on the target’s machine when he hovers his mouse over
    the link would be [https://gmail.com/](https://gmail.com/). When the target clicks
    the link, Gmail opens but is quickly replaced with your malicious web server.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: SET版本0.7中引入的 *web jacking* 攻击方法允许您创建一个网站克隆，目标会看到一个链接，表明网站已迁移。当目标悬停在链接上时，显示的URL是真实URL，而不是攻击者的URL。例如，如果您正在克隆[https://gmail.com/](https://gmail.com/)，当目标将鼠标悬停在链接上时，目标机器上显示的URL将是[https://gmail.com/](https://gmail.com/)。当目标点击链接时，Gmail会打开，但很快就被您的恶意Web服务器所取代。
- en: This attack uses a time-based iframe replacement. When the target hovers over
    the link, it points to whatever site you cloned. When the target clicks the link,
    the iframe replacement will initiate and replace the target’s browser with the
    malicious cloned site without the target’s knowledge. You can change the timing
    of a web jacking attack using the `config/set_config` flags.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 这种攻击使用基于时间的iframe替换。当目标悬停在链接上时，它指向您克隆的任何网站。当目标点击链接时，iframe替换将启动并替换目标浏览器，用恶意克隆网站替换，而目标并不知道。您可以使用`config/set_config`标志更改web
    jacking攻击的时间。
- en: To configure SET for the attack, select `Web Jacking Attack Method` ![](../images/00002.gif)
    and `Site Cloner` ![](../images/00004.gif), and then add the site you want to
    clone, [https://gmail.com](https://gmail.com) ![](../images/00005.gif), as shown
    below.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 要配置SET进行攻击，选择`Web Jacking Attack Method` ![](../images/00002.gif) 和 `Site Cloner`
    ![](../images/00004.gif)，然后添加您想要克隆的网站，[https://gmail.com](https://gmail.com) ![](../images/00005.gif)，如下所示。
- en: '[PRE18]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: When the target visits the cloned site, he will see the link shown in [Figure 10-4](part0014.html#initial_page_and_link_to_the_cloned_page).
    Notice that the URL at the lower-left corner shows [https://gmail.com/](https://gmail.com/).
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 当目标访问克隆的网站时，他将看到[图10-4](part0014.html#initial_page_and_link_to_the_cloned_page)中显示的链接。注意，左下角的URL显示为[https://gmail.com/](https://gmail.com/)。
- en: '![Initial page and link to the cloned page](../images/00042.jpeg)Figure 10-4. Initial
    page and link to the cloned page'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '![初始页面和克隆页面的链接](../images/00042.jpeg)图10-4. 初始页面和克隆页面的链接'
- en: When the target clicks the link, he is presented with the cloned web page shown
    in [Figure 10-5](part0014.html#cloned_gmail_welcome_page), which looks exactly
    like the real Gmail Welcome page.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 当目标点击链接时，他看到的克隆网页如[图10-5](part0014.html#cloned_gmail_welcome_page)所示，看起来与真实的Gmail欢迎页面一模一样。
- en: '![Cloned Gmail Welcome page](../images/00043.jpeg)Figure 10-5. Cloned Gmail
    Welcome page'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: '![克隆的Gmail欢迎页面](../images/00043.jpeg)图10-5. 克隆的Gmail欢迎页面'
- en: Notice that the URL text at the top of [Figure 10-5](part0014.html#cloned_gmail_welcome_page)
    shows our malicious web server. As in preceding examples, you can register a similar
    domain name to avoid this issue. Once the target enters his username and password
    in the appropriate fields, you can intercept and harvest the credentials.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，[图10-5](part0014.html#cloned_gmail_welcome_page) 顶部显示的URL文本显示了我们的恶意网络服务器。与前面的示例一样，您可以注册一个类似的域名来避免这个问题。一旦目标在适当的字段中输入用户名和密码，您就可以拦截并收集凭证。
- en: Putting It All Together with a Multipronged Attack
  id: totrans-97
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用多管齐下的攻击将所有内容组合在一起
- en: The multi-attack web vector allows you to chain multiple web attack methods
    together to perform a single attack. The multi-attack vector allows you to turn
    on and off different vectors and combine the attacks into one web page. When the
    user clicks the link, he will be targeted by each of the attack vectors you specify.
    A multipronged attack is particularly useful because, in some cases, the Java
    applet might fail, while a client-side Internet Explorer exploit would succeed.
    Or, the Java applet and the Internet Explorer exploits might fail, but the credential
    harvester succeeds.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 多攻击网络向量允许您将多个网络攻击方法串联起来执行单一攻击。多攻击向量允许您打开和关闭不同的向量，并将攻击组合到一个网页中。当用户点击链接时，他将成为您指定的每个攻击向量的目标。多管齐下的攻击特别有用，因为在某些情况下，Java小程序可能会失败，而客户端的Internet
    Explorer漏洞利用可能会成功。或者，Java小程序和Internet Explorer漏洞利用可能会失败，但凭证收集器会成功。
- en: In the following example, we’ll use the Java applet attack, the Metasploit client-side
    exploit, and the web jacking attack. When the target browses the affected site,
    he will be enticed to click the link and will then be bombarded with a credential
    harvester, Metasploit exploits, and the Java applet attack. Here we’ll select
    an Internet Explorer 7 exploit and browse the target’s machine using Internet
    Explorer 6 just to demonstrate how if one method fails, others can be used.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下示例中，我们将使用Java小程序攻击、Metasploit客户端漏洞利用和Web劫持攻击。当目标浏览受影响的网站时，他将被诱惑点击链接，然后会被凭证收集器、Metasploit漏洞利用和Java小程序攻击所轰炸。这里我们将选择一个Internet
    Explorer 7漏洞利用，并使用Internet Explorer 6浏览目标机器，只是为了演示如果一种方法失败，其他方法可以被使用。
- en: '[PRE19]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Begin configuring the attack by selecting `Multi-Attack Web Method` ![](../images/00002.gif)
    from the main menu, and then choose `Site Cloner` ![](../images/00004.gif) and
    enter the URL to clone, [https://gmail.com](https://gmail.com) ![](../images/00005.gif).
    Next, SET presents a menu of different attacks. Select `The Java Applet Attack
    Method` ![](../images/00006.gif), then `The Metasploit Browser Exploit Method`
    ![](../images/00007.gif), and finally, select `Web Jacking Attack Method` ![](../images/00026.gif).
    You could also select option 7, `Use them all - A.K.A. 'Tactical Nuke'` to enable
    all the attack vectors automatically.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 通过从主菜单中选择`多攻击网络方法` ![](../images/00002.gif) 开始配置攻击，然后选择`站点克隆器` ![](../images/00004.gif)
    并输入要克隆的URL，[https://gmail.com](https://gmail.com) ![](../images/00005.gif)。接下来，SET会显示不同攻击的菜单。选择`Java小程序攻击方法`
    ![](../images/00006.gif)，然后选择`Metasploit浏览器漏洞利用方法` ![](../images/00007.gif)，最后选择`Web劫持攻击方法`
    ![](../images/00026.gif)。您还可以选择选项7，`全部使用 - 俗称“战术核弹”`，以自动启用所有攻击向量。
- en: In the preceding example, notice that the flags have changed and that the Java
    applet, Metasploit browser exploit, credential harvester, and web jacking attack
    methods have all been enabled. To proceed, press enter or choose option 8 (`I'm
    finished...`).
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的示例中，请注意标志已更改，Java小程序、Metasploit浏览器漏洞利用、凭证收集器和Web劫持攻击方法都已启用。要继续，请按回车键或选择选项8（`我完成了...`）。
- en: '[PRE20]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: To complete the attack setup, select the default reverse Meterpreter payload
    ![](../images/00002.gif) along with default encoding and listening port ![](../images/00004.gif).
    Choose not to configure a Linux and OS X payload ![](../images/00005.gif), and
    then set the browser exploit to `Internet Explorer 7 Uninitialized Memory Corruption
    (MS09-002)` ![](../images/00006.gif); then SET will launch the attack.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
- en: Once everything is running, you can browse to the website and see what’s going
    on there. A message URL tells you that the site has been moved. Please refer to
    [Figure 10-4](part0014.html#initial_page_and_link_to_the_cloned_page) to see what
    the target will see on his machine.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
- en: 'Click the link and the Metasploit exploit begins. Here’s the handler on the
    backend:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: This exploit fails, because we are using Internet Explorer 6\. The target’s
    screen is shown in [Figure 10-6](part0014.html#multi-attack_security_warning).
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
- en: '![Multi-attack security warning](../images/00044.jpeg)Figure 10-6. Multi-attack
    security warning'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
- en: We have a backup attack, however. The target clicks Run on the malicious Java
    applet, a Meterpreter shell begins, and the target is redirected back to the original
    Gmail page. The attack is successful.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
- en: Notice that when using the Java applet, we automatically migrate to a separate
    thread (process) that happens to be *notepad.exe*. Because of this, if the target
    closes the browser, our attack will continue because the process won’t terminate
    our Meterpreter shell. Also, within the configuration file you can set the “Java
    Repeater” option, which will continue to prompt the target with the Java applet
    warning even if he clicks Cancel. This makes it more likely that the target will
    click the Run button.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
- en: The Meterpreter shell is presented to us once a successful exploit is performed,
    as shown below.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Now let’s say that this attack fails, and the target clicks Cancel (without
    the repeater option enabled). He would then be prompted to enter his username
    and password into the username and password fields, allowing you to successfully
    harvest the credentials on the website and still have a successful attack. While
    you wouldn’t have a Meterpreter shell, because the target didn’t click Run, you
    would still be able to intercept the credentials:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE23]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: As you’ve seen in the preceding examples, you can see that SET offers a number
    of powerful web-based attack vectors in its arsenal. It can be difficult to persuade
    a target to think that a cloned site is legitimate. Most knowledgeable users are
    generally cautious about unfamiliar sites and try to avoid potential security
    issues as they browse the Internet. SET tries to leverage this cautiousness and,
    by letting you mimic a known website, fool even some of the savviest technical
    folks.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
- en: Infectious Media Generator
  id: totrans-117
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The Infectious Media Generator is a relatively simple attack vector. With this
    vector, SET creates a folder for you that you can either burn to a CD/DVD or store
    on a USB thumb drive. The *autorun.inf* file is used, which, once inserted into
    a target’s machine, will execute whatever you specify during attack creation.
    Currently, SET supports executables (such as Meterpreter) as well as file-format
    bugs (such as Adobe exploits).
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 感染性媒体生成器是一个相对简单的攻击向量。使用此向量，SET 会为您创建一个文件夹，您可以将它烧录到 CD/DVD 上或存储在 USB 驱动器上。使用
    *autorun.inf* 文件，一旦将其插入目标机器，就会执行攻击创建期间指定的任何内容。目前，SET 支持可执行文件（如 Meterpreter）以及文件格式漏洞（如
    Adobe 漏洞）。
- en: Teensy USB HID Attack Vector
  id: totrans-119
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Teensy USB HID 攻击向量
- en: The Teensy USB HID (human interface device) attack vector is a remarkable combination
    of customized hardware and restriction bypass via keyboard emulation. Traditionally,
    when you insert a CD/DVD or USB into your computer, if autorun is disabled, *autorun.inf*
    isn’t called and you can’t execute your code automatically. However, using the
    Teensy USB HID, you can emulate a keyboard and mouse. When you insert the device,
    it will be detected as a keyboard, and using the microprocessor and onboard flash
    memory storage, you can send a very fast set of keystrokes to the target’s machine
    and completely compromise it, regardless of autorun. You can order a Teensy USB
    HID at [http://www.prjc.com/](http://www.prjc.com/).
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: Teensy USB HID（人机界面设备）攻击向量是定制硬件和通过键盘模拟绕过限制的出色组合。传统上，当您将 CD/DVD 或 USB 插入电脑时，如果禁用了自动运行，*autorun.inf*
    不会被调用，您无法自动执行代码。然而，使用 Teensy USB HID，您可以模拟键盘和鼠标。当您插入设备时，它将被检测为键盘，并且使用微处理器和板载闪存存储，您可以向目标机器发送一组非常快速的按键，并完全控制它，无论是否启用自动运行。您可以在
    [http://www.prjc.com/](http://www.prjc.com/) 订购 Teensy USB HID。
- en: Let’s set up a Teensy USB HID to perform a WScript download of a Metasploit
    payload. In the following example, a small WScript file will be written that will
    download an executable and execute it. This will be our Metasploit payload, and
    it’s all handled through SET.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们设置一个 Teensy USB HID 来执行 Metasploit 有效载荷的 WScript 下载。在以下示例中，将编写一个小 WScript
    文件，该文件将下载一个可执行文件并执行它。这将是我们 Metasploit 有效载荷，并且所有操作都通过 SET 完成。
- en: '[PRE24]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: To begin setting up this attack, choose `Teensy USB HID Attack Vector` ![](../images/00002.gif)
    from the main menu, and then choose `WSCRIPT HTTP GET MSF Payload` ![](../images/00004.gif).
    Then tell SET to set up a payload and listener ![](../images/00005.gif), selecting
    the default Meterpreter payload ![](../images/00006.gif) and encoding method ![](../images/00007.gif).
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始设置此攻击，从主菜单中选择 `Teensy USB HID 攻击向量` ![选择](../images/00002.gif)，然后选择 `WSCRIPT
    HTTP GET MSF Payload` ![选择](../images/00004.gif)。然后告诉 SET 设置一个有效载荷和监听器 ![设置](../images/00005.gif)，选择默认的
    Meterpreter 有效载荷 ![选择](../images/00006.gif) 和编码方法 ![选择](../images/00007.gif)。
- en: Now that you have a *.pde* file, you will need to download and use the Arduino
    interface, which is a graphical user interface for compiling the *.pde* files
    to be uploaded to your Teensy device.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您有了 *.pde* 文件，您需要下载并使用 Arduino 接口，这是一个用于将 *.pde* 文件编译成上传到您的 Teensy 设备的图形用户界面。
- en: For this attack, follow the instructions at PJRC ([http://www.pjrc.com/](http://www.pjrc.com/))
    for uploading your code to the Teensy board. It’s relatively simple. You install
    the Teensy loader and libraries. Then you’ll see an IDE (Integrated Drive Electronics)
    interface called *Arduino*. (Arduino/Teensy is supported on Linux, Mac OS X, and
    Windows operating systems.) One of the *most* important aspects of this is that
    you ensure that you set your board to a Teensy USB keyboard/mouse, as show in
    [Figure 10-7](part0014.html#setting_up_the_teensy_device).
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 对于此攻击，请遵循 PJRC ([http://www.pjrc.com/](http://www.pjrc.com/)) 上的说明将代码上传到 Teensy
    板。这相对简单。您安装 Teensy 加载器和库。然后您将看到一个名为 *Arduino* 的 IDE（集成驱动电子）界面。（Arduino/Teensy
    支持在 Linux、Mac OS X 和 Windows 操作系统上运行。）其中最重要的一个方面是确保您将板设置为 Teensy USB 键盘/鼠标，如图
    [图 10-7](part0014.html#setting_up_the_teensy_device) 所示。
- en: '![Setting up the Teensy device](../images/00045.jpeg)Figure 10-7. Setting up
    the Teensy device'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: '![设置 Teensy 设备](../images/00045.jpeg) 图 10-7. 设置 Teensy 设备'
- en: After you have this selected, drag your *.pde* file into the Arduino interface.
    Insert your USB device into the computer and upload your code. This will program
    your device with the SET-generated code. [Figure 10-8](part0014.html#teensy_attack_code_upload)
    shows the code being uploaded.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 在您选择好之后，将您的 *.pde* 文件拖入 Arduino 接口。将您的 USB 设备插入电脑并上传您的代码。这将使用 SET 生成的代码编程您的设备。[图
    10-8](part0014.html#teensy_attack_code_upload) 展示了正在上传的代码。
- en: 'After the programmed USB device is inserted into the target’s machine and the
    code is installed, you should see a Meterpreter shell:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 在将编程好的USB设备插入目标机器并安装代码后，您应该看到一个Meterpreter外壳：
- en: '[PRE25]'
  id: totrans-129
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '![Teensy attack code upload](../images/00046.jpeg)Figure 10-8. Teensy attack
    code upload'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: '![Teensy攻击代码上传](../images/00046.jpeg)图10-8. Teensy攻击代码上传'
- en: Additional SET Features
  id: totrans-131
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SET的其他功能
- en: 'We won’t cover every aspect of the Social-Engineer Toolkit, but it does have
    some particularly notable aspects. One tool of note is the SET Interactive Shell:
    an interactive shell that can be selected as a payload instead of Meterpreter.
    Another feature is RATTE (Remote Administration Tool Tommy Edition), a full HTTP
    tunneling payload that was created by Thomas Werth. It relies on HTTP-based communications
    and piggybacks proxy settings on the target machine. RATTE is particularly useful
    when the target uses egress and packet inspection rules that can detect non-HTTP
    traffic. RATTE uses the Blowfish encryption algorithm for communications to allow
    full encryption over HTTP.'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 我们不会涵盖Social-Engineer Toolkit的每个方面，但它确实有一些特别值得注意的方面。一个值得注意的工具是SET交互式外壳：一个可以选择作为有效载荷而不是Meterpreter的交互式外壳。另一个功能是RATTE（远程管理工具汤米版），这是一个完整的HTTP隧道有效载荷，由托马斯·沃斯创建。它依赖于基于HTTP的通信，并在目标机器上依赖代理设置。当目标使用出口和包检查规则来检测非HTTP流量时，RATTE特别有用。RATTE使用Blowfish加密算法进行通信，以允许在HTTP上实现完全加密。
- en: Two other tools include the SET Web-GUI (a full-fledged web application that
    automates several of the attacks discussed above) and the wireless attack vector.
    To run the SET Web-GUI, simply enter **`./set-web`** from the SET home folder.
    The Web-GUI is written in Python and is a great way to perform attacks through
    a web interface. The wireless attack vector creates a rogue access point on the
    attacking machine. When the target connects to the access point, any website he
    visits is redirected to the attacker machine, which can then launch a number of
    SET attacks (such as harvester or the Java applet) on the target.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 其他两个工具包括SET Web-GUI（一个完整的Web应用程序，自动化了上述讨论的几个攻击）和无线攻击向量。要运行SET Web-GUI，只需从SET主文件夹中输入**`./set-web`**。Web-GUI是用Python编写的，通过Web界面执行攻击是一个很好的方法。无线攻击向量在攻击机器上创建一个恶意接入点。当目标连接到接入点时，他访问的任何网站都会被重定向到攻击者机器，然后可以在目标上启动一系列SET攻击（如harvester或Java小程序）。
- en: Looking Ahead
  id: totrans-134
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 展望未来
- en: Like Metasploit, SET is a work in progress. The security community has embraced
    the capabilities and potential of SET and continues to contribute to making it
    better. Social-engineering attacks are on the rise, so ensuring that you can properly
    test these attack vectors is imperative for any comprehensive security program.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 与Metasploit一样，SET是一个持续发展的项目。安全社区已经接受了SET的功能和潜力，并继续为其改进做出贡献。社会工程攻击正在增加，因此确保您能够正确测试这些攻击向量对于任何全面的网络安全计划至关重要。
- en: As organizations and vendors get better at securing their network perimeters
    with software and hardware solutions, we often forget how easy it is to call or
    email a user and convince him to click or download something that can be used
    for an attack. Social engineering in general takes skill and practice, and a good
    attacker knows that he needs to ensure that the attack is specially crafted to
    target weaknesses in his targets’ company user awareness programs or systems.
    A skilled attacker knows that spending a few days researching an organization,
    looking at Facebook or Twitter pages, and determining what may trigger someone
    to click hastily is just as important as the tools used behind the attack.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 随着组织和供应商在软件和硬件解决方案方面提高保护其网络边界的技能，我们常常忘记通过电话或电子邮件联系用户并说服他们点击或下载可能被用于攻击的东西是多么容易。总的来说，社会工程需要技巧和实践，而一个优秀的攻击者知道他需要确保攻击专门针对目标公司用户意识计划或系统中的弱点。一个熟练的攻击者知道，花几天时间研究一个组织，查看Facebook或Twitter页面，并确定可能触发某人匆忙点击的东西，与攻击背后使用的工具一样重要。
- en: Tools like SET are useful to attackers, but always remember that as a penetration
    tester, your skill is defined by your creativity and your ability to navigate
    difficult situations. SET will aid you in attacking your targets, but, ultimately,
    if you fail, it’s probably because you weren’t creative enough.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: SET等工具对攻击者很有用，但请始终记住，作为一名渗透测试员，您的技能由您的创造力和您在困难情况下的导航能力定义。SET可以帮助您攻击目标，但最终，如果您失败了，可能是因为您不够有创意。
