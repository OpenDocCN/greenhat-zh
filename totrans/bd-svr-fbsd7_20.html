<html><head></head><body>

<div class="calibre1"><div class="calibre1"><a name="cups_print_server_1.3.3" class="calibre8" id="cups_print_server_1.3.3"/>
<div class="calibre24" id="calibre_pb_0"/><h2 id="title-ID0EQTOM" class="docPrefaceTitle">Chapter 6. CUPS Print Server 1.3.3</h2>
<h4 class="calibre32"><a class="calibre2" target="_blank" href="HTTP://CUPS.ORG">HTTP://CUPS.ORG</a></h4>
<a name="summary-id5" class="calibre8" id="summary-id5"/>
<h3 class="docSection1Title" id="-100000">6.1. SUMMARY</h3>
<p class="docText1"><a name="The" class="calibre8" id="The"/>The <span class="docEmphasis1"><a name="Printing System" class="calibre8" id="Printing System"/>Common Unix Printing System (CUPS)</span><a name="printing system" class="calibre8" id="printing system"/> is an open source printing system that provides a common interface to support printers in Unix-based systems. It also provides a standardized and modular platform that allows the use of external filters like Foomatic and Ghostscript for expanded printer compatibility. CUPS is licensed under the GNU GPL and has become the standard printing system for a large number of Linux distributions as well as Mac OS X.<a name="IDX-CHP-6-0111" class="calibre8" id="IDX-CHP-6-0111"/><a name="IDX-CHP-6-0112" class="calibre8" id="IDX-CHP-6-0112"/><a name="IDX-CHP-6-0113" class="calibre8" id="IDX-CHP-6-0113"/><a name="IDX-CHP-6-0114" class="calibre8" id="IDX-CHP-6-0114"/><a name="IDX-CHP-6-0115" class="calibre8" id="IDX-CHP-6-0115"/><a name="IDX-CHP-6-0116" class="calibre8" id="IDX-CHP-6-0116"/></p>
<p class="docText1"><a name="of a" class="calibre8" id="of a"/>CUPS is composed of a print spooler, filters, and backends. It uses the Internet Printing Protocol (IPP) to accept print jobs from clients on the network. The print data is then stored in a print spool or queue until the printer is ready to accept a print job. When the printer is ready, CUPS sends the print job through filters that convert the print job data into a language the printer understands. The converted data then travels through a backend to the intended printer. Common backends include Universal Serial Bus (USB) and parallel interfaces.</p>
<p class="docText1"><a name="PostScript was" class="calibre8" id="PostScript was"/>Most printers communicate using either PostScript or Printer Control Language (PCL). PostScript was developed at Adobe Systems in the mid-1980s to create a standard language for both document exchange and printer communication. CUPS can print to virtually all printers that support PostScript. However, PostScript printers are notoriously expensive due to the cost of licensing the technology from Adobe. PCL was created by Hewlett-Packard in 1984 and didn't carry the licensing restrictions of PostScript. This has created a large market of low cost PCL printers. To support this large market, projects like Gimp-Print were started to develop Unix drivers for PCL printers. HP has responded to the need for Unix-based drivers with the Hewlett-Packard Inkjet Driver Project. Gimp-Print and the HP Inkjet Driver Project greatly expand CUPS support for non-PostScript printers.<a name="IDX-CHP-6-0117" class="calibre8" id="IDX-CHP-6-0117"/><a name="IDX-CHP-6-0118" class="calibre8" id="IDX-CHP-6-0118"/><a name="IDX-CHP-6-0119" class="calibre8" id="IDX-CHP-6-0119"/></p>
<p class="docText1"><a name="Michael Sweet" class="calibre8" id="Michael Sweet"/>CUPS was created by Michael Sweet and first released in 1999 by Easy Software Products, a company he co-founded with Andrew Senft. CUPS was originally designed around the 30-year-old Line Printing Daemon (LPD) protocol common in Unix systems. The emergence of IPP ultimately resulted in the switch from the LPD protocol to the more scalable IPP protocol.<a name="IDX-CHP-6-0120" class="calibre8" id="IDX-CHP-6-0120"/><a name="IDX-CHP-6-0121" class="calibre8" id="IDX-CHP-6-0121"/></p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="resources-id5" class="calibre8" id="resources-id5"/>
<h3 class="docSection1Title" id="-100000">6.2. RESOURCES</h3>
<p class="docText1"><span class="b"><a name="CUPS " class="calibre8" id="CUPS "/>CUPS 1.3 User Documentation</span></p>
<p class="docText1"><a class="calibre2" target="_blank" href="http://cups.org/documentation.php">http://cups.org/documentation.php</a></p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="required-id5" class="calibre8" id="required-id5"/>
<h3 class="docSection1Title" id="-100000">6.3. REQUIRED</h3>
<p class="docText1"><img border="0" id="" src="bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg" alt="" class="calibre33"/><a name="FreeBSD " class="calibre8" id="FreeBSD "/> FreeBSD 7.0-RELEASE (see "<a class="calibre2" href="freebsd_7.0_split_000.html#freebsd_7.0">FreeBSD 7.0</a>")<a name="IDX-CHP-6-0122" class="calibre8" id="IDX-CHP-6-0122"/><a name="IDX-CHP-6-0123" class="calibre8" id="IDX-CHP-6-0123"/></p>
<p class="docText1"><img border="0" id="" src="bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg" alt="" class="calibre33"/><a name="collection " class="calibre8" id="collection "/> Updated ports collection (see "<a class="calibre2" href="freebsd_ports_collection.html#freebsd_ports_collection">FreeBSD Ports Collection</a>")</p>
<p class="docText1"><img border="0" id="" src="bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg" alt="" class="calibre33"/> Internet connection</p>
<p class="docText1"><img border="0" id="" src="bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg" alt="" class="calibre33"/><a name="printer " class="calibre8" id="printer "/> Supported parallel or USB printer (see "<a class="calibre2" href="notes-id4.html#printer_types">Printer Types</a>")</p>
<p class="docText1"><img border="0" id="" src="bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg" alt="" class="calibre33"/> Lynx (see "<a class="calibre2" href="lynx_2.8.6.html#lynx_2.8.6">Lynx 2.8.6</a>") or other web browser</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="optional-id3" class="calibre8" id="optional-id3"/>
<h3 class="docSection1Title" id="-100000">6.4. OPTIONAL</h3>
<p class="docText1"><img border="0" id="" src="bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg" alt="" class="calibre33"/><a name="OpenSSL " class="calibre8" id="OpenSSL "/> OpenSSL (see "<a class="calibre2" href="openssl_0.9.8g.html#openssl_0.9.8g">OpenSSL 0.9.8g</a><a name="wish to" class="calibre8" id="wish to"/>") if you wish to enable secure HTTP connections to the web administration interface</p>
<p class="docText1"><img border="0" id="" src="bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg" alt="" class="calibre33"/> Registered domain name</p>
<p class="docText1"><img border="0" id="" src="bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg" alt="" class="calibre33"/> Local Authoritative DNS server (see "<a class="calibre2" href="isc_bind_dns_server_9.4.2.html#isc_bind_dns_server_9.4.2">ISC BIND DNS Server 9.4.2</a><a name="assign the" class="calibre8" id="assign the"/>") if you wish to assign the print server a hostname</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="preparation-id5" class="calibre8" id="preparation-id5"/>
<h3 class="docSection1Title" id="-100000">6.5. PREPARATION</h3>
<p class="docText1"><a name="See " class="calibre8" id="See "/>See "<a class="calibre2" href="notes-id4.html#printer_types">Printer Types</a><a name="on printer" class="calibre8" id="on printer"/>" for information on printer compatibility before proceeding.</p>
<p class="docText1">Become the superuser.</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="install-id5" class="calibre8" id="install-id5"/>
<h3 class="docSection1Title" id="-100000">6.6. INSTALL</h3>
<p class="docText1"><a name="Enter the" class="calibre8" id="Enter the"/>Enter the following commands to begin the CUPS installation process:</p>
<pre class="calibre30"># <b class="calibre28">setenv XORG_UPGRADE yes</b>
# <b class="calibre28">cd /usr/ports/print/cups</b>
# <b class="calibre28">make config ; make install clean</b>
# <b class="calibre28">rehash</b></pre>
<p class="docText1"><a name="will appear" class="calibre8" id="will appear"/>A menu will appear displaying options for cups-base. We will leave these at their defaults, so press [tab] to select <span class="b">OK</span><a name="continue the" class="calibre8" id="continue the"/> and then press [enter] to continue the installation process.</p>
<p class="docText1"><a name="driver configuration" class="calibre8" id="driver configuration"/>A GNU Ghostscript driver configuration menu will also appear (more than 30 minutes into the build process). Leave the selections at their defaults unless you have a specific reason to change them. Press [tab] to select <span class="b">OK</span> and then press [enter] to continue the installation process.</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="configure-id5" class="calibre8" id="configure-id5"/>
<h3 class="docSection1Title" id="-100000">6.7. CONFIGURE</h3>
<p class="docText1"><a name="Once the" class="calibre8" id="Once the"/>Once the installation process is complete, it's time to configure CUPS for use on your system.</p>
<div class="calibre34"><ol class="docList" type="1"><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="a print" class="calibre8" id="a print"/>FreeBSD includes a print spooling system that utilizes the same command names as CUPS. If the search path has not been modified from its default, the FreeBSD spooler will run instead of CUPS. See "<a class="calibre2" href="configure.html#default_search_path">Default Search Path</a><a name="the default" class="calibre8" id="the default"/>" for details on changing the default search path.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1">The phrase <tt class="calibre20">"NO_LPR = YES"</tt><a name="to the" class="calibre8" id="to the"/> must be added to the <span class="docEmphasis1">make.conf</span> file in <span class="docEmphasis1">/etc</span>. This tells the FreeBSD <tt class="calibre20">make</tt><a name="choose to" class="calibre8" id="choose to"/> command to skip compilation of the print spooler if you choose to recompile the base operating system. CUPS can be considered a drop-in replacement for the FreeBSD print spooler. The following commands will add this line to <span class="docEmphasis1">make.conf</span>:</p><pre class="calibre30"># <b class="calibre28">cp /etc/make.conf /etc/make.conf.old</b>
# <b class="calibre28">echo "NO_LPR = YES" &gt;&gt; /etc/make.conf</b></pre>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="print clients" class="calibre8" id="print clients"/>In order to allow print clients to send raw print data to the connected printer you must uncomment a line in the <span class="docEmphasis1">mime.convs</span> file located in <span class="docEmphasis1">/usr/local/etc/cups</span>. Open <span class="docEmphasis1">mime.convs</span> like this:</p><pre class="calibre30"># <b class="calibre28">ee /usr/local/etc/cups/mime.convs</b></pre><br class="calibre1"/>
<p class="docText1">Scroll down to the <tt class="calibre20">application/octet-stream</tt> declaration (~109) and remove the hash mark (<tt class="calibre20">#</tt><a name="as follows" class="calibre8" id="as follows"/>) to uncomment the line. It should now appear as follows:</p><pre class="calibre30">application/octet-stream   application/vnd.cups-raw     0     -</pre><br class="calibre1"/>
<p class="docText1">Save and exit.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="modify the" class="calibre8" id="modify the"/>You are now ready to modify the main configuration file, <span class="docEmphasis1">cupsd.conf</span>, located in <span class="docEmphasis1">/usr/local/etc/cups</span>. To open <span class="docEmphasis1">cupsd.conf</span>, enter:</p><pre class="calibre30"># <b class="calibre28">ee /usr/local/etc/cups/cupsd.conf</b></pre><br class="calibre1"/>
<p class="docText1">Change the <tt class="calibre20">Listen localhost:631</tt> declaration (~18) to <tt class="calibre20">Listen *:631</tt><a name="web administration" class="calibre8" id="web administration"/>. This allows external clients access to the CUPS web administration page. This line should appear as follows after the modification:</p><pre class="calibre30">Listen *:631</pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="and needs" class="calibre8" id="and needs"/>By default, access to CUPS services is restricted and needs to be relaxed to enable printing support to computers on the local network. Change the <tt class="calibre20"><a name="Allow localhost" class="calibre8" id="Allow localhost"/>Allow localhost</tt><a name="the" class="calibre8" id="the"/> declaration (~32) within the <tt class="calibre20">Location /</tt> container to <tt class="calibre20">Allow @LOCAL</tt><a name="as follows" class="calibre8" id="as follows"/>. The line should appear as follows after the modification:</p><pre class="calibre30"># Restrict access to the server...
&lt;Location /&gt;
  Order allow,deny
  <b class="calibre28">Allow @LOCAL</b>
&lt;/Location&gt;</pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="the administrative" class="calibre8" id="the administrative"/>By default, access to the administrative web interface is closed to the local network and can only be accessed from the server itself. To allow access from the local network, change the <tt class="calibre20">Allow localhost</tt> declaration (~39) within the <tt class="calibre20">Location /admin</tt> container to <tt class="calibre20">Allow @LOCAL</tt>. You should also add <tt class="calibre20">Require user @SYSTEM</tt><a name="lines should" class="calibre8" id="lines should"/> to require authentication for access to the web administration page. The lines should appear as follows after the modification:</p><pre class="calibre30"># Restrict access to the admin pages...
&lt;Location /admin&gt;
  Encryption Required
  <b class="calibre28">Require user @SYSTEM</b>
  Order allow,deny
  <b class="calibre28">Allow @LOCAL</b>
&lt;/Location&gt;</pre><br class="calibre1"/>
<hr size="1" noshade="noshade" class="calibre27"/><span><i class="docEmphasis1"><b class="calibre28">Note:</b></i> The root account and users that are members of the wheel group will be able to log in to the web administration page at <a class="calibre2" target="_blank" href="https://host.example.com:631/admin">https://host.example.com:631/admin</a> (substitute your server's hostname or IP address for <a class="calibre2" target="_blank" href="http://host.example.com">host.example.com</a>) to manage printers and print jobs. CUPS will encrypt authentication credentials using a self-signed certificate. You may specify your own SSL Certificate if you like. See "<a class="calibre2" href="notes-id4.html#ssl_certificates">SSL Certificates</a>" for details.</span><hr size="1" noshade="noshade" class="calibre27"/></div></li><li class="calibre16"><div class="calibre35"><p class="docText1">Save and exit.</p></div></li></ol></div>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="testing-id3" class="calibre8" id="testing-id3"/>
<h3 class="docSection1Title" id="-100000">6.8. TESTING</h3>
<p class="docText1"><a name="In this" class="calibre8" id="In this"/>In this section we'll perform some basic tests to confirm that CUPS starts properly before attempting to configure printers.<a name="IDX-CHP-6-0124" class="calibre8" id="IDX-CHP-6-0124"/></p>
<div class="calibre34"><ol class="docList" type="1"><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="CUPS to" class="calibre8" id="CUPS to"/>To configure CUPS to start automatically at system startup, open the <span class="docEmphasis1">rc.conf</span> file located in <span class="docEmphasis1">/etc</span>:</p><pre class="calibre30"># <b class="calibre28">ee /etc/rc.conf</b></pre>
<p class="docText1">then add the following line:</p><pre class="calibre30">cupsd_enable="YES"</pre><br class="calibre1"/>
<p class="docText1"><a name="run the" class="calibre8" id="run the"/>Save your changes and run the startup script:</p><pre class="calibre30"># <b class="calibre28">/usr/local/etc/rc.d/cupsd start</b></pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="by pointing" class="calibre8" id="by pointing"/>Test the server by pointing a web browser to <a class="calibre2" target="_blank" href="http://host.example.com:631">http://host.example.com:631</a> (substituting your server's hostname or IP address for <a class="calibre2" target="_blank" href="http://host.example.com">host.example.com</a><a name="the server" class="calibre8" id="the server"/>). You should see a Common Unix Printing System Welcome! page if the server started successfully; if you don't, check your <span class="docEmphasis1">cupsd.conf</span> file for typographical errors.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="a PostScript" class="calibre8" id="a PostScript"/>If you are using a PostScript printer, have its PPD (PostScript Printer Description) file handy and skip to step 8. If you don't have your printer's PPD file, check <a class="calibre2" target="_blank" href="http://openprinting.org">http://openprinting.org</a>.</p><hr size="1" noshade="noshade" class="calibre27"/><span><i class="docEmphasis1"><b class="calibre28">Note:</b></i> PPD files are usually shipped with the software that came with the printer. You may be able to find them on the manufacturer's website or at <a class="calibre2" target="_blank" href="http://linuxprinting.org">http://linuxprinting.org</a>. CUPS stores these files in the <span class="docEmphasis1">/usr/local/share/cups/model</span> directory.</span><hr size="1" noshade="noshade" class="calibre27"/></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="a non" class="calibre8" id="a non"/>If you are going to be using a non-PostScript printer with CUPS, you will need to install printer drivers. If your printer is supported by either the Gutenprint or HPLIP (Hewlett-Packard Linux Imaging and Printing) driver, proceed to the appropriate section. If your printer is not supported by either of these two drivers, skip to step 7 and specify <span class="docEmphasis1">Raw</span><a name="step " class="calibre8" id="step "/> as the printer make in step 10.<a name="IDX-CHP-6-0125" class="calibre8" id="IDX-CHP-6-0125"/></p></div></li></ol></div>
<a name="gutenprint_driver" class="calibre8" id="gutenprint_driver"/>
<h4 id="title-ID0E2YOM" class="docSection1Title">6.8.1. Gutenprint Driver</h4>
<div class="calibre34"><ol class="docList" type="1" start="continues"><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="printers " class="calibre8" id="printers "/>The Gutenprint driver contains extensive support for Epson printers (among others). Visit <a class="calibre2" target="_blank" href="http://gutenprint.sourceforge.net">http://gutenprint.sourceforge.net</a><a name="following commands" class="calibre8" id="following commands"/> for a complete list of supported printers. The following commands will install the Gutenprint driver from the ports collection (this may take 30 minutes or more to complete):<a name="IDX-CHP-6-0126" class="calibre8" id="IDX-CHP-6-0126"/><a name="IDX-CHP-6-0127" class="calibre8" id="IDX-CHP-6-0127"/><a name="IDX-CHP-6-0128" class="calibre8" id="IDX-CHP-6-0128"/></p><pre class="calibre30"># <b class="calibre28">cd /usr/ports/print/gutenprint</b>
# <b class="calibre28">make install clean</b></pre><br class="calibre1"/>
<p class="docText1"><a name="A menu" class="calibre8" id="A menu"/>A menu will appear containing options for Gutenprint; highlight <span class="b">Gutenprint Cups Drivers</span><a name="to put" class="calibre8" id="to put"/> and press [spacebar] to put a tick in its box. Leave the other options at their defaults: Press [tab] to highlight <span class="b">OK</span><a name="the installation" class="calibre8" id="the installation"/> and then press [enter]. Once the installation is complete, proceed to step 8 below. You may install the HPLIP driver as well, if you wish.</p></div></li></ol></div>
<a name="hplip_driver" class="calibre8" id="hplip_driver"/>
<h4 id="title-ID0ER1OM" class="docSection1Title">6.8.2. HPLIP Driver</h4>
<div class="calibre34"><ol class="docList" type="1" start="continues"><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="Imaging and" class="calibre8" id="Imaging and"/>The HP Linux Imaging and Printing driver was developed at Hewlett-Packard, and it contains support for virtually all HP printers. Visit <a class="calibre2" target="_blank" href="http://hplip.sourceforge.net">http://hplip.sourceforge.net</a><a name="install the" class="calibre8" id="install the"/> for a complete list of supported printers. The following commands will install the HPLIP printer driver from the ports collection (this may take 60 minutes or more to complete):</p><pre class="calibre30"># <b class="calibre28">cd /usr/ports/print/hplip</b>
# <b class="calibre28">make config ; make install clean</b></pre><br class="calibre1"/>
<p class="docText1"><a name="containing options" class="calibre8" id="containing options"/>A menu will appear containing options for HPLIP. Leave them at their defaults: Press [tab] to highlight <span class="b">OK</span> and then press [enter] to continue installation.</p></div></li></ol></div>
<a name="finishing_printer_setup" class="calibre8" id="finishing_printer_setup"/>
<h4 id="title-ID0EX2OM" class="docSection1Title">6.8.3. Finishing Printer Setup</h4>
<div class="calibre34"><ol class="docList" type="1" start="continues"><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="and connected" class="calibre8" id="and connected"/>Ensure that your printer is powered on and connected to the CUPS server via a USB or parallel cable. Reboot the system. Log in as root to the web administration interface <a class="calibre2" target="_blank" href="https://host.example.com:631/admin">https://host.example.com:631/admin</a><a name="for" class="calibre8" id="for"/> (substitute your server's hostname or IP address for <a class="calibre2" target="_blank" href="http://host.example.com">host.example.com</a>).<a name="IDX-CHP-6-0129" class="calibre8" id="IDX-CHP-6-0129"/></p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1">Select <span class="b">Add Printer</span><a name="name down" class="calibre8" id="name down"/>. Choose a name for the connected printer (write this name down; you will need it when you set up client printing). You may enter a location if you wish (e.g., upstairs office). Enter a description of the printer (e.g., HP LaserJet 1100). Click <span class="b">Continue</span>.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="next page" class="calibre8" id="next page"/>There should be a pull-down menu on the next page. Select either USB or LPT (parallel) as appropriate and then click <span class="b">Continue</span>.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="Select the" class="calibre8" id="Select the"/>Select the correct brand (make) of your printer on the next page, then click <span class="b">Continue</span>.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="correct model" class="calibre8" id="correct model"/>Choose the correct model from the list presented on the next page, then click <span class="b">Continue</span>.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="ready to" class="calibre8" id="ready to"/>Your printer should be ready to accept print jobs. You can print a test page from the Printers page of the CUPS web interface.</p></div></li></ol></div>
<p class="docText1"><a name="appropriate section" class="calibre8" id="appropriate section"/>Proceed to the appropriate section to set up client printing.</p>
<p class="docText1"><span class="b">Printing from Windows XP</span></p>
<div class="calibre34"><ol class="docList" type="1"><li class="calibre16"><div class="calibre35"><p class="docText1">To print to a CUPS printer from Windows XP, click the <span class="b">Start</span> menu and select <span class="b">Control Panel</span>.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1">Double-click the Printers and Faxes icon.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1">Click <span class="b">Add a Printer</span><a name="Add Printer" class="calibre8" id="Add Printer"/> at the left side of the window. The Welcome to the Add Printer Wizard dialog will appear; click <span class="b">Next</span>.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1">Click the <span class="docEmphasis1">Network Printer</span> radio button, then click <span class="b">Next</span>.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1">Click the <span class="docEmphasis1"><a name="on the" class="calibre8" id="on the"/>Connect to a Printer on the Internet or on a Home or Office Network</span><a name="syntax to" class="calibre8" id="syntax to"/> radio button. In the URL field, use the following syntax to specify the server address: <a class="calibre2" target="_blank" href="http://host.example.com:631/printers/printername">http://host.example.com:631/printers/printername</a><a name="of your" class="calibre8" id="of your"/> (substitute the hostname or IP address of your CUPS server for <a class="calibre2" target="_blank" href="http://host.example.com">host.example.com</a> and replace <span class="docEmphasis1">printername</span><a name="the CUPS" class="calibre8" id="the CUPS"/> with the name you assigned the printer during the CUPS printer setup).</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1">After clicking <span class="b">Next</span><a name="printer make" class="calibre8" id="printer make"/>, you will be required to select the printer make and model from a list. If you have a Windows driver from the manufacturer, use it; otherwise select it from the given list and click <span class="b">OK</span>.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="You should" class="calibre8" id="You should"/>You should be able to print via the CUPS print server from Windows applications.</p></div></li></ol></div>
<p class="docText1"><span class="b"><a name="Mac OS" class="calibre8" id="Mac OS"/>Printing from Mac OS X</span></p>
<div class="calibre34"><ol class="docList" type="1"><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="of printing" class="calibre8" id="of printing"/>Open an application capable of printing (e.g., Safari).</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1">In the <span class="b">File</span> menu, select <span class="b">Print</span>.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1">Select the <span class="b">Printer</span><a name="a list" class="calibre8" id="a list"/> pull-down menu to display a list of available printers. You should see Shared Printers in the lower half of the menu.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1">Hover the mouse over <span class="b">Shared Printers</span> to display the submenu.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="will be" class="calibre8" id="will be"/>Select the appropriate CUPS printer from the list. The CUPS printer will be added to your permanent list of printers.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="current document" class="calibre8" id="current document"/>You can print the current document by clicking <span class="b">Print</span> on the lower-right side of the dialog box.</p></div></li></ol></div>
<p class="docText1"><span class="b">Printing from the FreeBSD Command Line</span></p>
<p class="docText1"><a name="file to" class="calibre8" id="file to"/>You can print the contents of a file to the CUPS-configured printer at the FreeBSD command line with the following command:</p>
<pre class="calibre30"># <b class="calibre28">lp -d</b> <span class="docEmphBoldItalic">printername filename</span></pre><br class="calibre1"/>
<p class="docText1">Replace <tt class="calibre20"><i class="docEmphasis1">printername</i></tt><a name="CUPS printer" class="calibre8" id="CUPS printer"/> with the name of the CUPS printer you'd like to print to. Replace <tt class="calibre20"><i class="docEmphasis1">filename</i></tt><a name="you wish" class="calibre8" id="you wish"/> with the path and filename of the file you wish to print.</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="administration" class="calibre8" id="administration"/>
<h3 class="docSection1Title" id="-100000">6.9. ADMINISTRATION</h3>
<p class="docText1"><a name="To administer" class="calibre8" id="To administer"/>To administer CUPS, enter one of the following URLs, replacing <a class="calibre2" target="_blank" href="http://host.example.com">host.example.com</a><a name="hostname or" class="calibre8" id="hostname or"/> with your hostname or CUPS server IP address.<a name="IDX-CHP-6-0130" class="calibre8" id="IDX-CHP-6-0130"/><a name="IDX-CHP-6-0131" class="calibre8" id="IDX-CHP-6-0131"/><a name="IDX-CHP-6-0132" class="calibre8" id="IDX-CHP-6-0132"/><a name="IDX-CHP-6-0133" class="calibre8" id="IDX-CHP-6-0133"/></p>
<p class="docText1"><a class="calibre2" target="_blank" href="http://host.example.com:631">http://host.example.com:631</a> (printer and print job status)</p>
<p class="docText1"><a class="calibre2" target="_blank" href="https://host.example.com:631/admin">https://host.example.com:631/admin</a> (CUPS administration over SSL)</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="config_files-id5" class="calibre8" id="config_files-id5"/>
<h3 class="docSection1Title" id="-100000">6.10. CONFIG FILES</h3>
<p class="docText1"><span class="b">/usr/local/etc/cups/cupsd.conf</span></p>
<p class="docText1"><a name="The main" class="calibre8" id="The main"/>The main configuration file of the CUPS print server</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="log_files-id3" class="calibre8" id="log_files-id3"/>
<h3 class="docSection1Title" id="-100000">6.11. LOG FILES</h3>
<p class="docText1"><span class="b">/var/log/cups/access_log</span></p>
<p class="docText1"><a name="Contains IP" class="calibre8" id="Contains IP"/>Contains IP addresses, times, and activity on the CUPS web interface</p>
<p class="docText1"><span class="b">/var/log/cups/error_log</span></p>
<p class="docText1"><a name="and status" class="calibre8" id="and status"/>Contains error and status messages produced by the CUPS print server</p>
<p class="docText1"><span class="b">/var/log/cups/page_log</span></p>
<p class="docText1"><a name="who printed" class="calibre8" id="who printed"/>Contains a log of printers, who printed to them, when, number of pages, and their IP addresses</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="notes-id4" class="calibre8" id="notes-id4"/>
<h3 class="docSection1Title" id="-100000">6.12. NOTES</h3>
<p class="docText1"><a name="The following" class="calibre8" id="The following"/>The following sections include a brief explanation of the two general classes of printers, some options for printing restrictions, and coverage of SSL Certificates and the lptcontrol utility.</p>
<a name="printer_types" class="calibre8" id="printer_types"/>
<h4 id="title-ID0EZXOM" class="docSection1Title">6.12.1. Printer Types</h4>
<p class="docText1"><a name="categories of" class="calibre8" id="categories of"/>In general, two categories of printers exist, PostScript and PCL. PostScript is an industry-standard page description language. The language was developed by Adobe Systems in the mid-1980s to allow the sharing of electronic documents while preserving formatting and appearance. It is similar to the PDF (Portable Document Format), also developed by Adobe. PostScript printers are usually more expensive than non-PostScript printers. High-end business laser printers usually include PostScript support. PCL printers include most consumer-oriented inkjet and laser printers. Most low-cost printers do not support the PostScript language. This means drivers must be installed that are specific to the make and model of the printer. Finding and installing drivers compatible with the CUPS system can be a challenging task. This guide provides installation instructions for the Gutenprint and HPLIP drivers. Many popular consumer printers are covered by at least one of these two drivers.</p>
<p class="docText1"><a name="native support" class="calibre8" id="native support"/>The CUPS system contains native support for virtually all PostScript printers provided you have the matching PostScript Printer Description file for the printer. The PPD file is usually included with the software that is bundled with the printer. Many PPD files are also freely available at <a class="calibre2" target="_blank" href="http://linuxprinting.org">http://linuxprinting.org</a>.</p>
<p class="docText1"><a name="an Epson" class="calibre8" id="an Epson"/>If you own an Epson, Canon, Lexmark, or other PCL-based printer, check <a class="calibre2" target="_blank" href="http://gutenprint.sourceforge.net">http://gutenprint.sourceforge.net</a><a name="If you" class="calibre8" id="If you"/> to see if your printer is supported by the Gutenprint driver. If you own an HP printer, check <a class="calibre2" target="_blank" href="http://hplip.sourceforge.net">http://hplip.sourceforge.net</a><a name="printer is" class="calibre8" id="printer is"/> to see if your printer is supported by the HPLIP driver. If your printer is from another manufacturer, check <a class="calibre2" target="_blank" href="http://linuxprinting.org">http://linuxprinting.org</a><a name="by another" class="calibre8" id="by another"/> to see if your printer is supported by another CUPS-compatible driver.</p>
<p class="docText1"><a name="supported by" class="calibre8" id="supported by"/>If your printer is not supported by a CUPS-compatible driver, you may still print to it using the CUPS server, provided:</p>
<ul class="calibre15"><li class="calibre16"><p class="docText1">All intended print clients are running Microsoft Windows</p></li><li class="calibre16"><p class="docText1">A Windows-compatible printer driver is available on each system</p></li></ul>
<p class="docText1"><a name="to send" class="calibre8" id="to send"/>This is possible because CUPS has the capability to send raw data to the connected printer. The Windows driver sends the data to be printed in the correct printer language; CUPS then relays this data to the connected printer.</p>
<p class="docText1"><a name="to the" class="calibre8" id="to the"/>To configure CUPS to send raw data to the connected printer, select <span class="b">Raw</span><a name="when specifying" class="calibre8" id="when specifying"/> when specifying the printer make in step 10 of "Testing" (page 56). Complete the rest of the guide normally.</p>
<a name="printing_restrictions" class="calibre8" id="printing_restrictions"/>
<h4 id="title-ID0ELZOM" class="docSection1Title">6.12.2. Printing Restrictions</h4>
<p class="docText1"><a name="printing may" class="calibre8" id="printing may"/>Restrictions to printing may be enforced with authentication and/or access rules based on client IP address. For example, to restrict printing to authenticated users only, add the lines below to the end of the <span class="docEmphasis1">cupsd.conf</span> file in <span class="docEmphasis1">/usr/local/etc/cups</span>. To open <span class="docEmphasis1">cupsd.conf</span>, enter:</p>
<pre class="calibre30"># <b class="calibre28">ee /usr/local/etc/cups/cupsd.conf</b></pre>
<p class="docText1"><a name="bottom of" class="calibre8" id="bottom of"/>Scroll down to the bottom of the <span class="docEmphasis1">cupsd.conf</span><a name="add the" class="calibre8" id="add the"/> file using [ctrl-U] and add the following lines:</p>
<pre class="calibre30">&lt;Location /printers&gt;
AuthType Basic
AuthClass User
&lt;/Location&gt;</pre><br class="calibre1"/>
<p class="docText1">Save and exit.</p>
<p class="docText1"><a name="a username" class="calibre8" id="a username"/>With these settings in place, users will be required to provide a username and password to send jobs to any printer.</p>
<hr size="1" noshade="noshade" class="calibre27"/><span><i class="docEmphasis1"><b class="calibre28">Note:</b></i> Users must have their own system-level account to authenticate. Username and password information is sent in the clear; consider using access rules if you do not want authentication information sent insecurely over the network.</span><hr size="1" noshade="noshade" class="calibre27"/>
<p class="docText1"><a name="used to" class="calibre8" id="used to"/>Access rules may be used to allow access to printers based on a client's originating IP address. For example, to restrict printing to IP addresses 192.168.0.1 and 192.168.0.2 only, add the lines below to the end of the <span class="docEmphasis1">cupsd.conf</span> file in <span class="docEmphasis1">/usr/local/etc/cups</span>. To open <span class="docEmphasis1">cupsd.conf</span> enter:</p>
<pre class="calibre30"># <b class="calibre28">ee /usr/local/etc/cups/cupsd.conf</b></pre><br class="calibre1"/>
<p class="docText1">Scroll down to the bottom of the <span class="docEmphasis1">cupsd.conf</span> file using [ctrl-U] and add the following lines:</p>
<pre class="calibre30">&lt;Location /printers&gt;
Order Deny,Allow
Deny From All
Allow From 192.168.0.1
Allow From 192.168.0.2
&lt;/Location&gt;</pre><br class="calibre1"/>
<p class="docText1">Save and exit.</p>
<p class="docText1"><a name="very basic" class="calibre8" id="very basic"/>The aforementioned methods of print restrictions are very basic. If you need more functionality or flexibility, consider using Samba to manage print privileges. See "<a class="calibre2" href="samba_3.0.28.html#samba_3.0.28">Samba 3.0.28</a>" for more information.</p>
<a name="ssl_certificates" class="calibre8" id="ssl_certificates"/>
<h4 id="title-ID0EZ2OM" class="docSection1Title">6.12.3. SSL Certificates</h4>
<p class="docText1"><a name="SSL Certificate" class="calibre8" id="SSL Certificate"/>You can use an existing SSL Certificate with CUPS instead of the self-signed certificate CUPS generates for use with the secure web administration interface. Add the following lines to <span class="docEmphasis1">cupsd.conf</span> in <span class="docEmphasis1">/usr/local/etc/cups</span><a name="and key" class="calibre8" id="and key"/>. Substitute the path- and filenames of your server certificate and key files.</p>
<div class="calibre1">
              Code View:</div><pre class="calibre30"><b class="calibre28">ServerCertificate /usr/local/openssl/certs/ </b><span class="docEmphBoldItalic">host.example.com-cert.pem</span>
<b class="calibre28">ServerKey /usr/local/openssl/certs/ </b><span class="docEmphBoldItalic">host.example.com-unencrypted-key.pem</span>
<i class="docEmphasis1">host.example.com-cert.pem </i> is the server's public SSL Certificate file.
<i class="docEmphasis1">host.example.com-unencrypted-key.pem </i> is the server's private unencrypted key file.

					  </pre><br class="calibre1"/>
<a name="lptcontrol" class="calibre8" id="lptcontrol"/>
<h4 id="title-ID0EY3OM" class="docSection1Title">6.12.4. lptcontrol</h4>
<p class="docText1"><a name="printer driver" class="calibre8" id="printer driver"/>The lptcontrol utility controls how the LPT printer driver sends data to the printer. This does not apply to USB printers. By default, the LPT printer driver uses interrupt-driven mode. This works satisfactorily with most printers. Some printers, however, exhibit problems with this mode. If you experience slower than typical print times, you might try changing the default interrupt-driven mode to polling mode with the following command:</p>
<pre class="calibre30"># <b class="calibre28">lptcontrol -p -d /dev/lpt0</b></pre><br class="calibre1"/>
<p class="docText1"><a name="You may" class="calibre8" id="You may"/>You may add this line to <span class="docEmphasis1">/etc/rc.local</span><a name="set LPT" class="calibre8" id="set LPT"/> to automatically set LPT port polling mode at boot time, if necessary.</p>
</div></div>

</body></html>