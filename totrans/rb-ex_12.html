<html><head></head><body><div class="chapter" title="Chapter&#xA0;12.&#xA0;RubyGems and Rails Preparation"><div class="titlepage"><div><div><h1 class="title"><a id="rubygems_and_rails_preparation"/>Chapter 12. RubyGems and Rails Preparation</h1></div></div></div><div class="informalfigure"><div class="mediaobject"><a id="I_mediaobject12_d1e19997"/><img alt="image with no caption" src="httpatomoreillycomsourcenostarchimages686190.png.jpg"/></div></div><p>In this chapter, we’ll discuss Ruby’s package-management system, <a class="indexterm" id="idx-CHP-12-1131"/>RubyGems, as well as Ruby’s most prominent web development framework, Rails. These somewhat disparate subjects are lumped together because the “canonical” way to install Rails is with the RubyGems software. By the end of this chapter, you will be able to install Rails via RubyGems and understand the basic structure and purpose of the files that make up a Rails application.</p><div class="sect1" title="RubyGems"><div class="titlepage"><div><div><h1 class="title"><a id="rubygems"/>RubyGems</h1></div></div></div><p>Good operating systems have good package-management systems—software that can keep track of the other software needed or provided by that operating system and make sure everything stays up to date. Mac OS X has Software Update, Windows has Windows Update, and the various flavors of GNU/Linux have programs like RPM, YUM, and my favorite, APT. Good programming languages have similar programs that give programmers and other users access to vast <a class="indexterm" id="idx-CHP-12-1132"/>libraries of software written in that language. Perl has the <a class="indexterm" id="idx-CHP-12-1133"/>Comprehensive Perl Archive Network (<a class="ulink" href="http://cpan.org">http://cpan.org</a>), Python has the <a class="indexterm" id="idx-CHP-12-1134"/>Cheese Shop (<a class="ulink" href="http://cheeseshop.python.org/pypi">http://cheeseshop.python.org/pypi</a>), and Ruby has <a class="indexterm" id="idx-CHP-12-1135"/>RubyGems (<a class="ulink" href="http://rubygems.org">http://rubygems.org</a>).</p><div class="note" title="Note"><h3 class="title"><a id="note-63"/>Note</h3><p><span class="emphasis"><em>The most up-to-date RubyGems information is available at <a class="ulink" href="http://docs.rubygems.org">http://docs.rubygems.org</a>. This chapter is intended to give you a basic introduction and help you get Rails up and running. If you find your curiosity piqued about RubyGems (as I hope you will), I highly recommend making <a class="ulink" href="http://docs.rubygems.org">http://docs.rubygems.org</a> one of your regular stops on the Web</em></span>.<a class="indexterm" id="idx-CHP-12-1136"/></p></div><p>RubyGems has already become the de facto method of creating stand-alone Ruby software (especially libraries and programmer utilities) for use by others in the Ruby community. With this system, you can easily use other programmers’ software to make your job easier, and you can also share your own work, likely making some other programmer’s job easier. Each bundle of software that is packaged together as a single unit via RubyGems is called a <span class="emphasis"><em>gem</em></span>, and users are able to manipulate such <a class="indexterm" id="idx-CHP-12-1137"/>gems with the appropriately named <code class="literal">gem</code> command.</p><div class="sect2" title="Installing RubyGems"><div class="titlepage"><div><div><h2 class="title"><a id="installing_rubygems"/>Installing RubyGems</h2></div></div></div><p>You will want to browse to <a class="ulink" href="http://rubyforge.org/frs/?group_id=126">http://rubyforge.org/frs/?group_id=126</a> to download the most recent version of RubyGems. Files are provided in both TGZ and Zip formats, as well as gem files (for updating after you already have RubyGems installed) and patch files. For this example, I’ve downloaded <code class="literal">rubygems-0.9.2.tgz</code>. Uncompress the downloaded file, and use the command <code class="literal">ruby setup.rb</code> to run the <code class="literal">setup.rb</code> program found inside the newly created directory. You’ll probably have to do this as the root user (if applicable to your operating system). You can type <code class="literal">gem -v</code> to see which version of RubyGems you now have installed on your system.<a class="indexterm" id="idx-CHP-12-1138"/><a class="indexterm" id="idx-CHP-12-1139"/></p></div><div class="sect2" title="Using RubyGems"><div class="titlepage"><div><div><h2 class="title"><a id="using_rubygems"/>Using RubyGems</h2></div></div></div><p>If you run <code class="literal">gem</code> with no arguments, it should return something similar to this:</p><a id="I_programlisting12_d1e20100"/><pre class="programlisting">RubyGems is a sophisticated package manager for Ruby.  This is
a basic help message containing pointers to more information.

  Usage:
    gem -h/--help
    gem -v/--version
    <a class="indexterm" id="idx-CHP-12-1140"/>gem command [arguments...] [options...]

  Examples:
    gem install rake
    gem list --local
    gem build package.gemspec
    gem help install

  Further help:
    <a class="indexterm" id="idx-CHP-12-1141"/>gem help commands            list all 'gem' commands
    gem help examples            show some examples of usage
    gem help &lt;COMMAND&gt;           show help on COMMAND
                                   (e.g. 'gem help install')
  Further information:
    http://<a class="indexterm" id="idx-CHP-12-1142"/>rubygems.rubyforge.org</pre><div class="sect3" title="Listing Installed and Installable Gems"><div class="titlepage"><div><div><h3 class="title"><a id="listing_installed_and_installable_gems"/>Listing Installed and Installable Gems</h3></div></div></div><p>By executing <code class="literal">gem list --local</code>, you can see which gems are already installed on your system. Here is the result of running <code class="literal">gem list --local</code> immediately after <a class="indexterm" id="idx-CHP-12-1143"/>installing RubyGems on my machine:<a class="indexterm" id="idx-CHP-12-1144"/><a class="indexterm" id="idx-CHP-12-1145"/></p><a id="I_programlisting12_d1e20141"/><pre class="programlisting">*** LOCAL GEMS ***

sources (0.0.1)
    This package provides download sources for remote gem installation</pre><p>The <code class="literal">sources</code> gem makes it possible for you to install other gems by maintaining retrieval information about them. We can query that information via <code class="literal">gem query --remote</code>, which outputs a very long list of available gems, shown here in highly truncated form:<a class="indexterm" id="idx-CHP-12-1146"/></p><a id="I_programlisting12_d1e20156"/><pre class="programlisting">*** REMOTE GEMS ***

abstract (1.0.0)
    a library which enable you to define abstract method in Ruby

ackbar (0.1.1, 0.1.0)
    ActiveRecord KirbyBase Adapter

action_profiler (1.0.0)
    A profiler for Rails controllers</pre></div><div class="sect3" title="Installing Gems"><div class="titlepage"><div><div><h3 class="title"><a id="installing_gems"/>Installing Gems</h3></div></div></div><p>Each individual gem is installable via the command <code class="literal">gem install --remote</code> <em class="replaceable"><code>some_gem_name</code></em>. As an example, let’s install the <code class="literal">rails</code> gem with <code class="literal">gem install --remote rails</code>.<a class="indexterm" id="idx-CHP-12-1147"/><a class="indexterm" id="I_indexterm12_d1e20180"/></p><a id="I_programlisting12_d1e20183"/><pre class="programlisting">Install required dependency rake? [Yn]
Install required dependency activesupport? [Yn]
Install required dependency activerecord? [Yn]
Install required dependency actionpack? [Yn]
Install required dependency actionmailer? [Yn]
Install required dependency actionwebservice? [Yn]
Successfully installed rails-1.2.2
Successfully installed rake-0.7.1
Successfully installed activesupport-1.4.1
Successfully installed activerecord-1.15.2
Successfully installed actionpack-1.13.2
Successfully installed actionmailer-1.3.2
Successfully installed actionwebservice-1.2.2
<a class="indexterm" id="idx-CHP-12-1148"/>Installing ri <a class="indexterm" id="idx-CHP-12-1149"/>documentation for rake-0.7.1...
Installing ri documentation for activesupport-1.4.1...
Installing ri documentation for activerecord-1.15.2...
Installing ri documentation for actionpack-1.13.2...
Installing ri documentation for actionmailer-1.3.2...
Installing ri documentation for actionwebservice-1.2.2...
Installing <a class="indexterm" id="idx-CHP-12-1150"/>RDoc documentation for rake-0.7.1...
Installing RDoc documentation for activesupport-1.4.1...
Installing RDoc documentation for activerecord-1.15.2...
Installing RDoc documentation for actionpack-1.13.2...
Installing RDoc documentation for actionmailer-1.3.2...
Installing RDoc documentation for actionwebservice-1.2.2...</pre><p>I answered <code class="literal">Y</code> to all requests for confirmation. You can see that the <a class="indexterm" id="idx-CHP-12-1151"/>RubyGems system is intelligent enough to know which gems are required by other gems, and it will install your requested gem’s dependencies automatically. We now have a functioning Rails system, which we’ll explore in the next chapter.</p><div class="note" title="Note"><h3 class="title"><a id="note-64"/>Note</h3><p><span class="emphasis"><em>At the time of my installation, there were some minor warnings related to <em class="replaceable"><code>actionpack</code></em>’s ri and RDoc documentation. They had no impact on the functioning of the code and may be out of date by the time you read this book, so I have omitted them from the output examples in this chapter</em></span>.<a class="indexterm" id="idx-CHP-12-1152"/></p></div></div><div class="sect3" title="Updating Gems"><div class="titlepage"><div><div><h3 class="title"><a id="updating_gems"/>Updating Gems</h3></div></div></div><p>You can update gems already present on your system with the <code class="literal">gem update</code> command. A good precursor is to query whether any gems need updating with <code class="literal">gem outdated</code>. I ran this command on one of my systems that had some out-of-date gems and I got the following results:<a class="indexterm" id="idx-CHP-12-1153"/><a class="indexterm" id="idx-CHP-12-1154"/></p><a id="I_programlisting12_d1e20240"/><pre class="programlisting">Bulk updating Gem source index for: http://gems.rubyforge.org
activerecord (1.15.1 &lt; 1.15.2)
rails (1.2.1 &lt; 1.2.2)
actionwebservice (1.2.1 &lt; 1.2.2)
rubygems-update (0.9.1 &lt; 0.9.2)
actionpack (1.13.1 &lt; 1.13.2)
actionmailer (1.3.1 &lt; 1.3.2)
activesupport (1.4.0 &lt; 1.4.1)</pre><p>Updating the gems with <code class="literal">gem update rails</code> (as root) produced this output:<a class="indexterm" id="idx-CHP-12-1155"/><a class="indexterm" id="I_indexterm12_d1e20252"/></p><a id="I_programlisting12_d1e20257"/><pre class="programlisting">Updating installed gems...
Bulk updating Gem source index for: http://gems.rubyforge.org
Attempting remote update of rails
Install required dependency activesupport? [Yn]
Install required dependency activerecord? [Yn]
Install required dependency actionpack? [Yn]
Install required dependency actionmailer? [Yn]
Install required dependency actionwebservice? [Yn]
Successfully installed rails-1.2.2
Successfully installed activesupport-1.4.1
Successfully installed activerecord-1.15.2
Successfully installed actionpack-1.13.2
Successfully installed actionmailer-1.3.2
Successfully installed actionwebservice-1.2.2
Installing ri documentation for activesupport-1.4.1...
Installing ri documentation for activerecord-1.15.2...
Installing ri documentation for actionpack-1.13.2...
Installing ri documentation for actionmailer-1.3.2...
Installing ri documentation for actionwebservice-1.2.2...
Installing RDoc documentation for activesupport-1.4.1...
Installing RDoc documentation for activerecord-1.15.2...
Installing RDoc documentation for actionpack-1.13.2...
Installing RDoc documentation for actionmailer-1.3.2...
Installing RDoc documentation for actionwebservice-1.2.2...
Gems: [<a class="indexterm" id="idx-CHP-12-1156"/>rails] updated</pre><p>I specifically chose <code class="literal">rails</code> as the <a class="indexterm" id="idx-CHP-12-1157"/>gem to be updated because it is a gem with many dependencies, as we learned when installing it for the first time. Therefore, <a class="indexterm" id="idx-CHP-12-1158"/>updating it shows how dependencies are automatically updated along with the requested gem. Rails depends on <a class="indexterm" id="idx-CHP-12-1159"/>Active Record (a software package that provides sophisticated database access tools), so updating the <code class="literal">rails</code> gem also automatically updates the <code class="literal">activerecord</code> gem, as you can see in the update session results above. All other <code class="literal">rails</code> dependencies are updated in a similar manner.</p><div class="note" title="Note"><h3 class="title"><a id="note-65"/>Note</h3><p><span class="emphasis"><em>After updating your gems, you probably want to execute <em class="replaceable"><code>rake rails:update</code></em> within each of your Rails application directories. This ensures that any application files you have already generated will be updated to account for the change in gems, as well</em></span>.<a class="indexterm" id="idx-CHP-12-1160"/></p></div></div><div class="sect3" title="Learning More About RubyGems"><div class="titlepage"><div><div><h3 class="title"><a id="learning_more_about_rubygems"/>Learning More About RubyGems</h3></div></div></div><p>You can always learn more about the <code class="literal">gem</code> command as it exists on your own machine with <code class="literal">gem help</code> and <code class="literal">gem help</code> <em class="replaceable"><code>some_specific_command</code></em>. This information will always be up to date and specific to your system.<a class="indexterm" id="idx-CHP-12-1161"/><a class="indexterm" id="idx-CHP-12-1162"/><a class="indexterm" id="I_indexterm12_d1e20331"/><a class="indexterm" id="I_indexterm12_d1e20334"/><a class="indexterm" id="I_indexterm12_d1e20339"/></p></div></div></div></div>
<div class="sect1" title="Rails Preparation"><div class="titlepage"><div><div><h1 class="title"><a id="rails_preparation"/>Rails Preparation</h1></div></div></div><p>You should now know enough about RubyGems to have used it to install Rails. The rest of this chapter will familiarize you enough with Rails that you can start creating a Rails application in the next chapter. This book introduces Rails (with a focus on general design philosophy, rather than an exhaustive list of the API), but it would be silly to think that a few chapters could give Rails the attention it deserves. The definitive text on Rails is <em class="citetitle">Agile Web Development with Rails</em>, now in its second edition, by Dave <a class="indexterm" id="idx-CHP-12-1163"/>Thomas, David Heinemeier <a class="indexterm" id="idx-CHP-12-1164"/>Hansson (creator of Rails), and others (Pragmatic Bookshelf, 2006). Other members of the Rails community also give high praise to <a class="indexterm" id="idx-CHP-12-1165"/><em class="citetitle">Ruby for Rails</em> by David Alan <a class="indexterm" id="idx-CHP-12-1166"/>Black (Manning Publications, 2006).</p><div class="sect2" title="What Is Rails?"><div class="titlepage"><div><div><h2 class="title"><a id="what_is_rails"/>What Is Rails?</h2></div></div></div><p>According to its website (<a class="ulink" href="http://rubyonrails.org">http://rubyonrails.org</a>), Rails is “an open-source web framework that’s optimized for programmer happiness and sustainable productivity. It lets you write beautiful code by favoring convention over configuration.” The site describes it as “Web development that doesn’t hurt.” What does that mean?<a class="indexterm" id="idx-CHP-12-1167"/></p><p>Since it optimizes for programmer happiness and focuses on the ability to write beautiful code, Rails is well within the design philosophy of Ruby itself. Rails picks sensible defaults for its behavior, and as long as you are willing to follow those conventions, your job as the programmer becomes relatively easy. Rails provides shortcuts and tools for you to generate a skeleton of a web application very quickly; it allows you to place each piece of code in a reasonable location within the directory structure that is appropriate to the job that code is expected to perform. This provides clean, well-ordered, reusable code that helps you develop an application quickly, efficiently, and painlessly.</p></div><div class="sect2" title="Other Options for Installing Rails"><div class="titlepage"><div><div><h2 class="title"><a id="other_options_for_installing_rails"/>Other Options for Installing Rails</h2></div></div></div><p>Using RubyGems isn’t the only way to install Rails. There are several other options that you may want to use, for example, if you haven’t been following along with the text, or if you simply wish to install Rails via some other method. It should be noted, however, that installation as a gem is the recommended way to install Rails.<a class="indexterm" id="idx-CHP-12-1168"/><a class="indexterm" id="idx-CHP-12-1169"/></p><div class="sect3" title="Via Operating System Package Manager"><div class="titlepage"><div><div><h3 class="title"><a id="via_operating_system_package_manager"/>Via Operating System Package Manager</h3></div></div></div><p>Some operating systems’ package managers, such as APT, provide Rails as an installable package. For example, on my Ubuntu system, the command <code class="literal">apt-cache search rails</code> shows (among other packages) this result:<a class="indexterm" id="idx-CHP-12-1170"/></p><a id="I_programlisting12_d1e20406"/><pre class="programlisting">rails - MVC ruby based framework geared for web application development</pre><p>If you want to use Rails, but you don’t need the most recent bleeding-edge version, and you want to avoid installing RubyGems (for whatever reason), this option may work well for you.</p></div><div class="sect3" title="From Source"><div class="titlepage"><div><div><h3 class="title"><a id="from_source"/>From Source</h3></div></div></div><p>As with any free or open source software, there is always the option to install from source. You can browse to <a class="ulink" href="http://rubyonrails.org/down">http://rubyonrails.org/down</a> for the most recent recommended source tarball.<a class="indexterm" id="idx-CHP-12-1171"/></p></div><div class="sect3" title="Pre-Packaged"><div class="titlepage"><div><div><h3 class="title"><a id="pre-packaged"/>Pre-Packaged</h3></div></div></div><p>There are also some pre-packaged versions of Rails available. For Windows, there is <a class="indexterm" id="idx-CHP-12-1172"/>Instant Rails (<a class="ulink" href="http://instantrails.rubyforge.org">http://instantrails.rubyforge.org</a>), and for Mac OS X, there’s <a class="indexterm" id="idx-CHP-12-1173"/>Locomotive (<a class="ulink" href="http://locomotive.sourceforge.net">http://locomotive.sourceforge.net</a>). Either of these pieces of software can get you up and running with Rails. Note that there may be subtle differences in configuration between these packages and the default <a class="indexterm" id="idx-CHP-12-1174"/>Rails setup. Consulting the website for your chosen pre-packaged <a class="indexterm" id="idx-CHP-12-1175"/>application is probably your best bet when encountering such a situation.</p></div></div><div class="sect2" title="Databases"><div class="titlepage"><div><div><h2 class="title"><a id="databases"/>Databases</h2></div></div></div><p>Rails needs to have access to a database program to function properly. Generally, that database is <a class="indexterm" id="idx-CHP-12-1176"/>MySQL (<a class="ulink" href="http://mysql.com">http://mysql.com</a>), although other options are possible. If you’re installing via gems or through your operating system’s package manager, you should install MySQL. This is probably easiest to do through your operating system’s package manager. The pre-packaged Rails installers like Instant Rails and Locomotive generally come with their own pre-configured databases; however, for all subsequent examples, I’ll assume you installed Rails as a gem and you’re using MySQL.<a class="indexterm" id="idx-CHP-12-1177"/></p></div><div class="sect2" title="The Structure of a Rails Application"><div class="titlepage"><div><div><h2 class="title"><a id="the_structure_of_a_rails_application"/>The Structure of a Rails Application</h2></div></div></div><p>Rails operates under a design philosophy (or <span class="emphasis"><em>pattern</em></span>) for software called <a class="indexterm" id="idx-CHP-12-1178"/>Model-View-Controller (MVC), developed by Norwegian computer scientist Trygve <a class="indexterm" id="idx-CHP-12-1179"/>Reenskaug<sup>[<a class="footnote" href="#ftn.CHP-12-FNOTE-1" id="CHP-12-FNOTE-1">35</a>]</sup> while he was working at Xerox PARC in the late 1970s. It was originally developed in relation to traditional graphical user interfaces (GUIs), but MVC has recently become very popular in web development. The basics of this pattern are as follows. The <span class="emphasis"><em>Model</em></span> represents the data and is an object of some sort. The <span class="emphasis"><em>View</em></span> is a way of presenting data, whether directly to a user or to some other computer, or as any other type of output. The <span class="emphasis"><em>Controller</em></span> is the traffic cop or manager that keeps track of any requested actions, queries or manipulates the Model to get or update data, and gives the View whatever information it needs to format the data as necessary.</p><p>Let’s consider an example to help explain this pattern. Back in our second currency conversion script (<a class="xref" href="ch05s05.html" title="#19 Currency Conversion, Advanced (currency_converter2.rb)">#19 Currency Conversion, Advanced (currency_converter2.rb)</a> on page 90), we used data retrieved from an RSS feed. In MVC terms, that data is the Model. That same data could have been presented (or Viewed) on a traditional HTML web page, as a plaintext file for download, or as a YAML file. In all of these different examples, the Model would stay the same and would be something like ExchangeRate or CurrencyUnit, depending on how the application was designed. The Controller would also be the same, and it would be responsible for retrieving the data from a server. We’d probably call it the Download Controller, since it would be used to download data from a server.</p><p>For the sake of argument, let’s say that we also wanted to present our Model in some completely different way, perhaps written down on paper. The written piece of paper would use a different Controller, one that deals with paper instead of servers. Perhaps we’d call it the Pencil Controller. The View would also be different in each of these examples: RSS, HTML, ASCII, WrittenOnAPieceOfPaper, and so on. These are all simply different ways of presenting the same data, which is the Model. For example, our Rails application in the next chapter has Views for both HTML and RSS display of photographs and related information.</p><div class="sect3" title="Generating a Rails Application"><div class="titlepage"><div><div><h3 class="title"><a id="generating_a_rails_application"/>Generating a Rails Application</h3></div></div></div><p>You create a Rails application with the command <code class="literal">rails</code> <em class="replaceable"><code>application_name</code></em>. If you execute <code class="literal">rails rails_sample_app</code> in a suitable workspace directory, you should see a very long output similar to the following truncated version:<a class="indexterm" id="idx-CHP-12-1180"/><a class="indexterm" id="idx-CHP-12-1181"/><a class="indexterm" id="idx-CHP-12-1182"/></p><a id="I_programlisting12_d1e20525"/><pre class="programlisting">$ rails rails_sample_app
      create
      create  app/controllers
      create  app/helpers
      create  app/models
      create  app/views/layouts
      (several lines deleted)
      create  <a class="indexterm" id="idx-CHP-12-1183"/>public/javascripts/application.js
      create  <a class="indexterm" id="idx-CHP-12-1184"/>doc/README_FOR_APP
      create  <a class="indexterm" id="idx-CHP-12-1185"/>log/server.log
      create  log/production.log
      create  log/development.log
      create  log/<a class="indexterm" id="idx-CHP-12-1186"/>test.log</pre><p>A large number of directories and files are automatically created for you. We’ll briefly touch on the <code class="literal">app, doc, lib, log, public, script</code>, and <code class="literal">test</code> directories. The <code class="literal">app</code> directory contains the code you’ll write for your application: Models, Views, Controllers, and so on. The <code class="literal">doc</code> directory contains documentation. Nothing is initially created in the <code class="literal">lib</code> directory, but you’ll put generic library files (such as extensions that add new methods to existing classes) here. The <code class="literal">log</code> directory contains the application log files, which are split up for production, development, and testing. The <code class="literal">public</code> directory contains non-Ruby files that are viewed or used in a web browser, such as static HTML files, images, JavaScript files, CSS stylesheets, and the like. The <code class="literal">script</code> directory contains useful small programs meant to be run by the developer or administrator of the application. The <code class="literal">test</code> directory contains files that allow you to easily automate testing of the application.<a class="indexterm" id="idx-CHP-12-1187"/><a class="indexterm" id="idx-CHP-12-1188"/></p><p>We’ll discuss what each of these files and directories does shortly, but first, let’s test our application to make sure it’s running properly.</p></div><div class="sect3" title="Viewing Your Rails Application"><div class="titlepage"><div><div><h3 class="title"><a id="viewing_your_rails_application"/>Viewing Your Rails Application</h3></div></div></div><p>Execute <code class="literal">cd rails_sample_app</code> to navigate to the newly created directory <code class="literal">rails_sample_app</code>, and execute the command <code class="literal">ruby script/server</code>. This starts Rails’ built-in webserver that it uses for development purposes. You should see output similar to the following:<a class="indexterm" id="idx-CHP-12-1189"/></p><a id="I_programlisting12_d1e20600"/><pre class="programlisting">$ ruby script/server    <em class="lineannotation"><span class="lineannotation">Starting WEBrick</span></em>
=&gt; Booting WEBrick...
=&gt; Rails application started on http://0.0.0.0:3000
=&gt; Ctrl-C to shutdown server; call with --help for options
[2007-02-10 12:43:54] INFO  WEBrick 1.3.1
[2007-02-10 12:43:54] INFO  ruby 1.8.4 (2005-12-24) [i486-linux]
[2007-02-10 12:43:54] INFO  <a class="indexterm" id="idx-CHP-12-1190"/>WEBrick::HTTPServer#start: pid=27162 port=3000</pre><p>Your specifics may be different. The <code class="literal">pid</code> value will almost certainly be different, and your Ruby version may be a later one. Your webserver may also be something else, such as <a class="indexterm" id="idx-CHP-12-1191"/>Mongrel, which is a newer webserver for <a class="indexterm" id="idx-CHP-12-1192"/>Rails. (WEBrick is the older webserver that serves as a default fallback.) What is unlikely to be different is the port: 3000. You can test your application by browsing to that port on your local machine (just point your favorite web browser to http://localhost:3000). <a class="xref" href="ch12s02.html#viewing_your_application_in_a_web_browse" title="Figure 12-1. Viewing your application in a web browser with the URL http://localhost:3000">Figure 12-1</a> shows what that URL looked like when I viewed it on my Ubuntu machine with the Epiphany web browser.<a class="indexterm" id="I_indexterm12_d1e20624"/></p><div class="figure"><a id="viewing_your_application_in_a_web_browse"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject12_d1e20632"/><img alt="Viewing your application in a web browser with the URL http://localhost:3000" src="httpatomoreillycomsourcenostarchimages686170.png.jpg"/></div></div><p class="title">Figure 12-1. Viewing your application in a web browser with the URL http://localhost:3000</p></div><p>As you can see, this page provides useful information about how to set up your application as well as links to Rails-related information on the Web. Two points of particular interest are that the database connection is described in the YAML file <code class="literal">config/database.yml</code> and that <code class="literal">script/generate</code> is available to help you generate Models and Controllers.<a class="indexterm" id="idx-CHP-12-1193"/></p></div><div class="sect3" title="Basics for Generating Applications"><div class="titlepage"><div><div><h3 class="title"><a id="basics_for_generating_applications"/>Basics for Generating Applications</h3></div></div></div><p>Within the directory <code class="literal">rails_sample_app</code>, execute the command <code class="literal">ruby script/generate model ExchangeRate</code>, following our MVC example earlier. We’re telling Rails that we want to <span class="emphasis"><em>generate</em></span> something, the thing we want to make is a <span class="emphasis"><em>Model</em></span>, and the name of the Model is <span class="emphasis"><em>ExchangeRate</em></span>. Here are the results:<a class="indexterm" id="idx-CHP-12-1194"/></p><a id="I_programlisting12_d1e20674"/><pre class="programlisting">ruby script/generate model ExchangeRate    <em class="lineannotation"><span class="lineannotation">Making a Model</span></em>
      exists  app/models/
      exists  test/unit/
      exists  test/fixtures/
      create  app/models/exchange_rate.rb
      create  test/unit/exchange_rate_test.rb
      create  test/fixtures/exchange_rates.yml
      create  db/migrate
      create  db/migrate/001_create_exchange_rates.rb</pre><p>As well as some useful testing- and database-related files, this command created a Ruby file called <code class="literal">app/models/exchange_rate.rb</code>, the contents of which are the following:</p><a id="I_programlisting12_d1e20684"/><pre class="programlisting">class ExchangeRate &lt; ActiveRecord::Base
end</pre><p>There doesn’t seem to be a lot there, but appearances can be deceiving. The Model follows the Rails naming convention of using CamelCase for class names and multi_word_separated_lowercase for filenames. You’ll also notice that <code class="literal">ExchangeRate</code> is a child of something called <code class="literal">ActiveRecord::Base</code>. Active Record is the software that gives Rails its intuitive database interaction. It defines Models (which are classes) such that each instance represents a record in a database table. Not only that, but the name of the table is always the plural of the class. Therefore, the file <code class="literal">exchange_rate.rb</code> defines a class called <code class="literal">ExchangeRate</code>, each instance of which is stored in a database table called <code class="literal">exchanges_rates</code>. This all takes place under the hood—Rails does it for you automatically, and it is even smart enough to know that the plural of <code class="literal">person</code> is <code class="literal">people</code>, the plural of <code class="literal">baby</code> is <code class="literal">babies</code>, and so on.</p><div class="note" title="Note"><h3 class="title"><a id="note-66"/>Note</h3><p><span class="emphasis"><em>Active Record provides what’s called object-relational mapping (ORM). ORM enables a specific instance of a class to represent a record in a database table. For those who are curious, each field in the table also represents an instance variable in the appropriate class. We’ll talk about this topic more in the next chapter</em></span>.</p></div><p>Our Model doesn’t do anything yet. We won’t start adding to Models until the next chapter, so let’s make a Controller with the command <code class="literal">ruby script/generate controller server_access rss html ascii yaml</code>, telling Rails that this time we want to generate a Controller and that it should have the Views <code class="literal">rss, html, ascii</code>, and <code class="literal">yaml</code>. Here are the results:</p><a id="I_programlisting12_d1e20732"/><pre class="programlisting">ruby script/generate controller server_access rss html ascii yaml    <em class="lineannotation"><span class="lineannotation">Making a Controller</span></em>
      exists  app/controllers/
      exists  app/helpers/
      create  app/views/server_access
      exists  test/functional/
      create  app/controllers/server_access_controller.rb
      create  test/functional/server_access_controller_test.rb
      create  app/helpers/server_access_helper.rb
      create  app/views/server_access/rss.rhtml
      create  app/views/server_access/html.rhtml
      create  app/views/server_access/ascii.rhtml
      create  app/views/server_access/yaml.rhtml</pre><p>This output is slightly more complicated. We see that we now have a Controller called <code class="literal">server_access_controller.rb</code> in <code class="literal">app/controllers/</code>, and we now have the files <code class="literal">rss.rhtml, html.rhtml, ascii.rhtml</code>, and <code class="literal">yaml.rhtml</code> inside <code class="literal">app/views/server_access/</code>. Let’s take a look at <code class="literal">app/controllers/server_access_controller.rb</code>.</p><a id="I_programlisting12_d1e20758"/><pre class="programlisting">class <a class="indexterm" id="idx-CHP-12-1195"/>ServerAccessController &lt; ApplicationController

  def rss
  end

  def html
  end

  def ascii
  end

  def yaml
  end
end</pre><p>We now see another class definition, this time descended from <code class="literal">ApplicationController</code>, and several empty methods whose names match the names of our requested Views. Now point your browser at http://localhost:3000/server_access and see what’s there (<a class="xref" href="ch12s02.html#unknown_action" title="Figure 12-2. Unknown action">Figure 12-2</a>).</p><div class="figure"><a id="unknown_action"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject12_d1e20775"/><img alt="Unknown action" src="httpatomoreillycomsourcenostarchimages686168.png.jpg"/></div></div><p class="title">Figure 12-2. Unknown action</p></div><p>What happened? We browsed to the same top-level URL for our <a class="indexterm" id="idx-CHP-12-1196"/>Rails application, this time adding the name of our new <code class="literal">server_access</code> Controller, and our application complained. Let’s try the URL http://localhost:3000/server_access/rss instead. My result is shown in <a class="xref" href="ch12s02.html#the_rss_views_default_result" title="Figure 12-3. The RSS View’s default result">Figure 12-3</a>.</p><p>Then try using http://localhost:3000/server_access/ascii as the URL (<a class="xref" href="ch12s02.html#the_ascii_views_default_result" title="Figure 12-4. The ASCII View’s default result">Figure 12-4</a>).</p><div class="figure"><a id="the_rss_views_default_result"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject12_d1e20798"/><img alt="The RSS View’s default result" src="httpatomoreillycomsourcenostarchimages686176.png.jpg"/></div></div><p class="title">Figure 12-3. The RSS View’s default result</p></div><div class="figure"><a id="the_ascii_views_default_result"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject12_d1e20806"/><img alt="The ASCII View’s default result" src="httpatomoreillycomsourcenostarchimages686158.png.jpg"/></div></div><p class="title">Figure 12-4. The ASCII View’s default result</p></div><p>In the latter two cases, Rails told us which file provides content for the URL requested. We browse to the top-level Rails application and provide the Controller name as the first directory and the View name as the next element in the URL. This means that in our first example (http://localhost:3000/server_access), we provided no View. How will Rails interpret that?</p><p>Similar to how the default HTML file in a directory is <code class="literal">index.html</code>, the default View used when none is explicitly provided is <code class="literal">index</code>. However, <code class="literal">ServerAccessController</code> does not have a method called <code class="literal">index</code>, so it complained. Don’t worry—we’ll create an <code class="literal">index</code> View in our sample application in the next chapter.<a class="indexterm" id="idx-CHP-12-1197"/></p><p>However, the URL http://localhost:3000/server_access/ascii used a View that we know we have, <code class="literal">ascii</code>, and its results told us to look inside <code class="literal">app/views/server_access/ascii.rhtml</code>. Let’s do so.</p><a id="I_programlisting12_d1e20842"/><pre class="programlisting">&lt;h1&gt;ServerAccess#ascii&lt;/h1&gt;
&lt;p&gt;Find me in app/views/server_access/ascii.rhtml&lt;/p&gt;</pre><p>There’s just enough HTML content there to provide the visible information. The file informs us that the Controller name is the class, and the View name is the method, using the <code class="literal">#</code> sign to indicate that it’s an <a class="indexterm" id="idx-CHP-12-1198"/>instance method (the <code class="literal">#</code> sign is often used in the Ruby community to distinguish an <a class="indexterm" id="idx-CHP-12-1199"/>instance method from a class method). To write a real Rails application, we’ll start filling these empty classes, methods, and HTML stub files with real content, and we’ll also connect to a database to retrieve our information.</p><p>Since our View files are .rhtml files, not just static .html files, we can use techniques similar to those we’ve already seen in the context of <code class="literal">mod_ruby</code> to put Ruby code directly into our .rhtml files.<sup>[<a class="footnote" href="#ftn.CHP-12-FNOTE-2" id="CHP-12-FNOTE-2">36</a>]</sup> This will be crucial in the next chapter.</p></div></div><div class="footnotes"><br/><hr/><div class="footnote"><p><sup>[<a class="para" href="#CHP-12-FNOTE-1" id="ftn.CHP-12-FNOTE-1">35</a>] </sup>Dr. Reenskaug is online at <a class="ulink" href="http://heim.ifi.uio.no/~trygver">http://heim.ifi.uio.no/~trygver</a>.</p></div><div class="footnote"><p><sup>[<a class="para" href="#CHP-12-FNOTE-2" id="ftn.CHP-12-FNOTE-2">36</a>] </sup>Technically, <code class="literal">mod_ruby</code> uses eRuby, while <a class="indexterm" id="idx-CHP-12-1200"/>Rails uses erb; these are two different ways to embed Ruby code within markup, but they are very similar in practice.</p></div></div></div>
<div class="sect1" title="Chapter Recap"><div class="titlepage"><div><div><h1 class="title"><a id="chapter_recap-id010"/>Chapter Recap</h1></div></div></div><p>What was new in this chapter?</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Package management</p></li><li class="listitem"><p>Installing RubyGems</p></li><li class="listitem"><p>Installing, updating, and querying specific gem package files</p></li><li class="listitem"><p>Rails basics</p></li><li class="listitem"><p>Installing Rails</p></li><li class="listitem"><p>The MVC pattern</p></li><li class="listitem"><p>ORM basics</p></li><li class="listitem"><p>Viewing your first Rails application</p></li><li class="listitem"><p>Generating Models and Controllers</p></li><li class="listitem"><p>The <code class="literal">index</code> View used as the default View</p></li><li class="listitem"><p>Distinguishing instance methods from class methods with <code class="literal">#</code></p></li><li class="listitem"><p>HTML stub files for Views<a class="indexterm" id="I_indexterm12_d1e20927"/></p></li></ul></div><p>With just that information, you could create some interesting applications that do a variety of dynamic tasks. However, the real power of Rails stems from its ability to access a database and manipulate content. That will be the focus of our next and final chapter.</p></div></body></html>