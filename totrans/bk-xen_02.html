<html><head></head><body><div class="chapter" title="Chapter&#xA0;2.&#xA0;GETTING STARTED"><div class="titlepage"><div><div><h1 class="title"><a id="getting_started"/>Chapter 2. GETTING STARTED</h1></div></div></div><div class="informalfigure"><div class="mediaobject"><a id="I_mediaobject2_d1e1174"/><img src="httpatomoreillycomsourcenostarchimages333191.png.jpg" alt="image with no caption"/></div></div><p>Fascinating though the theoretical underpinnings and implementation details of Xen are, we should probably move on to working directly with Xen for a bit of practice. There is, after all, no substitute for experience.</p><p>So! Welcome to Xen. This chapter is an easy quick start aimed at gently introducing Xen to one of your machines. We will hold your hand and not let it go.</p><p>Because this is a detailed walk-through, we're going to give focused, specific instructions, deviating from our normal policy of being vague and distro-agnostic. For the purposes of this chapter, we'll assume you're installing CentOS 5.x with the <span class="emphasis"><em>server</em></span> defaults and using its built-in Xen support.</p><p>If you're using something else, this chapter will probably still be useful, but you might have to improvise a bit—the goals will be the same but the steps will probably be different.</p><div class="sidebar"><a id="red_hat_vs_centos_vs_fedora"/><p class="title">RED HAT VS. CENTOS VS. FEDORA</p><p>So what is this CentOS, and why are we using it? The short answer is that CentOS, the <span class="emphasis"><em>Community ENTerprise OS</em></span>, is an RPM-based distro derived from <a id="idx-CHP-2-0091" class="indexterm"/>Red Hat Enterprise Linux with all of Red Hat's trademarks stripped out. We're focusing on it here because it's well supported by Xen, reasonably generic in structure, and fairly popular. Additionally, it's more stable than <a id="idx-CHP-2-0092" class="indexterm"/>Fedora and a lot cheaper than Red Hat's official product, <a id="idx-CHP-2-0093" class="indexterm"/>Red Hat Enterprise Linux (<span class="emphasis"><em>RHEL</em></span> for short).<a id="idx-CHP-2-0094" class="indexterm"/></p><p>We have difficulty recommending Fedora for production use simply because the release cycle is unrealistically fast. While Red Hat handpicks updates for stability, Fedora operates as Red Hat's pressure cooker. Fedora applies the same sort of philosophy as Red Hat to picking kernel patches and such, but they release far more often. (If you've ever run a stock 2.6 kernel, you know that <span class="emphasis"><em>someone</em></span> needs to handpick updates, be it you or your distro overlords, to get anything like enterprise performance.<sup>[<a id="CHP-2-FNOTE-1" href="#ftn.CHP-2-FNOTE-1" class="footnote">14</a>]</sup>) Fedora releases could be considered alpha versions of the next RHEL, and therefore, like any alpha software, we hesitate to rely on it.</p><p>The reason we suggest CentOS rather than Red Hat Enterprise Linux is simply that RHEL is quite expensive. (Especially by Linux standards.) It may well be worth it if you want support—but we'll stick to CentOS. It's a good product, benefiting from Red Hat's years of work with Linux, and it's stable and easy to manage.</p><p>Red Hat's effort shows to particular advantage in the work they've done integrating Xen. Red Hat has taken Xen and done a fair amount of work to make it a product. Thankfully, because Xen is open source, everyone benefits.</p></div><p>In general, the goals for this walk-through are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Make sure your hardware can run Xen.</p></li><li class="listitem"><p>Install a basic OS.</p></li><li class="listitem"><p>Install Xen.</p></li><li class="listitem"><p>Familiarize yourself with the Xen environment.</p></li><li class="listitem"><p>Install a domU.</p></li><li class="listitem"><p>Log in to your domU and configure it to make sure everything works.</p></li><li class="listitem"><p>Rest.</p></li></ul></div><div class="sect1" title="Hardware Compatibility"><div class="titlepage"><div><div><h1 class="title"><a id="hardware_compatibility"/>Hardware Compatibility</h1></div></div></div><p>First, make sure that your hardware's up to the task of running Xen. (It almost certainly is.)<a id="idx-CHP-2-0095" class="indexterm"/></p><p>All you need is a Pentium Pro or better, 512MiB of memory,<sup>[<a id="CHP-2-FNOTE-2" href="#ftn.CHP-2-FNOTE-2" class="footnote">15</a>]</sup> and a few hundred MiB of <a id="idx-CHP-2-0097" class="indexterm"/>hard drive space. If you can't manage that, dig some change out of your couch cushions and buy a machine. The PPro came out in, what, 1996? Haven't you heard? This Is The Future.</p><p>At present, Xen runs only on x86 (that is, Intel and AMD) processors and IBM's PowerPC. X86_64—the 64-bit extension to the x86 instruction set—is supported on both AMD and Intel processors. Xen also supports Intel's Itanium. For the sake of this walk-through, we'll assume that you're using an x86 or x86_64 machine.</p><p>Our test box, for example—chosen to be as common as possible—was a three-year-old Dell, with a Pentium 4, 1GB of RAM, and a quantity of hard drive space beyond my wildest imaginings. Personally, I think it's all so fast it makes me sick.</p><p>Anyway, so you've got a machine capable of <a id="idx-CHP-2-0098" class="indexterm"/>running Xen. Congratulations. First, it needs a basic operating system that Xen can run on top of.</p><div class="note" title="Note"><h3 class="title"><a id="note-6"/>Note</h3><p>Run on top of <span class="emphasis"><em>is probably not the best way of characterizing Xen's interaction with the dom0 OS, in view of the fact that the dom0 kernel runs on the hypervisor, but it is a convenient and frequently used phrase. We beg your patience, Constant Reader</em></span>.</p></div></div><div class="footnotes"><br/><hr/><div class="footnote"><p><sup>[<a id="ftn.CHP-2-FNOTE-1" href="#CHP-2-FNOTE-1" class="para">14</a>] </sup>We recognize that some people may disagree with this opinion.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-2-FNOTE-2" href="#CHP-2-FNOTE-2" class="para">15</a>] </sup>The absolute <a id="idx-CHP-2-0096" class="indexterm"/>minimum would probably be 128MiB, but CentOS itself requires 256, and each domU will also require a significant amount of memory.</p></div></div></div>
<div class="sect1" title="Installing CentOS"><div class="titlepage"><div><div><h1 class="title"><a id="installing_centos"/>Installing CentOS</h1></div></div></div><p>First, we'll install CentOS in a completely ordinary way. Put the install medium in the drive, boot from it, and install it according to your preference. We opted to accept the default partitioning, which creates a small <span class="emphasis"><em>/boot</em></span> partition and devotes the rest of the drive to an LVM group, with a logical volume for swap and a volume for root. We also accepted the default configuration for the GRUB boot loader and the default network config.<a id="idx-CHP-2-0099" class="indexterm"/><a id="idx-CHP-2-0100" class="indexterm"/></p><div class="note" title="Note"><h3 class="title"><a id="note-7"/>Note</h3><p><span class="emphasis"><em>Now would also be a good time to make sure you have some sort of Internet access</em></span>.</p></div><p>Set your time zone and enter a root password. We're just running through the standard CentOS install process at this point—it's probably familiar territory. Follow the prompts as usual.</p><p>Next comes package selection. We chose the <span class="strong"><strong> virtualization server</strong></span><a id="idx-CHP-2-0101" class="indexterm"/> package group, since that's the one that includes the Xen hypervisor and supporting tools, and left the rest blank. If you'd like to, you can also choose other package groups to install, like the GNOME desktop or server-gui set of packages, without modifying any of the steps in this section.</p><p>Select <span class="strong"><strong> Next</strong></span>. Now the machine will install the packages you've selected. This may take a while, varying with package selection and install medium. It took us about 15 minutes to install from a DVD. When that's done, the machine will reboot and give you the chance to do postinstall configuration—firewall, services, SELinux, and so on.</p><p>At this point you may wish to do other system configuration related stuff, not directly related to Xen. Feel free.</p><p>Now, we're ready to create a virtual machine. But first let's look at Xen's boot messages and get familiar with the Xen environment.</p><div class="sidebar"><a id="the_livecd"/><p class="title">THE LIVECD</p><p>So, you downloaded the LiveCD? May as well try it. It's pretty slick, but when it's booted, it's just another operating system. This captures what makes Xen so fascinating—its sheer banality. After all this work, you wind up sitting in front of a Linux box. Yes, it will pretend to be multiple Linux boxes on demand, but there's not really much "there" there, to borrow a well-turned phrase from Gertrude Stein.</p><p>The LiveCD does showcase some useful <a id="idx-CHP-2-0102" class="indexterm"/>features, though. For example, it uses a copy-on-write filesystem to give each Xen domain persistent writable storage across VM reboots. The LiveCD also has some neat scripts that use the XenBus to pop up a VNC console automatically on domU startup. (See <a class="xref" href="ch14.html" title="Chapter 14. TIPS">Chapter 14</a> for more information on that.)</p><p>It's a nice demo, but it's not really useful for production, and it doesn't give you the sort of hands-on experience that comes with setting up a machine. The other problem is that the LiveCD hasn't been updated in a while. The last version (as of this writing) is two years old and is based on Xen 3.0.3. There have since been some changes to Xen.</p></div><p><a id="idx-CHP-2-0103" class="indexterm"/>Booting with Xen features extra Xen-specific boot output, as shown in <a class="xref" href="ch02s02.html#success_the_xen_kernel_wants_to_have_a_c" title="Figure 2-1. Success! The Xen kernel wants to have a conversation with us.">Figure 2-1</a>.</p><div class="figure"><a id="success_the_xen_kernel_wants_to_have_a_c"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject2_d1e1365"/><img src="httpatomoreillycomsourcenostarchimages333205.png.jpg" alt="Success! The Xen kernel wants to have a conversation with us."/></div></div><p class="title">Figure 2-1. Success! The Xen kernel wants to have a conversation with us.</p></div><p>After GRUB loads, it loads the Xen hypervisor, which then takes control of the hardware and outputs its <a id="idx-CHP-2-0104" class="indexterm"/>initialization lines (starting with <code class="literal">(XEN)</code>). Then it loads the dom0 kernel, which takes over and spews the familiar Linux <a id="idx-CHP-2-0105" class="indexterm"/>boot messages that we know and tolerate. (Note that you may not see these messages if you're using the VGA console, since they go by rather quickly. You can type <code class="literal">xm dmesg</code> to see them at any time.)<a id="idx-CHP-2-0106" class="indexterm"/></p><p>After the system boots, you should be looking at the normal login prompt, with nary a sign that you're <a id="idx-CHP-2-0107" class="indexterm"/>running in a Xen virtual machine. (Albeit a specially privileged virtual <a id="idx-CHP-2-0108" class="indexterm"/>machine.) Now would be a great time to log in, if you haven't already.</p></div>
<div class="sect1" title="Getting Familiar with Your Xen System"><div class="titlepage"><div><div><h1 class="title"><a id="getting_familiar_with_your_xen_system"/>Getting Familiar with Your Xen System</h1></div></div></div><p>Before we start creating virtual machines, let's take a brief look at the Xen <a id="idx-CHP-2-0109" class="indexterm"/>configuration files in the dom0. We'll be referring to these a lot in future chapters, so now might be a good time to take a quick tour.</p><p>First, there's the Xen configuration directory, <span class="emphasis"><em>/etc/xen</em></span>. Most, though not all, of the Xen configuration happens via files here or in the <span class="emphasis"><em>scripts</em></span> subdirectory.<a id="idx-CHP-2-0110" class="indexterm"/><a id="idx-CHP-2-0111" class="indexterm"/></p><p>The main Xen config file is <a id="idx-CHP-2-0112" class="indexterm"/><em class="filename">xend-config.sxp</em>. This where you'd perform tasks like enabling migration or <a id="idx-CHP-2-0113" class="indexterm"/>specifying the network backend. For now, we'll be content with the defaults.</p><div class="note" title="Note"><h3 class="title"><a id="note-8"/>Note</h3><p><span class="emphasis"><em>If you're planning on using this Xen installation for anything besides this walk-through, now is a good time to set the</em></span> <em class="replaceable"><code>(dom-min-mem)</code></em> <span class="emphasis"><em>option in</em></span> xend-config.sxp <span class="emphasis"><em>to something sensible. We use</em></span> <em class="replaceable"><code>(dom-min-mem 1024)</code></em>. <span class="emphasis"><em>See <a class="xref" href="ch14.html" title="Chapter 14. TIPS">Chapter 14</a> for more details</em></span>.</p></div><p>The <span class="emphasis"><em>/etc/xen/scripts</em></span> directory contains scripts to handle tasks like setting up virtual devices.<a id="idx-CHP-2-0114" class="indexterm"/></p><p>Finally, domain configuration files live in <span class="emphasis"><em>/etc/xen</em></span>. For example, you can take a look at <span class="emphasis"><em>xmexample1</em></span> to see a liberally commented sample config.</p><p>The <span class="emphasis"><em>/etc/init.d</em></span> directory contains scripts to start and stop <a id="idx-CHP-2-0115" class="indexterm"/>Xen-related <a id="idx-CHP-2-0116" class="indexterm"/>services. The Xen control daemon, <code class="literal">xend</code>, runs as a standard service from the <span class="emphasis"><em>/etc/init.d/xend</em></span> script. Although you probably won't need to modify it, this can be a handy place to change <code class="literal">xend</code> 's <a id="idx-CHP-2-0117" class="indexterm"/>parameters. It's also the easiest way to restart <code class="literal">xend</code>, by <a id="idx-CHP-2-0118" class="indexterm"/>running <code class="literal">/etc/init.d/xend restart</code>. The <span class="emphasis"><em>xendomains</em></span> script may also be of interest—it automatically saves domains when the system shuts down and restores them when it boots up.<a id="idx-CHP-2-0119" class="indexterm"/></p><p>There's also <a id="idx-CHP-2-0120" class="indexterm"/><em class="filename">/boot/grub/menu.lst</em>. This file tells the bootloader, GRUB, to boot the Xen kernel, relegating the dom0 Linux kernel to a "module" line. Here you'd change the <a id="idx-CHP-2-0121" class="indexterm"/>boot parameters for both Xen and Linux. For example, you might want to specify a fixed memory <a id="idx-CHP-2-0122" class="indexterm"/>allocation for dom0 using the <code class="literal">dom0_mem</code> hypervisor option, or increase the number of network loopback devices via the Linux <code class="literal">nloopbacks</code> option.<a id="idx-CHP-2-0123" class="indexterm"/></p><p>domU data itself, if you're using file-backed virtual disks under CentOS and following the default prompts for <code class="literal">virt-install</code>, resides in <span class="emphasis"><em>/var/lib/xen/images</em></span>. Other distros and frontends are likely to have different defaults.</p><div class="sect2" title="Management with xm"><div class="titlepage"><div><div><h2 class="title"><a id="management_with_xm"/>Management with xm</h2></div></div></div><p>The main command that you'll use to interact with Xen is <code class="literal">xm</code>. This tool has a wide variety of subcommands. First, since we're still looking around the environment, try <code class="literal">xm list</code>:<a id="I_indexterm2_d1e1577" class="indexterm"/><a id="I_indexterm2_d1e1582" class="indexterm"/></p><a id="I_programlisting2_d1e1587"/><pre class="programlisting"># xm list
Name                                      ID Mem(MiB) VCPUs State   Time(s)
Domain-0                                   0      934     2 r-----     37.6</pre><p>The output of <code class="literal">xm list</code> shows the <a id="idx-CHP-2-0124" class="indexterm"/>running domains and their attributes. Here we see that only one domain is running, Domain-0 (abbreviated <span class="emphasis"><em>dom0</em></span> throughout the book) with ID 0, 934MiB of memory, and two VCPUS. It's in the "running" state and has used 37.6 seconds of CPU time since boot.<a id="idx-CHP-2-0125" class="indexterm"/></p><div class="note" title="Note"><h3 class="title"><a id="note-9"/>Note</h3><p><span class="emphasis"><em>Red Hat doesn't officially support</em></span> <code class="literal">xm</code>, <span class="emphasis"><em>although they unofficially expect it to continue working through RHEL 5</em></span>.x. <span class="emphasis"><em>For this reason</em></span>, <code class="literal">xm</code> '<span class="emphasis"><em>s documentation may advertise capabilities that don't work on RHEL or CentOS. The supported management tool on RHEL and friends is</em></span> <em class="replaceable"><code>virsh</code></em>, <span class="emphasis"><em>for</em></span> virtualization shell.<a id="idx-CHP-2-0126" class="indexterm"/><a id="idx-CHP-2-0127" class="indexterm"/></p></div><p>You might also try <code class="literal">xm info</code> for more <a id="idx-CHP-2-0128" class="indexterm"/>information on the hypervisor. We'll introduce more <code class="literal">xm</code> subcommands in later chapters, and there's a complete list in <a class="xref" href="apa.html" title="Appendix A. XM REFERENCE">Appendix A</a>.<a id="idx-CHP-2-0129" class="indexterm"/></p></div></div>
<div class="sect1" title="Making a DomU"><div class="titlepage"><div><div><h1 class="title"><a id="making_a_domu"/>Making a DomU</h1></div></div></div><p>For the moment, since we want to create a domU, the <code class="literal">xm</code> subcommand we're most interested in is <code class="literal">create</code>. However, before we can create a domain, we need to create an <a id="idx-CHP-2-0130" class="indexterm"/>OS image for it to boot from and use as storage.<a id="idx-CHP-2-0131" class="indexterm"/></p><p>Because this is an initial walk-through, we're going to install our Xen image <a id="idx-CHP-2-0132" class="indexterm"/>using Red Hat's <code class="literal">virt-install</code> tool. For information on building your own domU images, take a look at <a class="xref" href="ch03.html" title="Chapter 3. PROVISIONING DOMUS">Chapter 3</a>.</p><p>Begin by starting <code class="literal">virt-install</code>. It'll start in interactive mode, and have a bit of a conversation with you, as shown. Our inputs are shown in bold. (If you decided to install the GUI, you can also use the graphical <code class="literal">virt-manager</code> tool. The prompts will look very similar.)</p><a id="I_programlisting2_d1e1701"/><pre class="programlisting">#<strong class="userinput"><code> virt-install</code></strong>

What is the name of your virtual machine?<strong class="userinput"><code> prospero</code></strong>
How much RAM should be allocated (in megabytes)?<strong class="userinput"><code> 256</code></strong>
What would you like to use as the disk (file path)?<strong class="userinput"><code> /var/lib/xen/images/prospero.img</code></strong>
How large would you like the disk (/var/lib/xen/images/prospero.img) to be (in gigabytes)?<strong class="userinput"><code> 4</code></strong>
Would you like to enable graphics support? (yes or no)<strong class="userinput"><code> no</code></strong>
What is the install location?<strong class="userinput"><code> http://mirrors.kernel.org/centos/5/os/i386</code></strong></pre><p>The machine then begins an <a id="idx-CHP-2-0133" class="indexterm"/>interactive network install of CentOS. We won't go into the details of its operation for now—suffice it to say that great pains have been taken to preserve the appearance of installing an OS on a physical machine. As such, the install process should eerily resemble the one we performed at the start of this chapter. Follow its prompts. (For the curious, we discuss <code class="literal">virt-install</code> and its accompanying tools more thoroughly in Chapters <a class="xref" href="ch03.html" title="Chapter 3. PROVISIONING DOMUS">Chapter 3</a> and <a class="xref" href="ch06.html" title="Chapter 6. DOMU MANAGEMENT: TOOLS AND FRONTENDS">Chapter 6</a>.)</p><p>Once you've made your selections and gone through the install, the machine will reboot. Log in, and then shut the machine down via <code class="literal">shutdown -h now</code> (remember, it's an ordinary Linux box) so that we can look a bit more at things from the dom0 end.<a id="idx-CHP-2-0134" class="indexterm"/></p><div class="sect2" title="Anatomy of a Domain Configuration File"><div class="titlepage"><div><div><h2 class="title"><a id="anatomy_of_a_domain_configuration_file"/>Anatomy of a Domain Configuration File</h2></div></div></div><p>Let's take a moment to examine the config file that <code class="literal">virt-install</code> generated for us. As we've mentioned already, the config file is <span class="emphasis"><em>/etc/xen/&lt;domain name&gt;</em></span> by convention.<a id="idx-CHP-2-0135" class="indexterm"/></p><a id="I_programlisting2_d1e1761"/><pre class="programlisting"># cat /etc/xen/prospero
name = "prospero"
uuid = "9f5b38cd-143d-77ce-6dd9-28541d89c02f"
maxmem = 256
memory = 256
vcpus = 1
bootloader = "/usr/bin/pygrub"
on_poweroff = "destroy"
on_reboot = "restart"
on_crash = "restart"
vfb = [  ]
disk = [ "tap:aio:/opt/xen/images/prospero.img,xvda,w" ]
vif = [ "mac=00:16:3e:63:b7:a0,bridge=xenbr0" ]</pre><p>As you see, the file consists of simple name=value pairs, with Python-style lists in square brackets. Note the values that we specified in the <code class="literal">virt-install</code> session, plugged into appropriate places—the name, the memory amount, and the disk image. <code class="literal">virt-install</code> also fills in some network configuration, specifying a MAC address and dom0-level bridge device.</p><p>We'll examine many of the config file parameters more deeply in subsequent chapters. For now, let's just move on to seeing the effects of these values on our domain.</p></div></div>
<div class="sect1" title="Configuring the DomU"><div class="titlepage"><div><div><h1 class="title"><a id="configuring_the_domu"/>Configuring the DomU</h1></div></div></div><p>Finally, start the image! We'll run <code class="literal">xm</code> with the <code class="literal">create</code> subcommand, which expects a config file name as an argument. We can omit the path, since it defaults to looking in <span class="emphasis"><em>/etc/xen</em></span>.<a id="idx-CHP-2-0136" class="indexterm"/></p><a id="I_programlisting2_d1e1792"/><pre class="programlisting">#<strong class="userinput"><code> <a id="idx-CHP-2-0137" class="indexterm"/>xm create -c prospero</code></strong></pre><p>Since we passed the <code class="literal">-c</code> option to <code class="literal">xm create</code>, it'll immediately connect us to the domain's console, so that we can interact with the bootloader. Hit ENTER to boot with default options, and watch it go.</p><p>Once it boots, you should be looking at the console of a shiny new Xen domU, as illustrated in <a class="xref" href="ch02s05.html#we_assure_you_that_this_is_the_domu_cons" title="Figure 2-2. We assure you that this is the domU console.">Figure 2-2</a>. Log in as root and frolic.</p><p>Start by looking at the output of the <code class="literal">dmesg</code> command within the domU. Note that the disk and network devices are Xen's special paravirtualized devices.</p><div class="figure"><a id="we_assure_you_that_this_is_the_domu_cons"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject2_d1e1820"/><img src="httpatomoreillycomsourcenostarchimages333207.png.jpg" alt="We assure you that this is the domU console."/></div></div><p class="title">Figure 2-2. We assure you that this is the domU console.</p></div><p>You can also take a look at the domU's <a id="idx-CHP-2-0138" class="indexterm"/>networking, which is essentially indistinguishable from that of a normal Linux system:</p><a id="I_programlisting2_d1e1833"/><pre class="programlisting"># ifconfig eth0
eth0      Link encap:Ethernet  HWaddr 00:16:3E:63:B7:A0
          inet addr:216.218.223.74  Bcast:216.218.223.127  Mask:255.255.255.192
          inet6 addr: 2001:470:1:41:a800:ff:fe53:314a/64 Scope:Global
          inet6 addr: fe80::a800:ff:fe53:314a/64 Scope:Link
          UP BROADCAST <a id="idx-CHP-2-0139" class="indexterm"/>RUNNING MULTICAST  MTU:1500  Metric:1


          RX packets:73650errors:0 dropped:0 overruns:0 frame:0
          TX packets:49731 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          TX bytes:106033983 (101.1 MiB)    RX bytes:2847950 (2.7 MiB)</pre><p>Note that we're using standard <a id="idx-CHP-2-0140" class="indexterm"/>commands—one of the major features of Xen is that most of the management takes place via familiar Linux <a id="idx-CHP-2-0141" class="indexterm"/>commands. This makes it easy <a id="idx-CHP-2-0142" class="indexterm"/>to customize your Xen environment, usually by making changes to the support scripts. Furthermore, standard commands will generally behave in expected ways—for example, you can give yourself a new IP address via <code class="literal">ifconfig</code>, and it'll work just as it would on a physical machine.<sup>[<a id="CHP-2-FNOTE-3" href="#ftn.CHP-2-FNOTE-3" class="footnote">16</a>]</sup></p><p>Let's return to the dom0 for a moment, just to take a look at the running domain from outside. To break <a id="idx-CHP-2-0143" class="indexterm"/>out of the domU's console, type CTRL-]. You can reconnect at any time by running <code class="literal">xm console &lt;domU name or id&gt;</code> from the dom0.<a id="idx-CHP-2-0144" class="indexterm"/></p><p>Now that we're back in the dom0, we can note that our new domain shows up in <code class="literal">xm list</code>, consuming memory and CPU time:</p><a id="I_programlisting2_d1e1887"/><pre class="programlisting"># xm list
Name                                      ID Mem(MiB) VCPUs State   Time(s)
Domain-0                                   0      739     2 r-----    136.7
prospero                                   1      255     1 -b----   116.1</pre><p>And that it's got a visible network device:</p><a id="I_programlisting2_d1e1891"/><pre class="programlisting"># ifconfig vif1.0
vif1.0    Link encap:Ethernet  HWaddr FE:FF:FF:FF:FF:FF
          inet6 addr: fe80::fcff:ffff:feff:ffff/64 Scope:Link
          UP BROADCAST RUNNING NOARP  MTU:1500  Metric:1
          RX packets:49731 errors:0 dropped:0 overruns:0 frame:0
          TX packets:73650 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:32
          RX bytes:2847950 (2.7 MiB)  TX bytes:106033983 (101.1 MiB)</pre><p>Some points to mention about the network device: First, it's got a dummy MAC address. You can see the actual MAC address of the virtual Ethernet device from within the domU. Second, the counters are reversed—the domain's actually downloaded 100MiB, and transmitted 2.7. Third, both IPv4 and IPv6 "just work" with the default setup. We go into further detail in <a class="xref" href="ch05.html" title="Chapter 5. NETWORKING">Chapter 5</a>.</p><p>From here you can treat the domain just like any other Linux box. You can set up users on it, SSH into it, or access its console via <code class="literal">xm console</code>. You can reboot it via the <code class="literal">xm reboot</code> command, and shut it down using <code class="literal">xm shutdown</code>.</p><div class="footnotes"><br/><hr/><div class="footnote"><p><sup>[<a id="ftn.CHP-2-FNOTE-3" href="#CHP-2-FNOTE-3" class="para">16</a>] </sup>The administrator can disable this, however. You'll still be able to change the IP from the domU, but the dom0 will block traffic from the new IP. See <a class="xref" href="ch05.html" title="Chapter 5. NETWORKING">Chapter 5</a> for details.</p></div></div></div>
<div class="sect1" title="You're Finished. Have a Cookie."><div class="titlepage"><div><div><h1 class="title"><a id="youre_finished_have_a_cookie"/>You're Finished. Have a Cookie.</h1></div></div></div><p>Now that you've got a domain, read the next chapter.</p><p>If it didn't work … what a fabulous opportunity to examine <a class="xref" href="ch15.html" title="Chapter 15. TROUBLESHOOTING">Chapter 15</a>. We are sorry. Please email us and mention that our directions need work.</p></div></body></html>