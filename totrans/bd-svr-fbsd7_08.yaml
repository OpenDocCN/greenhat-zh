- en: Chapter 2\. FREEBSD PORTS COLLECTION
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[HTTP://WWW.FREEBSD.ORG/PORTS](HTTP://WWW.FREEBSD.ORG/PORTS)'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 2.1\. SUMMARY
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: As you learned in "[FreeBSD 7.0](freebsd_7.0_split_000.html#freebsd_7.0)" the
    ports collection provides a simple and centralized way of installing software
    on FreeBSD. It consists of categorized directories containing makefiles that are
    used by the `make` command to compile source code into executable programs or
    libraries. The ports collection is designed to be automated and relatively easy
    to use.
  prefs: []
  type: TYPE_NORMAL
- en: Ports are maintained by designated port administrators who are responsible for
    ensuring that each port stays current with the latest version available from the
    original software author.
  prefs: []
  type: TYPE_NORMAL
- en: 'Installing software from a port builds the program from its source code; if
    the source code isn''t already on the system, it is downloaded from a site designated
    in the makefile. The system verifies the contents of the downloaded source code,
    typically using an MD5 (Message-Digest algorithm 5) hash to ensure its authenticity.
    An MD5 hash is a 32-character alphanumeric string that is like a fingerprint for
    the file. A typical MD5 hash might look like this: e6c75c12f663a484ee3157ab058cfc9e.'
  prefs: []
  type: TYPE_NORMAL
- en: Once the authenticity of the source code has been assured, the make program
    checks the makefile to see if the port requires any other software. If it does,
    FreeBSD installs those dependencies as well. Next, patches are applied to the
    source code, as necessary, before it is compiled and installed.
  prefs: []
  type: TYPE_NORMAL
- en: Once all processes are complete, the port is treated as a FreeBSD package and
    recorded in the installed packages database, pkgdb.db, which is stored in the
    /var/db/pkg directory. Information on the FreeBSD package system can be found
    at [http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/ports-overview.html](http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/ports-overview.html).
  prefs: []
  type: TYPE_NORMAL
- en: 2.2\. RESOURCES
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Using the Ports Collection (FreeBSD Handbook)
  prefs: []
  type: TYPE_NORMAL
- en: '[http://www.freebsd.org/doc/en/books/handbook/ports-using.html](http://www.freebsd.org/doc/en/books/handbook/ports-using.html)'
  prefs: []
  type: TYPE_NORMAL
- en: Search FreeBSD Ports Collection
  prefs: []
  type: TYPE_NORMAL
- en: '[http://www.freebsd.org/ports](http://www.freebsd.org/ports)'
  prefs: []
  type: TYPE_NORMAL
- en: portmaster
  prefs: []
  type: TYPE_NORMAL
- en: '[http://dougbarton.us/portmaster.html](http://dougbarton.us/portmaster.html)'
  prefs: []
  type: TYPE_NORMAL
- en: 2.3\. REQUIRED
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '![](bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg) FreeBSD 7.0-RELEASE
    (see "[FreeBSD 7.0](freebsd_7.0_split_000.html#freebsd_7.0)")'
  prefs: []
  type: TYPE_IMG
- en: '![](bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg) FreeBSD 7.0-RELEASE
    install CD1'
  prefs: []
  type: TYPE_NORMAL
- en: '![](bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg) Internet
    connection (you will need to be online if you want to use the ports collection
    to install applications)'
  prefs: []
  type: TYPE_IMG
- en: 2.4\. PREPARATION
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Become the superuser.
  prefs: []
  type: TYPE_NORMAL
- en: 2.5\. INSTALL
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: If you installed the ports collection when you installed FreeBSD (as discussed
    in the previous chapter), skip to the "[Configure](configure.html#configure)"
    section below. Otherwise, insert the FreeBSD CD into the CD drive, then enter
    the following commands to mount the FreeBSD CD, change to the correct working
    directory, and install the ports collection to the /usr/ports directory.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 2.6\. CONFIGURE
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Keeping the ports collection up to date ensures that applications you install
    via the ports system are the latest versions available. To update the ports collection:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Modify the file ports-supfile. Specify the server to contact when downloading
    updates via `csup`, then copy this configuration file into the /root directory
    so that you can find it easily later. To copy the example ports-supfile to the
    /root directory, enter:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Before editing ports-supfile, choose a suitable update server. FreeBSD maintains
    cvsup servers with names like [cvsup2.freebsd.org](http://cvsup2.freebsd.org),
    [cvsup3.freebsd.org](http://cvsup3.freebsd.org), and so on. For a complete list
    of worldwide CVSup servers, visit [http://www.freebsd.org/doc/en/books/handbook/cvsup.html](http://www.freebsd.org/doc/en/books/handbook/cvsup.html).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Using the following command, ping a few servers to find one that is relatively
    fast.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: The rightmost column in the last line above (`time=85.607 ms`) displays the
    time it takes each packet to reach the server and return. The lower the number,
    the better. Repeat this for a few servers and pick the one with the shortest time.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Open the ports-supfile and add the name of the server you have chosen. Scroll
    down to and replace `CHANGE_THIS` in the `*default host` declaration with the
    name of your chosen server. The command below opens ports-supfile in Easy Editor:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'The `*default host` declaration should appear as follows around line 49 of
    /root/ports-supfile:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Replace `*cvsup4*` with the server you chose earlier, then save and exit.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'To update the ports collection, use this command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Before continuing, we will install the Perl programming language from the ports
    collection so that we can create the ports index file. To begin the installation,
    enter the following commands:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'After installing Perl, update the ports index and README files with the following
    commands:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: This may take more than half an hour to complete, depending on the speed of
    your system.
  prefs: []
  type: TYPE_NORMAL
- en: 'You can search the ports collection with the following commands:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: Replace `*portname*` with the name of an application you would like to find.
    The output of this command will provide the port name, path, description, and
    dependencies, among other information. You can also search for ports on the Internet
    by visiting [http://www.freebsd.org/ports/](http://www.freebsd.org/ports/) or
    [http://www.freshports.org](http://www.freshports.org).
  prefs: []
  type: TYPE_NORMAL
- en: If you have a web browser like Lynx (see "[Lynx 2.8.6](lynx_2.8.6.html#lynx_2.8.6)")
    installed, you may browse the ports collection via an HTML interface. The following
    command will use Lynx to open this file.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 2.6.1\. portmaster
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The portmaster utility allows you to upgrade most installed ports to the current
    version available in the ports collection without breaking dependencies or links
    to other programs. For example, the Apache HTTP Server relies on the port eXpat
    for XML (Extensible Markup Language) support. Upgrading to the latest version
    of eXpat manually involves removing the previous installation and reinstalling.
    Doing this will break the Apache HTTP Server install, because its link with eXpat
    is lost. portmaster will allow you to remove and reinstall eXpat without changing
    this dependency or the link with the Apache HTTP Server.
  prefs: []
  type: TYPE_NORMAL
- en: 'To install portmaster from the ports collection, enter the following commands:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: '***Note:*** Back up your system before performing any software installation
    or upgrade. Upgrading installed ports can break things, and having a fresh backup
    will allow you to revert relatively painlessly. (See [Appendix B](backup_and_restore.html#backup_and_restore)
    for information on backup and restore.)'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: 'A list of installed ports that have new versions available in the ports tree
    can be shown with this command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: It is a good idea to read /usr/ports/UPDATING prior to upgrading a port. This
    text file contains known issues when upgrading certain ports.
  prefs: []
  type: TYPE_NORMAL
- en: 'To upgrade a specific port (eXpat for example), run the `portmaster` command
    as shown below:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: '***Note:*** You must specify the old port name as shown in italics above.'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: By default, portmaster will prompt you prior to upgrading the specified port.
    Type Y and press [enter] to commence the upgrade. Once portmaster completes, you
    should have a current version of eXpat installed without affecting the Apache
    HTTP installation.
  prefs: []
  type: TYPE_NORMAL
- en: 'The `-b` switch above tells portmaster to keep a backup of the old port in
    the /root directory. This can prove useful if you need to revert to the old version
    of the port. For example, if the new version of eXpat that was installed was 2.0.0
    we could use the following commands to revert to the old version:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: '***Note:*** The ports collection is constantly updated and changes frequently.
    Trying to keep your installed ports up to date can be challenging. You should
    use portmaster only when necessary (e.g., for security updates; see the "[portaudit](#portaudit)"
    section below), because incompatibilities may appear when running the latest version
    of a program in conjunction with software that expects an older version for functionality.
    To minimize this effect, the `portmaster` command can be run with the `-r` switch,
    which will upgrade the specified port and any port that depends on it. This switch
    should be used with caution as it can affect more than the port being upgraded.'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: 2.6.2\. portaudit
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The portaudit utility allows you to check your installed ports against a database
    of published security vulnerabilities. This database is maintained by the FreeBSD
    port administrators and the FreeBSD Security Team. If a security advisory exists
    for an installed port, a web link to the security advisory is provided for more
    information.
  prefs: []
  type: TYPE_NORMAL
- en: 'To install portaudit, enter:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: 'To check installed ports against the current portaudit database, enter:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: '***Note:*** When building ports, `make` will check the vulnerability database
    to ensure that the port you are installing does not have any known security vulnerabilities.
    If it does, the port will not install and references to the vulnerability (or
    vulnerabilities) will be provided. If you determine that the installation of the
    port does not pose a security risk to your system, you may allow installation
    of the affected port by disabling the vulnerability check temporarily. To disable
    vulnerability checking when running `make`:'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: 2.7\. UTILITIES
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Once a port is successfully installed, it is registered in the package database
    located in /var/db/pkg. A package is a group of files that are installed by a
    software application. Installed ports are treated as packages after being installed
    and should be managed as such. The utilities below are used to manage installed
    packages.
  prefs: []
  type: TYPE_NORMAL
- en: 2.7.1\. pkg_info
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: This utility is used to display information about packages installed on the
    system.
  prefs: []
  type: TYPE_NORMAL
- en: Command
  prefs: []
  type: TYPE_NORMAL
- en: '`pkg_info`'
  prefs: []
  type: TYPE_NORMAL
- en: Syntax
  prefs: []
  type: TYPE_NORMAL
- en: '`pkg_info` `*-option pkgname*`'
  prefs: []
  type: TYPE_NORMAL
- en: Options
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: Shows all installed packages
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: Shows a list of dependent packages
  prefs: []
  type: TYPE_NORMAL
- en: Examples
  prefs: []
  type: TYPE_NORMAL
- en: 'To show a list of all installed packages in two-column format, issue the following
    command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: 'To show the dependencies of a package named perl-5.8.8, issue the following
    command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: 'To list dependencies of all installed packages, enter:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: '***Note:*** Output from `*pkg_info*` may span several pages. As such, it may
    be wise to use a text display utility like `*less*` when dealing with long file
    listings. The `*less*` command would allow you to view a long document page by
    page. See "[less](general.html#less)" for details.'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: 2.7.2\. pkg_delete
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: This utility is used to remove installed packages or ports.
  prefs: []
  type: TYPE_NORMAL
- en: Command
  prefs: []
  type: TYPE_NORMAL
- en: '`pkg_delete`'
  prefs: []
  type: TYPE_NORMAL
- en: Syntax
  prefs: []
  type: TYPE_NORMAL
- en: '`pkg_delete` `*-option pkgname*`'
  prefs: []
  type: TYPE_NORMAL
- en: Options
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: Forces removal of the installed package, even if it contains dependencies
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE23]'
  prefs: []
  type: TYPE_PRE
- en: Recursive removal; deletes specified package and dependent packages
  prefs: []
  type: TYPE_NORMAL
- en: Examples
  prefs: []
  type: TYPE_NORMAL
- en: 'To remove a package named perl-5.8.8, enter:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE24]'
  prefs: []
  type: TYPE_PRE
- en: 'To force the removal of a package named perl-5.8.8 that contains dependencies,
    enter:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE25]'
  prefs: []
  type: TYPE_PRE
- en: 'To remove a package named perl-5.8.8 along with its dependencies, enter:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE26]'
  prefs: []
  type: TYPE_PRE
- en: 2.8\. CONFIG FILES
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 2.8.1\. ports-supfile
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The configuration file for the optional CVSup system. You'll find an example
    at /usr/share/examples/cvsup.
  prefs: []
  type: TYPE_NORMAL
- en: 2.9\. NOTES
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Before you install applications via the ports system, make a full backup of
    the system. This is a good habit, in case the installation doesn't perform the
    way you expected. (See [Appendix B](backup_and_restore.html#backup_and_restore)
    for details on backup procedure.)
  prefs: []
  type: TYPE_NORMAL
