<html><head></head><body><section class="chapter" epub:type="chapter" id="everything_etc" title="Chapter&#xA0;14.&#xA0;Everything /etc"><div class="titlepage"><div><div><h2 class="title">Chapter 14. Everything /etc</h2></div></div></div><div class="epigraph" epub:type="epigraph"><div class="literallayout"><p><span class="emphasis"><em>You are in a maze</em></span><br/>
<span class="emphasis"><em>of twisty little configs;</em></span><br/>
<span class="emphasis"><em>no two are alike.</em></span></p></div></div><p><a class="indexterm" id="idx0586"/><span class="inlinemediaobject"><a id="inline_id00015"/><img alt="" src="httpatomoreillycomsourcenostarchimages1616079.png"/></span> When I get saddled with an unfamiliar server, the first thing I do is look for the previous sysadmin’s documentation. When I discover there isn’t any, I study the <span class="emphasis"><em>/etc</em></span> directory because it contains the basic configuration for a Unix-like system. The fastest way to go from a junior sysadmin to a midgrade one is to read <span class="emphasis"><em>/etc</em></span> and the associated man pages—all of the documentation. Yes, that’s a lot of reading.</p><p>Once you understand <span class="emphasis"><em>/etc</em></span>, you understand how the system hangs together. You must learn all this anyhow, but you might as well take the easier route and learn it up front rather than in an unscheduled series of desperate troubleshooting sessions. (I’ve already discussed many <span class="emphasis"><em>/etc</em></span> files in earlier chapters where relevant, such as <span class="emphasis"><em>/etc/fstab</em></span> in <a class="xref" href="ch08.html" title="Chapter 8. Disks and Filesystems">Chapter 8</a> and <span class="emphasis"><em>/etc/services</em></span> in <a class="xref" href="ch11.html" title="Chapter 11. Overview of TCP/IP">Chapter 11</a>.)</p><p>Some files that you’ll find in <span class="emphasis"><em>/etc</em></span> are of only historical interest or are gradually dying out. I’ll discuss briefly what they do, but I won’t spend much time on obsolete files. I also won’t spend much time on files useful only in edge cases (where they relate to software that’s not used too often or only in very peculiar circumstances). On the other hand, I will dive deeply into important <span class="emphasis"><em>/etc</em></span> files that haven’t already found a place elsewhere in this book.</p><div class="sect1" title="/etc Across Unix Variants"><div class="titlepage"><div><div><h2 class="title" id="etc_across_unix_variants" style="clear: both">/etc Across Unix Variants</h2></div></div></div><p><a class="indexterm" id="idx0087"/><a class="indexterm" id="idx0096"/><a class="indexterm" id="idx0152"/><a class="indexterm" id="idx0567"/><a class="indexterm" id="idx0569"/><a class="indexterm" id="idx0570"/><a class="indexterm" id="idx0587"/><a class="indexterm" id="idx0589"/><a class="indexterm" id="idx0936"/>Different Unix-like systems use different <span class="emphasis"><em>/etc</em></span> files. In many commercial variants, these files are simply renamed or restructured files from primordial BSD.</p><p>For example, the first time I had to manage an IBM AIX system, I needed to know which disks should be mounted where, but there was no <span class="emphasis"><em>/etc/fstab</em></span>. A little searching led me to <span class="emphasis"><em>/etc/filesystems</em></span>, which was IBM’s <span class="emphasis"><em>/etc/fstab</em></span>. Apparently, the IBM folks felt that a file named for “filesystem table” was confusing, so they gave it a different name. Knowing that this information existed somewhere in <span class="emphasis"><em>/etc</em></span>, and knowing which files had an unrelated purpose, greatly shortened my search.</p><p>Changes to <span class="emphasis"><em>/etc</em></span> can dramatically alter how your system performs. While manually recovering a scrambled filesystem can push an adequate sysadmin toward becoming a pretty good one, it’s one of the least pleasant ways to get there.</p></div><div class="sect1" title="The /etc Files"><div class="titlepage"><div><div><h2 class="title" id="the_etc_files" style="clear: both">The /etc Files</h2></div></div></div><p>Now we will take a look at each of the <span class="emphasis"><em>/etc</em></span> files, going in alphabetical order. We’ll start with <span class="emphasis"><em>/etc/adduser.conf</em></span> and end with <span class="emphasis"><em>/etc/ypldap.conf</em></span>.</p><div class="sect2" title="/etc/adduser.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_adduser_conf">/etc/adduser.conf</h3></div></div></div><p>The <span class="emphasis"><em>/etc/adduser.conf</em></span> file contains the persistent configuration for <code class="literal">adduser(8)</code>, which <a class="xref" href="ch06.html" title="Chapter 6. User Management">Chapter 6</a> covers in detail. To change <code class="literal">adduser</code>’s settings, edit this file. This file is self-documenting, and if you’ve read <a class="xref" href="ch06.html" title="Chapter 6. User Management">Chapter 6</a>, you shouldn’t have any trouble with it.</p></div><div class="sect2" title="/etc/amd"><div class="titlepage"><div><div><h3 class="title" id="etc_amd">/etc/amd</h3></div></div></div><p>The automounter daemon automatically loads NFS filesystems upon request. If you’re interested in this function, read the <code class="literal">amd(8)</code> man page.</p><p>The automounter daemon isn’t as useful as you might think. As the documentation says, “A weird imagination is most useful to gain full advantage of all the features.”</p></div><div class="sect2" title="/etc/authpf"><div class="titlepage"><div><div><h3 class="title" id="etc_authpf">/etc/authpf</h3></div></div></div><p>The <span class="emphasis"><em>/etc/authpf</em></span> directory contains the authenticating packet filter configuration. If you’re interested in having user authentication for firewall access, I recommend <span class="emphasis"><em>The Book of PF, 2nd Edition</em></span>, by Peter Hansteen (No Starch Press, 2010).</p></div><div class="sect2" title="/etc/bgpd.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_bgpd_conf">/etc/bgpd.conf</h3></div></div></div><p><a class="indexterm" id="idx0122"/><a class="indexterm" id="idx0124"/><a class="indexterm" id="idx0247"/><a class="indexterm" id="idx0313"/><a class="indexterm" id="idx0571"/><a class="indexterm" id="idx0573"/><a class="indexterm" id="idx0575"/><a class="indexterm" id="idx0577"/><a class="indexterm" id="idx0578"/><a class="indexterm" id="idx0581"/><a class="indexterm" id="idx0583"/><a class="indexterm" id="idx0584"/><a class="indexterm" id="idx0592"/><a class="indexterm" id="idx2394"/>OpenBSD includes a BGP daemon, <code class="literal">bgpd(8)</code>. Most sysadmins will never go near BGP, but if you need it, see the <code class="literal">bgpd.conf(5)</code> man page.</p></div><div class="sect2" title="/etc/boot.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_boot_conf">/etc/boot.conf</h3></div></div></div><p>The <span class="emphasis"><em>/etc/boot.conf</em></span> file controls the system’s booting process, as discussed in <a class="xref" href="ch05.html" title="Chapter 5. The Boot Process">Chapter 5</a>.</p></div><div class="sect2" title="/etc/changelist"><div class="titlepage"><div><div><h3 class="title" id="etc_changelist">/etc/changelist</h3></div></div></div><p><span class="emphasis"><em>/etc/changelist</em></span> is a text file that contains the list of files to be checked by the daily security check script, <span class="emphasis"><em>/etc/security</em></span>. We cover these tasks in detail in <a class="xref" href="ch15.html" title="Chapter 15. System Maintenance">Chapter 15</a>.</p></div><div class="sect2" title="/etc/chio.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_chio_conf">/etc/chio.conf</h3></div></div></div><p>The <code class="literal">chio(1)</code> medium changer lets you manage jukebox-style media arrays, such as CD and tape changers. If you have a tape backup unit that can swap between multiple tapes all on its own, <code class="literal">chio</code> is your friend. Configure <code class="literal">chio</code> in <span class="emphasis"><em>/etc/chio.conf</em></span>. Most OpenBSD users don’t have media changers, but if you’re interested, see the man page for <code class="literal">chio(1)</code>.</p></div><div class="sect2" title="/etc/csh.*"><div class="titlepage"><div><div><h3 class="title" id="etc_csh">/etc/csh.*</h3></div></div></div><p>The <span class="emphasis"><em>/etc/csh.*</em></span> files contain system-wide defaults for <code class="literal">csh(1)</code> and <code class="literal">tcsh(1)</code>. When a user logs in with either of these shells, the shell executes any commands listed in <span class="emphasis"><em>/etc/csh.login</em></span>. Similarly, when the user logs out, the shell executes any commands in <span class="emphasis"><em>/etc/csh.logout</em></span>. Put general shell configuration in <span class="emphasis"><em>/etc/csh.cshrc</em></span>.</p></div><div class="sect2" title="/etc/daily and /etc/daily.local"><div class="titlepage"><div><div><h3 class="title" id="etc_daily_and_etc_daily_local">/etc/daily and /etc/daily.local</h3></div></div></div><p>The <span class="emphasis"><em>/etc/daily.local</em></span> script is run every day to maintain the system. See <a class="xref" href="ch15.html" title="Chapter 15. System Maintenance">Chapter 15</a> for details.</p></div><div class="sect2" title="/etc/dhclient.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_dhclient_conf">/etc/dhclient.conf</h3></div></div></div><p>You can configure OpenBSD’s DHCP client by using <code class="literal">dhclient(8)</code>, as discussed in <a class="xref" href="ch12.html" title="Chapter 12. Connecting to the Network">Chapter 12</a>.</p></div><div class="sect2" title="/etc/dhcpd.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_dhcpd_conf">/etc/dhcpd.conf</h3></div></div></div><p>OpenBSD includes a secure DHCP server. It started life as an Internet Systems Consortium (ISC) DHCP server, but has been repeatedly rewritten and simplified by the OpenBSD team. See <a class="xref" href="ch16.html" title="Chapter 16. Network Servers">Chapter 16</a> for details.</p></div><div class="sect2" title="/etc/disklabels/"><div class="titlepage"><div><div><h3 class="title" id="etc_disklabels">/etc/disklabels/</h3></div></div></div><p>The <span class="emphasis"><em>/etc/disklabels/</em></span> directory traditionally contains backup copies of disklabels, as discussed in <a class="xref" href="ch08.html" title="Chapter 8. Disks and Filesystems">Chapter 8</a>. Very few system administrators actually use it, because very few system administrators know it’s there. OpenBSD copies the disklabels for all system disks as part of the daily backup of critical files (see <a class="xref" href="ch15.html" title="Chapter 15. System Maintenance">Chapter 15</a>).</p></div><div class="sect2" title="/etc/disktab"><div class="titlepage"><div><div><h3 class="title" id="etc_disktab">/etc/disktab</h3></div></div></div><p><a class="indexterm" id="idx0496"/><a class="indexterm" id="idx0526"/><a class="indexterm" id="idx0528"/><a class="indexterm" id="idx0529"/><a class="indexterm" id="idx0593"/><a class="indexterm" id="idx0594"/><a class="indexterm" id="idx0595"/><a class="indexterm" id="idx0598"/><a class="indexterm" id="idx0601"/><a class="indexterm" id="idx0602"/>A couple of decades ago, hard drives were expensive and precious devices that came in only a few varieties. While modern disks can tell the computer about their geometry, older disks need manual configuration, as do older removable media such as 1.44MB floppy disks and Zip disks. If you want to access one of these ancient disks, you’ll need the information in <span class="emphasis"><em>/etc/disktab</em></span>. (But if you need to use one of these old disks, you’re almost certainly solving the wrong problem.)</p></div><div class="sect2" title="/etc/dumpdates"><div class="titlepage"><div><div><h3 class="title" id="etc_dumpdates">/etc/dumpdates</h3></div></div></div><p>The <span class="emphasis"><em>/etc/dumpdates</em></span> file records the dates of the last successful <code class="literal">dump(8)</code> backup. The <code class="literal">dump</code> tool backs up a filesystem, rather than just the files on a filesystem, as <code class="literal">tar(1)</code> does. A dump includes file flags and other special characteristics of the filesystem.</p></div><div class="sect2" title="/etc/dvmrpd.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_dvmrpd_conf">/etc/dvmrpd.conf</h3></div></div></div><p>OpenBSD implements the Distance Vector Multicast Routing Protocol (DVMRP) with <code class="literal">dvmrpd(8)</code>, configured in <span class="emphasis"><em>dvmrpd.conf</em></span>. This is another edge case where OpenBSD performs well, but is of interest only to a few users. If you’re interested in DVMRP, see the <code class="literal">dvmrpd(8)</code> man pages.</p></div><div class="sect2" title="/etc/exports"><div class="titlepage"><div><div><h3 class="title" id="etc_exports">/etc/exports</h3></div></div></div><p>NFS servers list the filesystems they export, and who may access them, in <span class="emphasis"><em>/etc/exports</em></span>. See <a class="xref" href="ch09.html" title="Chapter 9. More Filesystems">Chapter 9</a> for information about using NFS as both a client and a server.</p></div><div class="sect2" title="/etc/fbtab"><div class="titlepage"><div><div><h3 class="title" id="etc_fbtab">/etc/fbtab</h3></div></div></div><p>OpenBSD can change the ownership of system files and devices based on how a user has logged in. When a user logs in via the text console, <code class="literal">login(1)</code> changes the ownership of the console, as well as the keyboard and the mouse, to that user. This way, users can then configure the keyboard or mouse to suit their preferences. A user who logs in via an X session needs similar changes.</p><p>You could use <span class="emphasis"><em>/etc/fbtab</em></span> to change permissions on other devices or files for other special needs, but this is really tricky to get right, and usually means you’re making something much more complicated than it needs to be. If you’re considering this approach, rethink your problem.</p></div><div class="sect2" title="/etc/firmware"><div class="titlepage"><div><div><h3 class="title" id="etc_firmware">/etc/firmware</h3></div></div></div><p>Some hardware needs software to run. In years past, this software would have been loaded onto programmable read-only memory (PROM) chips on the device itself. Network cards often had boot PROMs that let them get configuration information from the network. PROMs are not expensive these days, but making millions of anything adds up quickly. Hardware vendors now often ask the operating system to load this software, called <span class="emphasis"><em>firmware</em></span>, onto the hardware for them.</p><p><a class="indexterm" id="idx0603"/><a class="indexterm" id="idx0606"/><a class="indexterm" id="idx0610"/><a class="indexterm" id="idx0611"/><a class="indexterm" id="idx0612"/><a class="indexterm" id="idx0867"/><a class="indexterm" id="idx0908"/>Firmware is usually a closed-source binary object, or <span class="emphasis"><em>blob</em></span>. While the OpenBSD team members would never accept loading a blob into the kernel, they’re willing to hand a file to a piece of hardware. It doesn’t matter if the hardware gets the blob from the operating system or from a PROM chip attached to the hardware—it’s still software that runs only on the device, not in the operating system.</p><p>For user convenience, OpenBSD distributes firmware that it’s legally permitted to offer. If OpenBSD cannot distribute firmware on the installation media, the <code class="literal">fw_update</code> script uses the package system to fetch it over the Internet. Wherever the firmware comes from, it’s stored in <span class="emphasis"><em>/etc/firmware</em></span>.</p><p>By default, <code class="literal">fw_update</code> runs at first boot after an OpenBSD install or upgrade, but you can run it any time you want (it’s stored in <span class="emphasis"><em>/usr/sbin</em></span>).</p></div><div class="sect2" title="/etc/fonts/"><div class="titlepage"><div><div><h3 class="title" id="etc_fonts">/etc/fonts/</h3></div></div></div><p>The <span class="emphasis"><em>/etc/fonts/</em></span> directory contains the Xenocara X11 fonts. We’ll discuss Xenocara and X11 in <a class="xref" href="ch17.html" title="Chapter 17. Desktop OpenBSD">Chapter 17</a>.</p></div><div class="sect2" title="/etc/fstab"><div class="titlepage"><div><div><h3 class="title" id="etc_fstab">/etc/fstab</h3></div></div></div><p>The filesystem table lists all filesystems that the system knows about, whether they’re automatically mounted at boot or kept in reserve. See <a class="xref" href="ch08.html" title="Chapter 8. Disks and Filesystems">Chapter 8</a> for details.</p></div><div class="sect2" title="/etc/ftpchroot"><div class="titlepage"><div><div><h3 class="title" id="etc_ftpchroot">/etc/ftpchroot</h3></div></div></div><p>Users listed in <span class="emphasis"><em>/etc/ftpchroot</em></span> are automatically <code class="literal">chroot</code>ed into their home directory when they log in via FTP. See <code class="literal">ftpd(8)</code> for full details.</p><p>Try to avoid FTP, as it transmits usernames and passwords in cleartext. Use <code class="literal">scp(1)</code> or <code class="literal">sftp(1)</code> instead.</p></div><div class="sect2" title="/etc/ftpusers"><div class="titlepage"><div><div><h3 class="title" id="etc_ftpusers">/etc/ftpusers</h3></div></div></div><p>The <span class="emphasis"><em>/etc/ftpusers</em></span> file does exactly the opposite of what the filename implies, but it has been this way for decades, so don’t worry about it.</p><p>Any user listed in <span class="emphasis"><em>/etc/ftpusers</em></span> cannot log in via FTP. See <code class="literal">ftpd(8)</code> for details, but again, use <code class="literal">scp(1)</code> or <code class="literal">sftp(1)</code> instead—especially for administrative tasks!</p></div><div class="sect2" title="/etc/gettytab"><div class="titlepage"><div><div><h3 class="title" id="etc_gettytab">/etc/gettytab</h3></div></div></div><p>The <span class="emphasis"><em>/etc/gettytab</em></span> file contains the configuration information for login terminals. Unix-like systems have been traditionally accessed by anything and everything, from innumerable slightly different serial consoles to Secure Shell (SSH) sessions over the network. If you ever need to use a nonstandard terminal type, explore <span class="emphasis"><em>/etc/gettytab</em></span>.</p><p><a class="indexterm" id="idx0614"/><a class="indexterm" id="idx0616"/><a class="indexterm" id="idx0617"/><a class="indexterm" id="idx0621"/><a class="indexterm" id="idx0622"/><a class="indexterm" id="idx0623"/><a class="indexterm" id="idx0978"/><a class="indexterm" id="idx0981"/>There’s no reason to get rid of this file. After all, someone out there probably still uses a plugboard 1200-baud terminal. But there’s no longer any reason to modify it either. In any case, the man page is worth reading, especially if you read it to the end.</p></div><div class="sect2" title="/etc/group"><div class="titlepage"><div><div><h3 class="title" id="etc_group">/etc/group</h3></div></div></div><p>The <span class="emphasis"><em>/etc/group</em></span> file controls to which groups each user account belongs. User groups are covered in <a class="xref" href="ch06.html" title="Chapter 6. User Management">Chapter 6</a> and <a class="xref" href="ch07.html" title="Chapter 7. Root, and How to Avoid It">Chapter 7</a>.</p></div><div class="sect2" title="/etc/hostapd.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_hostapd_conf">/etc/hostapd.conf</h3></div></div></div><p>OpenBSD can act as a wireless access point. The host access point daemon (<code class="literal">hostapd(8)</code>) lets OpenBSD perform some complicated access point tasks that are useful in larger environments. OpenBSD’s wireless services are interesting if you use wireless; read <code class="literal">hostapd(8)</code> and <code class="literal">ifconfig(8)</code> for full details.</p></div><div class="sect2" title="/etc/hostname.*"><div class="titlepage"><div><div><h3 class="title" id="etc_hostname">/etc/hostname.*</h3></div></div></div><p>The <span class="emphasis"><em>/etc/hostname.*</em></span> files configure network interfaces, as discussed briefly in <a class="xref" href="ch04.html" title="Chapter 4. Post-Install Setup">Chapter 4</a> and at length in <a class="xref" href="ch12.html" title="Chapter 12. Connecting to the Network">Chapter 12</a>.</p></div><div class="sect2" title="/etc/hosts"><div class="titlepage"><div><div><h3 class="title" id="etc_hosts">/etc/hosts</h3></div></div></div><p>The <span class="emphasis"><em>/etc/hosts</em></span> file contains a hand-maintained map of IP addresses and hostnames. See <a class="xref" href="ch12.html" title="Chapter 12. Connecting to the Network">Chapter 12</a> for details.</p></div><div class="sect2" title="/etc/hosts.equiv"><div class="titlepage"><div><div><h3 class="title" id="etc_hosts_equiv">/etc/hosts.equiv</h3></div></div></div><p>The <span class="emphasis"><em>/etc/hosts.equiv</em></span> file is used by the various r-tools, such as <code class="literal">rcp(1)</code>, <code class="literal">rlogin(1)</code>, and <code class="literal">rsh(1)</code>. These tools, and the underlying protocols, are relics of an earlier age, when security on the Internet was not so great a concern. OpenBSD no longer includes an <code class="literal">rlogin(1)</code> client. The r-tools are largely replaced by SSH. Today, you should not use the r-protocols under any sensible circumstances.</p><p>The <span class="emphasis"><em>/etc/hosts.equiv</em></span> file should not contain any uncommented entries, unless you specifically put them there. This is the only system file I can reasonably say every sysadmin should verify is empty and marked immutable (see <a class="xref" href="ch10.html" title="Chapter 10. Securing Your System">Chapter 10</a>).</p><p>What did I mean by “sensible circumstances” and using the r-protocols? A few years ago, I worked on a network with ancient but mission-critical VMS servers manageable only by r-protocols, but those were not reasonable circumstances. If you find yourself similarly trapped, check out <code class="literal">hosts.equiv(5)</code>, <code class="literal">rshd(8)</code>, and <code class="literal">rsh(1)</code>. And do something about your circumstances.</p></div><div class="sect2" title="/etc/hosts.lpd"><div class="titlepage"><div><div><h3 class="title" id="etc_hosts_lpd">/etc/hosts.lpd</h3></div></div></div><p>You can configure an OpenBSD system to accept print requests from other machines and feed them to a locally attached printer. This was vital when printers were big, expensive beasts, but it’s less important today. This file lists the hostnames or IP addresses of systems that may use the local system’s line printer daemon, <code class="literal">lpd(8)</code>.</p><p><a class="indexterm" id="idx0624"/><a class="indexterm" id="idx0625"/><a class="indexterm" id="idx0626"/><a class="indexterm" id="idx0627"/><a class="indexterm" id="idx0628"/><a class="indexterm" id="idx0630"/><a class="indexterm" id="idx0631"/><a class="indexterm" id="idx0633"/><a class="indexterm" id="idx1016"/><a class="indexterm" id="idx1029"/><a class="indexterm" id="idx1069"/><a class="indexterm" id="idx1082"/><a class="indexterm" id="idx1103"/>If you’re really interested in having your OpenBSD system print, check out <code class="literal">lpd(8)</code> and <span class="emphasis"><em>/etc/printcap</em></span>.</p></div><div class="sect2" title="/etc/hotplug/"><div class="titlepage"><div><div><h3 class="title" id="etc_hotplug">/etc/hotplug/</h3></div></div></div><p>OpenBSD can automatically take action when a device is plugged into the system through <code class="literal">hotplugd(8)</code>. For example, if you attach your digital camera to a USB port, <code class="literal">hotplugd</code> can run a script that will attach the device node to a directory and make it readable by your user account.</p><p><code class="literal">hotplugd</code> runs the script <span class="emphasis"><em>/etc/hotplug/attach</em></span> when a device is attached, and <span class="emphasis"><em>/etc/hotplug/detach</em></span> when a device is removed. These scripts must be carefully written to match the devices being attached and detached. For details on how this works, see <code class="literal">hotplugd(8)</code>.</p></div><div class="sect2" title="/etc/ifstated.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_ifstated_conf">/etc/ifstated.conf</h3></div></div></div><p>The interface state daemon <code class="literal">ifstated(8)</code> monitors network conditions and takes action when specified events occur. For example, you can configure <code class="literal">ifstated</code> to watch for another server to go down, and when that server fails, start up the local web server. For more information about using <code class="literal">ifstated</code>, see Hansteen’s <span class="emphasis"><em>The Book of PF</em></span>.</p></div><div class="sect2" title="/etc/iked/, /etc/iked.conf, /etc/ipsec.conf, and /etc/isakmpd"><div class="titlepage"><div><div><h3 class="title" id="etc_iked_etc_iked_conf_etc_ipsec_conf_an">/etc/iked/, /etc/iked.conf, /etc/ipsec.conf, and /etc/isakmpd</h3></div></div></div><p>The <span class="emphasis"><em>/etc/iked/</em></span>, <span class="emphasis"><em>/etc/iked.conf</em></span>, <span class="emphasis"><em>/etc/ipsec.conf</em></span>, and <span class="emphasis"><em>/etc/isakmpd</em></span> files manage OpenBSD’s implementation of the IPsec standard for VPNs. OpenBSD has a very robust IPsec implementation, and it is actually used for testing by various interoperability groups.</p><p>You can fill entire books with the acronyms used for VPN technologies, let alone instructions for actually configuring them. See the man pages for details.</p></div><div class="sect2" title="/etc/inetd.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_inetd_conf">/etc/inetd.conf</h3></div></div></div><p>The Internet small service listener <code class="literal">inetd(8)</code> attaches to multiple network ports for programs that don’t need to run constantly. When a request on one of those ports comes in, <code class="literal">inetd</code> activates the correct program to handle the request. <a class="xref" href="ch16.html" title="Chapter 16. Network Servers">Chapter 16</a> discusses <code class="literal">inetd(8)</code> in more detail.</p></div><div class="sect2" title="/etc/kbdtype"><div class="titlepage"><div><div><h3 class="title" id="etc_kbdtype">/etc/kbdtype</h3></div></div></div><p>The <span class="emphasis"><em>/etc/kbdtype</em></span> file contains a single line with your preferred terminal keyboard mapping. Test your keyboard mapping with <code class="literal">kdb(1)</code>, and then put that keyboard mapping in <span class="emphasis"><em>/etc/kbdtype</em></span>.</p></div><div class="sect2" title="/etc/kerberosV/"><div class="titlepage"><div><div><h3 class="title" id="etc_kerberosv">/etc/kerberosV/</h3></div></div></div><p><a class="indexterm" id="idx0634"/><a class="indexterm" id="idx0635"/><a class="indexterm" id="idx0636"/><a class="indexterm" id="idx0637"/><a class="indexterm" id="idx0639"/><a class="indexterm" id="idx0640"/><a class="indexterm" id="idx0642"/><a class="indexterm" id="idx0647"/><a class="indexterm" id="idx0648"/><a class="indexterm" id="idx1185"/><a class="indexterm" id="idx1192"/><a class="indexterm" id="idx1250"/><a class="indexterm" id="idx1266"/><a class="indexterm" id="idx2638"/>The <span class="emphasis"><em>/etc/kerberosV/</em></span> directory contains configuration for the Kerberos centralized authentication system. I recommend some kind of centralized logon for every network. Configuring Kerberos properly is a large subject. If you’re interested, peruse <code class="literal">kerberos(1)</code>.</p></div><div class="sect2" title="/etc/ksh.kshrc"><div class="titlepage"><div><div><h3 class="title" id="etc_ksh_kshrc">/etc/ksh.kshrc</h3></div></div></div><p><span class="emphasis"><em>/etc/ksh.kshrc</em></span> is the global configuration file for the public domain Korn shell included with OpenBSD. Users must include this file in their personal <span class="emphasis"><em>.kshrc</em></span> for settings here to take effect. See the <code class="literal">ksh(1)</code> man page for details.</p></div><div class="sect2" title="/etc/ldap/ and /etc/ldapd.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_ldap_and_etc_ldapd_conf">/etc/ldap/ and /etc/ldapd.conf</h3></div></div></div><p>OpenBSD includes a Lightweight Directory Access Protocol (LDAP) daemon. LDAP is commonly used for centralized authentication, address books, and other database operations that are read more than they write. As of this writing, the features of <code class="literal">ldapd(8)</code> are not complete, but it’s good enough to provide a central authentication point.</p></div><div class="sect2" title="/etc/localtime"><div class="titlepage"><div><div><h3 class="title" id="etc_localtime">/etc/localtime</h3></div></div></div><p>The <span class="emphasis"><em>/etc/localtime</em></span> file is a symlink to the actual time zone file. To change the time zone, change the symlink. <a class="xref" href="ch04.html" title="Chapter 4. Post-Install Setup">Chapter 4</a> covers time zones.</p></div><div class="sect2" title="/etc/locate.rc"><div class="titlepage"><div><div><h3 class="title" id="etc_locate_rc">/etc/locate.rc</h3></div></div></div><p>The <span class="emphasis"><em>/etc/locate.rc</em></span> file controls creation of the <code class="literal">locate(1)</code> database. OpenBSD updates the locate database every week, as discussed in <a class="xref" href="ch15.html" title="Chapter 15. System Maintenance">Chapter 15</a>.</p></div><div class="sect2" title="/etc/login.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_login_conf">/etc/login.conf</h3></div></div></div><p>With <span class="emphasis"><em>/etc/login.conf</em></span>, you can control user account login behavior, as discussed in <a class="xref" href="ch06.html" title="Chapter 6. User Management">Chapter 6</a>.</p></div><div class="sect2" title="/etc/lynx.cfg"><div class="titlepage"><div><div><h3 class="title" id="etc_lynx_cfg">/etc/lynx.cfg</h3></div></div></div><p>OpenBSD includes the <code class="literal">lynx(1)</code> text-mode web browser. Lynx is endlessly configurable, and settings in <span class="emphasis"><em>/etc/lynx.cfg</em></span> affect all Lynx users on the system. You can save yourself a lot of trouble by configuring your proxy server settings here.</p></div><div class="sect2" title="/etc/magic"><div class="titlepage"><div><div><h3 class="title" id="etc_magic">/etc/magic</h3></div></div></div><p>Many files include a “magic number” and other characteristics specific to their type. <code class="literal">file(1)</code> uses these magic numbers to identify the file type, with <span class="emphasis"><em>/etc/magic</em></span> as an index of magic numbers. Do not manually edit <span class="emphasis"><em>/etc/magic</em></span>, as it’s automatically generated by compiling <code class="literal">file(1)</code>.</p></div><div class="sect2" title="/etc/mail/"><div class="titlepage"><div><div><h3 class="title" id="etc_mail">/etc/mail/</h3></div></div></div><p><a class="indexterm" id="idx0546"/><a class="indexterm" id="idx0649"/><a class="indexterm" id="idx0651"/><a class="indexterm" id="idx0652"/><a class="indexterm" id="idx0653"/><a class="indexterm" id="idx1269"/><a class="indexterm" id="idx1274"/><a class="indexterm" id="idx1521"/><a class="indexterm" id="idx2080"/><a class="indexterm" id="idx2142"/><a class="indexterm" id="idx2158"/>The <span class="emphasis"><em>/etc/mail/</em></span> directory contains the configuration files for OpenBSD’s email software. OpenBSD includes two email packages: the old workhorse Sendmail and the OpenBSD-created <code class="literal">smptd(8)</code>. <code class="literal">smptd</code> isn’t <span class="emphasis"><em>quite</em></span> ready for production use, but it might be by the time this book hits the shelves.</p><p>This directory also contains <span class="emphasis"><em>/etc/mail/aliases</em></span>, a list of mail redirections. Be sure you set the email alias for your root account to somewhere you’ll actually read your email, as discussed in <a class="xref" href="ch04.html" title="Chapter 4. Post-Install Setup">Chapter 4</a>.</p></div><div class="sect2" title="/etc/mail.rc"><div class="titlepage"><div><div><h3 class="title" id="etc_mail_rc">/etc/mail.rc</h3></div></div></div><p>The <span class="emphasis"><em>/etc/mail.rc</em></span> file has nothing to do with sending or receiving email as a mail server. It’s the global configuration file for the <code class="literal">mail(1)</code> email client. While more advanced email clients have almost completely superseded <code class="literal">mail</code>, it’s worth exploring because almost any Unix-like system will have it installed.</p></div><div class="sect2" title="/etc/mailer.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_mailer_conf">/etc/mailer.conf</h3></div></div></div><p>Traditionally, the only mail server program available for any Unix-like operating system was Sendmail. As such, a huge amount of add-on software expects to find <span class="emphasis"><em>/usr/sbin/sendmail</em></span> and expects it to behave in a certain manner. It doesn’t matter that, by modern standards, Sendmail and the whole Simple Mail Transfer Protocol (SMTP) are baroque and bizarre; software expects to find it.</p><p>Worse, <code class="literal">sendmail(8)</code> behaved differently depending on what name it was called with. Programs such as <code class="literal">send-mail</code>, <code class="literal">mailq</code>, and <code class="literal">newaliases</code> are all Sendmail wearing different hats. If you call the Sendmail program by running the <code class="literal">mailq</code> command, it runs differently than if you call it by running the <code class="literal">newaliases</code> command. They all point to the same binary on disk, however. Third-party software expects to find all these names as well, and that these commands behave as required.</p><p>Sendmail is such a standard that writers of newer mail server programs are forced to call them <code class="literal">sendmail</code> and to have them behave exactly as Sendmail does, just to maintain compatibility with this vast installed base. This makes using alternate mailers confusing. Also, OpenBSD includes Sendmail as part of the base system. You can’t just remove Sendmail and go on. Upgrades reinstall brand-name Sendmail.</p><p>OpenBSD does an end run around all this confusion by eliminating <span class="emphasis"><em>/usr/sbin/sendmail</em></span> as an actual mail program. Instead, the <code class="literal">sendmail</code> program is just a wrapper that calls the real mail-handling software. The entries in <span class="emphasis"><em>/etc/mailer.conf</em></span> are just a list of classic Sendmail program names, along with the path to the actual program to be run. The mail-handling program <code class="literal">sendmail</code> is actually installed as <span class="emphasis"><em>/usr/libexec/sendmail/sendmail</em></span>, for example.</p><p>To run an alternate mail server, give <span class="emphasis"><em>/etc/mailer.conf</em></span> the expected command name and the full path to all of the appropriate programs. This happens automatically when you install a new mail transfer agent from a package.</p></div><div class="sect2" title="/etc/man.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_man_conf">/etc/man.conf</h3></div></div></div><p><a class="indexterm" id="idx0386"/><a class="indexterm" id="idx0654"/><a class="indexterm" id="idx1299"/><a class="indexterm" id="idx1306"/><a class="indexterm" id="idx1307"/><a class="indexterm" id="idx1320"/><a class="indexterm" id="idx2038"/><a class="indexterm" id="idx2645"/><a class="indexterm" id="idx2648"/>The <span class="emphasis"><em>etc/man.conf</em></span> file tells <code class="literal">man(1)</code> how to find and present man pages. If you install software in nonstandard locations, add the information on the software’s man pages to <span class="emphasis"><em>man.conf</em></span> so that you can call up those man pages transparently. This file has several types of entries, each of which is set off by keywords or section names.</p><p>Why would you do this? If you must install software from a source other than ports or packages, you could place it in a directory tree outside those managed by OpenBSD to reduce confusion when upgrading or adding software.</p><p>For example, I occasionally install Wireshark on an OpenBSD desktop. The OpenBSD team decided to remove OpenBSD’s Wireshark package because it has such a shaky security history. If I installed Wireshark as <span class="emphasis"><em>/usr/local/bin</em></span>, it would be mingled with my packaged software. If I install Wireshark as <span class="emphasis"><em>/usr/local/wireshark/bin</em></span>, however, it’s clearly distinct from packaged software. I can’t access the man pages, however, as <code class="literal">man(1)</code> doesn’t know about <span class="emphasis"><em>/usr/local/wireshark/man</em></span>.<sup>[<a class="footnote" epub:type="noteref" href="#ftn.id430592" id="id430592">39</a>]</sup> Let’s walk through how we would add man page access for Wireshark.</p><div class="sect3" title="Adding to the Search Index"><div class="titlepage"><div><div><h4 class="title" id="adding_to_the_search_index">Adding to the Search Index</h4></div></div></div><p>The <code class="literal">_whatdb</code> keyword gives the full path to a <code class="literal">whatis(1)</code> database, used by <code class="literal">apropos(1)</code> and <code class="literal">whatis(1)</code>, allowing you to easily search and cross-index man pages. The file <span class="emphasis"><em>man.conf</em></span> has entries for databases in <span class="emphasis"><em>/usr/local/man</em></span>, <span class="emphasis"><em>/usr/share/man</em></span>, and <span class="emphasis"><em>/usr/X11R6/man</em></span>. Here’s how to add an entry for <span class="emphasis"><em>/usr/local/wireshark/man</em></span>:</p><a id="I_programlisting14_id471555"/><pre class="programlisting">_whatdb /usr/local/wireshark/man/whatis.db</pre><p>Now we create a new database with <code class="literal">makewhatis(8)</code>. This job runs automatically when you install software and during weekly maintenance.</p></div><div class="sect3" title="Adding to Man Page Directories"><div class="titlepage"><div><div><h4 class="title" id="adding_to_man_page_directories">Adding to Man Page Directories</h4></div></div></div><p>Man pages are scattered in directories all over the system. The <code class="literal">_default</code> keyword tells <code class="literal">man(1)</code> which directories to search automatically. Use only one <code class="literal">_default</code> keyword, but list multiple directories if needed, and group directories using brackets.</p><p>Here’s the standard directory list:</p><a id="I_programlisting14_id471600"/><pre class="programlisting">_default /usr/{share, X11R6,local,ports/infrastructure}/man/</pre><p>This is a pretty massive group of directories, and the brackets combine multiple directories associatively. For example, this entry means that we check <span class="emphasis"><em>/usr/share/man/</em></span>, <span class="emphasis"><em>/usr/X11R6/man/</em></span>, <span class="emphasis"><em>/usr/local/man/</em></span>, and <span class="emphasis"><em>/usr/local/ports/infrastructure/man/</em></span>. (The entries end with a slash, which means that the final directories contain subdirectories.)</p><p><a class="indexterm" id="idx0212"/><a class="indexterm" id="idx1309"/><a class="indexterm" id="idx1311"/><a class="indexterm" id="idx1730"/><a class="indexterm" id="idx2259"/><a class="indexterm" id="idx2546"/>To add <span class="emphasis"><em>/usr/local/wireshark/man/</em></span> to the default locations, add <code class="literal">local/wireshark</code> into the associative array, like this:</p><a id="I_programlisting14_id471686"/><pre class="programlisting">_default /usr/{share, X11R6,local,ports/infrastructure,local/wireshark}/man/</pre><p>The <code class="literal">_subdir</code> keyword lists subdirectories to be searched beneath the main directories, in order, with the first match returned first.</p><a id="I_programlisting14_id471698"/><pre class="programlisting">_subdir  man1 man8 man6 man2 man3 man5 man7 man4 man9 man3p man3f mann</pre><p>You can use <code class="literal">_subdir</code> to change the order in which man pages are returned. For example, if your job is programming Perl on OpenBSD, you might want to see the Perl man pages by default. In that case, you could move the <span class="emphasis"><em>man3p</em></span> subdirectory to the front of the list.</p></div><div class="sect3" title="Displaying Man Pages"><div class="titlepage"><div><div><h4 class="title" id="displaying_man_pages">Displaying Man Pages</h4></div></div></div><p>Software vendors distribute their manuals in the format they think best. As a sysadmin, this means you might as well get manuals in random formats, because each format needs a different command to display it. Fortunately, each format has a different filename suffix, which tells <code class="literal">man(1)</code> how to display the file. The <code class="literal">_build</code> keyword defines a filename suffix and the command used to display the file. (It’s very unlikely that you’ll have a man page that requires a new <code class="literal">_build</code> statement.)</p></div><div class="sect3" title="Defining Man Sections"><div class="titlepage"><div><div><h4 class="title" id="defining_man_sections">Defining Man Sections</h4></div></div></div><p>The final <span class="emphasis"><em>man.conf</em></span> function is dividing the manual into sections. We saw in <a class="xref" href="ch01.html" title="Chapter 1. Getting Additional Help">Chapter 1</a> that you can search the manual by particular sections to get specific man pages. These sections are nothing more than directories identified in <span class="emphasis"><em>/etc/man.conf</em></span>. Here’s where we define the man pages included in section 1.</p><a id="I_programlisting14_id471769"/><pre class="programlisting">1 /usr/{share,X11R6,local}/man/man1</pre><p>There’s no trailing slash, because we’re not adding any subdirectories. These are the actual directories containing section 1 of the manual.</p><p>You can define arbitrary section names in <span class="emphasis"><em>/etc/man.conf</em></span>. While you should avoid section names beginning with an underscore in order to prevent confusion with keywords, you can do just about anything else.</p></div></div><div class="sect2" title="/etc/master.passwd, /etc/passwd, /etc/spwd.db, and /etc/pwd.db"><div class="titlepage"><div><div><h3 class="title" id="etc_master_passwd_etc_passwd_etc_spwd_db">/etc/master.passwd, /etc/passwd, /etc/spwd.db, and /etc/pwd.db</h3></div></div></div><p>The <span class="emphasis"><em>/etc/master.passwd</em></span>, <span class="emphasis"><em>/etc/passwd</em></span>, <span class="emphasis"><em>/etc/spwd.db</em></span>, and <span class="emphasis"><em>/etc/pwd.db</em></span> files contain usernames and passwords, along with a few other key items about locally defined users. When you log in, the password you type is compared with the encrypted and salted hash of your password in this file. As such, <span class="emphasis"><em>/etc/master.passwd</em></span> is vital to system security.</p><div class="sect3" title="Editing /etc/master.passwd"><div class="titlepage"><div><div><h4 class="title" id="editing_etc_master_passwd">Editing /etc/master.passwd</h4></div></div></div><p><a class="indexterm" id="idx0020"/><a class="indexterm" id="idx0250"/><a class="indexterm" id="idx0658"/><a class="indexterm" id="idx0703"/><a class="indexterm" id="idx0752"/><a class="indexterm" id="idx2609"/>If you’re considering editing <span class="emphasis"><em>/etc/master.passwd</em></span> directly, <span class="bolditalic">stop</span>. Go back to <a class="xref" href="ch06.html" title="Chapter 6. User Management">Chapter 6</a>. Reread it. See if there’s another way to make your desired change. Damaging <span class="emphasis"><em>/etc/master.passwd</em></span> can prevent people from logging in at all, and might render your system unusable. To edit a single user account in <span class="emphasis"><em>/etc/master.passwd</em></span>, run <code class="literal">chpass(1)</code> as root.</p><p>If you must edit <span class="emphasis"><em>/etc/master.passwd</em></span> directly—say, to change everyone’s home directory to point to a new filesystem—there’s a program just for that. The program <code class="literal">vipw(8)</code> calls up the text editor in <code class="literal">$EDITOR</code>, loads the password file, lets you make changes, and checks the file syntax before saving it. <code class="literal">vipw</code> also updates <span class="emphasis"><em>/etc/passwd</em></span> and the password databases <span class="emphasis"><em>/etc/pwd.db</em></span> and <span class="emphasis"><em>/etc/spwd.db</em></span>.</p><p>Be absolutely sure that this file is synchronized with the password databases. Using <code class="literal">vipw</code> prevents many basic mistakes and helps ensure data consistency, but if you’re really bent on corrupting <span class="emphasis"><em>/etc/master.passwd</em></span>, <code class="literal">vipw(8)</code> will make your task more difficult but won’t stop you.</p><p>That said, only senior sysadmins should use <code class="literal">vipw</code>. How do you know if you qualify? If you’ve made enough horrible mistakes with <code class="literal">vipw</code> that you know in your bones not to use it, if your stomach churns at the mere thought of typing those four letters, you may use <code class="literal">vipw</code>.</p></div><div class="sect3" title="Controlling Account Information Access"><div class="titlepage"><div><div><h4 class="title" id="controlling_account_information_access">Controlling Account Information Access</h4></div></div></div><p>Many programs need parts of the information stored in <span class="emphasis"><em>/etc/master.passwd</em></span>. For example, a program must be able to look up a user’s shell and home directory to properly find the user’s files. Rather than allowing anyone to read this file and the scrambled passwords therein, OpenBSD (and most other Unix-like systems) provide the account information everyone needs to see in <span class="emphasis"><em>/etc/passwd</em></span>.</p><p>Accessing and parsing a text file can be slow, especially if the computer has a slow processor and many user accounts. Text files are not meant for searching. If a program must search a text file for user account number 10631, the search can hold up the program’s activity and even block other programs. Checking a database for an entry is much faster, as the program can just say “Give me account 10631” and get a response from a file store intended for searches.</p><p>All Unix-like systems create databases from the password files whenever the account information changes. The database of public account information, built from <span class="emphasis"><em>/etc/passwd</em></span>, is <span class="emphasis"><em>/etc/pwd.db</em></span>. The database file <span class="emphasis"><em>/etc/spwd.db</em></span> contains private account information built from <span class="emphasis"><em>/etc/master.passwd</em></span>.</p><p>Realistically, very few pieces of software actually use the password file directly. Most programs access <span class="emphasis"><em>pwd.db</em></span>. I know people who delete <span class="emphasis"><em>/etc/passwd</em></span> without ill effect, but you do need to keep the password database.</p></div><div class="sect3" title="/etc/master.passwd Fields"><div class="titlepage"><div><div><h4 class="title" id="etc_master_passwd_fields">/etc/master.passwd Fields</h4></div></div></div><p><a class="indexterm" id="idx0659"/><a class="indexterm" id="idx2527"/>Each account is a line in <span class="emphasis"><em>/etc/master.passwd</em></span> and <span class="emphasis"><em>/etc/passwd</em></span>. Each line has the following nine fields, separated by colons.</p><div class="blockquote" title="Username"><blockquote class="blockquote" title="Username"><div class="blockquote-title">Username</div><p>This field contains either an account created by the sysadmin and used by a human, or a nonprivileged user created for use by a program or service. <a class="xref" href="ch06.html" title="Chapter 6. User Management">Chapter 6</a> covers usernames.</p></blockquote></div><div class="blockquote" title="Hashed and Salted Password"><blockquote class="blockquote" title="Hashed and Salted Password"><div class="blockquote-title">Hashed and Salted Password</div><p>This field contains the user’s password, hashed and salted. (It’s commonly called a hash, but you should know it’s more than that.) You cannot derive the password from the hash, but if you have the hash, you can try passwords until you find one that matches the hash. That’s why you must protect your <span class="emphasis"><em>/etc/master.passwd</em></span> file. In <span class="emphasis"><em>/etc/passwd</em></span>, the password field is blank.</p></blockquote></div><div class="note" title="Note"><h3 class="title"><a id="ch14note01"/>Note</h3><p>One simple way to temporarily disable a user account is to edit the password file with <code class="literal">chpass(1)</code> and put an asterisk (<code class="literal">*</code>) in front of the hash. While the account will still be active, no one will be able to log in to it. I’ve used this to great effect when a client is behind on a bill. While clients can ignore overdue payment notices, they call quite quickly when they cannot access their account. I can easily route that call to the billing department. Once the matter is resolved, I can re-enable their account by removing the asterisk.</p></div><div class="blockquote" title="User ID Number"><blockquote class="blockquote" title="User ID Number"><div class="blockquote-title">User ID Number</div><p>The third field is the user ID number, or UID. Every user must have a unique UID.</p></blockquote></div><div class="blockquote" title="Group ID Number"><blockquote class="blockquote" title="Group ID Number"><div class="blockquote-title">Group ID Number</div><p>This field is the group ID number, or GID. This is the user’s primary group, as discussed in <a class="xref" href="ch06.html" title="Chapter 6. User Management">Chapter 6</a>. Usually, this is the same as the UID, and the user’s primary group has the same name as the username. Some sites prefer to use a single group for all unprivileged users.</p></blockquote></div><div class="blockquote" title="User Class"><blockquote class="blockquote" title="User Class"><div class="blockquote-title">User Class</div><p>We discuss the user class in <a class="xref" href="ch06.html" title="Chapter 6. User Management">Chapter 6</a>. Changing the class can increase or decrease the amount of system resources the user can access.</p></blockquote></div><div class="blockquote" title="Password Expiration Date"><blockquote class="blockquote" title="Password Expiration Date"><div class="blockquote-title">Password Expiration Date</div><p>The expiration date is expressed in the number of seconds since midnight, January 1, 1970, the UNIX epoch. You can convert dates to seconds with <code class="literal">date(1)</code>. If you must manually set an expiration date for a password, use <code class="literal">chpass(1)</code> and specify a human-readable date.</p></blockquote></div><div class="blockquote" title="Gecos"><blockquote class="blockquote" title="Gecos"><div class="blockquote-title">Gecos</div><p><a class="indexterm" id="idx0082"/><a class="indexterm" id="idx0194"/><a class="indexterm" id="idx0449"/><a class="indexterm" id="idx0660"/><a class="indexterm" id="idx0662"/><a class="indexterm" id="idx0663"/><a class="indexterm" id="idx0664"/><a class="indexterm" id="idx0665"/><a class="indexterm" id="idx1294"/><a class="indexterm" id="idx1384"/>This field contains the user’s real name, office number, work phone number, and home phone number, all separated by commas. This information was much more important when computers were big systems with hundreds or thousands of users, and you might need to contact people when their process went completely insane. Today, it’s basically ignored. (Do not use colons here; colons are reserved specifically for separating fields in <span class="emphasis"><em>/etc/master.passwd</em></span>.)</p></blockquote></div><div class="blockquote" title="User’s Home Directory"><blockquote class="blockquote" title="User’s Home Directory"><div class="blockquote-title">User’s Home Directory</div><p>This field is the user’s home directory. While this defaults to a directory with the same name as the username, beneath <span class="emphasis"><em>/home</em></span>, you can move this directory anywhere you like. Editing the home directory in the password file does not move the actual directory; you need to do that yourself.</p></blockquote></div><div class="blockquote" title="User’s Shell"><blockquote class="blockquote" title="User’s Shell"><div class="blockquote-title">User’s Shell</div><p>The last field gives the user’s shell. If this field is empty, the user gets boring old <span class="emphasis"><em>/bin/sh</em></span>.</p></blockquote></div></div></div><div class="sect2" title="/etc/mixerctl.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_mixerctl_conf">/etc/mixerctl.conf</h3></div></div></div><p>OpenBSD includes solid audio abilities. You can listen to MP3s, mix music, or just about anything else you would like.</p><p>Control audio settings with <code class="literal">mixectl(8)</code>, and set boot-time <code class="literal">mixerctl</code> settings in <span class="emphasis"><em>/etc/mixerctl.conf</em></span>.</p></div><div class="sect2" title="/etc/mk.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_mk_conf">/etc/mk.conf</h3></div></div></div><p>Configure <code class="literal">make(1)</code> with <span class="emphasis"><em>/etc/mk.conf</em></span>. The most common use for special <code class="literal">make</code> settings is while you are building ports (covered in <a class="xref" href="ch13.html" title="Chapter 13. Software Management">Chapter 13</a>) or while building your own custom OpenBSD release (<a class="xref" href="ch20.html" title="Chapter 20. Upgrading">Chapter 20</a>).</p></div><div class="sect2" title="/etc/moduli"><div class="titlepage"><div><div><h3 class="title" id="etc_moduli">/etc/moduli</h3></div></div></div><p>The <span class="emphasis"><em>/etc/moduli</em></span> file contains prime numbers, used for Diffie-Hellman cryptography. Never edit this file. Some people may understand cryptography well enough to edit <span class="emphasis"><em>/etc/moduli</em></span>, but if you’re reading this book, you’re probably not one of them.<sup>[<a class="footnote" epub:type="noteref" href="#ftn.id344316" id="id344316">40</a>]</sup></p></div><div class="sect2" title="/etc/monthly and /etc/monthly.local"><div class="titlepage"><div><div><h3 class="title" id="etc_monthly_and_etc_monthly_local">/etc/monthly and /etc/monthly.local</h3></div></div></div><p>The <span class="emphasis"><em>/etc/monthly.local</em></span> shell script runs once per month as part of routine system maintenance. <a class="xref" href="ch15.html" title="Chapter 15. System Maintenance">Chapter 15</a> discusses scheduled maintenance jobs.</p></div><div class="sect2" title="/etc/motd"><div class="titlepage"><div><div><h3 class="title" id="etc_motd">/etc/motd</h3></div></div></div><p><a class="indexterm" id="idx0666"/><a class="indexterm" id="idx0667"/><a class="indexterm" id="idx0668"/><a class="indexterm" id="idx0669"/><a class="indexterm" id="idx0671"/><a class="indexterm" id="idx0676"/><a class="indexterm" id="idx0677"/><a class="indexterm" id="idx0678"/><a class="indexterm" id="idx0680"/><a class="indexterm" id="idx1356"/><a class="indexterm" id="idx1388"/><a class="indexterm" id="idx1413"/><a class="indexterm" id="idx1415"/><a class="indexterm" id="idx1528"/>The MOTD, or message of the day, is displayed to users upon login. In this file, you might put system notices or announcements that you hope users will notice. Many organizations put legal notices or acceptable use policies in <span class="emphasis"><em>/etc/motd</em></span>.</p><p>Note that the first line of <span class="emphasis"><em>/etc/motd</em></span> is overwritten at every boot. Start your legal warning in line 2 or below.</p></div><div class="sect2" title="/etc/mrouted.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_mrouted_conf">/etc/mrouted.conf</h3></div></div></div><p>In addition to <code class="literal">dvmrpd(8)</code>, OpenBSD supports multicast routing with <code class="literal">mrouted(8)</code>. The <code class="literal">dvmrpd</code> implementation is preferred, but for specific edge cases, you might need <code class="literal">mrouted</code> instead.</p><p>Configure <code class="literal">mrouted</code> in <span class="emphasis"><em>/etc/mrouted.conf</em></span>. Eventually, <code class="literal">mrouted</code> will be removed from OpenBSD.</p></div><div class="sect2" title="/etc/mtree/"><div class="titlepage"><div><div><h3 class="title" id="etc_mtree">/etc/mtree/</h3></div></div></div><p>The <span class="emphasis"><em>/etc/mtree/</em></span> directory contains a list of most directories on a stock OpenBSD system, with their ownership and permissions. The system upgrade process uses this. While you don’t really need to edit these files, it’s nice to know what the heck they’re for.</p></div><div class="sect2" title="/etc/mygate"><div class="titlepage"><div><div><h3 class="title" id="etc_mygate">/etc/mygate</h3></div></div></div><p>The <span class="emphasis"><em>/etc/mygate</em></span> script gives the address of the default gateway for both IPv4 and IPv6, as discussed in <a class="xref" href="ch12.html" title="Chapter 12. Connecting to the Network">Chapter 12</a>.</p></div><div class="sect2" title="/etc/myname"><div class="titlepage"><div><div><h3 class="title" id="etc_myname">/etc/myname</h3></div></div></div><p>The <span class="emphasis"><em>/etc/myname</em></span> file contains the hostname of the system, as discussed in <a class="xref" href="ch04.html" title="Chapter 4. Post-Install Setup">Chapter 4</a>.</p></div><div class="sect2" title="/etc/netstart"><div class="titlepage"><div><div><h3 class="title" id="etc_netstart">/etc/netstart</h3></div></div></div><p>The <span class="emphasis"><em>/etc/netstart</em></span> script starts the network, as discussed in <a class="xref" href="ch12.html" title="Chapter 12. Connecting to the Network">Chapter 12</a>.</p></div><div class="sect2" title="/etc/networks"><div class="titlepage"><div><div><h3 class="title" id="etc_networks">/etc/networks</h3></div></div></div><p><span class="emphasis"><em>/etc/networks</em></span> is a list of subnets and their names. Use of a networks database has fallen out of favor, because it’s not terribly useful.</p></div><div class="sect2" title="/etc/newsyslog.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_newsyslog_conf">/etc/newsyslog.conf</h3></div></div></div><p>The <code class="literal">newsyslog(8)</code> program rotates log files, as discussed in <a class="xref" href="ch15.html" title="Chapter 15. System Maintenance">Chapter 15</a>.</p></div><div class="sect2" title="/etc/nginx/"><div class="titlepage"><div><div><h3 class="title" id="etc_nginx">/etc/nginx/</h3></div></div></div><p>OpenBSD has imported the <code class="literal">nginx</code> web server (<span class="emphasis"><em><a class="ulink" href="http://www.nginx.org/" target="_top">http://www.nginx.org/</a></em></span>) as a replacement for the older Apache 1.3 server, but as of this writing, it’s not quite integrated with the rest of the system. You can find the <code class="literal">nginx</code> configuration files in this directory, and the server is quite usable, but it’s not the official OpenBSD web server—yet.</p></div><div class="sect2" title="/etc/nsd.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_nsd_conf">/etc/nsd.conf</h3></div></div></div><p><a class="indexterm" id="idx0448"/><a class="indexterm" id="idx0681"/><a class="indexterm" id="idx0683"/><a class="indexterm" id="idx0686"/><a class="indexterm" id="idx0687"/><a class="indexterm" id="idx0689"/><a class="indexterm" id="idx0697"/><a class="indexterm" id="idx0698"/><a class="indexterm" id="idx0699"/><a class="indexterm" id="idx0702"/><a class="indexterm" id="idx1759"/><a class="indexterm" id="idx1864"/>OpenBSD has imported the name server daemon <code class="literal">nsd(8)</code> to eventually partially replace the old DNS workhorse server <code class="literal">named(8)</code>. It’s usable, but as of this writing, it’s not yet integrated with the system.</p></div><div class="sect2" title="/etc/ntpd.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_ntpd_conf">/etc/ntpd.conf</h3></div></div></div><p>The NTP daemon keeps the system time synchronized with other machines on your network and the Internet. We discuss <code class="literal">ntpd(8)</code> in <a class="xref" href="ch15.html" title="Chapter 15. System Maintenance">Chapter 15</a>.</p></div><div class="sect2" title="/etc/ospf6d.conf and /etc/ospfd.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_ospf6d_conf_and_etc_ospfd_conf">/etc/ospf6d.conf and /etc/ospfd.conf</h3></div></div></div><p>OSPF is a routing protocol used inside autonomous networks. OpenBSD has two OSPF implementations: one for IPv4 and one for IPv6. If you want to know more about OSPF, read <code class="literal">ospfd(8)</code> and <code class="literal">ospf6d(8)</code>.</p></div><div class="sect2" title="/etc/pf.conf and /etc/pf.os"><div class="titlepage"><div><div><h3 class="title" id="etc_pf_conf_and_etc_pf_os">/etc/pf.conf and /etc/pf.os</h3></div></div></div><p>Configure the OpenBSD <code class="literal">pf(4)</code> packet filter in <span class="emphasis"><em>/etc/pf.conf</em></span>. Packet filtering uses <span class="emphasis"><em>/etc/pf.os</em></span> to fingerprint other operating systems. <a class="xref" href="ch21.html" title="Chapter 21. Packet Filtering">Chapter 21</a> and <a class="xref" href="ch22.html" title="Chapter 22. Advanced PF">Chapter 22</a> cover packet filtering.</p></div><div class="sect2" title="/etc/ppp/"><div class="titlepage"><div><div><h3 class="title" id="etc_ppp">/etc/ppp/</h3></div></div></div><p>You can connect OpenBSD to the Internet via a dial-up modem, which is rarely done these days. If you need to configure a modem on your OpenBSD system, read the <code class="literal">ppp(8)</code> man page.</p></div><div class="sect2" title="/etc/printcap"><div class="titlepage"><div><div><h3 class="title" id="etc_printcap">/etc/printcap</h3></div></div></div><p>The printer capability file describes all printers that this system can access. Making a Unix-like system work with a random printer was long considered to require some sort of sacrifice, a moon in the correct phase, and a team of chanting acolytes in robes. While complicated software such as CUPS has been written to simplify printing, configuring an OpenBSD machine to print to a print server or a network PostScript printer is pretty simple. See <a class="xref" href="ch16.html" title="Chapter 16. Network Servers">Chapter 16</a> for details on printing.</p></div><div class="sect2" title="/etc/protocols"><div class="titlepage"><div><div><h3 class="title" id="etc_protocols">/etc/protocols</h3></div></div></div><p>The <span class="emphasis"><em>/etc/protocols</em></span> file contains protocol numbers for TCP/IP network protocols. <a class="xref" href="ch11.html" title="Chapter 11. Overview of TCP/IP">Chapter 11</a> covers TCP/IP versions 4 and 6 in detail.</p></div><div class="sect2" title="/etc/rbootd.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_rbootd_conf">/etc/rbootd.conf</h3></div></div></div><p><a class="indexterm" id="idx0705"/><a class="indexterm" id="idx0709"/><a class="indexterm" id="idx0728"/><a class="indexterm" id="idx0731"/><a class="indexterm" id="idx0733"/><a class="indexterm" id="idx0735"/><a class="indexterm" id="idx0736"/><a class="indexterm" id="idx0737"/><a class="indexterm" id="idx1203"/><a class="indexterm" id="idx1923"/><a class="indexterm" id="idx1941"/><a class="indexterm" id="idx1955"/><a class="indexterm" id="idx1972"/><a class="indexterm" id="idx1973"/><a class="indexterm" id="idx1975"/><a class="indexterm" id="idx2086"/><code class="literal">rbootd(8)</code> offers boot services for HP workstations—a very narrow subset of obsolete diskless clients. OpenBSD still supports the HP300 machines that need this service. If you’re interested in diskless operations on modern hardware, read the <code class="literal">diskless(8)</code> man page instead, or look at <a class="xref" href="ch23.html" title="Chapter 23. Customizing OpenBSD">Chapter 23</a>.</p></div><div class="sect2" title="/etc/rc.*"><div class="titlepage"><div><div><h3 class="title" id="etc_rc">/etc/rc.*</h3></div></div></div><p>The <span class="emphasis"><em>/etc/rc.*</em></span> files are used for system booting, as discussed in tortuous detail in <a class="xref" href="ch05.html" title="Chapter 5. The Boot Process">Chapter 5</a>.</p></div><div class="sect2" title="/etc/relayd.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_relayd_conf">/etc/relayd.conf</h3></div></div></div><p>The load balancer daemon <code class="literal">relayd(8)</code> works with the OpenBSD Packet Filter (PF) system to act as a network load balancer. The <code class="literal">relayd</code> daemon requires a good understanding of PF, however, and a very specific network. If you’re interested in load balancing, read Hansteen’s <span class="emphasis"><em>The Book of PF</em></span>.</p></div><div class="sect2" title="/etc/remote"><div class="titlepage"><div><div><h3 class="title" id="etc_remote">/etc/remote</h3></div></div></div><p>Unix-like systems have extensive support for connecting into the system over serial lines, usually for serial consoles. Many network appliances have management serial ports, and you can use OpenBSD as a client to configure these devices. The <span class="emphasis"><em>/etc/remote</em></span> file contains serial connection configurations for most common modern serial connections (covered in <a class="xref" href="ch05.html" title="Chapter 5. The Boot Process">Chapter 5</a>).</p></div><div class="sect2" title="/etc/resolv.conf and /etc/resolv.conf.tail"><div class="titlepage"><div><div><h3 class="title" id="etc_resolv_conf_and_etc_resolv_conf_tail">/etc/resolv.conf and /etc/resolv.conf.tail</h3></div></div></div><p>The <span class="emphasis"><em>/etc/resolv.conf</em></span> and /<span class="emphasis"><em>etc/resolv.conf.tail</em></span> files configure the resolver (covered in <a class="xref" href="ch12.html" title="Chapter 12. Connecting to the Network">Chapter 12</a>), letting the host map names to IP addresses and vice versa.</p></div><div class="sect2" title="/etc/ripd.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_ripd_conf">/etc/ripd.conf</h3></div></div></div><p>RIP is an old way to broadcast routing instructions across a network. OpenBSD has a RIP daemon, <code class="literal">ripd(8)</code>, configured in <span class="emphasis"><em>/etc/ripd.conf</em></span>.</p><p>RIP is generally considered undesirable, like the r-services. Among other shortcomings, it doesn’t even support netmasks, so it’s restricted to old-style class A, B, and C networks. And as with the r-services, sometimes you’re stuck with RIP because some obsolete device on your network can handle nothing else. Use <code class="literal">ripd</code> to scrape by until you can arrange a tragic accident for that device.</p></div><div class="sect2" title="/etc/rmt"><div class="titlepage"><div><div><h3 class="title" id="etc_rmt">/etc/rmt</h3></div></div></div><p>The remote magnetic tape command (<code class="literal">rmt</code>) lets a host access a tape drive on another machine. It’s most commonly used to restore a system from backup.</p></div><div class="sect2" title="/etc/rpc"><div class="titlepage"><div><div><h3 class="title" id="etc_rpc">/etc/rpc</h3></div></div></div><p><a class="indexterm" id="idx0738"/><a class="indexterm" id="idx0739"/><a class="indexterm" id="idx0740"/><a class="indexterm" id="idx0743"/><a class="indexterm" id="idx0747"/><a class="indexterm" id="idx0748"/><a class="indexterm" id="idx0749"/><a class="indexterm" id="idx2006"/><a class="indexterm" id="idx2015"/><a class="indexterm" id="idx2074"/><a class="indexterm" id="idx2081"/><a class="indexterm" id="idx2092"/><a class="indexterm" id="idx2155"/>RPC is a method for executing commands on a remote server. Much like TCP/IP, RPC has service and port numbers. The file <span class="emphasis"><em>/etc/rpc</em></span> contains a list of these services and port numbers. The most common RPC consumer in OpenBSD is NFS, as discussed in <a class="xref" href="ch09.html" title="Chapter 9. More Filesystems">Chapter 9</a>.</p></div><div class="sect2" title="/etc/sasyncd.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_sasyncd_conf">/etc/sasyncd.conf</h3></div></div></div><p>OpenBSD supports failover between IPsec gateways, using the security association synchronization daemon <code class="literal">sasyncd(8)</code>. This is not a common feature in operating systems, and its presence is a highlight in OpenBSD. To learn about IPsec failover, read <code class="literal">sasyncd(8)</code>.</p></div><div class="sect2" title="/etc/sensorsd.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_sensorsd_conf">/etc/sensorsd.conf</h3></div></div></div><p>Modern hardware has sensors for detecting items like fan speed, circuit voltage, temperature, and so on. OpenBSD’s <code class="literal">sensord(8)</code> reads these sensors and presents the information to the user. Configure which sensors you want to pay attention to, as well as what you want to do when the sensors detect something, in <span class="emphasis"><em>/etc/sensorsd.conf</em></span>. See <a class="xref" href="ch15.html" title="Chapter 15. System Maintenance">Chapter 15</a> for details on <code class="literal">sensorsd</code>.</p></div><div class="sect2" title="/etc/services"><div class="titlepage"><div><div><h3 class="title" id="etc_services">/etc/services</h3></div></div></div><p>The <span class="emphasis"><em>/etc/services</em></span> file contains a list of network services and their associated TCP/IP ports. See <a class="xref" href="ch11.html" title="Chapter 11. Overview of TCP/IP">Chapter 11</a> for details.</p></div><div class="sect2" title="/etc/shells"><div class="titlepage"><div><div><h3 class="title" id="etc_shells">/etc/shells</h3></div></div></div><p>The <span class="emphasis"><em>/etc/shells</em></span> file contains a list of legitimate user shells, as discussed in <a class="xref" href="ch06.html" title="Chapter 6. User Management">Chapter 6</a>.</p></div><div class="sect2" title="/etc/skel/"><div class="titlepage"><div><div><h3 class="title" id="etc_skel">/etc/skel/</h3></div></div></div><p>The <span class="emphasis"><em>/etc/skel/</em></span> directory contains standard user environment configuration files. When you create a user account, <code class="literal">adduser(8)</code> copies the files in this directory to the new user’s home directory. This directory can be overwritten when you upgrade your system.</p><p>If you need to customize these files for your users, create a custom dotfile directory and tell <code class="literal">adduser(8)</code> to use it instead.</p></div><div class="sect2" title="/etc/sliphome/"><div class="titlepage"><div><div><h3 class="title" id="etc_sliphome">/etc/sliphome/</h3></div></div></div><p>The Serial Line Internet Protocol (SLIP) predated the Point-to-Point Protocol (PPP) commonly used for dial-up lines. OpenBSD still supports it, as someone might need it and there’s no real reason to get rid of it.</p></div><div class="sect2" title="/etc/snmpd.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_snmpd_conf">/etc/snmpd.conf</h3></div></div></div><p><a class="indexterm" id="idx0750"/><a class="indexterm" id="idx0753"/><a class="indexterm" id="idx0755"/><a class="indexterm" id="idx0759"/><a class="indexterm" id="idx0765"/><a class="indexterm" id="idx0769"/><a class="indexterm" id="idx0771"/><a class="indexterm" id="idx1221"/><a class="indexterm" id="idx2056"/><a class="indexterm" id="idx2143"/><a class="indexterm" id="idx2164"/><a class="indexterm" id="idx2211"/><a class="indexterm" id="idx2220"/><a class="indexterm" id="idx2266"/><a class="indexterm" id="idx2308"/><a class="indexterm" id="idx2357"/>Simple Network Management Protocol (SNMP) is a method for accessing information about a device over the network. Unfortunately, it’s not a terribly secure protocol (one common acronym for SNMP is “Security? Not My Problem!”) The OpenBSD team has written a more secure SNMP daemon, <code class="literal">snmpd(8)</code>. Configure it in <span class="emphasis"><em>/etc/snmpd.conf</em></span>, as discussed in <a class="xref" href="ch16.html" title="Chapter 16. Network Servers">Chapter 16</a>.</p><p>While OpenBSD’s SNMP daemon might resist intrusions and abuse, it can’t help the fact that SNMP itself, as commonly deployed, isn’t terribly secure.</p></div><div class="sect2" title="/etc/ssh/"><div class="titlepage"><div><div><h3 class="title" id="etc_ssh">/etc/ssh/</h3></div></div></div><p>The SSH daemon <code class="literal">sshd(8)</code> offers a secure replacement for <code class="literal">telnet(1)</code> and the r-protocols. <a class="xref" href="ch16.html" title="Chapter 16. Network Servers">Chapter 16</a> includes a brief discussion of SSH.</p></div><div class="sect2" title="/etc/ssl/"><div class="titlepage"><div><div><h3 class="title" id="etc_ssl">/etc/ssl/</h3></div></div></div><p>The <span class="emphasis"><em>/etc/ssl/</em></span> directory is for Secure Sockets Layer (SSL) certificates, as well as the OpenSSL configuration file <span class="emphasis"><em>openssl.cnf</em></span>. Store system SSL certificates here.</p></div><div class="sect2" title="/etc/sudoers"><div class="titlepage"><div><div><h3 class="title" id="etc_sudoers">/etc/sudoers</h3></div></div></div><p>The <span class="emphasis"><em>/etc/sudoers</em></span> file controls <code class="literal">sudo(1)</code> configuration. See <a class="xref" href="ch07.html" title="Chapter 7. Root, and How to Avoid It">Chapter 7</a> for details about <code class="literal">sudo</code>.</p></div><div class="sect2" title="/etc/sysctl.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_sysctl_conf">/etc/sysctl.conf</h3></div></div></div><p>Set kernel runtime tunable options in <span class="emphasis"><em>/etc/sysctl.conf</em></span>. Sysctls are covered in <a class="xref" href="ch18.html" title="Chapter 18. Kernel Configuration">Chapter 18</a>.</p></div><div class="sect2" title="/etc/syslog.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_syslog_conf">/etc/syslog.conf</h3></div></div></div><p>The logging daemon <code class="literal">syslogd(8)</code> reads messages from programs and hosts, and then separates those messages into records based on the configuration in <span class="emphasis"><em>/etc/syslog.conf</em></span>. See <a class="xref" href="ch15.html" title="Chapter 15. System Maintenance">Chapter 15</a> for details on <code class="literal">syslogd</code>.</p></div><div class="sect2" title="/etc/systrace/"><div class="titlepage"><div><div><h3 class="title" id="etc_systrace">/etc/systrace/</h3></div></div></div><p>The <code class="literal">systrace(4)</code> system call wrapper provides access controls to system calls. You could run a binary “under” <code class="literal">systrace(1)</code>, and if the program attempted to access any system call beyond those permitted in the application’s <code class="literal">systrace</code> policy, <code class="literal">systrace</code> would block the access.</p><p>Flaws were found in <code class="literal">systrace</code>, however, that make it less than effective, and it’s now considered only a partial solution. It still ships with OpenBSD, but its use is discouraged. Today, <code class="literal">systrace</code> is mostly used for package-building clusters to make sure that software built doesn’t phone home or write outside the fake installation root.</p><p>If you need to use <code class="literal">systrace</code>, store policies in <span class="emphasis"><em>/etc/systrace</em></span>.</p></div><div class="sect2" title="/etc/termcap"><div class="titlepage"><div><div><h3 class="title" id="etc_termcap">/etc/termcap</h3></div></div></div><p><a class="indexterm" id="idx0289"/><a class="indexterm" id="idx0421"/><a class="indexterm" id="idx0772"/><a class="indexterm" id="idx0774"/><a class="indexterm" id="idx1893"/><a class="indexterm" id="idx2093"/><a class="indexterm" id="idx2401"/><a class="indexterm" id="idx2610"/>The <span class="emphasis"><em>/etc/termcap</em></span> file describes all the different terminals that OpenBSD supports. Pretty much every console device now supports the standard VT220 terminal, however.</p></div><div class="sect2" title="/etc/ttys"><div class="titlepage"><div><div><h3 class="title" id="etc_ttys">/etc/ttys</h3></div></div></div><p>Configure system terminals in <span class="emphasis"><em>/etc/ttys</em></span>. You can enable, disable, and change terminals here. A “terminal” could be the keyboard and monitor attached to the computer, a login over a serial line as with a serial console, or a virtual terminal as used by telnet or SSH.</p><p>A classic UNIX terminal device resembled a teletype; that’s where the <span class="emphasis"><em>tty</em></span> label comes from. All sorts of UNIX architectural details descend from this historical accident, and Unix-like systems inherited them.</p><div class="sect3" title="Terminal Types"><div class="titlepage"><div><div><h4 class="title" id="terminal_types">Terminal Types</h4></div></div></div><p><span class="emphasis"><em>/etc/ttys</em></span> lists three different terminal types: the console, serial ports, and pseudo-terminals.</p><p>The console is where boot messages display, where single-user mode maintenance can happen, and where error messages directed at the console appear. While the console is usually the keyboard, monitor, and mouse attached to the computer, it doesn’t need to be that. The “console” is an abstraction that usually happens to be aimed at your physical monitor and keyboard. You can direct the console at a serial port instead, for example. The console uses the device <span class="emphasis"><em>/dev/console</em></span>.</p><p>On some platforms, including i386 and amd64, OpenBSD supports multiple virtual consoles attached to your physical console. If you press <span class="smallcaps">CTRL</span>-<span class="smallcaps">ALT</span>-F2 on the physical keyboard, you’ll see a brand-new login screen. <span class="smallcaps">CTRL</span>-<span class="smallcaps">ALT</span>-F1 returns you to the main console. You can have as many virtual consoles as you have function keys, but OpenBSD has five by default. These virtual consoles have device names beginning with <span class="emphasis"><em>/dev/ttyC</em></span> and ending in a hexadecimal number.</p><p>Serial ports can be used as login devices, once you attach either an old-fashioned serial terminal or a null-modem cable and another device with a serial port. They can also be used for outgoing serial connections. Serial ports used as incoming devices start with <span class="emphasis"><em>/dev/tty</em></span>, while ports used for outgoing connections start with <span class="emphasis"><em>/dev/cua</em></span>, and both end in hexadecimal numbers. Each serial port can have one terminal attached to it.</p><p>Pseudo-terminals support network connections. Even though your remote SSH window has no corresponding physical hardware on the server, OpenBSD treats it in some way as a <code class="literal">tty</code> device. Pseudo-terminals have device names beginning with <span class="emphasis"><em>/dev/tty</em></span>, a letter <code class="literal">p</code> through <code class="literal">z</code> (either lowercase or uppercase), and ending in a single letter or number. When a user connects over the network, such as via SSH, the login session is assigned one of these virtual terminal devices.</p><p>Whatever the terminal type is, configure it in <span class="emphasis"><em>/etc/ttys</em></span>, using the following procedure.</p></div><div class="sect3" title="Configuring Terminals"><div class="titlepage"><div><div><h4 class="title" id="configuring_terminals">Configuring Terminals</h4></div></div></div><p><a class="indexterm" id="idx1990"/><a class="indexterm" id="idx1995"/><a class="indexterm" id="idx2402"/>Each terminal has an <span class="emphasis"><em>/etc/ttys</em></span> entry, containing at least three entries and possibly up to five.</p><a id="I_programlisting14_id474190"/><pre class="programlisting">ttyC0 /usr/libexec/getty std.9600 vt220 on secure</pre><p>The first entry is the device name, without the leading <span class="emphasis"><em>/dev</em></span>.</p><p>The second entry is the name of the program that spawns login requests on the terminal. Physical terminals and virtual consoles use <code class="literal">getty(8)</code>, while pseudo-terminals process login requests through whatever daemon the user logs in through.</p><p>The third entry is the terminal type. OpenBSD uses a <code class="literal">vt220</code> terminal on the monitor and the virtual consoles. Serial consoles use the <code class="literal">unknown</code> terminal type, as there’s no way to know in advance what kind of hardware is on the other end of the terminal. (You can switch this to <code class="literal">vt220</code> without issue if you’re using a reasonably modern serial client.) Pseudo-terminals use the <code class="literal">network</code> terminal type; the server daemon and client software determine the terminal’s features.</p><p>The fourth field determines if the terminal is available for logins. Set this to <code class="literal">on</code> to accept login requests, or <code class="literal">off</code> to deny them. Pseudo-terminals are activated on demand, so you don’t need to configure them in <span class="emphasis"><em>/etc/ttys</em></span>.</p><p>The root account can log on to only a secure console. The physical terminal and the console are the only devices defined as secure by default. You can log in as a regular user and use <code class="literal">su(1)</code> or <code class="literal">sudo(1)</code> on an insecure terminal; you just can’t directly log on as straight <code class="literal">root</code>. This means that anyone who has the root password and physical access to the machine can just walk up to the keyboard and log in as root. To disallow logins directly to root, remove the <code class="literal">secure</code> keyword from the virtual console entries in <span class="emphasis"><em>/etc/ttys</em></span>. Also, on secure terminals, you won’t be asked for the root password when you boot into single-user mode.</p><p>If you use serial consoles, you might want to log in to a running multiuser system over the serial cable. By default, you cannot log in on a serial line. Set the serial line with the serial console to <code class="literal">on</code>, and you’ll be able to log in. This makes a serial line behave much like being at the physical console, where you can work in multiuser mode and while the machine is running normally.</p><p>While all of the defaults use <code class="literal">getty(8)</code>, there are alternatives. For example, the HylaFAX package lets you connect a fax machine to a serial line, but you need to reconfigure the terminal to support it.</p><a id="I_programlisting14_id474295"/><pre class="programlisting">tty0e   "/usr/local/sbin/faxgetty"      dialup  on</pre><p>The point is that you can use serial ports any way you like, once you get the right software tool for the job.</p></div><div class="sect3" title="Making /etc/ttys Changes Take Effect"><div class="titlepage"><div><div><h4 class="title" id="making_etc_ttys_changes_take_effect">Making /etc/ttys Changes Take Effect</h4></div></div></div><p><a class="indexterm" id="idx0775"/><a class="indexterm" id="idx0776"/><a class="indexterm" id="idx0777"/><a class="indexterm" id="idx0780"/><a class="indexterm" id="idx2705"/>Offering terminals is a low-level system task handled directly by <code class="literal">init(8)</code>. Changes to <span class="emphasis"><em>/etc/ttys</em></span> do not take effect until you tell <code class="literal">init</code> to reread its configuration. (<code class="literal">init</code> is always process ID 1.)</p><a id="I_programlisting14_id474370"/><pre class="programlisting"># kill -HUP 1</pre><p>If you don’t tell <code class="literal">init</code> to reread its configuration, changes won’t take effect until you reboot.</p></div></div><div class="sect2" title="/etc/weekly and /etc/weekly.local"><div class="titlepage"><div><div><h3 class="title" id="etc_weekly_and_etc_weekly_local">/etc/weekly and /etc/weekly.local</h3></div></div></div><p>The <span class="emphasis"><em>/etc/weekly.local</em></span> script runs once a week to perform weekly maintenance, as discussed in <a class="xref" href="ch15.html" title="Chapter 15. System Maintenance">Chapter 15</a>.</p></div><div class="sect2" title="/etc/wsconsctl.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_wsconsctl_conf">/etc/wsconsctl.conf</h3></div></div></div><p>OpenBSD includes hardware-independent access to the physical console through the <code class="literal">wscons(4)</code> driver. Configure this console via <code class="literal">wsconsctl(8)</code>. The boot-time <code class="literal">wsconsctl</code> settings are read from <span class="emphasis"><em>/etc/wsconsctl.conf</em></span>. See <a class="xref" href="ch17.html" title="Chapter 17. Desktop OpenBSD">Chapter 17</a> for details on console configuration.</p></div><div class="sect2" title="/etc/X11"><div class="titlepage"><div><div><h3 class="title" id="etc_x11">/etc/X11</h3></div></div></div><p>The <span class="emphasis"><em>/etc/X11</em></span> directory contains configuration for the X Window System. OpenBSD’s Xenocara integrates X with the base system. <a class="xref" href="ch17.html" title="Chapter 17. Desktop OpenBSD">Chapter 17</a> discusses desktop OpenBSD, including some X features.</p></div><div class="sect2" title="/etc/ypldap.conf"><div class="titlepage"><div><div><h3 class="title" id="etc_ypldap_conf">/etc/ypldap.conf</h3></div></div></div><p>In addition to the LDAP daemon <code class="literal">ldapd(8)</code>, OpenBSD supports the YP database for centralizing passwords, groups, and host filesystems. YP is compatible with Sun’s original Network Information System (NIS). OpenBSD uses YP as a gateway to LDAP authentication. If you’re interested in this feature, see <code class="literal">yp(8)</code> and <code class="literal">ypldap(8)</code>.</p><p>This takes you through everything in <span class="emphasis"><em>/etc</em></span> not covered elsewhere. In the next chapter, we’ll discuss how OpenBSD maintains itself, and how you can meddle with the maintenance processes.</p></div></div><div class="footnotes" epub:type="footnotes"><br/><hr style="width: 100; align: left;"/><div class="footnote" epub:type="footnote" id="ftn.id430592"><p><sup>[<a class="para" href="#id430592">39</a>] </sup>If Wireshark has a shaky security history, why would I install it? Because, sadly, it’s still the easiest way to debug really complicated network problems, especially when you’re working with an unfamiliar protocol.</p></div><div class="footnote" epub:type="footnote" id="ftn.id344316"><p><sup>[<a class="para" href="#id344316">40</a>] </sup>Henning Brauer, OpenBSD developer and point man on packet filtering, comments, “I understand crypto somewhat well. … I don’t muck with moduli either tho.” Consider yourself warned.</p></div></div></section></body></html>