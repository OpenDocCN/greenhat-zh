<html><head></head><body><section class="chapter" epub:type="chapter" id="user_management" title="Chapter&#xA0;6.&#xA0;User Management"><div class="titlepage"><div><div><h2 class="title">Chapter 6. User Management</h2></div></div></div><div class="epigraph" epub:type="epigraph"><div class="literallayout"><p><span class="emphasis"><em>This one can log in,</em></span><br/>
<span class="emphasis"><em>this other can get email;</em></span><br/>
<span class="emphasis"><em>never give out root.</em></span></p></div></div><p><a class="indexterm" id="idx2073"/><a class="indexterm" id="idx2535"/><a class="indexterm" id="idx2554"/><span class="inlinemediaobject"><a id="inline_id00007"/><img alt="" src="httpatomoreillycomsourcenostarchimages1616079.png"/></span> While computer intrusions over the Internet make headlines, a system administrator’s greatest security threats often come from a system’s own users. Maybe they won’t ship your data to a crime syndicate, but disgruntled and incompetent users will crash your servers given the chance—sometimes out of malice, but more often out of ignorance. Think about security as the combination of confidentiality, integrity, and availability, and it will immediately become clear how users with unrestricted system access can damage security.</p><p>Despite what you might have learned from the Bastard Operator from Hell, the system exists for the users, and proper management of those users’ accounts is absolutely necessary. In this chapter, we’ll cover one of the systems administrator’s most common tasks: managing users by adding, removing, configuring, and modifying user accounts.</p><div class="sect1" title="The Root Account"><div class="titlepage"><div><div><h2 class="title" id="the_root_account" style="clear: both">The Root Account</h2></div></div></div><p><a class="indexterm" id="idx1189"/><a class="indexterm" id="idx1750"/><a class="indexterm" id="idx1876"/><a class="indexterm" id="idx1877"/><a class="indexterm" id="idx1988"/><a class="indexterm" id="idx2536"/><a class="indexterm" id="idx2547"/>In recent years, there has been a trend toward using the privileged root account for everyday tasks on systems that have only a single user.<sup>[<a class="footnote" epub:type="noteref" href="#ftn.id330569" id="id330569">13</a>]</sup> Using a privileged account to read your email and browse the Web increases your risks from both user errors and malicious attacks. While a careless keystroke by a regular user will generate only a <code class="literal">permission denied</code> error, that same keystroke by root might render your system unusable and destroy all your data. Even if you’re the only person using your OpenBSD system, you must use an unprivileged user account for day-to-day tasks.</p><p>If an intruder compromises an unprivileged account, the potential damage is limited only by that user’s permissions. If the compromised account handles your email and web bookmarks, you might suffer only personal embarrassment. But if that account handles system administration tasks, your intruder can inflict unlimited system damage and send you scurrying for your backup. Using a regular account for day-to-day tasks means that you can take extra steps to restrict the root account.</p><p>Perform all tasks with the minimum level of privilege necessary. If you don’t need root access to perform a task, don’t use it! For example, OpenBSD’s web server runs as the specific user <code class="literal">www</code>, rather than as root. If an intruder breaks into your web server and gains access your system as the <code class="literal">www</code> user, he can damage only the files the <code class="literal">www</code> user has permission to write to. Likewise, if the web server software goes into an error state and starts deleting files at random, this same principle limits the files it can delete. The least privilege approach protects the system from both intruders and its own software.</p><p>Operating systems that give every user privileged access have more problems as a result. Virus effectiveness, unexpected misconfiguration, and even crashes can be traced back to unnecessary privileged access. OpenBSD might be the most secure operating system in the world, but all those fancy security features can’t protect you from poor system administration practices.</p><p>Using the root account for routine tasks also creates bad habits. People under pressure perform what they practice. If you use root on your desktop for routine work, you’ll need to fight your habits to perform routine tasks when you work on a production server. This sort of sloppiness inevitably breeds security problems. Even on my OpenBSD desktop, where I’m the only user, I do everything as a regular user specifically to develop and maintain good sysadmin habits.</p></div><div class="sect1" title="Adding Users"><div class="titlepage"><div><div><h2 class="title" id="adding_users" style="clear: both">Adding Users</h2></div></div></div><p>OpenBSD uses many of the standard UNIX user- and password-management programs, such as <code class="literal">passwd(1)</code> and <code class="literal">vipw(8)</code>. It also includes a friendly interactive user-creation program, <code class="literal">adduser(8)</code>. We’ll cover <code class="literal">adduser</code> first, and then look at some of the more advanced tools.</p><div class="sect2" title="Adding Users Interactively"><div class="titlepage"><div><div><h3 class="title" id="adding_users_interactively">Adding Users Interactively</h3></div></div></div><p><a class="indexterm" id="idx0030"/><a class="indexterm" id="idx0032"/><a class="indexterm" id="idx0387"/><a class="indexterm" id="idx0395"/><a class="indexterm" id="idx0969"/><a class="indexterm" id="idx0973"/><a class="indexterm" id="idx1232"/><a class="indexterm" id="idx1735"/><a class="indexterm" id="idx2135"/><a class="indexterm" id="idx2522"/><a class="indexterm" id="idx2548"/><a class="indexterm" id="idx2643"/>Only the root user can run <code class="literal">adduser</code>. If you start <code class="literal">adduser</code> at the command line without specifying any options, it drops you into a friendly interactive dialog where you can create new users.</p><div class="sect3" title="Configuring adduser"><div class="titlepage"><div><div><h4 class="title" id="configuring_adduser">Configuring adduser</h4></div></div></div><p>The first time <code class="literal">adduser</code> runs, it asks a series of questions to determine its default settings. It saves these default settings, but you can change the defaults later.</p><a id="I_programlisting6_id438402"/><pre class="programlisting"># <span class="strong"><strong>adduser</strong></span>
Couldn't find /etc/adduser.conf: creating a new adduser configuration file
Reading /etc/shells
Enter your default shell: csh ksh nologin sh tcsh [ksh]: <span class="strong"><strong>1</strong></span>
Your default shell is: ksh -&gt; /bin/ksh
Default login class: authpf bgpd daemon default staff
[default]: <span class="strong"><strong>2</strong></span>
Enter your default HOME partition: [/home]: <span class="strong"><strong>3</strong></span>
Copy dotfiles from: /etc/skel no [/etc/skel]: <span class="strong"><strong>4</strong></span>
Send welcome message?: /path/file default no [no]: <span class="strong"><strong>5</strong></span>
Do not send message(s)
Prompt for passwords by default (y/n) [y]: <span class="strong"><strong>6</strong></span>
Default encryption method for passwords: auto blowfish des md5 old
[auto]: <span class="strong"><strong>7</strong></span></pre><p>adduser first asks for your preferred default shell. It reads <span class="emphasis"><em>/etc/shells</em></span> to see all the shells installed on your system. Though I’ve long used tcsh, I usually start new users with the OpenBSD standard of ksh <span class="strong"><strong>1</strong></span>. That way, they have a shell that more closely resembles what is used by the rest of the world, and they quickly learn that I cannot answer questions about their shell.</p><p>Next, adduser asks for your default login class. I’ll cover login classes later in this chapter. For now, assign new users to the default login class at <span class="strong"><strong>2</strong></span>.</p><p>If you have a default OpenBSD installation, your user home directories are on the <span class="emphasis"><em>/home</em></span> partition. If not, specify the default home directory at <span class="strong"><strong>3</strong></span>.</p><p>User accounts need configuration dotfiles (<span class="emphasis"><em>.shrc</em></span>, <span class="emphasis"><em>.login</em></span>, <span class="emphasis"><em>.profile</em></span>, and so on). If you have a directory containing customized dotfiles, tell adduser about it at <span class="strong"><strong>4</strong></span>. Otherwise, just accept the default.</p><p>Though OpenBSD doesn’t include a welcome message by default, you can put one on the system so new users will have an email waiting for them on their first login. Give adduser the full path to the file containing your welcome message at <span class="strong"><strong>5</strong></span>.</p><p>Depending on how you create user accounts, you might want to provide a password when you create the user account. Accounts created without passwords are disabled until a password is assigned. If you won’t be assigning passwords when creating accounts, you can tell adduser not to prompt you for them at <span class="strong"><strong>6</strong></span>.</p><p><a class="indexterm" id="idx0555"/><a class="indexterm" id="idx0655"/><a class="indexterm" id="idx0746"/><a class="indexterm" id="idx0931"/><a class="indexterm" id="idx2133"/><a class="indexterm" id="idx2477"/><a class="indexterm" id="idx2517"/><a class="indexterm" id="idx2533"/><a class="indexterm" id="idx2545"/><a class="indexterm" id="idx2649"/>Finally, you can choose the encryption algorithm used to hash user passwords, which are stored in <span class="emphasis"><em>/etc/master.passwd</em></span>. Unless you have specific interoperability needs or otherwise know what you’re doing, accept the default at <span class="strong"><strong>7</strong></span>.</p><p>From now on, adduser will use these chosen defaults. If you want to modify the defaults later on, change them in <span class="emphasis"><em>/etc/adduser.conf</em></span>. Read the adduser(8) man page for a complete list of configuration file options.</p></div><div class="sect3" title="Creating User Accounts"><div class="titlepage"><div><div><h4 class="title" id="creating_user_accounts">Creating User Accounts</h4></div></div></div><p>Now that you’ve set your default options, run adduser again to create user accounts.</p><p>Start by assigning a username. Many people are irrationally attached to particular usernames, and it’s polite to ask them if they have a preference.</p><a id="I_programlisting6_id438658"/><pre class="programlisting">Ok, let's go.
Don't worry about mistakes. There will be a chance later to correct any input.
Enter username []: <span class="strong"><strong>pkdick</strong></span></pre><p>Once you have a username, you’ll get a chance to enter the user’s real name or the account’s intended purpose.</p><a id="I_programlisting6_id438672"/><pre class="programlisting">Enter full name []: <span class="strong"><strong>Phil Dick</strong></span></pre><p>The shell you specify is a matter of user preference. The list of shells is taken from <span class="emphasis"><em>/etc/shells</em></span>, with the addition of the <code class="literal">nologin</code> option. Users can change their shell unless you specifically prevent that, so don’t worry too much about which shell you assign.</p><a id="I_programlisting6_id438693"/><pre class="programlisting">Enter shell csh ksh nologin sh tcsh [ksh]:</pre><p>Next, choose a user ID (UID) number. By default, UID numbering starts at 1000, and <code class="literal">adduser</code> uses the lowest available number. You can change this if needed to match some local standard.</p><a id="I_programlisting6_id438706"/><pre class="programlisting">Uid [1001]:</pre><p>By default, new users are assigned to a group with the same name as their username. Each user can be assigned to only a single login group (or primary group), but you can assign user accounts to multiple secondary groups if needed. If you want this user to be able to use the root account, invite the user to the <code class="literal">wheel</code> group. Other common groups include <code class="literal">staff</code>, <code class="literal">users</code>, and <code class="literal">operator</code>.</p><a id="I_programlisting6_id438730"/><pre class="programlisting">Login group pkdick [pkdick]:
Login group is ``pkdick''. Invite pkdick into other groups: guest no
[no]: <span class="strong"><strong>wheel</strong></span></pre><p><a class="indexterm" id="idx0031"/><a class="indexterm" id="idx1229"/><a class="indexterm" id="idx1736"/><a class="indexterm" id="idx2523"/><a class="indexterm" id="idx2549"/>Choose a login class for the user. If you don’t understand login classes yet, accept the default. I recommend assigning administrative users—for example, those in the <code class="literal">wheel</code> group—to the <code class="literal">staff</code> class. If you’re a desktop user, you want to be in the <code class="literal">staff</code> login class.</p><a id="I_programlisting6_id438804"/><pre class="programlisting">Login class authpf bgpd daemon default staff [default]: <span class="strong"><strong>staff</strong></span></pre><p>If you set <code class="literal">adduser</code> to ask for passwords, it will ask you for a password, and then ask again to confirm.</p><a id="I_programlisting6_id438820"/><pre class="programlisting">Enter password []:
Enter password again []:</pre><p>Now <code class="literal">adduser</code> displays everything you selected.</p><a id="I_programlisting6_id438832"/><pre class="programlisting">Name:        pkdick
Password:    ****
Fullname:    Phil Dick
Uid:         1001
Gid:         1001 (pkdick)
Groups:      pkdick wheel
Login Class: staff
HOME:        /home/pkdick
Shell:       /bin/ksh
OK? (y/n) [y]: <span class="strong"><strong>y</strong></span></pre><p>Either accept or reject the user at this point. If you accept, <code class="literal">adduser</code> will create the new user and ask if you want to create another user.</p></div></div><div class="sect2" title="Adding Users Noninteractively"><div class="titlepage"><div><div><h3 class="title" id="adding_users_noninteractively">Adding Users Noninteractively</h3></div></div></div><p>If you need to create many users, you probably don’t want to spend your day looping through <code class="literal">adduser</code> dialogs. If you have scripts, cron jobs, or web interfaces that add user accounts, you’ll want to create users noninteractively. <code class="literal">adduser</code>’s <code class="literal">-batch</code> flag enables this. When you use batch mode, <code class="literal">adduser</code> takes four additional arguments: the username, the groups the username belongs to, the full name, and the password in encrypted format.</p><a id="I_programlisting6_id438881"/><pre class="programlisting"># <span class="strong"><strong>adduser -batch <span class="emphasis"><em>username group 'Real Name' encryptedpassword</em></span></strong></span></pre><p>To create our user <code class="literal">pkdick</code> in batch mode, we would run this:</p><a id="I_programlisting6_id438899"/><pre class="programlisting"># <span class="strong"><strong>adduser -batch pkdick wheel 'Phil Dick' NotThePassword</strong></span></pre><p>One thing to note here is that <code class="literal">pkdick</code>’s password is <span class="emphasis"><em>not</em></span> <code class="literal">NotThePassword</code>. <code class="literal">adduser</code> expects us to provide a random salt that hashes to the string <code class="literal">NotThePassword</code>, not the password itself. For instructions on how to generate encrypted passwords, see <a class="xref" href="ch06.html#passwords_and_batch_mode" title="Passwords and Batch Mode">Passwords and Batch Mode</a>.</p><div class="sect3" title="Groups in Batch Mode"><div class="titlepage"><div><div><h4 class="title" id="groups_in_batch_mode">Groups in Batch Mode</h4></div></div></div><p><a class="indexterm" id="idx0656"/><a class="indexterm" id="idx0932"/><a class="indexterm" id="idx1737"/><a class="indexterm" id="idx2011"/>By default, new users are assigned a primary group with the same name as their login name. In batch mode, you must specify additional groups desired on the command line. Our example user <code class="literal">pkdick</code> is created with the login group of <code class="literal">pkdick</code>. If you want to set a different login group for a particular user, use the <code class="literal">-group</code> flag.</p><a id="I_programlisting6_id438998"/><pre class="programlisting"># <span class="strong"><strong>adduser -group guest -batch jgballard customers 'Jim Ballard' NotThePassword</strong></span></pre><p>You’ll need to add the user to another group. Here, I gave <code class="literal">jgballard</code> the login group of <code class="literal">guest</code> and added him to the group <code class="literal">customers</code>.</p><p>To assign a user to multiple groups, separate the groups using commas.</p><a id="I_programlisting6_id439025"/><pre class="programlisting"># <span class="strong"><strong>adduser -batch jgballard customers,sftp-only 'Jim Ballard' NotThePassword</strong></span></pre><p>The end result here is that <code class="literal">jgballard</code> is assigned to the <code class="literal">jgballard</code> primary group and added to the <code class="literal">customers</code> and <code class="literal">sftp-only</code> secondary groups.</p></div><div class="sect3" title="Passwords and Batch Mode"><div class="titlepage"><div><div><h4 class="title" id="passwords_and_batch_mode">Passwords and Batch Mode</h4></div></div></div><p>If you actually follow any of the previous examples, you’ll create an account with no known password. Modern Unix-like operating systems don’t store passwords in readable format; instead, passwords are stored as a hash of the password and a random salt. When you assign a password to a user, the system takes the password, adds the salt, and performs some horrible computations to generate a hash of the password. The system then stores that hash and salt in the <span class="emphasis"><em>/etc/master.passwd</em></span> file. When you attempt to log in, the login process takes your password, adds the salt, and computes the hash of that combination. If the computed hash matches what’s stored in <span class="emphasis"><em>/etc/master.passwd</em></span>, the login is permitted.</p><p>The examples create an account with a password hash of <code class="literal">NotThePassword</code>. Because this isn’t a legitimate hash, no entered password will match it. We need to provide a pregenerated encrypted password, enter an unencrypted password, and let <code class="literal">adduser</code> calculate the hash for us, or create an account without a password.</p><p>Creating a new account without a password is the simplest option. OpenBSD will disable the account until you assign a password to it, but this is acceptable for accounts used to run daemons, or if you have a help desk staff to assist new users in setting passwords. To create an account without a password, simply omit the password from the account-creation process.</p><a id="I_programlisting6_id439101"/><pre class="programlisting"># <span class="strong"><strong>adduser -batch pkdick wheel 'Phil Dick'</strong></span></pre><p>If you want to enter an unencrypted password on the command line, use the <code class="literal">-unencrypted</code> option. Put this option before the <code class="literal">-batch</code> option. For example, to give Phil’s account the password <code class="literal">IsThePassword</code>, enter the following:</p><a id="I_programlisting6_id439125"/><pre class="programlisting"># <span class="strong"><strong>adduser -unencrypted -batch pkdick wheel 'Phil Dick' IsThePassword</strong></span></pre><p><a class="indexterm" id="idx0033"/><a class="indexterm" id="idx0034"/><a class="indexterm" id="idx0552"/><a class="indexterm" id="idx1732"/><a class="indexterm" id="idx2295"/><a class="indexterm" id="idx2515"/>This account now has a password of <code class="literal">IsThePassword</code>. You might use this inside a script or when no one is around to look over your shoulder. The password will appear in the system’s process list, however, so any users on the system can see the password if they’re quick enough to notice.</p><p>Another option is to generate a prehashed password using <code class="literal">encrypt(1)</code>. By default, <code class="literal">encrypt</code> gives you a blank line. When you enter a word, it returns the hash of that word. It defaults to using the encryption algorithm defined in the <code class="literal">default</code> login class. (For the past several years, this has been Blowfish.) You can enter any number of words, and each will be hashed separately. Press <span class="smallcaps">CTRL-</span>C to exit <code class="literal">encrypt</code>.</p><a id="I_programlisting6_id439217"/><pre class="programlisting"># <span class="strong"><strong>encrypt</strong></span>
<span class="strong"><strong>gerbil</strong></span>
$2a$06$V/VO91VVAKSNslesQNH6pezXsGhoKUMcnvWxyDOJUmWRk3fflX5cy
<span class="strong"><strong>weasel</strong></span>
$2a$06$652ngShUnOBuFEL7X2yrf.E0U2GUw/FseVq/BkVgaiyqvp4wt.Nsy
<span class="strong"><strong>^C</strong></span>
#</pre><p>If you’re encrypting only one password or creating passwords interactively, give the <code class="literal">-p</code> option to <code class="literal">encrypt</code>. This gives you a non-echoing password prompt.</p><a id="I_programlisting6_id439257"/><pre class="programlisting"># <span class="strong"><strong>encrypt -p</strong></span>
Enter string:
$2a$06$nyA.mygoei/6VGS2tq4wA.VOzB6inwlK9pWOIAsiUWBkWf0CqOJ7.
#</pre></div><div class="sect3" title="Other Batch Mode Options"><div class="titlepage"><div><div><h4 class="title" id="other_batch_mode_options">Other Batch Mode Options</h4></div></div></div><p>I frequently create administrator accounts with one set of standards and unprivileged accounts with another. I create sysadmin accounts by hand using <code class="literal">adduser</code> in interactive mode (I don’t create sysadmin accounts very often). Someone else creates unprivileged user accounts using an <code class="literal">adduser</code> batch mode script I wrote. <span class="emphasis"><em>adduser.conf</em></span> contains the default settings for sysadmins, which I then override in the script. This approach requires less of my organic memory and ensures that unprivileged accounts are consistent.</p><p>All of these options must appear on the command line before the <code class="literal">-batch</code> argument. <code class="literal">adduser</code> treats everything after <code class="literal">-batch</code> as account information.</p><p>The <code class="literal">-noconfig</code> option tells <code class="literal">adduser</code> to not read defaults from <span class="emphasis"><em>adduser.conf</em></span>. Using this option in a script guarantees that sysadmin-friendly defaults in <span class="emphasis"><em>adduser.conf</em></span> don’t leak into unprivileged accounts.</p><p>The <code class="literal">-dotdir</code> option specifies a directory for user dotfiles. All files in this directory are copied to the new user’s home directory. I often have special dotfiles for unprivileged users.</p><p>The <code class="literal">-home</code> option tells <code class="literal">adduser</code> where to create the new user’s home directory. This is not the actual home directory, but the base directory where the home directory will be created. For example, if all of your web server customers have home directories on the <span class="emphasis"><em>/www</em></span> partition, you might use <code class="literal">-home /www</code>.</p><p><a class="indexterm" id="idx0403"/><a class="indexterm" id="idx1433"/><a class="indexterm" id="idx1976"/><a class="indexterm" id="idx2134"/><a class="indexterm" id="idx2524"/><a class="indexterm" id="idx2526"/>To assign a nondefault login class, use the <code class="literal">-class</code> option.</p><p>The <code class="literal">-message</code> option gives a path to the new user message. To turn off a default of sending a message, use <code class="literal">-message no</code>.</p><p>To assign a shell, use <code class="literal">-shell</code> and the shell name as it appears in <span class="emphasis"><em>/etc/shells</em></span>, or <code class="literal">nologin</code> to disable logins.</p><p>Perhaps you want to assign your batch-created users UIDs in a specific range. Maybe all of your customers have a UID above 10000, while sysadmins have a UID in the thousands. Specify a minimum UID with <code class="literal">-uid_start</code> and a maximum with <code class="literal">-uid_end</code>. If available, the login group created will be given a GID equal to the UID.</p></div></div><div class="sect2" title="User Account Restrictions"><div class="titlepage"><div><div><h3 class="title" id="user_account_restrictions">User Account Restrictions</h3></div></div></div><p>User accounts are subject to the following restrictions, fully documented in <code class="literal">adduser(8)</code>.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Usernames can contain characters (preferably lowercase) and digits, as well as nonleading hyphens, periods, underscores, and a trailing <code class="literal">$</code>. Usernames can be no longer than 31 characters.</p></li><li class="listitem"><p>Full names cannot contain a colon (<code class="literal">:</code>).</p></li><li class="listitem"><p>Other values must exist in the relevant files: shells must appear in <span class="emphasis"><em>/etc/shells</em></span>, login classes in <span class="emphasis"><em>/etc/login.conf</em></span>, and so on.</p></li></ul></div></div></div><div class="sect1" title="Removing User Accounts"><div class="titlepage"><div><div><h2 class="title" id="removing_user_accounts" style="clear: both">Removing User Accounts</h2></div></div></div><p>Removing unneeded user accounts is just as important as adding new ones. Use <code class="literal">rmuser(8)</code> to delete accounts.</p><a id="I_programlisting6_id439523"/><pre class="programlisting"># <span class="strong"><strong>rmuser pkdick</strong></span>
Matching password entry:
pkdick:*:1001:1001::0:0:phil dick:/home/pkdick:/bin/ksh
Is this the entry you wish to remove? <span class="strong"><strong>y</strong></span>
Remove user's home directory (/home/pkdick)? <span class="strong"><strong>y</strong></span>
Updating password file, updating databases, done.
Updating group file: Removing group pkdick -- personal group is empty
 done.
Removing user's home directory (/home/pkdick): done.</pre><p>The <code class="literal">rmuser</code> command displays the account entry from <span class="emphasis"><em>/etc/passwd</em></span>, giving you a chance to verify that you really want to delete this particular user. Read the account’s real name, and verify that you’re deleting the correct account. Next, <code class="literal">rmuser</code> asks if you want to delete the user’s home directory. If you suspect that you might need some files from that user account, you could choose to keep the directory around for a while. It automatically deletes the user’s cron jobs and incoming mail file.</p></div><div class="sect1" title="Editing User Accounts"><div class="titlepage"><div><div><h2 class="title" id="editing_user_accounts" style="clear: both">Editing User Accounts</h2></div></div></div><p><a class="indexterm" id="idx0248"/><a class="indexterm" id="idx0615"/><a class="indexterm" id="idx0657"/><a class="indexterm" id="idx0688"/><a class="indexterm" id="idx2518"/>You create users with privileges based on the knowledge you have at the time. The information you have is probably wrong, so get comfortable with editing users. In most cases, <code class="literal">chpass(1)</code> does everything you need in a user-friendly way.</p><p>Users can edit their own accounts by running <code class="literal">chpass</code> without any arguments.</p><a id="I_programlisting6_id439639"/><pre class="programlisting">$ <span class="strong"><strong>chpass</strong></span>
$ Changing user database information for mwlucas.
Shell: /usr/local/bin/tcsh
Full Name: mwlucas
Office Location:
Office Phone:
Home Phone:</pre><p>Here, users can update their shell or change their directory information. Many applications ignore the directory information (phone numbers and office location) stored in <span class="emphasis"><em>/etc/passwd</em></span>, but in some places, it’s important. Make changes, save, and exit.</p><p>If you run <code class="literal">chpass</code> as root, giving a username as an argument, you get a very different picture.</p><a id="I_programlisting6_id439667"/><pre class="programlisting"># <span class="strong"><strong>chpass mwlucas</strong></span>
# Changing user database information for mwlucas.
Login: mwlucas
Encrypted password: $2a$08$s2EVX.cAhYHskOaHk/4C5eLn76atAmGPU7z5DqRKAYe/V.OGgWXVi
Uid [#]: 1000
Gid [# or name]: 1000
Change [month day year]:
Expire [month day year]:
Class: staff
Home directory: /home/mwlucas
Shell: /usr/local/bin/tcsh
Full Name: mwlucas
Office Location:
Office Phone:
Home Phone:</pre><p>Here, you can forcibly change the user’s password (although there are better ways to do this), shell, UID, password expiration, and so on, in addition to all of the user’s directory information.</p><p>Changes made through <code class="literal">chpass</code> affect only <span class="emphasis"><em>/etc/passwd</em></span>, <span class="emphasis"><em>/etc/master.passwd</em></span>, and <span class="emphasis"><em>/etc/group</em></span>. If you change a user’s UID, GID, or home directory, you must also make the corresponding changes to the files the user owns and his home directory; otherwise, the user’s account won’t work correctly. If <span class="emphasis"><em>/etc/passwd</em></span> lists your home directory as <span class="emphasis"><em>/newhome/mwlucas</em></span> in <span class="emphasis"><em>/etc/passwd</em></span>, but your files are in <span class="emphasis"><em>/home/mwlucas</em></span>, you’ll have trouble on your hands.</p><p>Note that you can’t edit <span class="emphasis"><em>/etc/master.passwd</em></span> or <span class="emphasis"><em>/etc/passwd</em></span> with just any text editor; you need to use tools that manage the corresponding password databases. If you insist on editing the password file by hand, you can use <code class="literal">vipw(8)</code> to directly edit <span class="emphasis"><em>/etc/passwd</em></span>. If you’re not familiar with <code class="literal">vipw</code>, stick with <code class="literal">chpass</code>. The most common use for <code class="literal">vipw</code> is when the password file is damaged, and the most common way someone damages the password file is by using <code class="literal">vipw</code>.</p></div><div class="sect1" title="Login Classes"><div class="titlepage"><div><div><h2 class="title" id="login_classes" style="clear: both">Login Classes</h2></div></div></div><p><a class="indexterm" id="idx0396"/><a class="indexterm" id="idx0397"/><a class="indexterm" id="idx0641"/><a class="indexterm" id="idx1226"/><a class="indexterm" id="idx1227"/><a class="indexterm" id="idx2228"/><a class="indexterm" id="idx2608"/>A user’s shell can be used to limit what a user can do, but OpenBSD provides very specific access controls with login classes. Login classes, set in <span class="emphasis"><em>/etc/login.conf</em></span>, define the resources and information accessible to users. Login classes also let you control password length and expiration times, as well as external authentication mechanisms.</p><p>Each user is assigned to a class, and each class places limits on available resources. When you change the limits on a class, the new limits are applied to each user the next time the user logs in. Define a user’s class when creating the account, or change it with <code class="literal">chpass</code>.</p><p>By default, <span class="emphasis"><em>login.conf</em></span> offers two classes for users, one class for daemons, and a few special-case classes. The <code class="literal">default</code> user class gives the user wide-ranging access to system resources and is suitable for machines with a limited number of shell users. The <code class="literal">staff</code> user class gives the user no restrictions on memory use, sets very high limits on the number of processes a user can run concurrently, and allows the user to log in even when logins are forbidden.</p><p>If these two classes meet your needs, and if you won’t be using an alternative authentication protocol like Remote Authentication Dial In User Service (RADIUS) or Kerberos, you can skip this section. If not, read on.</p><div class="sect2" title="Login Class Definitions"><div class="titlepage"><div><div><h3 class="title" id="login_class_definitions">Login Class Definitions</h3></div></div></div><p>Each class definition consists of a series of variable assignments describing the class’s resource limits, authentication, and environment. Each variable assignment in the class definition begins and ends with a colon. The backslash character indicates that the class continues on the next line, which makes the file more readable.</p><p>Here’s the definition of the <code class="literal">default</code> class:</p><a id="I_programlisting6_id439889"/><pre class="programlisting">  default:\
<span class="strong"><strong>1</strong></span>      :path=/usr/bin /bin /usr/sbin /sbin /usr/X11R6/bin /usr/local/bin /usr/local/sbin:\
<span class="strong"><strong>2</strong></span>      :umask=022:\
<span class="strong"><strong>3</strong></span>      :datasize-max=512M:\
       :datasize-cur=512M:\
       :maxproc-max=256:\
       :maxproc-cur=128:\
       :openfiles-cur=512:\
       :stacksize-cur=4M:\
       :localcipher=blowfish,6:\
       :ypcipher=old:\
<span class="strong"><strong>4</strong></span>      :tc=auth-defaults:\
       :tc=auth-ftp-defaults:</pre><p><a class="indexterm" id="idx0224"/><a class="indexterm" id="idx0643"/><a class="indexterm" id="idx0645"/><a class="indexterm" id="idx1744"/><a class="indexterm" id="idx2480"/><a class="indexterm" id="idx2590"/>The <code class="literal">default</code> class has several variables. Some of these have fairly obvious interpretations. For example, the <code class="literal">path</code> variable at <span class="strong"><strong>1</strong></span> assigns a default command search path to the user’s shell, usually visible to the user as <code class="literal">$PATH</code>. The <code class="literal">umask</code> setting at <span class="strong"><strong>2</strong></span> assigns a default umask to the user’s shell. The user can override both of these.</p><p>Other settings, such as <code class="literal">datasize-max</code> and <code class="literal">maxproc-max</code> at <span class="strong"><strong>3</strong></span>, are harder to define by guesswork. We’ll go through some of the more commonly used values in the next section.</p><p>Similar in behavior to the <code class="literal">termcap</code> <code class="literal">tc</code> variables at <span class="strong"><strong>4</strong></span> used to configure serial console clients in <a class="xref" href="ch05.html" title="Chapter 5. The Boot Process">Chapter 5</a>, the <code class="literal">default</code> class copies settings from the entries <code class="literal">auth-defaults</code> and <code class="literal">auth-ftp-defaults</code> elsewhere in <span class="emphasis"><em>login.conf</em></span>.</p><p>Some variables don’t require a value to trigger behavior; these values trigger a specified behavior simply by adding them to <span class="emphasis"><em>login.conf</em></span>. For example, the presence of <code class="literal">requirehome</code> means that the user must have a valid home directory to log in.</p></div><div class="sect2" title="Changing login.conf"><div class="titlepage"><div><div><h3 class="title" id="changing_login_conf">Changing login.conf</h3></div></div></div><p>On many BSD systems, you must transform the <span class="emphasis"><em>login.conf</em></span> file to a program-friendly database file, <span class="emphasis"><em>login.conf.db</em></span>, with <code class="literal">cap_mkdb(8)</code>. OpenBSD doesn’t require this. Programs that check login classes first look for the login class database, and if they don’t find it, they directly parse <span class="emphasis"><em>login.conf</em></span>. You can use <code class="literal">cap_mkdb</code> to create such a database, which will very slightly improve the performance of software that checks <span class="emphasis"><em>login.conf</em></span>.</p><a id="I_programlisting6_id440120"/><pre class="programlisting"># <span class="strong"><strong>cap_mkdb /etc/login.conf</strong></span></pre><p>Note that once you create this database, you must rebuild it every time you edit <span class="emphasis"><em>login.conf</em></span>. Database values in <span class="emphasis"><em>login.conf.db</em></span> will always override your <span class="emphasis"><em>login.conf</em></span> settings. Alternatively, you can remove <span class="emphasis"><em>login.conf.db</em></span> and force programs to always parse <span class="emphasis"><em>login.conf</em></span>.</p><p>I recommend skipping <code class="literal">cap_mkdb</code> on modern hardware.</p></div><div class="sect2" title="Legal Values for login.conf Variables"><div class="titlepage"><div><div><h3 class="title" id="legal_values_for_login_conf_variables">Legal Values for login.conf Variables</h3></div></div></div><p>The <span class="emphasis"><em>login.conf</em></span> variables accept only very specific values, including the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>A full path to a text file or a program</p></li><li class="listitem"><p>A comma-separated list of environment variables</p></li><li class="listitem"><p>A comma-separated list of values</p></li><li class="listitem"><p>A number (put a 0x in front of the number for hexadecimal, or a 0 in front for octal)</p></li><li class="listitem"><p>A space-separated list of pathnames</p></li><li class="listitem"><p>A size, in bytes (default), kilobytes (K), megabytes (M), gigabytes (G), or 512-byte blocks (T)</p></li><li class="listitem"><p>A time in some combination of seconds (assumed if no unit is given), minutes (m), hours (h), days (d), weeks (w), or years (y)</p></li></ul></div><p><a class="indexterm" id="idx0005"/><a class="indexterm" id="idx0013"/><a class="indexterm" id="idx0303"/><a class="indexterm" id="idx0307"/><a class="indexterm" id="idx0369"/><a class="indexterm" id="idx0515"/><a class="indexterm" id="idx0837"/><a class="indexterm" id="idx1331"/><a class="indexterm" id="idx1352"/><a class="indexterm" id="idx1353"/><a class="indexterm" id="idx1629"/><a class="indexterm" id="idx1745"/><a class="indexterm" id="idx1964"/><a class="indexterm" id="idx2227"/><a class="indexterm" id="idx2422"/><a class="indexterm" id="idx2525"/><a class="indexterm" id="idx2626"/>Variables that use pathnames accept the special symbols tilde (<code class="literal">~</code>) and dollar sign (<code class="literal">$</code>). A tilde followed by a slash or the user’s login name, or at the end of a pathname represents the user’s home directory. You can use <code class="literal">~/bin</code> to represent a <code class="literal">bin</code> directory in the user’s home directory. The dollar sign represents the username. For example, you might use <code class="literal">/var/mail/$</code> to represent the user’s incoming mail file.</p><p>Some variables require particular types of values. A path to the user’s home directory must be a full path, while the amount of memory a user can allocate must be a size. In most cases, legitimate answers are fairly obvious, but check <code class="literal">login.conf(5)</code> for a full listing of acceptable values.</p></div><div class="sect2" title="Setting Resource Limits"><div class="titlepage"><div><div><h3 class="title" id="setting_resource_limits">Setting Resource Limits</h3></div></div></div><p>Resource limits allow you to control the amount of system resources any one user can monopolize at any one time. If several hundred users are logged in to one machine, and one user decides to compile LibreOffice, that person will consume far more than his fair share of processor time, memory, and I/O. By limiting the resources any one user can use, you can make the system more responsive for all users.</p><p>Resource limits were more commonly used back when computing facilities were very expensive and departments received bills for the amount of computing time they used. These days, utilization accounting isn’t so important. It’s generally cheaper to buy more computing power than it is to configure accounting or resource limits. That said, if you have a buggy daemon that sometimes leaks and starts to soak up CPU time or memory, giving it a login class can prevent it from devouring the system.</p><p><a class="xref" href="ch06.html#some_login_conf_resource_limits" title="Table 6-1. Table 6-1: Some login.conf Resource Limits">Table 6-1</a> lists some resource-limiting <span class="emphasis"><em>login.conf</em></span> variables.</p><div class="table"><a id="some_login_conf_resource_limits"/><div class="table-title">Table 6-1. Table 6-1: Some login.conf Resource Limits</div><div class="table-contents"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="c1"/><col class="c2"/></colgroup><thead><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Variable</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Description</p></td></tr></thead><tbody><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">coredumpsize</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Maximum size of a core dump file</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">cputime</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Maximum CPU time any one process can use</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">datasize</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Maximum data size per process</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">filesize</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Maximum size of any one file</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">maxproc</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Maximum number of processes</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">memorylocked</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Maximum locked-in core memory use per process</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">memoryuse</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Maximum core memory use per process</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">openfiles</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Maximum open file descriptors per process</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">stacksize</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Maximum stack size per process</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; "><p><code class="literal">vmemoryuse</code></p></td><td style="vertical-align: top; "><p>Maximum virtual memory use per process</p></td></tr></tbody></table></div></div><p>Resource limits are generally set per process. If you permit each process 200MB of RAM and allow 40 processes per user, you’ve just allocated each user 8GB of memory. Perhaps your system has a lot of memory, but does it really have that much?</p><p><a class="indexterm" id="idx0316"/><a class="indexterm" id="idx0557"/><a class="indexterm" id="idx0644"/><a class="indexterm" id="idx0994"/><a class="indexterm" id="idx1018"/><a class="indexterm" id="idx1550"/><a class="indexterm" id="idx1743"/><a class="indexterm" id="idx1871"/><a class="indexterm" id="idx1960"/><a class="indexterm" id="idx2103"/><a class="indexterm" id="idx2130"/><a class="indexterm" id="idx2132"/><a class="indexterm" id="idx2398"/><a class="indexterm" id="idx2481"/><a class="indexterm" id="idx2644"/>All resource-limiting variables except <code class="literal">vmemoryuse</code> support maximum and current (advisory) limits. Users are warned by the system when they exceed current limits and cannot exceed the maximum limits. This works well on a cooperative system, where multiple users share resources but need to be notified when they are approaching their limit.</p><p>To specify a current limit, add <code class="literal">-cur</code> to the variable name. To make a maximum limit, add <code class="literal">-max</code>. For example, to set a current and maximum limit on the number of processes a user can have, use this definition in the class:</p><a id="I_programlisting6_id440831"/><pre class="programlisting">…
:maxproc-cur: 50:\
:maxproc-max: 60:\
…</pre><p>A user in this class will receive a warning when he uses more than 50 processes and will not be able to use more than 60 processes. If you do not specify a limit as current or maximum, it acts as both.</p></div><div class="sect2" title="Modifying the Shell Environment"><div class="titlepage"><div><div><h3 class="title" id="modifying_the_shell_environment">Modifying the Shell Environment</h3></div></div></div><p>You can define environment settings in a user class. This can work better than setting them in the default shell profile, because changes affect all users immediately upon their next login. This setting will impact all user shells, even those that don’t read <span class="emphasis"><em>.profile</em></span> or <span class="emphasis"><em>.cshrc</em></span>.</p><p><a class="xref" href="ch06.html#some_login_conf_environment_variables" title="Table 6-2. Table 6-2: Some login.conf Environment Variables">Table 6-2</a> lists popular user class variables that affect the user environment.</p><div class="table"><a id="some_login_conf_environment_variables"/><div class="table-title">Table 6-2. Table 6-2: Some login.conf Environment Variables</div><div class="table-contents"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="c1"/><col class="c2"/></colgroup><thead><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Variable</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Description</p></td></tr></thead><tbody><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">hushlogin</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>If present, no system information is given out during login.</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">ignorenologin</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>User can log in even when <span class="emphasis"><em>/etc/nologin</em></span> file is present.</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">nologin</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Path to a file. If the file exists, when a user tries to log in, the file contents are displayed and login is denied.</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">path</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Default command search path.</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">priority</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>User’s priority (nice) level. See <code class="literal">renice(1)</code>.</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">requirehome</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>If present, user must have valid home directory to log in.</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">setenv</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>A comma-separated list of environment variables and values.</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">shell</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>User shell. Overrides user shell selection in <span class="emphasis"><em>/etc/passwd</em></span>. The user’s <code class="literal">$SHELL</code> environment variable reflects <span class="emphasis"><em>/etc/passwd</em></span>, resulting in an inconsistent environment. Playing games with this is an excellent way to annoy your users.</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">term</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Default terminal type, if environment can’t figure out terminal type.</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">umask</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Initial umask. Should always start with a 0.</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; "><p><code class="literal">welcome</code></p></td><td style="vertical-align: top; "><p>Path to a file containing the login message.</p></td></tr></tbody></table></div></div></div><div class="sect2" title="Password and Login Options"><div class="titlepage"><div><div><h3 class="title" id="password_and_login_options">Password and Login Options</h3></div></div></div><p><a class="indexterm" id="idx1208"/><a class="indexterm" id="idx1230"/><a class="indexterm" id="idx1372"/><a class="indexterm" id="idx1728"/><a class="indexterm" id="idx1738"/><a class="indexterm" id="idx1739"/><a class="indexterm" id="idx1740"/><a class="indexterm" id="idx1741"/>Unlike the user environment, which can be configured in several different places, many password controls can be configured only via the user class. The password controls affect only the local password database, not Lightweight Directory Access Protocol (LDAP), Kerberos, RADIUS, or other remote password databases.</p><p>Let’s have a look at some commonly used password controls.</p><div class="blockquote" title="localcipher"><blockquote class="blockquote" title="localcipher"><div class="blockquote-title"><span class="strong"><strong><code class="literal">localcipher</code></strong></span></div><p>This controls the password hashing method used in <span class="emphasis"><em>/etc/master.passwd</em></span>. The default is Blowfish. Don’t change the password hashing method unless you’re trying to be compatible with a specific foreign Unix-like operating system. See <code class="literal">login.conf(5)</code> for the list of supported hashing algorithms.</p></blockquote></div><div class="blockquote" title="login-backoff"><blockquote class="blockquote" title="login-backoff"><div class="blockquote-title"><span class="strong"><strong><code class="literal">login-backoff</code></strong></span></div><p>This controls how quickly a user can struggle to remember his password. After this many unsuccessful login attempts, <code class="literal">login(1)</code> slows down how quickly it offers a new username and password prompt.</p></blockquote></div><div class="blockquote" title="passwordcheck"><blockquote class="blockquote" title="passwordcheck"><div class="blockquote-title"><span class="strong"><strong><code class="literal">passwordcheck</code></strong></span></div><p>This gives the full path to an external program that checks new passwords for quality. OpenBSD passes the password to the program on standard input. The program is expected to return a 0 if the password is adequate and a 1 if the password is inadequate. OpenBSD includes a very simple and limited password-quality checker; if you need a password-quality checker, check out <code class="literal">passwdqc</code> (<span class="emphasis"><em>/usr/ports/security/passwdqc</em></span>).</p></blockquote></div><div class="blockquote" title="passwordtries"><blockquote class="blockquote" title="passwordtries"><div class="blockquote-title"><span class="strong"><strong><code class="literal">passwordtries</code></strong></span></div><p>This is the number of times <code class="literal">passwd(1)</code> uses the password-quality checker. If the user cannot come up with a sufficiently complicated password in this many tries, the new password is accepted anyway. If this is set to 0, a new password is accepted only when it passes the quality check.</p></blockquote></div><div class="blockquote" title="minpasswordlen"><blockquote class="blockquote" title="minpasswordlen"><div class="blockquote-title"><span class="strong"><strong><code class="literal">minpasswordlen</code></strong></span></div><p>This is the minimum length of a new password. Password length is not a measure of quality—a stream of 128 <code class="literal">A</code> characters is still a lousy password, but it might help you meet site requirements.</p></blockquote></div><div class="blockquote" title="passwordtime"><blockquote class="blockquote" title="passwordtime"><div class="blockquote-title"><span class="strong"><strong><code class="literal">passwordtime</code></strong></span></div><p>This is the maximum age of a password, in seconds. Use this to require regular password changes.</p></blockquote></div><div class="blockquote" title="password-warn"><blockquote class="blockquote" title="password-warn"><div class="blockquote-title"><span class="strong"><strong><code class="literal">password-warn</code></strong></span></div><p>This is the length of time, in seconds, before <code class="literal">login(1)</code> begins warning the user of an expiring password.</p></blockquote></div><div class="blockquote" title="password-dead"><blockquote class="blockquote" title="password-dead"><div class="blockquote-title"><span class="strong"><strong><code class="literal">password-dead</code></strong></span></div><p><a class="indexterm" id="idx0023"/><a class="indexterm" id="idx0088"/><a class="indexterm" id="idx0202"/><a class="indexterm" id="idx0249"/><a class="indexterm" id="idx0311"/><a class="indexterm" id="idx1177"/><a class="indexterm" id="idx1178"/><a class="indexterm" id="idx1183"/><a class="indexterm" id="idx1726"/><a class="indexterm" id="idx1729"/><a class="indexterm" id="idx1911"/><a class="indexterm" id="idx1913"/><a class="indexterm" id="idx1940"/><a class="indexterm" id="idx2152"/><a class="indexterm" id="idx2162"/><a class="indexterm" id="idx2448"/><a class="indexterm" id="idx2516"/><a class="indexterm" id="idx2706"/>This is the length of time, in seconds, after password expiration when the user may log in one last time, just to reset his own password. If the user does not reset his password, he cannot log in. This is a last-chance grace period; if the user blows this chance, sysadmin intervention is required to reset the password.</p></blockquote></div></div><div class="sect2" title="Changing Authentication Methods"><div class="titlepage"><div><div><h3 class="title" id="changing_authentication_methods">Changing Authentication Methods</h3></div></div></div><p>OpenBSD supports many different authentication mechanisms, such as the local password file, Kerberos, S/Key, RADIUS, and so on. Specify the authentication method desired in the user class definition, and OpenBSD will use it. This system behind this is called <span class="emphasis"><em>BSD Authentication</em></span>.</p><p>Setting an authentication mechanism does not configure the authentication mechanism. For example, configuring a login class to authenticate via Kerberos doesn’t magically establish a Kerberos domain. If the specified authentication method is unavailable, classes configured to use that method will be unable to log in.</p><p>Not all authentication methods interoperate with all protocols. For example, while SSH works with physical tokens, it doesn’t work with the <code class="literal">lchpass</code> authentication protocol, which allows users to change their password but disallows logins. Review the man page for each authentication method for details.</p><p>Some authentication methods require additional configuration. For example, if you want to use RADIUS authentication, you must tell your system where to find your RADIUS server. The special <span class="emphasis"><em>login.conf</em></span> variables and their use are documented in the authentication method’s man page.</p><p><a class="xref" href="ch06.html#bsd_authentication_methods" title="Table 6-3. Table 6-3: BSD Authentication Methods">Table 6-3</a> lists the authentication methods supported by OpenBSD’s built-in BSD Authentication.</p><div class="table"><a id="bsd_authentication_methods"/><div class="table-title">Table 6-3. Table 6-3: BSD Authentication Methods</div><div class="table-contents"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="c1"/><col class="c2"/><col class="c3"/></colgroup><thead><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Method</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Man Page</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Description</p></td></tr></thead><tbody><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">activ</code></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">login_activ(8)</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Authenticate via ActivCard token</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">chpass</code></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">login_chpass(8)</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Change password, no shell</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">crypto</code></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">login_crypto(8)</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Authenticate via CRYPTOCard token</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">krb5</code></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">login_krb5(8)</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Authenticate via Kerberos</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">krb5-or-pwd</code></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">login_krb5-or-pwd(8)</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Try Kerberos, then local password database</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">lchpass</code></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">login_lchpass(8)</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Change local password</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">passwd</code></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">login_passwd(8)</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Authenticate against local password file</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">radius</code></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">login_radius(8)</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Authenticate against RADIUS server</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">reject</code></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">login_reject(8)</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Request a password, then deny the login</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">skey</code></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">login_skey(8)</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Authenticate via S/Key</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">snk</code></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">login_snk(8)</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Authenticate via SecureNet token</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">token</code></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">login_token(8)</code></p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Authenticate via X9.9 token</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; "><p><code class="literal">yubikey</code></p></td><td style="vertical-align: top; border-right: 0.5pt solid ; "><p><code class="literal">login_yubikey(8)</code></p></td><td style="vertical-align: top; "><p>Authenticate via Yubico YubiKey token</p></td></tr></tbody></table></div></div><p><a class="indexterm" id="idx0085"/><a class="indexterm" id="idx0089"/><a class="indexterm" id="idx0646"/><a class="indexterm" id="idx0860"/><a class="indexterm" id="idx1186"/><a class="indexterm" id="idx1228"/><a class="indexterm" id="idx1563"/><a class="indexterm" id="idx1912"/>The ports collection (discussed in <a class="xref" href="ch13.html" title="Chapter 13. Software Management">Chapter 13</a>) contains a few additional login methods, such as fingerprint scanners (<span class="emphasis"><em>sysutils/login_fingerprint</em></span>), OATH one-time passwords (<span class="emphasis"><em>sysutils/login_oath</em></span>), and LDAP integration (<span class="emphasis"><em>sysutils/login_ldap</em></span>). You can also create your own custom authentication methods; see <code class="literal">login.conf(5)</code> for details.</p><p>Set the authentication method using the <code class="literal">auth</code> variable in <span class="emphasis"><em>login.conf</em></span>:</p><a id="I_programlisting6_id442126"/><pre class="programlisting">:auth=token,passwd:\</pre><p>Users in a class with this set try to authenticate via an X9.9 token. If that’s not possible, the system falls back on the local password database.</p><p>BSD Authentication supports different authentication methods for different daemons. You can specify a service name after the <code class="literal">auth</code> keyword, indicating that this set of authentication methods applies to only that particular service. You’ll frequently see login classes like <code class="literal">auth-ssh</code> and <code class="literal">auth-su</code>.</p><p>Here are a couple of sample entries from the default <span class="emphasis"><em>login.conf</em></span> file:</p><a id="I_programlisting6_id442160"/><pre class="programlisting"># Default allowed authentication styles
auth-defaults:auth=passwd,skey:
# Default allowed authentication styles for authentication type ftp
auth-ftp-defaults:auth-ftp=passwd:</pre><p>This defines the class <code class="literal">auth-defaults</code>, with only one entry. By default, users in this class first use password authentication, and then S/Key authentication. The <code class="literal">auth-ftp-defaults</code> class defines <code class="literal">auth-ftp</code> as using the password database, and only the password database.</p><p>Earlier in this chapter, I mentioned that the default class included two other classes. These are the <code class="literal">auth-defaults</code> and <code class="literal">auth-ftp-defaults</code> classes. Every other login class in the default <span class="emphasis"><em>login.conf</em></span> file includes them by reference. If you change the authentication methods used by the <code class="literal">auth-defaults</code> class, that change will apply to every other login class.</p></div><div class="sect2" title="Using Login Classes for RADIUS Authentication"><div class="titlepage"><div><div><h3 class="title" id="using_login_classes_for_radius_authentic">Using Login Classes for RADIUS Authentication</h3></div></div></div><p>I have a long-running love/hate relationship with RADIUS. It’s the lowest common denominator of authentication protocols. Just about every operating system and hardware device supports it, but it’s a finicky protocol with innumerable edge cases. Luckily, configuring OpenBSD as a RADIUS client is simple. Any RADIUS server can provide authentication services for OpenBSD.</p><p>I encourage you to use another login service, such as LDAP or Kerberos, rather than RADIUS. But in certain cases, for certain users, RADIUS is adequate. RADIUS combined with Microsoft’s Internet Authentication Service gives you easy password synchronization with the local Windows domain and reduces your support load.</p><p><a class="indexterm" id="idx0086"/><a class="indexterm" id="idx0091"/><a class="indexterm" id="idx0704"/><a class="indexterm" id="idx0897"/><a class="indexterm" id="idx1231"/>First, read <code class="literal">login_radius(8)</code>, and then configure your RADIUS server to permit access from your OpenBSD host. To configure RADIUS authentication, you need the RADIUS server’s IP address, the port RADIUS runs on, and a shared secret. (For historical reasons, it’s best to specify the RADIUS port explicitly rather than relying on <span class="emphasis"><em>/etc/services</em></span>.) In our example, the RADIUS server is 192.0.2.2, the port is 1812, and the secret is the string <code class="literal">Insubordination88</code>.</p><p>First, create a directory to hold the server configuration file and set its permissions appropriately, as per <code class="literal">login_radius(8)</code>.</p><a id="I_programlisting6_id442289"/><pre class="programlisting"># <span class="strong"><strong>mkdir /etc/raddb</strong></span>
# <span class="strong"><strong>chgrp _radius /etc/raddb/</strong></span>
# <span class="strong"><strong>chmod 755 /etc/raddb/</strong></span></pre><p>Now create the file <span class="emphasis"><em>/etc/raddb/servers</em></span>. This file should contain a server and its secret, each on one line. Our <span class="emphasis"><em>servers</em></span> file has only one line:</p><a id="I_programlisting6_id442320"/><pre class="programlisting">192.0.2.2	Insubordination88</pre><p>Now change <span class="emphasis"><em>login.conf</em></span> to use RADIUS by default.</p><a id="I_programlisting6_id442331"/><pre class="programlisting">auth-defaults:\
        :auth=radius:\
        :radius-port=1812:\
        :radius-server=192.0.2.2:</pre><p>The <code class="literal">auth-defaults</code> class is OpenBSD’s default authentication class. If we change it, we change how every other class authenticates. We set the <code class="literal">auth</code> type to <code class="literal">radius</code>, and set the port and the server.</p><p>Immediately upon saving the file, OpenBSD will try to authenticate all user accounts against the RADIUS server. You might want to change the <code class="literal">auth-ftp</code> class to match.<sup>[<a class="footnote" epub:type="noteref" href="#ftn.id472953" id="id472953">14</a>]</sup></p><p>Until you confirm everything is working, keep an SSH session logged in as root so you can change <span class="emphasis"><em>login.conf</em></span>. Otherwise, you might lock yourself out of the system, or at least out of the root account. If you can’t get into the system, you’ll need to reboot into single-user mode and edit <span class="emphasis"><em>login.conf</em></span>.</p><p>Changing the authentication scheme for all users might not be desirable, either. You might want <code class="literal">authpf(8)</code> users to authenticate against RADIUS, but have users in the <code class="literal">staff</code> class authenticate against the local password database. Perhaps you don’t want your root account to authenticate via RADIUS, so you need an <code class="literal">auth-su</code> login class that points at the local password database. Using login classes, you can configure user authentication to fit your specific needs.</p></div></div><div class="sect1" title="Unprivileged User Accounts"><div class="titlepage"><div><div><h2 class="title" id="unprivileged_user_accounts" style="clear: both">Unprivileged User Accounts</h2></div></div></div><p><a class="indexterm" id="idx0971"/><a class="indexterm" id="idx1427"/><a class="indexterm" id="idx2017"/><a class="indexterm" id="idx2131"/><a class="indexterm" id="idx2499"/><a class="indexterm" id="idx2520"/><a class="indexterm" id="idx2528"/>An unprivileged user account is a user account with no privileges to any programs or files. Many programs run as unprivileged users or use unprivileged users to perform specific duties. These unprivileged users get only the rights needed to perform a limited task.</p><p>“Only the rights needed to perform a limited task” sounds like every user account, doesn’t it? That’s true, but the account used by the least privileged human being still has more rights than many programs need. Any user with shell access usually has a home directory. Users can create files in their home directory, run text editors, process email, run scripts, and compile (if not install) software. An average shell user needs these minimal privileges, but programs do not. By having a program run as a very restricted user, you control the amount of damage the software or intruders can do to the system.</p><p>OpenBSD includes several unprivileged users out of the box. Take a look at <span class="emphasis"><em>/etc/passwd</em></span>, and you’ll see accounts like <code class="literal">sshd</code>, <code class="literal">named</code>, <code class="literal">_ntp</code>, and so on. These are all unprivileged accounts used by specific server daemons. Examine them, and you’ll find several common characteristics.</p><p>Unprivileged users do not have normal home directories. Most share the home directory of <span class="emphasis"><em>/var/empty</em></span>, which is owned by root and contains nothing except a logging socket. Having a home directory the user cannot write to makes the account less flexible, but is good enough for most server daemons. If these users do own files on the system, file permissions are usually set so that the user cannot write to them.</p><p>Similarly, no one should ever log in to the system with these accounts. If the <code class="literal">named</code> user account is reserved for the DNS subsystem, why would anyone actually need to log in as that account? Unprivileged users are assigned a shell that specifically forbids logging in: <span class="emphasis"><em>/sbin/nologin</em></span>.</p><p>How does all this enhance system security? Let’s pick on the web server, a common intrusion vector, as an example. OpenBSD runs its web server as the user <code class="literal">www</code>. Suppose an intruder discovers a security flaw in your website and can use this to make the web server execute arbitrary code. This is a security nightmare; our intruder can now make the server program do absolutely anything within its power. But what, exactly, is within the web server’s power?</p><p>A command prompt permits much more mischief and mayhem than a website, so the intruder will probably try to access a command prompt on the system. The <code class="literal">www</code> user has a shell that specifically disallows a command prompt. While this doesn’t categorically prevent the intruder from getting a command prompt, it does make it much more difficult.</p><p>But our intruder is clever. Through really excellent intrusion skills, he makes the web server open a high-numbered port that dumps clients into a root shell. He now has access to a command prompt and can wreak untold damage … or can he?</p><p>He has no home directory, and no permissions to create one. Any files he wants to store must go into a globally accessible directory such as <span class="emphasis"><em>/tmp</em></span> or <span class="emphasis"><em>/var/tmp</em></span>, increasing his visibility. The web server configuration file is not owned by the <code class="literal">www</code> user. Even if the intruder has a path into the web server, he cannot reconfigure it. He can’t change the website files, as the <code class="literal">www</code> user doesn’t own them. The <code class="literal">www</code> user doesn’t have access to anything on the system, actually. Additionally, OpenBSD’s built-in web server <code class="literal">chroot</code>s itself. Having broken into the web server program, the intruder now must escape the <code class="literal">chroot</code> and penetrate a privileged program.</p><p><a class="indexterm" id="idx0014"/><a class="indexterm" id="idx0359"/><a class="indexterm" id="idx1544"/><a class="indexterm" id="idx2486"/><a class="indexterm" id="idx2521"/>Can he penetrate your system? Possibly, but it will be much more difficult. If he is specifically targeting you or your company, he might go to the trouble. If he is just looking for easy meat, however, he will probably give up and go bother someone running a Linux or Windows system.</p><p>Using unprivileged users doesn’t solve all security problems, mind you. The compromised <code class="literal">www</code> user can view web application source files. If your application is badly written or has database passwords hardcoded into hidden files, you’re still in trouble. But if you don’t use poorly written applications and you’ve kept your system updated and patched, the intruder will have a very hard time penetrating the rest of your server.</p><div class="sect2" title="The nobody Account"><div class="titlepage"><div><div><h3 class="title" id="the_nobody_account">The nobody Account</h3></div></div></div><p>The first unprivileged account was <code class="literal">nobody</code>. It was created for use by the Network File System (NFS, discussed in <a class="xref" href="ch09.html" title="Chapter 9. More Filesystems">Chapter 9</a>) to map files owned by root on foreign systems. Decades ago, people started using <code class="literal">nobody</code> as a generic unprivileged user, running web servers, proxy servers, and other daemons as <code class="literal">nobody</code>. While this was better than running those programs as root, it’s still poor practice. If an intruder penetrated one of those programs, he would gain access to all processes owned by <code class="literal">nobody</code>. Our hypothetical web server intruder would suddenly have access not only to the web server, but also to the database, NFS, or anything else running as <code class="literal">nobody</code>!</p><p>Every daemon that needs to run as a user needs its own unprivileged accounts—the whole point of using unprivileged users is to minimize the damage one piece of software can inflict. Use them liberally. OpenBSD provides discrete unprivileged users for services as small as <code class="literal">finger(1)</code> and the audio system. Follow this example.</p></div><div class="sect2" title="_username"><div class="titlepage"><div><div><h3 class="title" id="username">_username</h3></div></div></div><p>If you take a look at <span class="emphasis"><em>/etc/passwd</em></span>, you’ll see that many unprivileged users have an underscore before their name, such as <code class="literal">_syslogd</code>, <code class="literal">_ldapd</code>, and <code class="literal">_dhcp</code>. This is an OpenBSD convention for identifying unprivileged users. Most add-on software also uses unprivileged usernames beginning with an underscore, such as <code class="literal">_mysql</code> and <code class="literal">_postgresql</code>.</p><p>Not all unprivileged usernames start with an underscore, however. Some of these are legacy users that OpenBSD retains for compatibility reasons, such as <code class="literal">nobody</code>. Others have a long history or support inflexible software, and changing them would be more annoyance than it’s worth.</p><p>The presence of an underscore means that a user is unprivileged. The absence of an underscore means nothing; the user might be a normal account or it might be unprivileged. If you create your own unprivileged users, you don’t need to include a leading underscore, but doing so will help other system administrators understand what the user does.</p></div><div class="sect2" title="Creating Unprivileged Users"><div class="titlepage"><div><div><h3 class="title" id="creating_unprivileged_users">Creating Unprivileged Users</h3></div></div></div><p><a class="indexterm" id="idx2500"/>Here are common settings used for unprivileged users. You can change any of these as needed for your application.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: none"><p title="username"><span class="title"><strong><span class="strong"><strong>username</strong></span></strong></span>. Assign a username related to the user’s functions, so that you’ll easily recognize it. Giving an unprivileged user a username like <code class="literal">_fgcrl</code> might seem like a good way to conceal its purpose, but it will confuse your sysadmins and an intruder will quickly figure it out.</p></li><li class="listitem" style="list-style-type: none"><p title="home directory"><span class="title"><strong><span class="strong"><strong>home directory</strong></span></strong></span>. <span class="emphasis"><em>/var/empty</em></span> is a common setting for unprivileged users.</p></li><li class="listitem" style="list-style-type: none"><p title="shell"><span class="title"><strong><span class="strong"><strong>shell</strong></span></strong></span>. <span class="emphasis"><em>/sbin/nologin</em></span> is a common setting for unprivileged users.</p></li><li class="listitem" style="list-style-type: none"><p title="UID/GID"><span class="title"><strong><span class="strong"><strong>UID/GID</strong></span></strong></span>. Choose a specific range of UIDs and GIDs for your custom unprivileged users. OpenBSD reserves all UIDs below 1000 for system-assigned unprivileged users.</p></li><li class="listitem" style="list-style-type: none"><p title="full name"><span class="title"><strong><span class="strong"><strong>full name</strong></span></strong></span>. Assign a name describing the user’s role.</p></li><li class="listitem" style="list-style-type: none"><p title="password"><span class="title"><strong><span class="strong"><strong>password</strong></span></strong></span>. Use <code class="literal">chpass(1)</code> to assign the user a single asterisk as their encrypted password. This disables the account password.</p></li></ul></div><p>These settings make your unprivileged user very unprivileged indeed. You can set all of these options except the password using <code class="literal">adduser(8)</code>.</p><p>Now that you understand how to create, manage, and use user accounts, let’s discuss how to manage privileged users.</p></div></div><div class="footnotes" epub:type="footnotes"><br/><hr style="width: 100; align: left;"/><div class="footnote" epub:type="footnote" id="ftn.id330569"><p><sup>[<a class="para" href="#id330569">13</a>] </sup>This probably leaked through from the Microsoft culture, where for many years, every user had administrative access.</p></div><div class="footnote" epub:type="footnote" id="ftn.id472953"><p><sup>[<a class="para" href="#id472953">14</a>] </sup>Or you might not want to make this change. FTP transmits passwords in clear text, so you might want to use a separate password source for FTP connections. Why transmit passwords securely over one protocol, while transmitting them insecurely on a neighboring port?</p></div></div></section></body></html>