- en: Chapter 15. VIRTUAL PRIVATE NETWORKS
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '![VIRTUAL PRIVATE NETWORKS](tagoreillycom20090210nostarchimages255004.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: The security tools in the Wi-Fi specification are not good enough to protect
    data transmitted through a wireless network. What's the fix? A virtual private
    network (VPN) can add another effective form of security to data that moves from
    a wireless network client to a host that can be located anywhere with a network
    connection.
  prefs: []
  type: TYPE_NORMAL
- en: A VPN uses a *data tunnel* to connect two points on a network through an encrypted
    channel. The end points can be a single network client and a network server, a
    pair of client computers or other devices, or the gateways to a pair of LANs.
    Data that passes through a public network such as the Internet is completely isolated
    from other network traffic. It uses login and password authentication to restrict
    access to authorized users; it encrypts the data to make it unintelligible to
    intruders who intercept it; and it uses data authentication to maintain the integrity
    of each data packet and to assure that all data originates with legitimate network
    clients.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '*VPN functions occur at the IP or network layer of the ISO model. Therefore,
    they can operate on top of the Wi-Fi or other wireless protocols, which operate
    at the physical layer. VPNs can also pass data across a network connection that
    includes more than one physical medium (for example, a wireless link that passes
    data onward to a wired Ethernet network). In other words, a VPN is an end-to-end
    service; it doesn''t matter whether data uses a wireless link, an Ethernet cable,
    an ordinary telephone line, or some combination of those and other transmission
    media. This adds another level of security to (or provides an alternative to)
    WEP or WPA encryption, which only applies to the wireless portion of the network*.'
  prefs: []
  type: TYPE_NORMAL
- en: In a traditional VPN, a remote user can log in to a distant LAN and obtain all
    the same network services that are available to local clients. VPNs are commonly
    used to extend corporate networks to branch offices and to connect users to the
    LAN from home or from off-site locations such as a client or customer's office.
  prefs: []
  type: TYPE_NORMAL
- en: A connection through a VPN server presents the same appearance to the rest of
    the network as a client device connected directly to the LAN. The only difference
    is that the data from the VPN passes through a VPN driver and a public network
    instead of moving directly from the network adapter to the LAN. [Figure 15-1](ch15.html#a_remote_network_can_connect_to_a_lan_th
    "Figure 15-1. A remote network can connect to a LAN through a VPN.") shows a typical
    VPN connection to a remote network.
  prefs: []
  type: TYPE_NORMAL
- en: '![A remote network can connect to a LAN through a VPN.](tagoreillycom20090210nostarchimages254669.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 15-1. A remote network can connect to a LAN through a VPN.**'
  prefs: []
  type: TYPE_NORMAL
- en: 'All of the same security benefits also apply to a short-range VPN that tunnels
    through a wireless link and a longer-range VPN that starts on a wireless network
    and relays the data to a remote server. These are two different uses for a VPN:
    a *local* VPN that only extends across the wireless portion of a network between
    the client devices and the access point and an *extended network* that carries
    VPN-encoded data beyond the access points to a VPN server through a public network,
    such as the Internet or a dial-up telephone connection.'
  prefs: []
  type: TYPE_NORMAL
- en: An extended network is a traditional VPN that happens to originate from a wireless
    network client. The same VPN can also support connections that don't include a
    wireless segment and logins from public wireless services, such as the ones at
    airports or coffee shops. This is the conventional way to use a VPN.
  prefs: []
  type: TYPE_NORMAL
- en: Local, short-range VPNs are interesting to people who operate wireless networks
    because they add another layer of security to wireless links. Because the data
    moving between wireless clients and the network access point is encrypted (using
    an algorithm that is more secure than WPA encryption), it is unintelligible to
    any third party who might be monitoring the radio signal; because the VPN server
    at the access point won't accept data links from wireless clients that are not
    using the correct VPN drivers and passwords, an intruder can't break into the
    network by associating a rogue client with the access point.
  prefs: []
  type: TYPE_NORMAL
- en: The goal of a wireless VPN is to protect the wireless link between the clients
    and the access point and to lock out unauthorized users. Therefore, the isolated
    and encrypted data can only move across a single room rather than hundreds or
    thousands of miles. Of course, the access point might also relay VPN-encoded data
    onward through the Internet to a network host in another location.
  prefs: []
  type: TYPE_NORMAL
- en: '[Figure 15-2](ch15.html#a_vpn_provides_a_secure_connection_betwe "Figure 15-2. A
    VPN provides a secure connection between a wireless network and an Internet gateway
    or a local LAN.") shows a wireless connection to a VPN. The VPN server is located
    between the wireless access point and the host LAN, so all of the packets that
    move through the wireless portion of the network are encoded. For clarity, the
    diagram shows the VPN server as a separate component, but the most practical way
    to add VPN security to a wireless LAN is to use a router or gateway that incorporates
    VPN support. VPN-enabled routers are available from several vendors, including
    Cisco, NETGEAR, and TRENDnet.'
  prefs: []
  type: TYPE_NORMAL
- en: '![A VPN provides a secure connection between a wireless network and an Internet
    gateway or a local LAN.](tagoreillycom20090210nostarchimages254442.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 15-2. A VPN provides a secure connection between a wireless network
    and an Internet gateway or a local LAN.**'
  prefs: []
  type: TYPE_NORMAL
- en: VPN Methods
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A VPN moves data through one or more intermediate networks to a destination
    on another network. The VPN's tunneling client encapsulates the existing data
    packets or frames by adding a new header with the routing information that instructs
    them how to reach the end point of the VPN. The transmission path through the
    intermediate networks is called a tunnel. At the other end of the tunnel, the
    VPN server removes the tunneling header and forwards the data to the destination
    specified by the next layer of headers. The exact form of the tunnel doesn't make
    any difference to the data because the data treats the tunnel as a point-to-point
    connection.
  prefs: []
  type: TYPE_NORMAL
- en: The tunneling headers can take several forms. The methods used most widely in
    VPNs are Point-to-Point Tunneling Protocol (PPTP), Layer Two Tunneling Protocol
    (L2TP), and IP Security (IPsec) mode. PPTP and L2TP can move data through IP,
    IPX, and NetBEUI networks; IPsec is limited to IP networks. Both the client and
    the server must use the same protocol.
  prefs: []
  type: TYPE_NORMAL
- en: In PPTP and L2TP, the client and server must configure the tunnel for each transmission
    before they begin to exchange data. The configuration parameters include the route
    through the intermediate network and the encryption and compression specifications.
    When the transmission is complete, the client and server terminate the connection
    and close the tunnel. Unfortunately, several data security analysts have identified
    significant flaws in PPTP that can allow intruders to break into a VPN based on
    PPTP and sniff passwords, decode encryption, read data, or inflict damage to a
    network server. Therefore, PPTP headers are not secure and should not be used.
  prefs: []
  type: TYPE_NORMAL
- en: In an IPsec network link, the client and server must establish the tunnel through
    the intermediate networks in a separate transaction before they begin to exchange
    data.
  prefs: []
  type: TYPE_NORMAL
- en: 'Both L2TP and IPsec offer specific advantages and disadvantages, but they''re
    both good enough to create a secure link between a wireless network client and
    an access point. The differences among the three are technical rather than practical.
    You can find an excellent explanation of the internal operation of all three protocols
    in Microsoft''s white paper entitled *Virtual Private Networking in Windows 2000:
    An Overview*, which is available online at [http://www.microsoft.com/windows2000/docs/VPNoverview.doc](http://www.microsoft.com/windows2000/docs/VPNoverview.doc)
    (but remember that the flaws in PPTP networks were identified after that white
    paper was written).'
  prefs: []
  type: TYPE_NORMAL
- en: VPN Servers
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A VPN server (or host) can be part of a Unix or Windows server, or it can be
    built into a stand-alone network router or gateway. If your network already uses
    a separate computer as a dedicated server, you can use that computer as the VPN
    server. A separate piece of hardware might be a better choice if your network
    does not already have a full-blown network server.
  prefs: []
  type: TYPE_NORMAL
- en: Dozens of VPN equipment makers offer routers, gateways, and other products that
    support one or more of the VPN protocols. Each of these products has a different
    feature set, so it's essential to test the specific combination of client and
    server that you intend to use on your own network before you commit to them. The
    Virtual Private Network Consortium (VPNC) is moving toward a set of interoperability
    tests and certification standards (much like the Wi-Fi standards for wireless
    Ethernet equipment). The VPNC website, [http://www.vpnc.org](http://www.vpnc.org),
    lists the products that have passed the interoperability tests, and it also provides
    links to sources of information about a long list of VPN products.
  prefs: []
  type: TYPE_NORMAL
- en: Configuring a Windows Server for a Wireless VPN
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'If you''re committed to using a Windows server, you can use either L2TP or
    IPsec with Windows Server 2003 or Windows Server 2008; if your server runs the
    older Windows NT Server 4.0 or Windows 2000 Server software, you''re limited to
    L2TP (or the seriously flawed PPTP). The server also requires two network interface
    cards: one connected to the wired LAN or the Internet gateway and the other connected
    to the wireless network. The interface card that is connected to the wireless
    port normally connects directly to the wireless access point''s Ethernet port.
    The exact process of installing an L2TP host on a Windows server is slightly different
    in each version of Windows, but the general steps are the same. For specific information
    about configuring a particular operating system, consult the online Help screens
    and Microsoft''s Resource Kit and other online documentation for your server''s
    operating system. The following sections describe the configuration steps in general
    terms.'
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '*For more information about deploying and using VPNs with Microsoft servers,
    see the Microsoft TechNet articles linked from* [http://technet.microsoft.com/en-us/network/bb545442.aspx](http://technet.microsoft.com/en-us/network/bb545442.aspx).'
  prefs: []
  type: TYPE_NORMAL
- en: Configure the Connection to the Wired Network
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The link to the LAN or other network is a dedicated connection through a network
    adapter. The network connection profile for this connection must include the IP
    address and subnet mask assigned to this connection and the default gateway address
    assigned to the network gateway.
  prefs: []
  type: TYPE_NORMAL
- en: Configure the VPN Connection
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The VPN connection is usually an Ethernet link to one or more access points.
    The connection profile on the server for the VPN connection must include the IP
    address and subnet mask assigned to this port and the addresses of the DNS and
    WINS name servers used by this network.
  prefs: []
  type: TYPE_NORMAL
- en: Configure the Remote Access Server as a Router
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The server must use either static routes or routing protocols that make each
    wireless client reachable from the wired network.
  prefs: []
  type: TYPE_NORMAL
- en: Enable and Configure the Server for L2TP Clients
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Windows uses Remote Access Service (RAS) and Point-to-Point Protocol (PPP)
    to establish VPN connections. The Routing and Remote Access service enables RAS.
    A VPN connection requires these RAS configuration options:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Authentication Method** Encrypted PPTP connections use the MS-CHAP or EAP-TLS
    authentication methods. |'
  prefs: []
  type: TYPE_TB
- en: '| **Authentication Provider** Either Windows 2000 security or an external RADIUS
    server can verify network clients. |'
  prefs: []
  type: TYPE_TB
- en: '| **IP Routing** IP Routing and IP-based remote access must be active. If the
    wired network acts as a DHCP server for the wireless clients, DHCP must be active.
    |'
  prefs: []
  type: TYPE_TB
- en: Configure L2TP Ports
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Set each L2TP port to accept remote access.
  prefs: []
  type: TYPE_NORMAL
- en: Configure Network Filters
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Input and output filters keep the remote access server from sending and receiving
    data that does not originate at a VPN client. These filters will reject data to
    or from unauthorized users, so those intruders will not be able to obtain an Internet
    connection (or a connection to the wired LAN) through the wireless network.
  prefs: []
  type: TYPE_NORMAL
- en: Configure Remote Access Policies
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The remote access permission for each wireless client must be set to allow
    access to the RAS server. The port type must be set to the correct VPN protocol
    (e.g., PPTP or L2TP), and the profile for each connection must include the type
    of encryption in use. In Windows, the three encryption strength options are:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Basic** Uses a 40-bit encryption key |'
  prefs: []
  type: TYPE_TB
- en: '| **Strong** Uses a 56-bit encryption key |'
  prefs: []
  type: TYPE_TB
- en: '| **Strongest** Uses a 128-bit encryption key |'
  prefs: []
  type: TYPE_TB
- en: VPN Servers for Unix
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: All of the BSD variations (including FreeBSD, NetBSD, OpenBSD, and Mac OS X)
    include an IPsec VPN client and server as part of the release package.
  prefs: []
  type: TYPE_NORMAL
- en: Linux FreeS/WAN is the most popular implementation of IPsec for Linux. Go to
    [http://www.freeswan.org](http://www.freeswan.org) for downloads, documentation,
    and access to the community of FreeS/WAN users.
  prefs: []
  type: TYPE_NORMAL
- en: OpenVPN is an SSL-based VPN solution for Linux, BSD, OS X, and Windows. It is
    easy to configure and offers both routed VPN (traffic to specific destinations
    is sent through the VPN) and tunneled virtual interfaces (emulating a physical
    layer Ethernet device, which can pass non-IP traffic through the VPN). OpenVPN
    can be found at [http://openvpn.net](http://openvpn.net).
  prefs: []
  type: TYPE_NORMAL
- en: If you are using a Linux firewall, you might want to consider VPN Masquerade.
    Linux uses the IP Masquerade function in the Linux kernel to share a single connection
    to the Internet among multiple clients. VPN Masquerade is the section of IP Masquerade
    that supports IPsec clients. The HOWTO for Linux VPN Masquerade is at [http://tldp.org/HOWTO/VPN-Masquerade-HOWTO.html](http://tldp.org/HOWTO/VPN-Masquerade-HOWTO.html).
  prefs: []
  type: TYPE_NORMAL
- en: Network Hardware with Built-in VPN Support
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A dedicated computer running Linux or one of the BSD versions of Unix can be
    an inexpensive VPN server; if you're using a Windows server for other purposes,
    it can also provide VPN support at little or no additional cost. But a full-size
    network server is often a bigger and more complicated solution to a relatively
    simple problem. They're not always the best choice. Many switches, routers, gateways,
    and firewall devices also include VPN support. Cisco, 3COM, Intel, and many other
    manufacturers make VPN products that are often easier to install and maintain
    than a separate computer.
  prefs: []
  type: TYPE_NORMAL
- en: In a wireless network, the VPN server does not need all the same bells and whistles
    as a server in a larger corporate network. As [Figure 15-3](ch15s02.html#a_network_router_can_also_act_as_a_vpn_s
    "Figure 15-3. A network router can also act as a VPN server for a wireless network.")
    shows, a router located between the wireless access point and the wired portion
    of an enterprise network can easily double as a VPN server. In a home network,
    the VPN server can operate between the access point and a DSL or cable modem.
  prefs: []
  type: TYPE_NORMAL
- en: '![A network router can also act as a VPN server for a wireless network.](tagoreillycom20090210nostarchimages253997.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 15-3. A network router can also act as a VPN server for a wireless
    network.**'
  prefs: []
  type: TYPE_NORMAL
- en: Stand-alone VPN client hardware that sits between the computer and the network
    is also available, but it's not as practical in a wireless network because the
    wireless network adapter is almost always plugged directly into the computer itself.
  prefs: []
  type: TYPE_NORMAL
- en: VPN Client Software
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A wireless client connects to a VPN server through its wireless Ethernet link
    to the network access point, which the operating system sees as a LAN connection.
    To set up a VPN tunnel through that connection, you must install the tunneling
    protocol as a network service.
  prefs: []
  type: TYPE_NORMAL
- en: Configuring Windows for VPN
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Windows XP and Vista include support for VPNs, but it's not part of the default
    installation, so the first step in setting up a VPN client is to install the protocol.
  prefs: []
  type: TYPE_NORMAL
- en: 'In Windows XP and Windows Vista, a wizard makes the whole process easy. In
    XP, follow these steps to set up a VPN connection:'
  prefs: []
  type: TYPE_NORMAL
- en: From the Control Panel, open **Network Connections**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Double-click the **New Connection Wizard** icon.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: When the Network Connection Type window shown in [Figure 15-4](ch15s03.html#the_option_for_creating_a_vpn_link_speci
    "Figure 15-4. The option for creating a VPN link specifies connecting to a workplace
    network, but it also applies to a wireless VPN.") appears, choose the **Connect
    to the network at my workplace** option.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![The option for creating a VPN link specifies connecting to a workplace network,
    but it also applies to a wireless VPN.](tagoreillycom20090210nostarchimages254435.png.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: '**Figure 15-4. The option for creating a VPN link specifies connecting to a
    workplace network, but it also applies to a wireless VPN.**'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: In the Network Connection window (shown in [Figure 15-5](ch15s03.html#select_the_virtual_private_network_conne
    "Figure 15-5. Select the Virtual private network connection option to create a
    VPN connection.")), choose the **Virtual private network connection** option and
    click the **Next** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the Connection Name window, type a name for the Wireless VPN connection.
    This name will appear on desktop shortcuts to this connection. Click the **Next**
    button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Select the Virtual private network connection option to create a VPN connection.](tagoreillycom20090210nostarchimages254575.png.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: '**Figure 15-5. Select the Virtual private network connection option to create
    a VPN connection.**'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: In the Public Network window (shown in [Figure 15-6](ch15s03.html#in_a_wireless_network_the_vpn_does_not_r
    "Figure 15-6. In a wireless network, the VPN does not require a dial-up connection.")),
    choose the **Do not dial the initial connection** option because you don't need
    to connect through a telephone line. Click the **Next** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![In a wireless network, the VPN does not require a dial-up connection.](tagoreillycom20090210nostarchimages254332.png.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: '**Figure 15-6. In a wireless network, the VPN does not require a dial-up connection.**'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: In the VPN Server Selection window shown in [Figure 15-7](ch15s03.html#the_host_name_or_ip_address_identifies_t
    "Figure 15-7. The Host Name or IP Address identifies the VPN server at the other
    end of the wireless link."), type the IP address of the VPN server.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![The Host Name or IP Address identifies the VPN server at the other end of
    the wireless link.](tagoreillycom20090210nostarchimages254057.png.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: '**Figure 15-7. The Host Name or IP Address identifies the VPN server at the
    other end of the wireless link.**'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Click the **Next** button and then the **Finish** button to complete the wizard.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In Vista, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Open the **Control Panel**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Open the **Network and Sharing Center**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the list of Tasks on the left side of the Network and Sharing Center shown
    in [Figure 15-8](ch15s03.html#use_the_set_up_a_connection_or_network_o "Figure 15-8. Use
    the Set up a connection or network option to create a VPN link."), choose the
    **Set up a connection or network** option. A Choose a Connection Option window
    will open.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose the **Connect to a workplace** option and click the **Next** button.
    The wizard will ask if you want to use an existing connection.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose the **No, create a new connection** option. The wizard will ask if you
    want to use a VPN or a dial-up connection.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Use the Set up a connection or network option to create a VPN link.](tagoreillycom20090210nostarchimages254757.png.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: '**Figure 15-8. Use the Set up a connection or network option to create a VPN
    link.**'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Choose the **Internet connection (VPN)** option. The wizard will ask for details
    in the screen shown in [Figure 15-9](ch15s03.html#use_this_screen_to_configure_your_vpn
    "Figure 15-9. Use this screen to configure your VPN.").
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Use this screen to configure your VPN.](tagoreillycom20090210nostarchimages254187.png.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: '**Figure 15-9. Use this screen to configure your VPN.**'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Type the VPN server's address provided by the network manager in the Internet
    Address field. This can be either a numeric address or a name.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Type the name you want to use on your own computer for this VPN connection in
    the Destination Name field.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If you want to test the connection, click the Next button. If you don't want
    to connect, select the Don't connect now option and click Next. The wizard will
    ask for your name and password.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Type the name and password you use for this VPN account. If you want your computer
    to automatically send your password, turn on the **Remember this password** option.
    Click the **Create** button to establish the VPN connection and close the wizard.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'To create a shortcut to a VPN on your desktop in Windows, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: In XP, open the Control Panel and choose **Network Connections**. In Vista,
    open the Control Panel, choose the **Network and Sharing Center**, and select
    **Manage Network Connections** from the list of Tasks.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: From the Network Connections window, right-click the icon or listing for the
    VPN and choose **Create Shortcut** from the pop-up menu.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: A pop-up window will ask if you want to place the shortcut on the desktop. Click
    the **Yes** button. A shortcut will appear on the desktop.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The Microsoft L2TP/IPsec VPN Client
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Microsoft includes a client for Layer Two Tunneling Protocol (L2TP) connections
    with Internet Protocol security (IPsec) in Windows 2000, Windows XP, and Windows
    Vista. A similar client program for Windows 98, Windows Me, and Windows NT Workstation
    4.0 is available for free download from [http://download.microsoft.com/download/win98/Install/1.0/W9XNT4Me/EN-US/msl2tp.exe](http://download.microsoft.com/download/win98/Install/1.0/W9XNT4Me/EN-US/msl2tp.exe).
  prefs: []
  type: TYPE_NORMAL
- en: Making the Connection in Windows
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'When the VPN connection profile is in place, it''s easy to connect a Windows
    client to the host LAN or the Internet through the wireless VPN link: Just double-click
    the icon for the connection profile. Windows will ask for a login and password
    and then make the connection.'
  prefs: []
  type: TYPE_NORMAL
- en: 'If your wireless connection is the method you use most often to connect to
    the Internet, you can make it the default connection, which will open whenever
    you run a network application such as a web browser or email client program. To
    make the VPN profile the default, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Open the **Internet Properties** window from the Control Panel.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the **Connections** tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the Dial-Up Settings section, select the VPN connection profile from the
    list and click the **Set Default** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the **Settings** button. In the Dial-Up Settings section, type your login
    and password on the VPN server.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose the **Dial whenever a network connection is not present** option.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Windows XP Options
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Windows XP and Windows Vista offer many VPN options that were not available
    in earlier versions of Windows. To set these options, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Open the **Network Connections** window from the Control Panel. If you have
    a shortcut to your VPN connection on the desktop, you can skip this step.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Double-click the VPN icon. A Connect VPN to Internet window like the one in
    [Figure 15-10](ch15s03.html#use_the_connect_vpn_to_internet_window_t "Figure 15-10. Use
    the Connect VPN to Internet window to configure a VPN in Windows XP.") will appear.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Use the Connect VPN to Internet window to configure a VPN in Windows XP.](tagoreillycom20090210nostarchimages254893.png.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: '**Figure 15-10. Use the Connect VPN to Internet window to configure a VPN in
    Windows XP.**'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Click the **Properties** button. The Properties window for your VPN client will
    appear. [Figure 15-11](ch15s03.html#the_general_tab_controls_the_destination "Figure 15-11. The
    General tab controls the destination of a VPN connection.") shows the General
    tab of the VPN to Internet Properties window.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![The General tab controls the destination of a VPN connection.](tagoreillycom20090210nostarchimages254661.png.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: '**Figure 15-11. The General tab controls the destination of a VPN connection.**'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: The IP address of the VPN server should already be visible in the Host Name
    or IP Address of Destination field. The **Dial another connection first** option
    should be disabled. Click the **Networking** tab to view the dialog box shown
    in [Figure 15-12](ch15s03.html#the_networking_tab_controls_the_vpns_net "Figure 15-12. The
    Networking tab controls the VPN's network configuration options.").
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![The Networking tab controls the VPN''s network configuration options.](tagoreillycom20090210nostarchimages254728.png.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: '**Figure 15-12. The Networking tab controls the VPN''s network configuration
    options.**'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Choose the type of VPN server your network will use from the Type of VPN menu.
    If you don't know the VPN type, choose the Automatic option.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select Internet Protocol (TCP/IP) or Internet Protocol Version 4 from the list
    of connection items, and click the **Properties** button to change the network
    settings, including the use of a DHCP server or manual settings for IP address
    and DNS.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the **Advanced** tab to open the dialog box shown in [Figure 15-13](ch15s03.html#the_advanced_tab_controls_the_use_of_a_f
    "Figure 15-13. The Advanced tab controls the use of a firewall on the VPN.").
    If your network is not already protected by a firewall, select the Internet connection
    firewall option. This will protect the wireless client from attacks coming through
    the Internet.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![The Advanced tab controls the use of a firewall on the VPN.](tagoreillycom20090210nostarchimages254720.png.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: '**Figure 15-13. The Advanced tab controls the use of a firewall on the VPN.**'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: The Options and Security tabs in the VPN to Internet Properties window control
    connection options that normally don't change from the default settings. Network
    managers who want to change the security settings should instruct their users
    how to configure these options to comply with the network's specific requirements.
  prefs: []
  type: TYPE_NORMAL
- en: VPN Clients for Unix
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Using a VPN client on a computer running Unix is more complicated than running
    a VPN from a Windows machine because the client is not integrated into the kernel.
    Therefore, you must find a client program that works with the version of Unix
    *and* the VPN protocol you are trying to use. No single program offers a universal
    VPN client, and some combinations, such as PPTP on BSD Unix versions, don't seem
    to exist at all.
  prefs: []
  type: TYPE_NORMAL
- en: IPsec Clients
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Linux users can choose from several IPsec implementations:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **FreeS/WAN** [http://www.freeswan.org](http://www.freeswan.org) |'
  prefs: []
  type: TYPE_TB
- en: '| **pipsec** [http://perso.enst.fr/~beyssac/pipsec](http://perso.enst.fr/~beyssac/pipsec)
    |'
  prefs: []
  type: TYPE_TB
- en: '| **NIST Cerberus** [http://w3.antd.nist.gov/tools/cerberus](http://w3.antd.nist.gov/tools/cerberus)
    |'
  prefs: []
  type: TYPE_TB
- en: IPsec is included in the OpenBSD distribution. You can find a tutorial that
    explains how to use it at [http://www2.papamike.ca:8082/tutorials/pub/obsd_ipsec.html](http://www2.papamike.ca:8082/tutorials/pub/obsd_ipsec.html).
  prefs: []
  type: TYPE_NORMAL
- en: The IPsec implementation for FreeBSD is at [http://www.r4k.net/ipsec](http://www.r4k.net/ipsec).
  prefs: []
  type: TYPE_NORMAL
- en: For information about NetBSD IPsec, take a look at [http://www.netbsd.org/Documentation/network/ipsec](http://www.netbsd.org/Documentation/network/ipsec).
  prefs: []
  type: TYPE_NORMAL
- en: Using a Wireless VPN
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When you design a VPN to protect the data on your network as it passes through
    the wireless link, it's important to understand exactly where the end points of
    the VPN tunnel are located. If the VPN only tunnels through the wireless link,
    as shown in [Figure 15-14](ch15s04.html#a_wireless_vpn_with_the_server_at_the_ac
    "Figure 15-14. A wireless VPN with the server at the access point protects data
    through the wireless link, but it does not extend the network."), the network
    will look exactly the same as it does without a VPN.
  prefs: []
  type: TYPE_NORMAL
- en: '![A wireless VPN with the server at the access point protects data through
    the wireless link, but it does not extend the network.](tagoreillycom20090210nostarchimages254824.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 15-14. A wireless VPN with the server at the access point protects
    data through the wireless link, but it does not extend the network.**'
  prefs: []
  type: TYPE_NORMAL
- en: If the VPN extends beyond the wireless access points to pass through a wide
    area network (such as the Internet), like the one in [Figure 15-15](ch15s04.html#a_vpn_can_include_both_the_wireless_link
    "Figure 15-15. A VPN can include both the wireless link and an intercity connection
    through the Internet to a corporate network."), the wireless network client can
    appear to be part of a LAN in another building or halfway across the continent.
  prefs: []
  type: TYPE_NORMAL
- en: So how far should your wireless VPN extend? It depends on what you want the
    network to accomplish. If your wireless network is in place to support laptop
    and other portable computers at your office, factory, or campus, it makes sense
    to place the server between the network of access points and the connection to
    your corporate LAN. This will protect your wireless users' data and keep unauthorized
    users off the network, but it won't affect the other users whose computers connect
    to the LAN through cables.
  prefs: []
  type: TYPE_NORMAL
- en: '![A VPN can include both the wireless link and an intercity connection through
    the Internet to a corporate network.](tagoreillycom20090210nostarchimages254923.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 15-15. A VPN can include both the wireless link and an intercity connection
    through the Internet to a corporate network.**'
  prefs: []
  type: TYPE_NORMAL
- en: At home or in a small business network, the access points probably connect to
    an Internet gateway router that provides Internet access to all the computers
    in the office or the house. If the access point and the gateway are separate devices,
    you can place the VPN server between the two. If the access point and gateway
    are combined in the same box, you'll either have to use VPN clients on all your
    computers, including the desktop machines that are hardwired to the gateway, and
    place the client between the gateway and the Internet modem like the network in
    [Figure 15-16](ch15s04.html#in_a_small_lan_you_can_use_vpn_clients_o "Figure 15-16. In
    a small LAN, you can use VPN clients on every computer."), or you'll have to ignore
    the wired Ethernet ports on the gateway and add a new hub or switch between the
    VPN server and the Internet modem, as shown in [Figure 15-17](ch15s04.html#in_this_network_the_vpn_only_protects_th
    "Figure 15-17. In this network, the VPN only protects the wireless links.").
  prefs: []
  type: TYPE_NORMAL
- en: '![In a small LAN, you can use VPN clients on every computer.](tagoreillycom20090210nostarchimages254326.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 15-16. In a small LAN, you can use VPN clients on every computer.**'
  prefs: []
  type: TYPE_NORMAL
- en: '![In this network, the VPN only protects the wireless links.](tagoreillycom20090210nostarchimages254656.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 15-17. In this network, the VPN only protects the wireless links.**'
  prefs: []
  type: TYPE_NORMAL
- en: Making the Connection
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: If you use the wireless LAN with VPN protection most of the time, you should
    make the VPN profile your default connection. Whenever you run a network application,
    the computer will try to connect through the VPN unless you open a different connection
    (such as a dial-up telephone line) first.
  prefs: []
  type: TYPE_NORMAL
- en: To set a connection profile as the default in Windows, open the **Network Connections**
    window. Right-click the icon for the profile you want to choose, and select the
    **Set as default** option from the menu.
  prefs: []
  type: TYPE_NORMAL
- en: To connect to a VPN that isn't your default, double-click the icon for the VPN's
    connection profile. You will see a login window like the one in [Figure 15-18](ch15s04.html#a_vpn_connection_normally_requires_a_log
    "Figure 15-18. A VPN connection normally requires a login name and password.").
    Type your name and password, and click the **Connect** button. If the VPN server
    recognizes your account, it will set up the connection.
  prefs: []
  type: TYPE_NORMAL
- en: '![A VPN connection normally requires a login name and password.](tagoreillycom20090210nostarchimages254147.png.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 15-18. A VPN connection normally requires a login name and password.**'
  prefs: []
  type: TYPE_NORMAL
- en: Bypassing the VPN
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Even though you normally use a VPN to protect your wireless data, you might
    sometimes want to send data in the clear without using the VPN. For example, you
    might use a local VPN at your own office or at home between your computer and
    your Internet gateway router, but when you use the same computer at an airport
    or a coffee shop, or some other location that isn't protected by a VPN, you can
    use the same computer and network adapter to connect directly to the Internet.
  prefs: []
  type: TYPE_NORMAL
- en: If you're a network manager, you might occasionally have to change your Wi-Fi
    network's internal settings. The configuration programs that control the Wi-Fi
    network's operating channel, SSID, and other options are web-based utilities that
    originate on the access point. Because the access point is inside the VPN tunnel,
    it is not possible to send commands to the access point through the VPN. It's
    important to remember that you can use a VPN when you need it and bypass it when
    you want to make a direct connection.
  prefs: []
  type: TYPE_NORMAL
- en: Using a VPN Through a Public Network
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: When you connect your laptop to your corporate LAN through a public network
    at an airport or in a conference center, or if you're using a broadband wireless
    service, you can connect through their network to the Internet and onward to your
    corporate VPN server. Because you will have to log in to the public network before
    you initiate the VPN connection, you should create a separate *VPN via Public
    Network* connection profile in addition to the one you use from your own office.
    The profile should point to your corporate VPN server, but it should not be your
    default connection.
  prefs: []
  type: TYPE_NORMAL
- en: 'To connect through a public network on a computer running Windows, follow these
    steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Turn on the computer with the wireless network adapter in place.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Use your wireless configuration utility to select the public network you want
    to use.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Start Internet Explorer, Netscape Navigator, or some other web browser. You
    will see the public network's login screen.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If the computer doesn't do it automatically, enter your account name and password.
    The public network will acknowledge your login.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Minimize the browser window and open the **Network Connections** window or find
    the VPN shortcut on your desktop.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Double-click the icon for your VPN via Public Network profile. The computer
    will connect through the Internet to your corporate LAN.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enter the login and password for your corporate network.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If this procedure doesn't work for your VPN, ask your network manager for help.
  prefs: []
  type: TYPE_NORMAL
- en: VPNs are an important part of many networks' security plans for off-site users.
    When a VPN is up and running, it's also an extremely convenient way to connect
    to your LAN. With just a few keystrokes or mouse clicks, you can establish the
    same access to your network resources from anywhere with Internet access that
    you can get from your own office. If any Internet technique can eliminate the
    apparent distance between you and your LAN, your office, and your colleagues,
    a VPN is that technique.
  prefs: []
  type: TYPE_NORMAL
