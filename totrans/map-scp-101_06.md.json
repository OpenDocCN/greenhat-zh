["```\nvar dist_km = marker1.location.distance(marker2.location);\n```", "```\nfunction LatLonPoint_distance(pt1, pt2) {\n❶   var rads = Math.PI / 180;\n    var diffLat = (pt1.lat-pt2.lat) * rads;\n    var diffLon = (pt1.lon-pt2.lon) * rads;\n    var a = Math.sin(diffLat / 2) * Math.sin(diffLat / 2) +\n            Math.cos(pt1.lat * rads) * Math.cos(pt2.lat * rads) *\n            Math.sin(diffLon/2) * Math.sin(diffLon/2);\n    return 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)) * ❷6371;\n  }\n```", "```\nvar mapstraction;\n  var dist;\n  var wportland, eportland;\n  function create_map() {\n    mapstraction = new mxn.Mapstraction('mymap', 'google');\n    mapstraction.addSmallControls();\n    // Declare points for each side of the river\n    wportland = new mxn.LatLonPoint(45.52822, −122.67195);\n    eportland = new mxn.LatLonPoint(45.52933, −122.66957);\n\n❶   dist = eportland.distance(wportland); // Calculate distance\n\n    // Show points on the map\n    mapstraction.addMarker(new mxn.Marker(wportland));\n    mapstraction.addMarker(new mxn.Marker(eportland));\n❷   mapstraction.addPolylineWithData(new mxn.Polyline([wportland, eportland]));\n    mapstraction.autoCenterAndZoom();\n\n    var disttext = document.createTextNode(\"Distance is \" + dist + \" km.\");\n❸   mapstraction.currentElement.parentNode.appendChild(disttext);\n  }\n```", "```\nvar mapstraction;\n  var gdir;\n  var dist, ddist;\n  var wportland, eportland;\n  function create_map() {\n    mapstraction = new mxn.Mapstraction('mymap', 'google');\n    mapstraction.addSmallControls();\n    // Declare points for each side of the river\n    wportland = new mxn.LatLonPoint(45.52822, −122.67195);\n    eportland = new mxn.LatLonPoint(45.52933, −122.66957);\n    dist = eportland.distance(wportland); // Calculate distance\n    mapstraction.addPolylineWithData(new mxn.Polyline([wportland, eportland]));\n\n    // Google-specific code for driving directions\n❶   gdir = new google.maps.DirectionsService();\n❷   var diropt = {\n    origin: wportland.toProprietary(mapstraction.api),\n    destination: eportland.toProprietary(mapstraction.api),\n    travelMode: google.maps.DirectionsTravelMode.DRIVING\n    };\n    gdir.route(diropt, ❸setDDist);\n  }\n  function setDDist() {\n    if (status == google.maps.DirectionsStatus.OK) {\n      var directionsDisplay = new google.maps.DirectionsRenderer(\n                              {map: mapstraction.getMap()});\n❹     directionsDisplay.setDirections(response);\n❺     ddist = response.routes[0].legs[0].distance.value / 1000;\n      // driving distance in km\n      var disttext = document.createTextNode(\"Normal distance is \" + dist +\n      \" km, but driving distance is \" + ddist + \" km\");\n❻     mapstraction.currentElement.parentNode.appendChild(disttext);\n    }\n  }\n  function handleErrors(){\n    // Handle errors in this section\n  }\n```", "```\n<html >\n  <head>\n    <title>Driving Directions with Google Maps</title>\n\n    <script type=\"text/javascript\" src=\"http://maps.google.\ncom/maps/api/js?sensor=false\"></script>\n    <style type=\"text/css\">\n    div#mymap {\n      width: 400px;\n      height: 350px;\n    }\n    div#mydir {\n      width: 400px;\n    }\n    </style>\n    <script type=\"text/javascript\">\n      ❶var myaddress = \"2839 NE Alberta St, Portland, OR\";\n      // Google Maps Driving Directions Code Will Go Here\n    </script>\n  </head>\n  <body ❷onload=\"create_map()\" onunload=\"GUnload()\">\n    <h1>Venido a La Bonita</h1>\n\n    <div id=\"mymap\"></div>\n    ❸<div id=\"mydir\"></div>\n  </body>\n</html>\n```", "```\n<form onSubmit=\"❹loadDir();return false;\">\n  Address: <input type=\"text\" name=\"addr\" />\n  City: <input type=\"text\" name=\"city\" value=\"Portland\" />\n  ❺<select name=\"state\">\n    <option>OR</option>\n    <option>WA</option>\n  </select>\n  <input type=\"submit\" value=\"Go\" />\n</form>\n```", "```\n❶ var map, gdir;\n  function create_map() {\n    var opt = {center: new google.maps.LatLng(45.559192, −122.636049), zoom: 15,\n               mapTypeId: google.maps.MapTypeId.ROADMAP};\n    map = new google.maps.Map(document.getElementById(\"mymap\"), opt);\n❷   gdir = new google.maps.DirectionsService();\n  }\n  function loadDir() {\n    var stateobj = document.getElementById('state');\n❸   var fromaddress = document.getElementById('addr').value + \" \"\n          + document.getElementById('city').value + \", \"\n          + stateobj.options[stateobj.selectedIndex].value;\n❹   var diropt = {\n      origin: fromaddress, destination: myaddress,\n      travelMode: google.maps.DirectionsTravelMode.DRIVING\n    }\n    gdir.route(diropt, ❺setDir);\n  }\n  function setDir(response, status) {\n    if (status == google.maps.DirectionsStatus.OK) {\n      var directionsDisplay = new google.maps.DirectionsRenderer(\n          {map: map, panel: document.getElementById('mydir')});\n      directionsDisplay.setDirections(response);\n    }\n  }\n```", "```\nfunction get_random_by_bounds(bounds) {\n  var lat = bounds.sw.lat + (Math.random() * (bounds.ne.lat − bounds.sw.lat));\n             var lon = bounds.sw.lon + (Math.random()\n * (bounds.ne.lon − bounds.sw.lon));\n  return new mxn.LatLonPoint(lat, lon);\n}\n```", "```\n❶ var bounds = new mxn.BoundingBox(32.4, −113.9, 40.9, −103.0);\n❷ for (i=1; i<=5; i++) {\n    var marker = new mxn.Marker(❸get_random_by_bounds(bounds));\n    mapstraction.addMarker(marker);\n  }\n❹ mapstraction.setBounds(bounds);\n  mapstraction.click.addHandler(❺find_closest_marker);\n```", "```\nfunction find_closest_marker(event_type, event_source, event_args) {\n    if (mapstraction.markers.length > 0) {\n      var clickpoint = event_args.location;\n❻     var closest_marker = mapstraction.markers[0];\n❼     var closest_dist = clickpoint.distance(closest_marker.location);\n❽     for (var i=1; i < mapstraction.markers.length; i++) {\n        var thismarker = mapstraction.markers[i];\n        var thisdist = clickpoint.distance(thismarker.location);\n❾       if (thisdist < closest_dist) {\n          closest_dist = thisdist;\n          closest_marker = thismarker;\n        }\n      }\n      if (closest_marker) {\n❿       var poly = new mxn.Polyline([clickpoint, closest_marker.location]);\n        mapstraction.addPolyline(poly);\n      }\n    }\n  }\n```", "```\nvar mapstraction;\nvar wichita = new mxn.LatLonPoint(37.7454463, −97.4080747);\nvar tulsa = new mxn.LatLonPoint(36.0390101, −95.9936344);\n\nfunction create_map() {\n  mapstraction = new mxn.Mapstraction('mymap', 'google');\n  mapstraction.setCenterAndZoom(wichita, 8);\n  mapstraction.addPolyline(new mxn.Polyline([wichita, tulsa]));\n  mapstraction.autoCenterAndZoom();\n  // Find bearing\n\n  // Find point X km along route\n\n}\n```", "```\nfunction get_bearing(pt1, pt2) {\n  var lat1 = degrees_to_radians(pt1.lat);\n  var lat2 = degrees_to_radians(pt2.lat);\n  var lon_diff = degrees_to_radians(pt2.lon − pt1.lon);\n  var y = Math.sin(lon_diff) * Math.cos(lat2);\n  var x = Math.cos(lat1) * Math.sin(lat2)\n          - Math.sin(lat1) * Math.cos(lat2) * Math.cos(lon_diff);\n  var bearing = Math.atan2(y, x);\n  return (radians_to_degrees(bearing)+360) % 360;\n}\nfunction degrees_to_radians(deg) {\n  return deg * Math.PI / 180;\n}\nfunction radians_to_degrees(rad) {\n  return rad * 180 / Math.PI;\n}\n```", "```\nvar bearing = get_bearing(wichita, tulsa);\n```", "```\nfunction get_destination(pt, dist, bearing) {\n  var R = 6371; // radius of earth (km)\n  var lat1 = degrees_to_radians(pt.lat);\n  var lon1 = degrees_to_radians(pt.lon);\n  bearing = degrees_to_radians(bearing);\n  var cosLat1 = Math.cos(lat1);\n  var sinLat1 = Math.sin(lat1);\n  var distOverR = dist / R;\n  var cosDistOverR = Math.cos(distOverR);\n  var sinDistOverR = Math.sin(distOverR);\n\n  var lat2 = Math.asin( sinLat1 * cosDistOverR\n\n             + cosLat1 * sinDistOverR * Math.cos(bearing) );\n  var lon2 = lon1 + Math.atan2( Math.sin(bearing) * sinDistOverR * cosLat1,\n             cosDistOverR Đ sinLat1 * Math.sin(lat2) );\n  lon2 = (lon2 + Math.PI) % (2 * Math.PI) Đ Math.PI;\n  lat2 = radians_to_degrees(lat2);\n  lon2 = radians_to_degrees(lon2);\n\n  return new mxn.LatLonPoint(lat2, lon2);\n}\n```", "```\nvar newpt = get_destination(wichita, 128, bearing);\nvar mk = new mxn.Marker(newpt);\nmapstraction.addMarker(mk);\n```", "```\n<script type=\"text/javascript\"\nsrc=\"http://api.maps.yahoo.com/ajaxymap?v=3.8&appid=*`yourkeyhere`*\"></script>\n```", "```\nvar mapstraction;\n  function create_map() {\n    mapstraction = new mxn.Mapstraction('mymap', 'yahoo');\n    mapstraction.setCenterAndZoom(new mxn.LatLonPoint(37.7740486,-122.4101883), 15);\n    mapstraction.addLargeControls();\n    // Yahoo-specific calls\n❶   var ymap = mapstraction.getMap();\n    YEvent.Capture(ymap, EventsList.onEndLocalSearch, ❷plotResults);\n❸   ymap.searchLocal(ymap.getCenterLatLon(), 'burritos', ❹1, ❺5);\n  }\n```", "```\nfunction plotResults(❶results) {\n    if (results.Data) {\n      var places = results.Data.ITEMS;\n❷     for (i=0; i < places.length; i++) {\n        var thisplace = places[i];\n        var lat = ❸parseFloat(thisplace.LATITUDE);\n        var lon = parseFloat(thisplace.LONGITUDE);\n        var marker = new mxn.Marker(new mxn.LatLonPoint(lat, lon));\n        marker.setInfoBubble(thisplace.TITLE + '<br />' + thisplace.ADDRESS);\n        mapstraction.addMarker(marker);\n      }\n    }\n❹   mapstraction.autoCenterAndZoom();\n  }\n```", "```\nhttp://local.yahooapis.com/LocalSearchService/V3/localSearch?`appid`=\n*`yourkeyhere`*&`query`=burritos&`location`=San+Francisco+CA\n```", "```\n❶ <?xml version=\"1.0\"?>\n❷ <ResultSet ... totalResultsAvailable=\"553\" totalResultsReturned=\"10\">\n❸   <Result id=\"21356805\">\n      <Title>El Farolito</Title>\n      <Address>2777 Mission St</Address>\n      <City>San Francisco</City>\n      <State>CA</State>\n      <Latitude>37.752713</Latitude>\n      <Longitude>-122.41835</Longitude>\n      ...\n    </Result>\n    <Result id=\"21342579\">\n      ...\n    </Result>\n    ...\n  </ResultSet>\n```", "```\n<?\n    $api_key = \"*`yourkeyhere`*\";\n    $search_term = urlencode(\"burritos\");\n    $location = ❶\"urlencode(\"San Francisco, CA\");\n    $url = \"http://local.yahooapis.com/LocalSearchService/V3/localSearch\";\n❷   $url .= \"?appid=$api_key&query=$search_term&location=$location\";\n❸   $xobj = get_xml($url);\n    print $xobj->Result[0]->Title;\n  ?>\n```", "```\nvar box = mapstraction.getBounds();\nvar inview = box.contains(new mxn.LatLonPoint(37.7740486, −122.4101883));\n```", "```\nfunction check_bounds(pt, box) {\n  return (pt.lat >= box.sw.lat && pt.lat <= box.ne.lat\n       && pt.lon >= box.sw.lon && pt.lon <= box.ne.lon);\n```", "```\nvar mapstraction;\n  var box;\n  function create_map() {\n    mapstraction = new mxn.Mapstraction('mymap', 'google');\n    mapstraction.setCenterAndZoom(new mxn.LatLonPoint(37.7740486,-122.4101883), 9);\n    mapstraction.addSmallControls();\n❶   box = new mxn.BoundingBox(37.5, −122.8, 37.9, −122.2);\n❷   var poly = BoundingBox_to_Polyline(box);\n    mapstraction.addPolyline(poly);\n❸   mapstraction.click.addHandler(function(event_type, event_source, event_args) {\n      var reply = \"\";\n      var clickpoint = event_args.location;\n❹     if (box.contains(clickpoint)) {\n        reply = \"You clicked inside the box! \";\n      }\n      else {\n        reply = \"Sorry--You missed the box. \";\n      }\n      // Create marker at click\n      var mk = new mxn.Marker(clickpoint);\n      mk.setInfoBubble(reply);\n      mapstraction.addMarker(mk);\n❺     mk.openBubble();\n    });\n  }\n  function BoundingBox_to_Polyline(box) {\n    var points = [box.sw, new mxn.LatLonPoint(box.ne.lat, box.sw.lon), box.ne,\n                  new mxn.LatLonPoint(box.sw.lat, box.ne.lon),\n                  new mxn.LatLonPoint(box.sw.lat, box.sw.lon-.0001)];\n    var poly = new mxn.Polyline(points);\n    return poly;\n  }\n```", "```\nfunction get_random_by_bounds(❶bounds) {\n    var lat = bounds.sw.lat + (❷Math.random() * ❸(bounds.ne.lat − bounds.sw.lat));\n    var lon = bounds.sw.lon + (Math.random() * (bounds.ne.lon − bounds.sw.lon));\n❸   return new mxn.LatLonPoint(lat, lon);\n  }\n```", "```\nvar b = new mxn.BoundingBox(❶45.5, −122.9, 45.6, −122.8);\n❷ var pt = get_random_by_bounds(b);\n  var mk = new mxn.Marker(pt);\n  mapstraction.addMarker(mk);\n```", "```\nutah = [new mxn.LatLonPoint(36.99, −114.05), new mxn.LatLonPoint(36.99, −109.04),\n        new mxn.LatLonPoint(40.99, −109.05), new mxn.LatLonPoint(40.99, −111.05),\n        new mxn.LatLonPoint(41.99, −111.05), new mxn.LatLonPoint(41.99, −114.04),\n        new mxn.LatLonPoint(36.99, −114.05)];\n```", "```\nfunction points_to_bounds(pts) {\n    if (pts.length > 0) { var minlat = pts[0].lat\n      var maxlat = minlat;\n      var minlon = pts[0].lon\n      var maxlon = minlon;\n❶     for (var i = 1; i < pts.length; i++) {\n        var pt = pts[i];\n❷       if (pt.lat > maxlat) {\n❸         maxlat = pt.lat;\n         }\n        if (pt.lon > maxlon) {\n          maxlon = pt.lon;\n        }\n  if (pt.lat < minlat) {\n          minlat = pt.lat;\n        }\n        if (pt.lon < minlon) {\n          minlon = pt.lon;\n        }\n      }\n❹     return new mxn.BoundingBox(minlat, minlon, maxlat, maxlon);\n    }\n    return null;\n  }\n```", "```\nvar lat_change = (❶(box.ne.lat - box.sw.lat) / 100);\nvar pt2 = new mxn.LatLonPoint(box.sw.lat - lat_change, mypt.lon);\n```", "```\nfunction check_intersection(A, B, C, D) {\n❶   var latdiff1 = B.lat − A.lat;\n    var latdiff2 = D.lat − C.lat;\n    var londiff1 = B.lon − A.lon;\n    var londiff2 = D.lon − C.lon;\n\n    // Make sure lines aren't parallel\n❷   if (londiff2 * latdiff1 - latdiff2 * londiff1 != 0) {\n      var segtest1 = (londiff1 * (C.lat - A.lat) + latdiff1 * (A.lon − C.lon))\n                     / ❸(londiff2 * latdiff1 - latdiff2 * londiff1);\n      var segtest2 = (londiff2 * (A.lat - C.lat) + latdiff2 * (C.lon − A.lon))\n                     / (latdiff2 * londiff1 - londiff2 * latdiff1);\n❹     if (segtest1 >= 0 && segtest1 <= 1 && segtest2 >= 0 && segtest2 <= 1) {\n        return true;\n      }\n    }\n    return false;\n  }\n```", "```\nfunction check_polygon(mypt, polypts) {\n❶   var box = points_to_bounds(polypts);\n❷   if (box.contains(mypt)) {\n      var lat_change = ((box.ne.lat - box.sw.lat) / 100);\n❸     var pt2 = new mxn.LatLonPoint(box.sw.lat - lat_change, mypt.lon);\n      var intersections = 0;\n❹     for (var i = 1; i < polypts.length; i++) {\n        var seg1 = polypts[i-1];\n        var seg2 = polypts[i];\n❺       if (check_intersection(seg1, seg2, mypt, pt2)) {\n          intersections++;\n        }\n      }\n❻     if (intersections % 2 == 1) {\n        return true;\n      }\n    }\n    return false;\n  }\n```", "```\nfunction create_map() {\n    mapstraction = new mxn.Mapstraction('mymap', 'google');\n    mapstraction.setCenterAndZoom(new mxn.LatLonPoint(39.5, −111.7), 6);\n    mapstraction.addSmallControls();\n❶   mapstraction.click.addHandler(function(event_type, event_source, event_args) {\n      var clickpoint = event_args.location;\n      var intersects = check_polygon(clickpoint, utah);\n❷     if (intersects) {\n        msg = \"You clicked in Utah!\";\n      }\n      else {\n        msg = \"That's not Utah!\";\n      }\n❸     var m = new mxn.Marker(clickpoint);\n      m.setInfoBubble(msg);\n      mapstraction.addMarker(m);\n      m.openBubble();\n    });\n  }\n```", "```\nSET @earthRadius = 6371;\nSET @lat = 45.517;\nSET @lon = −122.649;\nSET @radLat = RADIANS(@lat);\nSET @radLon = RADIANS(@lon);\nSET @cosLat = COS(@radLat);\nSET @sinLat = SIN(@radLat);\nSELECT *,\n  `( @earthRadius❶ * ACOS( @cosLat * cosRadLat *`\n  `COS( radLon - @radLon ) + @sinLat *`\n  `sinRadLat ) ) AS dist`\nFROM places\nORDER BY dist;\n```"]