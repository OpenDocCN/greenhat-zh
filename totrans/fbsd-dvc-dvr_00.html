<html><head></head><body><div class="preface" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="introduction"/>Introduction</h1></div></div></div><div class="informalfigure"><a id="image_no_caption"/><div class="mediaobject"><a id="I_mediaobject_d1e163"/><img alt="image with no caption" src="httpatomoreillycomsourcenostarchimages1137497.png.jpg"/></div></div><p>Welcome to <span class="emphasis"><em>FreeBSD Device Drivers</em></span>! The goal of this book is to help you improve your understanding of device drivers under FreeBSD. By the time you finish this book, you should be able to build, configure, and manage your own FreeBSD device drivers.</p><p>This book covers FreeBSD version 8, the version recommended for production use as of this writing. Nonetheless, most of what you’ll learn will apply to earlier versions and should apply to later ones as well.</p><div class="sect1" title="Who Is This Book For?"><div class="titlepage"><div><div><h1 class="title"><a id="who_is_this_book_for_question"/>Who Is This Book For?</h1></div></div></div><p>I wrote this book as a programmer, for programmers. As such, you’ll find a heavy focus on programming, not theory, and you’ll examine real device drivers (namely, ones that control hardware). Imagine trying to write a book without ever having read one. Inconceivable! The same thing goes for device drivers.</p></div></div>
<div class="sect1" title="Prerequisites"><div class="titlepage"><div><div><h1 class="title"><a id="prerequisites"/>Prerequisites</h1></div></div></div><p>To get the most out of this book, you should be familiar with the C programming language. You should also know something about operating system design; for example, the difference between a process and a thread.</p><p>If you lack the necessary background, I recommend reading the following three books prior to this one, or just keeping them around as references:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>The <span class="emphasis"><em>C Programming Language</em></span>, by Brian W. Kernighan and Dennis M. Ritchie (Prentice Hall PTR, 1988)</p></li><li class="listitem"><p><span class="emphasis"><em>Expert C Programming</em></span>, by Peter van der Linden (Prentice Hall, 1994)</p></li><li class="listitem"><p><span class="emphasis"><em>The Design and Implementation of the FreeBSD Operating System</em></span>, by Marshall Kirk McKusick and George V. Neville-Neil (Addison-Wesley Professional, 2005)</p></li></ul></div></div>
<div class="sect1" title="Contents at a Glance"><div class="titlepage"><div><div><h1 class="title"><a id="contents_at_a_glance"/>Contents at a Glance</h1></div></div></div><p><span class="emphasis"><em>FreeBSD Device Drivers</em></span> contains the following chapters.</p><div class="variablelist"><dl><dt><span class="term"><a class="xref" href="ch01.html" title="Chapter 1. Building and Running Modules">Chapter 1</a></span></dt><dd><p>Provides an overview and introduction to basic device driver programming concepts and terminology.</p></dd><dt><span class="term"><a class="xref" href="ch02.html" title="Chapter 2. Allocating Memory">Chapter 2</a></span></dt><dd><p>Describes FreeBSD’s kernel memory management routines.</p></dd><dt><span class="term"><a class="xref" href="ch03.html" title="Chapter 3. Device Communication and Control">Chapter 3</a></span></dt><dd><p>Teaches you how to communicate with and control your device drivers from user space.</p></dd><dt><span class="term"><a class="xref" href="ch04.html" title="Chapter 4. Thread Synchronization">Chapter 4</a></span></dt><dd><p>Discusses the problems and solutions associated with multithreaded programming and concurrent execution.</p></dd><dt><span class="term"><a class="xref" href="ch05.html" title="Chapter 5. Delaying Execution">Chapter 5</a></span></dt><dd><p>Describes delaying code execution and asynchronous code execution, and explains why these tasks are needed.</p></dd><dt><span class="term"><a class="xref" href="ch06.html" title="Chapter 6. Case Study: Virtual Null Modem">Chapter 6</a></span></dt><dd><p>Contains the first of several occasions where I walk you through a real-world device driver.</p></dd><dt><span class="term"><a class="xref" href="ch07.html" title="Chapter 7. Newbus and Resource Allocation">Chapter 7</a></span></dt><dd><p>Covers the infrastructure used by FreeBSD to manage the hardware devices on the system. From here on, I deal exclusively with real hardware.</p></dd><dt><span class="term"><a class="xref" href="ch08.html" title="Chapter 8. Interrupt Handling">Chapter 8</a></span></dt><dd><p>Discusses interrupt handling in FreeBSD.</p></dd><dt><span class="term"><a class="xref" href="ch09.html" title="Chapter 9. Case Study: Parallel Port Printer Driver">Chapter 9</a></span></dt><dd><p>Walks through <code class="literal">lpt(4)</code>, the parallel port printer driver, in its entirety.</p></dd><dt><span class="term"><a class="xref" href="ch10.html" title="Chapter 10. Managing and Using Resources">Chapter 10</a></span></dt><dd><p>Covers port-mapped I/O and memory-mapped I/O.</p></dd><dt><span class="term"><a class="xref" href="ch11.html" title="Chapter 11. Case Study: Intelligent Platform Management Interface Driver">Chapter 11</a></span></dt><dd><p>Reviews the parts of <code class="literal">ipmi(4)</code>, the Intelligent Platform Management Interface driver, which uses port-mapped I/O and memory-mapped I/O.</p></dd><dt><span class="term"><a class="xref" href="ch12.html" title="Chapter 12. Direct Memory Access">Chapter 12</a></span></dt><dd><p>Explains how to use Direct Memory Access (DMA) in FreeBSD.</p></dd><dt><span class="term"><a class="xref" href="ch13.html" title="Chapter 13. Storage Drivers">Chapter 13</a></span></dt><dd><p>Teaches you how to manage storage devices, such as disk drives, flash memory, and so on.</p></dd><dt><span class="term"><a class="xref" href="ch14.html" title="Chapter 14. Common Access Method">Chapter 14</a></span></dt><dd><p>Provides an overview and introduction to Common Access Method (CAM), which you’ll use to manage host bus adapters.</p></dd><dt><span class="term"><a class="xref" href="ch15.html" title="Chapter 15. USB Drivers">Chapter 15</a></span></dt><dd><p>Teaches you how to manage USB devices. It also walks through <code class="literal">ulpt(4)</code>, the USB printer driver, in its entirety.</p></dd><dt><span class="term"><a class="xref" href="ch16.html" title="Chapter 16. Network Drivers, Part 1: Data Structures">Chapter 16</a></span></dt><dd><p>Describes the data structures used by network drivers. It also goes over Message Signaled Interrupts (MSI).</p></dd><dt><span class="term"><a class="xref" href="ch17.html" title="Chapter 17. Network Drivers, Part 2: Packet Reception and Transmission">Chapter 17</a></span></dt><dd><p>Examines the packet reception and transmission components of <code class="literal">em(4)</code>, the Intel PCI Gigabit Ethernet adapter driver.</p></dd></dl></div></div>
<div class="sect1" title="Welcome Aboard!"><div class="titlepage"><div><div><h1 class="title"><a id="welcome_aboard_exclamation"/>Welcome Aboard!</h1></div></div></div><p>I hope you find this book useful and entertaining. As always, I welcome feedback with comments or bug fixes to <span class="email"><a class="email" href="mailto:joe@thestackframe.org">joe@thestackframe.org</a></span>.</p><p>Okay, enough with the introductory stuff. Let’s begin.</p></div></body></html>