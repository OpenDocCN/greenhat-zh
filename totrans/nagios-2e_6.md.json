["```\n# /etc/nagios/nagios.cfg\n...\nenable_flap_detection=1\nlow_service_flap_threshold=5.0\nhigh_service_flap_threshold=20.0\n...\n```", "```\ndefine service{\n    host_name              linux01\n    service_description    NTP\n    ...\n    flap_detection_enabled 1\n    low_flap_threshold     5.0\n    high_flap_threshold    20.0\n    ...\n}\n```", "```\nflap_detection_options u,w,c,u\n```", "```\nmax_check_attempts    3\nnormal_check_interval                 5\nretry_check_interval                  1\n```", "```\n# /etc/nagios/nagios.cfg\nenable_flap_detection=1\nlow_host_flap_threshold=5.0\nhigh_host_flap_threshold=20.0\n```", "```\ndefine host{\n    host_name              linux01\n    ...\n    flap_detection_enabled 1\n    low_flap_threshold     5.0\n    high_flap_threshold    20.0\n}\n```", "```\nnormal_check_interval 5\nretry_check_interval  2\nmax_check_attempts    4\n```", "```\ndefine service{\n    host_name             printserver\n    service_description   LPD\n    ...\n  **event_handler**  **restart-lpd**\n    ...\n}\n```", "```\ndefine command{\n    command_name **restart-lpd**\n    command_line $USER1$/eventhandler/restart-lpd.sh $SERVICESTATE$ $SER\nVICESTATETYPE$ $SERVICEATTEMPT$\n}\n```", "```\n#!/bin/bash\n# /usr/local/nagios/libexec/eventhandlers/restart-lpd.sh\n# $1 = Status, $2 = status type, $3 = attempt\n\ncase $1 in\n   OK)\n      ;;\n   WARNING)\n      ;;\n   CRITICAL)\n      if [ $2 == \"HARD\" ] || [[ $2 == \"SOFT\" && $3 -eq 3 ]]; then\n         echo \"Restarting lpd service\"\n         /usr/bin/sudo /etc/init.d/lpd restart\n      fi\n      ;;\n   UNKNOWN)\n      ;;\nesac\nexit 0\n```", "```\nlinux:~ # **visudo**\n```", "```\nnagios nagsrv=(root) NOPASSWD: /etc/init.d/lpd\n```", "```\ndefine command{\n   command_name check_http\n   command_line $USER1$/check_http -H $HOSTADDRESS$ $ARG1$\n}\n```", "```\ndefine host{\n   host_name linux01\n   address 192.0.2.1\n   ...\n}\n\ndefine service{\n  host_name            linux01\n\n  service_description  HTTP\n  check_command        check_http!-u test.html\n  ...\n}\n```", "```\n#!/bin/bash\n# badscript\n\nHOST=$NAGIOS_HOSTADDRESS\n...\n```", "```\ndefine command{\ncommand_line $USER1$/badscript\n...\n}\n```", "```\ndefine command{\n   command_line $USER1$/goodscript $HOSTADDRESS$\n...\n}\n```", "```\n#!/bin/bash\n# goodscript\n\nHOST=$1\n...\n```", "```\n$HOSTADDRESS:linux01$\n$HOSTSTATE:switch05$\n```", "```\n$SERVICESTATE:switch05:PING$\n$SERVICESTATE::NRPE$\n```", "```\n$CONTACTNAME:gregor$\n$CONTACTEMAIL:smith$\n```", "```\ndefine host {\n   host_name         linux01\n   ...\n   _NSCLIENT_PORT 12489\n   _ASSETID       734287\n}\ndefine service {\n   host_name           linux01\n   service_description HTTP\n   ...\n   _HTTP_PORT          8080\n}\ndefine contact {\n   contact_name wob\n   ...\n   _DEPARTMENT  41ZBV\n}\n```", "```\n$_HOSTNSCLIENT_PORT$\n$_HOSTASSETID$\n$_SERVICEHTTP_PORT$\n$_CONTACTDEPARTMENT$\n```", "```\ndefine host {\n   host_name       linux01\n   ...\n   __NSCLIENT_PORT 12489\n   __ASSETID       734287\n}\n```", "```\n$_HOST_NSCLIENT_PORT$\n$_HOST_ASSETID$\n```", "```\nillegal_object_name_chars='~$^&'<>\n```", "```\nHTTP/1.1 401 Authorization Required\n...\nWWW-Authenticate: Negotiate\nWWW-Authenticate: NTLM\nWWW-Authenticate: Basic realm=\"Nagios Monitoring\"\n...\n```", "```\n**GET /nagios/index.html HTTP/1.1**\n...\n**Authorization: Negotiate YIIIlwYGKwYBBQUCoIIIizCCCIegJDA..**.\n```", "```\nHTTP/1.1 200 OK\n...\nWWW-Authenticate: Negotiate oYGeMIGbo...\n```", "```\nHTTP/*fqdn*@EXAMPLE.NET\n```", "```\nC:\\> **cd \\Programs\\Support Tools**\nC:\\Programs\\Support Tools> **ktpass -princ HTTP/nagios.example.net@EXAMP**\n**LE.NET -mapuser webnagios@example.net -pass ***** -out c:\\temp\\webnagios**\n**http.keytab**\n\nTargeting domain controller: dc01.example.net\nSuccessfully mapped HTTP/nagios.example.net\nto webnagios. Key created. Output keytab to\nc:\\temp\\webnagioshttp.keytab: Keytab version:\n0x502 keysize 81 HTTP/nagios.example.net@EXAMPLE.NET\nptype 1 (KRB5_NT_PRINCIPAL) vno 3 etype 0x3 (DES-CBC-MD5)\nkeylength 8 (0x7fc42302a7342952) Account webnagios has\nbeen set for DES-only encryption.\n```", "```\n# /etc/krb5.conf\n[libdefaults]\n   default_realm = EXAMPLE.NET\n\n[realms]\n   EXAMPLE.NET = {\n        kdc = dc01.example.net:88\n        kdc = dc02.example.net:88\n        admin_server = dc01.example.net\n}\n```", "```\nlinux:~ # **kinit administrator@EXAMPLE.NET**\nPassword for administrator@EXAMPLE.NET: ******\n```", "```\nlinux:~ # **klist**\nTicket cache: FILE:/tmp/krb5cc_0\nDefault principal: administrator@EXAMPLE.NET\n\nValid starting      Expires     Service principal\n08/26/07 14:31:47   08/27/07 00:31:49 krbtgt/EXAMPLE.NET@EXAMPLE.NET\n      renew until 08/27/07 14:31:47\n\nKerberos 4 ticket cache: /tmp/tkt0\nklist: You have no tickets cached\n```", "```\nLoadModule auth_kerb_module /usr/lib/apache2/modules/mod_auth_kerb.so\n```", "```\nlinux:~ # **a2enmod auth_kerb**\nModule auth_kerb installed; run /etc/init.d/apache2 force-reload to enable.\n```", "```\n<Directory \"/usr/local/nagios\">\n   AllowOverride None\n   Order allow,deny\n   Allow from all\n\n   # -- Authentification\n   AuthType Kerberos\n   AuthName \"Nagios Monitoring\"\n   KrbAuthRealms EXAMPLE.NET\n   Krb5Keytab /etc/apache2/keytabs/webnagioshttp.keytab\n   KrbMethodK5Passwd on\n   KrbMethodNegotiate on\n   KrbSaveCredentials off\n\n   require valid-user\n</Directory>\n```", "```\ndefine contact{\n        use            template-contact-webuser\n        contact_name   wob@EXAMPLE.NET\n        alias          wob@EXAMPLE\n        contactgroups  admins\n        email          w.barth@example.net\n}\n```", "```\nlinux:~ # **cd /usr/local/src/mod_auth_ntlm_winbind**\nlinux:src/mod_auth_ntlm_winbind # **autoconf**\n...\nlinux:src/mod_auth_ntlm_winbind # **./configure**\n...\nlinux:src/mod_auth_ntlm_winbind # **apxs2 -DAPACHE2 -c -i mod_auth_ntlm_ \\**\n**winbind.c**\n...\n```", "```\nLoadModule auth_ntlm_winbind_module /usr/lib/apache2/modules/mod_auth_nt\nlm_winbind.so\n```", "```\nlinux: # **/etc/init.d/apache2 stop; /etc/init.d/apache2 start**\n```", "```\n# /etc/samba/smb.conf (Minimalkonfiguration)\n[global]\nworkgroup             =EXAMPLE\nrealm                 =EXAMPLE.NET\nsecurity              =ads\npassword server       =dc01.example.net dc02.example.net\nencrypt passwords     =yes\nidmap uid             =10000-20000\nidmap gid             = 10000-20000\nwinbind enum users    =yes\nwinbind enum groups   =yes\nwinbind separator     = /\n# winbind use default domain = yes\nhosts allow           =127.0.0.1\n```", "```\nlinux:~ # **net ads join -U administrator@EXAMPLE.NET**\nadministrator's password: ******\nUsing short domain name - EXAMPLE\nJoined 'NAGIOS' to realm 'EXAMPLE.NET'\n```", "```\nlinux:~ **# /etc/init.d/samba restart**\nlinux:~ **# /etc/init.d/winbind restart**\n```", "```\nlinux:~ **# wbinfo -t**\nchecking the trust secret via RPC calls succeeded\n```", "```\nuser@linux:~$ **chgrp www-data /var/lib/samba/winbindd_privileged**\nuser@linux:~$ **chmod 750 /var/lib/samba/winbindd_privileged**\nuser@linux:~$ **ls -ld /var/lib/samba/winbindd_privileged**\ndrwxr-x— 2 root www-data 4096 Aug 26 17:51 /var/lib/samba/winbindd_pri\nvileged/\n```", "```\n<Directory \"/usr/local/nagios\">\n  AllowOverride None\n  Order allow,deny\n  Allow from all\n\n  AuthName \"Nagios Monitoring\"\n  # -- NTLM\n  AuthType NTLM\n  NTLMAuth on\n  NTLMAuthHelper \"/usr/bin/ntlm_auth --helper-protocol=squid-2.5-ntlmssp\"\n\n  # -- Basic\n  NTLMBasicAuth on\n  NTLMBasicAuthoritative on\n  PlaintextAuthHelper \"/usr/bin/ntlm_auth --helper-protocol=squid-2.5-bas\nic\"\n  NTLMBasicRealm \"Nagios Monitoring (Basic)\"\n\n  # -- Negotiate\n  # AuthType Negotiate\n  # NegotiateAuth on\n  # NegotiateAuthHelper \"/usr/bin/ntlm_auth --helper-protocol=gss-spnego\"\n\n   require valid-user\n</Directory>\n```", "```\ndefine contact{\n       use           template-contact-webuser\n       contact_name  EXAMPLE/wob\n       ...\n}\n```", "```\nuser@linux:~$ **kinit myuser@EXAMPLE.NET**\nPassword for myuser@EXAMPLE.NET: ******\n```", "```\nuser@linux:~$ /usr/local/nagios/bin/nagiostats -c /etc/nagios/nagios.cfg\nNagios Stats 3.0b3\nCopyright (c) 2003-2007 Ethan Galstad (www.nagios.org)\nLast Modified: 08-30-2007\nLicense: GPL\n\nCURRENT STATUS DATA\n-----------------------------------------------------\nStatus File:                              /var/nagios/status.dat\nStatus File Age:                          0d 0h 0m 5s\nStatus File Version:                      3.0b3\n\nProgram Running Time:                     1d 23h 26m 57s\nNagios PID:                               8184\n**Used/High/Total Command Buffers:          0 / 1 / 4096**\n\nTotal Services:                           1997\nServices Checked:                         1997\nServices Scheduled:                       1995\nServices Actively Checked:                1995\nServices Passively Checked:               2\nTotal Service State Change:               0.000 / 30.260 / 0.040 %\n**Active Service Latency:                   0.000 / 2.233 / 0.361 sec**\nActive Service Execution Time:            0.063 / 20.081 / 0.518 sec\nActive Service State Change:              0.000 / 7.630 / 0.011 %\nActive Services Last 1/5/15/60 min:       308 / 1417 / 1922 / 1944\nPassive Service State Change:             26.250 / 30.260 / 28.255 %\nPassive Services Last 1/5/15/60 min:      0 / 0 / 0 / 0\nServices Ok/Warn/Unk/Crit:                1904 / 61 / 5 / 27\nServices Flapping:                        2\nServices In Downtime:                     0\n\nTotal Hosts:                              166\nHosts Checked:                            166\nHosts Scheduled:                          166\nHosts Actively Checked:                   166\nHost Passively Checked:                   0\nTotal Host State Change:                  0.000 / 0.000 / 0.000 %\n**Active Host Latency:                      0.000 / 1.527 / 0.638 sec**\n**Active Host Execution Time:               0.066 / 0.537 / 0.155 sec**\nActive Host State Change:                 0.000 / 0.000 / 0.000 %\nActive Hosts Last 1/5/15/60 min:          52 / 148 / 166 / 166\nPassive Host State Change:                0.000 / 0.000 / 0.000 %\nPassive Hosts Last 1/5/15/60 min:         0 / 0 / 0 / 0\nHosts Up/Down/Unreach:                    166 / 0 / 0\nHosts Flapping:                           0\nHosts In Downtime:                        0\n\nActive Host Checks Last 1/5/15 min:       59 / 209 / 622\n   Scheduled:                             54 / 154 / 475\n   On-demand:                             5 / 43 / 108\n   Parallel:                              59 / 198 / 584\n **Serial:                                0 / 0 / 0**\n   Cached:                                0 / 12 / 39\nPassive Host Checks Last 1/5/15 min:      0 / 0 / 0\n**Active Service Checks Last 1/5/15 min:    345 / 2148 / 6342**\n      Scheduled:                          345 / 2148 / 6342\n      On-demand:                          0 / 0 / 0\n      Cached:                             0 / 0 / 0\nPassive Service Checks Last 1/5/15 min:   0 / 0 / 0\n\nExternal Commands Last 1/5/15 min:        0 / 0 / 0\n```", "```\nuser@linux:~$ **/usr/local/nagios/bin/nagiostats -h**\n ...\n NUMACTSVCCHECKSxM  number of total active service checks\n                    occuring in last 1/5/15 minute\n ...\n xxxACTSVCLAT       MIN/MAX/AVG active service check latency (ms).\n ...\n```", "```\nuser@linux:~$ **/usr/local/nagios/bin/nagiostats -c /etc/nagios/nagios.cfg\\**\n  **--mrtg --data=NUMACTSVCCHECKS5M**\n2195\n```", "```\nuser@linux:~$ **/usr/local/nagios/bin/nagiostats -c /etc/nagios/nagios.cfg\\**\n  **--mrtg --data=MINACTSVCLAT,MAXACTSVCLAT,AVGCTSVCLAT**\n0\n934\n203\n```", "```\n# Global configuration\nWorkDir: /var/www/mrtg\nWriteExpires: Yes\n```", "```\nlinux:~ # **indexmaker /etc/mrtg.cfg > /var/www/mrtg/index.html**\n```", "```\n#!/bin/bash\n# Attention: thresholds in milliseconds\n\nWARN=20000\nCRIT=60000\nTIMESTAMP='date +%s'\nCMDFILE='/var/nagios/rw/nagios.cmd'\n\nLATENCY='/usr/local/nagios/bin/nagiostats \\\n           --config=/etc/nagios/nagios.cfg \\\n           --mrtg --data=AVGACTSVCLAT'\n\nif [$LATENCY < $WARN ]; then\n   STATUS=0; INFO=\"OK\"\nelif [$LATENCY < $CRIT ]; then\n   STATUS=1; INFO=\"WARNING\"\nelse\n   STATUS=2; INFO=\"CRITICAL\"\nfi\n\nCMD=\"PROCESS_SERVICE_CHECK_RESULT\"\nOUTCMD=\"[%lu] $CMD;*nagios-server*;Service Latency;$STATUS;\"\nOUTINFO=\"$INFO Service Latency = ${LATENCY}ms \"\nOUTPERF=\"svclat=$LATENCY;$WARN;$CRIT;\\n\"\n\nprintf \"${OUTCMD}${OUTINFO}|${OUTPERF}\" $TIMESTAMP > $CMDFILE\n```", "```\nNEW VALUE: /etc/nagios/nagios.cfg\n```", "```\n*/3 * * * * nagios /usr/local/nagios/libexec/passive/check_svc_latency.sh\n> /dev/null\n```", "```\n# -- service latency check\ndefine service{\n    host_name                   *nagios-server*\n    service_description         Service-Latenz\n    active_checks_enabled       0\n    passive_checks_enabled      1\n    check_freshness             0\n    check_command               check_dummy!3!active check, should not happen!\n    max_check_attempts          3\n    flap_detection_enabled      0\n\n    use                         template-service\n}\n```", "```\nOUTPERF=**\"check_svc_latency::check_svc_latency::svclat**=$LATENCY;$WARN; $CRIT;\"\n```", "```\n#!/usr/bin/perl\nuse strict;\nuse warnings;\n...\n```", "```\n#!/usr/bin/perl -w\n...\n```", "```\nmy $data = <<DATA;\na 1  30\nb 2  40\nc 7  80\n...\nDATA\n```", "```\nuse vars qw($value);\n```", "```\n$result = &mysub( \\$value );\n```", "```\n# /etc/nagios.cfg\n...\nenable_embedded_perl=1\nuse_embedded_perl_implicitly=1\n...\n```", "```\n#!/usr/bin/perl -w\n# nagios: -epn\n...\n```", "```\ndefine command{\n   command_name    check_disk\n   command_line  **/usr/bin/perl** $USER1$/check_disk.pl $ARG1$\n}\n```", "```\nlinux:nagios/contrib **# make mini_epn**\n...\nlinux:nagios/contrib **# make new_mini_epn**\n...\n```", "```\nlinux:nagios/contrib **# cp mini_epn new_mini_epn /usr/local/nagios/bin/**.\n```", "```\nuser@linux:nagios$ **~cd /usr/local/nagios/bin**\nuser@linux:nagios$ nagios/bin**./new_mini_epn**\nplugin command line:\n```", "```\nplugin command line: **/usr/local/nagios/libexec/check_file_age -f /etc/hosts**\nembedded perl plugin return code and output was: 2 & FILE_AGE CRITICAL:\n/etc/hosts is 3718127 seconds old and 2671 bytes\n```", "```\ndefine host {\n\n   ...\n   display_name              *display_name*\n   contacts                  *contacts*\n   first_notification_delay  *number*\n   flap_detection_options    o,d,u\n   notification_options      d,u,r,f,s\n   initial_state             o,d,u\n   retry_interval            *number*\n\n   ...\n}\n```", "```\ndefine host {\n   ...\n   # -- extended host information\n   notes             *free text*\n   notes_url         *url*\n   action_url        *url*\n   icon_image        *image file*\n   icon_image_alt    *free text*\n   vrml_image        *image file*\n   statusmap_image   *image file*\n   2d_coords         *x,y*\n   3d_coords         *x,y,z*\n}\n```", "```\ndefine service {\n   ...\n   display_name              *display_name*\n   contacts                  *contacts*\n   first_notification_delay  *number*\n   flap_detection_options    o,c,w,u\n   notification_options      w,u,c,r,f,s\n   initial_state             o,d,u\n   check_interval            *number*\n   retry_interval            *number*\n   ...\n   # -- extended service information\n   Notes             *free text*\n   notes_url         *url*\n   action_url        *url*\n   icon_image        *image file*\n   icon_image_alt    *free text*\n   vrml_image        *image file*\n   statusmap_image   *image file*\n   2d_coords         *x,y*\n   3d_coords         *x,y,z*\n}\n```", "```\ndefine hostgroup {\n   hostgroup_members *host groups*\n   ...\n   notes             *free text*\n   notes_url         *url*\n   action_url        *url*\n}\ndefine servicegroup {\n   servicegroup_members *service groups*\n   ...\n   notes          *free text*\n   notes_url      *url*\n   action_url     *url*\n}\ndefine contactgroup {\n   contactgroup_members *contact groups*\n   ...\n}\n```", "```\ndefine contact {\n   host_notifications_enabled     *value*\n   service_notifications_enabled  *value*\n   can_submit_commands            *value*\n   ...\n}\n```", "```\ndefine timeperiod {\n   timeperiod_name  veryspecial\n   2007-12-23      00:00-24:00\n   april 1         00:00-24:00\n   day 1           00:00-24:00\n   monday 2 may    00:00-24:00\n   monday 3        00:00-24:00\n   monday          00:00-24:00\n   2007-12-01 - 2009-04-01 / 3 00:00-24:00\n   ...\n   exclude *timeperiod_name1, timeperiod_name2*,...\n}\n```", "```\ndefine hostdependency {\n   dependency_period  *timeperiod_name*\n   ...\n}\n\ndefine servicedependency {\n   dependency_period  *timeperiod_name*\n   ...\n}\n```", "```\ndefine servicedependency {\n   host_name                                linux\n   service_description                    Disk_Usage\n   dependent_service_description NRPE\n   ...\n}\n```", "```\ndefine hostescalation {\n   contacts   *contact*\n   ...\n}\ndefine serviceescalation {\n   contacts *contact*\n   ...\n}\n```", "```\ndefine host {\n   name **host_generic_t**\n   register 0\n   #\n   check_period         24×7\n   max_check_attempts   3\n   check_interval       10\n   retry_interval       2\n   ...\n   hostgroups           ALL_HOSTS\n}\ndefine host {\n   name **host_site_t**\n   register 0\n   #\n   check_interval   5\n   retry_interval   1\n   ...\n   parents          switch01\n   hostgroups       HAMBURG\n}\ndefine host {\n   host_name   linux01\n   use         **host_site_t,host_generic_t**\n   ...\n   parents **null**\n   hostgroups **+LINUX**\n}\n```", "```\ndefine host {\n   host_name             linux01\n   check_period          24×7\n   max_check_attempts    3\n   check_interval        5\n   retry_interval        1\n   ...\n   hostgroups            **HAMBURG,LINUX**\n}\n```", "```\ndefine host {\n   host_name linux01\n   use       host_site_t,host_generic_t\n   ...\n **_NRPE_PORT** 5666\n}\n```", "```\ndefine command {\n   command_name check_nrpe\n   command_line $USER1$/check_nrpe -H $HOSTADDRESS$ -p $_HOSTNRPE_PORT$\n-c $ARG1$\n}\n```", "```\nenable_environment_macros=0\n```", "```\nPROCESS_FILE; *path/to/file; number*\n```", "```\nSEND_CUSTOM_SVC_NOTIFICATION;*host; service; options; author; comment*\nSEND_CUSTOM_HOST_NOTIFICATION;*host; options; author; comment*\n```", "```\nnagios@linux:~$ **/usr/local/nagios/bin/nagios -s /etc/nagios/nagios.cfg**\nOBJECT CONFIG PROCESSING TIMES\n(* = Potential for precache savings with -u option)\n----------------------------------\nRead:                 0.019277 sec\nResolve:              0.001001 sec *\nRecomb Contactgroups: 0.000737 sec *\nRecomb Hostgroups:    0.003890 sec *\nDup Services:         0.005938 sec *\nRecomb Servicegroups: 0.048659 sec *\nDuplicate:            0.001527 sec *\nInherit:              0.005602 sec *\nRecomb Contacts:      0.000001 sec *\nSort:                 0.030277 sec *\nRegister:             0.010132 sec\nFree:                 0.001831 sec\n                      ============\nTOTAL:                0.128874 sec * = 0.097634 sec (75.76%)\n                                       estimated savings\n\nCONFIG VERIFICATION TIMES\n(* = Potential for speedup with -x option)\n----------------------------------\nObject Relationships: 0.013131 sec\nCircular Paths:       0.002341 sec *\nMisc:                 0.001032 sec\n                      ============\nTOTAL:                0.016504 sec * = 0.002341 sec (14.2%)\n                                       estimated savings\n```", "```\nnagios@linux:~$ **/usr/local/nagios/bin/nagios -vp /etc/nagios/nagios.cfg**\nnagios@linux:~$ **/etc/init.d/nagios stop**\nnagios@linux:~$ **/usr/local/nagios/bin/nagios -udx /etc/nagios/nagios.cfg**\n```", "```\nlinux:src/nagios-3.0 # **./base/nagios -v /etc/nagios/nagios.cfg**\n...\n```", "```\ninfo {\n   created=1144429286\n   version=2.0\n}\n```", "```\nlinux:~ **# /etc/init.d/nagios stop**\nlinux:~ **# cd /var/nagios**\nlinux:var/nagios # cat **comments.dat downtime.dat >> retention.dat**\n```", "```\nlinux:src/nagios-3.0 # **make install**\n...\nlinux:src/nagios-3.0 # **make install-init**\n...\nlinux:src/nagios-3.0 # **make install-commandmode**\n...\n```"]