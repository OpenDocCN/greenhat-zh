<html><head></head><body>
  <h1><span class="chapter">Chapter 11</span><br/>
  Developing Software for the Xbox</h1>

  <p>While the focus of this book is educating readers in the ways of hardware <span style="font-size: 1em;">hacking and security, one ultimate goal of Xbox hacking is to run home</span><span style="font-size: 1em;">brew software. This chapter is devoted to describing some of the home</span><span style="font-size: 1em;">brew software projects in progress for the Xbox at the time of this writing.</span></p>

  <h2 id="sigil_toc_id_82"><b class="calibre3">Xbox-Linux</b></h2>

  <p>The goal of the Xbox-Linux project is to create a user-friendly and legal port of GNU/Linux and of GNU/Linux applications to the Xbox hardware <span style="font-size: 1em;">platform. Thanks to the dedication and contributions of hackers around the</span> <span style="font-size: 1em;">globe, the Xbox-Linux project has had a great deal of success toward</span> <span style="font-size: 1em;">meeting its goals. A picture of the core Xbox-Linux project team can be seen in Figure 11-1, and the sidebars in this chapter and in Chapter 9 contain</span> <span style="font-size: 1em;">interviews with Xbox-Linux project team members. (The homepage for the</span> <span style="font-size: 1em;">Xbox-Linux project is http://xbox-linux.sourceforge.net.)</span> <span style="font-size: 1em;">Significantly, the Xbox-Linux project and its principle hackers are not anti-Microsoft. They are pro-“freedom to tinker,” and not puerile Microsoft-</span><span style="font-size: 1em;">haters; they have an agenda that touches upon preserving the very freedoms</span> <span style="font-size: 1em;">of thought and speech that brought technology to where it is today.</span></p>

  <p><span style="font-size: 1em;">Xbox-Linux is not the ultimate software project for the Xbox; on the</span> <span style="font-size: 1em;">contrary, it is just the beginning of Xbox software hacking. Porting the</span> <span style="font-size: 1em;">familiar GNU/Linux development environment to the Xbox enables a</span> <span style="font-size: 1em;">larger base of software hackers to join the Xbox hacking project. With</span> <span style="font-size: 1em;">GNU/Linux, the Xbox can run a wide variety of application software, from</span> <span style="font-size: 1em;">free open-source video games to word processing applications to clustering</span> <span style="font-size: 1em;">software for building Beowulf-style computer clusters.</span></p>

  <h3 id="sigil_toc_id_83"><b class="calibre3">Installing Xbox-Linux</b></h3>

  <p>Currently, in order to run Xbox-Linux, you need to install a GNU/Linux <span style="font-size: 1em;">boot ROM using an alternate firmware device. This requires opening up the</span> <span style="font-size: 1em;">Xbox. Chapter 10 describes methods for building and installing an alternate firmware device for the Xbox via the LPC interface. Several vendors now</span> <span style="font-size: 1em;">offer easy-to-install LPC interface alternative firmware devices. Notably, the Xodus/Matrix device is the first alternative firmware device on the market with an entirely solderless installation procedure. All the tools you need to install the Xodus/Matrix device are described in Chapter 1, “Voiding the</span> <span style="font-size: 1em;">Warranty,” and the Xodus/Matrix device itself comes with some easy-to-</span><span style="font-size: 1em;">follow instructions on how to program and use the alternate firmware</span> <span style="font-size: 1em;">device.</span></p>

  <div class="infobox">
    <h2 class="sigil_not_in_toc"><b class="calibre3">Profile: Michael Steil</b></h2>

    <p><b>Michael, can you tell us a little bit more about yourself?</b></p>

    <p>Born in 1979 in Erding/Germany, I’m a student of computer <span style="font-size: 1em;">science at the Technische Universität München. I teach</span> <span style="font-size: 1em;">Assembly to students in the first semester, and I plan to have</span> <span style="font-size: 1em;">a MA degree next year. I have been working with comput</span><span style="font-size: 1em;">ers since I was ten years old; my first computer was a Com</span><span style="font-size: 1em;">modore 64, followed soon by a 386 PC. My main interests</span> <span style="font-size: 1em;">were always hardware and operating systems, and I was</span> <span style="font-size: 1em;">especially fascinated by the diversity of hardware archi</span><span style="font-size: 1em;">tectures (Commodore, PC, Amiga, Macintosh, . . .) as well as</span> <span style="font-size: 1em;">popular embedded systems, such as gaming consoles. (Did</span> <span style="font-size: 1em;">you know the “SEGA CD” has three CPUs, one Z80 and two</span> <span style="font-size: 1em;">M68000?). That’s why I bought many video game systems</span> <span style="font-size: 1em;">for experimentation, such as the Nintendo SNES, the SEGA</span> <span style="font-size: 1em;">Genesis, and the Nintendo Game Boy. I also had a look at</span> <span style="font-size: 1em;">Linux for the SEGA Dreamcast, but I have never seen Linux</span> <span style="font-size: 1em;">for the Sony Playstation 2, since the whole set was really too</span> <span style="font-size: 1em;">expensive for me, both for experimentation and for real use.</span></p>

    <p><b>How did you get into Xbox hacking, and in particular, the <span style="font-size: 1em;">Xbox-Linux project?</span></b></p>

    <p>On April 30th 2002, I bought an Xbox, convinced that it <span style="font-size: 1em;">would be a great toy for hacking, and well-suited for Linux.</span> <span style="font-size: 1em;">After looking at the system software for an hour or two (I</span> <span style="font-size: 1em;">bought no game), I unscrewed the Xbox. Looking for infor</span><span style="font-size: 1em;">mation about hacking the box disappointed me at first: I</span> <span style="font-size: 1em;">didn’t find much more than how to connect the hard disk</span> <span style="font-size: 1em;">to a PC, and a site about Xbox Linux with virtually no infor</span><span style="font-size: 1em;">mation on it. So I decided to start my own Xbox hacking site</span> <span style="font-size: 1em;">and put information on it that I found out by connecting</span> <span style="font-size: 1em;">the hard disk to a PC.</span></p>

    <p><span style="font-size: 1em;">Xboxhacker.net and the original Xbox Linux mailing list were</span> <span style="font-size: 1em;">a great help; they both attracted excellent hackers and</span> <span style="font-size: 1em;">published valuable information. Dissatisfied with the origi</span><span style="font-size: 1em;">nal infrastructure of the Xbox Linux Project, I decided to</span> <span style="font-size: 1em;">move to Sourceforge on May 23rd. Now every contributor</span> <span style="font-size: 1em;">could add anything to the website without having to go</span> <span style="font-size: 1em;">through the maintainer. But at that time, everything was still</span> <span style="font-size: 1em;">quite theoretical: Without the advent of modchips we</span> <span style="font-size: 1em;">couldn’t do much more than write code that “should theo</span><span style="font-size: 1em;">retically work.” Andy Green’s Filtror accelerated everything:</span> <span style="font-size: 1em;">This mod made it possible to finish the bootloader and, with</span> <span style="font-size: 1em;">Milosch Meriac’s help, adapt the Linux kernel within a very</span> <span style="font-size: 1em;">short time.</span></p>

    <p style="font-size: medium;">The “anonymous donor” approaching me in June did not <span style="font-size: 1em;">only lead to additional publicity of the project and there</span><span style="font-size: 1em;">fore to even more contributors, but also to a personal friend</span><span style="font-size: 1em;">ship of mine: Walter Meyer, creator of the BioXX (OpenXbox)</span> <span style="font-size: 1em;">modchip happens to live only 20 kilometers away from my</span> <span style="font-size: 1em;">place. Among other things, he helped me a lot with</span> <span style="font-size: 1em;">modding my boxes, since I’m not really a soldering iron per</span><span style="font-size: 1em;">son.</span></p>

    <p style="font-size: medium;">With Linux already running on the Xbox, in December 2002 <span style="font-size: 1em;">the Xbox Linux core team (Andy Green, Milosch Meriac,</span> <span style="font-size: 1em;">Franz Lehner, and me; Edgar Hucek unfortunately couldn’t</span> <span style="font-size: 1em;">come) met in person for the first time at the Chaos Com-</span> <span style="font-size: 1em;">puter Club Congress in Berlin.</span></p>

    <p style="font-size: medium;"><span style="font-size: 1em;">My original motivation for everything was just that it’s fun</span> <span style="font-size: 1em;">and I could learn a lot by doing it. I didn’t start it because</span> <span style="font-size: 1em;">I wanted to harm Microsoft — still, I agree that Microsoft</span> <span style="font-size: 1em;">harms their customers by not letting them use the software</span> <span style="font-size: 1em;">they want to use on the hardware they bought, and that’s</span> <span style="font-size: 1em;">why the Xbox Linux Project is especially important.</span></p>

    <p style="font-size: medium;"><span style="font-size: 1em;">[We’re] not “Anti-MS” or “MS-haters.” We dislike their market in</span> <span style="font-size: 1em;">strategy, so we have a rational reason to work against them.</span></p>

    <p style="font-size: medium;"><b><span style="font-size: 1em;">Is there anything more you’d like to say about the $200k prize</span> <span style="font-size: 1em;">for Xbox-Linux?</span></b></p>

    <p style="font-size: medium;">I think that the award didn’t attract people that wanted to <span style="font-size: 1em;">see some money: Now one month after the deadline, the</span> <span style="font-size: 1em;">money still hasn’t been distributed yet and still not a single</span> <span style="font-size: 1em;">person has sent me a single question about when he will get</span> <span style="font-size: 1em;">the money. The award attracted the press; we got more pub</span><span style="font-size: 1em;">licity, and this way we got more hackers. But nobody did it</span> <span style="font-size: 1em;">because of the money. So we don’t want to be regarded as</span> <span style="font-size: 1em;">being paid for the job by Michael Robertson. A good proof is</span> <span style="font-size: 1em;">that we’re stil al active after the deadline.</span></p>

    <p style="font-size: medium;"><b>Can you tel us more about your “MIST X-Code hack”?</b></p>

    <p style="font-size: medium;"><span style="font-size: 1em;">Some time after bunnie’s original hack, Andy extracted the</span> <span style="font-size: 1em;">MCPX ROM completely and Steve, Paul , and I started to ana</span><span style="font-size: 1em;">lyze the code, and I reverse-engineered the X-Code interpreter</span> <span style="font-size: 1em;">contained within it. When looking for bugs that could be used</span> <span style="font-size: 1em;">to escape the X-Code interpretation loop, I found that a part</span> <span style="font-size: 1em;">of the code had already been written with our attacks in mind.</span> <span style="font-size: 1em;">This is my original disassembly:</span></p>
    <pre>
cmp     ebx, 80000880 ; ISA Bridge, MCPX disable?
jnz      short not_mcpx_disable
               ; BUG: too specific: bits 24 to 30
               ; undefined and ignored by PCI hardware!
and     ecx, not 2 ; clear bit 1 (MCPX ROM will be
                   ; turned off by setting bit 1)
not_mcpx_disable:
mov     eax, ebx
mov     dx, 0CF8h
out    dx, eax ; PCI configuration address
add     dl, 4
mov     eax, ecx
out    dx, eax ; PCI configuration data
jmp     short next_instruction

</pre>

    <p style="font-size: medium;">I had been working with “PCI configuration” before, therefore <span style="font-size: 1em;">I knew that the test for the attack was too specific: Similar</span> <span style="font-size: 1em;">codes would do the same, but they pass the test. So the MS</span> <span style="font-size: 1em;">developers had a good idea, but the implementation was</span> <span style="font-size: 1em;">wrong, thus telling us about their idea this way!</span></p>

    <p style="font-size: medium;"><span style="font-size: 1em;">I sent my idea to Andy, Steve, and Paul, and they verified after</span> <span style="font-size: 1em;">a short time that 0x88000880 worked just as well as 0x80000880</span> <span style="font-size: 1em;">to turn off the MCPX ROM and exiting the interpreter by map</span><span style="font-size: 1em;">ping the interpreter code out of memory!</span></p>
  </div>

  <div class="note">
    <h3 class="sigil_not_in_toc">Note</h3>

    <p><img alt="" class="note" src="../Images/index-181_1.png" style="height: auto; width: auto;"/></p>

    <p><b class="calibre3">Microsoft can and will revise their motherboard layout and</b> <b class="calibre3" style="font-size: 1em;">security system, so check with your device vendor for com</b><b class="calibre3" style="font-size: 1em;">patibility with your specific system hardware before mak</b><b class="calibre3" style="font-size: 1em;">ing a purchase. You will also need an Xbox gameport to</b> <b class="calibre3" style="font-size: 1em;">USB converter cable if you wish to use a standard key</b><b class="calibre3" style="font-size: 1em;">board and mouse with the Xbox, which can be purchased</b> <b class="calibre3" style="font-size: 1em;">through aftermarket retailers such as Lik-Sang (http://</b><b class="calibre3" style="font-size: 1em;">www.lik-sang.com) or you can build one yourself by fol</b><b class="calibre3" style="font-size: 1em;">lowing the step-by-step guide in Chapter 4.</b></p>
  </div>

  <p style="clear: left;">Before installing your alternative firmware device, you will need to program it with a ROM image that boots the GNU/Linux kernel. “Cromwell” is an <span style="font-size: 1em;">open-source, clean-room (i.e., contains no Microsoft code) boot ROM for</span> <span style="font-size: 1em;">the Xbox that is capable of booting GNU/Linux. Significantly, the informa</span><span style="font-size: 1em;">tion contained in the Cromwell source code and binary image cannot be</span> <span style="font-size: 1em;">used to bypass any of the native copyright control mechanisms built into</span> <span style="font-size: 1em;">the Xbox. In other words, it is difficult to argue that Cromwell is any kind of copyright control circumvention tool. (Cromwell can be downloaded</span> <span style="font-size: 1em;">from the Xbox-Linux website on the Sourceforge.net server at http://</span><span style="font-size: 1em;">xbox-linux.sourceforge.net.)</span></p>

  <p>After burning the Cromwell ROM to your alternate firmware device and <span style="font-size: 1em;">installing the device in the Xbox, you will need to burn onto CD/RW</span> <span style="font-size: 1em;">media a GNU/Linux install image that you can download from the Xbox-</span><span style="font-size: 1em;">Linux website (again, http://xbox-linux.sourceforge.net). This</span> <span style="font-size: 1em;">install image comes as a fairly hefty (100+ MB)</span> <i class="calibre4" style="font-size: 1em;">ISO image,</i> <span style="font-size: 1em;">compressed using bzip2, and it contains al of the software, interfaces, and tools necessary for getting a user-friendly GNU/Linux distribution up and running on the Xbox. When burning this ISO image, you must use the burn image option</span> <span style="font-size: 1em;">in the CD burner software. Do not copy the ISO image onto the CD as a</span> <span style="font-size: 1em;">single large file. (ISO images are literal bit patterns for a CD, so an ISO</span> <span style="font-size: 1em;">image already contains a complete filesystem description. Burning an ISO</span> <span style="font-size: 1em;">image as a regular file, instead of as an image, encapsulates the ISO image in a new filesystem, so the ISO just appears as a “bag of bits” instead of a filesystem with files.)</span></p>

  <p>You may also need a second disk burned with the boot program for Xbox-<span style="font-size: 1em;">Linux. This boot program comes as a smaller ISO image that should be</span> <span style="font-size: 1em;">available from the same place where you downloaded the main GNU/Linux</span> <span style="font-size: 1em;">install image. This boot image allows you to boot the Linux installation by simply dropping it into the Xbox, just like starting a game. (You can also</span> <span style="font-size: 1em;">copy the contents of this disk onto the hard drive using a third-party</span> <span style="font-size: 1em;">dashboard and boot Xbox-Linux directly from the hard drive if you prefer</span> <span style="font-size: 1em;">not to deal with a separate boot disk.)</span></p>

  <p>Burning a good CD/RW image is perhaps one of the trickiest parts of <span style="font-size: 1em;">installing Xbox-Linux. The laser used inside the DVD-ROM drive of the</span> <span style="font-size: 1em;">Xbox is not well-suited for reading writeable CD media, so the Xbox is very finicky about the kind of media and the kind of burner as well as the burner settings used to create the CD image. Furthermore, the exact details of how the laser is degraded varies from Xbox to Xbox and is dependent upon the model of drive that happened to be installed. Users have found that few</span> <span style="font-size: 1em;">Xboxes can reliably read CD-R media, so CD/RW media</span> <i class="calibre4" style="font-size: 1em;">must</i> <span style="font-size: 1em;">be used. In addition, it helps to burn the CD/RW media at the slowest burner setting</span> <span style="font-size: 1em;">using either a fresh, blank CD/RW, or a CD/RW that has been fully erased</span> <span style="font-size: 1em;">(as opposed to the quick erase that just resets the filesystem and does not actually destroy previously written data).</span></p>

  <p>Before committing to a particular type of CD/RW media, try using the <span style="font-size: 1em;">regular Xbox Dashboard’s WMA ripping tools to copy the contents of a</span> <span style="font-size: 1em;">CD/RW that you burned with music to the hard drive. If this works</span> <span style="font-size: 1em;">reliably and without error, you can probably use that kind of CD/RW</span> <span style="font-size: 1em;">media for installing Linux. (Many Xbox-Linux installation problems have</span> <span style="font-size: 1em;">been traced to problems reading data off of the CD/RW drive.) At the time</span> <span style="font-size: 1em;">of this writing, there are no distributions available in hard-pressed CD-</span><span style="font-size: 1em;">ROM media. There is some talk in the Xbox-Linux community of ordering</span> <span style="font-size: 1em;">a set of custom CD-ROM images, since this would solve many of the</span> <span style="font-size: 1em;">CD/RW headaches that users have been experiencing. (Also note that it</span> <span style="font-size: 1em;">is possible to install in your Xbox an after-market DVD-ROM drive that</span> <span style="font-size: 1em;">has better compatibility with writeable CD formats, as discussed in the</span> <span style="font-size: 1em;">previous chapter.)</span></p>

  <div class="note">
    <h3 class="sigil_not_in_toc">Note</h3>

    <p><img alt="" class="note" src="../Images/index-184_1.png" style="height: auto; width: auto;"/></p>

    <p><b class="calibre3">Keep in mind that Xbox-Linux is an active project that is</b> <b class="calibre3" style="font-size: 1em;">constantly evolving. The most up-to-date instructions for</b> <b class="calibre3" style="font-size: 1em;">installing GNU/Linux on the Xbox can be found at the</b> <b class="calibre3" style="font-size: 1em;">Sourceforge Xbox-Linux website, and these instructions</b> <b class="calibre3" style="font-size: 1em;">have been translated into at least a half-dozen languages</b> <b class="calibre3" style="font-size: 1em;">at the time of this writing. If you are interested in contribut</b><b class="calibre3" style="font-size: 1em;">ing your talents to the Xbox-Linux project, there is a list of</b> <b class="calibre3" style="font-size: 1em;">projects to-do on the Sourceforge Xbox-Linux website as</b> <b class="calibre3" style="font-size: 1em;">well as some instructions on how to join the developer’s</b> <b class="calibre3" style="font-size: 1em;">mailing list.</b></p>
  </div>

  <h3 id="sigil_toc_id_84"><b class="calibre3">“Project B”</b></h3>

  <p>There is a work in progress, referred to as “Project B” by the Xbox-Linux <span style="font-size: 1em;">developers, to find a way to install and boot Xbox-Linux without any</span> <span style="font-size: 1em;">hardware modifications. The Project B moniker comes from the criteria</span> <span style="font-size: 1em;">defined for the awarding of a $200,000 prize offered by Michael Robertson,</span> <span style="font-size: 1em;">the CEO of Lindows. The “Project A” prize was $100,000 and it has been</span> <span style="font-size: 1em;">awarded to the first group to get Linux running on an Xbox with hardware</span> <span style="font-size: 1em;">modifications. The remaining $100,000 will be awarded to the individual or</span> <span style="font-size: 1em;">group that completes Project B. The asymmetric division of the prize</span> <span style="font-size: 1em;">money hints at the challenge of completing Project B. (More details on</span> <span style="font-size: 1em;">Project B can be found at the Sourceforge Xbox-Linux website at http://</span><span style="font-size: 1em;">xbox-linux.sourceforge.net/articles.php?aid=2002354043211.)</span></p>

  <p>There are a number of Project B strategies being pursued by various groups. <span style="font-size: 1em;">The most conceptually simple approach is to factor the 2048-bit RSA key</span> <span style="font-size: 1em;">used to sign Xbox game disks. This approach is being pursued by</span> <span style="font-size: 1em;">OperationProjectX (http://sourceforge.net/projects/opx) using</span> <span style="font-size: 1em;">a distributed computing approach. Simply put, if the 2048-bit RSA key is</span> <span style="font-size: 1em;">factored to reveal Microsoft’s private key, anyone can forge Microsoft’s digital signature and create bootable game disks for the Xbox, given that Microsoft never removes from the Xbox kernel the ability to load programs from regular CD or CD/RW media. Significantly, Microsoft ships its games on 2-</span><span style="font-size: 1em;">layer DVD-9 format disks with special security structures. The Xbox</span> <span style="font-size: 1em;">firmware could be configured by Microsoft to only boot from disks that</span> <span style="font-size: 1em;">have this particular structure, regardless of the digital signature check. Since it is currently impossible to burn 2-layer DVDs using a common DVD burner drive, requiring secured DVD-9 media as the only source for executables</span> <span style="font-size: 1em;">would present an impairment to distributing Xbox-Linux through free</span> <span style="font-size: 1em;">downloads off the Internet. The other problem with this approach is that</span> <span style="font-size: 1em;">the chance of successful y factoring the Xbox’s private key through a brute force search is very, very small. (Chapter 7, “A Brief Primer on Security,”</span> <span style="font-size: 1em;">contains a sidebar on “Very Difficult Problems” that attempts to</span> <span style="font-size: 1em;">communicate the computational difficulty of this task.) If the private key</span> <span style="font-size: 1em;">is successfully recovered within a reasonable amount of time by this</span> <span style="font-size: 1em;">approach, it will significantly reduce people’s confidence in the RSA</span> <span style="font-size: 1em;">algorithm. (On the other hand, you can never win the lottery if you don’t</span> <span style="font-size: 1em;">buy a ticket, and running a free distributed factoring client using the spare cycles on your CPU is much cheaper than a Powerball ticket.)</span></p>

  <p style="font-size: medium;"><img alt="" class="calibre2" src="../Images/index-185_1.png"/></p>

  <p class="caption" style="font-size: medium;"><b class="calibre3">Figure 11-1</b>: The Xbox-Linux core team at the 19th annual Chaos Computer Conference, held in Berlin, Germany. In the back, Michael Steil; in the front, from left to right: Andy Green, Milosch Meriac, and Franz Lehner.<i class="calibre4">(Photograph courtesy</i> <i class="calibre4">of Gerhard Farfeleder.)</i> Hacking the Xbox: An Introduction to Reverse Engineering</p>

  <p>Another approach, related to cracking the RSA-2048 bit key, is to modify <span style="font-size: 1em;">an existing, signed Xbox executable in a useful manner without changing</span> <span style="font-size: 1em;">its cryptographic hash value. Such a constructive hash collision would</span> <span style="font-size: 1em;">make the modified executable look identical to the original as far as the</span> <span style="font-size: 1em;">digital signature check is concerned. The hash used in the Xbox’s digital</span> <span style="font-size: 1em;">signature algorithm is SHA-1. SHA-1 is a 160-bit hash with no publicly</span> <span style="font-size: 1em;">known algorithmic weaknesses; since the source of the hash is fixed,</span> <span style="font-size: 1em;">about 2<sup>160</sup> random variations would have to be tried to discover a</span> <span style="font-size: 1em;">collision. As a side note, you can’t use a birthday attack to reduce the</span> <span style="font-size: 1em;">difficulty of the attack to 280 random variations because we are not trying to find two messages that hash to the same arbitrary value. The goal is to</span> <span style="font-size: 1em;">generate a specific target hash, or perhaps one of a very limited set of</span> <span style="font-size: 1em;">target hashes harvested from the set of all published Xbox game titles.</span> <span style="font-size: 1em;">Hence, this approach also falls into the category of “Very Difficult</span> <span style="font-size: 1em;">Problems.”</span></p>

  <p><span style="font-size: 1em;">An alternative approach to Project B is to find security holes in Xbox</span> <span style="font-size: 1em;">software and use the holes to seize control of the CPU’s instruction</span> <span style="font-size: 1em;">pointer. To see how this is helpful, consider this example: Suppose a</span> <span style="font-size: 1em;">network-based buffer overrun exploit was discovered in a game that can</span> <span style="font-size: 1em;">lead to arbitrary code execution. A program running on a PC connected</span> <span style="font-size: 1em;">to the Xbox via the network could then use this exploit to send packets</span> <span style="font-size: 1em;">to the Xbox that would install a simple bootloader for Xbox-Linux. This</span> <span style="font-size: 1em;">bootloader could be something as simple as a program that runs code at</span> <span style="font-size: 1em;">a designated location on the Xbox’s hard drive or on the DVD drive.</span> <span style="font-size: 1em;">Any port where the Xbox can accept data is a vector for this kind of</span> <span style="font-size: 1em;">attack, including the USB and network port as well as the hard drive and</span> <span style="font-size: 1em;">the DVD-ROM drive.) Corrupted save games or file structures can be</span> <span style="font-size: 1em;">imaged onto the hard drive or DVD-ROM drive that cause the Xbox to</span> <span style="font-size: 1em;">run user-developed code. To Microsoft’s credit, all of the network</span> <span style="font-size: 1em;">interactions and save game protocols use fairly strong and well-tested</span> <span style="font-size: 1em;">security techniques. In addition, I heard at a presentation about the Xbox</span> <span style="font-size: 1em;">by Microsoft at MIT that all game code is inspected by a buffer overrun</span> <span style="font-size: 1em;">checker and that Microsoft has contractual remedies against game</span> <span style="font-size: 1em;">developers that are found guilty of putting deliberate back doors into their game code. This points to the Xbox code base being more secure than a</span> <span style="font-size: 1em;">typical Microsoft product, which makes it all the more interesting as a</span> <span style="font-size: 1em;">problem for hackers to work on. (If you are interested in participating in</span> <span style="font-size: 1em;">hacking on the Xbox as a part of “Project B,” I encourage you to first check</span> <span style="font-size: 1em;">out the Project B Prize Rules web page at</span> <span style="font-size: 1em;">http://xbox-linux.sourceforge.net/</span><span style="font-size: 1em;">articles.php?aid=20030023081956.)</span></p>

  <p style="font-size: medium;">Recently, a buffer overrun exploit was discovered in the way saved games <span style="font-size: 1em;">are handled by Electronic Arts’ “007: Agent Under Fire” game. The</span> <span style="font-size: 1em;">exploit was first divulged by a hacker known simply as “habibi_xbox” on</span> <span style="font-size: 1em;">March 29, 2003 through a posting on the XboxHacker.net BBS. Signifi</span><span style="font-size: 1em;">cantly, the exploit was identified in an undisclosed number of games, but</span> <span style="font-size: 1em;">“007: Agent Under Fire” was the only game explicitly named in the</span> <span style="font-size: 1em;">posting. The exploit leverages an unchecked string to run a short segment</span> <span style="font-size: 1em;">(a few hundred bytes) of code that inserts a series of kernel patches.</span> <span style="font-size: 1em;">Various measures were included in the design of the hack to make it very</span> <span style="font-size: 1em;">difficult to modify the hack to do anything other than run the intended</span> <span style="font-size: 1em;">Xbox-Linux target. For example, the hack patches the original Xbox</span> <span style="font-size: 1em;">RSA public key, used for verifying digital signatures, with a new public</span> <span style="font-size: 1em;">key, while leaving the digital signature check algorithm unpatched. Only</span> <span style="font-size: 1em;">he Xbox-Linux bootloader, provided as part of the hack, is appropri</span><span style="font-size: 1em;">ately signed with the corresponding new private key. Other hackers</span> <span style="font-size: 1em;">would have to factor the new public key in order to use this hack to run</span> <span style="font-size: 1em;">other executables. Also, the “007: Agent Under Fire” game itself</span> <span style="font-size: 1em;">performs an independent digital signature check on al saved games, so</span> <span style="font-size: 1em;">modifying the exploit code in the hacked savegame file is not trivial. The</span> <span style="font-size: 1em;">inclusion of such security measures in the hack is a laudable decision on</span> <span style="font-size: 1em;">the part of the hack’s implementer, as it helps ensure that the hack is not directly useful for applications such as piracy. Implementing security</span> <span style="font-size: 1em;">measures that protect Microsoft’s interests may help save the Xbox-Linux</span> <span style="font-size: 1em;">project from the wrath of Microsoft and the U.S. Department of Justice.</span></p>

  <div class="infobox">
    <h2 class="sigil_not_in_toc"><span class="calibre3" style="font-size: 1em; font-weight: normal;">Profile: Milosch Meriac</span></h2>

    <p><b>Can you tell us a little bit about yourself?</b></p>

    <p>My general history is fairly simple. I was born in 1976 in Czecho<span style="font-size: 1em;">slovakia. My parents (my mother is a teacher, my father is a</span> <span style="font-size: 1em;">civil engineer) escaped during the Cold War to western</span> <span style="font-size: 1em;">Germany because of repressions by the communist regime.</span> <span style="font-size: 1em;">I was about three years old when we arrived in Germany. In</span> <span style="font-size: 1em;">German kindergarten I immediately learned the German</span> <span style="font-size: 1em;">language. From this point it was really simple — being ten</span> <span style="font-size: 1em;">years old, I got my first computer after some months of whin</span><span style="font-size: 1em;">ing. Things started to roll.</span></p>

    <p>After school leaving exams and a weird intermezzo at Ger<span style="font-size: 1em;">man Federal Armed Forces Military Duty, i started studying</span> <span style="font-size: 1em;">cybernetics and computer science, but i decided after</span> <span style="font-size: 1em;">three years to quit university and to concentrate as a long</span><span style="font-size: 1em;">term objective on my own company. During my studies I</span> <span style="font-size: 1em;">established some valuable business connections, so it was</span> <span style="font-size: 1em;">easy to work as a freelancer for various companies in Ger</span><span style="font-size: 1em;">many. I did some reverse engineering projects, developed</span> <span style="font-size: 1em;">realtime embedded linux systems with small footprint, did</span> <span style="font-size: 1em;">some lowlevel programming like realtime extensions for Win</span><span style="font-size: 1em;">dows systems, and developed a software based harddisk</span> <span style="font-size: 1em;">safeguard for a famous German company. I now live with</span> <span style="font-size: 1em;">my girlfriend in Berlin and we are having a great time there.</span></p>

    <p style="font-size: medium;"><b>Why do you hack?</b></p>

    <p style="font-size: medium;">After getting more experienced in programming I started to <span style="font-size: 1em;">discover that the beautiful and bright entity of the com</span><span style="font-size: 1em;">puter world is in fact a fragile patchwork.</span></p>

    <p style="font-size: medium;">In the beginning hacking was like a game for me. You could <span style="font-size: 1em;">walk around inside your computer system discovering worlds</span> <span style="font-size: 1em;">of new code and possibilities every single day. Occasion</span><span style="font-size: 1em;">ally one could challenge the application authors to a duel</span> <span style="font-size: 1em;">by trying to analyze and circumvent their copy protec</span><span style="font-size: 1em;">tions. Sometimes it was like playing chess; other times it was</span> <span style="font-size: 1em;">like a deathmatch.</span></p>

    <p style="font-size: medium;">On one hand I was excited to see my knowledge growing <span style="font-size: 1em;">and on the other hand it was naturally a great ego boost</span> <span style="font-size: 1em;">for a 14 year old child to circumvent security systems of</span> <span style="font-size: 1em;">overpaid godlike hardcore programmers. During my time</span> <span style="font-size: 1em;">as a senior high school, I revised this view — while program</span><span style="font-size: 1em;">ming tools and applications for some local companies dur</span><span style="font-size: 1em;">ing school vacations I met some genuine programmers —</span> <span style="font-size: 1em;">and was disappointed: they were neither gods, nor god</span><span style="font-size: 1em;">like.</span></p>

    <p style="font-size: medium;">After some time i realized that writing a cool demo, hacking <span style="font-size: 1em;">application X, or finding a nifty hack for Y doesn’t change</span> <span style="font-size: 1em;">the world more than a sack of rice toppling down some</span><span style="font-size: 1em;">where in China. So I started choosing my realms more wisely</span> <span style="font-size: 1em;">— technologies of everyday life like telephones, computers,</span> <span style="font-size: 1em;">networks and satellites. I found out that one has the power to</span> <span style="font-size: 1em;">change things by explaining technology to average users or</span> <span style="font-size: 1em;">by helping companies to secure their products.</span></p>

    <p style="font-size: medium;"><span style="font-size: 1em;">Today I am aware of my power as whitehat hacker. Every</span> <span style="font-size: 1em;">person in today’s life is affected by information technologies:</span> <span style="font-size: 1em;">surveillance techniques, data mining, information warfare, Digi</span><span style="font-size: 1em;">tal Milllenium Copyright Act, TCPA, digital rights management,</span> <span style="font-size: 1em;">new interpretations of copyright and patent law are growing</span> <span style="font-size: 1em;">like mushrooms after monsoon rain. Like in my past I ache to</span> <span style="font-size: 1em;">peek behind these beautiful and bright entities, and hopefully</span> <span style="font-size: 1em;">find the bugs and traps before they find us.</span></p>

    <p style="font-size: medium;"><b><span style="font-size: 1em;">Can you tell us about your experience with the Xbox-Linux</span> <span style="font-size: 1em;">project?</span></b></p>

    <p style="font-size: medium;">I joined the Xbox Linux project and helped to get the kernel <span style="font-size: 1em;">running, which was tricky because the Xbox architecture has</span> <span style="font-size: 1em;">some traps and differences compared to a personal com</span><span style="font-size: 1em;">puter. I created the early Linux distributions for Microsoft’s Xbox.</span> <span style="font-size: 1em;">This was important because we had only 1 MB flash available</span> <span style="font-size: 1em;">to store the complete distribution and the kernel, and the hard</span> <span style="font-size: 1em;">disk wasn’t unlocked yet. I also provided a console driver for</span> <span style="font-size: 1em;">Andy Green’s filtror device, so we were able to see the kernel</span> <span style="font-size: 1em;">boot messages and get a linux console by using his device as</span> <span style="font-size: 1em;">some sort of remote interface. This distribution already included</span> <span style="font-size: 1em;">network drivers, soundcard drivers, mp3 support, a telnet server,</span> <span style="font-size: 1em;">webserver, NFS support, and a broad range of standard linux</span> <span style="font-size: 1em;">tools. This enabled us to get rid of our custom-made hard</span><span style="font-size: 1em;">ware and allowed hundreds of people to join the project,</span> <span style="font-size: 1em;">either as code contributors or as test persons. We had no screen</span> <span style="font-size: 1em;">output yet, so I added a framebuffer interface to the Xbox</span> <span style="font-size: 1em;">Linux kernel and made many other contributions.</span></p>

    <p style="font-size: medium;">The number of contributing developers started to grow enor<span style="font-size: 1em;">mously. We get awesome help from all over the world to make</span> <span style="font-size: 1em;">Xbox Linux possible. Some stay hidden because they are afraid</span> <span style="font-size: 1em;">of legal uncertainties like the DMCA in United States, while</span> <span style="font-size: 1em;">others can contribute freely.</span></p>

    <p style="font-size: medium;"><b>Do you have any other comments you would like to share?</b></p>

    <p style="font-size: medium;">Some people may ask why full-grown people like me fiddle <span style="font-size: 1em;">about with this Xbox toy. Every person certainly has his own</span> <span style="font-size: 1em;">reasons; my reason is to improve my skil s and to learn more</span> <span style="font-size: 1em;">about recent technologies. The Microsoft Xbox for instance is</span> <span style="font-size: 1em;">the predecessor of a TCPA/Palladium protected computer,</span> <span style="font-size: 1em;">with all the technical and social implications. It’s a fine play</span><span style="font-size: 1em;">ground for my research on more secure computer systems with</span><span style="font-size: 1em;">out pressing users.</span></p>

    <p style="font-size: medium;">One of the main reasons is our community. It’s really fun and a <span style="font-size: 1em;">great pleasure to work together with these bright geeks —</span> <span style="font-size: 1em;">online and especially offline in a pub with pints of fine beer. I</span> <span style="font-size: 1em;">am amazed every day by the growing strength of our com</span><span style="font-size: 1em;">munity. Thanks to all for making this possible!</span></p>
  </div>

  <p><span style="font-size: 1em;">Looking forward, the success of Project B could spell either a new age</span> <span style="font-size: 1em;">for Xbox hacking, or the demise of Xbox hacking. Even though Project</span> <span style="font-size: 1em;">B hackers have demonstrated social conscience and good will by trying to</span> <span style="font-size: 1em;">protect Microsoft’s interests, it is impossible to prevent less scrupulous</span> <span style="font-size: 1em;">hackers from reverse engineering the hack and eventually figuring out how</span> <span style="font-size: 1em;">to reproduce the technique in some less Microsoft-friendly form. The end</span> <span style="font-size: 1em;">result could either be a harsh crackdown by Microsoft upon all hacking</span> <span style="font-size: 1em;">activity, or Microsoft exiting the video game business altogether since their revenue stream would be cut off like Sega’s in the Dreamcast piracy debacle.</span> <span style="font-size: 1em;">Or, Microsoft could just elect to plow more money into the business and</span> <span style="font-size: 1em;">release a redesigned console that incorporates patches and countermeasures</span> <span style="font-size: 1em;">for known security holes. The outcome will depend heavily upon how</span> <span style="font-size: 1em;">events unfold in the next few months. However, with deep price cuts on the</span> <span style="font-size: 1em;">horizon for the Xbox and rumors of a thoroughly redesigned “shrink”</span> <span style="font-size: 1em;">version of the console floating around, it seems that Microsoft’s near-term strategy is to focus its energies on storming the market instead of stemming fair-use or piracy. After all, every Playstation2 or Gamecube sold probably has a worse effect on Microsoft’s business than every Xbox converted to run GNU/Linux, or even an Xbox converted to run pirated games.</span></p>

  <h2 id="sigil_toc_id_85"><b class="calibre3">OpenXDK</b></h2>

  <p>Many interesting and useful projects for the Xbox, such as the <span style="font-size: 1em;">XboxMediaPlayer and MAME-X (Multiple Arcade Machine Emulator for</span> <span style="font-size: 1em;">the Xbox), have been developed for the native Xbox gaming platform.</span> <span style="font-size: 1em;">Unfortunately, these programs were developed using unauthorized versions</span> <span style="font-size: 1em;">of the Microsoft Xbox SDK (Software Development Kit). Microsoft’s</span> <span style="font-size: 1em;">Xbox SDK is supposed to be available only to approved, licensed develop</span><span style="font-size: 1em;">ers. However, the SDK was leaked even before the console was launched,</span> <span style="font-size: 1em;">and since then many have used the leaked Xbox SDK for creating their own</span> <span style="font-size: 1em;">Xbox programs. While the proprietary Xbox SDK is convenient and easy to</span> <span style="font-size: 1em;">use, it is also technically il egal to use. The lack of a legal SDK for the native Xbox platform makes it difficult to attract a large base of open-source developers.</span></p>

  <p>The OpenXDK project was created to address the need for a legal alternative to the Xbox SDK. OpenXDK’s stated goal is to create a legal development <span style="font-size: 1em;">kit for creating Xbox Executables (XBEs). OpenXDK wil al ow users to</span> <span style="font-size: 1em;">create native XBE files that, when signed with the appropriate digital</span> <span style="font-size: 1em;">signature, could run on a vanilla Xbox. Since this appropriate digital</span> <span style="font-size: 1em;">signature is as of yet unknown, this work is done in anticipation of a legal technology that enables interoperability with programs developed using the</span> <span style="font-size: 1em;">OpenXDK.</span></p>

  <p>Despite its utility, the OpenXDK project is still in its nascence and is <span style="font-size: 1em;">looking for developers. More about the OpenXDK project can be found</span> <span style="font-size: 1em;">at http://openxdk.sourceforge.net. OpenXDK’s project managers</span> <span style="font-size: 1em;">are Dan Johnson (also known as SiliconIce, the creator of the</span> <span style="font-size: 1em;">XboxHacker BBS) and Aaron Robinson (also known as caustik; caustik is</span> <span style="font-size: 1em;">also leading the CXBX executable relinker and the CXBE Xbox emula</span><span style="font-size: 1em;">tor projects).</span></p>
</body></html>