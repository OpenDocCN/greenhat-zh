- en: INTRODUCTION
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Welcome to *Designing BSD Rootkits*! This book will introduce you to the fundamentals
    of programming and developing kernel-mode rootkits under the FreeBSD operating
    system. Through the "learn by example" method, I'll detail the different techniques
    that a rootkit can employ so that you can learn what makes up rootkit code at
    its simplest level. It should be noted that this book does not contain or diagnose
    any "full-fledged" rootkit code. In fact, most of this book concentrates on *how*
    to employ a technique, rather than *what* to do with it.
  prefs: []
  type: TYPE_NORMAL
- en: Note that this book has nothing to do with exploit writing or how to gain root
    access to a system; rather, it is about maintaining root access long after a successful
    break-in.
  prefs: []
  type: TYPE_NORMAL
- en: What Is a Rootkit?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: While there are a few varied definitions of what constitutes a rootkit, for
    the purpose of this book, a *rootkit* is a set of code that allows someone to
    control certain aspects of the host operating system without revealing his or
    her presence. Fundamentally, that's what makes a rootkit—evasion of end user knowledge.
  prefs: []
  type: TYPE_NORMAL
- en: Put more simply, a rootkit is a "kit" that allows a user to maintain "root"
    access.
  prefs: []
  type: TYPE_NORMAL
- en: Why FreeBSD?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: FreeBSD is an advanced, open source operating system; with FreeBSD, you have
    full, uninhibited access to the kernel source, making it easier to learn systems
    programming—which is, essentially, what you'll be doing throughout this book.
  prefs: []
  type: TYPE_NORMAL
- en: The Goals of This Book
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The primary goal of this book is to expose you to rootkits and rootkit writing.
    By the time you finish this book, you should "theoretically" be able to rewrite
    the entire operating system, on the fly. You should also understand the theory
    and practicality behind rootkit detection and removal.
  prefs: []
  type: TYPE_NORMAL
- en: The secondary goal of this book is to provide you with a practical, hands-on
    look at parts of the FreeBSD kernel, with the extended goal of inspiring you to
    explore and hack the rest of it on your own. After all, getting your hands dirty
    is always the best way to learn.
  prefs: []
  type: TYPE_NORMAL
- en: Who Should Read This Book?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This book is aimed at programmers with an interest in introductory kernel hacking.
    As such, experience writing kernel code is not required or expected.
  prefs: []
  type: TYPE_NORMAL
- en: To get the most out of this book, you should have a good grasp of the C programming
    language (i.e., you understand pointers) as well as *x*86 Assembly (AT&T Syntax).
    You'll also need to have a decent understanding of operating system theory (i.e.,
    you know the difference between a process and a thread).
  prefs: []
  type: TYPE_NORMAL
- en: Contents Overview
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This book is (unofficially) divided into three sections. The first section ([Chapter 1](ch01.html
    "Chapter 1. LOADABLE KERNEL MODULES")) is essentially a whirlwind tour of kernel
    hacking, designed to bring a novice up to speed. The next section ([Chapter 2](ch02.html
    "Chapter 2. HOOKING") through [Chapter 6](ch06.html "Chapter 6. PUTTING IT ALL
    TOGETHER")) covers the gamut of current, popular rootkit techniques (i.e., what
    you would find in "the wild"); while the last section ([Chapter 7](ch07.html "Chapter 7. DETECTION"))
    focuses on rootkit detection and removal.
  prefs: []
  type: TYPE_NORMAL
- en: Conventions Used in This Book
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Throughout this book, I have used a boldface font in code listings to indicate
    commands or other text that I have typed in, unless otherwise specifically noted.
  prefs: []
  type: TYPE_NORMAL
- en: Concluding Remarks
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Although this book concentrates on the FreeBSD operating system, most (if not
    all) of the concepts can be applied to other OSes, such as Linux or Windows. In
    fact, I learned half of the techniques in this book on those very systems.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: All of the code examples in this book were tested on an IA-32-based computer
    running FreeBSD 6.0-STABLE.
  prefs: []
  type: TYPE_NORMAL
