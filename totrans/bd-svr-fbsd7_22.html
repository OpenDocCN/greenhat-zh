<html><head></head><body>

<div class="calibre1"><div class="calibre1"><a name="cyrus_sasl_2.1.22" class="calibre8" id="cyrus_sasl_2.1.22"/>
<div class="calibre24" id="calibre_pb_0"/><h2 id="title-ID0ESXOM" class="docPrefaceTitle">Chapter 7. CYRUS SASL 2.1.22</h2>
<h4 class="calibre32"><a class="calibre2" target="_blank" href="HTTP://ASG.WEB.CMU.EDU/SASL">HTTP://ASG.WEB.CMU.EDU/SASL</a></h4>
<a name="summary-id6" class="calibre8" id="summary-id6"/>
<h3 class="docSection1Title" id="-100000">7.1. SUMMARY</h3>
<p class="docText1"><span class="docEmphasis1"><a name="SASL " class="calibre8" id="SASL "/>SASL (Simple Authentication and Security Layer)</span><a name="system for" class="calibre8" id="system for"/> is a system for adding authentication support to connection-based protocols. For the purposes of this book, we will be using this mechanism for the Simple Mail Transfer Protocol (SMTP). The Postfix MTA employs SMTP to transfer Internet email. Adding authentication support to Postfix is important for users who wish to relay email through their server from an unsecured public network. A secure mail relay can be attained by coupling SASL with SSL/TLS-based encryption.<a name="IDX-CHP-7-0134" class="calibre8" id="IDX-CHP-7-0134"/><a name="IDX-CHP-7-0135" class="calibre8" id="IDX-CHP-7-0135"/><a name="IDX-CHP-7-0136" class="calibre8" id="IDX-CHP-7-0136"/><a name="IDX-CHP-7-0137" class="calibre8" id="IDX-CHP-7-0137"/><a name="IDX-CHP-7-0138" class="calibre8" id="IDX-CHP-7-0138"/></p>
<p class="docText1"><a name="is not" class="calibre8" id="is not"/>By default, the Postfix MTA is not an open email relay. While this prevents unauthorized users from using the server to relay spam, it also prevents legitimate users from sending email from a location other than the local private network. Cyrus SASL allows the SMTP server to verify the identity of remote users. Once authenticated, users are allowed remote relay privileges.</p>
<p class="docText1"><a name="systems architect" class="calibre8" id="systems architect"/>John Myers, a former systems architect at Carnegie Mellon University, published the SASL specification in October 1997. Cyrus SASL is maintained under Project Cyrus at Carnegie Mellon.<a name="IDX-CHP-7-0139" class="calibre8" id="IDX-CHP-7-0139"/></p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="resources-id6" class="calibre8" id="resources-id6"/>
<h3 class="docSection1Title" id="-100000">7.2. RESOURCES</h3>
<p class="docText1"><span class="b"><a name="Official Cyrus" class="calibre8" id="Official Cyrus"/>Official Cyrus SASL Website at Carnegie Mellon University</span></p>
<p class="docText1"><a class="calibre2" target="_blank" href="http://asg.web.cmu.edu/sasl/">http://asg.web.cmu.edu/sasl/</a></p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="required-id6" class="calibre8" id="required-id6"/>
<h3 class="docSection1Title" id="-100000">7.3. REQUIRED</h3>
<p class="docText1"><img border="0" id="" src="bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg" alt="" class="calibre33"/><a name="FreeBSD " class="calibre8" id="FreeBSD "/> FreeBSD 7.0-RELEASE (see "<a class="calibre2" href="freebsd_7.0_split_000.html#freebsd_7.0">FreeBSD 7.0</a>")</p>
<p class="docText1"><img border="0" id="" src="bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg" alt="" class="calibre33"/><a name="collection " class="calibre8" id="collection "/> Updated ports collection (see "<a class="calibre2" href="freebsd_ports_collection.html#freebsd_ports_collection">FreeBSD Ports Collection</a>")</p>
<p class="docText1"><img border="0" id="" src="bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg" alt="" class="calibre33"/> Internet connection</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="preparation-id6" class="calibre8" id="preparation-id6"/>
<h3 class="docSection1Title" id="-100000">7.4. PREPARATION</h3>
<p class="docText1"><a name="Become the" class="calibre8" id="Become the"/>Become the superuser.</p>
<hr size="1" noshade="noshade" class="calibre27"/><span><i class="docEmphasis1"><b class="calibre28">Note:</b></i> This guide is relevant for the configuration of Cyrus SASL with the Postfix MTA, and it assumes that you intend to utilize SASL with SMTP coupled with SSL/TLS encryption to secure the PLAIN and/or LOGIN authentication methods.</span><hr size="1" noshade="noshade" class="calibre27"/>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="install-id6" class="calibre8" id="install-id6"/>
<h3 class="docSection1Title" id="-100000">7.5. INSTALL</h3>
<p class="docText1"><a name="You will" class="calibre8" id="You will"/>You will be installing the Cyrus SASL authentication server, which includes Cyrus SASL. To begin the installation of the Cyrus SASL authentication server, type the following commands:<a name="IDX-CHP-7-0140" class="calibre8" id="IDX-CHP-7-0140"/></p>
<pre class="calibre30"># <b class="calibre28">cd /usr/ports/security/cyrus-sasl2-saslauthd</b>
 # <b class="calibre28">make config ; make install clean</b>
 # <b class="calibre28">rehash</b></pre>
<p class="docText1"><a name="should appear" class="calibre8" id="should appear"/>A menu should appear showing options for Cyrus SASL. We will leave these settings at their defaults, so press [tab] to highlight <span class="b">OK</span> and then press [enter].</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="configure-id6" class="calibre8" id="configure-id6"/>
<h3 class="docSection1Title" id="-100000">7.6. CONFIGURE</h3>
<p class="docText1"><a name="Once the" class="calibre8" id="Once the"/>Once the installation process is complete, it's time to configure Cyrus SASL for use on your system.</p>
<div class="calibre34"><ol class="docList" type="1"><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="file named" class="calibre8" id="file named"/>Create a file named <span class="docEmphasis1">smtpd.conf</span>. The <span class="docEmphasis1">smtpd.conf</span><a name="Cyrus SASL" class="calibre8" id="Cyrus SASL"/> file is used by Cyrus SASL when it is configured to work with the Postfix MTA. Create the file:</p><pre class="calibre30"># <b class="calibre28">ee /usr/local/lib/sasl2/smtpd.conf</b></pre>
<p class="docText1"><a name="two lines" class="calibre8" id="two lines"/>and add these two lines to it:</p><pre class="calibre30">pwcheck_method: saslauthd
mech_list: plain login</pre><br class="calibre1"/>
<p class="docText1"><a name="authentication server" class="calibre8" id="authentication server"/>The first line directs Cyrus SASL to use the SASL authentication server that you installed. The second line tells Cyrus SASL to announce only PLAIN and LOGIN methods when a client initially connects to the SMTP server.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1">Save and exit.</p></div></li></ol></div>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="testing-id4" class="calibre8" id="testing-id4"/>
<h3 class="docSection1Title" id="-100000">7.7. TESTING</h3>
<p class="docText1"><a name="In this" class="calibre8" id="In this"/>In this section, we'll enable the SASL authentication server to start at boot time, then perform a test to confirm that it is running.<a name="IDX-CHP-7-0141" class="calibre8" id="IDX-CHP-7-0141"/></p>
<div class="calibre34"><ol class="docList" type="1"><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="the SASL" class="calibre8" id="the SASL"/>To configure the SASL authentication server to start automatically at boot time, open <span class="docEmphasis1">rc.conf</span>:</p><pre class="calibre30"># <b class="calibre28">ee /etc/rc.conf</b></pre>
<p class="docText1"><a name="startup lines" class="calibre8" id="startup lines"/>and add the following startup lines:</p><pre class="calibre30">saslauthd_enable="YES"
saslauthd_flags="-a pam"</pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="and test" class="calibre8" id="and test"/>Save your changes and test by running the startup script:</p><pre class="calibre30"># <b class="calibre28">/usr/local/etc/rc.d/saslauthd start</b>
# <b class="calibre28">/usr/local/etc/rc.d/saslauthd status</b></pre><br class="calibre1"/>
<p class="docText1">If the SASL authentications server is running, you'll see:</p><pre class="calibre30">saslauthd is running as pid <tt class="calibre20"><i class="docEmphasis1">1234</i></tt>.</pre><br class="calibre1"/>
<p class="docText1">The pid (process ID) will vary.</p></div></li></ol></div>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="config_files-id6" class="calibre8" id="config_files-id6"/>
<h3 class="docSection1Title" id="-100000">7.8. CONFIG FILES</h3>
<p class="docText1"><span class="b">/usr/local/lib/sasl2/smtpd.conf</span><a name="IDX-CHP-7-0142" class="calibre8" id="IDX-CHP-7-0142"/></p>
<p class="docText1"><a name="This file" class="calibre8" id="This file"/>This file controls the behavior of the SASL daemon when used with the Postfix MTA. It stores parameters that tell Cyrus SASL what method of authentication to announce to SMTP clients.</p>
</div></div>

</body></html>