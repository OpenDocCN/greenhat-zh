["```\ndefine host{\n    host_name      proxy\n    ...\n  **parents switch2**\n}\ndefine host{\n    host_name      switch2\n    ...\n  **parents switch1**\n}\ndefine host{\n    host_name      switch1\n    ...\n}\n```", "```\ndefine service{\n     host_name                              proxy\n     service_description                    DNS\n     ...\n     **normal_check_interval**[[43](#ftn.CHP-4-FN-3)] **5**\n **retry_check_interval**[[44](#ftn.CHP-4-FN-4)] **1**\n **max_check_attempts**              **5**\n     ...\n}\n```", "```\n220 swobspace.de ESMTP\n```", "```\n*TYPE_OF_CHECK STATUS - informational text*\n```", "```\nSMTP OK - 0.186 sec. response time\nDISK WARNING - free space: /net/eli02/a 3905 MB (7%);\n```", "```\nOK - 172.17.129.2: rta 97.751ms, lost 0%| rta=97.751ms;200.000;500.000;0; pl=0%;40;80;;\n```", "```\nnagios@linux:local/libexec$ **./check_icmp -m 2 -H 192.168.1.9**\n\\\n**192.168.1.11 192.168.1.13**\nOK - 192.168.1.9: rta 0.098ms, lost 0% :: **192.168.1.11: rta nan, lost 100%** ::\n192.168.1.13: rta 0.744ms, lost 0%|192.168.1.9rta=0.09 8ms;200.000;500.000;0;\n 192.168.1.9pl=0%;40;80;; 192.168.1.11rta=0\\. 000ms;200.000;500.000;0;\n 192.168.1.11pl=100%;40;80;;\n 192.168.1.13r ta=0.744ms;200.000 ;500.000;0; 192.168.1.13pl=0%;40;80;;\n```", "```\nlinux:~ # **chown root.nagios /usr/local/nagios/libexec/check_icmp**\nlinux:~ # **chmod 4711 /usr/local/nagios/libexec/check_icmp**\nlinux:~ # **ls -l /usr/local/nagios/libexec/check_icmp**\n-rwsr-x--x l root nagios 61326 2005-02-08 19:49 check_icmp\n```", "```\nnagios@linux:~$ **cd /usr/local/nagios/libexec**\nnagios@linux:nagios/libexec$ **./check_icmp -H 192.168.1.13** \\ **-w 100.0,20%\n -c 200.0,40%**\n\nOK - 192.168.1.13: rta 0.253ms, lost 0%| rta=0.253ms;100.000;200.000;0; pl=0%;20;40;;\n```", "```\ndefine command{\n **command_name   check**_**ping**\n      command_line          $USER1$/**check**_**icmp** -H $HOSTADDRESS$ -w $ARG1$ -c\n $ARG2$\n}\n```", "```\ndefine service{\n    service_description   PING\n    host_name             linux01\n    **check_command      check_ping!100.0,20%!500.0,60%**\n   ...\n}\n```", "```\nlinux:~ # **cd /usr/local/nagios/libexec**\nlinux:nagios/libexec # **ln -s check_icmp check**_**host**\n```", "```\ndefine host{\n    host_name           linux01\n    alias               Linux File Server\n    address             192.168.1.21\n     **check**_**command   check-host-alive**\n    ...\n}\n```", "```\ndefine command{\n **command**_**name  check-host-alive**\n      command_line         $USER1$/**check**_**host** -H $HOSTADDRESS$\n}\n```", "```\nnagios@linux:nagios/libexec$ **./check_smtp -H smtp01**\nSMTP OK - 0,008 sec. response time|time=0,008157s;;;0,000000\n```", "```\ndefine command{\n    command_name **check_smtp**\n    command_line      $USER1$/**check_smtp** -H $HOSTADDRESS$\n}\n```", "```\ndefine service{\n     service_description     SMTP\n     host_name               linux01\n      **check_command    check_smtp**\n     ...\n}\n```", "```\nnagios@linux:nagios/libexec$ **./check_smtp -H localhost** \\\n **-C \"MAIL FROM: <bla@gna.dot>\" -R \"250\"** \\\n **-C \"RCPT TO: <bla@gna.dot>\" -R \"554\"**\nSMTP OK - 0,019 sec. response time|time=0,018553s;;;0,000000\n```", "```\nuser@linux:~$ **telnet localhost 25**\nTrying 127.0.0.1...\nConnected to loca1host.\nEscape character is '^]'.\n220 swobspace.de ESMTP\n**helo swobspace**\n250 swobspace.de\n**MAIL FROM: <bla@gna.dot>**\n250 Ok\n**RCPT TO: <bla@gna.dot>**\n554 <bla@gna.dot>: Recipient address rejected: test not existing top lev\nel domain\n...\n```", "```\n./check_imap -H *computer* -s \"a1 CAPABILITY\" -e \"STARTTLS\"\n```", "```\nnagios@linux:nagios/libexec$ **./check_pop -H mailsrv**\nPOP OK - 0.064 second response time on port 110 [+OK eli11 Cyrus POP3\nv2.1.16 server ready <1481963980.1118597146@eli11>]\n|time=0.064228s;0.000000;0.000000;0.000000;10.000000\n```", "```\ndefine command{\n    command_name **check_pop**\n    command_line     $USER1$/**check_pop** -H $HOSTADDRESS$\n}\n```", "```\ndefine service{\n    service_description     POP\n    host_name               linux01\n     **check_command    check_pop**\n     ...\n}\n```", "```\n--port=21 --expect=\"220\" --quit=\"QUIT\\r\\n\"\n```", "```\nnagios@linux:nagios/libexec$ **./check_ftp -H ftp.gwdg.de**\nFTP OK - 0,130 second response time on port 21 [220-Gesellschaft fuer wi\nssenschaftliche Datenverarbeitung mbH Goettingen] |time=0,130300s;0,0000\n00;0,000000;0,000000;10,000000\n```", "```\ndefine command{\n     command_name **check_ftp**\n     command_line   $USER1$/**check_ftp** -H $HOSTADDRESS$\n}\n```", "```\ndefine service{\n    service_description    FTP\n    host_name              linux01\n **check_command   check_ftp**\n    ...\n}\n```", "```\nnagios@linux:nagios/libexec$ **./check_http -H www.swobspace.de**\nHTTP OK HTTP/1.1 200 OK - 2553 bytes in 0.154 seconds\n```", "```\nnagios@linux:nagios/libexec$ **./check_http -I www.swobspace.de**\nHTTP WARNING: HTTP/1.1 404 Not Found\n```", "```\nnagios@linux:nagios/libexec$ **./check_http -H linux.swobspace.net \\**\n **-u /mailinglisten/index.html**\nHTTP OK HTTP/1.1 200 OK - 5858 bytes in 3.461 seconds\n```", "```\nnagios@linux:nagios/libexec$ **./check_http -H www.swobspace.de -L**\n<A HREF=\"http://www.swobspace.de:80/\" target=\"_blank\"> HTTP OK HTT P/1.1 200 OK\n - 2553 bytes in 0.156 seconds</A>\n```", "```\nnagios@linux:nagios/libexec$ **./check_http -H www.swobspace.de** \\\n **m 500:2000**\nHTTP WARNING: page size 2802 too large|size=2802B;500;0;0\n```", "```\n-k \"Accept-Charset: iso-8859-1; Accept-Encoding: compress, gzip;\"\n```", "```\nnagios@linux:nagios/libexec$ **./check_http --ssl -H \\**\n **www.verisign.com**\nHTTP OK HTTP/1.1 200 OK - 33836 bytes in 1.911 seconds\n```", "```\nnagios@linux:nagios/libexec$ **./check_http --ssl -H www.swobspace.de**\nConnection refused\nUnable to open TCP socket\n```", "```\nGET **http://www.swobspace.de/** HTTP/1.1\nHost: **www.swobspace.de**\nUser-Agent: Mozilla/5.0 (X11; U; Linux i686; de-DE; rv:1.7.5)\nGecko/20041108 Firefox/1.0\nAccept: text/xml,application/xml,application/xhtml+xml,...\nAccept-Language: de-de,de;q=0.8,en-us;q=0.5,en;q=0.3\nAccept-Encoding: gzip,deflate\nAccept-Charset: ISO-8859-15,utf-8;q=0.7,*;q=0.7\nKeep-Alive: 300\nProxy-Connection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\n```", "```\nnagios@linux:nagios/libexec$ **./check_http -H www.swobspace.de** \\\n **-I 192.168.1.13 -p 3128 -u http://www.swobspace.de**\nHTTP OK HTTP/1.0 200 OK - 2553 bytes in 0.002 seconds\n```", "```\nGET **http://www.swobspace.de HTTP/1.0**\nUser-Agent: check_http/v1861 (nagios-plugins 1.4.11)\nConnection: close\nHost: **www.swobspace.de**\n```", "```\ndefine command{\n    command_name **check_proxy**\n    command_line   $USER1$/**check_http** -H www.googl\ne.de -u http://www.google.de -I $HOSTADDRESS$ -p $ARG1$\n}\n```", "```\ndefine service{\n    service_description    Webproxy\n    host_name              linux01\n **check_command   check_proxy!3128**\n    ...\n}\n```", "```\nGET cache_object: //*ip_address/command* HTTP/1.1\\n\\n\n```", "```\nuser@linux:~$ **echo \"GET cache_object://192.168.1.13/info HTTP/1.1\\n\\n\"** \\\n    | **netcat 192.168.1.13 3128**\n...\nFile descriptor usage for squid:\n         Maximum number of file descriptors:     1024\n         Largest file desc currently in use:       18\n         Number of file desc currently in use:     15\n         Files queued for open:                     0\n         Available number of file descriptors:   1009\n         Reserved number of file descriptors:     100\n         Store Disk files open:                     0\n...\n```", "```\n...\nacl manager proto cache_object\n**acl nagiosserver 192.168.1.9**\n**http_access allow manager nagiosserver**\nhttp_access deny manager\n**cachemgr_passwd none info menu**\n...\n```", "```\nhttp_access deny manager\n```", "```\nlinux:~ # **/etc/init.d/squid reload**\n```", "```\nnagios@linux:nagios/libexec$ **./check_squid.pl -H 192.168.1.13**\nSquid cache OK (1009 FreeFileDesc)\n```", "```\ndefine command{\n    command_name   **check_squid.pl**\n    command_line $USER1$/**check_squid.pl** -H $HOSTADDRESS$\n}\n```", "```\ndefine service{\n   service_description   Squid\n   host_name             linux01\n   **check_command  check_squid.pl**\n   ...\n}\n```", "```\nnagios@linux:nagios/libexec$ **/check_dns -H www.google.com**\nDNS OK: 0,009 seconds response time www.google.com returns 216.239.59.99\n```", "```\ndefine command{\n    command_name **check_dns**\n    command_line $USER1$/**check_dns** -H www.google.de\n}\n```", "```\ndefine service{\n    service_description      DNS/nslookup\n    host_name                linux01\n    **check_command  check_dns**\n    ...\n}\n```", "```\nnagios@linux:nagios/libexec$ **./check_dig -H 194.25.2.129 -l** \\\n **www.swobspace.de**\nDNS OK - 2,107 Sekunden Antwortzeit (www.swobspace.de. 1800 IN A 21\n2.227.119.101)\nnagios@linux:nagios/libexec$ **./check_dig -H 194.25.2.129 -l** \\\n **www.swobspace.de -a 1.2.3.4**\nDNS WARNING - 0,094 Sekunden Antwortzeit (Server nicht gefunden in ANSWE\nR SECTION)\n```", "```\ndefine command{\n    command_name **check_dig**\n    command_line $USER1$/**check_dig** -H $HOSTADDRESS$ −1 $ARG1$\n}\n```", "```\ndefine service{\n   service_description     DNS/dig\n   host_name               linux01\n   **check_command    check_dig!www.google.com**\n   ...\n}\n```", "```\nnagios@linux:nagios/libexec$ **./check_ssh -H localhost** \\\n **-r 'OpenSSH_4.3p2 Debian-9'**\nSSH OK - OpenSSH_4.3p2 Debian-9 (protocol 2.0)\nnagios@linux:nagios/libexec$ **./check_ssh -H wobgate -r** \\\n **'OpenSSH_4.3p2 Debian-9'**\nSSH WARNING - OpenSSH_3.8.1p1 Debian-8.sarge.6 (protocol 2.0) version mi\nsmatch, expected 'OpenSSH_4.3p2 Debian-9'\n```", "```\ndefine command{\n    command_name **check_ssh**\n    command_line        $USER1$/**check_ssh** -H $HOSTADDRESS$\n}\n\ndefine service{\n    service_description   SSH\n    host_name             linux01\n     **check_command  check_ssh**\n    ...\n}\n```", "```\nnagios@linux:nagios/libexec$ **./check_tcp -H 192.168.1.89 -p 5631**\nTCP OK - 0,061 second response time on port 5631 | time=0,060744s;0,\n000000;0,000000;0,000000;10,000000\n```", "```\ndefine command{\n     command_name  **check_tcp**\n     command_line       $USER1$/**check_tcp** -H $HOSTADDRESS$ -p $ARG1$\n}\n```", "```\ndefine service{\n   service_description   pcAnywhere\n   host_name             Win01\n   **check_command  check_tcp!5631**\n   ...\n}\n```", "```\nnagios@linux:nagios/libexec$ **./check_udp -H 192.168.1.13 -p 123 -s \"w\"** \\\n **-e\"\"**\nUDP OK - 0.001 second response time on port 123 []|time=0.000586s;;;0.00\n0000;10.000000\n```", "```\ndefine command{\n    command_name **check_udp**\n    command_line $USER1$/**check_udp** -H $HOSTADDRESS$ -p $ARG1$ -s $ARG2$\n}\n```", "```\ndefine service{\n   service_description\n   host_name             timesrv\n    **check_command  check_tcp!123!-s \"w\" -e \"\"**\n   ...\n}\n```", "```\npostgres@linux:~$ **createuser --no-adduser --no-createdb nagios**\npostgres@linux:~$ **createdb --owner nagios nagdb**\n```", "```\n#type   db     user   ip-address   ip-mask       method options\nlocal   nagdb  nagios                            ident sameuser\nhost    nagdb  nagios *ip-nagios* 255.255.255.255 ident sameuser\n```", "```\nlinux:~ # **/etc/init.d/postgresql reload**\n```", "```\nnagios@linux:nagios/libexec$ **./check_pgsql -H linux01 -d nagdb**\nCRITICAL - no connection to 'nagdb' (FATAL: IDENT authentication failed\nfor user \"nagios\")\n```", "```\nnagios@linux:nagios/libexec$ **./check_pgsql -H linux01 -d nagdb**\nOK - database nagdb (0 sec.)|time=0,000000s;2,000000;8,000000;0,000000\n```", "```\nnagios@linux:nagios/libexec$ **./check_pgsql -H linux01**\nCRITICAL - no connection to 'template1' (FATAL: no pg_hba.conf entry fo\nr host \"172.17.129.2\", user \"nagios\", database \"template1\", SSL off)\n```", "```\nwob@linux:nagios/libexec$ **./check_pgsql -H linux01 -d nagdb**\nCRITICAL - no connection to 'nagdb' (FATAL: no pg_hba.conf entry for ho\nst \"172.17.129.2\", user \"wob\", database \"nagdb\", SSL off)\n```", "```\ndefine command{\n    command_name **check_pgsql**\n    command_line $USER1$/**check_pgsql** -H $HOSTADDRESS$ -d nagdb\n}\n```", "```\ndefine service{\n    service_description     PostgreSQL\n    host_name               linux01\n     **check_command     check_pgsql**\n    ...\n}\n```", "```\nuser@linux:~$ **netstat -ant | grep 3306**\ntcp 0 0 0.0.0.0:3306 0.0.0.0:* LISTEN\n```", "```\nuser@linux:~$ **mysql --user=root mysql**\nmysql> **CREATE DATABASE nagdb;**\n```", "```\nmysql> **GRANT select ON nagdb.* TO nagios@ ip-nagios;**\n```", "```\nnagios@linux:nagios/libexec$ **./check_mysql -H dbhost -u nagios -d nagdb**\nUptime: 19031 Threads: 2 Questions: 80 Slow queries: 0 Opens: 12\nFlush tables: 1 Open tables: 6 Queries per second avg: 0.004\n```", "```\nnagios@linux:nagios/libexec$ **./check_mysql -H dbhost**\nUptime: 19271 Threads: 1 Questions: 84 Slow queries: 0 Opens: 12\nFlush tables: 1 Open tables: 6 Queries per second avg: 0.004\n```", "```\nuser@linux:~$ **mysql -u nagios**\nmysql> **use nagdb**;\nDatabase changed\nmysql>\n```", "```\ndefine command{\n   command_name **check_mysql**\n   command_line $USER1$/**check_mysql** -H $HOSTADDRESS$ -u nagios -d nagdb\n}\n```", "```\ndefine service{\n   service_description     MySQL\n   host_name               linux01\n   **check_command               check_mysql**\n   ...\n}\n```", "```\nuid=wob,dc=swobspace,dc=de\n```", "```\nallow bind_v2\n```", "```\nnagios@linux:nagios/libexec$ **./check_ldap -H ldap.swobspace.de** \\\n **-b \"dc=swobspace,c=de\"**\nLDAP OK - 0,002 seconds response time|time=0,002186s;;;0,000000\n```", "```\ndefine command{\n    command_name **check_ldap**\n    command_line $USER1$/**check_ldap** -H $HOSTADDRESS$ -b $ARG1$\n}\n```", "```\ndefine service{\n   service_description    LDAP\n   host_name              linux01\n    **check_command     check_ldap!dc=swobspace,dc=de**\n   ...\n}\n```", "```\ndefine command{\n   command_name **check_ldap_auth**\n   command_line $USER1$/**check_ldap** -H $HOSTADDRESS$ -b $ARG1$ -D $ARG2$\n-P $USER3$\n}\n```", "```\ndefine service{\n    service_description     LDAP\n    host_name               linux01\n **check_command check_ldap_auth!dc=swobspace,dc=de!uid=nagios,**\\\n **dc=swobspace,dc=de**\n   ...\n}\n```", "```\nlinux:nagios/libexec # **chown root.nagios check_dhcp**\nlinux:nagios/libexec # **chmod 4750 check_dhcp**\nlinux:nagios/libexec # **ls -l check_dhcp**\n-rwsr-x--- 1 root nagios 115095 Jan 8 12:15 check_dhcp\n```", "```\nnagios@linux:nagios/libexec$  **./check_dhcp -i eth0**\nDHCP ok: Received 1 DHCPOFFER(s), max lease time = 600 sec.\n```", "```\nnagios@linux:nagios/libexec$ **./check_dhcp -i ethO -r 192.168.1.40**\nDHCP problem: Received 1 DHCPOFFER(s), requested address (192.168.1.40)\nwas not offered, max lease time = 600 sec.\nnagios@linux:nagios/libexec$ **echO $?**\n1\n```", "```\ndefine command{\n   command_name **check_dhcp_service**\n   command_line $USER1$/**check_dhcp** -i etho\n}\n```", "```\ndefine command{\n  command_name **check_dhcp_server**\n  command_line $USER1$/**check_dhcp** -i etho -s $HOSTADDRESS$\n}\n```", "```\ndefine service{\n   service_description    DHCP Services\n   host_name              linux01\n **check_command      check_dhcp_service**\n   ...\n}\n\ndefine service{\n   service_description     DHCP Server\n   host_name               linux01\n **check_command     check_dhcp_server**\n   ...\n}\n```", "```\n# -- /etc/nut/ups.conf\n\n[upsfw]\n    driver = apcsmart\n    port = /dev/ttySO\n    desc = \"Firewalling/DMZ\"\n```", "```\nuser@linux:~$ **chown nut:nut /dev/ttyS0**\nuser@linux:~$ **chmod 660 /dev/ttyS0**\n```", "```\n# -- /etc/nut/upsd.conf\n\n# ACL *aclname ipblock*\nACL all 0.0.0.0/0\nACL localhost 127.0.0.1/32\nACL nagios 172.17.129.2/32\n\nACCEPT localhost nagios\nREJECT all\n```", "```\nuser@linux:nagios/libexec$ **./check_ups -H localhost -u upsfw -T**\nUPS OK - Status=Online Utility=227.5V Batt=100.0% Load=27.0% Temp=30.6C|\nvoltage=227500mV;;;0 battery=100%;;;0;100 load=27%;;;0;100 temp=30degF;;\n;0\n```", "```\ndefine command{\n    command_name **check_ups**\n    command_line   $USER1$/**check_ups** -H $HOSTADDRESS$ -u $ARG1$ -T\n}\n```", "```\ndefine service{\n   service_description    UPS\n   host_name              linux01\n **check_command     check_ups!upsfw**\n   ...\n}\n```", "```\nuser@linux:nagios/libexec$ **./check_ups -H linux01 -u upsfw -T -v** \\\n **LOADPCT -W 60 -c 80**\nUPS WARNING - Status=Online Utility=227.5V Batt=100.0% Load=61.9%\nTemp=30.6C|voltage=227500mV;;;0 battery=100%;;;0;100 load=61%;60000;\n80000;0;100 temp=30degC;;;0\n```", "```\nnagios@linux:nagios/libexec$ **ntpq -np 192.168.1.13**\nremote           refid         st  t  when  poll  reach  delay  offset  jitter\n127.127.1.1      .LOCL.        10  1   26    64    377    0.000  0.000   0.001\n*81.169.141.30   81.169.172.219 3  u    1   128    377   27.515 −4.411   1.219\n+217.160.215.119 212.82.32.26   3  u  125   128    377   17.834  1.505   1.069\n```", "```\nnagios@linux:nagios/libexec$ **./check_ntp_peer -H 192.168.1.13**\nNTP OK: Offset −0.004411 secs|offset=−0.004411s;60.000000;120.000000;\n```", "```\nnagios@linux:nagios/libexec$ **df /usr/local**\nFilesystem 1K-blocks Used Available Use% Mounted on\n/dev/md2 9843168 7062980 2280172 76% /usr\n```", "```\nnagios@linux:nagios/libexec$ **./check_disk -w 10% -E -p/usr/local**\nDISK CRITICAL: /usr/local not found\n```", "```\nnagios@linux:nagios/libexec$ **./check_disk -w 10% -r 'md[0-2]$'**\nDISK OK - free space: / 281 MB (31% inode=80%); /usr 2226 MB (24% i\nnode=77%);| /=626MB;861;;0;957 /usr=6897MB;8650;;0;9612\n```", "```\n-w 10% -c 5% -p / -p /usr -C -w 500 -c 100 -p /var\n```", "```\nnagios@linux:nagios/libexec$ **./check_disk -g CLUSTER -w 10%**\\\n  **-r 'md[0-3]'**\nDISK OK - free space: CLUSTER 7437 MB (38% inode=86%);| CLUSTER=11\n719MB;18163;;0;20182\n```", "```\nuser@linux:nagios/libexec$ **./check_disk -w 10% -c 5% -p / -p /usr** \\\n  **-p /var -C -w 5% -c 3% -p /net/emil1/a -p /net/emil1/c -e**\nDISK WARNING - free space: /net/emil1/c 915 MB (5%);| /=146MB;458;483;0;\n509 /usr=1280MB;3633;3835;0;4037 /var=2452MB;3633;3835;0;4037 /net/emil1\n/a=1211MB;21593;22048;0;22730 /net/emil1/c=17584MB;17574;17944;0;18499\n```", "```\nuser@linux:nagios/libexec$ **./check_swap -w 50% -c 20%**\nswap OK: 100% free (3906 MB out of 3906 MB) |swap=3906MB;1953;781;0;3906\n```", "```\nuser@linux:~$ **uptime**\n16:33:35 up    7:05, 18 users, load average: 1.87, 1.38, 0.74\n```", "```\nuser@linux:local/libexec$ **./check_load -w 10.0,8.0,5.0 -c 15.0,10.0,8.0**\nOK - load average: 1.93, 0.95, 0.50| load1=1.930000;10.000000;15.000000;\n0.000000  load5=0.950000;8.000000;10.000000;0.000000 load15=0.500000;\n5.000000;8.000000;0.000000\n```", "```\nnagios@linux:nagios/libexec$ **./check_procs -c 1:1 -C nagios -p 1**\nPROCS OK: 1 process with command name 'nagios', PPID = 1\n```", "```\nnagios@linux:nagios/libexec$ **./check_procs -w 1:4 -c 1:7 -C slurpd**\nPROCS OK: 1 process with command name 'slurpd'\n```", "```\nnagios/libexec@linux: $ **./check_procs -w 1 -c 5 -s Z**\nPROCS OK: 0 processes with STATE = Z\n```", "```\nnagios/libexec@linux: $ **./check_procs -w 1 -c 5 -P 10**\nPROCS OK: 1 process with PCPU >= 10,00\n```", "```\nuser@linux : nagios/libexec$ **./check_procs -w 1 : 1 -c 1 : 1 -C master**\nCRITICAL - 2 processes running with command name master\n```", "```\nuser@linux : ~$ **ps -fC master**\nUID    PID   PPID   C   STIME   TTY   TIME          CMD\ncyrus  431      1   0    2004   ?   00 : 00 : 28    /usr/lib/cyrus/bin/master\nroot  1042      1   0    2004   ?   00 : 00 : 57    /usr/lib/postfix/master\n```", "```\nuser@linux : nagios/libexec$ **./check_procs -w 1 : 1 -c 1:1 -C master -u** \\\n **cyrus**\nOK - 1 processes running with command name master, UID = 96 (cyrus)\n```", "```\nnagios@linux : local/libexec$ **./check_log -F /var/log/auth** \\\n **-O /tmp/check_log.badlogin -q \"authentication failure\"**\n(1) < Jan 1 18 : 47 : 56 swobspace su[22893]: (pam_unix) authentication\nfailure; logname=wob uid=200 euid=0 tty=pts/8 ruser=wob rhost= user=root\n```", "```\n./check_log -F /var/log/messages -O /tmp/check_log.pluto -q \"pluto\"\n./check_log -F /var/log/messages -O /tmp/check_log.ntpd -q \"ntpd\"\n```", "```\n# /etc/nagios/check_logs.cfg\n$seek_file_template='/var/nagios/$log_file.check_log.seek';\n\n@log_files = (\n   {'file_name' ⇒ '/var/log/messages',\n   'reg_exp' ⇒ 'ntpd',\n   },\n   {'file_name' ⇒ '/var/log/warn',\n   'reg_exp' ⇒ '(named|dhcpd)',\n   },\n );\n 1;\n```", "```\nnagios@linux : local/libexec$ **./check_logs.pl -c \\**\n**/etc/nagios/check_logs.cfg**\nmessages ⇒ OK; warn ⇒ OK;\n\nnagios@linux : local/libexec$ **./check_logs.pl -c \\**\n**/etc/nagios/check_logs.cfg**\nmessages ⇒ OK; warn ⇒ (4): Jul  2 14 : 33 : 25 swobspace dhcpd: Configuration file\n errors encountered -- exiting;\n```", "```\nlinux: local/src **# tar xvzf /**pfad-zu**/check_logfiles-2.3.1.2.tar.gz**\n...\nlinux: local/src **# cd check_logfiles-2.3.1.2**\nlinux: check_logfiles-2.3.1.2 # .**/configure \\**\n  **--with-seekfiles-dir=/var/tmp \\**\n  **--with-protocols-dir=/var/tmp**\n...\nlinux: check_logfiles-2.3.1.2 **# make && make install**\n...\n```", "```\nuser@linux: ~$ **logger -p daemon.info hellowob**\n```", "```\nDec 16 17 : 46 : 06 swobspace wob: hellowob\n```", "```\nnagios@linux : nagios/libexec$ **./check_logfiles --tag=hellowob** \\\n **--logfile=/var/log/messages --criticalpattern='hellowob'**\nCRITICAL - (1 errors in check_logfiles.protocol-2007-12-16-17-46-08) - D\nec 16 17 : 46 : 06 swobspace wob: hellowob |hellowob_lines=2 hellowob_warni\nngs=0 hellowob_criticals=1 hellowob_unknowns=0\n```", "```\nnagios@linux : nagios/libexec$ **./check_logfiles --tag=hellowob** \\\n **--logfile=/var/log/messages --criticalpattern='hellowob'**\nOK - no errors or warnings |hellowob_lines=32 hellowob_warnings=0 hellow\nob_criticals=0 hellowob_unknowns=0\n```", "```\n@searches = (\n   { *search_instruction_1* },\n   { *search_instruction_2* },\n   ...\n   { *search_instruction_n* },\n)\n```", "```\n@searches = (\n   {\n      tag              ⇒ 'hellowob',\n      logfile          ⇒ '/var/log/messages',\n      criticalpatterns ⇒ 'hellowob',\n      rotation         ⇒ 'debian',\n      options          ⇒ 'noprotocol,nocase',\n    },\n)\n```", "```\ncriticalpatterns ⇒ ['VIRUS found', 'hellowob'],\n```", "```\ncriticalpatterns ⇒ ['.*hallowob.*', '.*hellowob.* ', '!dontcryforme'],\n```", "```\nuser@linux:nagios/libexec$ **./check_users -w 5 -c 10**\nUSERS CRITICAL - 20 users currently logged in |users=20;5;10;0\n```", "```\nnagios@linux:nagios/libexec$ **./check_ntp_time -H ntpserver**\nNTP OK: Offset −0.009505749214 secs|offset=−0.009506s;60.000000;120.0000\n00;\n```", "```\nnagios@linux:nagios/libexec$ **./check_time -H timesrv -w 10 -c 60**\nTIME CRITICAL - 1160 second time difference| time=0s;;;0 offset=1160s;10 ;60;0\n```", "```\nuser@linux:nagios/libexec$ **./check_mailq -w 5 -c 10 -M postfix**\nOK: mailq reports queue is empty|unsent=0;5;10;0\n```", "```\nuser@linux:nagios/libexec$ **./check_file_age /var/log/messages**\nWARNING - /var/log/syslog/messages is 376 seconds old and 7186250 bytes\n```", "```\nuser@linux:nagios/libexec$ **./check_apc status**\nUPS OK - ONLINE\n```", "```\nuser@linux:nagios/libexec$ **./check_apc load 60 80**\nUPS OK - LOAD: 39%\n```", "```\nuser@linux:nagios/libexec$ **./check_apc bcharge 50 30**\nUPS OK - Battery Charge: 100%\n```", "```\nuser@linux:nagios/libexec$ **./check_apc time 20 10**\nUPS OK - Time Left: 30 mins\n```", "```\nuser@linux:nagios/libexec$ **./check_nagios -e 60 \\**\n **-F /var/nagios/nagios.log -C /usr/local/nagios/bin/nagios**\nNAGIOS OK: 1 process, status log updated 184 seconds ago\n```", "```\n#!/bin/bash\nNAGCHK=\"/usr/local/nagios/libexec/check_nagios\"\nPARAMS=\"-e 60 -F /var/nagios/nagios.log -C /usr/local/nagios/bin/nagios\"\n\nINFO='$NAGCHK $PARAMS'\nSTATUS=$?\n\ncase $STATUS in\n   0) echo \"OK : \" $INFO\n      ;;\n   *) echo \"ERROR : \" $INFO | \\\n        /usr/bin/mailx -s \"Nagios Error\" nagios-admin@example.com\n      ;;\nesac\n```", "```\nuser@linux:~$ **sensors**\nfscher-i2c-0-73\nAdapter: SMBus I801 adapter at 2400\nTemp1/CPU:       +41.00 C\nTemp2/MB:        +45.00 C\nTemp3/AUX:       failed\nFan1/PS:           1440 RPM\nFan2/CPU:             0 RPM\nFan3/AUX:             0 RPM\n+12V:            +11.86 V\n+5V:              +5.10 V\nBattery:          +3.07 V\n```", "```\nuser@linux:nagios/libexec$ **./check_sensors**\nsensor ok\n```", "```\nuser@linux:nagios/libexec$ **./check_sensors -v**\nfscher-i2c-0-73 Adapter: SMBus I801 adapter at 2400 Temp1/CPU: +40.00 C Temp2/MB:\n +45.00 C Temp3/AUX: failed Fan1/PS: 1440 RPM Fan2/CPU: 0 RPM\nFan3/AUX: 0 RPM +12V: +11.86 V +5V: +5.10 V Battery: +3.07 V\nsensor ok\n```", "```\nnagios@linux:nagios/libexec$ ./**check_dummy 1 \"Debugging\"**\nWARNING: Debugging\nnagios@linux:nagios/libexec$ **echo $?**\n1\n```", "```\nnegate *plugin command*\nnegate -t *timeout plugin command*\n```", "```\nnagios@linux:nagios/libexec$ ./**negate** \\\n **/usr/local/nagios/libexec/check_icmp -H 192.0.2.1**\nCRITICAL - 192.0.2.1: rta nan, lost 100%| rta=0.000ms;200.000;500.000;0;\npl=100%;40;80;;\nnagios@linux:nagios/libexec$ **echo $?**\n0\n```", "```\nurlize *url plugin command*\n```", "```\nnagios@linux:nagios/libexec$ ./**urlize http://www.swobspace.de \\ /usr/local/nagios/\nlibexec/check_http -H www.swobspace.de**\n<A href=\"http://www.swobspace.de\">HTTP OK HTTP/1.1 200 OK - 2802 bytes\nin 0.132 seconds |time=0.132491s;;;0.000000 size=2802B;;;0</A>\n```", "```\n--data=$HOSTSTATEID:srv1$,$HOSTSTATEID:srv2$,$HOSTSTATEID:srv3$\n```", "```\nnagios@linux:local/libexec$ ./**check cluster -s -d 0,2,1,0,2 -w 0:2 -c 0:3**\nCLUSTER WARNING: Service cluster: 2 ok, 1 warning, 0 unknown, 2 critical\n```", "```\ndefine command{\n   command_name    check_cluster\n   command_line    $USER1$/check_cluster -l $ARG1$ $ARG2$\n}\n```", "```\ndefine service{\n   host_name mycluster\n   service_description Web Cluster\n   command check_cluster!Web Cluster!--service -d $SERVICESTATEID:srv1:\nHTTP$, $SERVICESTATEID:srv2:HTTP$ -w 0:0 -c 0:1\n}\n```", "```\n*normal text output* | *optional performance data*\n*longtext, 1st line*\n*longtext, 2nd line*\n...\n*longtext, n-th line | performance data, 2nd line*\n*performance data, 3rd line*\n...\n*performance data, n-th line*\n```", "```\n#define MAX_INPUT_BUFFER           8192\n#define MAX_PACKETBUFFER_LENGTH                    8192\n```", "```\nuser@linux:~$ ./**check_multi -f contrib/check_multi.cmd**\nMULTI CRITICAL - 35 plugins checked, 7 critical (network_rsync, proc_acp id,\n proc_httpd, system_syslog, system_users, nagios_system, dummy_critical), 2 warning\n (nagios_tac, dummy_warning), 2 unknown (network_if_ethl, dummy_unknown), 24 ok\n[1] network_ping PING OK - Packet loss = 0%, RTA = 0.06 ms\n[2] network_interfaces OK: host 'localhost', interfaces up: 6, down: 0, dormant: 0,\n excluded: 0, unused: 0\n[3] network_if_eth1 Either a valid snmpkey key (-k) or a ifDescr (-d) must be\n provided)\n...\n[16] system_load OK - load average: 0.89, 0.71, 0.71\n[17] system_mail TCP OK - 0.000 second response time on port 25\n[18] system_mailqueue OK: mailq is empty\n[19] system_mysql Uptime: 5573 Threads: 1 Questions: 140 Slow queries\n: 0 Opens: 137 Flush tables: 1 Open tables: 19 Queries per second avg\n: 0.025\n[20] system_ntp NTP OK: Offset −0.07118669868 secs\n[21] system_portmapper OK: RPC program portmapper version 2 udp running\n[22] system_rootdisk DISK OK - free space: / 287 MB (31% inode=81%);\n[23] system_ssh SSH OK - OpenSSH_4.3p2 Debian-9 (protocol 2.0)\n...\n|MULTI::check_multi::plugins=35 time=10.92 network_interfaces::check_ifs tatus::\nup=6,down=0,dormant=0,excluded=0,unused=0 system_load::check_load ::\nload1=0.890;5.000;10.000;0; load5=0.710;4.000;8.000;0; load15=0.710;3\\. 000;6.000;0;\n system_mail::\ncheck_tcp::time=0.000225s;;;0.000000;10.000000 system_mailqueue::check_mailq::\nunsent=0;2;4;0\n system_ntp::check_ntp::off set=−0.071187s;60.000000;120.000000; system_rootdisk::\ncheck_disk::\n/=620M B;909;937;0;957 system_swap::check_swap::swap=3906MB;0;0;0;3906 system_u sers::\ncheck_users::users=25;5;10;0 nagios.org_dns::check_dns::time=0.039 187s;;;\n0.000000 nagios.org_http::check_http::time=0.674044s;;;0.000000 s ize=21530B;;;0\n```", "```\n...\ncommand[ network_interfaces ] = check_ifstatus -H localhost\ncommand[ system_load ] = check_load -w 5,4,3 -c 10,8,6\ncommand[ system_mail ] = check_tcp -H localhost -p 25\ncommand[ system_mailqueue ] = check_mailq -w 2 -c 4\ncommand[ system_mysql ] = check_mysql -u admin\ncommand[ system_ntp ] = check_ntp -H ntp1.fau.de\ncommand[ system_portmapper ] = check_rpc -H localhost -C portmapper\ncommand[ system_rootdisk ] = check_disk -w 5% -c 2% -p /\ncommand[ system_ssh ] = check_ssh localhost\n...\n```", "```\n    ..., 2 critical (network_rsync, proc_acpid), 1 warning (nagios_tac), 1 unknown\n     (if_eth1), dummy_unknown), 24 ok\n    ```", "```\n...|rta=0.111ms;500.000;1000.000;0; pl=0%;5;10;; offset=0.002980s;60.000 000;\n120.000000;\n```", "```\n*servicedescription:: plugin:: label = values [label = calues]*\n```", "```\n|MULTI::check_multi::plugins=5 time=0.18 net_ping::check_icmp::rta=0.048 ms;\n500.000;1000.000;0; pl=0%;5;10;; system_ntp::check_ntp::offset=0.0022 66s;60.000000;\n120.000000;\n```", "```\n(gate1 > 1 || provider1 > 1) && (gate2 > 1 || provider2 > 1)\n```", "```\n# openvpn.cmd\ncommand[ gate1 ] = check_nrpe -H gate1 -c check_openvpn\ncommand[ provider1 ] = check_icmp -H provider1 -c 1000.0,60%\ncommand[ gate2 ] = check_nrpe -H gate2 -c check_openvpn\ncommand[ provider2 ] = check_icmp -H provider2 -c 1000.0,60%\n\nstate[warning] = count(CRITICAL) > 0 || count(UNKNOWN) > 0\nstate[critical] = (gate1 > 1 || provider1 > 1) && (gate2 > 1 || provider\n2 > 1)\n```", "```\n    state [critical] = (2 > 1 || 1 > 1) ...\n    ```", "```\n# terminalserver.cmd\ncommand[ ts01 ] = check_tcp -H ts01 -p 3389\ncommand[ ts02 ] = check_tcp -H ts02 -p 3389\ncommand[ ts03 ] = check_tcp -H ts03 -p 3389\ncommand[ ts04 ] = check_tcp -H ts04 -p 3389\ncommand[ ts05 ] = check_tcp -H ts05 -p 3389\ncommand[ ts06 ] = check_tcp -H ts06 -p 3389\ncommand[ ts07 ] = check_tcp -H ts07 -p 3389\ncommand[ ts08 ] = check_tcp -H ts08 -p 3389\n\nstate[ warning ] = count(CRITICAL) > 0 || count(UNKNOWN) > 0 || count(WA\nRNING) > 0\nstate[ critical ] = ts01 >= CRITICAL || count(CRITICAL) > 3\n```", "```\n# homeoffice.cmd\ncommand[ openvpn ] = check_multi -f /etc/nagios/check_multi/openvpn.cmd\n-r31\ncommand[ terminalserver ] = check_multi -f /etc/nagios/check_multi/termi\nnalserver.cmd -r31\n```", "```\ndefine command{\n   command_name check_multi\n   command_line $USER1$/check_multi $ARG1$\n}\n\ndefine service{\n   host_name           elix01\n   service_description homeoffice\n   check_command check_multi!-f /etc/nagios/check_multi/homeoffice.cmd -n\n   homeoffice -r 31\n   ...\n}\n```", "```\nnagios@linux:nagios/libexec$ **./check_by_ssh** -H target_computer  \\\n **-i /etc/nagios/.ssh/id_dsa \\**\n **-C \"/usr/local/nagios/libexec/check_swap -w 50% -c 10%\"**\nSWAP OK: 100% free (972 MB out of 972 MB) |swap=972MB;486;97;0;972\n```", "```\nssh -i *private_key target_computer \"command\"*\n```", "```\n-C \"/usr/local/nagios/libexec/check_disk -w 10% -c 5% -e -m\"\n```", "```\nnagios@linux:~$ **mkdir /etc/nagios/.ssh**\nnagios@linux:~$ **cd /etc/nagios/.ssh**\nnagios@linux:/etc/nagios/.ssh$ **ssh-keygen -b 1024 -f id_dsa -t dsa -N\"**\nGenerating public/private dsa key pair.\nYour identification has been saved in id_dsa.\nYour public key has been saved in id_dsa.pub.\nThe key fingerprint is:\n02:0b:5a:16:9c:b4:fe:54:24:9c:fd:c3:12:8f:69:5c nagios@nagserv\n```", "```\ntarget_computer:~ # **groupadd -g 9000 nagios**\ntarget_computer:~ # **useradd -u 9000 -g nagios -d /home/nagios -m \\**\n **-c \"Nagios Admin\" nagios**\ntarget_computer:~ # **mkdir /home/nagios/.ssh**\n```", "```\nlinux:~ # **scp /etc/nagios/.ssh/id_dsa.pub** \\\n target_computer**:/home/nagios/.ssh/authorized_keys**\n```", "```\ntarget_computer:~ # **chown -R nagios.nagios /home/nagios/.ssh**\ntarget_computer:~ # **chmod 700 /home/nagios/.ssh**\n```", "```\nnagios@linux:~$ **ssh -i /etc/nagios/.ssh/id_dsa** target_computer **w**\n18:02:09 up 128 days, 10:03, 8 users, load average: 0.01, 0.02, 0.00\nUSER     TTY      FROM          LOGIN@  IDLE   JCPU   PCPU WHAT\nwob      pts/1    linux01:S.1   08Sep04 1:27   4.27s  0.03s -bin/tcsh\n...\n```", "```\nnagios@linux:~$ **/usr/local/nagios/libexec/check_by_ssh** \\\n **-H** target_computer **-i /etc/nagios/.ssh/id_dsa** \\\n **-C \"/usr/local/nagios/libexec/check_disk -w 10% -c 5% -e -m\"**\nDISK CRITICAL [2588840 kB (5%) free on /net/linux04/b] [937152 kB (5%)\nfree on /net/linux04/c]\n```", "```\n# check_ssh_disk command definition\ndefine command{\n    command_name **check_ssh_disk**\n    command_line     $USER1$/**check_by_ssh** -H $HOSTADDRESS$ \\\n                     -i /etc/nagios/.ssh/id_dsa \\\n                     -C \"$USER1$/check_disk -w $ARG1$ -c $ARG2$ -p $ARG3$\"\n}\n```", "```\ndefine service{\n    host_name       linux02\n    service_description FS_root\n    ...\n   **check_command   check_ssh_disk**!10%!5%!/\n    ...\n}\n```", "```\ndefine service{\n    host_name       linux02\n    service_description FS_root\n    ...\n    check_command   check_ssh_disk!**/usr/lib/nagios/plugins**!10%!5%!/\n    ...\n}\n```", "```\n-C \"$ARG1$/check_disk -w $ARG2$ -c $ARG3$ -p $ARG4$\"\n```", "```\nlinux:~ # **mkdir /usr/local/src**\nlinux:~ # **cd /usr/local/src**\nlinux:local/src # **tar xvzf** /path/to/**nrpe-2.11.tar.gz**\n```", "```\nlinux:local/src # **cd nrpe-2.11**\nlinux:src/rnpe-2.11 # **./configure --sysconfdir=/etc/nagios --enable-ssl**\n```", "```\nnrpe 5666/tcp # Nagios Remote Plugin Executor NRPE\n```", "```\n# /etc/xinetd.d/nrpe\n# description: NRPE\n# default: on\nservice nrpe\n{\n   flags           =    REUSE\n   socket_type     =    stream\n   wait            =    no\n   user            =    *nobody*\n   group           =    *nogroup*\n   server          =    */usr/local/sbin/nrpe*\n   server_args     =    -c /*etc/nagios/nrpe.cfg* --inetd\n   log_on_failure  +=    USERID\n   disable         =    no\n   only_from       =    *127.0.0.1 ip_of_the_nagios_server*\n}\n```", "```\nlinux:~ # **/etc/init.d/xinetd reload**\n```", "```\nnrpe stream tcp nowait *nobody* /usr/sbin/tcpd */usr/local/sbin/nrpe* -c/\n*etc/nagios/nrpe.cfg* --inetd\n```", "```\nlinux:~ # **/etc/init.d/inetd reload**\n```", "```\nlinux:~ # **netstat -lnt | grep ':5666'**\n...\ntcp  0  0 0.0.0.0:5666     0.0.0.0:*   LISTEN\n...\n```", "```\nlinux:src/rnpe-2.11 # **mkdir /etc/nagios**\nlinux:src/rnpe-2.11 # **cp nrpe.cfg /etc/nagios/**.\n```", "```\nuser@linux:~$ **egrep -v '^#|^$' nrpe.cfg | less**\nserver_port=5666\nallowed_hosts=127.0.0.1\nnrpe_user=nobody\nnrpe_group=nogroup\ndont_blame_nrpe=0\ndebug=0\ncommand_timeout=60\n...\n```", "```\ncommand[check_users]=/usr/local/nagios/libexec/check_users -w 5 -c 10\ncommand[check_load]=/usr/lib/nagios/libexec/check_load -w 8,5,3 -c 15,10,7\ncommand[check_zombies]=/usr/lib/nagios/libexec/check_procs -w :1 -c :2 -s Z\n```", "```\nnagios@linux:nagios/libexec$ **./check_nrpe -H** target_host **-c check_users**\n```", "```\ncommand[check_disk_a]=*path/to/*check_disk -w 5% -c 2% -p /net/linux01/a\ncommand[check_disk_b]=*path/to/*check_disk -w 4% -c 2% -p /net/linux01/b\ncommand[check_disk_c]=*path/to/*check_disk -w 5% -c 2% -p /net/linux01/c\ncommand[check_disk_d]=*path/to/*check_disk -w 5% -c 2% -p /net/linux01/d\ncommand[check_disk_root]=*path/to/*check_disk -w 10% -c 5% -p /\ncommand[check_disk_usr]=*path/to/*check_disk -w 10% -c 5% -p /usr\ncommand[check_disk_var]=*path/to/*check_disk -w 10% -c 5% -p /var\ncommand[check_disk_home]=*path/to/*check_disk -w 10% -c 5% -p /home\ncommand[check_disk_tmp]=*path/to/*check_disk -w 10% -c 5% -p /tmp\n```", "```\ndont_blame_nrpe=1\n...\ncommand[check_disk]=*path/to/*check_disk -w $ARG1$ -c $ARG2$ -p $ARG3$\n```", "```\nuser@linux:nagios/libexec$ **./check_disk -w 10% -c 4% -e -m**\nDISK WARNING [2588840 kB (5%) free on /net/linux1/b] [937160 kB (5%) free on\n /net/linux1/c]\n```", "```\nnagios@linux:nagios/libexec$ **./check_nrpe -H swobspace**\nCHECK_NRPE: Error - Could not complete SSL handshake.\n```", "```\nlinux:~ # **grep nrpe /var/log/messages**\n...\nnrpe[19844]: Unable to open config file '/etc/nagios/nrpe.cfg' for reading\nnrpe[19844]: Config file '/etc/nagios/nrpe.cfg' contained errors, aborting...\n...\n```", "```\nnagios@linux:nagios/libexec$ **./check_nrpe -H swobspace**\nNRPE v2.11\n```", "```\ndefine command{\n    command_name check_nrpe\n    command_line $USER1$/**check_nrpe** -H $HOSTADDRESS$ -c $ARG1$\n}\n```", "```\ndefine service{\n    host_name           linux04\n    service_description FS_var\n    ...\n   check_command check_nrpe!check_disk_var\n   ...\n}\n```", "```\ncommand[check_disk]=*path/to/*check_disk -w $ARG1$ -c $ARG2$ -p $ARG3$\n```", "```\ndefine command{\n    command_name check_nrpe\n    command_line $USER1$/**check_nrpe** -H $HOSTADDRESS$ -c $ARG1$ -a $ARG2$\n}\n```", "```\ndefine service{\n    host_name           linux04\n    service_description FS_var\n    ...\n **check_command check_nrpe!check_disk!10% 5% /var**\n    ...\n}\n```", "```\ndefine service{\n    host_name       **linux04,linux02,linux11**\n    service_description FS_var\n    ...\n    check_command check_nrpe!check_disk_var\n    ...\n}\n```", "```\ndefine service{\n **hostgroup_name     linux-servers**\n    service_description Disks\n    ...\n    check_command check_nrpe!check_disk\n    ...\n}\n```", "```\nifEntry.ifIndex.1 = INTEGER: 1\nifEntry.ifDescr.1 = STRING: eth0\nifEntry.ifType.1 = INTEGER: ethernetCsmacd(6)\nifEntry.ifMtu.1 = INTEGER: 1500\nifEntry.ifSpeed.1 = Gauge32: 100000000\nifEntry.ifPhysAddress.1 = STRING: 0:30:5:6b:70:70\nifEntry.ifAdminStatus.1 = INTEGER: up(1)\nifEntry.ifOperStatus.1 = INTEGER: up(1)\n```", "```\nifEntry.ifIndex.2 = INTEGER: 2\nifEntry.ifDescr.2 = STRING: lo\nifEntry.ifType.2 = INTEGER: softwareLoopback(24)\nifEntry.ifMtu.2 = INTEGER: 16436\nifEntry.ifSpeed.2 = Gauge32: 10000000\nifEntry.ifPhysAddress.2 = STRING:\nifEntry.ifAdminStatus.2 = INTEGER: up(1)\nifEntry.ifOperStatus.2 = INTEGER: up(1)\n...\n```", "```\nuser@linux:~$ **snmpget -v1 -c public localhost ifDescr.1**\nIF-MIB::ifDescr.1 = STRING: eth0\nuser@linux:~$ **snmpgetnext -v1 -c public localhost ifDescr.1**\nIF-MIB::ifDescr.2 = STRING: lo\nuser@linux:~$ **snmpgetnext -v1 -c public localhost ifDescr.3**\nIF-MIB::ifType.1 = INTEGER: ethernetCsmacd(6)\n```", "```\nuser@linux:~$ **snmpget -v1 -On -c public localhost ifDescr.1**\n.1.3.6.1.2.1.2.2.1.2.1 = STRING: eth0\nuser@linux:~$ **snmpget -v1 -Of -c public localhost ifDescr.1**\n.iso.org.dod.internet.mgmt.mib-2.interfaces.ifTable.ifEntry.ifDescr.1 = STRING: eth0\n```", "```\nuser@linux:~$ **snmpwalk -v1 -c public localhost mib-2.interfaces**\nIF-MIB::ifNumber.0 = INTEGER: 3\nIF-MIB::ifIndex.1 = INTEGER: 1\nIF-MIB::ifIndex.2 = INTEGER: 2\nIF-MIB::ifIndex.3 = INTEGER: 3\nIF-MIB::ifDescr.1 = STRING: eth0\nIF-MIB::ifDescr.2 = STRING: lo\nIF-MIB::ifDescr.3 = STRING: eth1\nIF-MIB::ifType.1 = INTEGER: ethernetCsmacd(6)\n...\n```", "```\nuser@linux:~$ **snmpwalk -v1 -Of -c public localhost mib-2.interfaces**\n...mib-2.interfaces.ifNumber.0 = INTEGER: 3\n...mib-2.interfaces.ifTable.ifEntry.ifIndex.1 = INTEGER: 1\n...mib-2.interfaces.ifTable.ifEntry.ifIndex.2 = INTEGER: 2\n...mib-2.interfaces.ifTable.ifEntry.ifIndex.3 = INTEGER: 3\n...mib-2.interfaces.ifTable.ifEntry.ifDescr.1 = STRING: eth0\n...mib-2.interfaces.ifTable.ifEntry.ifDescr.2 = STRING: lo\n...mib-2.interfaces.ifTable.ifEntry.ifDescr.3 = STRING: eth1\n...mib-2.interfaces.ifTable.ifEntry.ifType.1 = INTEGER: ethernetCsmacd(6)\n```", "```\nuser@linux:~$ **snmpwalk -v1 -c public localhost ucdavis.dskTable |\\ grep '.2 ='**\nUCD-SNMP-MIB::dskIndex.2 = INTEGER: 2\nUCD-SNMP-MIB::dskPath.2 = STRING: /net/swobspace/b\nUCD-SNMP-MIB::dskDevice.2 = STRING: /dev/md6\nUCD-SNMP-MIB::dskMinimum.2 = INTEGER: −1\nUCD-SNMP-MIB::dskMinPercent.2 = INTEGER: 10\nUCD-SNMP-MIB::dskTotal.2 = INTEGER: 39373624\nUCD-SNMP-MIB::dskAvail.2 = INTEGER: 1694904\nUCD-SNMP-MIB::dskUsed.2 = INTEGER: 35678636\nUCD-SNMP-MIB::**dskPercent**.2 = INTEGER: 95\nUCD-SNMP-MIB::dskPercentNode.2 = INTEGER: 1\nUCD-SNMP-MIB::**dskErrorFlag**.2 = INTEGER: 1\nUCD-SNMP-MIB::**dskErrorMsg**.2 = STRING: /net/swobspace/b: less than 10% free (= 95%)\n```", "```\n#(1) source addressesQuelladressen\ncom2sec localnet 192.168.1.0/24 public\ncom2sec localhost 127.0.0.1 public\ncom2sec nagiossrv 192.168.1.9 public\n```", "```\n# (2) assignment of group - security model - source-IP alias\ngroup Local     v1     localhost\ngroup Nagios    v1     nagiossrv\n```", "```\ngroup Nagios     v1     nagiossrv\n     group Nagios     usm    nagiossrv\n```", "```\n#(3) View definition for partial trees of the SNMP namespace\n     view all included .1\n     view system included .iso.org.dod.internet.mgmt.mib-2.system\n```", "```\nview all included   .1\n     view all excluded   .iso.org.dod.internet.private\n```", "```\nview all     included .iso.org.dod.internet.mgmt     F8\n```", "```\n# (4) Definition of the access control\naccess   Local   any   noauth   exact   all   none   none\naccess   NagiosGrp   any   noauth    exact   all    none   none\n```", "```\n#(5) mib-2.system\nsyslocation Server room Martinstr., 2nd rack from the left\nsyscontact root <wob@swobspace.de>\n```", "```\nuser@linux:~$ **snmpwalk -v1 -c public localhost system**\nsystem.sysDescr.0 = STRING: Linux swobspace 2.6.10 #20 SMP Mon Dec 27 11:55:25 CET\n 2004 i686\nsystem.sysObjectID.0 = OID: NET-SNMP-MIB::netSnmpAgentOIDs.10\nsystem.sysUpTime.0 = Timeticks: (1393474) 3:52:14.74\nsystem.sysContact.0 = STRING: root <wob@swobspace.de>\nsystem.sysName.0 = STRING: swobspace\nsystem.sysLocation.0 = STRING: Serverraum Martinstr., 2\\. Rack von links\n```", "```\n# (6) Processes: enterprises.ucdavis.procTable\n# proc *process maximum minimum*\n# proc *process maximum*\n# proc *process*\nproc sshd\nproc nmbd 2 1\nproc smbd\nproc slapd\n```", "```\nuser@linux:~$ **snmpwalk -v1 -c public localhost prTable**\n...\nprTable.prIndex.4 = INTEGER: 4\nprTable.prNames.4 = STRING: slapd\nprTable.prMin.4 = INTEGER: 0\nprTable.prMax.4 = INTEGER: 0\nprTable.prCount.4 = INTEGER: 0\nprTable.**prErrorFlag**.4 = INTEGER: 1\nprTable.**prErrMessage**.4 = STRING: No slapd process running.\n...\n```", "```\n# (7) your own commands: enterprises.ucdavis.extTable\n# exec *name command arguments*\nexec echotest /bin/echo hello world\n```", "```\nuser@linux:~$ **snmpwalk -v1 -c public localhost extTable**\nextTable.extEntry.extIndex.1 = INTEGER: 1\nextTable.extEntry.extNames.1 = STRING: echotest\nextTable.extEntry.extCommand.1 = STRING: /bin/echo hello world\nextTable.extEntry.extResult.1 = INTEGER: 0\nextTable.extEntry.extOutput.1 = STRING: hello world\n...\n```", "```\n#(8) File systems: enterprises.ucdavis.dskTable\n#disk *mount point*\n#disk *mount point* minimum_capacity_in_KB\n#disk *mountpoint* minimum_capacity_in_percent%\ndisk / 10%\ndisk /usr 819200\ndisk /data 50%\n```", "```\n...\nUCD-SNMP-MIB::dskPercent.3 = INTEGER: 65\nUCD-SNMP-MIB::**dskErrorFlag**.3 = INTEGER: 1\nUCD-SNMP-MIB::**dskErrorMsg**.3 = STRING: /data: less than 50% free (= 65%)\n```", "```\nincludeAllDisks 10%\n```", "```\n# (9) System Load: enterprises.ucdavis.laTable\n# load *max1*\n# load *max1 max5*\n# load *max1 max5 max15*\nload 5 3 2\n```", "```\nuser@linux:~$ **snmpwalk -v1 -c public localhost laTable**\n...\nUCD-SNMP-MIB::laNames.1 = STRING: Load-1\nUCD-SNMP-MIB::laNames.2 = STRING: Load-5\nUCD-SNMP-MIB::laNames.3 = STRING: Load-15\nUCD-SNMP-MIB::laLoad.1 = STRING: 5.31\nUCD-SNMP-MIB::laLoad.2 = STRING: 2.11\nUCD-SNMP-MIB::laLoad.3 = STRING: 0.77\n...\nUCD-SNMP-MIB::laLoadInt.1 = INTEGER: 530\nUCD-SNMP-MIB::laLoadInt.2 = INTEGER: 210\nUCD-SNMP-MIB::laLoadInt.3 = INTEGER: 77\nUCD-SNMP-MIB::laLoadFloat.1 = Opaque: Float: 5.310000\nUCD-SNMP-MIB::laLoadFloat.2 = Opaque: Float: 2.110000\nUCD-SNMP-MIB::laLoadFloat.3 = Opaque: Float: 0.770000\nUCD-SNMP-MIB::laErrorFlag.1 = INTEGER: 1\nUCD-SNMP-MIB::laErrorFlag.2 = INTEGER: 0\nUCD-SNMP-MIB::laErrorFlag.3 = INTEGER: 0\nUCD-SNMP-MIB::laErrMessage.1 = STRING: 1 min Load Average too high (=5.31)\nUCD-SNMP-MIB::laErrMessage.2 = STRING:\nUCD-SNMP-MIB::laErrMessage.3 = STRING:\n```", "```\nnagios@linux:local/libexec$ ./**check_snmp -H swobspace -C public \\**\n **-o dskTable.dskEntry.dskPercent.2 -w 0:90 -c 0:95 -u percent** SNMP WARNING\n - *95* percent\n```", "```\nSNMP-DISK: /net/swobspace/b WARNING - *95* percent\n```", "```\ndefine command{\n    command_name **check_snmp**\n    command_line $USER1$/**check_snmp** -H $HOSTADDRESS$ -C $USER3$ -P 1 -o $ARG1$\n -w $ARG2$ -c $ARG3$ -l $ARG4$\n}\n```", "```\ncheck_snmp! *oid! warn! critical !prefix*\n```", "```\ndefine service{\n   service_description    SNMP-DISK-a\n   host_name              swobspace\n **check_command check_snmp!dskTable.dskEntry.dskPercent.2!0:90!0:95!DIS**\n **K: /net/swobspace/a**\n...\n}\n```", "```\nnagios@linux:local/libexec$ ./**check_snmp -H localhost -C public \\ -o\n lmTempSensorsValue.1 -w 25000:45000 -c 20000:48000 \\ -u 'degrees Celsius (* 1000)'\n -l 'Temp1/CPU'**\n     Temp1/CPU OK - 41000 degrees Celsius (* 1000)\n```", "```\nnagios@linux:local/libexec$ ./**check_snmp -H localhost -C public \\ -o system.sysName.0\n -r swobspace**\n     SNMP OK - \"swobspace\"\n```", "```\nnagios@linux:local/libexec$ **./check_snmp -H cisco1 -C public** \\\n**-o ifOperStatus.1 -w 1:1 -l 'SNMP: Port Status for Port 1 is: '**\nSNNP: Port Status for Port 1 is: OK - 1\n```", "```\nuser@linux:~$ **snmpwalk -v1 -c public konica01 system**\nsystem.sysDescr.0 = Konica IP Controller\nsystem.sysObjectID.0 = OID: enterprises.2364\n...\n```", "```\nuser@linux:~$ **snmpwalk -v1 -c public konica01 enterprises.2364**\n...\nenterprises.2364.1.2.6.1.1.5.1.1 = \"Ready to Print\"\n...\n```", "```\nuser@linux:~$ **snmpwalk -v1 -c public cisco01 ifType**\n...\ninterfaces.ifTable.ifEntry.ifType.12 = ethernetCsmacd(6)\ninterfaces.ifTable.ifEntry.ifType.13 = other(1)\ninterfaces.ifTable.ifEntry.ifType.14 = propVirtual(53)\n...\n```", "```\nnagios@linux:local/libexec$ **./check_ifstatus -C public -H cisco01** \\\n **-x 1,53**\nCRITICAL: host 'cisco01', interfaces up: 2, down: 10, dormant: 0,\nexcluded: 4, unused: 0<BR>GigabitEthernet0/2: down\n<BR>GigabitEthernet0/3: down <BR>GigabitEthernet0/4: down\n<BR>GigabitEthernet0/10: down <BR>GigabitEthernet0/5: down\n<BR>GigabitEthernet0/11: down <BR>GigabitEthernet0/6: down\n<BR>GigabitEthernet0/7: down <BR>GigabitEthernet0/8: down\n<BR>GigabitEthernet0/9: down <BR> |up=2, down=10, dormant=0, excluded=4, unu\nsed=0\n```", "```\ndefine command{\n    command_name **check_ifstatus**\n    command_line $USER1$/**check_ifstatus** -H $HOSTADDRESS$ -C\n        $USER3$\n -x $ARG1$\n}\n```", "```\ndefine service{\n   service_description   Interfaces\n   host_name             cisco01\n**check_command         check_ifstatus!1, 53**\n   ...\n}\n```", "```\n...\ninterfaces.ifTable.ifEntry.ifDescr.3 = ipsec0\ninterfaces.ifTable.ifEntry.ifDescr.4 = ipsec1\n\n...\ninterfaces.ifTable.ifEntry.ifDescr.7 = eth0\ninterfaces.ifTable.ifEntry.ifDescr.8 = eth1\ninterfaces.ifTable.ifEntry.ifDescr.9 = eth2\ninterfaces.ifTable.ifEntry.ifDescr.10 = ppp0\n```", "```\nnagios@linux:local/libexec$ **./check_ifoperstatus -H igate -c public \\**\n **-d eth0**\nOK: Interface eth0 (index 7) is up.\n```", "```\ndefine command{\n    command_name **check_ifoperstatus**\n    command_line $USER1$/**check_ifoperstatus** -H $HOSTADDRESS$ -C $USER\n3$ -d $ARG1$\n}\n```", "```\ndefine service{\n   service_description   Interface eth0\n   host_name             igate\n**check_command         check_ifoperstatus!eth0**\n}\n```", "```\nnagios@linux:local/libexec$ **./check_snmp_disk -H swobspace -C public**\n/data: less than 50% free (= 95%) (/dev/md6)\n```", "```\nnagios@linux:local/libexec$ **./check_snmp_proc -H localhost -C public**\nNo slapd process running.\n```", "```\ndefine command{\n    command_name **check_snmp_proc**\n    command_line      $USER1$/**check_snmp_proc** -H $HOSTADDRESS$ -C $USER3$\n}\n\ndefine command{\n    command_name  **check_snmp_disk**\n    command_line       $USER1$/**check_snmp_disk** -H $HOSTADDRESS$ -C $USER3$\n}\n```", "```\ndefine service{\n   service_description   DISK\n   host_name             linux01\n**check_command         check_snmp_disk**\n   ...\n}\n```", "```\nnagios@linux:local/libexec$ **./check_iftraffic.pl -H linux01 -i etho \\**\n**-b 100 -u m**\nTotal RX Bytes: 60.32 MB, Total TX Bytes: 26.59 MB<br> Average Traffic:\n1.14 kB/s (0.0%) in, 777.93 B/s (0.0%) out | inUsage=0.0,85,98 outUsage\n=0.0,85,98\n```", "```\ndefine command{\n    command_name **check_iftraffic**\n    command_line      $USER1$/**check_iftraffic.pl** -H $HOSTADDRESS$ -C $USER3$\n-i $ARG1$ -b $ARG2$ -u m\n}\n```", "```\ndefine service{\n   service_description   Traffic load eth0\n   host_name             linux01\n**check_command         check_iftraffic!eth0!100**\n   ...\n   max_check_attempts    1\n   normal_check_interval 5\n   retry_check_interval  5\n   ...\n}\n```", "```\nuser@linux:~$ **snmpwalk -v1 -c public swobspace hrStorageDescr**\nhrStorageDescr.2 = STRING: Real Memory\nhrStorageDescr.3 = STRING: Swap Space\nhrStorageDescr.4 = STRING: /\n...\nhrStorageDescr.11 = STRING: /net/swobspace/b\n```", "```\nnagios@linux:local/libexec$ **./check_snmp_storage.pl -H swobspace \\**\n **-C public -m /net/swobspace/b -w 90 -c 95**\n/net/swobspace/b : 91 %used (34842MB/38451MB) (< 90) : WARNING\nnagios@linux:local/libexec$ **./check_snmp_storage.pl -H swobspace \\**\n **-C public -m \"Swap\" -w 50 -c 75 -f**\nSwap Space : 0 %used (0MB/3906MB) (< 50) : OK | 'Swap Space'=0MB;1953;\n2930;0;3906\n```", "```\nnagios@linux:local/libexec$ **./check_snmp_load.pl -H swobspace \\**\n **-C public -w 1,2,3 -c 3,5,6 -L**\nLoad : 0.05 0.07 0.06 : OK\nnagios@linux:local/libexec$ **./check_snmp_load.pl -H swobspace \\**\n**-C public -N -w 80 -c 90 -f**\nCPU used 3.0 : < 80 : OK | cpu_prct_used=3%;80;90\n```", "```\nenable_notifications=1\n```", "```\nnotifications_enabled=1\n```", "```\nnotification_options=c,r\n```", "```\nnotification_period=24x7h\n```", "```\nnotification_interval=120\n```", "```\nfirst_notification_delay=15\n```", "```\ncontact_group=admins\n```", "```\n# -- /etc/nagios/global/contactgroups.cfg\ndefine contactgroup{\n    contactgroup_name  admins\n    alias              administrators\n **members**     **nagios,wob,mwi**\n}\n```", "```\nhost_notification_options=d,u,r\nservice_notification_options=c,r,u\n```", "```\nhost_notifications_enabled=1\nservice_notifications_enabled=1\n```", "```\nhost_notification_period=24x7\nservice_notification_period=workhours\n```", "```\ndefine contactgroup{\n **contactgroup_name   admins**\n    alias               Local Site Administrators\n **members             wob**\n}\n```", "```\ndefine service{\n   host_name                  linux01\n   service_description        PING\n   check_command              check_ping!100.0,20%!500.0,60%\n   max_check_attempts         3\n   normal_check_interval      2\n   retry_check_interval       1\n   check_period               24x7\n**notification_interval      0**\n**notification_period        workhours**\n**notification_options       w,u,c,r,f**\n**contact_groups             admins**\n}\n```", "```\ndefine contact{\n   **contact_name                 wob**\n   alias                        Wolfgang\n   host_notification_period     24x7\n   host_notification_options    d,u,r\n   **service_notification_period  24x7**\n   **service_notification_options w,u,c,r,f**\n}\n```", "```\ndefine service{\n   ...\n**notification_interval    120**\n**notification_period      24x7**\n**notification_options     w,u,c,r,f**\n   ...\n}\n```", "```\ndefine contact{\n   ...\n**service_notification_period     workhours**\n**service_notification_options    c,r**\n   ...\n}\n```", "```\ndefine contact{\n   ...\n   service_notification_commands   notify-by-email,notify-by-sms\n   host_notification_commands      host-notify-by-email,host-notify-by-sms\n   email                           nagios-admin@localhost\n   pager                           +49-1234-56789\naddress1                root@example.com\n    address2                123-456789\n   ...\n}\n```", "```\ndefine command{\n   command_name        notify-by-email\n   command_line        /usr/bin/printf \"%b\" \"***** Nagios *****\\n\\n Notificat\nion Type: $NOTIFICATIONTYPE$\\n\\nService: $SERVICEDESC$\\nHost: $HOSTALIAS\n$\\nAddress: $HOSTADDRESS$\\nState: $SERVICESTATE$\\n\\nDate/Time: $LONGDATE\nTIME$\\n\\nAdditional Info:\\n\\n$SERVICEOUTPUT$\" | /usr/bin/mail -s \"** $N\nOTIFICATIONTYPE$ alert - $HOSTALIAS$/$SERVICEDESC$ is $SERVICESTATE$ **\"\n$CONTACTEMAIL$\n}\n```", "```\nprintf *text* | mail -s *\"subject\" e-mail_address*\n```", "```\nTo: wob@swobspace.de\nSubject: ** PROBLEM alert - mail-WOB/SMTP is CRITICAL **\nDate: Fri, 14 Jan 2005 16:22:47 +0100 (CET)\nFrom: Nagios Admin <nagios@swobspace.de>\n\n***** Nagios *****\n\nNotification Type: PROBLEM\n\nService: SMTP\nHost: mail-WOB\nAddress: 172.17.168.2\nState: CRITICAL\n\nDate/Time: Fri Jan 14 16:22:47 CET 2005\n\nAdditional Info:\n\nCRITICAL - Socket timeout after 10 seconds\n```", "```\n/usr/bin/printf \"%b\" \"***** Nagios *****\\n\\nNotification Type:\n$NOTIFICATIONTYPE$\\nHost: $HOSTNAME$\\nState: $HOSTSTATE$\\nAddress:\n$HOSTADDRESS$\\nInfo: $HOSTOUTPUT$\\n\\nDate/Time: $LONGDATETIME$\\n\" |\n/usr/bin/mail -s \"Host $HOSTSTATE$ alert for $HOSTNAME$!\" $CONTACTEMAIL$\n```", "```\nTo: wob@swobspace.de\nSubject: Host UP alert for wob-proxy!\nDate: Fri, 14 Jan 2005 17:50:21 +0100 (CET)\nFrom: Nagios Admin <nagios@swobspace.de>\n\n***** Nagios *****\n\nNotification Type: RECOVERY\nHost: wob-proxy\nState: UP\nAddress: 172.17.168.19\nInfo: PING OK - Packet loss = 0%, RTA = 69.10 ms\n\nDate/Time: Fri Jan 14 17:50:21 CET 2005\n```", "```\nlinux:~ **# cd /usr/local/src**\nlinux:local/src **# tar xvzf /*path*/to/sms_client-2.x.y**\nlinux:local/src **# cd ./sms_client-2.x.y**\nlinux:src/sms_client-2.x.y **# ./configure**\nlinux:src/sms_client-2.x.y **# make && make install**\n```", "```\nSMS_default_service = \"d1\"\n```", "```\nMDM_lock_dir          = \"/var/lock\"    # directory for the lock files\nMDM_device            = \"ttyI0\"        # device name of the modem\n...\nMDM_command_prefix    = \"AT\"\nMDM_init_command      = \"Z&E<MSN>\"\nMDM_dial_command      = \"D\"\nMDM_number_prefix     = \"0\"            # outside line, if required\n...\n```", "```\nlinux:~ **# touch /var/log/smsclient.log**\nlinux:~ **# chgrp dialout /usr/bin/sms_client**\nlinux:~ **# chgrp dialout /dev/ttyI0 /var/log/smsclient.log**\nlinux:~ **# chmod 2755 /usr/bin/sms_client**\nlinux:~ **# chmod 664 /dev/ttyI0 /var/log/smsclient.log**\n```", "```\nnagios@linux:~$ **sms_client 01604711 \"Text\"**\nDialing SMSC 01712521002...\nWARNING: read() Timeout\nConnection Established.\nLogin...\nSMSC Acknowledgment received\nLogin successful\nReady to receive message\nReceived Message Response: Message 3003123223 send successful - message\nsubmitted for processing<CR>\nSuccessful message submission\nDisconnect...\nDisconnected from SMSC\nHangup...\nd1 Service Time: 17 Seconds\n[000] d1:01604711 \"Text\"\nTotal Elapsed Time: 17 Seconds\n```", "```\nnagios@linux:~$ **/bin/printf \"%b\"** *message* | sms_client *number*\n```", "```\n# 'notify-by-sms' command definition\ndefine command{\ncommand_name     notify-by-sms\n   command_line     /usr/bin/printf \"%.150s\" \"$NOTIFICATIONTYPE$ $HOSTNAM\n E$[$HOSTADDRESS$]/$SERVICEDESC$ is $SERVICESTATE$ /$SHORTDATETIME$/ $SER\n VICEOUTPUT$\" | /usr/bin/smsclient $CONTACTPAGER$\n\n}\n```", "```\nPROBLEM elimail[172.17.130.1]/UPS is CRITICAL /2005-03-30 17:00:53/ Connection refused\n```", "```\ndefine service{\n    host_name                linux01\nservice_description      Database\n    notification_period      24x7\n    notification_interval    120\n    ...\n    contact_groups           admins\n}\n```", "```\ndefine serviceescalation{\n    host_name             linux01\n    service_description   Database\n    first_notification    4\n    last_notification     10\n    notification_interval 60\n    contact_groups        admins, second-level\n}\n```", "```\ndefine serviceescalation{\n    host_name              linux01\n    service_description    Database\n    first_notification     8\n    last_notification      12\n    notification_interval  90\n    contact_groups         third-level\n}\n```", "```\nnagios@linux:~$ **/usr/local/nagios/libexec/check_nrpe -H linux01**\nNRPE v2.0\n```", "```\ndefine command{\n    command_name     test_nrpe\n    command_line $USER1$/check_nrpe -H $HOSTADDRESS$\n}\n```", "```\ndefine service{\n    host_name              linux01\n    service_description    NRPE\n    check_command          test_nrpe\n    ...\n}\n```", "```\ndefine servicedependency{\n    host_name                        linux01\n    service_description              NRPE\n    dependent_host_name              linux01\n    dependent_service_description    Disks, Users, Load\n    notification_failure_criteria    c, u\n    execution_failure_criteria       n\n}\n```", "```\ndefine servicedependency{\n    host_name                       linux04\n    service_description             SNMP\n    dependent_host_name             linux04\n    dependent_service_description   Disks\n    notification_failure_criteria   c, u\n    execution_failure_criteria      c, u\n}\n\ndefine servicedependency{\n    host_name                         linux01\n    service_description               NRPE\n    dependent_host_name               linux04\n    dependent_service_description     SNMP\n    notification_failure_criteria     c, u\n    execution_failure_criteria        c, u\n}\n```", "```\ninherits_parent                  1\n```", "```\nuser@linux:~$ **ls -lF /var/nagios/rw**\nprw-rw---- 1 nagios nagcmd 0 Dec 19 10:56 nagios.cmd|\n```", "```\n[*timestamp*] *command;arguments*\n```", "```\n# /etc/nagios/nagios.cfg\n...\ncheck_external_commands=1\ncommand_check_interval=-1\ncommand_file=/var/nagios/rw/nagios.cmd\n...\n```", "```\n# /etc/nagios/nagios.cfg\n...\naccept_passive_service_checks=1\n...\n```", "```\ndefine service{\n    host_name                             linux01\n    service_description                   Disks\n    passive_checks_enabled                1\n    active_checks_enabled                 0\n    check_command                         check_dummy\n    check_period                          none\n    ...\n}\n```", "```\n[*timestamp*] PROCESS_SERVICE_CHECK_RESULT; *host-name;service;*\n*return value; plugin output*\n```", "```\nuser@linux:~$ **date +%s**\n1112435763\n```", "```\n#!/bin/bash\nEXTCMDFILE=\"/var/nagios/rw/nagios.cmd\"\nTIME='date +%s'\nHOST=$1\nSRV=$2\nRESULT=$3\nOUTPUT=$4\nCMD=\"[$TIME] PROCESS_SERVICE_CHECK_RESULT;$HOST;$SRV;$RESULT;$OUTPUT\"\n\n/bin/echo $CMD >> $EXTCMDFILE\n```", "```\n*name_of_script* linux01 Disks 0 'Disks ok: everything in order :-)'\n```", "```\n# /etc/nagios/nagios.cfg\n...\naccept_passive_host_checks=1\n...\n```", "```\ndefine host{\n    host_name                       linux01\n    passive_checks_enabled          1\n    active_checks_enabled           0\n    check_period                    none\n    check_command                   check_dummy\n    ...\n}\n```", "```\n[*timestamp*] PROCESS_HOST_CHECK_RESULT;*hostname;return value; plugin output*\n```", "```\n# /etc/nagios/nagios.cfg\n...\ncheck_service_freshness=1\nservice_freshness_check_interval=60\ncheck_host_freshness=0\nhost_freshness_check_interval=60\n...\n```", "```\ndefine service{\n    host_name                 linux01\n    service_description       Disks\n    passive_checks_enabled    1\n    active_checks_enabled     0\n    check_freshness           1\n    freshness_threshold       3600\n    check_command             service_is_stale\n    ...\n}\n```", "```\n#!/bin/bash\n/bin/echo \"CRITICAL: no current results of the service\"\nexit 2\n```", "```\ndefine command{\n   command_name         service_is_stale\n   command_line         $USER1$/service_is_stale.sh\n}\n```", "```\nlinux:local/src # **tar xvzf**/path/to/**nsca-2.7.2.tar.gz**\n...\nlinux:local/src # **cd nsca-2.7.2**\nlinux:src/nsca-2.7.2 # **./configure --sysconfdir=/etc/nagios \\**\n**--localstatedir=/var/nagios**\n...\n******* Configuration summary for nsca 2.7.2 07-03-2007 *******:\n\n General Options:\n --------------------------\n NSCA port: 5667\n NSCA user: nagios\n NSCA group: nagios\n...\n```", "```\nlinux:src/nsca-2.7.2 # **cp src/nsca /usr/local/sbin/**.\nlinux:src/nsca-2.7.2 # **scp src/send_nsca** remote host**: /usr/local/bin/**.\n```", "```\nlinux:src/nsca-2.7.2 # **cp nsca.cfg /etc/nagios/**.\nlinux:src/nsca-2.7.2 # **scp send_nsca.cfg** remote_host**: /etc/nagios/**.\n```", "```\n# /etc/nagios/nsca.cfg\nserver_port=5667\nserver_address=192.168.1.1\nallowed_hosts=127.0.0.1\nnsca_user=nagios\nnsca_group=nagios\ndebug=0\ncommand_file=/var/nagios/rw/nagios.cmd\nalternate_dump_file=/var/nagios/rw/nsca.dump\naggregate_writes=0\nappend_to_file=0\nmax_packet_age=30\npassword=verysecret\ndecryption_method=10\n```", "```\nlinux:/etc/nagios # **chown nagios.nagios nsca.cfg**\nlinux:/etc/nagios # **chmod 400 nsca.cfg**\n```", "```\nnsca 5667/tcp # Nagios Service Check Acceptor (NSCA)\n```", "```\n# /etc/xinetd.d/nsca\n# description: NSCA\n# default: on\nservice nsca\n{\n   flags           = REUSE\n   socket_type     = stream\n   wait            = no\n   user            = **nagios**\n   group           = **nagios**\n   server          = **/usr/local/sbin/nsca**\n   server_args     = -c **/etc/nagios/nsca.cfg** --inetd\n   log_on_failure  += USERID\n   disable         = no\n   only_from       = **127.0.0.1** ip1 ip2... *ipn*\n}\n```", "```\nlinux:~ # **/etc/init.d/xinetd reload**\n```", "```\nnsca stream tcp nowait **nagios** /usr/sbin/tcpd\n **/usr/local/sbin/nsca** -c **/etc/nagios/nsca.cfg** --inetd\n```", "```\nlinux:~ # **/etc/init.d/inetd reload**\n```", "```\npassword=verysecret\ndecryption_method=10\n```", "```\nlinux:~ # **groupadd -g 9000 nagios**\nlinux:~ # **useradd -u 9000 -g nagios -d /usr/local/nagios** \\\n **-c \"Nagios Admin\" nagios**\n```", "```\nlinux:~ # **chown nagios.nagios /etc/nagios/send_nsca.cfg**\nlinux:~ # **chown nagios.nagios /usr/bin/send_nsca**\nlinux:~ # **chmod 400 /etc/nagios/send_nsca.cfg**\nlinux:~ # **chmod 4710 /usr/bin/send_nsca**\nlinux:~ # **ls -l /usr/bin/send_nsca**\n-rws--x--- 1 nagios nagios 83187 Apr 2 17:56 /usr/local/bin/send_nsca\n```", "```\n*host-name\\tservice\\treturn value\\toutput*\n*host-name\\treturn value\\toutput*\n```", "```\n#!/bin/bash\nCFG=\"/etc/nagios/send_nsca.cfg\"\nCMD=\"linux01;nmbd;3;UNKNOWN - just one NSCA test\"\n\n/bin/echo $CMD | /usr/local/bin/send_nsca -H nagios -d ';' -c $CFG\n```", "```\nnagios@linux:~$ **bash./test_nsca**\n1 data packet(s) sent to host successfully.\n```", "```\n# /etc/syslog-ng/syslog-ng.conf\nsource local {\n   unix-stream(\"/dev/log\");\n   internal();\n   file(\"/proc/kmsg\" log_prefix(\"kernel: \"));\n};\n\ndestination console_10 {\n   file(\"/dev/tty10\");\n};\n\nfilter f_messages {\n   not facility(auth, authpriv) and\n   level(info.. alert);\n};\n\nlog {\n   source(local);\n   filter(f_messages);\n   destination(console_10);\n};\n```", "```\nlog {\n   source1); *source2*;...\n *filter1; filter2*;...\n *destination1*; *destination2*;...\n}\n```", "```\ndestination d_nagios_warn {\n   program(\"/usr/local/nagios/misc/send_syslog.sh\"\n   template(\"$HOST;syslog-ng;1;WARNING: $MSG\\n\") template_escape(no));\n};\n\ndestination d_nagios_crit {\n   program(\"/usr/local/nagios/misc/send_syslog.sh\"\n   template(\"$HOST;syslog-ng;2;CRITICAL: $MSG\\n\") template_escape(no));\n};\n```", "```\n#!/bin/bash\nwhile read -r line; do\n    echo $line | /usr/bin/send_nsca -H nagsrv -d ';' \\\n              -c /etc/nagios/send_nsca.cfg \\\n               1>/usr/local/nagios/var/send_syslog.log 2>&1\ndone\n```", "```\ndefine service{\n    host_name               linux01\n    service_description     syslog-ng\n  **active_checks_enabled   0**\n  **passive_checks_enabled  1**\n  **check_freshness         0**\n  **is_volatile             1**\n  **max_check_attempts      1**\n    normal_check_interval   1\n    retry_check_interval    1\n    check_command           check_dummy!3!active check\n    check_period            none\n    contact_groups          localadmins\n    notification_options    w,c,u\n    notification_interval   480\n    notification_period     24x7\n}\n```", "```\ntraphandle *oid program*\ntraphandle *oid program arguments*\ntraphandle default *program*\ntraphandle default *program arguments*\n```", "```\n*hostname*\n*ip-address*\n*oid value*\n...\n```", "```\n# snmptrapd.conf\ntraphandle SNMPv2-MIB::coldStart /usr/local/nagios/libexec/eventhandler/\nhandle-trap SNMP cold-start\ntraphandle NET-SNMP-AGENT-MIB::nsNotifyRestart /usr/local/nagios/libexec\n/eventhandler/handle-trap SNMP restart\ntraphandle NET-SNMP-AGENT-MIB::nsNotifyShutdown /usr/local/nagios/libexe\nc/eventhandler/handle-trap SNMP shutdown\ntraphandle default /usr/local/nagios/libexec/eventhandler/handle-trap SN\nMP unknown\n```", "```\n# snmpd.conf\ntrapsink *name_or_ip_of_the_nagios-server*\n```", "```\n#!/bin/bash\n\nNAGIOS=\"nagsrv\"\nLOGFILE=\"/usr/local/nagios/var/handle-trap.log\"\n\nread HOST && echo \"host: $HOST\" >> $LOGFILE\nread IPADDR && echo \"ip: $IPADDR\" >> $LOGFILE\n\ncase $IPADDR in\n   192.168.201.4)\n      HOSTNAME=\"irouter\"\n   ;;\n   *)\n      # silent discard from unknown hosts\n      exit 0\n   ;;\nesac\n\nif [ -z \"$1\" ]; then\n   echo \"usage: $0 <service> <key>\"\n   echo \"usage: $0 <service> <key>\" >> $LOGFILE\n   exit 1\nelse\n   SERVICE=\"$1\"\nfi\n\nif [ ! -z \"$2\" ]; then\n   SWITCH=\"$2\"\nfi\n\ncase $SWITCH in\n   \"cold-start\")\n      OUTPUT=\"snmpd: Cold Start\"\n      STATE=0\n   restart)\n      OUTPUT=\"snmpd: Restart\"\n      STATE=1\n      ;;\n   shutdown)\n      OUTPUT=\"snmpd: Shutdown\"\n      STATE=2\n      ;;\n   *)\n      OUTPUT=\"Unknown Trap\"\n      STATE=1\n      ;;\nesac\n\nCMD=\"$HOSTNAME;$SERVICE;$STATE;$OUTPUT\"\n\necho \"$CMD\" >> $LOGFILE\n\necho \"$CMD\" | /usr/bin/send_nsca -H $NAGIOS -d ';' \\\n              -c /etc/nagios/send_nsca.cfg >> $LOGFILE 2>&1\n```", "```\ndefine service{\n    host_name                    irouter\n    service_description          SNMP\n **active_checks_enabled  0**\n **passive_checks_enabled 1**\n **check_freshness        0**\n **max_check_attempts     1**\n    is_volatile                   1\n   ...\n}\n```", "```\n# /etc/nagios/nagios.cfg\n...\nobsess_over_services=1\nocsp_command=submit_service_check\nocsp_timeout=5\nobsess_over_hosts=1\nochp_command=submit_host_check\nochp_timeout=5\n```", "```\ndefine host{\n  ...\n   obsess_over_hosts=0\n  ...\n}\n\ndefine service{\n  ...\n   obsess_over_services=0\n  ...\n}\n```", "```\n#!/bin/bash\n# Script submit_service_check\n\nPRINTF=\"/usr/bin/printf\"\nCMD=\"/usr/local/bin/send_nsca\"\nCFG=\"/etc/nagios/send_nsca.cfg\"\nHOST=$1\nSRV=$2\nRESULT=$3\nOUTPUT=$4\n\n$PRINTF \"%b\" \"$HOST\\t$SRV\\t$RESULT\\t$OUTPUT\\n\" | $CMD -H nagios -c $CFG\n```", "```\n#!/bin/bash\n# Script submit_host_check\n\nPRINTF=\"/usr/bin/printf\"\nCMD=\"/usr/local/bin/send_nsca\"\nCFG=\"/etc/nagios/send_nsca.cfg\"\nHOST=$1\nRESULT=$2\nOUTPUT=$3\n\n$PRINTF \"%b\" \"$HOST\\t$RESULT\\t$OUTPUT\\n\" | $CMD -H nagios -c $CFG\n```", "```\ndefine command{\n    command_name submit_service_check\n    command_line **$USER1$/eventhandlers/submit_service_check** $HOSTNAME$ '$\n SERVICEDESC$' $SERVICESTATEID$ '$SERVICEOUTPUT$'\n\ndefine command{\n   command_name submit_host_check\n   command_line **$USER1$/eventhandlers/submit_host_check** $HOSTNAME$ $HO STSTATEID$\n '$HOSTOUTPUT$'\n```", "```\n/etc/nagios/global\n/etc/nagios/local\n/etc/nagios/sites\n/etc/nagios/sites/bonn\n/etc/nagios/sites/Frankfurt\n/etc/nagios/sites/berlin\n...\n```", "```\n# -- /etc/nagios/nagios.cfg\n...\ncfg_dir=/etc/nagios/global\ncfg_dir=/etc/nagios/local\ncfg_dir=/etc/nagios/sites\n...\n```", "```\n# -- /etc/nagios/sites/bonn/services.cfg\ndefine service{\n    host_name            bonn01\n    service_description  HTTP\n  **use        bonn-svc-template**\n   ...\n    check_command                      check_http\n   ...\n}\n```", "```\n# -- On-Site configuration for the Bonn location\ndefine service{\n    name               bonn-svc-template\n    register           0\n  **max_check_attempts     3**\n  **normal_check_interval  5**\n  **retry_check_interval   1**\n  **active_checks_enabled  1**\n    passive_checks_enabled           1\n  **check_period            24×7**\n  **obsess_over_services     1**\n    notification_interval              0\n    notification_period                none\n    notification_options               n\n  **notifications_enabled    0**\n    contact_groups                     dummy\n}\n```", "```\n# -- Service template for the central Nagios server\ndefine service{\n    name            bonn-svc-template\n    register        0\n\n    max_check_attempts            3\n    normal_check_interval         5\n    retry_check_interval          1\n    active_checks_enabled         0\n **passive_checks_enabled     1**\n **check_period           none**\n **check_freshness        0**\nobsess_over_services   0\n**notification_interval 480**\n **notification_period   24×7**\n **notification_options u,c,r**\n **notifications_enabled 1**\n **contact_groups        admins**\n}\n```"]