<html><head></head><body>

<div class="calibre1"><div class="calibre1"><a name="openldap_server_2.3.38" class="calibre8" id="openldap_server_2.3.38"/>
<div class="calibre24" id="calibre_pb_0"/><h2 id="title-ID0EUPPM" class="docPrefaceTitle">Chapter 16. OPENLDAP SERVER 2.3.38</h2>
<h4 class="calibre32"><a class="calibre2" target="_blank" href="HTTP://OPENLDAP.ORG">HTTP://OPENLDAP.ORG</a></h4>
<a name="summary-id15" class="calibre8" id="summary-id15"/>
<h3 class="docSection1Title" id="-100000">16.1. SUMMARY</h3>
<p class="docText1"><span class="docEmphasis1"><a name="LDAP " class="calibre8" id="LDAP "/>LDAP (Lightweight Directory Access Protocol)</span><a name="protocol used" class="calibre8" id="protocol used"/> is a TCP-based protocol used to access directory services. <span class="docEmphasis1">Directory services</span><a name="other users" class="calibre8" id="other users"/> provide users with information about other users and resources within a network (usually in the form of address book entries). Entries are stored in a central database and accessed from an LDAP server (OpenLDAP, Windows Server Active Directory, etc.) via an LDAP-capable client (Microsoft Outlook, Mozilla Thunderbird, etc.).<a name="IDX-CHP-16-0237" class="calibre8" id="IDX-CHP-16-0237"/><a name="IDX-CHP-16-0238" class="calibre8" id="IDX-CHP-16-0238"/><a name="IDX-CHP-16-0239" class="calibre8" id="IDX-CHP-16-0239"/><a name="IDX-CHP-16-0240" class="calibre8" id="IDX-CHP-16-0240"/><a name="IDX-CHP-16-0241" class="calibre8" id="IDX-CHP-16-0241"/><a name="IDX-CHP-16-0242" class="calibre8" id="IDX-CHP-16-0242"/><a name="IDX-CHP-16-0243" class="calibre8" id="IDX-CHP-16-0243"/><a name="IDX-CHP-16-0244" class="calibre8" id="IDX-CHP-16-0244"/><a name="IDX-CHP-16-0245" class="calibre8" id="IDX-CHP-16-0245"/><a name="IDX-CHP-16-0246" class="calibre8" id="IDX-CHP-16-0246"/><a name="IDX-CHP-16-0247" class="calibre8" id="IDX-CHP-16-0247"/><a name="IDX-CHP-16-0248" class="calibre8" id="IDX-CHP-16-0248"/><a name="IDX-CHP-16-0249" class="calibre8" id="IDX-CHP-16-0249"/></p>
<p class="docText1"><a name="with the" class="calibre8" id="with the"/>OpenLDAP complies with the X.500 series of directory services standards developed by the ITU-T (the standards division of the International Telecommunication Union). This provides LDAP interoperability between X.500-based applications.</p>
<p class="docText1"><a name="LDAP entries" class="calibre8" id="LDAP entries"/>As per the X.500 standard, LDAP entries are stored in a hierarchal format consisting of sets of attributes within directory entries:</p>
<pre class="calibre30">-DOMAIN COMPONENT (.com)
  -DOMAIN COMPONENT (example)
    -ORGANIZATIONAL UNIT (People)
      -USER ID (jdoe)
        -TELEPHONENUMBER (phone number)
        -GIVENNAME (doe)</pre>
<p class="docText1"><a name="Yeong in" class="calibre8" id="Yeong in"/>LDAP was created by Tim Howes, Steve Kille, and Wengyik Yeong in 1992. It started as a project to provide directory services alongside the University of Michigan's email system.<a name="IDX-CHP-16-0250" class="calibre8" id="IDX-CHP-16-0250"/></p>
<p class="docText1"><a name="to provide" class="calibre8" id="to provide"/>A company named Net Boolean Inc. was formed to provide email services for businesses in early 1998. Available commercial LDAP implementations were too expensive for this young company. Net Boolean created Boolean LDAP from open source LDAP software made available by the University of Michigan. Kurt Zeilenga of Net Boolean later founded the OpenLDAP Foundation and the project in August of 1998. Current OpenLDAP development consists of a core team that includes founder Kurt Zeilenga, Howard Chu, and Pierangelo Masarati.</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="resources-id15" class="calibre8" id="resources-id15"/>
<h3 class="docSection1Title" id="-100000">16.2. RESOURCES</h3>
<p class="docText1"><span class="b"><a name="OpenLDAP " class="calibre8" id="OpenLDAP "/>OpenLDAP 2.3 Administrator's Guide</span></p>
<p class="docText1"><a class="calibre2" target="_blank" href="http://www.openldap.org/doc/admin23">http://www.openldap.org/doc/admin23</a></p>
<p class="docText1"><span class="b"><a name="Directory Access" class="calibre8" id="Directory Access"/>RFC 4511 - Lightweight Directory Access Protocol</span></p>
<p class="docText1"><a class="calibre2" target="_blank" href="http://tools.ietf.org/html/rfc4511">http://tools.ietf.org/html/rfc4511</a></p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="required-id15" class="calibre8" id="required-id15"/>
<h3 class="docSection1Title" id="-100000">16.3. REQUIRED</h3>
<p class="docText1"><img border="0" id="" src="OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg" alt="" class="calibre33"/><a name="FreeBSD " class="calibre8" id="FreeBSD "/> FreeBSD 7.0-RELEASE (see "<a class="calibre2" href="freebsd_7.0_split_000.html#freebsd_7.0">FreeBSD 7.0</a>")</p>
<p class="docText1"><img border="0" id="" src="OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg" alt="" class="calibre33"/><a name="collection " class="calibre8" id="collection "/> Updated ports collection (see "<a class="calibre2" href="freebsd_ports_collection.html#freebsd_ports_collection">FreeBSD Ports Collection</a>")</p>
<p class="docText1"><img border="0" id="" src="OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg" alt="" class="calibre33"/> Internet connection</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="optional-id7" class="calibre8" id="optional-id7"/>
<h3 class="docSection1Title" id="-100000">16.4. OPTIONAL</h3>
<p class="docText1"><img border="0" id="" src="OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg" alt="" class="calibre33"/><a name="OpenSSL with" class="calibre8" id="OpenSSL with"/> OpenSSL with a signed SSL Certificate (see "<a class="calibre2" href="openssl_0.9.8g.html#openssl_0.9.8g">OpenSSL 0.9.8g</a>")<a name="IDX-CHP-16-0251" class="calibre8" id="IDX-CHP-16-0251"/><a name="IDX-CHP-16-0252" class="calibre8" id="IDX-CHP-16-0252"/></p>
<p class="docText1"><img border="0" id="" src="OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg" alt="" class="calibre33"/> Registered domain name</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="preparation-id15" class="calibre8" id="preparation-id15"/>
<h3 class="docSection1Title" id="-100000">16.5. PREPARATION</h3>
<p class="docText1"><a name="Become the" class="calibre8" id="Become the"/>Become the superuser.</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="install-id15" class="calibre8" id="install-id15"/>
<h3 class="docSection1Title" id="-100000">16.6. INSTALL</h3>
<p class="docText1"><a name="To begin" class="calibre8" id="To begin"/>To begin the OpenLDAP installation process, enter the following commands:</p>
<pre class="calibre30"># <b class="calibre28">cd /usr/ports/net/openldap23-server</b>
# <b class="calibre28">make config ; make install clean</b>
# <b class="calibre28">rehash</b></pre>
<p class="docText1"><a name="should appear" class="calibre8" id="should appear"/>A menu should appear displaying options for openldap-server. We will leave the options at their defaults; press [tab] to select <span class="b">OK</span><a name="the installation" class="calibre8" id="the installation"/> and then press [enter] to continue the installation process.</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="configure-id15" class="calibre8" id="configure-id15"/>
<h3 class="docSection1Title" id="-100000">16.7. CONFIGURE</h3>
<p class="docText1"><a name="Once the" class="calibre8" id="Once the"/>Once the installation process is complete, it's time to configure OpenLDAP for use on your system.</p>
<div class="calibre34"><ol class="docList" type="1"><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="an OpenLDAP" class="calibre8" id="an OpenLDAP"/>Set up an OpenLDAP root password. OpenLDAP stores the LDAP administrator's password in the main configuration file <span class="docEmphasis1">slapd.conf</span><a name="either as" class="calibre8" id="either as"/>. OpenLDAP can read this password either as plaintext or as a hash. A hash obscures the password with an algorithm so it isn't in plain view. The commands below will create an SSHA (Salted Secure Hash Algorithm) hash of your root password for OpenLDAP and insert it into <span class="docEmphasis1">slapd.conf</span>.</p><pre class="calibre30"># <b class="calibre28">cd /usr/local/etc/openldap</b>
# <b class="calibre28">sed -I .old 's/rootpw/# rootpw/' slapd.conf</b>
# <b class="calibre28">echo -n "rootpw " &gt;&gt; slapd.conf</b>
# <b class="calibre28">slappasswd &gt;&gt; slapd.conf</b></pre>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="few more" class="calibre8" id="few more"/>We'll make a few more modifications to the <span class="docEmphasis1">slapd.conf</span> file. Open <span class="docEmphasis1">slapd.conf</span>:</p><pre class="calibre30"># <b class="calibre28">ee /usr/local/etc/openldap/slapd.conf</b></pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="the" class="calibre8" id="the"/>Scroll down to the <tt class="calibre20">suffix</tt> declaration (~56). If your domain name is <a class="calibre2" target="_blank" href="http://example.com">example.com</a>, enter <tt class="calibre20">"dc=</tt><tt class="calibre20"><i class="docEmphasis1">example</i></tt><tt class="calibre20">,dc=</tt><tt class="calibre20"><i class="docEmphasis1">com</i></tt><tt class="calibre20">"</tt>. Proceed to the next entry, <tt class="calibre20">rootdn</tt>, and enter the same information, leaving the <tt class="calibre20">"cn=Manager"</tt><a name="for a" class="calibre8" id="for a"/> segment alone. The two lines would appear as follows for a domain named <a class="calibre2" target="_blank" href="http://example.com">example.com</a>:</p><pre class="calibre30">suffix          "dc=example,dc=com"
rootdn          "cn=Manager,dc=example,dc=com"</pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1">Scroll down to the bottom of <span class="docEmphasis1">slapd.conf</span> and add the following two lines:</p><pre class="calibre30">include       /usr/local/etc/openldap/schema/cosine.schema
include       /usr/local/etc/openldap/schema/inetorgperson.schema</pre><br class="calibre1"/>
<p class="docText1">These lines add support for the <tt class="calibre20">COSINE</tt> schema and the <tt class="calibre20">inetOrgPerson</tt> object class. <tt class="calibre20">COSINE</tt> and <tt class="calibre20">inetOrgPerson</tt><a name="are useful" class="calibre8" id="are useful"/> extend the core schema with attributes that are useful to organizations. Examples of additional attributes include employee numbers, room numbers, building names, and so on.</p><p class="docText1">For information on the <tt class="calibre20">COSINE</tt> schema, see <a class="calibre2" target="_blank" href="http://tools.ietf.org/html/rfc4524">http://tools.ietf.org/html/rfc4524</a>.</p><p class="docText1">For information on the <tt class="calibre20">inetOrgPerson</tt> object class, see <a class="calibre2" target="_blank" href="http://tools.ietf.org/html/rfc2798">http://tools.ietf.org/html/rfc2798</a>.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1">Add a simple access policy to keep the <tt class="calibre20">userPassword</tt><a name="the bottom" class="calibre8" id="the bottom"/> attribute from being displayed to other users. Add these lines to the bottom of <span class="docEmphasis1">slapd.conf</span>:</p><pre class="calibre30">access to attrs=userPassword
        by self write
        by anonymous auth
        by * none</pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="should have" class="calibre8" id="should have"/>Add another access policy for user information. Users should have write access to their own information and read-only access to other people's information. Anonymous users should have no access. Requests from the localhost should have read access. The lines should appear as follows:</p><pre class="calibre30">access to *
        by self write
        by users read
        by peername.ip=127.0.0.1 read
        by anonymous auth</pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="possess a" class="calibre8" id="possess a"/>If you possess a signed SSL Certificate and wish to enable secure LDAP connections using SSL, continue. Otherwise skip to step 8. The following declarations will tell the slapd program where to find your SSL Certificates.</p><div class="calibre1">
              Code View:</div><pre class="calibre30">TLSCACertificateFile <tt class="calibre20"><i class="docEmphasis1">/usr/local/openssl/certs/example.com-CAcert.pem</i></tt>
TLSCertificateFile <tt class="calibre20"><i class="docEmphasis1">/usr/local/openssl/certs/host.example.com-cert.pem</i></tt>
TLSCertificateKeyFile <tt class="calibre20"><i class="docEmphasis1">/usr/local/openssl/certs/host.example.com-unencrypted-key.pem</i></tt>
</pre><br class="calibre1"/>
<p class="docText1"><a name="Remember to" class="calibre8" id="Remember to"/>Remember to change the paths and filenames (in italics) to point to your server certificates and key file. Save and exit.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="an embedded" class="calibre8" id="an embedded"/>OpenLDAP uses an embedded database called Berkeley DB to store its data. The command below will copy the example database configuration file <span class="docEmphasis1">DB_CONFIG.example</span> to OpenLDAP's database path:</p><pre class="calibre30"># <b class="calibre28">cd /usr/local/etc/openldap</b>
# <b class="calibre28">cp DB_CONFIG.example /var/db/openldap-data/DB_CONFIG</b></pre><br class="calibre1"/>
</div></li></ol></div>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="testing-id10" class="calibre8" id="testing-id10"/>
<h3 class="docSection1Title" id="-100000">16.8. TESTING</h3>
<p class="docText1"><a name="In this" class="calibre8" id="In this"/>In this section, we'll perform some basic tests to confirm that OpenLDAP answers LDAP requests properly.<a name="IDX-CHP-16-0253" class="calibre8" id="IDX-CHP-16-0253"/></p>
<div class="calibre34"><ol class="docList" type="1"><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="the LDAP" class="calibre8" id="the LDAP"/>To start the LDAP server automatically at boot time, add these lines to the <span class="docEmphasis1">rc.conf</span> file located in <span class="docEmphasis1">/etc</span>. Open <span class="docEmphasis1">rc.conf</span>:</p><pre class="calibre30"># <b class="calibre28">ee /etc/rc.conf</b></pre>
<p class="docText1"><a name="to enable" class="calibre8" id="to enable"/>If you did not choose to enable secure LDAP connections with SSL, add the following lines:</p><pre class="calibre30">slapd_enable="YES"
slapd_flags='-h "ldapi://%2fvar%2frun%2fopenldap%2fldapi/ ldap:///"'
slapd_sockets="/var/run/openldap/ldapi"</pre><br class="calibre1"/>
<p class="docText1"><a name="chose to" class="calibre8" id="chose to"/>If you chose to enable secure LDAP connections with SSL, add the following lines:</p><pre class="calibre30">slapd_enable="YES"
slapd_flags='-h "ldapi://%2fvar%2frun%2fopenldap%2fldapi/\
 ldap:/// ldaps:///"'
slapd_sockets="/var/run/openldap/ldapi"
slapd_owner="root:ldap"</pre><br class="calibre1"/>
<p class="docText1"><a name="start the" class="calibre8" id="start the"/>Save and exit, then start the LDAP server:</p><pre class="calibre30"># <b class="calibre28">/usr/local/etc/rc.d/slapd start</b></pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="first import" class="calibre8" id="first import"/>Create data to import into the LDAP database. The first import to the LDAP database will consist of the domain and manager entries. Change to a working directory of your choice. Create a file named <span class="docEmphasis1">domainmgr.ldif</span>:</p><pre class="calibre30"># <b class="calibre28">ee domainmgr.ldif</b></pre><br class="calibre1"/>
<p class="docText1">Enter the following text into the blank file:</p><pre class="calibre30"># <b class="calibre28">Create Domain entry</b>
<b class="calibre28">dn: dc=</b><span class="docEmphBoldItalic">example</span><b class="calibre28">,dc=</b><span class="docEmphBoldItalic">com</span>
<b class="calibre28">objectclass: dcObject</b><b class="calibre28">objectclass:
organization</b>
<b class="calibre28">o:</b> <span class="docEmphBoldItalic">example.com</span>
<b class="calibre28">dc:</b> <span class="docEmphBoldItalic">example</span>

# <b class="calibre28">Create Manager entry</b>
<b class="calibre28">dn: cn=Manager,dc=</b>
<span class="docEmphBoldItalic">example</span><b class="calibre28">,dc=</b><span class="docEmphBoldItalic">com</span>
<b class="calibre28">objectclass: organizationalRole</b>
<b class="calibre28">cn: Manager</b></pre><br class="calibre1"/>
<p class="docText1">The LDAP abbreviations in use are:</p><dl class="docList2">
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">dn</pre></p></dt>
<dd class="calibre36"><p class="docText1">distinguished name</p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">dc</pre></p></dt>
<dd class="calibre36"><p class="docText1">domain component</p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">cn</pre></p></dt>
<dd class="calibre36"><p class="docText1">common name</p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">o</pre></p></dt>
<dd class="calibre36"><p class="docText1">organization</p></dd>
</dl><p class="docText1"><a name="must reflect" class="calibre8" id="must reflect"/>Substitute your domain name appropriately (items in italics must reflect your domain). Do not change any other parts of this file. The ldapadd utility we are going to run next is very specific about the syntax of LDIF (LDAP Data Interchange Format) files. Ensure that there are no extra spaces after the last letter of each line. The single blank line between the domain and manager entries is necessary. Save and exit.<a name="IDX-CHP-16-0254" class="calibre8" id="IDX-CHP-16-0254"/></p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1">Add the entries of <span class="docEmphasis1">domainmgr.ldif</span> to the LDAP database (substitute your domain name):</p><pre class="calibre30"># <b class="calibre28">ldapadd -x -D "cn=Manager,dc=</b><span class="docEmphBoldItalic">example</span><b class="calibre28">,dc=</b><span class="docEmphBoldItalic">com</span><b class="calibre28">" -W -f domainmgr.ldif -c</b></pre><br class="calibre1"/>
<p class="docText1"><a name="created in" class="calibre8" id="created in"/>You will be prompted for the LDAP root password you created in step 1 of "<a class="calibre2" href="configure-id15.html#configure-id15">Configure</a><a name="reopen" class="calibre8" id="reopen"/>". If the command completes without any errors, continue; otherwise reopen <span class="docEmphasis1">domainmgr.ldif</span><a name="and spacing" class="calibre8" id="and spacing"/>, check spelling and spacing, and run the command again.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="Create an" class="calibre8" id="Create an"/>Create an organizational unit to hold user entries. Create a file named <span class="docEmphasis1">people.ldif</span>:</p><pre class="calibre30"># <b class="calibre28">ee people.ldif</b></pre><br class="calibre1"/>
<p class="docText1"><a name="following text" class="calibre8" id="following text"/>Enter the following text into the blank file:</p><pre class="calibre30"># <b class="calibre28">Create Organizational Unit (People)</b>
<b class="calibre28">dn: ou=People,dc=</b><span class="docEmphBoldItalic">example</span><b class="calibre28">,dc=</b><span class="docEmphBoldItalic">com</span>
<b class="calibre28">objectclass: top</b>
<b class="calibre28">objectclass: organizationalUnit</b>
<b class="calibre28">ou: People</b></pre><br class="calibre1"/>
<p class="docText1"><a name="and be" class="calibre8" id="and be"/>Again, substitute your domain name (shown in italics) and be careful with spelling and spacing. Save and exit.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="entries of" class="calibre8" id="entries of"/>Add the entries of <span class="docEmphasis1">people.ldif</span><a name="database " class="calibre8" id="database "/> to the LDAP database (substitute your domain name):</p><pre class="calibre30"># <b class="calibre28">ldapadd -x -D "cn=Manager,dc=</b><span class="docEmphBoldItalic">example</span><b class="calibre28">,dc=</b><span class="docEmphBoldItalic">com</span><b class="calibre28">" -W -f people.ldif</b></pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="the organizational" class="calibre8" id="the organizational"/>Add a user to the LDAP database within the organizational unit you created. Create a file named <span class="docEmphasis1">user.ldif</span>:</p><pre class="calibre30"># <b class="calibre28">ee user.ldif</b></pre><br class="calibre1"/>
<p class="docText1">Enter the following text into the blank file:</p><pre class="calibre30"># <b class="calibre28">Create User Entry</b>
<b class="calibre28">dn: cn=</b><span class="docEmphBoldItalic">John Doe</span><b class="calibre28">,ou=People,dc=</b><span class="docEmphBoldItalic">example</span><b class="calibre28">,dc=</b><span class="docEmphBoldItalic">com</span>
<b class="calibre28">objectclass: inetOrgPerson</b>
<b class="calibre28">cn:</b> <span class="docEmphBoldItalic">John Doe</span>
<b class="calibre28">givenname:</b> <span class="docEmphBoldItalic">John</span>
<b class="calibre28">sn:</b> <span class="docEmphBoldItalic">Doe</span>
<b class="calibre28">mail:</b> <span class="docEmphBoldItalic">jdoe@example.com</span></pre><br class="calibre1"/>
<p class="docText1"><a name="the appropriate" class="calibre8" id="the appropriate"/>Replace the items shown in italics with the appropriate data. Save and exit.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="it to" class="calibre8" id="it to"/>Create a hashed password for this new user and append it to <span class="docEmphasis1">user.ldif</span>:</p><pre class="calibre30"># <b class="calibre28">echo -n "userPassword: " &gt;&gt; user.ldif</b>
# <b class="calibre28">slappasswd &gt;&gt; user.ldif</b></pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1">Add the entries of <span class="docEmphasis1">user.ldif</span> to the LDAP database (substitute your domain name):</p><pre class="calibre30"># <b class="calibre28">ldapadd -x -D "cn=Manager,dc=</b><span class="docEmphBoldItalic">example</span><b class="calibre28">,dc=</b><span class="docEmphBoldItalic">com</span><b class="calibre28">" -W -f user.ldif</b></pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="made it" class="calibre8" id="made it"/>Check that all of the above entries made it into the LDAP database successfully (substitute your domain name):</p><pre class="calibre30"># <b class="calibre28">ldapsearch -W -H ldap://localhost/ -D\</b>
? <b class="calibre28">cn=Manager,dc=</b><span class="docEmphBoldItalic">example</span><b class="calibre28">,dc=</b><span class="docEmphBoldItalic">com</span> <b class="calibre28">-b 'dc=</b><span class="docEmphBoldItalic">example</span><b class="calibre28">,dc=</b><span class="docEmphBoldItalic">com</span><b class="calibre28">'</b> <b class="calibre28">'
(objectclass=*)'</b></pre><br class="calibre1"/>
<p class="docText1"><a name="be prompted" class="calibre8" id="be prompted"/>You will be prompted for the manager password. Below is a sample of output from the <tt class="calibre20">ldapsearch</tt> command:</p><pre class="calibre30"># extended LDIF
#
# LDAPv3
# base &lt;dc=turbojets,dc=net&gt; with scope subtree
# filter: (objectclass=*)
# requesting: ALL
#

# example.com
dn: dc=example,dc=com
objectClass: dcObject</pre><br class="calibre1"/>
<pre class="calibre30">objectClass: organization
o: example.com
dc: example

# Manager, example.com
dn: cn=Manager,dc=example,dc=com
objectClass: organizationalRole
cn: Manager

# People, example.com
dn: ou=People,dc=example,dc=com
objectClass: top
objectClass: organizationalUnit
ou: People

# John Doe, People, example.com
dn: cn=John Doe,ou=People,dc=example,dc=com
objectClass: inetOrgPerson
cn: John Doe
givenName: John
sn: Doe
mail: jdoe@example.com
userPassword:: e1NTSEF9MTJTZkh1YkRQelI0ZG4wV3hlZUxqRkJFZ200UzQ0YnQ=</pre><br class="calibre1"/>
<hr size="1" noshade="noshade" class="calibre27"/><span><i class="docEmphasis1"><b class="calibre28">Note:</b></i> When logging into the LDAP server from an LDAP client you may need to enter "Base DN," "Bind DN," password, and hostname. Here is what to enter for "Base DN" and "Bind DN" (replace the italicized items appropriately):</span><hr size="1" noshade="noshade" class="calibre27"/><pre class="calibre30"><b class="calibre28">Base DN: dc=</b><span class="docEmphBoldItalic">example</span><b class="calibre28">,dc=</b><span class="docEmphBoldItalic">com</span>
<b class="calibre28">Bind DN: cn=</b><span class="docEmphBoldItalic">John Doe</span><b class="calibre28">,ou=People,dc=</b><span class="docEmphBoldItalic">example</span><b class="calibre28">,dc=</b><span class="docEmphBoldItalic">com</span></pre><br class="calibre1"/>
</div></li></ol></div>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="config_files-id15" class="calibre8" id="config_files-id15"/>
<h3 class="docSection1Title" id="-100000">16.9. CONFIG FILES</h3>
<p class="docText1"><span class="b">/usr/local/etc/openldap/slapd.conf</span><a name="IDX-CHP-16-0255" class="calibre8" id="IDX-CHP-16-0255"/><a name="IDX-CHP-16-0256" class="calibre8" id="IDX-CHP-16-0256"/></p>
<p class="docText1"><a name="Main configuration" class="calibre8" id="Main configuration"/>Main configuration file for slapd</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="log_files-id9" class="calibre8" id="log_files-id9"/>
<h3 class="docSection1Title" id="-100000">16.10. LOG FILES</h3>
<p class="docText1"><span class="b">/var/log/debug.log</span></p>
<p class="docText1"><a name="Contains slapd" class="calibre8" id="Contains slapd"/>Contains slapd logs</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="notes-id11" class="calibre8" id="notes-id11"/>
<h3 class="docSection1Title" id="-100000">16.11. NOTES</h3>
<ul class="calibre15"><li class="calibre16"><p class="docText1"><a name="Since ldapadd" class="calibre8" id="Since ldapadd"/>Since ldapadd is sensitive to syntax errors, adding entries to the LDAP database manually (as we did in the test section above) can be very inconvenient. Utilities exist that allow you to administer the LDAP database in a more efficient and user-friendly manner. phpLDAPadmin is a web-based LDAP browser designed to manage the LDAP database more intuitively. See "phpLDAPadmin 1.1.0" on page 153 for details.</p></li><li class="calibre16"><p class="docText1"><a name="only LDAPv" class="calibre8" id="only LDAPv"/>OpenLDAP 2.3 accepts only LDAPv3 requests by default. Ensure that your LDAP client is set to LDAPv3 if given the option. If LDAPv2 is needed you may add <tt class="calibre20">allow bind_v2</tt> to <span class="docEmphasis1">/usr/local/etc/openldap/slapd.conf</span>; see the manual page for <span class="docEmphasis1">slapd.conf</span> for details (view this by typing <tt class="calibre20">man slapd.conf</tt> at the prompt).</p></li></ul>
</div></div>

</body></html>