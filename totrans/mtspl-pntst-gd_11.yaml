- en: Chapter 11. Fast-Track
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Fast-Track is an open source Python-based tool for augmenting advanced penetration
    testing techniques. Fast-Track uses the Metasploit Framework for payload delivery
    and client-side attack vectors. It complements Metasploit by adding additional
    features, including Microsoft SQL attacks, more exploits, and browser attack vectors.
    Fast-Track was created by Dave Kennedy, with contributions from Andrew Weidenhamer,
    John Melvin, and Scott White. It is currently updated and maintained by Joey Furr
    (j0fer).
  prefs: []
  type: TYPE_NORMAL
- en: Fast-Track’s interactive mode is the way to use it. To enter interactive mode,
    as shown below, use **`./fast-track.py -i`** (which is similar to the command
    used by SET). By issuing different options and sequences, you can customize your
    attack, targets, and more. (You can also use `./fast-track.py -g` to load the
    web interface.)
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: You can see the general categories of attacks and features in Fast-Track’s main
    menu above though we’ll only cover selected ones in this chapter. We’ll explore
    some of the most useful tricks, with an emphasis on exploiting Microsoft SQL.
    For example, the Autopwn Automation menu simplifies the process of Metasploit’s
    autopwn functionality — simply enter the IP address, and Fast-Track sets up everything
    for you. The Exploits menu contains additional exploits not included in Metasploit.
  prefs: []
  type: TYPE_NORMAL
- en: Microsoft SQL Injection
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '*SQL injection (SQLi) attacks* piggyback SQL commands to assault web applications
    by exploiting insecure code. A SQL query can be inserted into the backend database
    via a trusted web server to execute commands on the database. Fast-Track automates
    the process of performing advanced SQL injection attacks by focusing on query
    string and POST parameters within web applications. The following attack relies
    on the attacker knowing that SQL injection is present on the target website, and
    also knowing which parameter is vulnerable. This attack will work only on MS SQL–based
    systems.'
  prefs: []
  type: TYPE_NORMAL
- en: SQL Injector — Query String Attack
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Begin the setup for the attack by selecting `Microsoft SQL Tools` from the main
    menu and then `MSSQL Injector` ![](../images/00002.gif), as shown below.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'The simplest form of SQL injection is within the query string, typically sent
    in the URL field from the browser to the server. This URL string can often contain
    parameters that inform a dynamic site what information is being requested. Fast-Track
    distinguishes which field to attack by inserting an ''`INJECTHERE` into the vulnerable
    query string parameter, like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: When Fast-Track starts to exploit this vulnerability, it will look for the `id`
    string in all fields to determine which field to attack. Let’s look at this in
    action by selecting the first option, `Query String Parameter Attack`.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Success! Full access was granted to the system, all through SQL injection.
  prefs: []
  type: TYPE_NORMAL
- en: Note that this attack will not succeed if parameterized SQL queries or stored
    procedures are in use. Note, too, that the required configuration for this attack
    is very minimal. After selecting `SQL Injector - Query String Parameter Attack`
    ![](../images/00002.gif) from the menu of attacks, you simply direct Fast-Track
    to the point of SQL injection ![](../images/00004.gif). If the `xp_cmdshell` stored
    procedure is disabled, Fast-Track will automatically re-enable it and attempt
    privilege escalation of MS SQL.
  prefs: []
  type: TYPE_NORMAL
- en: SQL Injector — POST Parameter Attack
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Fast-Track’s POST parameter attack requires even less configuration than the
    preceding query string parameter attack. For this attack, simply pass Fast-Track
    the URL of the website you want to attack, and it will automatically detect the
    form to attack.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: As you can see, Fast-Track handled the automatic detection of the POST parameters
    and injected the attack, completely compromising the affected system via SQL injection.
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: You can also use FTP to deliver your payload, although FTP is generally blocked
    on outbound-based connections.
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Manual Injection
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: If you have a different IP address listening for the reverse shell or you need
    to fine-tune some of the configuration settings, you can set up the injector manually.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: First choose the manual option at ![](../images/00002.gif). Then, as in the
    query string parameter attack, point Fast-Track to the parameter vulnerable to
    SQL injection ![](../images/00004.gif) and input your listening IP address at
    ![](../images/00005.gif) along with the port you want your target to connect to
    at ![](../images/00006.gif). Fast-Track takes care of the rest.
  prefs: []
  type: TYPE_NORMAL
- en: MSSQL Bruter
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Perhaps one of the best aspects of Fast-Track is the *MSSQL Bruter* (available
    from the Microsoft SQL Attack Tools menu). When MS SQL is installed, MSSQL Bruter
    can use integrated Windows authentication, SQL authentication, or mixed-mode authentication.
  prefs: []
  type: TYPE_NORMAL
- en: Mixed-mode authentication allows users to be verified from Windows authentication
    as well as directly from the MS SQL Server. If mixed-mode or SQL authentication
    is used during the installation of MS SQL, the administrator installing the software
    needs to specify an *sa*, or system administrator, account for MS SQL. Often,
    administrators choose a weak, blank, or easily guessable password that can be
    used to an attacker’s advantage. If the *sa* account can be brute forced, it will
    lead to a compromise of the entire system through the extended stored procedure
    `xp_cmdshell`.
  prefs: []
  type: TYPE_NORMAL
- en: Fast-Track uses a few methods for discovery when looking for MS SQL servers,
    including using *nmap* to perform port scans of the default MS SQL TCP port 1433\.
    If the target machine is using MS SQL Server 2005 or later, dynamic port ranges
    can be used, which makes it more difficult to enumerate, but Fast-Track directly
    interfaces with Metasploit and can look for port 1434 User Datagram Protocol (UDP)
    to reveal which port MS SQL server’s dynamic port is running.
  prefs: []
  type: TYPE_NORMAL
- en: Once Fast-Track has identified a server and successfully brute forced the *sa*
    account, it will use advanced binary-to-hex conversion methods to deliver a payload.
    This attack is usually highly successful, especially in large environments where
    MS SQL is widely used.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here’s the initial attack:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: After we select the `MSSQL Bruter` option, Fast-Track presents us with a list
    of various attacks that can be conducted. Not all of these will work in every
    situation, or even serve the same purpose, so it is important to be sure that
    you understand what is happening for each option.
  prefs: []
  type: TYPE_NORMAL
- en: 'Fast-Track has several options:'
  prefs: []
  type: TYPE_NORMAL
- en: Attempt SQL Ping and Auto Quick Brute Force attempts to scan a range of IP addresses
    using the same syntax as *nmap* and a built-in predefined dictionary list of about
    50 passwords.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Mass scan and dictionary brute scans a range of IP addresses and allows you
    to specify a word list of your own. Fast-Track comes with a decent word list located
    at *bin/dict/wordlist.txt*.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Single Target allows you to brute force one specific IP address with a large
    word list.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Find SQL Ports (SQL Ping) only looks for SQL servers and will not attack them.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: I want a command prompt . . . spawns a command prompt for you if you already
    know the *sa* password.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Vulnerable system . . . adds a new administrative user on a box that you know
    to be vulnerable.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Enable `xp_cmdshell` . . . is a stored procedure Fast-Track uses to execute
    underlying system commands. By default, it is disabled in SQL Server versions
    2005 and later, but Fast-Track can automatically re-enable it. When attacking
    a remote system with any option, Fast-Track will automatically attempt to re-enable
    `xp_cmdshell`, just in case.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You can use and customize several options to reach your target, the easiest
    of which is the quick brute force, which will often go undetected. We’ll select
    the quick brute force option using a subset of built-in passwords and attempt
    to guess the password on the MS SQL server.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: After selecting Attempt SQL Ping and Auto Quick Brute Force at ![](../images/00002.gif),
    you will be prompted for a SQL database username ![](../images/00004.gif), followed
    by the range of IP addresses you want to scan at ![](../images/00005.gif). Answer
    **`yes`** when asked whether you want to perform advanced server identification
    ![](../images/00006.gif). Although slow, this can be very effective.
  prefs: []
  type: TYPE_NORMAL
- en: The preceding output shows that Fast-Track successfully brute forced a system
    with the username of *sa* and password *password*. At this point, you can select
    the payload and compromise the system, as shown here.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: You should now have full access to the machine using the Meterpreter payload.
  prefs: []
  type: TYPE_NORMAL
- en: SQLPwnage
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '*SQLPwnage* is a mass brute force attack that can be used against web applications
    in an attempt to find Microsoft SQL injection. SQLPwnage will scan subnets for
    web servers on port 80, crawl websites, and attempt to fuzz post parameters until
    it finds SQL injection. It supports both error- and blind-based SQL injection
    and will handle everything from privilege escalation to re-enabling the `xp_cmdshell`
    stored procedure, bypassing the Windows debug 64KB restriction, and dropping any
    payload you want onto the system.'
  prefs: []
  type: TYPE_NORMAL
- en: Begin the configuration for this attack by selecting `Microsoft SQL Tools` from
    the Fast-Track main menu, followed by `SQLPwnage`, option 2, as shown below.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: Depending on whether the website presents an error when SQL injection attempts
    are made, you will need to choose between `BLIND` and `ERROR BASED` attacks. At
    ![](../images/00002.gif) we choose `ERROR BASED` because the site is kind enough
    to report back error messages when it has trouble executing a SQL query.
  prefs: []
  type: TYPE_NORMAL
- en: Next, choose either to spider a single URL or to scan a complete subnet ![](../images/00004.gif).
    After scanning the subnet, we choose to attack all the sites Fast-Track found
    ![](../images/00005.gif). As you can see, scanning all the sites found a vulnerable
    form ![](../images/00006.gif) on one site.
  prefs: []
  type: TYPE_NORMAL
- en: The final configuration steps require that you select a payload. In the following
    example, you select `Metasploit Meterpreter Reflective Reverse TCP` ![](../images/00002.gif)
    along with the port at ![](../images/00004.gif) that you want your attacking machine
    to listen on. After Fast-Track has successfully exploited the SQL injection vulnerability,
    it sends a chunked payload ![](../images/00005.gif) to the target and eventually
    presents you with your Meterpreter shell ![](../images/00006.gif).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: Binary-to-Hex Generator
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The binary-to-hex generator is useful when you already have access to a system
    and you want to deliver an executable to the remote file system. Point Fast-Track
    to the executable, and it will generate a text file that you can copy and paste
    to the target operating system. To convert the hexadecimal back to a binary and
    execute it, choose option 6 as shown at ![](../images/00002.gif) below.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: After selecting the `Binary to Hex Payload Converter`, point Fast-Track to the
    binary you want to convert at ![](../images/00004.gif) and wait for the magic.
    At this point, you can simply copy and paste the output from ![](../images/00005.gif)
    into an existing shell window.
  prefs: []
  type: TYPE_NORMAL
- en: Mass Client-Side Attack
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The *mass client-side attack* is similar to the *Browser Autopwn* function;
    however, this attack includes additional exploits and built-in features that can
    incorporate ARP cache and DNS poisoning on the target’s machine, and additional
    browser exploits not included in Metasploit.
  prefs: []
  type: TYPE_NORMAL
- en: When a user connects to your web server, Fast-Track will fire off every exploit
    in its arsenal as well as those in the Metasploit Framework. If the user’s machine
    is susceptible to a specific vulnerability within one of these libraries, the
    attacker will obtain full access to the target machine.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: After selecting option 4, `Mass Client-Side Attack` ![](../images/00002.gif),
    from the main menu, tell Fast-Track what IP address the web server should listen
    on ![](../images/00004.gif), and then choose a payload ![](../images/00005.gif).
  prefs: []
  type: TYPE_NORMAL
- en: Next, decide whether to use Ettercap to ARP-poison your target machine. Ettercap
    will intercept all requests that the target makes and redirect them to your malicious
    server. After confirming that you want to use Ettercap at ![](../images/00002.gif),
    enter the IP address of the target you want to poison ![](../images/00004.gif).
    Fast-Track will then go ahead and set up Ettercap ![](../images/00005.gif) for
    you.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: Once a client connects to your malicious server, Metasploit fires exploits ![](../images/00002.gif)
    at the target. In the following listing, you can see that the Adobe exploit is
    successful, and a Meterpreter shell is waiting ![](../images/00004.gif).
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: You could use ARP cache poisoning within this attack, but it will only work
    when you are on the same local and unrestricted subnet as the target.
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: A Few Words About Automation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Fast-Track offers a plethora of exploitation capabilities that expand upon the
    feature-rich Metasploit Framework. When coupled with Metasploit it will allow
    you to use advanced attack vectors to fully control a target machine. Of course,
    automated attack vectors do not always succeed, which is why you must understand
    the system you are performing the attack against and ensure that when you attack
    it, you know its chances of success. If an automated tool fails, your ability
    to perform the tests manually and successfully attack the target system will make
    you a better penetration tester.
  prefs: []
  type: TYPE_NORMAL
