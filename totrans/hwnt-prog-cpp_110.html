<html><head></head><body>

<div class="calibre21" id="calibre_pb_0"/><div class="calibre1" id="calibre_toc_123">
<a name="ch11" class="calibre6" id="ch11"/>
<div class="calibre1">
<h2 class="lot-title" id="calibre_pb_1"><a name="128" class="calibre16" id="128"/><a name="ch11lev1sec2" class="calibre16" id="ch11lev1sec2"/><span class="chapter-titlelabel">Program 107: </span>Better Trash Collector</h2><p class="b24-bookeditorial">We've fixed Program 106 by adding the keyword "volatile." But things still don't work right.</p>
<div class="calibre1">
<pre class="literallayout-normal">
  1 /*************************************************
  2  * clear port -- Clear the input port.           *
  3  *************************************************/
  4 // Input register
  5 const char *volatile in_port_ptr  =
  6         (char *)0xFFFFFFE0;
  7
  8 // Output register
  9 const char *volatile out_port_ptr =
 10         (char *)0xFFFFFFE1;
 11
 12 /***********************************************
 13  * clear_input -- Clear the input device by    *
 14  *      reading enough characters to empty the *
 15  *      buffer. (It doesn't matter if we read  *
 16  *      extra, just so long as we read enough.)*
 17  ***********************************************/
 18 void clear_input(void)
 19 {
 20     char ch;     // Dummy character
 21
 22     ch = *in_port_ptr;   // Grab data
 23     ch = *in_port_ptr;   // Grab data
 24     ch = *in_port_ptr;   // Grab data 25 }
</pre>
</div>
<p class="b24-bookeditorial">(Next <a href="LiB0120.html#472" target="_parent" class="calibre2">Hint 336</a>. <a href="LiB0121.html#559" target="_parent" class="calibre2">Answer 61</a>.)</p>
<div class="calibre1">
<table class="calibre3" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr class="calibre4">
<td class="bluecell"><span class="calibre22"><b class="calibre13"><img src="_1.gif" alt="Start Sidebar" border="0" class="calibre23"/></b></span></td>
</tr>
</table>
<p class="b24-bookeditorial">A user called up technical support with a big problem. The technician tried for several hours to fix the problem over the phone but failed, so he asked the user to send him a copy of his disk. The next day, by Federal Express a letter arrived for the technician containing a photocopy of the disk. The user wasn't completely dumb: He knew that he had a two-sided disk, so he copied both sides.</p>
<p class="b24-bookeditorial">Oddly enough, the technician was able to figure out what the problem was from the photocopy. Turns out the user had the wrong version of the software.</p>
<table class="calibre3" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr class="calibre4">
<td class="bluecell"><span class="calibre22"><b class="calibre13"><img src="_1.gif" alt="End Sidebar" border="0" class="calibre23"/></b></span></td>
</tr>
</table>
</div>
<table class="calibre3" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr class="calibre4">
<td height="16" class="calibre8"/>
</tr>
</table>
</div>
</div>



</body></html>