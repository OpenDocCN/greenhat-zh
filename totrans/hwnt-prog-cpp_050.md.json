["```\n  1 /************************************************\n  2  * scan -- Scan a directory tree for files that *\n  3  *      begin with a magic number.              *\n  4  ************************************************/\n  5 #include <iostream>\n  6 #include <dirent.h>\n  7 #include <fcntl.h>\n  8 #include <unistd.h>\n  9\n 10 // Linux executable magic #\n 11 const long int MAGIC = 0Ã—464c457f;\n 12\n 13 /************************************************\n 14  * next_file -- find a list of files with       *\n 15  *      magic numbers that match the given      *\n 16  *      number.                                 *\n 17  *                                              *\n 18  * Returns the name of the file or              *\n 19  *      NULL if no more files.                  *\n 20  ************************************************/\n 21 char *next_file(\n 22     DIR  *dir   // Directory we are scanning\n 23 )\n 24 {\n 25     // The current directory entry\n 26     struct dirent *cur_ent;\n 27\n 28     while (1) {\n 29         cur_ent = readdir(dir);\n 30         if (cur_ent == NULL)\n 31             return (NULL);\n 32\n 33         // Open the fd for the input file\n 34         int fd = open(cur_ent->d_name, 0_RDONLY);\n 35         if (fd < 0)\n 36             continue;   // Can't get the file\n 37                         // so try again\n 38\n 39         int magic;      // The file's magic number\n 40\n 41         // Size of the latest read\n 42         int read_size =\n 43             read(fd, &magic, sizeof(magic));\n 44\n 45         if (read_size != sizeof(magic))\n 46             continue;\n 47\n 48         if (magic == MAGIC)\n 49         {\n 50             close(fd);\n 51             return (cur_ent->d_name);\n 52         }\n 53     }\n 54 }\n 55\n 56 /************************************************\n 57  * scan_dir -- Scan a directory for the         *\n 58  *      files we want.                          *\n 59  ************************************************/\n 60 void scan_dir(\n 61     const char dir_name[] // Directory name to use\n 62 )\n 63 {\n 64     // The directory we are reading\n 65     DIR *dir_info = opendir(dir_name);\n 66     if (dir_info == NULL)\n 67         return;\n 68\n 69     chdir(dir_name);\n 70\n 71     while (1) {\n 72         char *name = next_file(dir_info);\n 73         if (name == NULL)\n 74             break;\n 75         std::cout << \"Found: \" << name << '\\n';\n 76     }\n 77 }\n 78\n 79 int main()\n 80 {\n 81     scan_dir(\".\");\n 82     return (0);\n 83 }\n\n```"]