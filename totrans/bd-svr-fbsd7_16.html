<html><head></head><body>

<div class="calibre1"><div class="calibre1"><a name="courier_-_authlib_0.60.2" class="calibre8" id="courier_-_authlib_0.60.2"/>
<div class="calibre24" id="calibre_pb_0"/><h2 id="title-ID0EKMOM" class="docPrefaceTitle">Chapter 4. COURIER - AUTHLIB 0.60.2</h2>
<h4 class="calibre32"><a class="calibre2" target="_blank" href="HTTP://WWW.COURIER-MTA.ORG/AUTHLIB">HTTP://WWW.COURIER-MTA.ORG/AUTHLIB</a></h4>
<a name="summary-id3" class="calibre8" id="summary-id3"/>
<h3 class="docSection1Title" id="-100000">4.1. SUMMARY</h3>
<p class="docText1"><a name="Courier Authentication" class="calibre8" id="Courier Authentication"/>Courier-authlib (the Courier Authentication Library) provides authentication functionality for Courier-IMAP Server (see "Courier-IMAP Server 4.3.0" page 43). This package makes it possible for Courier-IMAP to authenticate users against the system password file in <span class="docEmphasis1">/etc/master.passwd</span><a name="password file" class="calibre8" id="password file"/>. The master password file stores passwords for all user accounts on the system.<a name="IDX-CHP-4-0085" class="calibre8" id="IDX-CHP-4-0085"/><a name="IDX-CHP-4-0086" class="calibre8" id="IDX-CHP-4-0086"/><a name="IDX-CHP-4-0087" class="calibre8" id="IDX-CHP-4-0087"/></p>
<p class="docText1"><a name="IMAP " class="calibre8" id="IMAP "/>Courier-IMAP Server includes both an IMAP (Internet Message Access Protocol) and POP3 (Post Office Protocol version 3) server implementation, and both rely on Courier-authlib for authentication. Username and password information is compared against the system password file located in <span class="docEmphasis1">/etc/master.passwd</span> using Courier-authlib's <tt class="calibre20">authpam</tt><a name="PAM " class="calibre8" id="PAM "/> authentication module. Courier-authlib then consults FreeBSD's built-in PAM (Pluggable Authentication Modules) library to authenticate. If authentication is successful, the user is allowed to access services offered by Courier-IMAP.</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="resources-id3" class="calibre8" id="resources-id3"/>
<h3 class="docSection1Title" id="-100000">4.2. RESOURCES</h3>
<p class="docText1"><span class="b"><a name="Courier Authentication" class="calibre8" id="Courier Authentication"/>Courier Authentication Library Documentation</span></p>
<p class="docText1"><a class="calibre2" target="_blank" href="http://www.courier-mta.org/authlib/documentation.html">http://www.courier-mta.org/authlib/documentation.html</a></p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="required-id3" class="calibre8" id="required-id3"/>
<h3 class="docSection1Title" id="-100000">4.3. REQUIRED</h3>
<p class="docText1"><img border="0" id="" src="bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg" alt="" class="calibre33"/><a name="FreeBSD " class="calibre8" id="FreeBSD "/> FreeBSD 7.0-RELEASE (see "<a class="calibre2" href="freebsd_7.0_split_000.html#freebsd_7.0">FreeBSD 7.0</a>")</p>
<p class="docText1"><img border="0" id="" src="bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg" alt="" class="calibre33"/><a name="collection " class="calibre8" id="collection "/> Updated ports collection (see "<a class="calibre2" href="freebsd_ports_collection.html#freebsd_ports_collection">FreeBSD Ports Collection</a>")</p>
<p class="docText1"><img border="0" id="" src="bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg" alt="" class="calibre33"/> Internet connection</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="preparation-id3" class="calibre8" id="preparation-id3"/>
<h3 class="docSection1Title" id="-100000">4.4. PREPARATION</h3>
<p class="docText1"><a name="Become the" class="calibre8" id="Become the"/>Become the superuser.</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="install-id3" class="calibre8" id="install-id3"/>
<h3 class="docSection1Title" id="-100000">4.5. INSTALL</h3>
<p class="docText1"><a name="To begin" class="calibre8" id="To begin"/>To begin the Courier-authlib installation process, enter the following commands:</p>
<pre class="calibre30"># <b class="calibre28">cd /usr/ports/security/courier-authlib</b>
 # <b class="calibre28">make config ; make install clean</b>
 # <b class="calibre28">rehash</b></pre>
<p class="docText1"><a name="should appear" class="calibre8" id="should appear"/>A menu should appear showing options for Courier-authlib. We will not need any of these optional authentication modules, so press [tab] to highlight <span class="b">OK</span> and then press [enter].</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="configure-id3" class="calibre8" id="configure-id3"/>
<h3 class="docSection1Title" id="-100000">4.6. CONFIGURE</h3>
<p class="docText1"><a name="Once the" class="calibre8" id="Once the"/>Once the installation process is complete, it's time to configure the authentication daemon for use on your system.</p>
<p class="docText1"><a name="only use" class="calibre8" id="only use"/>We will only use the <tt class="calibre20">authpam</tt> method of authentication.</p>
<p class="docText1"><a name="extraneous authentication" class="calibre8" id="extraneous authentication"/>The next steps remove extraneous authentication modules listed in the <span class="docEmphasis1">authdaemonrc</span><a name="prevent authdaemond" class="calibre8" id="prevent authdaemond"/> configuration file to prevent authdaemond from generating errors in the <span class="docEmphasis1">maillog</span> file.</p>
<div class="calibre34"><ol class="docList" type="1"><li class="calibre16"><div class="calibre35"><p class="docText1">Open <span class="docEmphasis1">authdaemonrc</span>:</p><pre class="calibre30"># <b class="calibre28">ee /usr/local/etc/authlib/authdaemonrc</b></pre>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1">Remove the names of all authentication modules in the <tt class="calibre20">authmodulelist</tt> declaration (~27) except for <tt class="calibre20">authpam</tt>. The <tt class="calibre20">authmodulelist</tt> declaration should now look like this:</p><pre class="calibre30">authmodulelist="authpam"</pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1">Save and exit.</p></div></li></ol></div>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="testing-id1" class="calibre8" id="testing-id1"/>
<h3 class="docSection1Title" id="-100000">4.7. TESTING</h3>
<p class="docText1"><a name="In this" class="calibre8" id="In this"/>In this section, we'll perform a basic test to confirm that Courier-authlib starts properly.<a name="IDX-CHP-4-0088" class="calibre8" id="IDX-CHP-4-0088"/></p>
<div class="calibre34"><ol class="docList" type="1"><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="start automatically" class="calibre8" id="start automatically"/>Configure Courier-authlib to start automatically at system startup. To load the Courier-authlib daemon at boot time, open <span class="docEmphasis1">rc.conf</span>:</p><pre class="calibre30"># <b class="calibre28">ee /etc/rc.conf</b></pre>
<p class="docText1">and add the following line:</p><pre class="calibre30">courier_authdaemond_enable="YES"</pre><br class="calibre1"/>
<p class="docText1">Save and exit.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="verify that" class="calibre8" id="verify that"/>Start the Courier-authlib daemon and verify that it is running:</p><pre class="calibre30"># <b class="calibre28">/usr/local/etc/rc.d/courier-authdaemond start</b>
# <b class="calibre28">/usr/local/etc/rc.d/courier-authdaemond status</b></pre><br class="calibre1"/>
<p class="docText1"><a name="the output" class="calibre8" id="the output"/>If startup is successful, the output of the second command should read:</p><pre class="calibre30">courier_authdaemond is running as pid <tt class="calibre20"><i class="docEmphasis1">12073</i></tt>.</pre><br class="calibre1"/>
<p class="docText1">Your <span class="docEmphasis1">pid</span> (process ID) will be different.</p></div></li></ol></div>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="config_files-id3" class="calibre8" id="config_files-id3"/>
<h3 class="docSection1Title" id="-100000">4.8. CONFIG FILES</h3>
<p class="docText1"><span class="b">/usr/local/etc/authlib/authdaemonrc</span></p>
<p class="docText1"><a name="Contains configuration" class="calibre8" id="Contains configuration"/>Contains configuration information for authdaemond</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="log_files-id1" class="calibre8" id="log_files-id1"/>
<h3 class="docSection1Title" id="-100000">4.9. LOG FILES</h3>
<p class="docText1"><span class="b">/var/log/maillog</span><a name="IDX-CHP-4-0089" class="calibre8" id="IDX-CHP-4-0089"/><a name="IDX-CHP-4-0090" class="calibre8" id="IDX-CHP-4-0090"/></p>
<p class="docText1"><a name="A general" class="calibre8" id="A general"/>A general log of email activity that includes information from authdaemond</p>
</div></div>

</body></html>