["```\nstatic TAILQ_HEAD(,❶ucdev_priv) cdevp_list =\n    TAILQ_HEAD_INITIALIZER(cdevp_list);\n\n```", "```\nextern struct mtx devmtx;\n\n```", "```\n#include <sys/param.h>\n#include <sys/proc.h>\n#include <sys/module.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/conf.h>\n#include <sys/queue.h>\n#include <sys/lock.h>\n#include <sys/mutex.h>\n\n#include <fs/devfs/devfs_int.h>\n\nextern TAILQ_HEAD(,cdev_priv) cdevp_list;\n\nd_read_t        read_hook;\nd_read_t        *read;\n\n/* read entry point hook. */\nint\nread_hook(struct cdev *dev, struct uio *uio, int ioflag)\n{\n\n           uprintf(\"You ever dance with the devil in the pale moonlight?\\n\");\n\n           ❶return((*read)(dev, uio, ioflag));\n\n}\n\n/* The function called at load/unload. */\nstatic int\nload(struct module *module, int cmd, void *arg)\n{\n\n        int error = 0;\n        struct cdev_priv *cdp;\n\n        switch (cmd) {\n        case MOD_LOAD:\n                mtx_lock(&devmtx);\n\n                /* Replace cd_example's read entry point with read_hook\n                TAILQ_FOREACH(cdp, &cdevp_list, cdp_list) {\n                      if (strcmp(cdp->cdp_c.si_name, \"cd_example\") == 0) {\n                              ❷read = cdp->cdp_c.si_devsw->d_read;\n                              ❸cdp->cdp_c.si_devsw->d_read = read_hook;\n                              break;\n\n                    }\n\n                 }\n\n               mtx_unlock(&devmtx);\n               break;\n\n           case MOD_UNLOAD:\n                   mtx_lock(&devmtx);\n\n                   /* Change everything back to normal. */\n\n                TAILQ_FOREACH(cdp, &cdevp_list, cdp_list) {\n\n                        if (strcmp(cdp->cdp_c.si_name, \"cd_example\") == 0) {\n\n                                ❹cdp->cdp_c.si_devsw->d_read = read;\n                                break;\n                        }\n\n                }\n\n               mtx_unlock(&devmtx);\n               break;\n\n         default:\n\n                error = EOPNOTSUPP;\n                break;\n        }\n\n        return(error);\n\n     }\n\n     static moduledata_t cd_example_hook_mod = {\n             \"cd_example_hook\",      /* module name */\n              load,                   /* event handler */\n              NULL                    /* extra data */\n\n};\n\nDECLARE_MODULE(cd_example_hook, cd_example_hook_mod, SI_SUB_DRIVERS,\n      SI_ORDER_MIDDLE);\n\n```", "```\n$ `sudo kldload ./cd_example_hook.ko`\n$ `sudo ./interface Tell\\ me\\ something,\\ my\\ friend.`\nWrote \"Tell me something, my friend.\" to device /dev/cd_example\nYou ever dance with the devil in the pale moonlight?\nRead \"Tell me something, my friend.\" from device /dev/cd_example\n\n```"]