<html><head></head><body>

<div class="calibre1"><div class="calibre1"><a name="pure-ftpd_server_1.0.21" class="calibre8" id="pure-ftpd_server_1.0.21"/>
<div class="calibre24" id="calibre_pb_0"/><h2 id="title-ID0ERRAO" class="docPrefaceTitle">Chapter 26. PURE - FTPD SERVER 1.0.21</h2>
<h4 class="calibre32"><a class="calibre2" target="_blank" href="HTTP://WWW.PUREFTPD.ORG">HTTP://WWW.PUREFTPD.ORG</a></h4>
<a name="summary-id25" class="calibre8" id="summary-id25"/>
<h3 class="docSection1Title" id="-100000">26.1. SUMMARY</h3>
<p class="docText1"><span class="docEmphasis1"><a name="FTP " class="calibre8" id="FTP "/>FTP (File Transfer Protocol)</span><a name="for transferring" class="calibre8" id="for transferring"/> is used for transferring files between a server and a client system. According to RFC 959,<sup class="docFootnote"><a class="calibre2" href="#CHP-26-1">[]</a></sup><a name="are to" class="calibre8" id="are to"/> the four objectives of FTP are to promote the sharing of files, encourage use of remote computers, shield users from variations in file storage systems, and transfer data reliably and efficiently.</p><blockquote class="calibre31"><p class="docFootnote1"><sup class="calibre37"><a name="CHP-26-1" class="calibre8" id="CHP-26-1">[]</a></sup><a name="Transfer Protocol" class="calibre8" id="Transfer Protocol"/> J. Postel and J. Reynolds, "File Transfer Protocol (FTP)," Internet Engineering Task Force, <a class="calibre2" target="_blank" href="http://www.ietf.org/rfc/rfc959.txt">http://www.ietf.org/rfc/rfc959.txt</a>.<a name="IDX-CHP-26-0380" class="calibre8" id="IDX-CHP-26-0380"/><a name="IDX-CHP-26-0381" class="calibre8" id="IDX-CHP-26-0381"/><a name="IDX-CHP-26-0382" class="calibre8" id="IDX-CHP-26-0382"/><a name="IDX-CHP-26-0383" class="calibre8" id="IDX-CHP-26-0383"/><a name="IDX-CHP-26-0384" class="calibre8" id="IDX-CHP-26-0384"/><a name="IDX-CHP-26-0385" class="calibre8" id="IDX-CHP-26-0385"/><a name="IDX-CHP-26-0386" class="calibre8" id="IDX-CHP-26-0386"/><a name="IDX-CHP-26-0387" class="calibre8" id="IDX-CHP-26-0387"/><a name="IDX-CHP-26-0388" class="calibre8" id="IDX-CHP-26-0388"/></p></blockquote>
<p class="docText1"><a name="developed in" class="calibre8" id="developed in"/>FTP was first developed in 1971 by the US Department of Defense for use in its network at DARPA. It is regarded as one of the Internet's first protocols.</p>
<p class="docText1"><a name="original FTP" class="calibre8" id="original FTP"/>Pure-FTPd is an open source FTP server that conforms to the original FTP standards with some additional functionality. These include a virtual user system, SSL/TLS encryption support, bandwidth throttling, and upload/download ratios, to name a few. Pure-FTPd supports both virtual users and users that exist on system-level accounts. This guide will exclusively focus on the virtual user scheme as it offers a larger feature set.</p>
<p class="docText1"><a name="by Arnt" class="calibre8" id="by Arnt"/>Pure-FTPd is based on Troll-FTPd, originally written by Arnt Gulbrandsen in 1995. Active development of Troll-FTPd stagnated in the late '90s, prompting Frank Denis to create the Pure-FTPd project. Denis made some modifications to the Troll-FTPd code, wrote new documentation, and released Pure-FTPd in 2001. A team of nine, led by Denis, continues development of the Pure-FTPd project.</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="resources-id25" class="calibre8" id="resources-id25"/>
<h3 class="docSection1Title" id="-100000">26.2. RESOURCES</h3>
<p class="docText1"><span class="b">Pure-FTPd Documentation</span></p>
<p class="docText1"><a class="calibre2" target="_blank" href="http://www.pureftpd.org/project/pure-ftpd/doc">http://www.pureftpd.org/project/pure-ftpd/doc</a></p>
<p class="docText1"><span class="b"><a name="RFC " class="calibre8" id="RFC "/>RFC 959 - File Transfer Protocol</span></p>
<p class="docText1"><a class="calibre2" target="_blank" href="http://tools.ietf.org/html/rfc959">http://tools.ietf.org/html/rfc959</a></p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="required-id25" class="calibre8" id="required-id25"/>
<h3 class="docSection1Title" id="-100000">26.3. REQUIRED</h3>
<p class="docText1"><img border="0" id="" src="N2QyLy9jZ3QvODFzcGVtaTlnNTRmOTk1N2kzMWFyczMvZzAwcC5uVQ--.jpg" alt="" class="calibre33"/><a name="FreeBSD " class="calibre8" id="FreeBSD "/> FreeBSD 7.0-RELEASE (see "<a class="calibre2" href="freebsd_7.0_split_000.html#freebsd_7.0">FreeBSD 7.0</a>")</p>
<p class="docText1"><img border="0" id="" src="N2QyLy9jZ3QvODFzcGVtaTlnNTRmOTk1N2kzMWFyczMvZzAwcC5uVQ--.jpg" alt="" class="calibre33"/><a name="collection " class="calibre8" id="collection "/> Updated ports collection (see "<a class="calibre2" href="freebsd_ports_collection.html#freebsd_ports_collection">FreeBSD Ports Collection</a>")</p>
<p class="docText1"><img border="0" id="" src="N2QyLy9jZ3QvODFzcGVtaTlnNTRmOTk1N2kzMWFyczMvZzAwcC5uVQ--.jpg" alt="" class="calibre33"/> Internet connection</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="optional-id14" class="calibre8" id="optional-id14"/>
<h3 class="docSection1Title" id="-100000">26.4. OPTIONAL</h3>
<p class="docText1"><img border="0" id="" src="N2QyLy9jZ3QvODFzcGVtaTlnNTRmOTk1N2kzMWFyczMvZzAwcC5uVQ--.jpg" alt="" class="calibre33"/><a name="OpenSSL with" class="calibre8" id="OpenSSL with"/> OpenSSL with a signed SSL Certificate, if you wish to enable encryption of the FTP control channel (see "<a class="calibre2" href="openssl_0.9.8g.html#openssl_0.9.8g">OpenSSL 0.9.8g</a>")</p>
<p class="docText1"><img border="0" id="" src="N2QyLy9jZ3QvODFzcGVtaTlnNTRmOTk1N2kzMWFyczMvZzAwcC5uVQ--.jpg" alt="" class="calibre33"/> Registered domain name</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="preparation-id25" class="calibre8" id="preparation-id25"/>
<h3 class="docSection1Title" id="-100000">26.5. PREPARATION</h3>
<p class="docText1"><a name="Become the" class="calibre8" id="Become the"/>Become the superuser.<a name="IDX-CHP-26-0389" class="calibre8" id="IDX-CHP-26-0389"/></p>
<hr size="1" noshade="noshade" class="calibre27"/><span><i class="docEmphasis1"><b class="calibre28">Note:</b></i> This guide provides instructions for using the virtual user system to manage and control users. This system provides a larger feature set and allows administration of FTP accounts without affecting system accounts.</span><hr size="1" noshade="noshade" class="calibre27"/>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="install-id25" class="calibre8" id="install-id25"/>
<h3 class="docSection1Title" id="-100000">26.6. INSTALL</h3>
<p class="docText1"><a name="To begin" class="calibre8" id="To begin"/>To begin the Pure-FTPd installation process, enter the following commands:</p>
<pre class="calibre30"># <b class="calibre28">cd /usr/ports/ftp/pure-ftpd</b>
# <b class="calibre28">make config ; make install clean</b>
# <b class="calibre28">rehash</b></pre>
<p class="docText1"><a name="containing pure" class="calibre8" id="containing pure"/>A menu containing pure-ftpd options will appear. Leave these options at their defaults, then press [tab] to select <span class="b">OK</span> and [enter] to continue.</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="configure-id25" class="calibre8" id="configure-id25"/>
<h3 class="docSection1Title" id="-100000">26.7. CONFIGURE</h3>
<p class="docText1"><a name="Once the" class="calibre8" id="Once the"/>Once the installation process is complete, it's time to configure Pure-FTPd for use on your system.</p>
<div class="calibre34"><ol class="docList" type="1"><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="sample configuration" class="calibre8" id="sample configuration"/>Copy the sample configuration file named <span class="docEmphasis1">pure-ftpd.conf.sample</span> to <span class="docEmphasis1">pure-ftpd.conf</span> in <span class="docEmphasis1">/usr/local/etc</span><a name="to set" class="calibre8" id="to set"/>. This file will be used to set configuration options.</p><pre class="calibre30"># <b class="calibre28">cd /usr/local/etc</b>
# <b class="calibre28">cp pure-ftpd.conf.sample pure-ftpd.conf</b>
# <b class="calibre28">ee pure-ftpd.conf</b></pre>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="location of" class="calibre8" id="location of"/>Specify the location of the virtual users database. Scroll down to the <tt class="calibre20">PureDB</tt><a name="the leading" class="calibre8" id="the leading"/> statement (~126), uncomment it (remove the leading hash mark) and change the path to <span class="docEmphasis1">/usr/local/etc/pureftpd.pdb</span>. The <tt class="calibre20">PureDB</tt> statement should appear as follows:</p><pre class="calibre30">PureDB               /usr/local/etc/pureftpd.pdb</pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="a user" class="calibre8" id="a user"/>To make adding new virtual users easier, configure Pure-FTPd to automatically create a user's home directory upon login (if it doesn't already exist). Uncomment the <tt class="calibre20">CreateHomeDir</tt> statement (~336) to enable this feature. The <tt class="calibre20">CreateHomeDir</tt> statement should look like this:</p><pre class="calibre30">CreateHomeDir        yes</pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="disabled by" class="calibre8" id="disabled by"/>Pure-FTPd is automatically compiled with SSL/TLS support. It is, however, disabled by default. If you do not wish to enable SSL/TLS encryption, save, exit, and skip to step 8.</p></div></li></ol></div>
<a name="configuring_ssl_solidus_tls" class="calibre8" id="configuring_ssl_solidus_tls"/>
<h4 id="title-ID0E3VAO" class="docSection1Title">26.7.1. Configuring SSL/TLS</h4>
<p class="docText1"><a name="The" class="calibre8" id="The"/>An FTP session utilizes a control channel and a data channel. The <span class="docEmphasis1">control channel</span><a name="initial authentication" class="calibre8" id="initial authentication"/> is responsible for handling the initial authentication, commands to the server, and the server's responses. The <span class="docEmphasis1">data channel</span> is used to transmit data during file transfers.</p>
<p class="docText1"><a name="control channel" class="calibre8" id="control channel"/>Pure-FTPd, if configured with SSL/TLS, can provide encryption for the control channel, although information on the data channel is still transmitted "in the clear." For a higher level of security, look at other solutions like SFTP, which is part of OpenSSH.</p>
<div class="calibre34"><ol class="docList" type="1" start="continues"><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="Uncomment the" class="calibre8" id="Uncomment the"/>Uncomment the <tt class="calibre20">TLS</tt><a name="specify " class="calibre8" id="specify "/> declaration (~422) and specify 1 or 2. There are two possible SSL/TLS configurations: The first (option 1) allows both unencrypted and encrypted connections to occur, while the second (option 2) allows only encrypted connections. The example below enables both encrypted and unencrypted connections:</p><pre class="calibre30">TLS                 1</pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1">Save and exit.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="key file" class="calibre8" id="key file"/>Pure-FTPd needs your server certificate and key file combined into a single file to function properly. We will assume your certificates and private key reside in <span class="docEmphasis1">/usr/local/openssl/certs</span><a name="commands will" class="calibre8" id="commands will"/>. The following commands will merge your server's private key file with your server certificate file into a new file that Pure-FTPd can use:</p><pre class="calibre30"># <b class="calibre28">cd /usr/local/openssl/certs</b>
# <b class="calibre28">cp</b> <span class="docEmphBoldItalic">host.example.com</span><b class="calibre28">-unencrypted-key.pem pure-ftpd.pem</b>
# <b class="calibre28">chmod 400 pure-ftpd.pem</b>
# <b class="calibre28">cat</b> <span class="docEmphBoldItalic">host.example.com</span><b class="calibre28">-cert.pem &gt;&gt; pure-ftpd.pem</b>
# <b class="calibre28">mkdir /etc/ssl/private</b>
# <b class="calibre28">mv pure-ftpd.pem /etc/ssl/private</b></pre><br class="calibre1"/>
<hr size="1" noshade="noshade" class="calibre27"/><span><i class="docEmphasis1"><b class="calibre28">Note:</b></i> Replace the filenames above to match the naming conventions used when you created your server key and certificate files with OpenSSL (see "<a class="calibre2" href="openssl_0.9.8g.html#openssl_0.9.8g">OpenSSL 0.9.8g</a>").</span><hr size="1" noshade="noshade" class="calibre27"/><p class="docText1"><a class="calibre2" target="_blank" href="http://host.example.com-unencrypted-key.pem">host.example.com-unencrypted-key.pem</a><a name="key file" class="calibre8" id="key file"/> Your server's unencrypted private key file</p><p class="docText1"><a class="calibre2" target="_blank" href="http://host.example.com-cert.pem">host.example.com-cert.pem</a> Your server's public certificate file</p><p class="docText1"><a class="calibre2" target="_blank" href="http:///etc/ssl/private/pure-ftpd.pem">/etc/ssl/private/pure-ftpd.pem</a> Pure-FTPd looks for the SSL Certificate here</p></div></li></ol></div>
<a name="importing_and_adding_users" class="calibre8" id="importing_and_adding_users"/>
<h4 id="title-ID0EXYAO" class="docSection1Title">26.7.2. Importing and Adding Users</h4>
<div class="calibre34"><ol class="docList" type="1" start="continues"><li class="calibre16"><div class="calibre35"><p class="docText1">You may either import users with system-level accounts (those listed in <span class="docEmphasis1">/etc/master.passwd</span><a name="to step" class="calibre8" id="to step"/>) en masse or create new users manually. To create users manually, skip to step 9. To import users that already exist on your system into the virtual user database, enter these commands:</p><pre class="calibre30"># <b class="calibre28">pure-pwconvert &gt;&gt; /usr/local/etc/pureftpd.passwd</b>
# <b class="calibre28">chmod 600 /usr/local/etc/pureftpd.passwd</b>
# <b class="calibre28">pure-pw mkdb</b></pre><br class="calibre1"/>
<hr size="1" noshade="noshade" class="calibre27"/><span><i class="docEmphasis1"><b class="calibre28">Note:</b></i> This utility will only import accounts that have shell access. Accounts with their shell set to <tt class="calibre20"><i class="docEmphasis1">nologin</i></tt> will need to be added manually.</span><hr size="1" noshade="noshade" class="calibre27"/></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="virtual user" class="calibre8" id="virtual user"/>To add users to the Pure-FTPd virtual user database manually, we need to create a system-level account that will be associated with virtual users. Create a new user named vftp like this:</p><pre class="calibre30"># <b class="calibre28">pw user add vftp -s /sbin/nologin -w no -d /usr/home/vftp\</b>
? <b class="calibre28">-c "Virtual FTP User" -m</b></pre><br class="calibre1"/>
<p class="docText1"><a name="users database" class="calibre8" id="users database"/>We are now able to add users to the virtual users database using the commands below. Replace <tt class="calibre20"><i class="docEmphasis1">user</i></tt><a name="to create" class="calibre8" id="to create"/> with the username you want to create.</p><pre class="calibre30"># <b class="calibre28">pure-pw useradd</b> <span class="docEmphBoldItalic">user</span> <b class="calibre28">-u vftp -g vftp -d /usr/home/vftp/</b><span class="docEmphBoldItalic">user</span>
# <b class="calibre28">pure-pw mkdb</b></pre><br class="calibre1"/>
<p class="docText1"><a name="with a" class="calibre8" id="with a"/>To add additional users, simply repeat the commands above with a different user.</p></div></li></ol></div>
<a name="configuring_anonymous_ftp" class="calibre8" id="configuring_anonymous_ftp"/>
<h4 id="title-ID0E21AO" class="docSection1Title">26.7.3. Configuring Anonymous FTP</h4>
<p class="docText1"><a name="configure anonymous" class="calibre8" id="configure anonymous"/>We'll configure anonymous FTP access in the next step. If you do not wish to configure anonymous FTP, skip to "<a class="calibre2" href="testing-id16.html#testing-id16">Testing</a>".<a name="IDX-CHP-26-0390" class="calibre8" id="IDX-CHP-26-0390"/></p>
<hr size="1" noshade="noshade" class="calibre27"/><span><i class="docEmphasis1"><b class="calibre28">Note:</b></i> Take great care when running an anonymous FTP server. A single ill-configured option can compromise your system's security.</span><hr size="1" noshade="noshade" class="calibre27"/>
<div class="calibre34"><ol class="docList" type="1" start="continues"><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="new system" class="calibre8" id="new system"/>Create a new system-level user named ftp like this:</p><pre class="calibre30"># <b class="calibre28">pw user add ftp -s /sbin/nologin -w no -d /usr/home/ftp\</b>
? <b class="calibre28">-c "Anonymous FTP User" -m</b>
# <b class="calibre28">rm /usr/home/ftp/.??*</b></pre><br class="calibre1"/>
<p class="docText1"><a name="structure of" class="calibre8" id="structure of"/>You may create a directory structure of your choice in <span class="docEmphasis1">/usr/home/ftp</span><a name="directories that" class="calibre8" id="directories that"/>. To create directories that anonymous users can upload to, use a mode of 777 on the directory. For read-only access to files, use a mode of 444. For read-only access to directories, use a mode of 555.</p><p class="docText1"><a name="allow upload" class="calibre8" id="allow upload"/>For example, you could allow upload access to the directory <span class="docEmphasis1">/usr/home/ftp/upload</span><a name="the upload" class="calibre8" id="the upload"/>. The following commands will make the home directory read only, create the upload directory, and give anonymous users write permissions there:</p><pre class="calibre30"># <b class="calibre28">chmod 555 /usr/home/ftp</b>
# <b class="calibre28">mkdir /usr/home/ftp/upload</b>
# <b class="calibre28">chmod 777 /usr/home/ftp/upload</b></pre><br class="calibre1"/>
<hr size="1" noshade="noshade" class="calibre27"/><span><i class="docEmphasis1"><b class="calibre28">Note:</b></i> Be sure to monitor the files in the <span class="docEmphasis1">/usr/home/ftp/upload</span> directory, since you can be held responsible if users place illegal content there. Consult the <span class="docEmphasis1">pure-ftpd.conf</span> file in <span class="docEmphasis1">/usr/local/etc</span> for anonymous login-related options. Refer to "<a class="calibre2" href="general.html#chown">chown</a>" and "<a class="calibre2" href="general.html#chmod">chmod</a>" for details on setting file ownership and permissions.</span><hr size="1" noshade="noshade" class="calibre27"/></div></li></ol></div>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="testing-id16" class="calibre8" id="testing-id16"/>
<h3 class="docSection1Title" id="-100000">26.8. TESTING</h3>
<p class="docText1"><a name="In this" class="calibre8" id="In this"/>In this section we'll perform some basic tests to confirm that Pure-FTPd functions properly.<a name="IDX-CHP-26-0391" class="calibre8" id="IDX-CHP-26-0391"/></p>
<div class="calibre34"><ol class="docList" type="1"><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="command to" class="calibre8" id="command to"/>Enter this command to start Pure-FTPd:</p><pre class="calibre30"># <b class="calibre28">/usr/local/etc/rc.d/pure-ftpd onestart</b></pre>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="this command" class="calibre8" id="this command"/>Initiate an FTP connection with this command (use your system's hostname):</p><pre class="calibre30"># <b class="calibre28">ftp</b> <span class="docEmphBoldItalic">localhost</span></pre><br class="calibre1"/>
<p class="docText1"><a name="message should" class="calibre8" id="message should"/>The login message should look like this:</p><pre class="calibre30">Connected to host.example.com.
220---------- Welcome to Pure-FTPd [TLS] ----------
220-You are user number 1 of 50 allowed.
220-Local time is now 15:16. Server port: 21.
220-IPv6 connections are also welcome on this server.
220 You will be disconnected after 15 minutes of inactivity.
Name (host.example.com:user):</pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="a user" class="calibre8" id="a user"/>Log in with a user account you created earlier and get a directory listing with the <tt class="calibre20">ls</tt> command. If the directory listing is successful, the test succeeds. Enter <tt class="calibre20"><b class="calibre28">quit</b></tt> to exit the FTP session.</p><hr size="1" noshade="noshade" class="calibre27"/><span><i class="docEmphasis1"><b class="calibre28">Note:</b></i> In order to test TLS/SSL functionality, you'll need a TLS/SSL-capable FTP client like Cyberduck for the Macintosh or FileZilla for Windows.</span><hr size="1" noshade="noshade" class="calibre27"/></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="To do" class="calibre8" id="To do"/>If the test was successful, configure Pure-FTPd to start automatically at system startup. To do so, open <span class="docEmphasis1">etc/rc.conf</span>:</p><pre class="calibre30"># <b class="calibre28">ee /etc/rc.conf</b></pre><br class="calibre1"/>
<p class="docText1">and add the following line:</p><pre class="calibre30">pureftpd_enable="YES"</pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1">Save, exit, and restart Pure-FTPd:</p><pre class="calibre30"># <b class="calibre28">/usr/local/etc/rc.d/pure-ftpd restart</b>
# <b class="calibre28">/usr/local/etc/rc.d/pure-ftpd status</b></pre><br class="calibre1"/>
</div></li></ol></div>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="utilities-id8" class="calibre8" id="utilities-id8"/>
<h3 class="docSection1Title" id="-100000">26.9. UTILITIES</h3>
<p class="docText1"><a name="Following is" class="calibre8" id="Following is"/>Following is brief information on the pure-pw and pure-ftpwho utilities.</p>
<a name="pure-pw" class="calibre8" id="pure-pw"/>
<h4 id="title-ID0E3UAO" class="docSection1Title">26.9.1. pure-pw</h4>
<p class="docText1"><a name="and displays" class="calibre8" id="and displays"/>The pure-pw utility adds, deletes, modifies, and displays information about the Pure-FTPd virtual user database.</p>
<a name="IDX-CHP-26-0392" class="calibre8" id="IDX-CHP-26-0392"/><dl class="docList1">
<dt class="calibre1"><p class="calibre23"><span class="docPubcolor"><span class="b">Command</span></span></p></dt>
<dd class="calibre36"><p class="docText1"><tt class="calibre20">pure-pw</tt><a name="IDX-CHP-26-0392" class="calibre8" id="IDX-CHP-26-0392"/></p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"><span class="b">Syntax</span></span></p></dt>
<dd class="calibre36"><p class="docText1"><tt class="calibre20">pure-pw</tt> <tt class="calibre20"><i class="docEmphasis1">command</i></tt> <tt class="calibre20"><i class="docEmphasis1">user</i></tt> <tt class="calibre20">-</tt><tt class="calibre20"><i class="docEmphasis1">options</i></tt></p></dd>
</dl>
<p class="docText1"><span class="b">Commands</span></p>
<dl class="docList1">
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">useradd</pre></p></dt>
<dd class="calibre36"><p class="docText1">Adds a virtual user to <span class="docEmphasis1">pureftpd.passwd</span> file</p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">usermod</pre></p></dt>
<dd class="calibre36"><p class="docText1"><a name="in" class="calibre8" id="in"/>Modifies a virtual user entry in <span class="docEmphasis1">pureftpd.passwd</span> file</p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">userdel</pre></p></dt>
<dd class="calibre36"><p class="docText1"><a name="virtual user" class="calibre8" id="virtual user"/>Deletes a virtual user</p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">passwd</pre></p></dt>
<dd class="calibre36"><p class="docText1"><a name="user password" class="calibre8" id="user password"/>Changes a virtual user password</p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">show</pre></p></dt>
<dd class="calibre36"><p class="docText1">Displays details about the specified user</p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">list</pre></p></dt>
<dd class="calibre36"><p class="docText1">Displays a list of users in the <span class="docEmphasis1">pureftpd.passwd</span> file</p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">mkdb</pre></p></dt>
<dd class="calibre36"><p class="docText1">Exports the <span class="docEmphasis1">pureftpd.passwd</span> file to the <span class="docEmphasis1">pureftpd.pdb</span><a name="to" class="calibre8" id="to"/> database file; this command must be run after making any modifications to <span class="docEmphasis1">pureftpd.passwd</span></p></dd>
</dl>
<p class="docText1"><span class="b">Options</span></p>
<dl class="docList1">
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">-u</pre></p></dt>
<dd class="calibre36"><p class="docText1">System user ID</p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">-g</pre></p></dt>
<dd class="calibre36"><p class="docText1">System group ID</p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">-d</pre></p></dt>
<dd class="calibre36"><p class="docText1">Home directory</p></dd>
</dl>
<p class="docText1"><span class="b">Examples</span></p>
<p class="docText1"><a name="named jill" class="calibre8" id="named jill"/>To delete a virtual user named jill from the virtual user database, enter:</p>
<pre class="calibre30"># <b class="calibre28">pure-pw userdel jill</b>
# <b class="calibre28">pure-pw mkdb</b></pre><br class="calibre1"/>
<p class="docText1">To change the password of a virtual user named jack, enter:</p>
<pre class="calibre30"># <b class="calibre28">pure-pw passwd jack</b>
# <b class="calibre28">pure-pw mkdb</b></pre><br class="calibre1"/>
<a name="pure-ftpwho" class="calibre8" id="pure-ftpwho"/>
<h4 id="title-ID0EX1AO" class="docSection1Title">26.9.2. pure-ftpwho</h4>
<p class="docText1">The pure-ftpwho utility monitors current FTP client sessions.</p>
<a name="IDX-CHP-26-0393" class="calibre8" id="IDX-CHP-26-0393"/><dl class="docList1">
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"><span class="b">Command</span></span></p></dt>
<dd class="calibre36"><p class="docText1"><tt class="calibre20">pure-ftpwho</tt><a name="IDX-CHP-26-0393" class="calibre8" id="IDX-CHP-26-0393"/></p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"><span class="b">Syntax</span></span></p></dt>
<dd class="calibre36"><p class="docText1"><tt class="calibre20">pure-ftpwho -</tt><tt class="calibre20"><i class="docEmphasis1">options</i></tt></p></dd>
</dl>
<p class="docText1"><span class="b">Option</span></p>
<dl class="docList1">
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">-v</pre></p></dt>
<dd class="calibre36"><p class="docText1">Verbose mode (adds local IP address, port, and transfer stats to output)</p></dd>
</dl>
<p class="docText1"><span class="b">Example</span></p>
<p class="docText1">To display the current FTP client sessions with transfer statistics, enter:</p>
<pre class="calibre30"># <b class="calibre28">pure-ftpwho -v</b></pre><br class="calibre1"/>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="config_files-id25" class="calibre8" id="config_files-id25"/>
<h3 class="docSection1Title" id="-100000">26.10. CONFIG FILES</h3>
<p class="docText1"><span class="b">/usr/local/etc/pure-ftpd.conf</span><a name="IDX-CHP-26-0394" class="calibre8" id="IDX-CHP-26-0394"/><a name="IDX-CHP-26-0395" class="calibre8" id="IDX-CHP-26-0395"/><a name="IDX-CHP-26-0396" class="calibre8" id="IDX-CHP-26-0396"/><a name="IDX-CHP-26-0397" class="calibre8" id="IDX-CHP-26-0397"/><a name="IDX-CHP-26-0398" class="calibre8" id="IDX-CHP-26-0398"/><a name="IDX-CHP-26-0399" class="calibre8" id="IDX-CHP-26-0399"/></p>
<p class="docText1"><a name="This is" class="calibre8" id="This is"/>This is the primary configuration file. It contains options that the <span class="docEmphasis1">pure-config.pl</span><a name="to the" class="calibre8" id="to the"/> script passes to the Pure-FTP daemon upon startup.</p>
<p class="docText1"><span class="b">/usr/local/etc/pureftpd.passwd</span></p>
<p class="docText1"><a name="directory information" class="calibre8" id="directory information"/>This file contains usernames, hashed passwords, and directory information on virtual users.</p>
<p class="docText1"><span class="b">.banner</span></p>
<p class="docText1"><a name="a text" class="calibre8" id="a text"/>This is a text file that is automatically displayed at login when put into a user's home directory.</p>
<p class="docText1"><span class="b">.message</span></p>
<p class="docText1"><a name="is automatically" class="calibre8" id="is automatically"/>This text file is automatically displayed when a user enters its parent directory.</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="log_files-id14" class="calibre8" id="log_files-id14"/>
<h3 class="docSection1Title" id="-100000">26.11. LOG FILES</h3>
<p class="docText1"><span class="b">/var/log/xferlog</span></p>
<p class="docText1"><a name="Stores FTP" class="calibre8" id="Stores FTP"/>Stores FTP session information and error messages</p>
<p class="docText1"><span class="b">/var/log/messages</span></p>
<p class="docText1"><a name="messages reported" class="calibre8" id="messages reported"/>Records error messages reported by Pure-FTPd</p>
<p class="docText1"><span class="b">/var/log/debug.log</span></p>
<p class="docText1"><a name="client commands" class="calibre8" id="client commands"/>Stores a log of all client commands if the <tt class="calibre20">VerboseLog</tt><a name="set to" class="calibre8" id="set to"/> declaration is set to yes in <span class="docEmphasis1">pure-ftpd.conf</span><a name="IDX-CHP-26-0400" class="calibre8" id="IDX-CHP-26-0400"/></p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="notes-id19" class="calibre8" id="notes-id19"/>
<h3 class="docSection1Title" id="-100000">26.12. NOTES</h3>
<ul class="calibre15"><li class="calibre16"><p class="docText1"><a name="By default" class="calibre8" id="By default"/>By default all user accounts are <span class="docEmphasis1">caged</span><a name="their respective" class="calibre8" id="their respective"/>, or restricted, to their respective home directories. If you need to allow access to a specific directory outside a user's home directory, symbolic links may be used. For example, say a webmaster, Michelle (username michelle), needs access to the <span class="docEmphasis1">/usr/local/www/apache22/data</span><a name="can create" class="calibre8" id="can create"/> directory to upload web content. You can create a symbolic link to this directory like this:</p><pre class="calibre30"># <b class="calibre28">cd /usr/home/vftp/michelle</b>
# <b class="calibre28">ln -s /usr/local/www/data-dist www</b></pre>
<p class="docText1"><a name="have the" class="calibre8" id="have the"/>Michelle will have the permissions of the associated userID and groupID you specified when you added her to the <span class="docEmphasis1">pureftpd.passwd</span><a name="to change" class="calibre8" id="to change"/> file. You may need to change her associated userID and/or groupID with the pure-pw utility to allow appropriate read/write/execute access to the newly linked directory. (If so, you might change her user and group IDs to www.) You may also choose to change user or group ownership of files and directories to accommodate her existing userID and groupID.</p><hr size="1" noshade="noshade" class="calibre27"/><span><i class="docEmphasis1"><b class="calibre28">Note:</b></i> Be sure you understand file ownership and permissions prior to implementing a scheme like this, as it may have security implications.</span><hr size="1" noshade="noshade" class="calibre27"/></li><li class="calibre16"><p class="docText1"><a name="problems may" class="calibre8" id="problems may"/>If your server is behind a firewall (such as a NAT router), problems may arise with clients trying to initiate connections because the Pure-FTP daemon tries to establish data connections on arbitrary ports when in active mode. If you encounter this, configure your FTP client to use passive mode.</p></li><li class="calibre16"><p class="docText1"><a name="not documented" class="calibre8" id="not documented"/>Pure-FTPd contains dozens of other features not documented here. Consult the Pure-FTPd project webpage <a class="calibre2" target="_blank" href="http://www.pureftpd.org/project/pure-ftpd">http://www.pureftpd.org/project/pure-ftpd</a> or manual page for details. The following command displays Pure-FTPd's man page:</p><pre class="calibre30"># <b class="calibre28">man pure-ftpd</b></pre><br class="calibre1"/>
</li></ul>
</div></div>

</body></html>