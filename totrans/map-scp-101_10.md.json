["```\n<html >\n    <head>\n      <title>Weather Map Mashup</title>\n      <style>\n        div#mymap {\n          width: 800px;\n          height: 450px;\n        }\n\n      </style>\n❶     <script src=\"http://ajax.googleapis.com/ajax/libs/\njquery/1.3/jquery.min.js\"></script>\n      <script type=\"text/javascript\" src=\"http://maps.google.com/\nmaps/api/js?sensor=false\"></script>\n      <script src=\"mxn.js?(googlev3)\"></script>\n      <script type=\"text/javascript\">\n        var mapstraction;\n❷       var center = new mxn.LatLonPoint(38,-98);\n❸       var zoom = 4;\n\n        function create_map() {\n          mapstraction = new mxn.Mapstraction('mymap', 'googlev3');\n          mapstraction.setCenterAndZoom(center, zoom);\n          mapstraction.addControls({\"zoom\":\"large\"});\n\n        }\n      </script>\n    </head>\n    <body onload=\"create_map()\">\n      <div id=\"mymap\"></div>\n\n    </body>\n    </html>t\n```", "```\n<rss version=\"2.0\" xmlns:yweather=\"http://xml.weather\n.yahoo.com/ns/rss/1.0\" >\n<channel>\n...\n<item>\n<title></title>\n<geo:lat></geo:lat>\n<geo:long></geo:long>\n\n</item></channel></rss>\n```", "```\n{\"count\":1,\"value\":{\"items\":[{\"geo:long\":\"-93.26\",\"geo:lat\":\"44.98\",\n\"description\":\"<img src=\\\"http:\\/\\/l.yimg.com\\/a\\/i\\/us\\/we\\/52\\/26.gif\\\"\\/>\n<br \\/>\\n<b>Current Conditions:<\\/b><br \\/>\\nCloudy...\",\"yweather:condition\":\n{\"temp\":\"50\",\"text\":\"Cloudy\",...,\"code\":\"26\"}}]}\n```", "```\nvar weatherids = [\n      \"USIL0225\", // Chicago\n      \"USTX0327\", // Dallas\n      \"USCO0105\", // Denver\n      \"USFL0316\", // Miami\n      \"USMN0503\", // Minneapolis\n      \"USTN0357\", // Nashville\n      \"USNY0996\", // New York City\n      \"USAZ0166\", // Phoenix\n      \"USMO0787\", // Saint Louis\n      \"USCA0987\", // San Francisco\n      \"USWA0395\" // Seattle\n    ];\n```", "```\nvar pipeid = \"Sbcb8u8J3hGNdOcopgt1Yg\";for (var i=0; i < weatherids.length; i++) {\n  var pipeurl = \"http://pipes.yahoo.com/pipes/pipe.run?_id=\" + pipeid;\n  pipeurl += \"&_render=json&location=\" + weatherids[i] + \"&_callback=?\";\n  jQuery.getJSON(pipeurl, add_weather);}\n```", "```\nfunction add_weather(data) {\n  jQuery.each(data.value.items, function(i, item) {\n    var lat = item[\"geo:lat\"];\n    var lon = item[\"geo:long\"];\n    var code = item[\"yweather:condition\"].code;\n    var imgsrc = \"http://l.yimg.com/a/i/us/we/52/\" + code + \".gif;\n\n    `add_marker`({\"lat\":lat, \"lon\":lon, \"code\":code, \"imgsrc\":imgsrc});\n}\n```", "```\nfunction add_marker(options) {\n  var marker = new mxn.Marker(new mxn.LatLonPoint(options[\"lat\"], options[\"lon\"]));\n  marker.setIcon(options[\"imgsrc\"], [52,52]);\n  marker.setShadowIcon('❶blankshadow.png', [0,0]);\n  mapstraction.addMarker(marker);\n}\n```", "```\n<div id=\"forecast\"></div>\n```", "```\ndiv#forecast {\n  position: relative;\n  width: 200px;\n  height: 400px;\n  background-color: #fff;\n  top: −435px;\n  left: 550px;\n  padding: 10px;\n}\n```", "```\n$('#forecast').hide();\n```", "```\nvar desc = item.description;\n```", "```\nadd_marker({\"lat\":lat, \"lon\":lon, \"code\":code, \"desc\":desc, \"imgsrc\":imgsrc});\n```", "```\nmarker.setInfoDiv(❶options[\"desc\"] + \"<p><a href=\\\"javascript:return_center()\\\">\"\n    + ❷\"<img src=\\\"usmap.png\\\" border=\\\"0\\\" alt=\\\"Return to full map\\\" />\"\n    + \"</a></p>\", ❸\"forecast\");\n```", "```\nmarker.click.addHandler(marker_clicked);\n```", "```\nfunction marker_clicked(event_name, event_source, event_args) {\n❹   mapstraction.setCenterAndZoom(event_source.location, 6);\n    var bounds = mapstraction.getBounds();\n    var diff = ((bounds.ne.lon − bounds.sw.lon)/4);\n❺   mapstraction.setCenter(\n      new mxn.LatLonPoint(mapstraction.getCenter().lat, bounds.ne.lon − diff));\n❻   $('#forecast').show();\n  });\n```", "```\nfunction return_center() {\n  mapstraction.setCenterAndZoom(center, zoom);\n  $('#forecast').hide();\n}\n```", "```\n<feed xml:base=\"http://earthquake.usgs.gov/\" \n      >\n<title>USGS M2.5+ Earthquakes</title>\n<subtitle>Real-time, worldwide earthquake list for the past 7 days</subtitle>\n<entry>\n  <id>...</id>\n  <title>M 2.6, Washington</title>\n  <updated>YYYY-MM-DDTHH:MM:SSZ</updated>\n  <link rel=\"alternate\" type=\"text/html\" href=\"/eqcenter/recenteqsww/Quakes/...\"/>\n  <summary type=\"html\">...</summary>\n  <georss:point>46.4078 −119.2521</georss:point>\n</entry>\n<entry>\n...\n</entry>\n...\n</feed>\n```", "```\n<html >\n  <head>\n    <title>Earthquake GeoRSS Map</title>\n    <script src=\"http://maps.google.com/maps?file=api&amp;v=2&amp;key=\n*`YOURKEY`*\" type=\"text/javascript\"></script>\n    <script type=\"text/javascript\" src=\"mxn.js?(google)\"></script>\n    <style type=\"text/css\">\n    div#mymap {\n      width: 550px;\n      height: 450px;\n    }\n    </style>\n    <script type=\"text/javascript\">\n    var mapstraction;\n    function create_map() {\n      mapstraction = new mxn.Mapstraction('mymap', 'google');\n      mapstraction.setCenterAndZoom(❶ new mxn.LatLonPoint(0, 0), 0);\n      mapstraction.addControls({zoom: 'large'});\n      `mapstraction.addOverlay(`\n        `\"http://earthquake.usgs.gov/eqcenter/catalogs/7day-M2.5.xml\");`\n      mapstraction.autoCenterAndZoom();\n    }\n    </script>\n  </head>\n  <body onload=\"create_map()\">\n    <div id=\"mymap\"></div>\n </body>\n</html>\n```", "```\n<html >\n    <head>\n      <title>Earthquake Map Mashup</title>\n      <style type=\"text/css\">\n        div#mymap {\n          width: 550px;\n          height: 450px;\n        }\n      </style>\n❶     <script type=\"text/javascript\"\n  src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js\"></script>\n      <script src=\"http://maps.google.com/maps?file=api&amp;v=2&amp;key=\n*`YOURKEY`*\" type=\"text/javascript\"></script>\n      <script type=\"text/javascript\" src=\"mxn.js?(google)\"></script>\n      <script type=\"text/javascript\">\n        var mapstraction;\n❷       var defaultloc = {\"point\": new mxn.LatLonPoint(14.6048\n47155053898, −177.1875),  \"zoom\": 1};\n\n        function create_map() {\n          mapstraction = new mxn.Mapstraction('mymap', 'google');\n          mapstraction.setMapType(mxn.Mapstraction.HYBRID);\n          mapstraction.addControls({\"zoom\":\"large\"});\n          view_world();\n\n        }\n        function view_world() {\n❸         mapstraction.setCenterAndZoom(defaultloc[\"point\"], defaultloc[\"zoom\"]);\n        }\n      </script>\n    </head>\n    <body onload=\"create_map()\">\n      <div id=\"mymap\"></div>\n    </body>\n    </html>\n```", "```\nselect * from atom where\n  url='http://earthquake.usgs.gov/eqcenter/catalogs/7day-M2.5.xml'\n```", "```\n// Data and marker functions\n  function get_quakes() {\n❶   var jsonurl = \"http://query.yahooapis.com/v1/public/yql\"\n    + \"?q=select+*+from+atom+where+url%3D'http%3A%2F%2Fearthquake.usgs.gov\"\n    + \"%2Feqcenter%2Fcatalogs%2F7day-M2.5.xml'\"\n    + \"&format=json&diagnostics=true&callback=?\";\n    jQuery.getJSON(jsonurl, function(data) {\n❷     jQuery.each(data.query.results.entry, function(i, item) {\n        // Get Lat/Lon point\n        var lltxt = item.point;\n❸       var llarr = lltxt.split(\" \");\n        // Get Richter value\n        var richter = item.title;\n❹       richter = richter.substr(2, 3);\n        var majorrichter = richter.substring(0, 1);\n        var iconvals = get_icon(majorrichter);\n        // Find link\n        var link;\n        if (item.link[0]) {\n          link = item.link[0].href;\n        }\n        else {\n          link = item.link.href;\n        }\n        // Create marker\n        var marker = new mxn.Marker(new mxn.LatLonPoint(llarr[0], llarr[1]));\n        marker.setIcon(iconvals.name, iconvals.size);\n❺       marker.setShadowIcon('blankshadow.png', [0,0]);\n        var eqdate = item.updated.substr(0, 10);\n❻       marker.setInfoBubble('<strong>' + item.title +\n '</strong><p>On ' + eqdate +  ' (<a href=\"' + link + '\">more info</a>)</p>');\n        mapstraction.addMarker(marker);\n      });\n    });\n  }\n  function get_icon(majorrichter) {\n    var identifier;\n    var size;\n    if (majorrichter < 4) {\n      identifier = \"low\";\n      size = [10, 10];\n    }\n    else if (majorrichter == 4) {\n      identifier = \"med\";\n      size = [15, 15];\n    }\n    else {\n      identifier = \"high\";\n      size = [20, 20];\n    }\n    return {\"name\": \"richter-\" + identifier + \".png\", \"size\": size};\n  }\n```", "```\n<ol id=\"legend\">\n  <li><img src=\"richter-low.png\" /> 2.5 − 3.9</li>\n  <li><img src=\"richter-med.png\" /> 4.0 − 4.9</li>\n  <li><img src=\"richter-high.png\" /> 5.0+</li>\n</ol>\n```", "```\nol#legend {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n}\nol#legend li {\n  display: inline;\n  padding-right: 30px;\n}\n```", "```\nvar regions = {\n  \"California\": new mxn.BoundingBox(30, −136, 45, −101),\n  \"Alaska\": new mxn.BoundingBox(48, 164, 68, −125),\n  \"Latin America\": new mxn.BoundingBox(−47, −112, 24, −15),\n  \"Southeast Asia\": new mxn.BoundingBox(−33, 52, 39, −167)\n};\n```", "```\n❶ google.maps.event.addListener(mapstraction.getMap(), 'mousemove', `check_hover`);\n❷ mapstraction.click.addHandler(function() {\n    if (highlighted) {\n❸     `set_region`(highlighted);\n    }\n  });\n```", "```\n// Region highlight functions\n  var highlighted = \"\";\n  function find_region(cpt) {\n    for (var k in regions) {\n      if (k != \"World\") {\n❶       if (regions[k].contains(cpt)) {\n          return k;\n        }\n      }\n    }\n    return \"\";\n  }\n  function check_hover(google_event) {\n    // Google-specific code to convert event to Mapstraction LatLonPoint\n    pt = new mxn.LatLonPoint(google_event.latLng.lat(), google_event.latLng.lng());\n    // Mapstraction code to highlight appropriate region\n    var regionin = find_region(pt);\n    if (regionin) {\n❷     if (highlighted != regionin) {\n        highlighted = regionin;\n        highlight_region(regionin);\n      }\n    }\n❸   else if (highlighted) {\n      highlighted = \"\";\n❹     mapstraction.removeAllPolylines();\n    }\n  }\n```", "```\nfunction highlight_region(name) {\n    var bounds = regions[name];\n    if (bounds) {\n      mapstraction.removeAllPolylines();\n❺     var pdata = {\"color\": \"white\"};\n      var poly = BoundingBox_to_Polyline(bounds);\n      mapstraction.addPolylineWithData(poly, pdata);\n    }\n  }\n  function BoundingBox_to_Polyline(box) {\n    var points = [box.sw, new mxn.LatLonPoint(box.ne.lat, box.sw. Lon),\n                  box.ne, new mxn.LatLonPoint(box.sw.lat, box.ne.lon),\n                  new mxn.LatLonPoint(box.sw.lat, box.sw.lon-.0001)];\n    var poly = new mxn.Polyline(points);\n    return poly;\n  }\n```", "```\nfunction set_region(name) {\n  var bounds = regions[name];\n  if (bounds) {\n    mapstraction.setBounds(bounds);\n  }\n}\n```", "```\n<a href=\"#\" id=\"reset\"><img src=\"worldmap.png\" /></a>\n```", "```\n#reset img {\n  border: 5px solid white;\n  position: relative;\n  top: −435px;\n  left: 430px;\n}\n```", "```\n$(\"#reset\").click(view_world);\n```", "```\n$(\"#reset\").hide();\n```", "```\n$(\"#reset\").show();\n```", "```\n<html >\n  <head>\n    <title>Upcoming Music Map Mashup</title>\n❶   <script type=\"text/javascript\"\n    src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js\"></script>\n    <script src=\"http://maps.google.com/maps?file=api&amp;v=2&amp;key=\n*`YOURKEY`*\"  type=\"text/javascript\"></script>\n    <script type=\"text/javascript\" src=\"mxn.js?(google)\"></script>\n    <style type=\"text/css\">\n    div#mymap {\n      width: 550px;\n      height: 450px;\n    }\n    </style>\n    <script type=\"text/javascript\">\n      var mapstraction;\n      function create_map() {\n        mapstraction = new mxn.Mapstraction('mymap', 'google');\n        mapstraction.addControls({\"zoom\":\"large\"});\n        mapstraction.setCenterAndZoom(new mxn.LatLonPoint(45.5, −122.5)❷, 10);\n      }\n    </script>\n  </head>\n  <body onload=\"create_map();\">\n  <p>\n  <form onsubmit=\"`search_upcoming()`; return false;\">\n  Location: <input type=\"text\" name=\"location\" value=\"Portland, OR\"❸ size=\"20\" />\n  <select name=\"radius\" onchange=\"`search_upcoming()`;\">\n    <option value=\"1\">1 mile</option>\n    <option value=\"5\"❹>5 miles</option>\n    <option value=\"10\">10 miles</option>\n    <option value=\"25\" selected=\"selected\">25 miles</option>\n    <option value=\"50\">50 miles</option>\n  </select>\n  <select name=\"cost\" onchange=\"`filter_select(this)`;\">\n    <option value=\"9999\"❺>Any price</option>\n    <option value=\"25\">$25 or less</option>\n    <option value=\"10\">$10 or less</option>\n  </select>\n  <input type=\"submit\" value=\"Search\" />\n  </form>\n  </p>\n  <div id=\"mymap\"></div>\n  </body>\n  </html>\n```", "```\n<rsp stat=\"ok\" version=\"1.0\" resultcount=\"12\">\n<event id=\"1234567\" name=\"Some Band Name\" description=\"...\"\nstart_date=\"2011-04-15\" latitude=\"45.5409\" longitude=\"-122.6637\"\ngeocoding_precision=\"address\" geocoding_ambiguous=\"0\"\nvenue_name=\"Wonder Ballroom\" venue_address=\"128 NE Russell St\"\nvenue_city=\"Portland\" venue_state_name=\"Oregon\" venue_state_code=\"OR\"\nvenue_zip=\"97212\" ticket_url=\"...\" ticket_price=\"$25-$40\" ticket_free=\"0\" />\n<event .... />\n...\n</rsp>\n```", "```\n<?php\n  $apikey = \"*`YOURKEY`*\";\n  $dateformat = \"Y-m-d\";\n  // Get arguments from querystring\n  `$location = $_GET[\"location\"];`\n  `$radius = $_GET[\"radius\"];`\n  `$timeframe = $_GET[\"timeframe\"];`\n  `$tags = $_GET[\"tags\"];`\n  // Determine the timeframe as a timestamp, set max/min date variables\n❶ $mindate = date($dateformat);\n  $maxdate = \"\";\n  switch($timeframe) {\n    case \"1d\":\n      $timestamp = ❷time();\n      break;\n    case \"1m\":\n      $timestamp = strtotime(\"+1 month −1 day\");\n      break;\n    case \"1w\":\n    default:\n      $timestamp = ❸strtotime(\"+1 week −1 day\");\n      break;\n  }\n❹ $maxdate = date($dateformat, $timestamp);\n```", "```\n// Get XML results from Upcoming\n❺ $url = \"http://upcoming.yahooapis.com/services/rest/?api_key=$apikey\";\n  $url .= \"&method=event.search&location=$location&radius=$radius\";\n  $url .= \"&tags=$tags\";\n  $url .= \"&max_date=$maxdate&min_date=$mindate\";\n❻ $xmlobj = get_xml($url);\n  $outobj = array();\n  // Loop through results\n  foreach (❼$xmlobj->event as $event) {\n❽   $attribs = $event->attributes();\n    $id = (int) $attribs->id;\n    $lat = (float) $attribs->latitude;\n    $lon = (float) $attribs->longitude;\n    $title = (string) $attribs->name;\n    $date = (string) $attribs->start_date;\n    $cost = \"\";\n    // Convert ticket price range into number value we can use in JavaScript\n❾   preg_match_all(\"(\\\\\\$\\d+)\", (string) $attribs->ticket_price, $dollars);\n    if (count($dollars) > 0 && count($dollars[0]) > 0) {\n      $cost = $dollars[0][count($dollars[0])-1];\n    }\n    $cost = str_replace(\"$\", \"\", $cost);\n    // Put all results into an array of associative arrays\n    $eventobj = array(\n      \"id\" => $id,\n      \"latitude\" => $lat,\n      \"longitude\" => $lon,\n      \"title\" => $title,\n      \"date\" => $date,\n      \"cost\" => $cost\n    );\n❿   array_push($outobj, $eventobj);\n  }\n```", "```\n// Output values as JSON\nprint header(\"Content-type: application/json\");\nprint json_encode($outobj);\n?>\n```", "```\n<?\n//cUrl functions\nfunction get_url($url) {\n  $c = curl_init();\n  curl_setopt($c, CURLOPT_URL, $url);\n  curl_setopt($c, CURLOPT_RETURNTRANSFER, 1);\n  $content = trim(curl_exec($c));\n  curl_close($c);\n  return $content;\n}\nfunction get_xml($url) {\n  $xml = get_url($url);\n  return simplexml_load_string($xml);\n}\n?>\n```", "```\nfunction search_upcoming() {\n❶   var tags = \"music,concert\";\n    var timeframe = \"1w\";\n❷   var data = {\n      \"location\": f.location.value.replace(\", \", \",\").replace(\" \", \"_\"),\n      \"radius\": f.radius.value,\n      \"tags\": tags,\n      \"timeframe\": timeframe\n    };\n❸   $.get(\"upcoming.php\", data, ❹plot_upcoming);\n  }\n```", "```\nfunction plot_upcoming(jobj) {\n    if (jobj.length > 0) {\n      mapstraction.removeAllMarkers();\n❺     for (var i=0; i < jobj.length; i++) {\n        var ev = jobj[i];\n❻       var url = \"http://upcoming.yahoo.com/event/\" + ev.id;\n        var marker = new mxn.Marker(new mxn.LatLonPoint(ev.latitude, ev.longitude));\n        var cost = ev.cost;\n        if (cost != \"\") {\n❼         marker.setAttribute('cost', parseInt(cost));\n          cost = \" ($\" + cost + \")\"; // Format cost for infoBubble\n        }\n        else {\n          marker.setAttribute('cost', 9999); // Set a way too high value\n        }\n        var bubbletext = ev.date + \" <a href=\\\"\" + url + \"\\\">\" + ev.title\n                         + \"</a>\" + cost;\n        marker.setInfoBubble(bubbletext);\n        mapstraction.addMarker(marker);\n      }\n❽     filter_select(document.forms[0].cost);\n    }\n    else {\n      alert('no results for this search');\n    }\n  }\n```", "```\nfunction filter_select(selobj) {\n❶   var cost = parseInt(selobj.options[selobj.selectedIndex].value);\n    filter_cost(cost);\n  }\n  function filter_cost(amt) {\n❷   mapstraction.removeAllFilters();\n    mapstraction.addFilter('cost', ❸'le', amt);\n    mapstraction.doFilter();\n❹   mapstraction.visibleCenterAndZoom();\n  }\n```", "```\n<html >\n    <head>\n      <title>Show Geocoded Tweets</title>\n      <style>\n        div#mymap {\n          width: 600px;\n          height: 400px;\n        }\n      </style>\n❶     <script type=\"text/javascript\"  src=\"http://ajax.google\napis.com/ajax/libs/jquery/1.3/jquery.min.js\"></script>\n❷     <script type=\"text/javascript\" src=\"http://www.google.com/\njsapi?key=*`YOURKEY`*\"></script>\n      <script type=\"text/javascript\" src=\"mxn.js?(google)\"></script>\n❸     <script type=\"text/javascript\" src=\"mxn.google.geocoder.js\"></script>\n      <script type=\"text/javascript\">\n❹       google.load(\"maps\", \"2\");\n\n        var mapstraction;\n        var radius_field, location_field, kw_field;\n        function create_map() {\n          mapstraction = new mxn.Mapstraction('mymap', 'google');\n          mapstraction.addControls({\"zoom\":\"large\"});\n\n          // Store form field objects\n          radius_field = document.getElementById('radius');\n          location_field = document.getElementById('loc');\n          kw_field = document.getElementById('keyword');\n\n          // Get position from ClientLocation\n          var pos = google.loader.ClientLocation;\n          if (pos) {\n            var posloc = new mxn.LatLonPoint(pos.latitude, pos.longitude);\n            var cityname = pos.address.city + \", \" + pos.address.region;\n            get_twitter_geo(posloc, 5);\n            mapstraction.setCenterAndZoom(posloc, 11);\n\n❺           location_field.value = cityname;\n          }\n          else {\n❻           mapstraction.setCenterAndZoom(new mxn.LatLonPoint(40, −92), 3);\n          }\n        }\n      </script>\n    </head>\n    <body onload=\"create_map()\">\n      <div id=\"mymap\"></div>\n      <form onsubmit=\"geocode_form();return false;\">\n        <input type=\"text\" id=\"keyword\" name=\"keyword\" size=\"25\" /> within\n        <select name=\"radius\" id=\"radius\">\n          <option value=\"1\">1 mi</option>\n          <option value=\"5\" selected>5 mi</option>\n          <option value=\"10\">10 mi</option>\n          <option value=\"25\">25 mi</option>\n        </select>\n        of <input type=\"text\" id=\"loc\" name=\"loc\" size=\"25\" />\n        <input type=\"submit\" value=\"Go\" />\n      </form>\n    </body>\n  </html>\n```", "```\nfunction geocode_form() {\n    var loctxt = location_field.value;\n❶   if (loctxt == \"\") {\n      call_twitter_geo({point: mapstraction.getCenter()});\n    }\n    else {\n      geocoder = new MapstractionGeocoder(❷call_twitter_geo,\n 'google'); var address = { address: loctxt };\n❸     geocoder.geocode(address);\n    }\n  }\n```", "```\nfunction call_twitter_geo(❹loc) {\n    mapstraction.setCenterAndZoom(loc.point, 11);\n    var kw = kw_field.value;\n    var rad = radius_field.options[radius_field.selectedIndex].value;\n❺ get_twitter_geo(loc.point, rad, kw, 1, 100);\n  }\n```", "```\n{\"results\":[\n  {\"from_user\":\"mapscripting\", \"created_at\":\"Thu 15 Jul 2010 12:30:12\",\n   \"text\":\"This is an example tweet, shown in the API\",\n   \"geo\":{\"coordinates\":[45.5228,-122.6485],\"type\":\"Point\"},\n   ...},\n  {\"from_user\":\"adamd\", ...\n   \"geo\":null, ... },\n   ...\n], ... }\n```", "```\nfunction get_twitter_geo(loc, rad, kw, pg, rpp) {\n    // Set default values\n    if (rpp == null) {\n      rpp = 100;\n    }\n    if (rad == null) {\n      rad = 5; // radius in miles\n    }\n    // Clear the map on first page\n    if (pg == null || pg == 1) {\n      pg = 1;\n      mapstraction.removeAllMarkers();\n      mapstraction.removeAllPolylines();\n❶     polygon_circle(loc, rad);\n    }\n    mapstraction.autoCenterAndZoom();\n    // Construct URL\n    var url = \"http://search.twitter.com/search.json?page=\" + pg;\n    if (kw != null && kw != \"\") {\n      url += \"&q=\" + kw;\n    }\n    url += \"&geocode=\" + loc.lat + \",\" + loc.lon + \",\" + rad + \"mi\" + \"&rpp=\" + rpp;\n❷   url += \"&callback=?\";\n\n    $.getJSON(url, function(jobj) {\n      var resarray = jobj.results;\n      for (var i=0; i<resarray.length; i++) {\n        var res = resarray[i];\n❸       if (res.geo) {\n          var coords = res.geo.coordinates;\n          var mk = new mxn.Marker(new mxn.LatLonPoint(coords[0], coords[1]));\n          mk.setInfoBubble(res.text);\n          mapstraction.addMarker(mk);\n        }\n      }\n❹     if ((pg * rpp) < 1500 && resarray.length == rpp) {\n        get_twitter_geo(loc, rad, kw, ❺pg+1, rpp);\n      }\n    });\n  }\n```", "```\nfunction polygon_circle(center, radius) {\n  var rad = new mxn.Radius(center, 10);\n  var poly = rad.getPolyline(mxn.util.milesToKM(radius), '990066');\n  mapstraction.addPolyline(poly);\n}\n```", "```\n<html >\n    <head>\n      <title>Coffee in the Middle</title>\n      <style>\n        div#mymap {\n          width: 600px;\n          height: 450px;\n        }\n      </style>\n❶     <script type=\"text/javascript\"  src=\"http://ajax.google\napis.com/ajax/libs/jquery/1.3/jquery.min.js\"></script>\n      <script src=\"http://maps.google.com/maps?file=api&amp;v=2&amp;key=\n*`YOURKEY`*\" type=\"text/javascript\"></script>\n      <script type=\"text/javascript\" src=\"mxn.js?(google)\"></script>\n      <script type=\"text/javascript\">\n        var mapstraction;\n❷       var gdir;\n\n        function create_map() {\n          mapstraction = new mxn.Mapstraction('mymap', 'google');\n          mapstraction.addControls({\"zoom\":\"large\"});\n          mapstraction.setCenterAndZoom(new mxn.LatLonPoint(40, −92), 3);\n\n        }\n      </script>\n    </head>\n    <body onload=\"create_map()\">\n      <form id=\"myform\" onSubmit=\"❸goDir();return false;\">\n        Your location: <input type=\"text\" id=\"start\" />\n        Friend's location: <input type=\"text\" id=\"end\" />\n        <input type=\"submit\" value=\"Go\" />\n      </form>\n      <div id=\"mymap\"></div>\n    </body>\n  </html>\n```", "```\n❶ // Google-specific code for driving directions\n❷ gdir = new google.maps.DirectionsService();\n```", "```\nfunction goDir() {\n    var start = document.getElementById('start').value;\n    var end = document.getElementById('end').value;\n\n    // Remove Markers and Polylines\n    mapstraction.removeAllMarkers();\n    mapstraction.removeAllPolylines();\n\n    // Google-specific: load directions\n❸   var diropt = {\n        origin: start,\n        destination: end,\n        travelMode: google.maps.DirectionsTravelMode.DRIVING\n     }\n❹   gdirroute(diropt, addDir);\n  }\n```", "```\nfunction addDir(response, status) {\n    if (status == google.maps.DirectionsStatus.OK) {\n❺     var gpts = response.routes[0].overview_path;\n      var polypts = [];\n      for (var i=0; i<gpts.length; i++) {\n❻       polypts.push(new mxn.LatLonPoint(gpts[i].lat(), gpts[i].lng()));\n      }\n      // Add polyline to map\n      var poly = new mxn.Polyline(polypts);\n      mapstraction.addPolyline(poly);\n      mapstraction.autoCenterAndZoom();\n      // Find distance\n❼     var dist = response.routes[0].legs[0].distance.value / 1000;\n      // Find midpoint\n❽     findMidpoint(polypts, dist);\n    }\n  }\n```", "```\nfunction findMidpoint(allpts, totaldist) {\n    var midicon = 'http://chart.apis.google.com/chart?chst=d_map_pin_icon\n&chld=star|00FF00';\n\n    // Determine distance needed\n    var halfdist = totaldist / 2;\n    var distsofar = 0;\n\n    // Loop through points, adding up distance so far\n    for (var i=1; i < allpts.length; i++) {\n    var pt1 = allpts[i-1];\n    var pt2 = allpts[i];\n    var thisdist = pt1.distance(pt2);\n❶   if ((distsofar + thisdist) < halfdist) {\n      distsofar += thisdist;\n    }\n    else {\n❷     var distneeded = halfdist − distsofar;\n\n      // Determine point that is \"distneeded\" along the line between pt1 and pt2\n      var bearing = get_bearing(pt1, pt2);\n      var midpt = get_destination(pt1, distneeded, bearing);\n❸     var midmk = new mxn.Marker(midpt);\n      midmk.setIcon(midicon);\n      mapstraction.addMarker(midmk);\n\n      // Determine search radius\n      var radius = 1+ totaldist / 10;\n      if (radius > 25) {\n        radius = 25;\n      }\n❹     loadYelp(\"coffee\", midpt, radius);\n      break; // stop the loop, we're halfway!\n    }\n   }\n  }\n```", "```\nfunction get_bearing(pt1, pt2) {\n  var lat1 = degrees_to_radians(pt1.lat);\n  var lat2 = degrees_to_radians(pt2.lat);\n  var lon_diff = degrees_to_radians(pt2.lon − pt1.lon);\n  var y = Math.sin(lon_diff) * Math.cos(lat2);\n  var x = Math.cos(lat1) * Math.sin(lat2)\n          - Math.sin(lat1) * Math.cos(lat2) * Math.cos(lon_diff);\n  var bearing = Math.atan2(y, x);\n  return (radians_to_degrees(bearing)+360) % 360;\n}\nfunction get_destination(pt, dist, bearing) {\n  var R = 6371; // radius of earth (km)\n  var lat1 = degrees_to_radians(pt.lat);\n  var lon1 = degrees_to_radians(pt.lon);\n  bearing = degrees_to_radians(bearing);\n  var cosLat1 = Math.cos(lat1);\n  var sinLat1 = Math.sin(lat1);\n  var distOverR = dist / R;\n  var cosDistOverR = Math.cos(distOverR);\n  var sinDistOverR = Math.sin(distOverR);\n  var lat2 = Math.asin( sinLat1 * cosDistOverR\n             + cosLat1 * sinDistOverR * Math.cos(bearing) );\n  var lon2 = lon1 + Math.atan2( Math.sin(bearing) * sinDistOverR * cosLat1,\n             cosDistOverR − sinLat1 * Math.sin(lat2) );\n  lon2 = (lon2 + Math.PI) % (2 * Math.PI) − Math.PI;\n  lat2 = radians_to_degrees(lat2);\n  lon2 = radians_to_degrees(lon2);\n  return new mxn.LatLonPoint(lat2, lon2);\n}\nfunction degrees_to_radians(deg) {\n  return deg * Math.PI / 180;\n}\nfunction radians_to_degrees(rad) {\n  return rad * 180 / Math.PI;\n}\n```", "```\n{\"message\": {\"text\": \"OK\", \"code\": 0, \"version\": \"1.1.1\"},\n \"businesses\": [\n   {\"name\": \"Somewhere Coffee\", \"latitude\": 12.3456, \"longitude\": 123.4567, ... },\n   {\"name\": \"Someplace Jo\", \"latitude\": 12.3456, \"longitude\": 123.4567, ... },\n   ...\n ]\n}\n```", "```\nfunction loadYelp(kw, loc, rad) {\n    var url = \"http://api.yelp.com/business_review_search\";\n    url += \"?ywsid=*`YOURKEY`*&num_biz_requested=10&term=\" + kw\";\n    url += \"&lat=\" + loc.lat + \"&long=\" + loc.lon + \"&radius=\" + rad;\n❶   url += \"&callback=?\";\n  $.getJSON(url, ❷function(x) {\n    if (x.message.text == \"OK\") {\n      if (x.businesses.length != 0) {\n        var res = x.businesses;\n        var allpts = [];\n        for (var i = 0; i < res.length; i++) {\n❸         var place = res[i];\n❹         var thisloc = new mxn.LatLonPoint(place.latitude, place.longitude);\n          allpts.push(thisloc);\n          var html = \"<strong>\" + place.name + \"</strong><br />\" + place.address1;\n          html += \"<br />\" + place.city + \", \" + place.state;\n          // Create and add marker to the map\n          var mk = new mxn.Marker(thisloc);\n          mk.setInfoBubble(html);\n          mapstraction.addMarker(mk);\n        }\n❺       mapstraction.centerAndZoomOnPoints(allpts);\n      }\n    }\n  });\n }\n```"]