<html><head></head><body>

<div class="calibre1"><div class="calibre1"><a name="openssh_server_4.7p1" class="calibre8" id="openssh_server_4.7p1"/>
<div class="calibre24" id="calibre_pb_0"/><h2 id="title-ID0EMTPM" class="docPrefaceTitle">Chapter 17. OPENSSH SERVER 4.7P1</h2>
<h4 class="calibre32"><a class="calibre2" target="_blank" href="HTTP://WWW.OPENSSH.COM">HTTP://WWW.OPENSSH.COM</a></h4>
<a name="summary-id16" class="calibre8" id="summary-id16"/>
<h3 class="docSection1Title" id="-100000">17.1. SUMMARY</h3>
<p class="docText1"><a name="OpenSSH is" class="calibre8" id="OpenSSH is"/>OpenSSH is a set of open source utilities that implement the SSH (Secure Shell) protocol. <span class="docEmphasis1">SSH</span><a name="secure version" class="calibre8" id="secure version"/> is a secure version of telnet; it's a protocol used to access the console or command line of remote systems. SSH provides administrators and users with access to a remote system as if they were physically at the console.<a name="IDX-CHP-17-0257" class="calibre8" id="IDX-CHP-17-0257"/><a name="IDX-CHP-17-0258" class="calibre8" id="IDX-CHP-17-0258"/><a name="IDX-CHP-17-0259" class="calibre8" id="IDX-CHP-17-0259"/><a name="IDX-CHP-17-0260" class="calibre8" id="IDX-CHP-17-0260"/><a name="IDX-CHP-17-0261" class="calibre8" id="IDX-CHP-17-0261"/><a name="IDX-CHP-17-0262" class="calibre8" id="IDX-CHP-17-0262"/></p>
<p class="docText1"><a name="eavesdropping on" class="calibre8" id="eavesdropping on"/>SSH uses encryption to prevent eavesdropping on connections made between a client and server. The telnet protocol lacks encryption; this gives eavesdroppers the ability to capture usernames and passwords with a packet sniffer. (A <span class="docEmphasis1">packet sniffer</span><a name="program designed" class="calibre8" id="program designed"/> is a program designed to monitor and capture network traffic.)</p>
<p class="docText1"><a name="overwhelming " class="calibre8" id="overwhelming "/>OpenSSH commands an overwhelming 87 percent of the SSH market, according to a survey conducted in November 2005.<sup class="docFootnote"><a class="calibre2" href="#CHP-17-1">[]</a></sup><a name="Linux and" class="calibre8" id="Linux and"/> It is included in virtually every distribution of Linux and BSD, as well as Apple's Mac OS X.</p><blockquote class="calibre31"><p class="docFootnote1"><sup class="calibre37"><a name="CHP-17-1" class="calibre8" id="CHP-17-1">[]</a></sup> OpenBSD, "SSH Usage Profiling," <a class="calibre2" target="_blank" href="http://www.openssh.com/usage/index.html">http://www.openssh.com/usage/index.html</a>.<a name="IDX-CHP-17-0263" class="calibre8" id="IDX-CHP-17-0263"/></p></blockquote>
<p class="docText1"><a name="by Tatu" class="calibre8" id="by Tatu"/>The SSH protocol was first developed in 1995 by Tatu Ylönen, a researcher from Helsinki University of Technology. Ylönen founded SSH Communications Security in late 1995 to develop and market SSH. His company currently markets the SSH Tectia Server/Client.<a name="IDX-CHP-17-0264" class="calibre8" id="IDX-CHP-17-0264"/></p>
<p class="docText1"><a name="of the" class="calibre8" id="of the"/>OpenSSH was originally conceived by the OpenBSD team as part of the OpenBSD 2.6 release in December 1999. The team used code from Tatu Ylönen's SSH project, which was originally open source. Bugs were fixed and features were added to the OpenSSH release. Soon after the release of OpenSSH, its developers decided to split into two teams. One group concentrated on the development of OpenSSH for OpenBSD while the other group developed a portable version of OpenSSH for use on other platforms. The portable edition has the letter <span class="docEmphasis1">P</span><a name="is still" class="calibre8" id="is still"/> appended to the version to signify this. OpenSSH is still developed by the OpenBSD team and is led by its founder, Theo de Raadt.</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="resources-id16" class="calibre8" id="resources-id16"/>
<h3 class="docSection1Title" id="-100000">17.2. RESOURCES</h3>
<p class="docText1"><span class="b"><a name="OpenSSH Manual" class="calibre8" id="OpenSSH Manual"/>OpenSSH Manual Pages</span></p>
<p class="docText1"><a class="calibre2" target="_blank" href="http://www.openssh.com/manual.html">http://www.openssh.com/manual.html</a></p>
<p class="docText1"><span class="b"><a name="Secure Shell" class="calibre8" id="Secure Shell"/>RFC 4251 - The Secure Shell (SSH) Protocol Architecture</span></p>
<p class="docText1"><a class="calibre2" target="_blank" href="http://tools.ietf.org/html/rfc4251">http://tools.ietf.org/html/rfc4251</a></p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="required-id16" class="calibre8" id="required-id16"/>
<h3 class="docSection1Title" id="-100000">17.3. REQUIRED</h3>
<p class="docText1"><img border="0" id="" src="OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg" alt="" class="calibre33"/><a name="FreeBSD " class="calibre8" id="FreeBSD "/> FreeBSD 7.0-RELEASE (see "<a class="calibre2" href="freebsd_7.0_split_000.html#freebsd_7.0">FreeBSD 7.0</a>")</p>
<p class="docText1"><img border="0" id="" src="OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg" alt="" class="calibre33"/><a name="collection " class="calibre8" id="collection "/> Updated ports collection (see "<a class="calibre2" href="freebsd_ports_collection.html#freebsd_ports_collection">FreeBSD Ports Collection</a>")</p>
<p class="docText1"><img border="0" id="" src="OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg" alt="" class="calibre33"/> Internet connection</p>
<p class="docText1"><img border="0" id="" src="OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg" alt="" class="calibre33"/> OpenSSL (see "<a class="calibre2" href="openssl_0.9.8g.html#openssl_0.9.8g">OpenSSL 0.9.8g</a>")</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="preparation-id16" class="calibre8" id="preparation-id16"/>
<h3 class="docSection1Title" id="-100000">17.4. PREPARATION</h3>
<p class="docText1"><a name="Become the" class="calibre8" id="Become the"/>Become the superuser.<a name="IDX-CHP-17-0265" class="calibre8" id="IDX-CHP-17-0265"/><a name="IDX-CHP-17-0266" class="calibre8" id="IDX-CHP-17-0266"/></p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="install-id16" class="calibre8" id="install-id16"/>
<h3 class="docSection1Title" id="-100000">17.5. INSTALL</h3>
<p class="docText1"><a name="OpenSSH " class="calibre8" id="OpenSSH "/>OpenSSH 4.5.p1 is part of the standard FreeBSD 7.0 distribution. In this guide, we will replace the base version with an updated version of OpenSSH from the ports collection.</p>
<p class="docText1"><a name="the OpenSSH" class="calibre8" id="the OpenSSH"/>To begin the OpenSSH installation process, enter:</p>
<pre class="calibre30"># <b class="calibre28">cd /usr/ports/security/openssh-portable</b>
# <b class="calibre28">make config ; make -D WITH_OVERWRITE_BASE install clean</b></pre>
<p class="docText1"><a name="OpenSSH will" class="calibre8" id="OpenSSH will"/>A menu with options for OpenSSH will appear. We will leave them at their defaults, so press [tab] to highlight <span class="b">OK</span><a name="press " class="calibre8" id="press "/> and then press [enter] to start the installation.</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="configure-id16" class="calibre8" id="configure-id16"/>
<h3 class="docSection1Title" id="-100000">17.6. CONFIGURE</h3>
<p class="docText1"><a name="Once the" class="calibre8" id="Once the"/>Once the installation process is complete, it's time to configure OpenSSH for use on your system.</p>
<div class="calibre34"><ol class="docList" type="1"><li class="calibre16"><div class="calibre35"><p class="docText1">The line <tt class="calibre20">"NO_OPENSSH = YES"</tt><a name="added to" class="calibre8" id="added to"/> must be added to the <span class="docEmphasis1">make.conf</span> file in <span class="docEmphasis1">/etc</span><a name="build the" class="calibre8" id="build the"/>. This tells make not to build the base version of OpenSSH if you rebuild FreeBSD from source (i.e., this prevents the system from downgrading OpenSSH to the older base version). The following commands will add this line to <span class="docEmphasis1">make.conf</span>:</p><pre class="calibre30"># <b class="calibre28">cp /etc/make.conf /etc/make.conf.old</b>
# <b class="calibre28">echo "NO_OPENSSH = YES" &gt;&gt; /etc/make.conf</b></pre>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="file has" class="calibre8" id="file has"/>OpenSSH's default configuration file has changed slightly from the base version to increase security. We'll replace the base configuration file with this newly installed file.</p><pre class="calibre30"># <b class="calibre28">cd /etc/ssh</b>
# <b class="calibre28">cp sshd_config sshd_config.old</b>
# <b class="calibre28">cp sshd_config-dist sshd_config</b>
# <b class="calibre28">/etc/rc.d/sshd restart</b></pre><br class="calibre1"/>
<hr size="1" noshade="noshade" class="calibre27"/><span><i class="docEmphasis1"><b class="calibre28">Note:</b></i> You may need to re-modify the <span class="docEmphasis1">sshd_config</span> file if you previously made any customizations.</span><hr size="1" noshade="noshade" class="calibre27"/></div></li></ol></div>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="testing-id11" class="calibre8" id="testing-id11"/>
<h3 class="docSection1Title" id="-100000">17.7. TESTING</h3>
<p class="docText1"><a name="In this" class="calibre8" id="In this"/>In this section, we'll perform some basic tests to confirm that OpenSSH answers SSH requests properly.</p>
<div class="calibre34"><ol class="docList" type="1"><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="OpenSSH Server" class="calibre8" id="OpenSSH Server"/>To start OpenSSH Server automatically at boot time, open <span class="docEmphasis1">rc.conf</span>:</p><pre class="calibre30"># <b class="calibre28">ee /etc/rc.conf</b></pre>
<p class="docText1"><a name="not already" class="calibre8" id="not already"/>and add the following line (if it's not already present):</p><pre class="calibre30">sshd_enable="YES"</pre><br class="calibre1"/>
</div></li><li class="calibre16"><div class="calibre35"><p class="docText1">Save and exit.</p></div></li><li class="calibre16"><div class="calibre35"><p class="docText1"><a name="if OpenSSH" class="calibre8" id="if OpenSSH"/>To test if OpenSSH is answering properly on port 22, connect via telnet and examine the response. Use the following command:</p><pre class="calibre30"># <b class="calibre28">telnet</b> <span class="docEmphBoldItalic">localhost</span> <b class="calibre28">22</b></pre><br class="calibre1"/>
<hr size="1" noshade="noshade" class="calibre27"/><span><i class="docEmphasis1"><b class="calibre28">Note:</b></i> You may replace <tt class="calibre20">localhost</tt> with the FQDN or IP address of your server if you are testing from a different system.<a name="IDX-CHP-17-0267" class="calibre8" id="IDX-CHP-17-0267"/></span><hr size="1" noshade="noshade" class="calibre27"/></div></li></ol></div>
<p class="docText1"><a name="yield the" class="calibre8" id="yield the"/>The connection should yield the following banner:</p>
<pre class="calibre30">Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
<tt class="calibre20"><i class="docEmphasis1">SSH-2.0-OpenSSH_4.7p1 FreeBSD-openssh-portable-overwrite-base-4.7.p1,1</i></tt></pre><br class="calibre1"/>
<p class="docText1"><a name="banner " class="calibre8" id="banner "/>Verify that the correct version appears in the banner (SSH-2.0 and OpenSSH_4.7p1 or later). Press [enter] to quit and return to the command prompt. You should now be able to connect with any SSH-capable client and any valid user account other than root.</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="utilities-id5" class="calibre8" id="utilities-id5"/>
<h3 class="docSection1Title" id="-100000">17.8. UTILITIES</h3>
<p class="docText1"><a name="OpenSSH includes" class="calibre8" id="OpenSSH includes"/>OpenSSH includes an SSH client, <span class="docEmphasis1">SFTP (secure file transfer)</span> client, and <span class="docEmphasis1">SCP (secure copy)</span><a name="is designed" class="calibre8" id="is designed"/> client. Each program is designed to operate similarly to the original, but insecure, telnet and FTP protocols. The SSH client enables users to securely log in to remote systems and the SFTP and SCP clients make secure file transfers possible.</p>
<a name="ssh_client" class="calibre8" id="ssh_client"/>
<h4 id="title-ID0ESWPM" class="docSection1Title">17.8.1. SSH Client</h4>
<p class="docText1"><a name="securely log" class="calibre8" id="securely log"/>This program is used to securely log in to the console of a remote system (i.e., start a terminal session).</p>
<a name="IDX-CHP-17-0268" class="calibre8" id="IDX-CHP-17-0268"/><dl class="docList1">
<dt class="calibre1"><p class="calibre23"><span class="docPubcolor"><span class="b">Command</span></span></p></dt>
<dd class="calibre36"><p class="docText1"><tt class="calibre20">ssh</tt><a name="IDX-CHP-17-0268" class="calibre8" id="IDX-CHP-17-0268"/></p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"><span class="b">Syntax</span></span></p></dt>
<dd class="calibre36"><p class="docText1"><tt class="calibre20">ssh -</tt><tt class="calibre20"><i class="docEmphasis1">options</i></tt> <tt class="calibre20"><i class="docEmphasis1">user@host</i></tt></p></dd>
</dl>
<p class="docText1"><span class="b">Options</span></p>
<dl class="docList1">
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">-p</pre></p></dt>
<dd class="calibre36"><p class="docText1"><a name="port in" class="calibre8" id="port in"/>Specify a port in which to connect to the remote host (the OpenSSH server must be configured for the port you specify).</p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">-L</pre></p></dt>
<dd class="calibre36"><p class="docText1"><tt class="calibre20"><b class="calibre28">localport:host:remoteport</b></tt><a name="local port" class="calibre8" id="local port"/> Forward a specified local port to a specified host port over the secure connection.</p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">-N</pre></p></dt>
<dd class="calibre36"><p class="docText1">Do not execute remote commands (used for port forwarding).</p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">-f</pre></p></dt>
<dd class="calibre36"><p class="docText1">Run the SSH client as a background process.</p></dd>
</dl>
<p class="docText1"><span class="b">Examples</span></p>
<p class="docText1">To log in to a remote host named <a class="calibre2" target="_blank" href="http://host.example.com">host.example.com</a> as user johnny, enter the following command:</p>
<pre class="calibre30"># <b class="calibre28">ssh johnny@host.example.com</b></pre><br class="calibre1"/>
<p class="docText1">To log in to a remote host named <a class="calibre2" target="_blank" href="http://fluffy.net">fluffy.net</a> as user cat on port 23, enter:</p>
<pre class="calibre30"># <b class="calibre28">ssh -p 23 cat@fluffy.net</b></pre><br class="calibre1"/>
<p class="docText1"><a name="to remote" class="calibre8" id="to remote"/>To create an SSH tunnel from local port 1234 to remote port 110 on host <a class="calibre2" target="_blank" href="http://host.example.com">host.example.com</a> as user aeron, enter:</p>
<pre class="calibre30"># <b class="calibre28">ssh -L 1234:host.example.com:110 -f -N aeron@host.example.com</b></pre><br class="calibre1"/>
<p class="docText1">To close this tunnel later, enter:</p>
<pre class="calibre30"># <b class="calibre28">killall -TERM ssh</b></pre><br class="calibre1"/>
<a name="secure_copy_client" class="calibre8" id="secure_copy_client"/>
<h4 id="title-ID0EU1PM" class="docSection1Title">17.8.2. Secure Copy Client</h4>
<p class="docText1"><a name="to or" class="calibre8" id="to or"/>This utility securely copies files and directories to or from a remote host.</p>
<a name="IDX-CHP-17-0269" class="calibre8" id="IDX-CHP-17-0269"/><dl class="docList1">
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"><span class="b">Command</span></span></p></dt>
<dd class="calibre36"><p class="docText1"><tt class="calibre20">scp</tt><a name="IDX-CHP-17-0269" class="calibre8" id="IDX-CHP-17-0269"/></p>
<p class="docText1"><span class="b">Syntax</span> <tt class="calibre20">scp -</tt><tt class="calibre20"><i class="docEmphasis1">options filename user@host:path</i></tt></p></dd>
</dl>
<p class="docText1"><span class="b">Options</span></p>
<dl class="docList1">
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">-C</pre></p></dt>
<dd class="calibre36"><p class="docText1">Enable data compression.</p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">-P</pre></p></dt>
<dd class="calibre36"><p class="docText1"><a name="host " class="calibre8" id="host "/>Specify a port in which to connect to the remote host (the OpenSSH server must be configured for the port you specify).</p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">-p</pre></p></dt>
<dd class="calibre36"><p class="docText1">Preserve the original file's modification times, access times, and file modes.</p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">-r</pre></p></dt>
<dd class="calibre36"><p class="docText1">Recursively copy directories.</p></dd>
</dl>
<p class="docText1"><span class="b">Examples</span></p>
<p class="docText1">To copy a file named <span class="docEmphasis1">example.doc</span> from the current working directory to the <span class="docEmphasis1">/usr/home</span> directory on a remote system <a class="calibre2" target="_blank" href="http://example.com">example.com</a> as user author, enter:</p>
<pre class="calibre30"># <b class="calibre28">scp example.doc author@example.com:/usr/home</b></pre><br class="calibre1"/>
<p class="docText1">To copy everything within the local <span class="docEmphasis1">/usr/samba</span> directory to <span class="docEmphasis1">/usr/home</span> on a remote system <a class="calibre2" target="_blank" href="http://example.com">example.com</a><a name="and enabling" class="calibre8" id="and enabling"/> as user author while preserving file modes and enabling data compression, enter:</p>
<pre class="calibre30"># <b class="calibre28">scp -p -C /usr/samba author@example.com:/usr/home</b></pre><br class="calibre1"/>
<p class="docText1"><a name="a file" class="calibre8" id="a file"/>To copy a file named <span class="docEmphasis1">/usr/example.doc</span><a name="to the" class="calibre8" id="to the"/> to the <span class="docEmphasis1">/usr</span><a name="the local" class="calibre8" id="the local"/> directory on the local system using port 23, using the author account on a host named <a class="calibre2" target="_blank" href="http://server1.example.com">server1.example.com</a>, enter:</p>
<pre class="calibre30"># <b class="calibre28">scp -P 23 author@server1.example.com:/usr/example.doc /usr</b></pre><br class="calibre1"/>
<a name="secure_file_transfer_client" class="calibre8" id="secure_file_transfer_client"/>
<h4 id="title-ID0ET5PM" class="docSection1Title">17.8.3. Secure File Transfer Client</h4>
<p class="docText1"><a name="and secure" class="calibre8" id="and secure"/>This program is an interactive and secure file transfer client. It can be used as an alternative to FTP, which is inherently insecure.<a name="IDX-CHP-17-0270" class="calibre8" id="IDX-CHP-17-0270"/><a name="IDX-CHP-17-0271" class="calibre8" id="IDX-CHP-17-0271"/></p>
<a name="IDX-CHP-17-0272" class="calibre8" id="IDX-CHP-17-0272"/><dl class="docList1">
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"><span class="b">Command</span></span></p></dt>
<dd class="calibre36"><p class="docText1"><tt class="calibre20">sftp</tt><a name="IDX-CHP-17-0272" class="calibre8" id="IDX-CHP-17-0272"/></p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"><span class="b">Syntax</span></span></p></dt>
<dd class="calibre36"><p class="docText1"><tt class="calibre20">sftp -</tt><tt class="calibre20"><i class="docEmphasis1">options user@host</i></tt></p></dd>
</dl>
<p class="docText1"><span class="b">Options</span></p>
<dl class="docList1">
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">-o Port=xx</pre></p></dt>
<dd class="calibre36"><p class="docText1"><a name="port in" class="calibre8" id="port in"/>Specify a port in which to connect to the remote host (the OpenSSH server must be configured for the port you specify).</p></dd>
<dt class="calibre1"><br class="calibre1"/><p class="calibre23"><span class="docPubcolor"/><pre class="calibre30">-C</pre></p></dt>
<dd class="calibre36"><p class="docText1">Enable data compression.</p></dd>
</dl>
<p class="docText1"><span class="b">Examples</span></p>
<p class="docText1"><a name="connection to" class="calibre8" id="connection to"/>To initiate a connection to a host named <a class="calibre2" target="_blank" href="http://server.example.com">server.example.com</a> as user test, enter:</p>
<pre class="calibre30"># <b class="calibre28">sftp test@server.example.com</b></pre><br class="calibre1"/>
<p class="docText1">To connect to a host named <a class="calibre2" target="_blank" href="http://example.com">example.com</a> over port 23 as user wilson with compression enabled, enter:</p>
<pre class="calibre30"># <b class="calibre28">sftp -o Port=23 -C wilson@example.com</b></pre><br class="calibre1"/>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="config_files-id16" class="calibre8" id="config_files-id16"/>
<h3 class="docSection1Title" id="-100000">17.9. CONFIG FILES</h3>
<p class="docText1"><span class="b">/etc/ssh/sshd_config</span></p>
<p class="docText1"><a name="Contains general" class="calibre8" id="Contains general"/>Contains general settings for sshd (SSH server daemon). It is generally safe to leave this file at its defaults.</p>
<p class="docText1"><span class="b">/etc/ssh/ssh_config</span></p>
<p class="docText1"><a name="settings for" class="calibre8" id="settings for"/>Contains general settings for ssh (SSH client program).</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="log_files-id10" class="calibre8" id="log_files-id10"/>
<h3 class="docSection1Title" id="-100000">17.10. LOG FILES</h3>
<p class="docText1"><span class="b">/var/log/auth.log</span></p>
<p class="docText1"><a name="A general" class="calibre8" id="A general"/>A general log of SSH server activity</p>
</div></div>




<div class="calibre1"><div class="calibre1"><a name="notes-id12" class="calibre8" id="notes-id12"/>
<h3 class="docSection1Title" id="-100000">17.11. NOTES</h3>
<ul class="calibre15"><li class="calibre16"><p class="docText1"><a name="By default" class="calibre8" id="By default"/>By default, all user accounts with shell access on your server will have SSH access (except for root). If you want to limit SSH access to specific users, you will need to add a line to the <span class="docEmphasis1">sshd_config</span><a name="in" class="calibre8" id="in"/> file located in <span class="docEmphasis1">/etc/ssh</span>. Open it like so:<a name="IDX-CHP-17-0273" class="calibre8" id="IDX-CHP-17-0273"/></p><pre class="calibre30"># <b class="calibre28">ee /etc/ssh/sshd_config</b></pre>
<p class="docText1">and add the following line:</p><pre class="calibre30">AllowUsers <tt class="calibre20"><i class="docEmphasis1">username</i></tt></pre><br class="calibre1"/>
<p class="docText1">Replace <tt class="calibre20"><i class="docEmphasis1">username</i></tt><a name="the user" class="calibre8" id="the user"/> with the login name of the user you want to allow SSH access. Separate multiple users with spaces. Only users who appear on this line will have access to SSH-based services.</p><hr size="1" noshade="noshade" class="calibre27"/><span><i class="docEmphasis1"><b class="calibre28">Note:</b></i> Be aware that this line is case sensitive. Confirm that the usernames are correct, especially if you are making this change from a remote location. You can lock yourself out if this is misconfigured!</span><hr size="1" noshade="noshade" class="calibre27"/><p class="docText1">Save, exit, and restart sshd:</p><pre class="calibre30"># <b class="calibre28">/etc/rc.d/sshd restart</b></pre><br class="calibre1"/>
</li><li class="calibre16"><p class="docText1"><a name="are usually" class="calibre8" id="are usually"/>Host keys are usually created after the initial FreeBSD installation process, if SSH logins were enabled. If you need to re-create them, it is easiest to remove the old keys and restart the SSH daemon. The SSH daemon will recreate the keys automatically. These commands will accomplish this:</p><pre class="calibre30"># <b class="calibre28">cd /etc/ssh</b>
# <b class="calibre28">mkdir old_keys</b>
# <b class="calibre28">mv ssh_host* old_keys</b>
# <b class="calibre28">/etc/rc.d/sshd restart</b></pre><br class="calibre1"/>
</li><li class="calibre16"><p class="docText1"><a name="will not" class="calibre8" id="will not"/>By default, OpenSSH Server will not allow root logins. If you need root privileges, you will need to log in as a normal user who is a member of the wheel group and then use the <tt class="calibre20">su</tt> command to become the superuser. see "<a class="calibre2" href="general.html#su">su</a><a name="the wheel" class="calibre8" id="the wheel"/>" for details. To add a user named lucky to the wheel group, log in as root and enter:</p><pre class="calibre30"># <b class="calibre28">pw user mod lucky -G wheel</b></pre><br class="calibre1"/>
</li></ul>
</div></div>

</body></html>