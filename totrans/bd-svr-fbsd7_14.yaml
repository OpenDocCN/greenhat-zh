- en: Chapter 3\. APACHE HTTP SERVER 2.2.8
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[HTTP://HTTPD.APACHE.ORG](HTTP://HTTPD.APACHE.ORG)'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 3.1\. SUMMARY
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Apache HTTP Server is an open source web server application regarded as one
    of the most efficient, scalable, and feature-rich web servers available. Apache
    is also highly customizable, with numerous third-party modules available to extend
    its functionality. You'll find modules that add support for SSL (Secure Sockets
    Layer) encryption over HTTP (HyperText Transfer Protocol), PHP support (PHP is
    a server-side scripting language), and authentication support for password protecting
    a site or page.
  prefs: []
  type: TYPE_NORMAL
- en: Apache was born at the NCSA (National Center for Supercomputing Applications)
    in 1993 when Rob McCool developed a public domain HTTP daemon (background process)
    that would later become the foundation of the Apache project. Apache version 1.3
    still contains code from the original NCSA-developed HTTP daemon, while version
    2 was rewritten from scratch and contains no NCSA code.
  prefs: []
  type: TYPE_NORMAL
- en: Apache HTTP Server is installed on nearly 53 percent of the world's web servers.
    Microsoft's Internet Information Server is in second place, with more than a 32
    percent share of the server market.^([[]](#CHP-3-1))
  prefs: []
  type: TYPE_NORMAL
- en: '^([]) Netcraft Ltd., "Netcraft: July 2007 Web Server Survey," [http://news.netcraft.com/archives/2007/07/09/july_2007_web_server_survey.html](http://news.netcraft.com/archives/2007/07/09/july_2007_web_server_survey.html)'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: The FreeBSD port of the Apache HTTP server documented here includes support
    for SSL over HTTP using the `mod_ssl` module. The module was created by Ralf S.
    Engelschall in 1998; it is based on software developed by Ben Laurie.
  prefs: []
  type: TYPE_NORMAL
- en: 3.2\. RESOURCES
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Official Apache HTTP Server Online Documentation
  prefs: []
  type: TYPE_NORMAL
- en: '[http://httpd.apache.org/docs/2.2](http://httpd.apache.org/docs/2.2)'
  prefs: []
  type: TYPE_NORMAL
- en: RFC 2616 - Hypertext Transfer Protocol - HTTP/1.1
  prefs: []
  type: TYPE_NORMAL
- en: '[http://tools.ietf.org/html/rfc2616](http://tools.ietf.org/html/rfc2616)'
  prefs: []
  type: TYPE_NORMAL
- en: 3.3\. REQUIRED
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '![](bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg) FreeBSD 7.0-RELEASE
    (see "[FreeBSD 7.0](freebsd_7.0_split_000.html#freebsd_7.0)")'
  prefs: []
  type: TYPE_IMG
- en: '![](bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg) Updated ports
    collection (see "[FreeBSD Ports Collection](freebsd_ports_collection.html#freebsd_ports_collection)")'
  prefs: []
  type: TYPE_IMG
- en: '![](bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg) Internet
    connection'
  prefs: []
  type: TYPE_NORMAL
- en: 3.4\. OPTIONAL
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '![](bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg) OpenSSL with
    a signed SSL Certificate (if you wish to enable secure HTTP connections; see "[OpenSSL
    0.9.8g](openssl_0.9.8g.html#openssl_0.9.8g)")'
  prefs: []
  type: TYPE_IMG
- en: '![](bTM3ZzJkLzhzNHRnOS9lL3BjMWk1OTU3MWk5ZmFycHMwZzMvMC5uVQ--.jpg) Registered
    domain name'
  prefs: []
  type: TYPE_NORMAL
- en: 3.5\. PREPARATION
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Become the superuser and then make sure your server's hostname is resolvable
    locally. This should already be the case if you are running your own DNS server
    and have it configured properly.
  prefs: []
  type: TYPE_NORMAL
- en: 'If you aren''t running your own DNS server, make sure you have an entry in
    your /etc/hosts file that points to your server''s IP address; this will ensure
    that your server''s hostname is resolvable locally. To do so, open the hosts file
    in a text editor:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'You should find something like the following around line 14 of the /etc/hosts
    file; replace [example.com](http://example.com) with your domain name, [host.example.com](http://host.example.com)
    with your hostname, and `*192.168.1.11*` with your server''s local IP address:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 3.6\. INSTALL
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'To begin the Apache installation process, enter the following commands:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: A menu should appear showing options for Apache. We'll leave the settings at
    their defaults, so press [tab] to highlight OK and then press [enter].
  prefs: []
  type: TYPE_NORMAL
- en: 3.7\. CONFIGURE
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Once the installation process completes, it is time to configure Apache for
    use on your system.
  prefs: []
  type: TYPE_NORMAL
- en: 'Open the httpd.conf file located in /usr/local/etc/apache22:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'We''ll edit a few entries in httpd.conf to get the HTTP daemon up and running.
    To do so, scroll to the `ServerAdmin` declaration (~138) and replace [you@example.com](mailto:you@example.com.html)
    with the email address of the person who will be maintaining the server. The line
    should appear as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Scroll to the `ServerName` declaration (~147), uncomment (remove the leading
    hash mark), and replace [host.example.com](http://host.example.com)`:80` with
    the hostname of your server. The line should now appear as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: '* * *'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '***Note:*** If you do not wish to set up SSL over HTTP, save, exit, and proceed
    to "[Testing](testing.html#testing)".'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '* * *'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'To enable SSL support, uncomment the Secure (SSL/TLS) connections declaration
    (~449) by removing the hash mark. The line should now appear as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Save, exit, and open Apache''s SSL configuration file:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Scroll to the `ServerName` and `ServerAdmin` declarations (~78) and replace
    [host.example.com](http://host.example.com) with your server''s hostname. Replace
    [you@example.com](mailto:you@example.com.html) with the email address of the person
    who will be maintaining the server. The two lines should now appear as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Go to the `SSLCertificateFile` declaration (~99) and input the path and filename
    of your server''s SSL Certificate. The line should now appear as follows (replacing
    the path and filename shown in italics with the path and filename of your SSL
    Certificate):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Go to the `SSLCertificateKeyFile` declaration (~107) and input the path and
    filename of your server''s private SSL key. The line should now appear as follows
    (replacing the path and filename shown in italics with the path and filename of
    your private key):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Code View:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: '* * *'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '***Note:*** It is highly recommended that you specify your unencrypted key
    file here. An encrypted key file will cause Apache to prompt for a password that
    may interfere with the startup of other critical services. See "[OpenSSL 0.9.8g](openssl_0.9.8g.html#openssl_0.9.8g)"
    for details on decrypting your key file if you haven''t already done so.'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '* * *'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Save and exit.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 3.8\. TESTING
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In this section, we'll perform some basic tests to confirm that Apache answers
    HTTP requests properly.
  prefs: []
  type: TYPE_NORMAL
- en: 'Apache includes a utility called apachectl that is capable of testing your
    configuration files for syntax errors. Let''s run this program to check for syntax
    errors:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: If apachectl returns `Syntax OK`, continue below. If apachectl finds a problem,
    it will list the filename, line number, and possible reasons for the error. Be
    sure to resolve any issues prior to continuing below.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'We''ll configure Apache to start automatically at boot time. To do so, open
    the rc.conf file located in /etc:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then add the following lines in /etc/rc.conf:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Save, exit, and start Apache with this command:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'You can choose to conduct your tests via a standard web browser, but the instructions
    below will conduct tests via the command line. Enter the following commands to
    connect directly to the HTTP service listening on port 80:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'The `GET` command below is case sensitive. Be sure to press [enter] twice and
    input a space before and after the first slash:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Code View:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: If you see the `It works!` text in the last line of output then Apache does
    indeed work!
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'If you configured Apache SSL support, enter the following command to connect
    to the HTTP server via SSL:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'The `GET` command is case sensitive; press [enter] twice:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: The output should be identical to the output you received over the unencrypted
    connection.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 3.9\. UTILITIES
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Following is brief information on the apache22 script that should be used to
    control the Apache daemon on FreeBSD.
  prefs: []
  type: TYPE_NORMAL
- en: 3.9.1\. apache22
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: This script is used to control the HTTP daemon.
  prefs: []
  type: TYPE_NORMAL
- en: Command
  prefs: []
  type: TYPE_NORMAL
- en: '`/usr/local/etc/rc.d/apache22`'
  prefs: []
  type: TYPE_NORMAL
- en: Syntax
  prefs: []
  type: TYPE_NORMAL
- en: '`/usr/local/etc/rc.d/apache22` `*option*`'
  prefs: []
  type: TYPE_NORMAL
- en: Options
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: Launches the Apache HTTP server
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: Stops the Apache server
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: Parses the configuration files for syntax errors
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: Restarts the Apache server
  prefs: []
  type: TYPE_NORMAL
- en: Example
  prefs: []
  type: TYPE_NORMAL
- en: 'To start the HTTP daemon, issue the following command at the prompt:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE23]'
  prefs: []
  type: TYPE_PRE
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: '***Note:*** `apache22_enable="YES"` must exist in /etc/rc.conf in order for
    this script to function.'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: 3.10\. CONFIG FILES
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: /usr/local/etc/apache22/httpd.conf
  prefs: []
  type: TYPE_NORMAL
- en: The Apache HTTP server's main configuration file
  prefs: []
  type: TYPE_NORMAL
- en: /usr/local/etc/apache22/extra/httpd-ssl.conf
  prefs: []
  type: TYPE_NORMAL
- en: The Apache HTTP server's SSL configuration file
  prefs: []
  type: TYPE_NORMAL
- en: 3.11\. LOG FILES
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: /var/log/httpd-access.log
  prefs: []
  type: TYPE_NORMAL
- en: Contains a log of IP addresses, times, and activity on the HTTP server
  prefs: []
  type: TYPE_NORMAL
- en: /var/log/httpd-error.log
  prefs: []
  type: TYPE_NORMAL
- en: Contains a log of error messages produced by the HTTP server
  prefs: []
  type: TYPE_NORMAL
- en: /var/log/httpd-ssl_request.log
  prefs: []
  type: TYPE_NORMAL
- en: Contains a log of IP addresses, times, and activity on the HTTPS server
  prefs: []
  type: TYPE_NORMAL
- en: 3.12\. NOTES
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The HTTP server uses the default port 80 for non-secure communications. The
    SSL-enabled HTTP server uses the default port 443 for secure communications. If
    you are behind a NAT router, be sure to forward these ports to your server. (Refer
    to your router's documentation for details on port forwarding.)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The default root folder of the HTTP server is /usr/local/www/apache22/data.
    Web content must be placed here unless you change the document root directory
    in httpd.conf.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
