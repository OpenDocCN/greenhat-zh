<html><head></head><body>
  <div class="sgc-1" id="filepos190170"/>&#13;
&#13;
  <h1 class="calibre1" id="calibre_pb_93"><span class="calibre2"><a class="calibre7" shape="rect"/>Chapter 2. WEBSITE SCRIPTING</span></h1>&#13;
&#13;
  <div class="calibre3"><a class="calibre17" shape="rect"/><img alt="WEBSITE SCRIPTING" class="calibre23" src="../Images/00001.jpg"/></div>&#13;
&#13;
  <p class="calibre4">Ruby and the Web go together. The Internet and the World Wide Web provide so much information that finding specific bits of that information can be overwhelming. Popular search engines have made crawling the Web more manageable, but these search engines lack customization. If you were to write your own script, it would be possible to customize every aspect of what information to gather and how to present it.</p>&#13;
&#13;
  <div class="calibre3">&#13;
    <hr class="calibre21"/>&#13;
  </div>&#13;
&#13;
  <div class="calibre3">&#13;
    <h3 class="calibre24" id="heading_id_2"><span class="calibre18"><a class="calibre7" shape="rect"/>Note</span></h3>&#13;
&#13;
    <p class="calibre4"><span class="calibre18"><span><em class="italic">If you've heard of Ruby, then chances are you've heard about Ruby on Rails. This book doesn't address Rails, as Ruby alone is a powerful tool for exploiting the Web. But if you'd like to explore web application development using Ruby, you should definitely check out the Rails framework</em></span> (<a class="calibre6" href="http://www.rubyonrails.org/" shape="rect">http://www.rubyonrails.org/</a>).</span></p>&#13;
  </div>&#13;
&#13;
  <div class="calibre3">&#13;
    <hr class="calibre21"/>&#13;
  </div>&#13;


  <div class="calibre3 calibre3 calibre3 calibre3">
    <h1 class="calibre1" id="calibre_pb_94"><span class="calibre2"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos192031"/>Web Page Link Validator</span></h1>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_95"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos192328"/>Web Page Link Validator</span></h2>
    </div>

    <div class="calibre3">
      <div class="calibre3 calibre3 calibre3">
        <h3 class="calibre16" id="heading_id_2"><a class="calibre7" shape="rect"/>linkValidator.rb</h3>
      </div>

      <p class="calibre4">The purpose <a class="calibre17" shape="rect"/>of this script is to validate all the <a class="calibre17" shape="rect"/>links on a <a class="calibre17" shape="rect"/>web page. Checking link validity is important for several reasons. First, as a viewer, encountering broken links is very frustrating. Second, valid links make a site more professional. Finally, if your website contains a link to someone else's site and they move or remove a page, you have no way of knowing without specifically checking.<a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/></p>

      <p class="calibre4">Without automating this task, a person would have to literally click each link to prove the paths were valid. Extremely small sites are easy to validate, but sites with many links are tedious and time consuming. This is an example of a task that, when done manually, could take several hours. With the use of some Ruby tricks, you can cut that time down to 10 seconds! Writing the script will take a little time, but it's reusable.</p>
    </div>
  </div>


  <div class="calibre3">&#13;
    <div class="calibre3 calibre3 calibre3">&#13;
      <h2 class="calibre8" id="calibre_pb_96"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos194055"/>The Code</span></h2>&#13;
    </div><a class="calibre17" shape="rect"/>&#13;
&#13;
    <div class="calibre3">&#13;
      <span class="calibre18"><tt class="calibre19"> require 'uri'<br class="calibre20"/>&#13;
       require 'open-uri'<br class="calibre20"/>&#13;
       require 'rubyful_soup'<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
       begin<br class="calibre20"/>&#13;
           print "\n\nEnter website to crawl (ex. http://www.google.com): "<br class="calibre20"/>&#13;
           url = gets<br class="calibre20"/>&#13;
           puts url<br class="calibre20"/>&#13;
           uri = URI.parse(url)<br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00002.jpg"/> html = open(uri).read<br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00003.jpg"/> rescue Exception =&gt; e<br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00004.jpg"/>      print "Unable to connect to the url:"<br class="calibre20"/>&#13;
            puts "ERROR ----  #{e}"<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
       end<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
       soup = BeautifulSoup.new(html)<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00005.jpg"/> links = soup.find_all('a').map { |a| a['href'] }<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00006.jpg"/> links.delete_if { |href| href =~ /javascript|mailto/ }<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00007.jpg"/> links.each do |l|<br class="calibre20"/>&#13;
           if l<br class="calibre20"/>&#13;
               begin<br class="calibre20"/>&#13;
                   link = URI.parse(l)<br class="calibre20"/>&#13;
                   link.scheme ||= 'http'<br class="calibre20"/>&#13;
                   link.host ||= uri.host<br class="calibre20"/>&#13;
                   link.path = uri.path + link.path unless link.path[0] == //<br class="calibre20"/>&#13;
                   link = URI.parse(link.to_s)<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
                   open(link).read<br class="calibre20"/>&#13;
               rescue Exception =&gt; e<br class="calibre20"/>&#13;
                   puts "#{link} failed because #{e}"<br class="calibre20"/>&#13;
               end<br class="calibre20"/>&#13;
           end<br class="calibre20"/>&#13;
       end</tt></span>&#13;
    </div>&#13;
  </div>&#13;


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_97"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos196287"/>Running the Code</span></h2>
    </div>

    <p class="calibre4">You will validate the <a class="calibre17" shape="rect"/>links on any given website by first launching the script like this:<a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/></p><a class="calibre17" shape="rect"/>

    <div class="calibre3">
      <span class="calibre18"><tt class="calibre19"><strong class="calibre22"><code class="calibre19">ruby linkValidator.rb</code></strong></tt></span>
    </div>

    <p class="calibre4">The script will present you with a prompt to enter the website you want to crawl. You need to enter the site with a full URL address (for example, <a class="calibre6" href="http://www.nostarch.com/" shape="rect">http://www.nostarch.com/</a>). From there, the script will list the links it had trouble accessing.</p>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_98"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos197438"/>The Results</span></h2>
    </div>

    <p class="calibre4">As a test, I ran the script against a website that shall go nameless, and the results are below.<a class="calibre17" shape="rect"/></p><a class="calibre17" shape="rect"/>

    <div class="calibre3">
      <span class="calibre18"><tt class="calibre19">Enter website to crawl (ex. http://www.google.com): <em class="italic"><code class="calibre19">http://www.url.com</code></em><br class="calibre20"/>
      http://www.url.com/products/specials.html failed because 403 Forbidden</tt></span>
    </div>

    <p class="calibre4">The site contained about 50 links. Each link was validated except for one, <span><em class="italic">specials.html</em></span>. As you can see from the error reported, the reason the specials page was not accessible was due to "403 Forbidden." This happened because the site owner didn't want to release the specials page for public viewing.</p>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_99"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos198683"/>How It Works</span></h2>
    </div>

    <p class="calibre4">For starters, we need to talk about HTML manipulation and interfacing with websites. Ruby has several ways of accessing the Web, but the simplest to use, by far, is <a class="calibre17" shape="rect"/>open_uri. If you are familiar with <code class="calibre19">wget</code>, then getting to know open_uri should be easy; with my wicked little gems, I'm halfway to scraping web pages. For Internet scraping activities, I typically use <a class="calibre17" shape="rect"/>rubyful_soup, an <a class="calibre17" shape="rect"/>HTML/XML parser for Ruby, in combination with uri and open_uri. The rubyful_soup gem can be installed like any of the other gems used throughout the book. As you follow the examples in the book, you will see just how powerful rubyful_soup can be.<a class="calibre17" shape="rect"/></p>

    <p class="calibre4">The script begins with some error handling in case the user mistakenly enters a bad URL or a connection cannot be made to the root directory of the web address <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00003.jpg"/></span>. Either way, the user will get more than one chance to correct his errors.</p>

    <p class="calibre4">After the URL has been entered, it is parsed using the uri library. The URL you provide is opened using the <code class="calibre19">open(uri).read</code> command <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00002.jpg"/></span>. This single line opens the URL and reads in all of the HTML source code. Pretty cool, huh? Did you ever think scraping a web page would be so easy?</p>

    <p class="calibre4">If there are any issues navigating to your <a class="calibre17" shape="rect"/>URL, the script will show you the error and print the specific error message <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00004.jpg"/></span>. Now on to the fun part, where <a class="calibre17" shape="rect"/>rubyful_soup shows its power.</p>

    <p class="calibre4">A new batch <a class="calibre17" shape="rect"/>of rubyful_soup is made by initializing the <code class="calibre19">BeautifulSoup</code> and passing in our HTML source code. The soup allows us to easily parse the HTML source code. Sure, you could write a fancy <a class="calibre17" shape="rect"/>regular expression or check each line for an <code class="calibre19">HREF</code>, but this feature is already supported by the soup! Just tell the soup to find all of the <a class="calibre17" shape="rect"/>links in the source and save them to our array entitled <code class="calibre19">links</code> <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00005.jpg"/></span>. One thing we want to remove is <code class="calibre19">javascript</code> and <code class="calibre19">mailto</code> links because these will make the parsers unhappy when they start testing link validity <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00006.jpg"/></span>. Once the links are cleaned up, the script starts to iterate through each one.</p>

    <p class="calibre4">Because we are checking for the validity of each link, what we are really checking for is any link that throws an error. If no errors are thrown, we know for certain that the link is valid. To interpret the output, we use a little more error-handling-fu and start checking each link <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00007.jpg"/></span>. If the links are valid, the script will move on. If a link is bad, it will be logged. In this script, I have chosen to output the bad links to the command prompt, but you can hack the script to output to a text file or whatever you want.</p>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_100"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos203147"/>Hacking the Script</span></h2>
    </div>

    <p class="calibre4">Another hack for this script would be to crawl the valid links that are found in the initial root domain. You can limit the crawler by specifying a link depth at which to crawl. This would allow you to crawl every link on an entire site. If the site isn't your own, you'd probably also want to add a delay between page fetches so that you wouldn't bog down the server. You could also incorporate HTTPS support using open_uri.</p>

    <p class="calibre4">If there is a particular site you wish to crawl, you can hard-code the address into the script so you won't have to keep typing it. This is a great foundational script for more Internet scraping.<a class="calibre17" shape="rect"/></p>
  </div>

  <div class="mbppagebreak" id="calibre_pb_101"/>


  <div class="calibre3 calibre3 calibre3 calibre3" id="filepos204064">
    <h1 class="calibre1" id="calibre_pb_102"><span class="calibre2"><a class="calibre7" shape="rect"/>Orphan File Checker</span></h1>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_103"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos204558"/>Orphan File Checker</span></h2>
    </div>

    <div class="calibre3">
      <div class="calibre3 calibre3 calibre3">
        <h3 class="calibre16" id="heading_id_2"><a class="calibre7" shape="rect"/>orphanCheck.rb</h3>
      </div>

      <p class="calibre4">In this section, we will be looking at the inverse of invalid link files—I will show you how to find files that are not linked at all. <span><em class="italic">An orphan file</em></span> is any file on a web server that has lost its link. Not only do these files waste space, they also have the potential to confuse web page administrators with superfluous files.<a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/></p>

      <p class="calibre4">I am what some may call a neat freak. I like to have things in order, just the way I like them. I despise clutter and wasted space. I treat my computer systems the same way, so I prefer to keep only the files that I need. If you have ever made a lot of changes or upgrades, or if you have had to share a system with other people, then you know how chaotic and disorganized filesystems can become. The orphan file checker script is unique because it gives you information that solves two problems. The first problem is <a class="calibre17" shape="rect"/>finding out which files are not accessible on your web server. Secondly, the script allows you to see the files that are being listed that should not be. Obviously, some files are not meant to have a link, but you should know which ones those are before you run this script.</p>
    </div>
  </div>


  <div class="calibre3">&#13;
    <div class="calibre3 calibre3 calibre3">&#13;
      <h2 class="calibre8" id="calibre_pb_104"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos206593"/>The Code</span></h2>&#13;
    </div><a class="calibre17" shape="rect"/>&#13;
&#13;
    <div class="calibre3">&#13;
      <span class="calibre18"><tt class="calibre19"><img alt="" class="calibre23" src="../Images/00002.jpg"/> links = Array.new<br class="calibre20"/>&#13;
       <a class="calibre17" shape="rect"/>orphans = Array.new<br class="calibre20"/>&#13;
       dir_array = [Dir.getwd]<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00003.jpg"/> unless File.readable?("links.txt")<br class="calibre20"/>&#13;
           puts "File is not readable."<br class="calibre20"/>&#13;
           exit<br class="calibre20"/>&#13;
       end<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
       File.open('links.txt', 'rb') do |lv|<br class="calibre20"/>&#13;
           lv.each_line do |line|<br class="calibre20"/>&#13;
               links &lt;&lt; line.chomp<br class="calibre20"/>&#13;
           end<br class="calibre20"/>&#13;
       end<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
       begin<br class="calibre20"/>&#13;
           p = dir_array.shift<br class="calibre20"/>&#13;
           Dir.chdir(p)<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
           Dir.foreach(p) do |filename|<br class="calibre20"/>&#13;
               next if filename == '.' or filename == '..'<br class="calibre20"/>&#13;
               if !File::directory?(filename)<br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00004.jpg"/>                orphans &lt;&lt; p + File::SEPARATOR + filename<br class="calibre20"/>&#13;
               else<br class="calibre20"/>&#13;
                   dir_array &lt;&lt; p + File::SEPARATOR + filename<br class="calibre20"/>&#13;
               end<br class="calibre20"/>&#13;
           end<br class="calibre20"/>&#13;
       end while !dir_array.empty?<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00005.jpg"/> orphans -= links<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
       File.open("orphans.txt", "wb") do |o|<br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00006.jpg"/>       o.puts orphans<br class="calibre20"/>&#13;
       end</tt></span>&#13;
    </div>&#13;
  </div>&#13;


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_105"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos208550"/>Running the Script</span></h2>
    </div>

    <p class="calibre4">To run the script, you must have already created a file called <span><em class="italic">links.txt</em></span> that contains a list of all the hyperlinks on a website. This list can be accomplished using a modified version of "#10 Web Page Link Validator" on <a class="calibre6" href="../Text/dummy_split_076.html#filepos194055" shape="rect">The Code</a>, or one <a class="calibre17" shape="rect"/>of your own scripts. The format is a single file, with the full path on each line. The file I used for this example was based on a web page used to track a few <a class="calibre17" shape="rect"/>of my Ruby web scripts; it looks like this:</p><a class="calibre17" shape="rect"/>

    <div class="calibre3">
      <span class="calibre18"><tt class="calibre19">/ruby/scripts/website_scripting\index.html<br class="calibre20"/>
      /ruby/scripts/website_scripting\orphanCheck.rb<br class="calibre20"/>
      /ruby/scripts/website_scripting\rssParser.rb<br class="calibre20"/>
      /ruby/scripts/website_scripting\ipAdderGen.rb<br class="calibre20"/>
      /ruby/scripts/website_scripting\formGenerator.rb</tt></span>
    </div>

    <p class="calibre4">The script does all of the work; you just have to type:</p><a class="calibre17" shape="rect"/>

    <div class="calibre3">
      <span class="calibre18"><tt class="calibre19"><strong class="calibre22"><code class="calibre19">ruby orphanCheck.rb</code></strong></tt></span>
    </div>

    <p class="calibre4">Now sit back, relax, and wait for the script to write <span><em class="italic">orphans.txt</em></span>.<a class="calibre17" shape="rect"/></p>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_106"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos210471"/>The Results</span></h2>
    </div>

    <p class="calibre4">The results of this script will be in a file called <span><em class="italic">orphans.txt</em></span>. The file will contain a complete path for each file that does not have a listing in <span><em class="italic">links.txt</em></span>. As you recall, the <span><em class="italic">links.txt</em></span> file contains a list of all files found on your website. Here's an example <span><em class="italic">orphans.txt</em></span> file:</p><a class="calibre17" shape="rect"/>

    <div class="calibre3">
      <span class="calibre18"><tt class="calibre19">/ruby/scripts/website_scripting\form.html<br class="calibre20"/>
      /ruby/scripts/website_scripting\linkValidator.rb<br class="calibre20"/>
      /ruby/scripts/website_scripting\subnetting.rb<br class="calibre20"/>
      /ruby/scripts/website_scripting\historicalStockParse.rb<br class="calibre20"/>
      /ruby/scripts/website_scripting\links.txt</tt></span>
    </div>

    <p class="calibre4">These are the files that were found on the web server that were not in the <span><em class="italic">links.txt</em></span> file. If I wanted to share these files with the world, then I would have <code class="calibre19">&lt;a href="link"&gt;</code> tags for them on my web page. But if these orphaned files were still in the works and not ready for public viewing, then there wouldn't be any issue (which was the case here).</p>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_107"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos212247"/>How It Works</span></h2>
    </div>

    <p class="calibre4">The script does not use any outside libraries, thus keeping its execution simple. I start by initializing the arrays that I'll be using to keep track of my links and <a class="calibre17" shape="rect"/>orphan files <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00002.jpg"/></span>. Next, I look to ensure that my <span><em class="italic">links.txt</em></span> file exists. If not, then there isn't much point in continuing to run the script, so it exits out with a nice error message <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00003.jpg"/></span>. If <span><em class="italic">links.txt</em></span> does exist, then we continue by opening the file and reading in all of the contents line-by-line. You can change this to a <span><em class="italic">comma-separated values (CSV)</em></span> file, but I prefer the readability of one link per line.</p>

    <p class="calibre4">After the links have been stored in the array <code class="calibre19">links</code>, the script begins to index every file in the current working directory. The results will be stored in an array called <code class="calibre19">orphans</code> <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00004.jpg"/></span>. If there are subdirectories, the script will also index those files. Presumably, you would run this in the root directory of your web server to take full advantage of this script.</p>

    <p class="calibre4">Now that the script has both the links and local files indexed, it is time to start comparing the two arrays, and see what's left <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00005.jpg"/></span>. I called the second array <code class="calibre19">orphans</code> because I will be deleting any entry that exists within the <code class="calibre19">link</code> array. Whatever is left will be files not included on the public-facing side of the web server.</p>

    <p class="calibre4">The script ends by creating a file called <span><em class="italic">orphans.txt</em></span> in the script's directory and writing the results to that file <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00006.jpg"/></span>. Finally, after the code block is finished, the file is closed and the script finished.</p>
  </div>

  <div class="mbppagebreak" id="calibre_pb_108"/>


  <div class="calibre3 calibre3 calibre3 calibre3" id="filepos215128">
    <h1 class="calibre1" id="calibre_pb_109"><span class="calibre2"><a class="calibre7" shape="rect"/>Form Generator</span></h1>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_110"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos215617"/>Form Generator</span></h2>
    </div>

    <div class="calibre3">
      <div class="calibre3 calibre3 calibre3">
        <h3 class="calibre16" id="heading_id_2"><a class="calibre7" shape="rect"/>formGenerator.rb</h3>
      </div>

      <p class="calibre4">When <a class="calibre17" shape="rect"/>forms first came onto the HTML scene, they were underutilized <a class="calibre17" shape="rect"/>tools. Now you can go to practically any site and find a form with one of those cool little submission buttons at the bottom. Google returns a whopping 60,000,000 results for a <span><em class="italic">submit button</em></span> search. Needless to say, web forms have become part of our digital lives. Forms can gather many different types of information. They can also anonymize a recipient's <a class="calibre17" shape="rect"/>email address. If your email address is published on a website and an email harvester collects it, you can expect to be receiving a lot of <a class="calibre17" shape="rect"/>spam. If you use a form on your site, your email remains hidden from users (and robots), but you can still receive email from your site's users. Also, forms allow users to communicate without a need for their own <span><em class="italic">Simple Mail Transfer Protocol (SMTP)</em></span> server or email service.<a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/></p>

      <p class="calibre4">Forms are simple and flexible. If you want to receive customer feedback, create a form. If you want to conduct a survey, create a form. You get the idea.</p>

      <p class="calibre4">Knowing how to create them is a good skill to have, but an even cooler skill is knowing how to create them automatically! With this script, you can build forms on the fly or create form templates. Creating web forms is no big deal. As you experiment with this script, you will generate numerous form files. If you don't feel like tracking each file, then use script #11, <a class="calibre17" shape="rect"/>Orphan File Checker (see <a class="calibre6" href="../Text/dummy_split_080.html#filepos203147" shape="rect">Hacking the Script</a>), to clean up your mess.<a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/></p>
    </div>
  </div>


  <div class="calibre3">&#13;
    <div class="calibre3 calibre3 calibre3">&#13;
      <h2 class="calibre8" id="calibre_pb_111"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos218415"/>The Code</span></h2>&#13;
    </div><a class="calibre17" shape="rect"/>&#13;
&#13;
    <div class="calibre3">&#13;
      <span class="calibre18"><tt class="calibre19">require 'cgi'<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00002.jpg"/> cgi = CGI.new("html4Tr")<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00003.jpg"/> print "Enter Form Page Title: "<br class="calibre20"/>&#13;
       title = gets.chomp<br class="calibre20"/>&#13;
       print "Enter Head Title: "<br class="calibre20"/>&#13;
       input_title = gets.chomp<br class="calibre20"/>&#13;
       print "Enter value for button: "<br class="calibre20"/>&#13;
       value = gets.chomp<br class="calibre20"/>&#13;
       print "Enter group: "<br class="calibre20"/>&#13;
       group = gets.chomp<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00004.jpg"/> $stdout = File.new("form.html","w")<br class="calibre20"/>&#13;
       cgi.out{<br class="calibre20"/>&#13;
           CGI.pretty(<br class="calibre20"/>&#13;
               <a class="calibre17" shape="rect"/>cgi.html{<br class="calibre20"/>&#13;
      <a class="calibre17" shape="rect"/><br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00005.jpg"/>                    cgi.head{ "\n"+cgi.title{title}}+<br class="calibre20"/>&#13;
                       cgi.body{"\n" +<br class="calibre20"/>&#13;
                           cgi.form{"\n" +<br class="calibre20"/>&#13;
                           cgi.hr +<br class="calibre20"/>&#13;
                           cgi.h1 { "#{input_title}:" } + "\n" +<br class="calibre20"/>&#13;
                           cgi.br +<br class="calibre20"/>&#13;
                           cgi.checkbox(group, value) + value + cgi.br +<br class="calibre20"/>&#13;
                           cgi.br +<br class="calibre20"/>&#13;
                           cgi.textarea("input",80,5) + "\n" +<br class="calibre20"/>&#13;
                           cgi.br +<br class="calibre20"/>&#13;
                           cgi.submit("Send")<br class="calibre20"/>&#13;
                           }<br class="calibre20"/>&#13;
                       }<br class="calibre20"/>&#13;
                }<br class="calibre20"/>&#13;
          )<br class="calibre20"/>&#13;
       }<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
       $stdout.close</tt></span>&#13;
    </div>&#13;
  </div>&#13;


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_112"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos220959"/>Running the Code</span></h2>
    </div>

    <p class="calibre4">This script takes user input to create the HTML form. Execute the script like any other, and follow its lead.</p>
  </div>


  <div class="calibre3">&#13;
    <div class="calibre3 calibre3 calibre3">&#13;
      <h2 class="calibre8" id="calibre_pb_113"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos221429"/>The Results</span></h2>&#13;
    </div>&#13;
&#13;
    <p class="calibre4">Contents <span><em class="italic">of form.html</em></span>:</p><a class="calibre17" shape="rect"/>&#13;
&#13;
    <div class="calibre3">&#13;
      <span class="calibre18"><tt class="calibre19">Content-Type: text/html<br class="calibre20"/>&#13;
      Content-Length: 724<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      &lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"<br class="calibre20"/>&#13;
      "http://www.w3.org/TR/html4/loose.dtd"&gt;<br class="calibre20"/>&#13;
      &lt;HTML&gt;<br class="calibre20"/>&#13;
        &lt;HEAD&gt;<br class="calibre20"/>&#13;
          &lt;TITLE&gt;<br class="calibre20"/>&#13;
            No Starch Press | Errata Submissions<br class="calibre20"/>&#13;
          &lt;/TITLE&gt;<br class="calibre20"/>&#13;
        &lt;/HEAD&gt;<br class="calibre20"/>&#13;
        &lt;BODY&gt;<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
          &lt;FORM METHOD="post" ENCTYPE="application/x-www-form-urlencoded"&gt;<br class="calibre20"/>&#13;
            &lt;HR&gt;<br class="calibre20"/>&#13;
            &lt;H1&gt;<br class="calibre20"/>&#13;
              Wicked Cool Ruby Scripts -- Errata Submissions:<br class="calibre20"/>&#13;
            &lt;/H1&gt;<br class="calibre20"/>&#13;
            &lt;BR&gt;<br class="calibre20"/>&#13;
            &lt;INPUT NAME="Bad Errata Submissions" TYPE="checkbox" VALUE="High<br class="calibre20"/>&#13;
      Priority"&gt;<br class="calibre20"/>&#13;
            Super Critical!!!<br class="calibre20"/>&#13;
            &lt;BR&gt;<br class="calibre20"/>&#13;
            &lt;TEXTAREA NAME="input" ROWS="5" COLS="80"&gt;<br class="calibre20"/>&#13;
            &lt;/TEXTAREA&gt;<br class="calibre20"/>&#13;
            &lt;BR&gt;<br class="calibre20"/>&#13;
            &lt;INPUT TYPE="submit" VALUE="Send"&gt;<br class="calibre20"/>&#13;
          &lt;/<a class="calibre17" shape="rect"/>FORM&gt;<br class="calibre20"/>&#13;
        &lt;/BODY&gt;<br class="calibre20"/>&#13;
      &lt;/HTML&gt;</tt></span>&#13;
    </div>&#13;
&#13;
    <p class="calibre4">See it in action in <a class="calibre6" href="#filepos223333" shape="rect">Figure 2-1</a>.</p>&#13;
&#13;
    <div class="calibre20">&#13;
      <span class="italic"><a class="calibre17" shape="rect"/></span>&#13;
&#13;
      <div class="calibre3 calibre3" id="filepos223333">&#13;
        <span class="italic"><a class="calibre17" shape="rect"/><img alt="The resulting form, as seen in a web browser" class="calibre23" src="../Images/00010.jpg"/></span>&#13;
      </div>&#13;
&#13;
      <p class="calibre4">Figure 2-1. The resulting form, as seen in a web browser</p>&#13;
    </div>&#13;
  </div>&#13;


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_114"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos223936"/>How It Works</span></h2>
    </div>

    <p class="calibre4">The form generation script uses the cgi library, so it is included in the <code class="calibre19">require</code> statement. I created a new document and specified that the HTML 4.0 Transitional version methods be used for <a class="calibre17" shape="rect"/>generating my code by using <code class="calibre19">html4Tr</code> as the argument <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00002.jpg"/></span>. The other options are <code class="calibre19">html3</code> (HTML 3.<span><em class="italic">x</em></span>), <code class="calibre19">html4</code> (HTML 4.<span><em class="italic">x</em></span>), or <code class="calibre19">html4Fr</code> (HTML 4.0 with Framesets). After the cgi methods have been set up, the script requests information from the user <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00003.jpg"/></span>. This script creates a submission form with one <a class="calibre17" shape="rect"/>checkbox and a text box. The example is a form developed for errata submissions.</p>

    <p class="calibre4">The header of the form is requested first, followed by the title of the web form. Next, the value of the checkbox is presented. In this example, I gave the user an option of submitting the value <code class="calibre19">High Priority</code>, to demonstrate the checkbox options. Checkboxes are useful when you are looking for information that must be a specific choice; for example, dinner choices—<code class="calibre19">chicken</code> or <code class="calibre19">beef</code>. Finally, I added a text box to allow the user to detail any errors she may have found. Once the information is collected, the script will go to work writing a slick HTML form.</p>

    <p class="calibre4">Two important lines of code are included in the redirection of standard <a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/>output <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00004.jpg"/></span>. <code class="calibre19">$stdout</code> is redirected to a new file called <span><em class="italic">form.html</em></span>, and it will capture the HTML form. The cgi method <code class="calibre19">out</code> is called to prepare the file for the creation of HTML code. Then the <code class="calibre19">pretty</code> method is used; although not necessary, it cleans up the HTML code so it resembles something you can easily read, with proper line spacing and indentations.<a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/></p>

    <p class="calibre4">The <code class="calibre19">HTML</code> method then begins constructing each piece of our form. First comes the head, which we specified earlier; next is the body, with each part of the form <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00005.jpg"/></span>. Last, and most importantly, is the submission button, which I appropriately named Send. To clean up our open file, we close it and exit the script. Our shiny new HTML form is ready for use.</p>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_115"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos227695"/>Hacking the Script</span></h2>
    </div>

    <p class="calibre4">The beauty of this script is in how simple writing HTML code becomes. You can explore the cgi library further to incorporate radio buttons, multiple groups, and other elements of a form. You can make this script even more flexible by specifying how many groups are needed and how many options should be in each group.</p>
  </div>

  <div class="mbppagebreak" id="calibre_pb_116"/>


  <div class="calibre3 calibre3 calibre3 calibre3" id="filepos228199">
    <h1 class="calibre1" id="calibre_pb_117"><span class="calibre2"><a class="calibre7" shape="rect"/>RSS Parsing</span></h1>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_118"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos228685"/>RSS Parsing</span></h2>
    </div>

    <div class="calibre3">
      <div class="calibre3 calibre3 calibre3">
        <h3 class="calibre16" id="heading_id_2"><a class="calibre7" shape="rect"/>rssParser.rb</h3>
      </div>

      <p class="calibre4"><a class="calibre17" shape="rect"/><span><em class="italic">Really Simple Syndication (RSS)</em></span> is a wonderful technology that has been gaining popularity since early 2000. RSS feeds allow users to stay current on information that frequently changes, such as news headlines or product announcements. Many websites feature RSS feeds, and a feed reader is needed to extract the important data included in the feed.<a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/></p>

      <p class="calibre4">Distribution can extend the functionality and interoperability of information. Ruby has a library which allows you to customize the way feeds are retrieved, published, aggregated, and manipulated. This script will allow you to retrieve information from No Starch's blog at <a class="calibre6" href="http://nostarch.com/blog/?feed=rss2/" shape="rect">http://nostarch.com/blog/?feed=rss2/</a>.<a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/></p>
    </div>
  </div>


  <div class="calibre3">&#13;
    <div class="calibre3 calibre3 calibre3">&#13;
      <h2 class="calibre8" id="calibre_pb_119"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos230448"/>The Code</span></h2>&#13;
    </div><a class="calibre17" shape="rect"/>&#13;
&#13;
    <div class="calibre3">&#13;
      <span class="calibre18"><tt class="calibre19"> require 'rss/1.0'<br class="calibre20"/>&#13;
       require 'rss/2.0'<br class="calibre20"/>&#13;
       require 'open-uri'<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00002.jpg"/> source = "http://nostarch.com/blog/?feed=rss2" # location of rss feed<br class="calibre20"/>&#13;
       content = ""<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00003.jpg"/> open(source) do |info|<br class="calibre20"/>&#13;
           content = info.read<br class="calibre20"/>&#13;
       end<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00004.jpg"/> rss = RSS::Parser.parse(content, false)<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
       print "Do you want to see feed descriptions (y/n)? "  <br class="calibre20"/>&#13;
       input = gets.chomp<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
       desc = input == 'y' || input == 'Y'<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
       puts "\n\nTITLE: #{rss.channel.title}"<br class="calibre20"/>&#13;
       puts "DESCRIPTION: #{rss.channel.description}"<br class="calibre20"/>&#13;
       puts "LINK: #{rss.channel.link}"<br class="calibre20"/>&#13;
       puts "PUBLICATION DATE: #{rss.channel.date} \n\n"<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00005.jpg"/> rss.items.size.times do |i|<br class="calibre20"/>&#13;
           puts "#{rss.items[i].date} ... #{rss.items[i].title}"<br class="calibre20"/>&#13;
           if desc<br class="calibre20"/>&#13;
               print "#{rss.items[i].description}\n\n\n"<br class="calibre20"/>&#13;
           end<br class="calibre20"/>&#13;
       end</tt></span>&#13;
    </div>&#13;
  </div>&#13;


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_120"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos232039"/>Running the Code</span></h2>
    </div>

    <p class="calibre4">To run this script, type:</p><a class="calibre17" shape="rect"/>

    <div class="calibre3">
      <span class="calibre18"><tt class="calibre19"><strong class="calibre22"><code class="calibre19">ruby rssParser.rb</code></strong></tt></span>
    </div>

    <p class="calibre4">The script will then ask if you would like to see the feed descriptions along with the titles. Enter <code class="calibre19">yes</code> or <code class="calibre19">no</code>. If you input <code class="calibre19">no</code>, the script will display only the titles from each entry.</p>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_121"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos232980"/>The Results</span></h2>
    </div>

    <p class="calibre4">With the descriptions turned off:</p><a class="calibre17" shape="rect"/>

    <div class="calibre3">
      <span class="calibre18"><tt class="calibre19">TITLE: The No Starch Press Blog<br class="calibre20"/>
      DESCRIPTION: With more stuff, less fluff<br class="calibre20"/>
      LINK: http://nostarch.com/blog<br class="calibre20"/>
      PUBLICATION DATE: Thu, 07 Aug 2008 13:42:08 -0400<br class="calibre20"/>
      <br class="calibre20"/>
      Thu, 07 Aug 2008 13:42:08 -0400 ... Good eats in Vegas<br class="calibre20"/>
      Tue, 29 Jul 2008 22:44:17 -0400 ... Boolean Operator<br class="calibre20"/>
      Thu, 10 Jul 2008 03:18:18 -0400 ... Windows Upgrade Hell<br class="calibre20"/>
      Sat, 05 Jul 2008 02:47:27 -0400 ... Problems brewing at Google?<br class="calibre20"/>
      Thu, 03 Jul 2008 15:35:30 -0400 ... Nick Hornby on eBooks<br class="calibre20"/>
      Tue, 17 Jun 2008 17:37:15 -0400 ... Happy Download Day!<br class="calibre20"/>
      Tue, 17 Jun 2008 14:22:08 -0400 ... How to Write a Book<br class="calibre20"/>
      Mon, 16 Jun 2008 19:08:22 -0400 ... Monday Afternoon Linkfest<br class="calibre20"/>
      Mon, 02 Jun 2008 04:36:47 -0400 ... Is blogging boring?<br class="calibre20"/>
      Wed, 21 May 2008 05:15:18 -0400 ... Giant LEGO Boulder</tt></span>
    </div>

    <p class="calibre4">With the descriptions left on:</p><a class="calibre17" shape="rect"/>

    <div class="calibre3">
      <span class="calibre18"><tt class="calibre19">TITLE: more stuff, less fluff<br class="calibre20"/>
      DESCRIPTION: the only blog with no starch<br class="calibre20"/>
      LINK: http://nostarch.com/blog<br class="calibre20"/>
      PUBLICATION DATE: Thu, 07 Aug 2008 13:42:08 -0400<br class="calibre20"/>
      <br class="calibre20"/>
      Thu, 07 Aug 2008 13:42:08 -0400 ... Good eats in Vegas<br class="calibre20"/>
      It's DEFCON time and that means Vegas. And as tempting as the $1.99 buffet<br class="calibre20"/>
      might be, maybe you've had all the cheap steak you want for the day. Check out<br class="calibre20"/>
      Bill's restaurant map for other ideas. There's a wide range represented, from<br class="calibre20"/>
      Himalayan cuisine to good ol' American food. If you've been to any of [...]<br class="calibre20"/>
      <br class="calibre20"/>
      Tue, 29 Jul 2008 22:44:17 -0400 ... Boolean Operator<br class="calibre20"/>
      The search performed by Monica Goodling while 'vetting' candidates for<br class="calibre20"/>
      positions within the Department of Justice:<br class="calibre20"/>
      [First name of a candidate]! and pre/2 [last name of a candidate] w/7 bush or<br class="calibre20"/>
      gore or republican! or democrat! or charg! or accus! or criticiz! or blam! or<br class="calibre20"/>
      defend! or iran contra or clinton or spotted owl or florida [...]<br class="calibre20"/>
      <br class="calibre20"/>
      Thu, 10 Jul 2008 03:18:18 -0400 ... Windows Upgrade Hell<br class="calibre20"/>
      Unfortunately, many of us here still use Windows. (I use Ubuntu almost<br class="calibre20"/>
      exclusively now, except when I'm fixing Windows.) And, even more<br class="calibre20"/>
      unfortunately, when it's time for that inevitable Windows problem, I often end<br class="calibre20"/>
      up having to fix it.<br class="calibre20"/>
      Tonight I chose to upgrade one of our XP machines to XP Pro. You'd figure that<br class="calibre20"/>
      would [...]<br class="calibre20"/>
      <br class="calibre20"/>
      ---[snip]---</tt></span>
    </div>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_122"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos235884"/>How It Works</span></h2>
    </div>

    <p class="calibre4">Fortunately, this script is fairly straightforward. The script starts off identifying the source of the RSS feed <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00002.jpg"/></span>. This can be either a live website or a local file, but it must be in RSS format. Next, we initialize the variable content and proceed to read in all of the information from our source file—in this case, the source file is No Starch's blog <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00003.jpg"/></span>.</p>

    <p class="calibre4">After the raw data is saved in the variable content, the RSS parser begins working its magic. The parser will parse the RSS feed into its specific format and save the resulting data into a variable called <code class="calibre19">rss</code> <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00004.jpg"/></span>. The variable <code class="calibre19">rss</code> has a lot of properties available for manipulation, so feel free to dig in and see what other information you can glean from it.</p>

    <p class="calibre4">Now that the hard part is out of the way, I decide what information will be presented to the user. The main information I was interested in looking at was dates, titles, and possibly descriptions. This way I can skim a feed for anything that might interest me further. The descriptions on some RSS feeds can be lengthy and take up a lot of space. I gave myself the option of seeing the descriptions, if I really needed to <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00005.jpg"/></span>. As you can see above, the output without lengthy descriptions is much easier to process.</p>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_123"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos238155"/>Hacking the Script</span></h2>
    </div>

    <p class="calibre4">If you are interested in specific topics, you can incorporate a search function to look for particular key terms in the title of RSS entries or even in the descriptions themselves. Another idea is to use this script to comb several feeds, look for similar articles, and aggregate them for easy access. You may recall the date property; you can filter the results based on the date the entry was put into the feed. For instance, if you are looking for entries within the last week, you can write a conditional statement to only display the most recent information.<a class="calibre17" shape="rect"/></p>
  </div>

  <div class="mbppagebreak" id="calibre_pb_124"/>


  <div class="calibre3 calibre3 calibre3 calibre3" id="filepos238943">
    <h1 class="calibre1" id="calibre_pb_125"><span class="calibre2"><a class="calibre7" shape="rect"/>Stock Exchange Grep</span></h1>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_126"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos239437"/>Stock Exchange Grep</span></h2>
    </div>

    <div class="calibre3">
      <div class="calibre3 calibre3 calibre3">
        <h3 class="calibre16" id="heading_id_2"><a class="calibre7" shape="rect"/>stockGrep.rb</h3>
      </div>

      <p class="calibre4">Stocks are awesome! I love investing in companies and watching them as they grow and develop into industry leaders. And watching a catastrophic failure is pretty interesting, too. The stock market is fascinating and complex, and many people spend their entire lives trying to understand it. I don't try to play the game or understand it; I just observe.<a class="calibre17" shape="rect"/></p>

      <p class="calibre4">But, whenever I see a stock that I think has promise, I like to keep an eye on it. I could watch the stocks through a web service or turn on the TV, but that's not fast enough for me. I like to get my information how, where, and when I want it.</p>

      <p class="calibre4">This script allows me to retrieve different pieces of information about particular stocks and perform actions based on certain events. For instance, this script could be made to send a text message when a stock reaches a pre-defined level. It can also aggregate several stocks in the same industry for easier comparison. There is so much data available in the stock market— to have the ability to extract the important information is priceless. This script can be modified in many different ways, so read through it and let your imagination run wild.<a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/></p>
    </div>
  </div>


  <div class="calibre3">&#13;
    <div class="calibre3 calibre3 calibre3">&#13;
      <h2 class="calibre8" id="calibre_pb_127"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos241461"/>The Code</span></h2>&#13;
    </div><a class="calibre17" shape="rect"/>&#13;
&#13;
    <div class="calibre3">&#13;
      <span class="calibre18"><tt class="calibre19"> require 'open-uri'<br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00002.jpg"/> require 'csv'<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00003.jpg"/> def get_info stock_symbol<br class="calibre20"/>&#13;
           puts "#{stock_symbol} Current Ticker Information"<br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00004.jpg"/>     url = "http://download.finance.yahoo.com/d/<br class="calibre20"/>&#13;
       quotes.csv?s=#{stock_symbol}&amp;f=sl1d1t1c1ohgv&amp;e=.csv"<br class="calibre20"/>&#13;
           puts "Connecting to #{url}\n\n\n"<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00005.jpg"/>      csv = CSV.parse(open(url).read)<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
           csv.each do |row|<br class="calibre20"/>&#13;
               puts "--------------------------------------------------"<br class="calibre20"/>&#13;
               puts "Information current as of #{row[3]} on #{row[2]}\n\n"<br class="calibre20"/>&#13;
               puts "#{row[0]}'s last trade was - $#{row[1]}  (increase of #{row[4]})\n\n"<br class="calibre20"/>&#13;
               puts "\tOpened at $#{row[5]}"<br class="calibre20"/>&#13;
               puts "\tRange for the day $#{row[7]} - $#{row[6]}"<br class="calibre20"/>&#13;
           end<br class="calibre20"/>&#13;
           puts "--------------------------------------------------"<br class="calibre20"/>&#13;
       end<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
       print "Enter <a class="calibre17" shape="rect"/>stock symbol (separate by space if &gt; 1): "<br class="calibre20"/>&#13;
       stock_symbols = gets.upcase<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00006.jpg"/> stock_symbols.split.each do |symbol|<br class="calibre20"/>&#13;
           get_info(symbol)<br class="calibre20"/>&#13;
       end</tt></span>&#13;
    </div>&#13;
  </div>&#13;


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_128"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos243449"/>Running the Code</span></h2>
    </div>

    <p class="calibre4">Running the script is easy—you give it a ticker symbol, and it pulls the data. That's it. Execute the script by entering the following:</p><a class="calibre17" shape="rect"/>

    <div class="calibre3">
      <span class="calibre18"><tt class="calibre19"><strong class="calibre22"><code class="calibre19">ruby stockGrep.rb</code></strong></tt></span>
    </div>

    <p class="calibre4">You will then be prompted to enter the ticker symbols you want to look up.</p><a class="calibre17" shape="rect"/>

    <div class="calibre3">
      <span class="calibre18"><tt class="calibre19">Enter stock symbol (separate by space if &gt; 1): <strong class="calibre22"><code class="calibre19"><em class="italic"><code class="calibre19">arun</code></em></code></strong></tt></span>
    </div>

    <p class="calibre4">This script can pull any information from <a class="calibre17" shape="rect"/>Yahoo! Finance.</p>
  </div>


  <div class="calibre3">&#13;
    <div class="calibre3 calibre3 calibre3">&#13;
      <h2 class="calibre8" id="calibre_pb_129"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos244751"/>The Results</span></h2>&#13;
    </div>&#13;
&#13;
    <p class="calibre4">Any information available from Yahoo! Finance will be output at the command prompt. <span><em class="italic">StockGrep.rb</em></span> outputs standard stock information in a nice format. In this example, I searched for Aruba Networks, Inc., which is a company that delivers enterprise wireless solutions. The results were promising:</p><a class="calibre17" shape="rect"/>&#13;
&#13;
    <div class="calibre3">&#13;
      <span class="calibre18"><tt class="calibre19">ARUN Current Ticker Information<br class="calibre20"/>&#13;
      Connecting to http://download.finance.yahoo.com/d/quotes.csv?s=ARUN&amp;f=sl1d1t1c1ohgv&amp;e=.csv<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      --------------------------------------------------<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      Information current as of 4:00pm on 6/1/2007<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      ARUN's last trade was - $20.20  (increase of +0.85)<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
          Opened at $19.35<br class="calibre20"/>&#13;
          Range for the day $19.34 - $20.73<br class="calibre20"/>&#13;
      --------------------------------------------------</tt></span>&#13;
    </div>&#13;
  </div>&#13;


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_130"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos246052"/>How It Works</span></h2>
    </div>

    <p class="calibre4">The script begins by requiring the two libraries needed to provide full functionality to the script. We've already mentioned <a class="calibre17" shape="rect"/>open_uri, which is the first library. For a reminder, see script "#10 Web Page Link Validator" on <a class="calibre6" href="../Text/dummy_split_076.html#filepos194055" shape="rect">The Code</a>. The second library is <a class="calibre17" shape="rect"/>csv, and it is capable of <a class="calibre17" shape="rect"/>parsing <a class="calibre17" shape="rect"/>comma-separated value files <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00002.jpg"/></span>. The returned object from Yahoo! will be a CSV file, as you will soon see.</p>

    <p class="calibre4">Next, I define a short method that will be used to retrieve information from multiple ticker symbols <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00003.jpg"/></span>. If I wanted to limit the script to one ticker symbol at a time, this section could have been added right into the main body of the code. Within the method called <code class="calibre19">get_info</code>, the first step is to print the ticker symbol for the <a class="calibre17" shape="rect"/>stock being analyzed. Then a custom URL is crafted in order to request the correct data from Yahoo! Finance <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00004.jpg"/></span>. Notice the <code class="calibre19">#{stock_symbol}</code> embedded within the URL; this is where the customization comes into play. When this URL is sent to Yahoo!, a comma-separated value file is sent back to the script.</p>

    <p class="calibre4">The variable <code class="calibre19">csv</code> will be used to hold any data parsed by the <code class="calibre19">CSV.parse()</code> method. Each element in a CSV file will be put into an array <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00005.jpg"/></span>. Yahoo!'s stock files contain the same fields, so there is no guesswork involved in what the output should be. The six <code class="calibre19">puts</code> lines simply display the information in a user-friendly manner.<a class="calibre17" shape="rect"/></p>

    <p class="calibre4">The last step of the script, which is actually the first to be executed, is to retrieve the stock symbols, then split them apart <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00006.jpg"/></span>. For each symbol that is split, the method <code class="calibre19">get_info</code> is called, as explained above.</p>

    <div class="calibre3">
      <hr class="calibre21"/>
    </div>

    <div class="calibre3">
      <h3 class="calibre24" id="heading_id_2"><span class="calibre18"><a class="calibre7" shape="rect"/>Warning</span></h3>

      <p class="calibre4"><span class="calibre18"><span><em class="italic">Many websites continually change their products, so if the URL is no longer valid, you must find the new one. Updates to this script will be posted at</em></span> <a class="calibre6" href="http://www.nostarch.com/wcruby.htm/" shape="rect">http://www.nostarch.com/wcruby.htm/</a>.</span></p>
    </div>

    <div class="calibre3">
      <hr class="calibre21"/>
    </div>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_131"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos249877"/>Hacking the Script</span></h2>
    </div>

    <p class="calibre4">Several modifications can make this script even more powerful. If you are interested in trend analysis, you can integrate historical data into this script or even have the script retrieve data and write the information to another file for further analysis.</p>

    <p class="calibre4">It's also worth considering other trends you could track using a web scraper.<a class="calibre17" shape="rect"/></p>
  </div>

  <div class="mbppagebreak" id="calibre_pb_132"/>


  <div class="calibre3 calibre3 calibre3 calibre3" id="filepos250500">
    <h1 class="calibre1" id="calibre_pb_133"><span class="calibre2"><a class="calibre7" shape="rect"/>IP Address Generation</span></h1>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_134"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos250996"/>IP Address Generation</span></h2>
    </div>

    <div class="calibre3">
      <div class="calibre3 calibre3 calibre3">
        <h3 class="calibre16" id="heading_id_2"><a class="calibre7" shape="rect"/>ipAdderGen.rb</h3>
      </div>

      <p class="calibre4">Ever need to generate a range of IPs? I have found myself in several situations that called for just that, and I knew I didn't want to generate the list by hand. There isn't any magic involved, but the sheer usefulness of this script makes it noteworthy.<a class="calibre17" shape="rect"/></p>

      <p class="calibre4">Working with networks on a day-to-day basis means dealing with IP addresses. Sometimes a simple <code class="calibre19">ping</code> sweep is used to identify machines on a network. This script generates a pre-defined list of IPs in any format I choose.<a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/></p>

      <p class="calibre4">The IPs can then be fed into other utility scripts that perform tasks with each machine. This script can be converted into a reusable library and integrated into a variety of situations.</p>
    </div>
  </div>


  <div class="calibre3">&#13;
    <div class="calibre3 calibre3 calibre3">&#13;
      <h2 class="calibre8" id="calibre_pb_135"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos252609"/>The Code</span></h2>&#13;
    </div><a class="calibre17" shape="rect"/>&#13;
&#13;
    <div class="calibre3">&#13;
      <span class="calibre18"><tt class="calibre19"> class IP<br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00002.jpg"/>     def initialize(ip)<br class="calibre20"/>&#13;
               @ip = ip<br class="calibre20"/>&#13;
           end<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
           def to_s<br class="calibre20"/>&#13;
               @ip<br class="calibre20"/>&#13;
           end<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
           def==(other)<br class="calibre20"/>&#13;
               to_s==other.to_s<br class="calibre20"/>&#13;
           end<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00003.jpg"/>     def succ<br class="calibre20"/>&#13;
               return @ip if @ip == "255.255.255.255"<br class="calibre20"/>&#13;
               parts = @ip.split('.').reverse<br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00004.jpg"/>         parts.each_with_index do |part,i|<br class="calibre20"/>&#13;
                   if part.to_i &lt; 255<br class="calibre20"/>&#13;
                       part.succ!<br class="calibre20"/>&#13;
                       break<br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00005.jpg"/>             elsif part == "255"<br class="calibre20"/>&#13;
                       part.replace("0") unless i == 3<br class="calibre20"/>&#13;
                   else<br class="calibre20"/>&#13;
                       raise ArgumentError, "Invalid number #{part} in <a class="calibre17" shape="rect"/>IP address"<br class="calibre20"/>&#13;
                   end<br class="calibre20"/>&#13;
               end<br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00006.jpg"/>         parts.reverse.join('.')<br class="calibre20"/>&#13;
           end<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00007.jpg"/>     def succ!<br class="calibre20"/>&#13;
               @ip.replace(succ)<br class="calibre20"/>&#13;
           end<br class="calibre20"/>&#13;
       end<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00008.jpg"/> print "Input Starting IP Address: "<br class="calibre20"/>&#13;
       start_ip = gets.strip<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
       print "Input Ending IP Address: "<br class="calibre20"/>&#13;
       end_ip = gets.strip<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00009.jpg"/> i = IP.new(start_ip)<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00011.jpg"/> ofile = File.open("ips.txt", "w")<br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00012.jpg"/> ofile.puts i.succ! until i == end_ip<br class="calibre20"/>&#13;
       ofile.close</tt></span>&#13;
    </div>&#13;
  </div>&#13;


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_136"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos255399"/>Running the Code</span></h2>
    </div>

    <p class="calibre4">To run this script, type:</p><a class="calibre17" shape="rect"/>

    <div class="calibre3">
      <span class="calibre18"><tt class="calibre19"><strong class="calibre22"><code class="calibre19">ruby ipAdderGen.rb</code></strong></tt></span>
    </div>

    <p class="calibre4">It will then prompt you to submit a range of <a class="calibre17" shape="rect"/>IP addresses:</p><a class="calibre17" shape="rect"/>

    <div class="calibre3">
      <span class="calibre18"><tt class="calibre19">Input Starting IP Address: <strong class="calibre22"><code class="calibre19"><em class="italic"><code class="calibre19">192.168.0.1</code></em></code></strong><br class="calibre20"/>
      Input Ending IP Address: <strong class="calibre22"><code class="calibre19"><em class="italic"><code class="calibre19">192.168.0.20</code></em></code></strong></tt></span>
    </div>

    <p class="calibre4">The output will be in a text file with one IP address per line.</p>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_137"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos256743"/>The Results</span></h2>
    </div>

    <p class="calibre4">After the script has been executed successfully, look for a text file called <span><em class="italic">ips.txt</em></span>. As expected, the output will be:<a class="calibre17" shape="rect"/></p><a class="calibre17" shape="rect"/>

    <div class="calibre3">
      <span class="calibre18"><tt class="calibre19">192.168.0.1<br class="calibre20"/>
      192.168.0.2<br class="calibre20"/>
      192.168.0.3<br class="calibre20"/>
      192.168.0.4<br class="calibre20"/>
      192.168.0.5<br class="calibre20"/>
      192.168.0.6<br class="calibre20"/>
      192.168.0.7<br class="calibre20"/>
      192.168.0.8<br class="calibre20"/>
      192.168.0.9<br class="calibre20"/>
      192.168.0.10<br class="calibre20"/>
      192.168.0.11<br class="calibre20"/>
      192.168.0.12<br class="calibre20"/>
      192.168.0.13<br class="calibre20"/>
      192.168.0.14<br class="calibre20"/>
      192.168.0.15<br class="calibre20"/>
      192.168.0.16<br class="calibre20"/>
      192.168.0.17<br class="calibre20"/>
      192.168.0.18<br class="calibre20"/>
      192.168.0.19<br class="calibre20"/>
      192.168.0.20</tt></span>
    </div>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_138"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos257759"/>How It Works</span></h2>
    </div>

    <p class="calibre4">This script has no arguments or options. The script asks the user for two IP addresses <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00008.jpg"/></span>. One is the start of the IP range, and the second is the end of it. Next, a new <code class="calibre19">IP</code> object is created using the defined <code class="calibre19">IP</code> class called <code class="calibre19">i</code> <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00009.jpg"/></span>. The final step before generating the IPs is to initialize the file the IP addresses will be written to, named <code class="calibre19">ofile</code> <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00011.jpg"/></span>. Now the fun begins.</p>

    <p class="calibre4">For each item returned, the results will be output to <code class="calibre19">ofile</code>. Using the <code class="calibre19">IP</code> class method <code class="calibre19">succ!</code>, an until loop calls the <code class="calibre19">succ!</code> method until <code class="calibre19">i</code> equals <code class="calibre19">end_ip</code> <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00012.jpg"/></span>. Once the two values are equal, that means the ending IP address has been generated and the output file is closed.</p>

    <p class="calibre4">The <a class="calibre17" shape="rect"/>script relies on a custom class called <code class="calibre19">IP</code>, which has four methods: <code class="calibre19">initialize</code>, <code class="calibre19">to_s</code>, <code class="calibre19">succ</code>, and <code class="calibre19">succ!</code>. The <code class="calibre19">IP</code> class is important because, once an object is created, the <a class="calibre17" shape="rect"/>IP address is stored as a class variable for easy tracking. The first method called, when <code class="calibre19">i</code> is declared, is <code class="calibre19">initialize</code>. This sets <code class="calibre19">@ip</code> to <code class="calibre19">start_ip</code> <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00002.jpg"/></span>. Next, <code class="calibre19">succ!</code> is called to begin creating the range of IPs. <code class="calibre19">succ!</code> calls <code class="calibre19">succ</code> and utilizes the <code class="calibre19">replace</code> method to overwrite the contents in <code class="calibre19">@ip</code> whenever <code class="calibre19">succ</code> returns a value <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00007.jpg"/></span>. The meat of the <code class="calibre19">IP</code> class is located in the method <code class="calibre19">succ</code> <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00003.jpg"/></span>. If <code class="calibre19">@ip</code> ever increments to the highest IP address, the script will return <code class="calibre19">255.255.255.255</code>. IP addresses can only go up to that value.</p>

    <p class="calibre4">Next, the IP address, stored in <code class="calibre19">@ip</code>, is split apart in reverse order, using the period as a delimiter. The values are stored in an array called <code class="calibre19">parts</code>. After the IP address is properly separated, a new code block is called on the array using the <code class="calibre19">each_with_index</code> method to access two pieces of information—the index being passed and the value <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00004.jpg"/></span>. Within this block, the value in <code class="calibre19">part</code> is compared against 255, again to prohibit invalid IP addresses. If the value is equal to 255, then it is reset to zero <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00005.jpg"/></span>. The one exception to the zero reset is if the value of <code class="calibre19">i</code> is equal to 3, since that is the first octet of the IP. If <code class="calibre19">part</code> is less than 255, the method <code class="calibre19">succ!</code> is called and the <code class="calibre19">if/else</code> statement breaks.</p>

    <p class="calibre4">After each part has been run through the code block, the IP address is put back together opposite of how it was taken apart. The script puts each piece back together using the <code class="calibre19">join</code> method, with periods in between the elements, all in reverse order <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00006.jpg"/></span>. As mentioned previously, the <code class="calibre19">succ!</code> method is called until the <code class="calibre19">end_ip</code> address is equal to the results of <code class="calibre19">succ!</code>. That's all there is to perfectly generating an IP address range.<a class="calibre17" shape="rect"/></p>
  </div>

  <div class="mbppagebreak" id="calibre_pb_139"/>


  <div class="calibre3 calibre3 calibre3 calibre3" id="filepos263411">
    <h1 class="calibre1" id="calibre_pb_140"><span class="calibre2"><a class="calibre7" shape="rect"/>Subnet Calculator</span></h1>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_141"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos263903"/>Subnet Calculator</span></h2>
    </div>

    <div class="calibre3">
      <div class="calibre3 calibre3 calibre3">
        <h3 class="calibre16" id="heading_id_2"><a class="calibre7" shape="rect"/>subnetCalc.rb</h3>
      </div>

      <p class="calibre4">IP space is not infinite, so network administrators must be cognizant of how they allocate IP addresses. One way to segment a network is through the use of subnet masks, or <span><em class="italic">Classless Inter-Domain Routing</em></span>. In order to properly calculate <span><em class="italic">subnetworks</em></span>, or <span><em class="italic">subnets</em></span>, you need a few pieces of information. If you don't already know how to calculate subnets, then hopefully this script will enlighten you.<a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/></p>

      <p class="calibre4">You can calculate the subnets by hand, but that can be time consuming, and converting from decimal to binary and then back to decimal again gets old after many repetitions. This script solves the problems of having to memorize subnet calculations. As long as you have the information available to input into the script, sit back and relax … your day just became that much easier.</p>

      <div class="calibre3">
        <hr class="calibre21"/>
      </div>

      <div class="calibre3">
        <h3 class="calibre24" id="heading_id_3"><span class="calibre18"><a class="calibre7" shape="rect"/>Note</span></h3>

        <p class="calibre4"><span class="calibre18"><span><em class="italic">This example is based on IPv4 addressing</em></span>.<a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/></span></p>
      </div>

      <div class="calibre3">
        <hr class="calibre21"/>
      </div>
    </div>
  </div>


  <div class="calibre3">&#13;
    <div class="calibre3 calibre3 calibre3">&#13;
      <h2 class="calibre8" id="calibre_pb_142"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos266098"/>The Code</span></h2>&#13;
    </div><a class="calibre17" shape="rect"/>&#13;
&#13;
    <div class="calibre3">&#13;
      <span class="calibre18"><tt class="calibre19"><img alt="" class="calibre23" src="../Images/00002.jpg"/> require 'ipaddr'<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
       begin<br class="calibre20"/>&#13;
           print "Enter the IP address: "<br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00003.jpg"/>     ip = IPAddr.new gets.chomp<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
           print "Enter the <a class="calibre17" shape="rect"/>Subnet <a class="calibre17" shape="rect"/>mask: "<br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00004.jpg"/>     subnet_mask = IPAddr.new gets.chomp<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00005.jpg"/> rescue Exception =&gt; e<br class="calibre20"/>&#13;
           puts "An error occurred: #{e}\n\n"<br class="calibre20"/>&#13;
       end<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
      <img alt="" class="calibre23" src="../Images/00006.jpg"/> subnet = ip.mask(subnet_mask.to_s)<br class="calibre20"/>&#13;
      <br class="calibre20"/>&#13;
       puts "Subnet address is: #{subnet}\n\n"</tt></span>&#13;
    </div>&#13;
  </div>&#13;


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_143"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos267320"/>Running the Code</span></h2>
    </div>

    <p class="calibre4">The script is completely interactive and will guide you through the process of creating subnets. Just use the following command to run it:</p><a class="calibre17" shape="rect"/>

    <div class="calibre3">
      <span class="calibre18"><tt class="calibre19"><strong class="calibre22"><code class="calibre19">ruby subnetCalc.rb</code></strong></tt></span>
    </div>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_144"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos268024"/>The Results</span></h2>
    </div><a class="calibre17" shape="rect"/>

    <div class="calibre3">
      <span class="calibre18"><tt class="calibre19">Enter the IP address: 192.168.1.130<br class="calibre20"/>
      Enter the Subnet mask: 255.255.255.192<br class="calibre20"/>
      Subnet address is: 192.168.1.128</tt></span>
    </div>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_145"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos268545"/>How It Works</span></h2>
    </div>

    <p class="calibre4">To begin, the script requires the <a class="calibre17" shape="rect"/>ipaddr library <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00002.jpg"/></span>, which is useful when working with Internet Protocol addresses. Not only does it have a predefined IP address data structure, but the library also includes methods to manipulate IPv4 and IPv6 addresses. The first part of computing a subnet address is defining the IP address. The user is prompted for the address, which is saved into <code class="calibre19">ip</code> <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00003.jpg"/></span>.</p>

    <p class="calibre4">Relying on the <code class="calibre19">IPAddr</code> data structure, I initialized a <code class="calibre19">begin/rescue</code> block, in case there are any issues with the IP address, such as an address out of bounds. As a side note, I could have used a regular expression to check <a class="calibre17" shape="rect"/>for IP address integrity, but the regular expression is quite lengthy. If an error is detected, the <code class="calibre19">rescue</code> clause catches it and outputs the specific culprit <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00005.jpg"/></span>.</p>

    <p class="calibre4">The second piece needed to calculate a subnet address is the subnet mask <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00004.jpg"/></span>. Next, the IP address and subnet mask are converted into decimal numbers so the binary arithmetic operation <code class="calibre19">AND</code> can be performed on the two addresses. The resulting binary address is converted back into decimal and is the final subnet address. As you will see in a moment, the <code class="calibre19">mask</code> method of the ipaddr library abstracts all of the mathematical operations, making subnet address calculations simple.</p>

    <p class="calibre4">If both addresses pass inspection from the ipaddr library, the <code class="calibre19">mask</code> method is called <span><a class="calibre17" shape="rect"/><img alt="" class="calibre23" src="../Images/00006.jpg"/></span>. The <code class="calibre19">mask</code> method expects a string object passed as the subnet mask address, so the <code class="calibre19">to_s</code> method is used to convert the <code class="calibre19">IPAddr</code> object. Finally, <code class="calibre19">mask</code> returns the subnet address, which is then displayed to the user.</p>
  </div>


  <div class="calibre3">
    <div class="calibre3 calibre3 calibre3">
      <h2 class="calibre8" id="calibre_pb_146"><span class="calibre9"><a class="calibre7" shape="rect"/><a class="calibre7" id="filepos271702"/>Hacking the Script</span></h2>
    </div>

    <p class="calibre4">You could easily convert this script to handle IPv6 addresses as well as IPv4 addresses. I used the ipaddr library method <code class="calibre19">mask</code> to accomplish the binary <code class="calibre19">AND</code> function, but you could also perform the calculations explicitly.<a class="calibre17" shape="rect"/><a class="calibre17" shape="rect"/></p>
  </div>

  <div class="mbppagebreak" id="calibre_pb_147"/>
</body></html>