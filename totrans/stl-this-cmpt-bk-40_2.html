<html><head></head><body><div class="part" title="Part&#xA0;II.&#xA0;The Pc Pioneers"><div class="titlepage"><div><div><h1 class="title"><a id="the_pc_pioneers"/>Part II. The Pc Pioneers</h1></div></div></div><div class="partintro" title="The Pc Pioneers" id="id2562925"><div/><p/></div></div>
<div class="chapter" title="Chapter&#xA0;4.&#xA0;Ansi Bombs and Viruses"><div class="titlepage"><div><div><h1 class="title"><a id="ansi_bombs_and_viruses"/>Chapter 4. Ansi Bombs and Viruses</h1></div></div></div><div class="epigraph"><p>I think computer viruses should count as life. I think it says something about human nature that the only form of life we have created so far is purely destructive. We've created life in our own image.<a id="IDX-CHP-4-0001" class="indexterm"/><a id="IDX-CHP-4-0002" class="indexterm"/><a id="IDX-CHP-4-0003" class="indexterm"/></p><div class="attribution"><span>—<span class="attribution">
<span class="author"><span class="firstname">STEPHEN</span> <span class="surname">HAWKING</span></span>
</span></span></div></div><p>In the beginning, personal computers were physically isolated from one another. To share files, people had to copy data onto a floppy disk and then carry that floppy disk over to another computer. This method of sharing files, dubbed the <span class="emphasis"><em>sneakernet</em></span> (since the data travels via foot power), made sharing information slow and tedious, but it also reduced the threat that malicious software, known as <span class="emphasis"><em>malware</em></span>, could spread quickly, if at all.<a id="IDX-CHP-4-0004" class="indexterm"/><a id="IDX-CHP-4-0005" class="indexterm"/></p><p>Before the Internet, there were electronic bulletin board systems, also known as BBSs. A BBS consists of a single computer connected to one or more phone lines that allowed callers to connect, read and write messages, play games, or copy files. The number of users that could be on a BBS at any given time was limited by the number of phone lines physically connected to the BBS host computer. On some BBSs, only one user could be on at a time, while on others, dozens or even hundreds of users could be logged on simultaneously.</p><p>A BBS allowed people to share messages with each other, but the most popular BBS activity was sharing the latest freeware and shareware files. To encourage people to upload their own files, many BBSs enforced a strict upload-to-download ratio. For every two or three files you uploaded, you'd be entitled to download one in return. In this way, a BBS could constantly expand its file library.</p><p>Of course, with so many people sharing files, the inevitable happened: Malicious hackers abused the community honor system. Rather than uploading files that were exactly what they purported to be, they started planting malicious payloads that would catch other users unprepared and wipe out their data. Two of the earliest of these malware threats were ANSI bombs and computer viruses.<a id="IDX-CHP-4-0006" class="indexterm"/></p><div class="sect1" title="The Making of an ANSI Bomb"><div class="titlepage"><div><div><h1 class="title"><a id="the_making_of_an_ansi_bomb"/>The Making of an ANSI Bomb</h1></div></div></div><p>Back in the heyday of the now-outmoded MS-DOS operating system, computers often booted up by loading a program called ANSI.SYS. This ANSI.SYS program was a special program called a device driver, which allowed a computer to display colors and fancy (for its time) graphics.</p><p>One function provided by the ANSI.SYS driver, which had unintended consequences, was to remap the keys on the keyboard. In its intended practical use, this allowed you to create keyboard macros, or shortcuts, such as launching a specific program whenever you pressed a function key. However, this also allowed malicious hackers to reprogram your computer to erase a file every time you pressed the E key.<a id="IDX-CHP-4-0007" class="indexterm"/></p><div class="sect2" title="How an ANSI bomb works"><div class="titlepage"><div><div><h2 class="title"><a id="how_an_ansi_bomb_works"/>How an ANSI bomb works</h2></div></div></div><p>ANSI.SYS key-remapping commands consist of cryptic-looking text that specifies, using ANSI numeric codes, which keys to redefine. In the following two examples, the ANSI codes of 99 and 66 represent the letters <span class="emphasis"><em>C</em></span> and <span class="emphasis"><em>c</em></span> respectively:</p><a id="I_programlisting1_d1e2062"/><pre class="programlisting">ESC[99;"format c:";13p
ESC[66;"format c:";13p</pre><p>In the above two commands, the keys for letters <span class="emphasis"><em>C</em></span> and <span class="emphasis"><em>c</em></span> are redefined to run the "<code class="literal">format c:</code>" command followed by the <span class="keycap">enter</span> key (ANSI code number 13) when they are pressed. Naturally, the moment the computer tries to run the "<code class="literal">format c:</code>" command to reformat the hard disk, a message will appear and ask, "Do you really want to reformat drive C: (Y/N)?"</p><p>Most users would likely answer "No" by pressing either the n or N key. So the ANSI bomb also includes driver commands to redefine both the N (ANSI code 110) and the n keys (ANSI code 78) to represent the Y (ANSI code 121) and y keys (ANSI code 89):</p><a id="I_programlisting1_d1e2083"/><pre class="programlisting">ESC[110;121;13p
ESC[78;89;13p</pre><p>Now when the user presses either the n or N key, the ANSI bomb actually gives the computer the y or Y response instead, which tells it to go ahead and format the entire hard disk.</p></div><div class="sect2" title="Planting an ANSI bomb"><div class="titlepage"><div><div><h2 class="title"><a id="planting_an_ansi_bomb"/>Planting an ANSI bomb</h2></div></div></div><p>To trick people into running an ANSI bomb, malicious hackers would often disguise them in innocent-looking batch files. Batch files are nothing more than text files containing one or more MS-DOS commands to run. With a batch file, the user needs only to type the batch file name to run a group of commands, rather than entering them in one by one at the MS-DOS command line.</p><p>Malicious hackers on a BBS would create an ANSI bomb using either an ordinary text editor or a specialized ANSI bomb–making program, as shown in <a class="xref" href="ch04.html#an_ansi_bombnmaking_program_can_simplify" title="Figure 4-1. An ANSI bomb–making program can simplify the process of creating and planting an ANSI bomb.">Figure 4-1</a>. They would either save the malicious code in a text file with a generic name, such as install.bat (commonly used for the batch files that install freeware or shareware) or insert it into the batch file used by some other popular shareware program. Then they would upload the rigged file to the BBS and its unsuspecting users. Unfortunately for these good citizens, they would thus run the ANSI bomb, which would redefine the keyboard and cause havoc on their machines.</p><p>More insidious ANSI bombs would copy themselves into the autoexec.bat batch file, which is the first batch file the computer runs when it boots up. The ANSI bomb would then load every time the user turned on the computer, and so cause problems over and over again.</p><div class="figure"><a id="an_ansi_bombnmaking_program_can_simplify"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject1_d1e2101"/><img src="httpatomoreillycomsourcenostarchimages676481.png.jpg" alt="An ANSI bomb–making program can simplify the process of creating and planting an ANSI bomb."/></div></div><p class="title">Figure 4-1. An ANSI bomb–making program can simplify the process of creating and planting an ANSI bomb.</p></div><p>Since few BBS users knew what ANSI bomb commands looked like, they often had no idea how to identify rigged batch files. Although ANSI bombs themselves are now largely obsolete since the introduction of Microsoft Windows, they do demonstrate a timeless and universal strategy used by malicious people: exploiting a victim's trust (the user's willingness to run programs downloaded from the BBS) and ignorance (disguising the ANSI bomb as a legitimate program).</p></div></div></div>
<div class="sect1" title="The Spread of Computer Viruses"><div class="titlepage"><div><div><h1 class="title"><a id="the_spread_of_computer_viruses"/>The Spread of Computer Viruses</h1></div></div></div><p>The most common victims of ANSI bombs were the BBS operators themselves, who would eagerly run each new shareware program someone uploaded to their BBS just to test it out. However, after an ANSI bomb wiped out the files on the BBS host computer, it could at least be counted on not to spread to anyone else.</p><p>What malicious hackers needed was a program carrying a malicious payload that could hide within a trusted program and spread without relying on the victim running the rigged program. These hackers found their solution in <span class="emphasis"><em>computer viruses</em></span>.<a id="IDX-CHP-4-0008" class="indexterm"/></p><p>Like their biological counterparts, computer viruses survive by "infecting" a carrier, such as a file or a floppy disk. Once a virus infects a host, it relies on that host to spread it around. The three most common infection methods are:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Infecting program files</p></li><li class="listitem"><p>Infecting the boot sectors of floppy disks</p></li><li class="listitem"><p>Infecting documents using the macro capabilities of a word processor or spreadsheet (a method that's still practical today)</p></li></ul></div><div class="sect2" title="Spreading a file-infecting virus"><div class="titlepage"><div><div><h2 class="title"><a id="spreading_a_file-infecting_virus"/>Spreading a file-infecting virus</h2></div></div></div><p>In the old days, programs used to fit on a single floppy disk. If you wanted to play a video game or run an application like WordPerfect or Microsoft Excel, you could ask a friend to copy the program to a floppy disk and hand it to you. As a result, one of the earliest forms of virus infection involved programs shared via floppy disk.</p><p>File-infecting viruses still exist, but they can only spread if someone transfers an infected program file over the Internet or via an infected CD/DVD. However, most programs nowadays consist of several files, so rather than copy individual program files off a hard disk, most people just copy the program's original installation CD/DVD. Unless a virus can infect this original installation CD/DVD, it won't be able to spread this way, and as a result, this method of infection poses little threat in today's computing environment.<a id="IDX-CHP-4-0009" class="indexterm"/><a id="IDX-CHP-4-0010" class="indexterm"/></p><div class="sect3" title="Parasitic program infectors"><div class="titlepage"><div><div><h3 class="title"><a id="parasitic_program_infectors"/>Parasitic program infectors</h3></div></div></div><p>When a virus infects a file, it has three choices: It can insert itself at the front, the back, or in the middle of the file. A virus that plants itself in the middle of a file by deleting part of the file it's infecting is known as an <span class="emphasis"><em>overwriting virus</em></span>.</p><p>When a virus attaches itself to the front or back of a file, it changes the file's size and usually doesn't harm the infected file. Such parasitic viruses don't alter the infected program, so a user can run programs plagued with such viruses without even noticing the infection. The vulnerability of this mode of infection is that a parasitic virus can easily be spotted by the change it causes in the infected program's file size.</p></div><div class="sect3" title="Overwriting file infectors"><div class="titlepage"><div><div><h3 class="title"><a id="overwriting_file_infectors"/>Overwriting file infectors</h3></div></div></div><p>Overwriting viruses attempt to mask their presence by physically replacing some of the infected program file's code with the virus code. The infected program's file size won't change (which would be a dead giveaway that the file may be infected), but the host program won't work while the virus runs and tries to infect other program files. Since overwriting viruses destroy the host program, few victims are likely to share the infected host program with other users. So, while overwriting viruses harm the victim's computer more seriously than parasitic viruses do, they're also less likely to spread to other machines.</p></div></div><div class="sect2" title="Spreading a boot-sector virus"><div class="titlepage"><div><div><h2 class="title"><a id="spreading_a_boot-sector_virus"/>Spreading a boot-sector virus</h2></div></div></div><p><span class="emphasis"><em>Boot-sector viruses</em></span> infect the boot sector of a disk, which tells the computer how to use that particular disk. A boot-sector virus spreads whenever you boot from or access an infected hard drive or removable disk (such as a floppy or CD).<a id="IDX-CHP-4-0011" class="indexterm"/><a id="IDX-CHP-4-0012" class="indexterm"/></p><p>At one time, boot-sector viruses were the most common type of infection, but as fewer people share floppy disks nowadays, they have become much more rare. Back when people used floppy disks to transfer files from one computer to another, they would often leave the disk behind in the floppy drive. When someone turned on a computer with an inserted floppy disk, it would first try to boot up from the floppy disk. If the floppy disk was infected with a boot-sector virus, that virus would then infect the hard disk or lurk in memory so it could infect any other floppy disks inserted into the computer. Boot-sector viruses thus typically spread through the sharing of infected floppy disks, although it's still possible nowadays for a boot-sector virus to spread by infecting bootable CDs.<a id="IDX-CHP-4-0013" class="indexterm"/><a id="IDX-CHP-4-0014" class="indexterm"/><a id="IDX-CHP-4-0015" class="indexterm"/></p></div><div class="sect2" title="Spreading a multipartite virus"><div class="titlepage"><div><div><h2 class="title"><a id="spreading_a_multipartite_virus"/>Spreading a multipartite virus</h2></div></div></div><p>Both file infectors and boot-sector viruses have their strengths and weaknesses. File-infecting viruses can only spread if the user runs the infected program. If the virus happens to infect a seldom-used file, the virus may never spread and do its damage.</p><p>Similarly, boot sector viruses spread only when a computer boots up from an infected floppy or hard disk. To increase their chances of spreading, some viruses combine the features of both file infectors and boot-sector viruses. These are called <span class="emphasis"><em>multipartite viruses</em></span> and can infect either (or both) files and boot sectors. Although this increases their chances of spreading themselves, multipartite viruses are also more vulnerable to detection because of their increased size and susceptibility to antivirus programs. They're also more complicated to write, and with fewer people sharing (or even using) floppy disks anymore, file, boot-sector, and multipartite viruses are quickly fading into obscurity. Your computer can still get infected by these nasty viruses, but the odds are getting slimmer every day.<a id="IDX-CHP-4-0016" class="indexterm"/><a id="IDX-CHP-4-0017" class="indexterm"/></p></div><div class="sect2" title="Spreading a macro virus"><div class="titlepage"><div><div><h2 class="title"><a id="spreading_a_macro_virus"/>Spreading a macro virus</h2></div></div></div><p>Macro viruses only infect files created by a specific program, such as documents created in Microsoft Word or spreadsheets created in Microsoft Excel. When you load an infected document, the macro virus tries to spread to any similar documents stored on your computer. Since so many people use Microsoft Word, the most common macro viruses target Word documents, although a handful of macro viruses also target Excel and Microsoft PowerPoint files too.<a id="IDX-CHP-4-0018" class="indexterm"/><a id="IDX-CHP-4-0019" class="indexterm"/></p><p>Unlike other types of viruses that are written using programming languages such as assembly language, C/C++, BASIC, or Pascal, macro viruses are written using the macro programming language specific to its target application. Most macro viruses are written using Microsoft's macro language, called Visual Basic for Applications (VBA), although a few are written in WordBasic, an older macro programming language for Microsoft Word.<a id="IDX-CHP-4-0020" class="indexterm"/></p><p>Word-processing macro viruses infect the template files that define the margins, font, and general formatting for every document created by a particular word processor. Try to create a new document from a template infected by a macro virus, and the macro virus will then attempt to infect another template.</p><p>Because most people share documents rather than templates, macro viruses cleverly convert infected documents into template files, while maintaining the appearance of an ordinary document file. So, you might think you're opening an ordinary document for editing, when you're actually opening a template file instead.</p><p>Despite their prevalence in the wild, macro viruses tend to infect only documents created using Microsoft products such as Word, Excel, and PowerPoint. Some people have tried writing macro viruses to infect WordPro or WordPerfect documents, but those documents store their macros in a separate file and thus are less fertile ground for spreading viruses. (Not to mention, far fewer people use WordPro and WordPerfect compared to Microsoft Word.) In contrast, when you copy a Word or Excel document file onto a floppy disk, through a network, or over the Internet, you're automatically copying both your document and any macros it contains in a single file, which gives the macro virus a chance to spread.<a id="IDX-CHP-4-0021" class="indexterm"/></p><p>To minimize the threat of macro viruses, Microsoft Word 2003 offers a special macro security feature that you can access by choosing Tools ▸ Macro ▸ Security to display a Security dialog box as shown in <a class="xref" href="ch04s02.html#microsoft_word_2003_offers_some_protecti" title="Figure 4-2. Microsoft Word 2003 offers some protection from macro viruses.">Figure 4-2</a>. Then click the Very High or High radio buttons to limit the ability for macro viruses to run.</p><div class="figure"><a id="microsoft_word_2003_offers_some_protecti"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject1_d1e2245"/><img src="httpatomoreillycomsourcenostarchimages676483.png.jpg" alt="Microsoft Word 2003 offers some protection from macro viruses."/></div></div><p class="title">Figure 4-2. Microsoft Word 2003 offers some protection from macro viruses.</p></div><p>Microsoft Office 2007 goes even further in eliminating macro viruses by changing the file format of Office files themselves. While this won't stop someone from writing new macro viruses specifically for Microsoft Office 2007 files, it prevents the majority of existing macro viruses from infecting Office 2007 files.</p></div></div>
<div class="sect1" title="How Viruses Avoid Detection"><div class="titlepage"><div><div><h1 class="title"><a id="how_viruses_avoid_detection"/>How Viruses Avoid Detection</h1></div></div></div><p>Viruses can survive only if they remain undetected long enough to spread to other computers. Virus programmers have used a variety of tactics to increase a virus's longevity.</p><div class="sect2" title="Infection methods"><div class="titlepage"><div><div><h2 class="title"><a id="infection_methods"/>Infection methods</h2></div></div></div><p>Antivirus programs can spot a virus in one of two ways. First, an antivirus program may recognize a particular virus's signature, which is nothing more than the specific instructions embedded in the virus program that tell it how to behave and act. A virus's signature is like a criminal's fingerprint—each one is unique and distinct.</p><p>A second way an antivirus program can detect a virus is by its behavior. Antivirus programs can often detect the presence of a previously unknown virus by noticing when it tries to infect another file or disk, which is called heuristic analysis or detection.</p><p>To sneak past an antivirus program, viruses may employ a variety of proliferation methods:<a id="IDX-CHP-4-0022" class="indexterm"/><a id="IDX-CHP-4-0023" class="indexterm"/><a id="IDX-CHP-4-0024" class="indexterm"/><a id="IDX-CHP-4-0025" class="indexterm"/><a id="IDX-CHP-4-0026" class="indexterm"/></p><div class="variablelist"><dl><dt><span class="term"><span class="strong"><strong>Direct infection</strong></span></span></dt><dd><p>The virus infects a disk or additional files each time the user runs the infected program or opens the infected document. If the user doesn't do either of those things, the virus can't spread. This is the simplest but also the most noticeable way of infecting a computer and can be detected by antivirus programs fairly easily.</p></dd><dt><span class="term"><span class="strong"><strong>Fast infection</strong></span></span></dt><dd><p>The virus infects any file accessed by an infected program. For example, if a virus infects your antivirus program, watch out! Each time an infected antivirus program examines a file, it can actually infect that file immediately after certifying that it is virus-free.</p></dd><dt><span class="term"><span class="strong"><strong>Slow infection</strong></span></span></dt><dd><p>The virus only infects newly created files or files modified by a legitimate program. By doing this, viruses attempt to mask their presence more thoroughly from antivirus programs. For example, antivirus programs often watch for a program trying to modify a file it typically should not be accessing. If you run Windows Explorer and click a file to rename it, your antivirus program won't raise an alarm, since Windows Explorer is allowed to modify files. But if a virus infects Windows Explorer, renaming a file could cause it to become infected at the same time.</p></dd><dt><span class="term"><span class="strong"><strong>Sparse infection</strong></span></span></dt><dd><p>This type of virus takes its time infecting files and does so arbitrarily. By spreading slowly and unpredictably, these viruses reduce the odds that their activities (but not necessarily their existence) will be detected.</p></dd><dt><span class="term"><span class="strong"><strong>RAM-resident infection</strong></span></span></dt><dd><p>This type of virus buries itself in your computer's working memory (RAM), and each time you run a program or insert a floppy disk, the virus infects that program or disk. RAM-resident infection is the only way that boot-sector viruses can spread, since the victim must physically insert an infected floppy disk into his computer.<a id="IDX-CHP-4-0027" class="indexterm"/></p></dd></dl></div></div><div class="sect2" title="Stealth"><div class="titlepage"><div><div><h2 class="title"><a id="stealth"/>Stealth</h2></div></div></div><p>Viruses normally reveal their presence during infection by changing the size, time, and date stamps of the files that they infect. However, file-infecting viruses that use stealth techniques may accomplish their dirty work without causing any of those modifications, thus remaining hidden and undetected.<a id="IDX-CHP-4-0028" class="indexterm"/></p><p>Boot-sector viruses always use stealth techniques. When the computer reads a disk's boot sector, the virus quickly loads a copy of the real boot sector (which it has safely stashed away in another location on the disk). This is like using call forwarding to answer the phone from the neighborhood pool hall when your parents call you at home to make sure you're behaving yourself. As far as your parents are concerned, they called your home number and you answered. All's well at home, or so they think. Boot-sector viruses use similar stealth techniques to hide their presence from the computer. But that doesn't always fool good antivirus programs. To slip past them, viruses may use polymorphism.</p></div><div class="sect2" title="Polymorphism"><div class="titlepage"><div><div><h2 class="title"><a id="polymorphism"/>Polymorphism</h2></div></div></div><p>If criminals could modify their fingerprints each time they committed a crime, they would be harder to catch. That's the idea behind polymorphism. A <span class="emphasis"><em>polymorphic virus</em></span> changes its signature—the set of instructions that makes up that virus—each time it infects a file. Theoretically, this means that an antivirus program can never find it.<a id="IDX-CHP-4-0029" class="indexterm"/><a id="IDX-CHP-4-0030" class="indexterm"/></p><p>However, because viruses need to make sure they don't infect the same file over and over again, and thus reveal themselves by consuming disk space, a polymorphic virus must still leave a small, stable, and distinct signature that it (or an antivirus program) can find. Of course, once the virus has been caught and examined—by an antivirus software vendor, for example—antivirus programs can find these same signatures. That's why antivirus programs need constant and frequent updates to recognize the latest viruses.<a id="IDX-CHP-4-0031" class="indexterm"/><a id="IDX-CHP-4-0032" class="indexterm"/></p></div><div class="sect2" title="Retaliators"><div class="titlepage"><div><div><h2 class="title"><a id="retaliators"/>Retaliators</h2></div></div></div><p>The best defense is a good offense. Rather than passively hiding from antivirus programs, many viruses actively search them out and attack them. These retaliating viruses either modify the antivirus program so that it can't detect the virus, or they infect the antivirus program itself and make it complicit in spreading the virus. In both cases, the attacked antivirus program cheerfully displays a "Your computer is virus-free" message while the virus is happily spreading throughout your computer.<a id="IDX-CHP-4-0033" class="indexterm"/><a id="IDX-CHP-4-0034" class="indexterm"/></p></div></div>
<div class="sect1" title="How Antivirus Programs Work"><div class="titlepage"><div><div><h1 class="title"><a id="how_antivirus_programs_work"/>How Antivirus Programs Work</h1></div></div></div><p>An antivirus program serves two purposes: one, to detect and remove any viruses currently on your computer, and two, to prevent any viruses from infecting your computer in the first place. To detect and remove viruses, antivirus programs rely on a database of virus signatures. Your antivirus program scans every file on your hard disk, looking for instances of these virus signatures. For additional protection, many antivirus programs will also scan any email you send or receive.</p><p>You have to be diligent about keeping your antivirus program updated with the very latest library of known virus signatures, however, or newly discovered threats may not be detected during the scan. For this reason, antivirus programs can never be 100 percent effective against viruses. To scan for the signature of a virus, the vendor of the antivirus software must first get a copy of the virus and dissect it to figure out how it works. Then the vendor can update the signature database so that its antivirus program will recognize and remove that particular virus.</p><p>Since scanning for virus signatures can never protect against unknown viruses, antivirus programs also use something called heuristic analysis, which involves monitoring for suspicious behavior, such as a program suddenly trying to modify another file. The moment heuristic analysis detects suspicious activity, it can warn you to stop the suspicious program from running.</p><div class="sect2" title="Comparing antivirus programs"><div class="titlepage"><div><div><h2 class="title"><a id="comparing_antivirus_programs"/>Comparing antivirus programs</h2></div></div></div><p>Antivirus programs are only as effective as their virus signature databases. Since it's impossible for one company to find and dissect every new virus that appears, antivirus companies cooperate with one another. The moment one antivirus company makes a new discovery, it shares the information with its rivals (although not always as quickly as those rivals might like, thus giving its own product a chance to catch one more virus than a competing product). This arrangement helps all antivirus companies keep their programs up to date.<a id="IDX-CHP-4-0035" class="indexterm"/><a id="IDX-CHP-4-0036" class="indexterm"/><a id="IDX-CHP-4-0037" class="indexterm"/><a id="IDX-CHP-4-0038" class="indexterm"/><a id="IDX-CHP-4-0039" class="indexterm"/><a id="IDX-CHP-4-0040" class="indexterm"/><a id="IDX-CHP-4-0041" class="indexterm"/><a id="IDX-CHP-4-0042" class="indexterm"/><a id="IDX-CHP-4-0043" class="indexterm"/><a id="IDX-CHP-4-0044" class="indexterm"/><a id="IDX-CHP-4-0045" class="indexterm"/></p><p>Even though antivirus companies share information, each must still provide its own customers a way to update their antivirus programs to catch the latest threats. Because companies update their signature databases on differing schedules, even the most recent versions of different antivirus programs can vary in terms of detecting and eliminating viruses from their customers' computers. So, at any given time, one antivirus program will detect more viruses than another, although this usually changes within days. As a result, there isn't a "best" antivirus program that can claim to catch all viruses or that can consistently catch more viruses than any of its competitors. The best antivirus program is simply the one that you like and find most convenient to use. (To learn more about which antivirus programs are good at catching the latest batch of viruses, visit the Virus Bulletin site at <a class="ulink" href="http://www.virusbtn.com">www.virusbtn.com</a>.)</p></div><div class="sect2" title="Choosing an antivirus program"><div class="titlepage"><div><div><h2 class="title"><a id="choosing_an_antivirus_program"/>Choosing an antivirus program</h2></div></div></div><p>Since no antivirus program can catch 100 percent of all viruses all the time, it's best to run two at a time. But that can get expensive. Here's a cheaper option.</p><p>First, use a free online virus scanner, as shown in <a class="xref" href="ch04s04.html#online_scanners_can_detect_viruses_on_yo" title="Figure 4-3. Online scanners can detect viruses on your computer, but cannot stop them from infecting your computer.">Figure 4-3</a>, such as one of the following:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col/><col/></colgroup><tbody><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>Trend Micro's Housecall</strong></span><a id="IDX-CHP-4-0046" class="indexterm"/></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://housecall.trendmicro.com/housecall">http://housecall.trendmicro.com/housecall</a></p></td></tr><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>Panda's Active Scan</strong></span></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.pandasoftware.com/products/activescan.htm">www.pandasoftware.com/products/activescan.htm</a></p></td></tr><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>RAV AntiVirus Online Virus Scan</strong></span></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.ravantivirus.com/scan">www.ravantivirus.com/scan</a></p></td></tr><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>BitDefender Online Scanner</strong></span></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.bitdefender.com/scan8/ie.html">www.bitdefender.com/scan8/ie.html</a></p></td></tr></tbody></table></div><p>Second, get an antivirus program that can automatically scan your computer for viruses and block any suspicious behavior. While there are plenty of commercial antivirus programs, three free ones (for personal use only) include:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col/><col/></colgroup><tbody><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>AntiVir</strong></span></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.free-av.com">www.free-av.com</a></p></td></tr><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>AVG Anti-Virus</strong></span></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.grisoft.com">www.grisoft.com</a></p></td></tr><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>Avast Antivirus</strong></span></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.avast.com">www.avast.com</a></p></td></tr></tbody></table></div><p>For completely free, open-source antivirus programs, visit:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col/><col/></colgroup><tbody><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>Clam AntiVirus</strong></span></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.clamav.net">www.clamav.net</a></p></td></tr><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>Open AntiVirus Project</strong></span></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.openantivirus.org">www.openantivirus.org</a></p></td></tr></tbody></table></div><div class="figure"><a id="online_scanners_can_detect_viruses_on_yo"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject1_d1e2538"/><img src="httpatomoreillycomsourcenostarchimages676485.png.jpg" alt="Online scanners can detect viruses on your computer, but cannot stop them from infecting your computer."/></div></div><p class="title">Figure 4-3. Online scanners can detect viruses on your computer, but cannot stop them from infecting your computer.</p></div><p>Combining a free antivirus program with periodic checkups by a free online virus scanner can protect your computer at no extra cost to you. After all, it's not your fault that viruses attack Windows so often, so why should you spend additional money?<a id="IDX-CHP-4-0047" class="indexterm"/><a id="IDX-CHP-4-0048" class="indexterm"/><a id="IDX-CHP-4-0049" class="indexterm"/><a id="IDX-CHP-4-0050" class="indexterm"/></p><p>If you use a Macintosh or Linux computer, your threat of viruses is both much less and much greater. Currently, there are only a handful of viruses that infect Macintosh and Linux computers, so the number of existing viruses that could attack a Macintosh or Linux computer is relatively small. However, since so few Macintosh and Linux users worry about viruses, few people own, let alone use, Macintosh or Linux antivirus programs. The moment someone invents a new way to infect and spread a virus among Macintosh or Linux users, it will likely spread rapidly among many defenseless computers. The bottom line is that if you don't have an antivirus program, you will get infected eventually, no matter what type of computer and operating system you use.<a id="IDX-CHP-4-0051" class="indexterm"/></p><p>Technically speaking, the biggest threats no longer come from viruses but from <span class="emphasis"><em>worms</em></span> and <span class="emphasis"><em>spyware</em></span>. Worms are essentially viruses that can spread by themselves, and spyware programs track your Internet behavior or retrieve information from your computer and send it elsewhere without your knowledge. (You'll learn more about worms in <a class="xref" href="ch05.html" title="Chapter 5. Trojan Horses and Worms">Chapter 5</a> and spyware in <a class="xref" href="ch20.html" title="Chapter 20. Adware and Spyware">Chapter 20</a>.) Because of these new threats, most antivirus programs scan not only for viruses, but for worms and spyware as well.<a id="IDX-CHP-4-0052" class="indexterm"/><a id="IDX-CHP-4-0053" class="indexterm"/></p></div></div>
<div class="sect1" title="Why People Write Viruses"><div class="titlepage"><div><div><h1 class="title"><a id="why_people_write_viruses"/>Why People Write Viruses</h1></div></div></div><p>Viruses are just computer programs that someone has taken the time to write and test, so people might wonder—why would anyone do something destructive and harmful to someone they don't know and will likely never see? Basically, some people write viruses for the same reasons that other people spray graffiti on buildings, smash car windows, or throw rocks from overpasses. The reason why people do any of these things is because they can, and because they can often get away with doing it.</p><div class="sect2" title="For fun"><div class="titlepage"><div><div><h2 class="title"><a id="for_fun"/>For fun</h2></div></div></div><p>Many people write computer viruses just to see if they can do it.</p><p>Virus writing requires detailed knowledge of a specific operating system, so for many programmers, writing a virus was a way to test and prove their knowledge. Many of these early viruses were designed more as proof of concept than as deliberate attempts to sabotage other people's computers.</p><p>Reflecting their creators' spirit of curiosity and lack of malice, these early viruses often did nothing more than play a constant beep through the computer's speaker or reprogram the keyboard to generate a question mark or other symbol every time the E key was pressed. Annoying, to be sure, but ultimately harmless.</p><p>Some viruses even got playful and displayed a graphic image on the screen, such as an ambulance or a man strolling across the bottom of the screen. One playful virus would randomly display the message, "I want a cookie," on the screen. The only way to make the message go away was to type <span class="strong"><strong>cookie</strong></span>. Other viruses displayed political or humorous messages, as shown in <a class="xref" href="ch04s05.html#the_monopoly_virus_pokes_fun_at_bill_gat" title="Figure 4-4. The Monopoly virus pokes fun at Bill Gates and his monopoly on the operating system market.">Figure 4-4</a>.</p><div class="figure"><a id="the_monopoly_virus_pokes_fun_at_bill_gat"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject1_d1e2607"/><img src="httpatomoreillycomsourcenostarchimages676487.png.jpg" alt="The Monopoly virus pokes fun at Bill Gates and his monopoly on the operating system market."/></div></div><p class="title">Figure 4-4. The Monopoly virus pokes fun at Bill Gates and his monopoly on the operating system market.</p></div></div><div class="sect2" title="For notoriety"><div class="titlepage"><div><div><h2 class="title"><a id="for_notoriety"/>For notoriety</h2></div></div></div><p>Although people write and release viruses every day, the large majority of viruses fail to spread due to poor programming. Many virus writers want the notoriety of creating viruses that spread faster and cause the greatest amount of damage possible. If a virus writer could panic an entire nation and get his virus reported by name in <span class="emphasis"><em>USA Today</em></span> or on CNN, his reputation would soar in the underground virus community.</p><p>So malicious virus writers developed ever trickier tactics for slipping past antivirus programs and spreading as quickly as possible. Their ultimate goal is to create a virus that would become a household name, like the Michelangelo, Melissa, Chernobyl, and I Love You viruses. Although these virus writers could never publicly bask in the notoriety of their creations, they could still gain some measure of fame among their underground hacker friends.</p><p>Many virus writers even banded together and formed their own virus-writing groups with names like Amateur Virus Creation &amp; Research Group (AVCR), Corrupted Programming International (CPI), Phalcon/Skism, and Youngsters Against McAfee (YAM). These groups often published their own newsletters, with names like 40Hex, The Crypt Newsletter, and VLAD (Virus Labs and Distribution) Magazine, that explained how their latest virus creations worked. Virus-writing groups typically ran their own BBSs or websites, stocked with live viruses that others could download and run. The more newsletters they published and the more viruses they spread, the greater the notoriety the group could gain.<a id="IDX-CHP-4-0054" class="indexterm"/><a id="IDX-CHP-4-0055" class="indexterm"/><a id="IDX-CHP-4-0056" class="indexterm"/><a id="IDX-CHP-4-0057" class="indexterm"/><a id="IDX-CHP-4-0058" class="indexterm"/><a id="IDX-CHP-4-0059" class="indexterm"/><a id="IDX-CHP-4-0060" class="indexterm"/><a id="IDX-CHP-4-0061" class="indexterm"/><a id="IDX-CHP-4-0062" class="indexterm"/><a id="IDX-CHP-4-0063" class="indexterm"/><a id="IDX-CHP-4-0064" class="indexterm"/><a id="IDX-CHP-4-0065" class="indexterm"/><a id="IDX-CHP-4-0066" class="indexterm"/><a id="IDX-CHP-4-0067" class="indexterm"/><a id="IDX-CHP-4-0068" class="indexterm"/><a id="IDX-CHP-4-0069" class="indexterm"/></p><p>Fewer virus-writing groups exist today, partly because worms spread more quickly and easily, partly because virus writers never profit from their creations, and partly because government authorities are getting more adept at identifying and tracking down virus writers, such as the 1999 arrest of David L. Smith, accused of writing and spreading the Melissa virus. Instead, many virus programmers today find it's more profitable to work for companies that make spyware.<a id="IDX-CHP-4-0070" class="indexterm"/></p></div></div>
<div class="sect1" title="Finding virus-writing tutorials"><div class="titlepage"><div><div><h1 class="title"><a id="finding_virus-writing_tutorials"/>Finding virus-writing tutorials</h1></div></div></div><p>Although most virus-writing tutorials are now obsolete, they can still be fascinating to read to get a flavor of how members of the virus-writing underground used to brag and boast about their accomplishments and share new ideas with each other. To find a collection of these historical virus-writing tutorials and newsletters, visit TextFiles (<a class="ulink" href="http://www.textfiles.com">www.textfiles.com</a>) or Sirkus (<a class="ulink" href="http://www.sirkussystem.com">www.sirkussystem.com</a>).</p><p>American Eagle Publications (<a class="ulink" href="http://www.ameaglepubs.com">www.ameaglepubs.com</a>) even offers PDF versions of early virus-writing tutorials it once published, including <span class="emphasis"><em>The Little Black Book of Computer Viruses</em></span> (shown in <a class="xref" href="ch04s06.html#the_little_black_book_of_computer_viruse" title="Figure 4-5. The Little Black Book of Computer Viruses provides step-by-step instructions for creating different types of viruses in assembly language.">Figure 4-5</a>), <span class="emphasis"><em>The Giant Black Book of Computer Viruses</em></span>, and <span class="emphasis"><em>Computer Viruses, Artificial Life and Evolution</em></span>. By reading these tutorials, you'll see how virus writers carefully crafted viruses from scratch using assembly language.<a id="IDX-CHP-4-0071" class="indexterm"/><a id="IDX-CHP-4-0072" class="indexterm"/><a id="IDX-CHP-4-0073" class="indexterm"/></p><div class="figure"><a id="the_little_black_book_of_computer_viruse"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject1_d1e2723"/><img src="httpatomoreillycomsourcenostarchimages676489.png" alt="The Little Black Book of Computer Viruses provides step-by-step instructions for creating different types of viruses in assembly language."/></div></div><p class="title">Figure 4-5. <span class="emphasis"><em>The Little Black Book of Computer Viruses</em></span> provides step-by-step instructions for creating different types of viruses in assembly language.</p></div></div>
<div class="sect1" title="Virus-writing toolkits"><div class="titlepage"><div><div><h1 class="title"><a id="virus-writing_toolkits"/>Virus-writing toolkits</h1></div></div></div><p>In addition to spreading their notoriety through newsletters and new viruses, a handful of virus groups also created virus-writing toolkits. These toolkits often sported fancy pull-down menus and modern graphical user interfaces to make virus writing as simple as clicking the features you wanted from a menu and then waiting for the toolkit to create your custom virus for you.<a id="IDX-CHP-4-0074" class="indexterm"/></p><p>One of the earliest virus-writing toolkits was called the Dark Avenger Mutation Engine (MtE). Virus writers could link their creations to MtE, which would mutate the virus's signature, turning an ordinary virus into a polymorphic one. Theoretically, MtE would make functionally identical copies of the same virus appear different from one another, making it impossible for antivirus scanners to detect the virus based on its signature. In practice, however, MtE proved difficult to use and couldn't completely mask a virus's signature, so few virus writers actually created viruses using MtE.<a id="IDX-CHP-4-0075" class="indexterm"/><a id="IDX-CHP-4-0076" class="indexterm"/></p><p>As the first mutation engine, MtE achieved notoriety solely for originating the idea of polymorphic viruses. While MtE never unleashed the flood of undetectable viruses that people originally feared, it did inspire other virus programmers to create toolkits of their own that could be, and were, used to generate viruses easily.<a id="IDX-CHP-4-0077" class="indexterm"/></p><p>Following the introduction of MtE, other virus writers created similar mutation engines with names like TridenT Polymorphic Engine (TPE) and Dark Angel's Multiple Encryptor (DAME). Like MtE, these other mutation engines had various degrees of success in creating viruses, although none lived up to its original promise of altering a virus completely to avoid detection. Viruses were hard enough to create in the first place, and few virus writers bothered taking the additional time to link their viruses to a buggy, hard-to-use mutation engine.<a id="IDX-CHP-4-0078" class="indexterm"/><a id="IDX-CHP-4-0079" class="indexterm"/><a id="IDX-CHP-4-0080" class="indexterm"/></p><p>However, as virus writers studied these later mutation engines, they adopted the ideas and programming techniques for use in their own viruses. So while mutation engines never succeeded in their original goal, they indirectly inspired virus writers to create viruses that were harder for antivirus programs to detect.</p><p>The next step in the evolution was the full-fledged virus-creation program. With user-friendly pull-down menus and interfaces, these programs let wannabe virus writers pick and choose the features they wanted, and the virus creation program would create it for them automatically. One of the first virus-creation programs was the Virus Creation Laboratory, shown in <a class="xref" href="ch04s07.html#the_virus_creation_laboratory_offered_pu" title="Figure 4-6. The Virus Creation Laboratory offered pull-down menus to make custom viruses quickly.">Figure 4-6</a>.<a id="IDX-CHP-4-0081" class="indexterm"/></p><p>Around this time, virus writers focused less attention on devising more dangerous viruses and concentrated more on developing their own virus-writing toolkits, which they eagerly shared with others. <a class="xref" href="ch04s08.html#virus_writers_soon_flooded_the_hacker_un" title="Figure 4-7. Virus writers soon flooded the hacker underground with virus-writing toolkits with different names and capabilities.">Figure 4-7</a> shows a list of typical virus-writing toolkits that you can still find today being traded on various hacker websites.</p><p>Theoretically, virus-creation toolkits would allow anyone to make their own viruses. In reality, they created viruses that either didn't work or were easily detected, so they could not cause much damage. Despite the attempts to automate production, virus-writing toolkits didn't made virus writing easier, nor did they flood the world with undetectable viruses as originally feared. If you want to write a virus, you still have to learn a programming language and understand the weaknesses of a particular operating system, and this effectively limits the art of virus writing to a handful of skilled souls interested in developing something destructive for no other reward than anonymous fame.</p><div class="figure"><a id="the_virus_creation_laboratory_offered_pu"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject1_d1e2780"/><img src="httpatomoreillycomsourcenostarchimages676491.png.jpg" alt="The Virus Creation Laboratory offered pull-down menus to make custom viruses quickly."/></div></div><p class="title">Figure 4-6. The Virus Creation Laboratory offered pull-down menus to make custom viruses quickly.</p></div></div>
<div class="sect1" title="Virus Myths and Hoaxes"><div class="titlepage"><div><div><h1 class="title"><a id="virus_myths_and_hoaxes"/>Virus Myths and Hoaxes</h1></div></div></div><p>Since each new outbreak of a virus causes hysteria and panic among computer users, you can cause nearly as much trouble by inventing a fictional virus as you can by creating a real one. You can learn about the latest virus hoaxes on the <a class="ulink" href="http://vmyths.com">Vmyths.com</a> website (<a class="ulink" href="http://www.vmyths.com">www.vmyths.com</a>). The following are examples of typical virus hoaxes. Notice that in each case, the trickster uses potentially confusing technical language and establishes his credibility by associating himself with a trusted and well-known organization.<a id="IDX-CHP-4-0082" class="indexterm"/><a id="IDX-CHP-4-0083" class="indexterm"/><a id="IDX-CHP-4-0084" class="indexterm"/><a id="IDX-CHP-4-0085" class="indexterm"/><a id="IDX-CHP-4-0086" class="indexterm"/><a id="IDX-CHP-4-0087" class="indexterm"/></p><div class="sect2" title="The mobile phone virus hoax"><div class="titlepage"><div><div><h2 class="title"><a id="the_mobile_phone_virus_hoax"/>The mobile phone virus hoax</h2></div></div></div><p>Among the more disruptive virus hoaxes are those that encourage you to email copies of warnings to your friends. To convince people of their legitimacy, these virus hoaxes often present information that sounds valid and threatening, but is actually useless and completely wrong. Often the hoax is based on a real event, which is a reliable way of inciting panic in an unsuspecting email recipient.</p><p>One example is the ICE phone virus hoax, which occurred after a legitimate organization dubbed In Case of Emergency (ICE)—<a class="ulink" href="http://www.icecontact.com">www.icecontact.com</a>—suggested that people make an entry in the directory of their mobile phones containing the name and phone number of someone to be contacted in an emergency, accessed by the letters <span class="emphasis"><em>ICE</em></span>.</p><p>Pranksters seized the opportunity. They created and spread the ICE hoax by circulating the following text:</p><div class="blockquote"><blockquote class="blockquote"><p>WARNING - ICE IS PHONE BASED VIRUS, SEE BELOW!! Be very careful with this one - although the intention is great it is unfortunately phase one of a phone based virus that is laying a path for propagating very quickly. Passing it on is part of the virus interestingly, such is the deviousness of the people who write these things. We have already seen the "second phase" where a program is sent as part of a ring-tone download that goes into your address book and looks for something it recognises - you've guessed it, an address book entry marked "ICE or I.C.E." or whatever. It then sends itself to the ICE list, charging you for the privilege.</p></blockquote></div><p>This hoax takes advantage of the fear of viruses and the introduction of viruses and Trojan horses specifically designed to infect mobile phones, such as RedBrowser, a Trojan horse that sneaks on to mobile phones and then makes calls to Russia, charging the user $5 a call. However, remember that real virus and Trojan horse news appear on legitimate security websites like Symantec or Trend Micro and not through unsolicited email messages. After all, do you rely on email messages from a total stranger for the latest sports scores—let alone for true news?</p><div class="figure"><a id="virus_writers_soon_flooded_the_hacker_un"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject1_d1e2841"/><img src="httpatomoreillycomsourcenostarchimages676493.png" alt="Virus writers soon flooded the hacker underground with virus-writing toolkits with different names and capabilities."/></div></div><p class="title">Figure 4-7. Virus writers soon flooded the hacker underground with virus-writing toolkits with different names and capabilities.</p></div></div><div class="sect2" title="The nuclear war hoax"><div class="titlepage"><div><div><h2 class="title"><a id="the_nuclear_war_hoax"/>The nuclear war hoax</h2></div></div></div><p>To give credibility to their hoax, many pranksters often quote trusted authorities, as in the following example, which claims that you can accidentally launch nuclear missiles through an errant email message:</p><div class="blockquote"><blockquote class="blockquote"><p>Hey. I just got this in the mail, from Symantec, so I thought I'd forward it along. It's a new virus that we should watch out for. PLEASE FORWARD THIS TO EVERYONE YOU KNOW. THIS IS VERY IMPORTANT.</p><p>Virus Update, 1/07/02</p><p>Symantec Virus Alert Center</p><p>Hello Subscriber, As part of our ongoing effort to keep Symantec clients up to date on virus alerts, this e-mail is being sent to all Symantec subscribers. A new, deadly type of virus has been detected in the wild. You should not open any message entitled "LAUNCH NUCLEAR STRIKE NOW," as this message has been programmed to access NORAD computers in Colorado and launch a full-scale nuclear strike on Russia and the former Soviet states. Apparently, a disgruntled ex-Communist hacker has designed a pernicious vb-script that actually bypasses the U.S. arsenal's significant security system and takes command of missiles and bombers directly. By opening the e-mail, you may be causing Armageddon. Needless to say, Armageddon will wipe out your hard drive and damage your computer. Again, we warn you, PLEASE, DO NOT OPEN ANY E-MAIL ENTITLED "LAUNCH NUCLEAR STRIKE NOW." YOU MAY CAUSE A FULL-SCALE NUCLEAR HOLOCAUST. As a precaution, all U.S. nuclear missiles have been set to "Do Not Authorize Launch Via E-mail" to prevent an accidental Armageddon. However, due to a Y2K bug, the possibility still exists that you may end life as we know it on this planet by opening the aforementioned e-mail.</p><p>VIRUS NAME: ArmaGeddyLee, HappyOrMaybeNot00, OopsWrongButton00</p><p>TRANSMITTAL METHOD: vb-script attached to e-mail</p><p>HAZARD: Extremely Super High</p><p>AREA OF INFECTION: Detected in wild</p><p>CHARACTERISTICS: Destroys life on earth via nuclear Armageddon</p><p>Please forward this warning to everyone you can. Thank you for your attention to this matter,</p><p>Sincerely,</p><p>The Symantec Anti-Virus Team</p></blockquote></div><p>As ridiculous as this hoax sounds (would <span class="emphasis"><em>any</em></span> country want to launch nuclear missiles via email?), the use of Symantec's name as a trustworthy source of virus information gives this hoax apparent credibility to the unquestioning. Such hoaxes could be stopped in their tracks if people would only verify the information before forwarding it. All it takes is a quick visit to Symantec's website to determine whether this warning is actually true.</p></div><div class="sect2" title="The bait-and-switch virus hoax"><div class="titlepage"><div><div><h2 class="title"><a id="the_bait-and-switch_virus_hoax"/>The bait-and-switch virus hoax</h2></div></div></div><p>Since most people don't understand how viruses work, any seemingly credible virus report will likely grab a lot of attention. To take advantage of this, a porn website once sent out email supposedly coming from "Dave Norton, <span class="email"><a class="email" href="mailto:VirusCenter@CNN.com">VirusCenter@CNN.com</a></span>" that contained the following text:<a id="IDX-CHP-4-0088" class="indexterm"/><a id="IDX-CHP-4-0089" class="indexterm"/><a id="IDX-CHP-4-0090" class="indexterm"/></p><div class="blockquote"><blockquote class="blockquote"><p>CNN Brings you information on the new devistating computer virus known as the 'Lions Den' virus. This virus is reported to be costing internet providers such as AOL, MSN, Yahoo, and Earthlink millions of dollars due to loss of members.</p></blockquote></div><p>The message then displayed a link that readers could follow to get details about the Lions Den virus and information on protecting their computer from it. Instead of going to the CNN site, however, the link would direct readers directly to the porn site. Once again, this type of hoax could be stopped if people would just verify the information before forwarding it to others.</p></div><div class="sect2" title="The publicity-seeking virus hoax"><div class="titlepage"><div><div><h2 class="title"><a id="the_publicity-seeking_virus_hoax"/>The publicity-seeking virus hoax</h2></div></div></div><p>In 2003, a computer security/hacking group named Gobbles Security released a statement claiming that the Recording Industry Association of America (RIAA) had contacted them to develop a computer worm that could spread through security vulnerabilities in several popular filesharing programs. The purported purpose of this worm was to disable the filesharing networks that are typically used to spread illegally copied MP3 music files.</p><p>Lending credibility to this hoax was the fact that many people believed that the RIAA actually would stoop to such illegal tactics in order to shut down the filesharing networks. Plus, Gobbles Security had been known to post legitimate security advisories in the past, and had even provided a sample program with their statement that showed how a computer worm could exploit such flaws in filesharing programs.</p><p>Ultimately, Gobbles Security admitted that their statement was a fake and that they only did it to generate publicity. This taught everyone that a hoax could catch even seasoned computer professionals unaware. Remember that no matter how trustworthy someone or something may have been in the past, they're always capable of lying to you now in their own interest. Treat all claims with skepticism, including everything you read in this book, and you should be all right.</p></div></div>
<div class="sect1" title="Learning More About Viruses"><div class="titlepage"><div><div><h1 class="title"><a id="learning_more_about_viruses"/>Learning More About Viruses</h1></div></div></div><p>To learn more about viruses (both real ones and hoaxes), visit one of the following websites:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col/><col/></colgroup><tbody><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>AVP Virus Encyclopedia</strong></span></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.avp.ch/avpve">www.avp.ch/avpve</a></p></td></tr><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>F-Secure Security Information Center</strong></span></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.f-secure.com/virus-info">www.f-secure.com/virus-info</a></p></td></tr><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>Sophos</strong></span></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.sophos.com/virusinfo">www.sophos.com/virusinfo</a></p></td></tr><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>Symantec</strong></span><a id="IDX-CHP-4-0091" class="indexterm"/><a id="IDX-CHP-4-0092" class="indexterm"/><a id="IDX-CHP-4-0093" class="indexterm"/></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.symantec.com/avcenter">www.symantec.com/avcenter</a></p></td></tr><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>McAfee Security</strong></span></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://us.mcafee.com/virusInfo">http://us.mcafee.com/virusInfo</a></p></td></tr><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>Trend Micro</strong></span></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.trendmicro.com/vinfo">www.trendmicro.com/vinfo</a></p></td></tr></tbody></table></div><p>These websites list all known viruses (and virus hoaxes), their characteristics, what damage (if any) they cause, and how to detect them. To exchange messages about computer viruses, visit the comp.virus or alt.comp.virus Usenet newsgroups.</p></div>
<div class="sect1" title="The Future Virus Threat"><div class="titlepage"><div><div><h1 class="title"><a id="the_future_virus_threat"/>The Future Virus Threat</h1></div></div></div><p>As the computing environment changes, today's virus threats die off, only to be replaced by newer types of malware. With few people still using floppy disks, file-infecting and boot-sector viruses can no longer spread as easily. Similarly, as Microsoft changes the file format of its Office suite of products (Word, Excel, PowerPoint, and Access), macro viruses relying on the earlier versions will gradually lose their effectiveness too.</p><p>However, despite the decreasing threat from pure viruses, antivirus programs are still important to protect your computer against all types of malware, not just viruses. And to really be safe, you ultimately need to supply your own healthy dose of common sense and practice safe computing habits (such as not indiscriminately copying and running programs from untrusted sources).</p></div>
<div class="chapter" title="Chapter&#xA0;5.&#xA0;Trojan Horses and Worms"><div class="titlepage"><div><div><h1 class="title"><a id="trojan_horses_and_worms"/>Chapter 5. Trojan Horses and Worms</h1></div></div></div><div class="epigraph"><p>member of the Ready Rangers Liberation Front<a id="IDX-CHP-5-0001" class="indexterm"/><a id="IDX-CHP-5-0002" class="indexterm"/><a id="IDX-CHP-5-0003" class="indexterm"/><a id="IDX-CHP-5-0004" class="indexterm"/></p><p>I do it for the pleasure of creating something, seeing that it works, and making something that could really survive, spread, and hold its own in the wild. A virus is something that lives. In real life you can't make a kind of animal. You can in the computer. It's like playing God.</p><div class="attribution"><span>—<span class="attribution">
<span class="author"><span class="firstname">BLUE</span> <span class="surname">OWL</span></span>
</span></span></div></div><p>Back in the '80s, a programmer named Bob Wallace started a software company based on a unique marketing scheme. Rather than force people to pay for software before using it and risk finding out later that it doesn't quite do what they expected, Wallace gave away his software for free. Under his rules, later dubbed <span class="emphasis"><em>shareware</em></span>, anyone could freely and legally copy and share his program, a word processor called PC-Write. Users who went the extra step and registered the program for $75 not only got a printed manual and technical support, but they also got a $25 commission every time someone else also registered their copy of PC-Write. Naturally, users spread copies of their registered PC-Write program wherever they could, most commonly through BBS systems around the world.<a id="IDX-CHP-5-0005" class="indexterm"/></p><p>With so many people sharing copies of PC-Write, the inevitable happened. In 1986, a malicious hacker wrote a Trojan horse and disguised it as a legitimate copy of PC-Write. When unsuspecting users tried to run the bogus copy of PC-Write, the Trojan horse would format their hard disk and erase all their files.</p><div class="sect1" title="The World of Trojan Horses"><div class="titlepage"><div><div><h1 class="title"><a id="the_world_of_trojan_horses"/>The World of Trojan Horses</h1></div></div></div><p>Although this doctored-up version of PC-Write was one of the most prominent of the early IBM-PC Trojan horses, Trojan horses have been around since the first computers. One of the simplest and oldest types of Trojan horses is a password-stealing program. These are especially common on shared computers used by many different people, such as those in a school computer laboratory. Such computers typically require a user to type in a user name and password, so all a hacker had to do to steal someone's password was create a fake program that looked like the usual login screen. The fake login screen would store the information, return an error message, and then display the real login screen. The unsuspecting user would then retype his user name and password and gain access to the computer, never realizing that he'd actually fed his personal information to a password-stealing Trojan horse during that first login attempt.</p><p>Just like the ancient Greek ruse from which it derives its name, Trojan horse programs rely on trickery. Trojan horses usually run only once, but that is enough to wipe out files, steal passwords, or cause other types of damage. After the introduction of the PC-Write Trojan horse, malicious hackers started creating similar Trojan horses masquerading as games or utility programs like those commonly found on BBSs. Most would run once and wipe out all the files stored on a hard disk, thereby removing the Trojan horse itself as well and preventing it from spreading. So while Trojan horses are dangerous, they rely on the gullibility of users in order to propagate themselves.<a id="IDX-CHP-5-0006" class="indexterm"/></p><p>Because Trojan horses can only work by tricking people into running them, many disguise themselves as enticements, such as naked pictures of the latest celebrities or security updates from trusted companies such as Symantec or Trend Micro. Trojan horse writers are also quick to exploit the latest current events. When someone started spreading the following hoax about a virus named AOL4Free, another individual created a Trojan horse to exploit the rumor:</p><div class="blockquote"><blockquote class="blockquote"><p>Subject: E-MAIL VIRUS!!!!! -- THIS IS NOT A JOKE!!!!!!</p><p>Anyone who receives this must send it to as many people as you can. It is essential that this problem be reconciled as soon as possible.</p><p>A few hours ago, someone opened an E-mail that had the subject heading of "AOL4FREE.COM".</p><p>Within seconds of opening it, a window appeared and began to display all his files that were being deleted. He immediately shut down his computer, but it was too late. This virus wiped him out. It ate the Anti-Virus Software that comes with the Windows '95 Program along with F-Prot AVS. Neither was able to detect it.</p><p>Please be careful and send this to as many people as possible, so maybe this new virus can be eliminated.</p><p>DON'T OPEN E-MAIL NOTING "AOL4FREE"</p><p>VIRUS ALERT!!!</p><p>Be aware that there are letters going around that you have won free Aol until 1998....or AOL 4 free...... PLEASE DELETE...... contains a virus that will wipe out your harddrive...... after you download and it executes.....</p><p>SUBJECT AREA OF EMAIL....... CONGRATULATIONS! You are a WINNER!</p><p>SUBJECT AREA OF EMAIL.......AOL 4 Free - Get AOL For Free</p><p>SENDERS................................Matthews27 or VPVVPPVVP</p><p>WARN YOUR FRIENDS!!!!!!!!!!!!!!!!!!!!!!</p></blockquote></div><p>The AOL4Free virus didn't actually exist, but soon after this hoax email got into circulation, a malicious hacker went ahead and created one. This Trojan horse claimed it would give users free access to America Online. Since people had already been told that the AOL4Free virus didn't exist, they felt safe running the "new" AOL4Free Trojan horse. This one actually would wipe out all the files on their hard disk.</p><div class="sect2" title="Taunting the victim"><div class="titlepage"><div><div><h2 class="title"><a id="taunting_the_victim"/>Taunting the victim</h2></div></div></div><p>Instead of destroying files, some Trojan horses simply annoy or taunt the user with pranks, such as displaying a fake dialog box that says "Now formatting hard disk" when nothing is actually happening, or playing beeping sounds through the computer's speaker randomly.<a id="IDX-CHP-5-0007" class="indexterm"/><a id="IDX-CHP-5-0008" class="indexterm"/><a id="IDX-CHP-5-0009" class="indexterm"/><a id="IDX-CHP-5-0010" class="indexterm"/></p><p>An Arabic Trojan horse named Yusufali sneaks into a computer and monitors the title bar of the currently active window, such as a web browser. If it finds words such as <span class="emphasis"><em>XXX</em></span>, <span class="emphasis"><em>sex</em></span>, or <span class="emphasis"><em>teen</em></span>, indicating that the user may be visiting a pornographic website, the Trojan horse displays passages from the Koran, as shown in <a class="xref" href="ch05.html#the_yusufali_trojan_horse_prevents_users" title="Figure 5-1. The Yusufali Trojan horse prevents users from looking at pornographic websites.">Figure 5-1</a>.</p><div class="figure"><a id="the_yusufali_trojan_horse_prevents_users"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject2_d1e3111"/><img src="httpatomoreillycomsourcenostarchimages676495.png.jpg" alt="The Yusufali Trojan horse prevents users from looking at pornographic websites."/></div></div><p class="title">Figure 5-1. The Yusufali Trojan horse prevents users from looking at pornographic websites.</p></div><p>While Trojan horses like Yusufali don't harm any files, they can prevent you from using your computer, to the point where you may need to reboot to get rid of their annoying distractions.</p></div><div class="sect2" title="Attacking the victim's pocketbook"><div class="titlepage"><div><div><h2 class="title"><a id="attacking_the_victim_apostrophy_s_pocket"/>Attacking the victim's pocketbook</h2></div></div></div><p>In addition to destroying files, Trojan horses can also cost you money.</p><p>In 1989, someone wrote the AIDS Trojan horse, which claimed to offer information about AIDS and HIV. When users ran the program, the Trojan horse would encrypt their hard disk and display a message demanding money in exchange for a password that could be used to decrypt the hard disk and recover their files. If users didn't send any money, the Trojan horse's author asserted, their hard disk would remain encrypted, their data essentially held hostage until the ransom was paid.<a id="IDX-CHP-5-0011" class="indexterm"/></p><p>In 2005, this type of Trojan horse reappeared when someone spread the PGPcoder Trojan, which would also encrypt files and attempt to extort users for cash in return for a password to unscramble their files. The following year in 2006, another extortion Trojan appeared called Cryzip, starting what security experts say could be the start of a new category of malware tentatively dubbed <span class="emphasis"><em>ransomware</em></span>.<a id="IDX-CHP-5-0012" class="indexterm"/></p><p>As more people became aware of the dangers of viruses, more computer users started using antivirus programs that could detect both viruses and Trojan horses, so malicious hackers began to search for easier targets. They found their opportunity in the vulnerable world of smart phones, which allow people to play games, retrieve email, and play music. For example, one malicious hacker started circulating a Trojan horse called Mosquito, which posed as a game that would work on any smart phone running the Symbian operating system. Once someone copied the Mosquito Trojan horse onto his or her smart phone and ran it, the Trojan horse would start sending text messages to phone numbers in the United Kingdom, Germany, the Netherlands, and Switzerland, saddling the victim with huge phone bills.<a id="IDX-CHP-5-0013" class="indexterm"/><a id="IDX-CHP-5-0014" class="indexterm"/><a id="IDX-CHP-5-0015" class="indexterm"/></p><p>Besides messing with personal computers and smart phones, malicious hackers have also gone after Sony PlayStation Portable users. Many PlayStation users like to modify their PlayStation units so that they can run other types of programs in addition to official Sony game cartridges, a hobby known as <span class="emphasis"><em>modding</em></span>. Targeting these modders, a malicious hacker wrote the first Trojan horse for Sony PlayStations in 2005, dubbed Trojan.PSPBrick. It would supposedly remove a Sony upgrade that made the device more resistant to modding. When people installed this Trojan horse, however, it would delete key files and turn the PlayStation Portable unit into an unusable piece of hardware.</p></div><div class="sect2" title="The coming of the RATs (remote-access Trojans)"><div class="titlepage"><div><div><h2 class="title"><a id="the_coming_of_the_rats_open_parenthesis"/>The coming of the RATs (remote-access Trojans)</h2></div></div></div><p>Up until the late '90s, hackers wrote more viruses than Trojan horses because viruses could spread more widely and cause greater damage than a Trojan horse ever could. All that changed in 1998 when a hacker group called The Cult of the Dead Cow released Back Orifice, a new type of Trojan horse called a <span class="emphasis"><em>remote-access Trojan (RAT)</em></span>, that took advantage of the Internet. Like other Trojan horses, RATs could only run by tricking users, but once they were launched they could also connect to the Internet and communicate directly with the hacker who created them.</p><div class="sect3" title="Sneaking a RAT onto a computer"><div class="titlepage"><div><div><h3 class="title"><a id="sneaking_a_rat_onto_a_computer"/>Sneaking a RAT onto a computer</h3></div></div></div><p>RATs consist of two separate programs: a client file and a server file. The server file infects a computer by deceiving the user into running it. The client file runs on the hacker's computer and controls any computer infected by the RAT's server file.</p><p>To trick victims into running the server file, RATs might masquerade as an attached news story (such as a hoax about Osama bin Laden's capture by US military forces), as a file claiming to contain graphic images of celebrities having sex, or as just a simple game, as shown in <a class="xref" href="ch05.html#rats_often_disguise_the_true_identity_of" title="Figure 5-2. RATs often disguise the true identity of a server file by pretending to be a game.">Figure 5-2</a>.</p><p>One problem with RAT server files is that they tend to be fairly large, as big as 1MB. An astute user might wonder why a file containing a purported news story would be so large. To avoid tipping off a potential victim due to the bulky size of a RAT's server file, RAT hackers use two deception strategies: backdoor Trojan horses and binder programs.</p><p>Unlike a full-size RAT, a backdoor Trojan horse is usually a small file whose size allows it to masquerade as something else, such as a simple game or a news story. When the victim runs the backdoor Trojan horse, the program does nothing more than open a network port—a "backdoor"—into the infected computer. Now the hacker can send a much larger file, such as a full-featured RAT, through this open port. Once this is installed on the computer, the backdoor Trojan horse has no further use and can be ignored or deleted.</p><p>An alternative way to sneak a full-featured RAT onto a computer is to use a binder program, which combines two programs in a single file. When someone runs a "bound" file, both programs run at the same time. Hackers use binder programs to bind RATs to a legitimate program, which can turn any file into a vehicle for installing a Trojan horse. Since most programs, such as game demos or trial versions of utility programs, are already hefty in size, the added bulk of a bound RAT isn't likely to be noticed. When a victim runs a bound file, the RAT secretly installs itself along with the legitimate program.</p><div class="figure"><a id="rats_often_disguise_the_true_identity_of"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject2_d1e3180"/><img src="httpatomoreillycomsourcenostarchimages676497.png.jpg" alt="RATs often disguise the true identity of a server file by pretending to be a game."/></div></div><p class="title">Figure 5-2. RATs often disguise the true identity of a server file by pretending to be a game.</p></div></div><div class="sect3" title="How RATs work"><div class="titlepage"><div><div><h3 class="title"><a id="how_rats_work"/>How RATs work</h3></div></div></div><p>RATs work by sending information through Internet ports. When computers exchange information over the Internet, they divide their physical Internet connection into virtual ports, with each port handling a specific type of information; for example, email messages are received on one port and web pages are viewed through another. Port numbers identify the type of information received on each port so that the operating system knows where to direct it. For example, by convention, any data arriving at a computer's port 25 should be email, and any data arriving at a computer's port 80 should be a web page.</p><p>The first thing a RAT's server program does after infecting a computer is to open one or more ports on its network connection in order to broadcast its presence to the RAT client program. Since a computer can theoretically use thousands of different numbered ports simultaneously, and the gory details are hidden from the casual user by the operating system, most users will never notice if a RAT opens one of the many available ports or if an open port is being used by a RAT rather than a legitimate application.</p><p>After opening a port on an infected computer's network connection, the RAT server waits to hear from the RAT client, which runs on the malicious hacker's computer. How does the RAT client locate instances of the RAT server? Hackers simply scan the open ports on every networked computer they can find, searching for the specific port that the RAT server opens after it installs itself. Different RATs use different ports, and a RAT hacker can thereby tell when its RAT is at work on a machine. For example, a RAT named Backage uses port 411, while another RAT named Ripper Pro uses port 2023, although hackers can configure RATs to connect to any port number.<a id="IDX-CHP-5-0016" class="indexterm"/></p><p>RAT client files can only control computers infected by the corresponding server file, so a hacker would need to use the Ripper Pro's client file to control computer infected by the Ripper Pro server file, for example. Once a hacker finds an open port used by his particular RAT, he can use the RAT client program to connect to the server and, through it, control the infected computer as if he were physically sitting at the keyboard. Anything typed on the infected computer (passwords, credit card numbers, Social Security numbers, etc.) can be seen by the hacker running the RAT client. This interaction is shown in <a class="xref" href="ch05.html#rats_consist_of_a_client_file_and_a_serv" title="Figure 5-3. RATs consist of a client file and a server file that work together to allow a malicious hacker to control a computer remotely over the Internet.">Figure 5-3</a>.</p><div class="figure"><a id="rats_consist_of_a_client_file_and_a_serv"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject2_d1e3204"/><img src="httpatomoreillycomsourcenostarchimages676499.png.jpg" alt="RATs consist of a client file and a server file that work together to allow a malicious hacker to control a computer remotely over the Internet."/></div></div><p class="title">Figure 5-3. RATs consist of a client file and a server file that work together to allow a malicious hacker to control a computer remotely over the Internet.</p></div><p>Some RATs can even capture screen images and keystrokes from an infected computer and send them (encoded as plain text) back to the hacker. <a class="xref" href="ch05.html#a_rat_apostrophy_s_client_file_provides" title="Figure 5-4. A RAT's client file provides a variety of features for controlling a computer infected by that RAT's server file.">Figure 5-4</a> shows the user interface of the Optix Pro RAT client, which provides push-button access to its many features for controlling an infected computer.</p><p>Once a RAT's server infects your computer, anyone with the corresponding client program can access and control it. So you then have to worry not only about the hacker who originally created the Trojan horse, you also have to worry about an army of hackers who routinely probe computers on the Internet looking for infected computers with open ports and servers waiting to receive and execute instructions from RAT clients.<a id="IDX-CHP-5-0017" class="indexterm"/></p><div class="figure"><a id="a_rat_apostrophy_s_client_file_provides"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject2_d1e3221"/><img src="httpatomoreillycomsourcenostarchimages676501.png" alt="A RAT's client file provides a variety of features for controlling a computer infected by that RAT's server file."/></div></div><p class="title">Figure 5-4. A RAT's client file provides a variety of features for controlling a computer infected by that RAT's server file.</p></div></div></div></div></div>
<div class="sect1" title="Worms: Self-Replicating Viruses"><div class="titlepage"><div><div><h1 class="title"><a id="worms_colon_self-replicating_viruses"/>Worms: Self-Replicating Viruses</h1></div></div></div><p>Most "virus outbreaks" these days are actually worms, although the media tends to use the terms "virus" and "worm" interchangeably. Technically, a virus can only spread by infecting something else, such as a program file or a Microsoft Word document, that must then be copied. When someone copies an infected program file or Word document, he or she helps the virus spread.<a id="IDX-CHP-5-0018" class="indexterm"/></p><p>A worm is more dangerous than a virus because a worm is self-propagating. In its simplest form, a worm program does nothing more than copy and spread itself, but that act alone can often clog network bandwidth and slow down or crash computers, as in the case of the 1988 Morris Internet worm, which reportedly infected up to 6,000 computers. The real danger occurs when the worm delivers a malicious payload as it spreads, such as one that drops a RAT on an infected computer (so that a hacker can spy on it later) or wipes out crucial files.<a id="IDX-CHP-5-0019" class="indexterm"/></p><p>Worms commonly spread through "always-on" Internet connections, such as cable or DSL modems (used by individuals), or T1 and T3 lines (used by businesses). It's possible to spread a worm through a dial-up connection, but dial-up connections are slow, which also limits the speed that a worm can spread.</p><p>Three common ways that worms spread are through email, Internet Relay Chat (IRC) channels or instant messaging services, and Internet ports. Some worms spread themselves exclusively through one method, while others use a combination of methods to ensure they spread as quickly as possible.<a id="IDX-CHP-5-0020" class="indexterm"/></p><div class="sect2" title="Email worms"><div class="titlepage"><div><div><h2 class="title"><a id="email_worms"/>Email worms</h2></div></div></div><p>To spread by email, a worm will search for the address book of an email application such as Microsoft Outlook or Outlook Express. Once the worm finds the address book, it emails copies of itself to some or all of the stored addresses along with a deceptive subject line such as "I Love You" (used by the Love Letter worm in 2000) or "Merry Christmas" (used by the Zafi worm in 2004).<a id="IDX-CHP-5-0021" class="indexterm"/><a id="IDX-CHP-5-0022" class="indexterm"/><a id="IDX-CHP-5-0023" class="indexterm"/><a id="IDX-CHP-5-0024" class="indexterm"/></p><p>Unlike spam, which comes from an unknown source, a worm's email comes from someone the recipient most likely knows (otherwise the email address wouldn't have been stored in the person's address book in the first place). People are apt to trust email from a familiar source and open the message and its attachments, not suspecting that it includes the worm.</p><p>To further entice users to run the malicious attachment, the worm may falsely describe its content as a graphics file (a celebrity having sex), as an electronic greeting card, or as a seemingly harmless text file (a technique used by the MyDoom worm). When the victim opens the attachment, the worm copies email addresses from the new victim's address book and starts emailing itself to a new batch of people all over again.</p></div><div class="sect2" title="IRC/Instant messaging worms"><div class="titlepage"><div><div><h2 class="title"><a id="irc_solidus_instant_messaging_worms"/>IRC/Instant messaging worms</h2></div></div></div><p>IRC networks are groups of chat rooms that anyone can join. To access an IRC network, a user must run an IRC program, called a client, which allows him to connect to an IRC server. After choosing an IRC network to visit, the user then chooses a specific IRC channel in which to chat.</p><p>When an IRC worm infects a computer, it starts that computer's IRC client program, usually the popular mIRC program. Once the worm has gotten the IRC client program running on its host computer, it randomly connects to an IRC network and channel and tries to trick the chatters into accepting a file containing a copy of itself, disguising it as an MP3 file from a popular recording artist or a pornographic image of a celebrity.</p><p>The moment an unsuspecting IRC user agrees to download the file offered by the IRC worm, the worm infects that person's computer too, and the worm can use the new victim's IRC client to connect to yet another IRC network and start the spread of the worm once more.</p><p>Instant messaging (IM) worms work similarly to IRC worms. An IM worm loads an IM program, such as MSN Messenger, and sends out messages to everyone in a chat room offering an enticing file, which, when downloaded, infects the user's computer and continues the cycle.<a id="IDX-CHP-5-0025" class="indexterm"/><a id="IDX-CHP-5-0026" class="indexterm"/></p></div><div class="sect2" title="Internet worms"><div class="titlepage"><div><div><h2 class="title"><a id="internet_worms"/>Internet worms</h2></div></div></div><p>Both email and IRC worms use Trojan horse strategies to fool victims into infecting their computers. Internet worms can infect a computer without the user even being aware of the attack, infection, and spread. Internet worms scan vulnerable computers for specific open ports and then download themselves onto these machines, often taking advantage of flaws in the target computer's operating system to escape undetected. Once an Internet worm has infected a computer, it then scans the Internet to find other vulnerable computers.</p><p>The Santy worm takes a slightly different approach. Instead of directly scanning targeted computers (and thereby risking revealing its presence), the Santy worm uses the Google search engine to find computers running a flawed version of a community forum program known as the PHP Bulletin Board (phpBB). It then targets those specific computers to infect. By taking this approach, the Santy worm doesn't waste time trying to infect computers that won't help it to spread (such as any computer running Mac OS X).<a id="IDX-CHP-5-0027" class="indexterm"/><a id="IDX-CHP-5-0028" class="indexterm"/><a id="IDX-CHP-5-0029" class="indexterm"/><a id="IDX-CHP-5-0030" class="indexterm"/><a id="IDX-CHP-5-0031" class="indexterm"/><a id="IDX-CHP-5-0032" class="indexterm"/></p></div><div class="sect2" title="Malicious web pages"><div class="titlepage"><div><div><h2 class="title"><a id="malicious_web_pages"/>Malicious web pages</h2></div></div></div><p>The latest technique for installing Trojan horses on unsuspecting computers involves malicious web pages. First, a Trojan horse infects a server that hosts a website. Then, every time someone visits that website, the Trojan horse infects that person's computer.<a id="IDX-CHP-5-0033" class="indexterm"/></p><p>While the thought of browsing a website that could infect your computer might be scary, the technical details prevent these types of Trojan horses from becoming more widespread. First, the Trojan horse must infect the server hosting a website. So if a hacker wanted to turn Microsoft's website into a malicious web page, he would first have to find the servers that host Microsoft's web pages, and then he would have to get the Trojan horse to infect that computer.</p><p>If a hacker is able to successfully infect a server, he then has to infect a user's computer. This relies on ActiveX controls, which are miniature programs that Microsoft uses to update Windows and antivirus vendors use to run online scans of your hard disk. Since ActiveX controls only run under Windows, only Windows computers are vulnerable, and then only those Windows computers that use Internet Explorer. Since neither Firefox nor Opera allow ActiveX controls to run, Trojan horses can't infect computers running those browsers. (ActiveX controls are more often used to install spyware on users' computers than Trojan horses are. See <a class="xref" href="ch20.html" title="Chapter 20. Adware and Spyware">Chapter 20</a> for more information about spyware.)<a id="IDX-CHP-5-0034" class="indexterm"/></p><p>Although the threat of malicious web pages is real, the problems involved in infecting the right servers and then infecting users' computers limit malicious web pages as a prominent way to spread Trojan horses and other malicious software.</p></div></div>
<div class="sect1" title="Stopping Worms and Trojan Horses"><div class="titlepage"><div><div><h1 class="title"><a id="stopping_worms_and_trojan_horses"/>Stopping Worms and Trojan Horses</h1></div></div></div><p>If you connect to the Internet, chances are good that your computer will eventually be attacked by a Trojan horse or worm. To protect yourself, you need to detect and remove any Trojan horses or worms already on your computer and then prevent them from infecting your computer again.</p><p>Step one is to use an antivirus program (see <a class="xref" href="ch04.html" title="Chapter 4. Ansi Bombs and Viruses">Chapter 4</a> for a list of antivirus programs), which will look for a Trojan horse or worm's unique fingerprint or signature and remove all traces of it from your computer. For further protection against RATs, you can also buy a dedicated anti–Trojan horse program such as:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col/><col/></colgroup><tbody><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>Bo Clean</strong></span></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.nsclean.com">www.nsclean.com</a></p></td></tr><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>Ewido Security Suite</strong></span></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.ewido.net">www.ewido.net</a></p></td></tr><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>Tauscan</strong></span></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.agnitum.com">www.agnitum.com</a></p></td></tr><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>The Cleaner</strong></span></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.moosoft.com">www.moosoft.com</a></p></td></tr><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>Hacker Eliminator</strong></span><a id="IDX-CHP-5-0035" class="indexterm"/><a id="IDX-CHP-5-0036" class="indexterm"/><a id="IDX-CHP-5-0037" class="indexterm"/><a id="IDX-CHP-5-0038" class="indexterm"/><a id="IDX-CHP-5-0039" class="indexterm"/><a id="IDX-CHP-5-0040" class="indexterm"/><a id="IDX-CHP-5-0041" class="indexterm"/><a id="IDX-CHP-5-0042" class="indexterm"/><a id="IDX-CHP-5-0043" class="indexterm"/><a id="IDX-CHP-5-0044" class="indexterm"/><a id="IDX-CHP-5-0045" class="indexterm"/><a id="IDX-CHP-5-0046" class="indexterm"/><a id="IDX-CHP-5-0047" class="indexterm"/><a id="IDX-CHP-5-0048" class="indexterm"/></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.lockdowncorp.com">www.lockdowncorp.com</a></p></td></tr><tr><td style="text-align: left" valign="top"><p><span class="strong"><strong>TrojanHunter</strong></span></p></td><td style="text-align: left" valign="top"><p><a class="ulink" href="http://www.misec.net/trojanhunter">www.misec.net/trojanhunter</a></p></td></tr></tbody></table></div><p>Since both RATs and worms can sneak in and out of a computer through open network ports, you also need a firewall that blocks these ports. With a firewall in place, even if a RAT or worm <span class="emphasis"><em>does</em></span> infect your computer, it won't be able to communicate and spread to the outside world through its customary ports. Unfortunately, a firewall won't protect against any damage a worm may cause on your machine.</p><p>Many worms rely on exploiting flaws in software running on the victim's machine, such as the operating system, so make sure you download every update issued for your operating system and applications. Of course, this won't protect your computer from worms that know how to exploit flaws that haven't yet been reported and patched, but it will at least limit any unnecessary exposure.</p><p>To stop the spread and infection of worms, consider using alternatives to popular software. Most RATs and worms target the Windows operating system, so nothing can make your computer more secure than switching to a non-Windows operating system such as Linux or BSD.</p><p>If you still insist on using Windows, you can foil email worms by using anything but Microsoft Outlook or Outlook Express. Instead, try Thunderbird (<a class="ulink" href="http://www.mozilla.org">www.mozilla.org</a>), Pegasus Mail (<a class="ulink" href="http://www.pmail.com">www.pmail.com</a>), or Eudora (<a class="ulink" href="http://www.eudora.com">www.eudora.com</a>). To stop most IRC worms, switch from mIRC to Visual IRC (<a class="ulink" href="http://www.visualirc.net">www.visualirc.net</a>), XiRCON (<a class="ulink" href="http://www.visualirc.net">www.visualirc.net</a>), or X-Chat (<a class="ulink" href="http://www.xchat.org">www.xchat.org</a>). For further help in removing worms and Trojan horses from your computer, download a free copy of Microsoft's Malicious Software Removal Tool (<a class="ulink" href="http://www.microsoft.com/security/malwareremove/default.mspx">www.microsoft.com/security/malwareremove/default.mspx</a>).<a id="IDX-CHP-5-0049" class="indexterm"/><a id="IDX-CHP-5-0050" class="indexterm"/><a id="IDX-CHP-5-0051" class="indexterm"/></p><p>The keys to stopping Trojan horses and worms are to prevent their initial access to your computer (by using a firewall to block the ports that they use), to detect and remove any existing Trojan horses and worms (using antivirus and Trojan horse cleaning programs), and to stop using the programs most commonly exploited to spread them (Windows, Outlook, mIRC, etc.). Your computer can still become a target of Trojan horses and worms no matter what defenses you install, but at least there will be less of a chance that your computer will suffer any damage or contribute to the proliferation of these threats.</p></div>
<div class="sect1" title="Tracking the Threats"><div class="titlepage"><div><div><h1 class="title"><a id="tracking_the_threats"/>Tracking the Threats</h1></div></div></div><p>To stay up to date on the latest security threats, visit CERT (<a class="ulink" href="http://www.cert.org/advisories">www.cert.org/advisories</a>), Virus List (<a class="ulink" href="http://www.viruslist.com">www.viruslist.com</a>), Security Focus (<a class="ulink" href="http://www.securityfocus.com">www.securityfocus.com</a>), SANS (SysAdmin, Audit, Network, Security) Institute (<a class="ulink" href="http://www.sans.org">www.sans.org</a>), or Symantec (<a class="ulink" href="http://securityresponse.symantec.com">http://securityresponse.symantec.com</a>).</p><p>Ultimately, knowledge and understanding of how Trojan horses and worms spread will be more useful in protecting your computer than all the defensive programs combined. If you don't exercise a little common sense when dealing with suspicious threats, all the firewalls and anti–Trojan horse programs in the world won't be enough to protect your computer.</p></div>
<div class="chapter" title="Chapter&#xA0;6.&#xA0;Warez (Software Piracy)"><div class="titlepage"><div><div><h1 class="title"><a id="warez_open_parenthesis_software_piracy_c"/>Chapter 6. Warez (Software Piracy)</h1></div></div></div><div class="epigraph"><p>Only one thing is impossible for God: To find any sense in any copyright law on the planet.<a id="IDX-CHP-6-0001" class="indexterm"/><a id="IDX-CHP-6-0002" class="indexterm"/></p><div class="attribution"><span>—<span class="attribution">
<span class="author"><span class="firstname">MARK</span> <span class="surname">TWAIN</span></span>
</span></span></div></div><p>When people started selling the first computer programs on paper tape, tape cassettes, floppy disks, and CDs, people discovered that they could easily copy a program and share it with their friends. Such blatant copying prompted the programmer of an Altair computer BASIC interpreter to write an open letter to fellow computer hobbyists, urging them not to copy or pirate software illegally:</p><div class="blockquote"><blockquote class="blockquote"><p>AN OPEN LETTER TO HOBBYISTS</p><p>By William Henry Gates III</p><p>February 3, 1976</p><p>To me, the most critical thing in the hobby market right now is the lack of good software courses, books and software itself. Without good software and an owner who understands programming, a hobby computer is wasted. Will quality software be written for the hobby market?</p><p>Almost a year ago, Paul Allen and myself, expecting the hobby market to expand, hired Monte Davidoff and developed Altair BASIC. Though the initial work took only two months, the three of us have spent most of the last year documenting, improving and adding features to BASIC. Now we have 4K, 8K, EXTENDED, ROM and DISK BASIC. The value of the computer time we have used exceeds $40,000.</p><p>The feedback we have gotten from the hundreds of people who say they are using BASIC has all been positive. Two surprising things are apparent, however, 1) Most of these "users" never bought BASIC (less than 10% of all Altair owners have bought BASIC), and 2) The amount of royalties we have received from sales to hobbyists makes the time spent on Altair BASIC worth less than $2 an hour.</p><p>Why is this? As the majority of hobbyists must be aware, most of you steal your software. Hardware must be paid for, but software is something to share. Who cares if the people who worked on it get paid?</p><p>Is this fair? One thing you don't do by stealing software is get back at MITS<sup>[<a id="CHP-6-FN-1" href="#ftn.CHP-6-FN-1" class="footnote">1</a>]</sup> for some problem you may have had. MITS doesn't make money selling software. The royalty paid to us, the manual, the tape and the overhead make it a break-even operation. One thing you do do is prevent good software from being written. Who can afford to do professional work for nothing? What hobbyist can put 3-man years into programming, finding all bugs, documenting his product and distribute for free? The fact is, no one besides us has invested a lot of money in hobby software. We have written 6800 BASIC, and are writing 8080 APL and 6800 APL, but there is very little incentive to make this software available to hobbyists. Most directly, the thing you do is theft.<a id="IDX-CHP-6-0003" class="indexterm"/><a id="IDX-CHP-6-0004" class="indexterm"/><a id="IDX-CHP-6-0005" class="indexterm"/></p><p>What about the guys who re-sell Altair BASIC, aren't they making money on hobby software? Yes, but those who have been reported to us may lose in the end. They are the ones who give hobbyists a bad name, and should be kicked out of any club meeting they show up at.</p><p>I would appreciate letters from any one who wants to pay up, or has a suggestion or comment. Just write to me at 1180 Alvarado SE, #114, Albuquerque, New Mexico, 87108. Nothing would please me more than being able to hire ten programmers and deluge the hobby market with good software.</p><p>Bill Gates</p><p>General Partner, Micro-Soft</p></blockquote></div><div class="sect1" title="Copying Copy-Protected Software"><div class="titlepage"><div><div><h1 class="title"><a id="copying_copy-protected_software"/>Copying Copy-Protected Software</h1></div></div></div><p>Despite Bill Gates's pleas, software piracy not only thrived but also proliferated under the slang name <span class="emphasis"><em>warez</em></span>. In the early days, software publishers tried to protect their products by shipping programs on copy-protected floppy disks, but other companies soon released special programs that could copy a copy-protected floppy disk, ostensibly for backup purposes.<a id="IDX-CHP-6-0006" class="indexterm"/></p><p>Some software publishers shipped their programs with a hardware device called a dongle, which usually attached to the computer's parallel port. Every time a program would run, it would check to see if this dongle was attached to the computer. If it didn't find the dongle, the program would assume it had been copied illegally and would refuse to run.</p><p>Hackers quickly found ways to emulate these dongles using software, essentially tricking a program into thinking a dongle was attached to the computer when it wasn't. Many companies even started selling software dongle emulators, such as Spectrum Software (<a class="ulink" href="http://www.donglefree.com">www.donglefree.com</a>) and SafeKey International (<a class="ulink" href="http://www.safe-key.com">www.safe-key.com</a>).<a id="IDX-CHP-6-0007" class="indexterm"/></p><p>When fledgling online services such as America Online appeared, software piracy became even more rampant. Hackers formed software cracking groups and gave themselves names like Phrozen Crew, Fantastic Four Cracking Group, and the International Network of Crackers. These cracking groups competed against one another to grab a copy of copy-protected programs (usually games), remove the copy-protection scheme, and distribute the cracked copy of the program on BBSs and online services such as America Online.<a id="IDX-CHP-6-0008" class="indexterm"/><a id="IDX-CHP-6-0009" class="indexterm"/><a id="IDX-CHP-6-0010" class="indexterm"/><a id="IDX-CHP-6-0011" class="indexterm"/></p><p>To brag about their exploits, cracking groups would insert a screen that appeared whenever someone tried to run a cracked program. These screens, dubbed <span class="emphasis"><em>crack intros</em></span> or simply <span class="emphasis"><em>cracktros</em></span>, often displayed colorful graphics to publicize the name of the cracking group, their BBS number, acknowledgments to their friends, or just a silly message, as shown in <a class="xref" href="ch06.html#cracktros_let_everyone_know_which_cracki" title="Figure 6-1. Cracktros let everyone know which cracking group had been responsible for cracking a particular program.">Figure 6-1</a>.</p><div class="figure"><a id="cracktros_let_everyone_know_which_cracki"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject3_d1e3624"/><img src="httpatomoreillycomsourcenostarchimages676503.png.jpg" alt="Cracktros let everyone know which cracking group had been responsible for cracking a particular program."/></div></div><p class="title">Figure 6-1. Cracktros let everyone know which cracking group had been responsible for cracking a particular program.</p></div><p>To see more examples of cracktros created by various cracking groups, visit Defacto2 (<a class="ulink" href="http://www.defacto2.net">www.defacto2.net</a>), Flashtro (<a class="ulink" href="http://www.flashtro.com">www.flashtro.com</a>), or the World of Cracktros (<a class="ulink" href="http://cracktros.planet-d.net">http://cracktros.planet-d.net</a>).</p><p>Among those who didn't partake of cracked programs, copy protection did prevent casual copying, but it also prevented legitimate users from making backup copies of their software. One spilled drink on a copy-protected floppy disk could effectively ruin a $495 program.</p><p>To copy-protect their software without inconveniencing legitimate users too much, software publishers have tried a variety of schemes. Some of these methods involved typing in special codes printed in the user manual every time the program started up. Another method involved "locking" a program to a specific hard disk. This required you to "unlock" and delete the program from the first computer before you could use the installation disk on a different computer.</p><p>This anecdote may be apocryphal, but it's said that Microsoft even attempted a bizarre form of copy protection on its MS-DOS version of Microsoft Word. Periodically, the program would check to see if it was running off a legitimate copy-protected floppy disk. If it detected a pirated copy, the program would retaliate by trashing any files it could find. Nobody knew about this form of copy protection until Word happened to trash a computer journalist's files. Even worse, the journalist had been running a legitimate copy of Microsoft Word.</p><p>Microsoft quickly denied that this form of copy protection existed, then blamed a summer intern for slipping the retaliation feature into Microsoft Word without the company's permission or knowledge.<a id="IDX-CHP-6-0012" class="indexterm"/></p><p>Although consumers hated it, copy-protection mechanisms remained on most software programs until hard disks became cheaper and more common. Users then needed to copy their software from a floppy disk to their hard disk. Instead of physically blocking their programs from being copied, software publishers resorted to using serial numbers for validation.</p></div><div class="footnotes"><br/><hr/><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-1" href="#CHP-6-FN-1" class="para">1</a>] </sup>Micro Instrumentation and Telemetry Systems (MITS) was the company that made the first personal computer, the Altair 8800.</p></div></div></div>
<div class="sect1" title="Defeating Serial Numbers"><div class="titlepage"><div><div><h1 class="title"><a id="defeating_serial_numbers"/>Defeating Serial Numbers</h1></div></div></div><p>To install many programs, you have to type in a serial number, usually found on an enclosed registration card or (if you downloaded the software over the Internet) included in an email message from the software publisher. By typing in a valid serial number, typically an unusual combination of letters and numbers, you "unlock" the software and install it on your computer.</p><p>Of course, some people found that serial numbers were easy to defeat. They'd simply copy their valid serial numbers and pass them among their friends. Since they no longer had to use their programming skills to crack any type of copy-protection, warez pirates simply set up websites with huge lists of valid serial numbers for different programs that anyone could use right away, as shown in <a class="xref" href="ch06s02.html#many_warez_sites_offer_serial_numbers_fo" title="Figure 6-2. Many warez sites offer serial numbers for a wide variety of different programs.">Figure 6-2</a>.</p><div class="figure"><a id="many_warez_sites_offer_serial_numbers_fo"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject3_d1e3665"/><img src="httpatomoreillycomsourcenostarchimages676505.png.jpg" alt="Many warez sites offer serial numbers for a wide variety of different programs."/></div></div><p class="title">Figure 6-2. Many warez sites offer serial numbers for a wide variety of different programs.</p></div><p>Besides storing serial numbers of different programs on websites, which could get shut down, other hackers have stored serial numbers in databases that you can download, search, and update, as shown in <a class="xref" href="ch06s02.html#you_can_find_a_list_of_serial_numbers_fo" title="Figure 6-3. You can find a list of serial numbers for different programs stored in the Serials 2000 database, available for download off the Internet.">Figure 6-3</a>.</p><div class="figure"><a id="you_can_find_a_list_of_serial_numbers_fo"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject3_d1e3677"/><img src="httpatomoreillycomsourcenostarchimages676507.png.jpg" alt="You can find a list of serial numbers for different programs stored in the Serials 2000 database, available for download off the Internet."/></div></div><p class="title">Figure 6-3. You can find a list of serial numbers for different programs stored in the Serials 2000 database, available for download off the Internet.</p></div><p>One problem with this approach is that expanding the database typically requires people to share their valid serial numbers. Since few people are likely to do this, hackers have created special serial number generation programs that use the same algorithms used by the programs themselves.<a id="IDX-CHP-6-0013" class="indexterm"/><a id="IDX-CHP-6-0014" class="indexterm"/><a id="IDX-CHP-6-0015" class="indexterm"/><a id="IDX-CHP-6-0016" class="indexterm"/></p><p>Although serial numbers appear to be random combinations of numbers and letters, they're actually created by a mathematical formula. So although it's nearly impossible to guess a valid serial number for a program, it's often possible to reverse engineer a program to determine the specific formula it uses during validation.</p><p>To reverse engineer a program, hackers use special programs called disassemblers, which can convert a program into assembly language instructions. Once hackers understand the exact verification method, they can create a program to generate random serial numbers that match the target program's serial number verification formula. Most companies use the same serial number verification formula for different products, so hackers develop different serial number generators for different vendors, such as Microsoft and Adobe, as shown in <a class="xref" href="ch06s02.html#serial_key_generators_can_develop_quotat" title="Figure 6-4. Serial key generators can develop &quot;valid&quot; serial numbers for a range of products from companies such as Adobe or Microsoft.">Figure 6-4</a>.</p><p>To find websites that list serial numbers or that offer serial number generators, visit CrackHell (<a class="ulink" href="http://www.crackhell.com">www.crackhell.com</a>), KeyGen (<a class="ulink" href="http://www.keygen.us">www.keygen.us</a>), MegaZip (<a class="ulink" href="http://www.megazip.com">www.megazip.com</a>), or Serials (<a class="ulink" href="http://www.serials.ws">www.serials.ws</a>).</p><div class="note" title="Note"><h3 class="title">Note</h3><p>Be careful when visiting any hacker sites, as they'll often bombard you with pop-up windows loaded with pornography and try to sneak spyware (see <a class="xref" href="ch20.html" title="Chapter 20. Adware and Spyware">Chapter 20</a>) onto your computer. For safety, browse hacker sites on a non-Windows computer such as one running Linux or Mac OS X.</p></div><div class="figure"><a id="serial_key_generators_can_develop_quotat"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject3_d1e3725"/><img src="httpatomoreillycomsourcenostarchimages676509.png.jpg" alt="Serial key generators can develop &quot;valid&quot; serial numbers for a range of products from companies such as Adobe or Microsoft."/></div></div><p class="title">Figure 6-4. Serial key generators can develop "valid" serial numbers for a range of products from companies such as Adobe or Microsoft.</p></div></div>
<div class="sect1" title="Defeating Product Activation"><div class="titlepage"><div><div><h1 class="title"><a id="defeating_product_activation"/>Defeating Product Activation</h1></div></div></div><p>The latest attempt to curb software piracy involves product activation. When you install a program that uses product activation, it gathers information about the computer's CPU, hard disk, graphics card, and other hardware to create a unique identifier. Then the program sends this information, along with the serial number entered by the user, to the software publisher. This ties a specific serial number to a particular computer, preventing anyone from reusing that serial number on another computer.<a id="IDX-CHP-6-0017" class="indexterm"/></p><p>Product activation defeats the rampant sharing of valid serial numbers, but still can't defeat serial number generators since a new serial number can always be generated to be linked to another computer.</p><p>More troublesome, from a user's point of view, is that product activation can be a nuisance at best and a major headache at worst. Intuit once sold its popular TurboTax program with product activation that, in many cases, actually prevented people from installing and using the software they legitimately bought. Symantec had similar problems when it started including product activation with its Norton Antivirus program. In Symantec's case, the product activation would ask for a serial number every time the computer booted up. No matter how many times the user typed in his valid serial number, the product activation would eventually shut down after a few days and stop Norton Antivirus from working altogether. In both cases, bugs in the product activation program wound up punishing legitimate users.</p><p>Product activation may stop ordinary computer users from pirating software, but it does nothing to stop determined hackers, who are the people most likely to pirate software in the first place. As soon as Microsoft introduced product activation for Windows, hackers developed product activation patches that could modify the operating system and prevent its product activation feature from working, as shown in <a class="xref" href="ch06s03.html#to_defeat_product_activation_comma_many" title="Figure 6-5. To defeat product activation, many hackers have developed patches that trick a program into thinking it has already been activated.">Figure 6-5</a>.<a id="IDX-CHP-6-0018" class="indexterm"/><a id="IDX-CHP-6-0019" class="indexterm"/><a id="IDX-CHP-6-0020" class="indexterm"/><a id="IDX-CHP-6-0021" class="indexterm"/><a id="IDX-CHP-6-0022" class="indexterm"/><a id="IDX-CHP-6-0023" class="indexterm"/><a id="IDX-CHP-6-0024" class="indexterm"/></p><div class="figure"><a id="to_defeat_product_activation_comma_many"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject3_d1e3770"/><img src="httpatomoreillycomsourcenostarchimages676511.png.jpg" alt="To defeat product activation, many hackers have developed patches that trick a program into thinking it has already been activated."/></div></div><p class="title">Figure 6-5. To defeat product activation, many hackers have developed patches that trick a program into thinking it has already been activated.</p></div><p>Like serial numbers and copy protection, product activation discourages casual copying but with added nuisance and expense for the software publisher. No matter what method software publishers use to guard against piracy, they'll only succeed in slowing down software pirates, not eliminating them. Product activation might work in theory, but as every hacker knows, theory means nothing in the real (and virtual) world of computers.</p></div>
<div class="sect1" title="Warez Websites"><div class="titlepage"><div><div><h1 class="title"><a id="warez_websites"/>Warez Websites</h1></div></div></div><p>In the old days, people pirated software by copying a program onto a floppy disk and giving the copy to someone else. Later, pirates ran private BBSs and swapped software through the telephone lines.</p><p>When pirates discovered the Internet, they set up their own websites for trading illicit software, as shown in <a class="xref" href="ch06s04.html#software_pirates_often_trade_software_am" title="Figure 6-6. Software pirates often trade software amongst themselves through pirate websites.">Figure 6-6</a>. Some popular lists of hacker sites include Warez List (<a class="ulink" href="http://www.warezlist.com">www.warezlist.com</a>), DirectDL (<a class="ulink" href="http://www.directdl.com">www.directdl.com</a>), AllSeek (<a class="ulink" href="http://top.allseek.info">http://top.allseek.info</a>), CrackDB (<a class="ulink" href="http://www.crackdb.com">www.crackdb.com</a>), and Warez Files (<a class="ulink" href="http://www.warez-files.com">www.warez-files.com</a>).<a id="IDX-CHP-6-0025" class="indexterm"/></p><p>Since websites can easily be tracked by the authorities, pirates soon moved on to swapping programs through filesharing networks (such as FastTrack, Gnutella, and BitTorrent) and Usenet newsgroups.<a id="IDX-CHP-6-0026" class="indexterm"/></p><p>One problem with filesharing networks is that authorities can track down any user's Internet Protocol (IP) address and then, by linking a computer's IP address to a physical address, could often nab blatant file sharers and punish them.</p><p>That's why more pirates have flocked to BitTorrent. Unlike traditional filesharing networks like Gnutella, you don't search anyone else's computer. Instead, you have to visit a website, called an indexing site, that provides a list of files you can download, such as movies, programs, or music. Once you click a file, the indexing site directs you to all the computers that have that file.</p><div class="figure"><a id="software_pirates_often_trade_software_am"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject3_d1e3816"/><img src="httpatomoreillycomsourcenostarchimages676513.png.jpg" alt="Software pirates often trade software amongst themselves through pirate websites."/></div></div><p class="title">Figure 6-6. Software pirates often trade software amongst themselves through pirate websites.</p></div><p>Even more remarkable is that as soon as you start downloading a file, BitTorrent lets you simultaneously share that file with anyone else. Not only does this speed up file transfers, but it also insures that if your computer loses connection with another computer, you can still download the parts of the file you need from a different computer. Because of its ability to handle large files and its speed in downloading, BitTorrent has quickly become a favorite among pirates of all kinds.<a id="IDX-CHP-6-0027" class="indexterm"/></p></div>
<div class="sect1" title="Usenet Newsgroups: The New Piracy Breeding Ground"><div class="titlepage"><div><div><h1 class="title"><a id="usenet_newsgroups_colon_the_new_piracy_b"/>Usenet Newsgroups: The New Piracy Breeding Ground</h1></div></div></div><p>While most pirates use BitTorrent to share files, many pirates also use the seemingly antiquated Usenet newsgroups as well.</p><p>On Usenet newsgroups, pirates can upload programs anonymously, and anyone can download them anonymously as well. No matter how hard they might try, the authorities can only identify that software piracy is occurring; they can't trace the offenders.</p><p>Initially, Usenet newsgroups were rather cumbersome compared to the point-and-click convenience of web pages. Trying to find a particular program meant scouring through multiple newsgroups. Also, Usenet newsgroups imposed a fixed file size of 10,000 lines per file, which meant that large files, such as pirated programs, had to be broken into parts, which were downloaded individually and then reassembled. If even one part were missing, the program wouldn't work. As a result, Usenet newsgroups often proved too troublesome for less tech-savvy users to handle.</p><p>To make searching for files among newsgroups easier, programmers have created a new file format, dubbed NewzBin (NZB), to turn Usenet newsgroups into a fast indexing and downloading resource for warez.<a id="IDX-CHP-6-0028" class="indexterm"/><a id="IDX-CHP-6-0029" class="indexterm"/><a id="IDX-CHP-6-0030" class="indexterm"/><a id="IDX-CHP-6-0031" class="indexterm"/><a id="IDX-CHP-6-0032" class="indexterm"/><a id="IDX-CHP-6-0033" class="indexterm"/><a id="IDX-CHP-6-0034" class="indexterm"/><a id="IDX-CHP-6-0035" class="indexterm"/><a id="IDX-CHP-6-0036" class="indexterm"/><a id="IDX-CHP-6-0037" class="indexterm"/><a id="IDX-CHP-6-0038" class="indexterm"/></p><p>To search a Usenet newsgroup for files, you can visit the more common ones, such as alt.binaries.warez, or you could use a Usenet newsgroup search engine such as alt.binaries.nl (<a class="ulink" href="http://alt.binaries.nl">http://alt.binaries.nl</a>), BinCrawler (<a class="ulink" href="http://www.bincrawler.com">www.bincrawler.com</a>), Newzbin (<a class="ulink" href="http://www.newzbin.com">www.newzbin.com</a>), or Find Free Files (<a class="ulink" href="http://www.findfreefiles.com">www.findfreefiles.com</a>), as shown in <a class="xref" href="ch06s05.html#by_searching_through_usenet_newsgroups_c" title="Figure 6-7. By searching through Usenet newsgroups, you can find a pirated program to download, such as Adobe Illustrator or VMware.">Figure 6-7</a>.</p><div class="figure"><a id="by_searching_through_usenet_newsgroups_c"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject3_d1e3891"/><img src="httpatomoreillycomsourcenostarchimages676515.png.jpg" alt="By searching through Usenet newsgroups, you can find a pirated program to download, such as Adobe Illustrator or VMware."/></div></div><p class="title">Figure 6-7. By searching through Usenet newsgroups, you can find a pirated program to download, such as Adobe Illustrator or VMware.</p></div><p>Once you find the pirated program you want, you can use a newsreader program that supports NZB files, such as NewsMan Pro (<a class="ulink" href="http://www.newsmanpro.com">www.newsmanpro.com</a>), Binary Boy (<a class="ulink" href="http://www.binaryboy.com">www.binaryboy.com</a>), NewsBin Pro (<a class="ulink" href="http://www.newsbin.com">www.newsbin.com</a>), or News Rover (<a class="ulink" href="http://www.newsrover.com">www.newsrover.com</a>), as shown in <a class="xref" href="ch06s05.html#a_newsreader_can_help_you_find_warez_in" title="Figure 6-8. A newsreader can help you find warez in a newsgroup, such as a copy of Microsoft Windows Vista along with a patch to disable Windows Vista's product activation feature.">Figure 6-8</a>, to download it without having to search manually.</p><p>Combine a NZB-enabled newsreader with a high-speed, dedicated news server such as NewsDemon (<a class="ulink" href="http://www.newsdemon.com">www.newsdemon.com</a>), GigaNews (<a class="ulink" href="http://www.giganews.com">www.giganews.com</a>), or AstraWeb (<a class="ulink" href="http://www.news.astraweb.com">www.news.astraweb.com</a>), and you can start downloading all the warez you want without anyone knowing who you are.</p><p>People have been pirating software ever since computers have been around, and that is not going to change anytime soon. People in developing nations and countries such as China and Russia pirate software because they can't afford it otherwise. That doesn't make piracy right, but given that the cost of a single copy of Adobe Photoshop is more than most people in the world earn in a month, it's safe to say that piracy will always be a more enticing option than buying software honestly, at least for some people.</p><div class="figure"><a id="a_newsreader_can_help_you_find_warez_in"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject3_d1e3928"/><img src="httpatomoreillycomsourcenostarchimages676517.png.jpg" alt="A newsreader can help you find warez in a newsgroup, such as a copy of Microsoft Windows Vista along with a patch to disable Windows Vista's product activation feature."/></div></div><p class="title">Figure 6-8. A newsreader can help you find warez in a newsgroup, such as a copy of Microsoft Windows Vista along with a patch to disable Windows Vista's product activation feature.</p></div><p>To fight back against piracy, the Motion Picture Association of America (MPAA) and the Recording Industry Association of America (RIAA) have used several techniques with varying degrees of success. Initially, the MPAA/RIAA targeted individuals sharing enormous numbers of files off their computers, such as a thousand or more. By suing these individuals, the MPAA/RIAA hoped to scare away others from sharing files too.<a id="IDX-CHP-6-0039" class="indexterm"/><a id="IDX-CHP-6-0040" class="indexterm"/><a id="IDX-CHP-6-0041" class="indexterm"/><a id="IDX-CHP-6-0042" class="indexterm"/></p><p>To further discourage piracy, the MPAA/RIAA also "poisoned" the filesharing networks with bogus files. If people kept downloading bogus files, the MPAA/RIAA hoped that they would abandon the filesharing networks and turn to legitimate ones instead.</p><p>Next, the MPAA/RIAA started targeting the companies that made the filesharing programs. During 2005, the MPAA/RIAA managed to sue and shut down the publishers of Grokster and WinMX. By taking away the software used to swap files, the MPAA/RIAA hoped to shut down the filesharing networks one by one.</p><p>For their latest tactic, the MPAA/RIAA has targeted the search engines that provide access to pirated files, such as BinNews.com, which allowed people to search Usenet newsgroups for warez, or IsoHunt.com, which provided links to BitTorrent files, such as full-length movies or major applications like Adobe Photoshop.</p><p>Generally speaking, finding a pirated program can be tedious—and getting that pirated program to work can sometimes be more frustrating than going out and buying it. For hackers, software piracy is a challenge. For the average user, piracy is appealing only when it's convenient. But to dedicated software pirates, piracy can be a way of life, and nothing the software publishers can do will ever stop it.</p></div></body></html>