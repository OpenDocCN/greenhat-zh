- en: Introduction
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简介
- en: '![image with no caption](httpatomoreillycomsourcenostarchimages1137497.png.jpg)'
  id: totrans-1
  prefs: []
  type: TYPE_IMG
  zh: '![无标题图片](httpatomoreillycomsourcenostarchimages1137497.png.jpg)'
- en: Welcome to *FreeBSD Device Drivers*! The goal of this book is to help you improve
    your understanding of device drivers under FreeBSD. By the time you finish this
    book, you should be able to build, configure, and manage your own FreeBSD device
    drivers.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 欢迎来到《*FreeBSD设备驱动程序*》！本书的目标是帮助您提高对FreeBSD下设备驱动程序的理解。完成本书后，您应该能够构建、配置和管理自己的FreeBSD设备驱动程序。
- en: This book covers FreeBSD version 8, the version recommended for production use
    as of this writing. Nonetheless, most of what you’ll learn will apply to earlier
    versions and should apply to later ones as well.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本书涵盖FreeBSD版本8，这是截至本书撰写时推荐的用于生产使用的版本。尽管如此，您将学到的大部分内容也将适用于早期版本，并且应该适用于后续版本。
- en: Who Is This Book For?
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 这本书是为谁写的？
- en: I wrote this book as a programmer, for programmers. As such, you’ll find a heavy
    focus on programming, not theory, and you’ll examine real device drivers (namely,
    ones that control hardware). Imagine trying to write a book without ever having
    read one. Inconceivable! The same thing goes for device drivers.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 我作为程序员为程序员写了这本书。因此，您会发现本书对编程的重视程度很高，而不是理论，您将检查真实的设备驱动程序（即控制硬件的驱动程序）。想象一下，如果不曾读过任何一本书就尝试写一本书。这是不可想象的！对于设备驱动程序来说，也是如此。
- en: Prerequisites
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 预备知识
- en: To get the most out of this book, you should be familiar with the C programming
    language. You should also know something about operating system design; for example,
    the difference between a process and a thread.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 为了充分利用本书，您应该熟悉C编程语言。您还应该了解一些操作系统设计方面的知识；例如，进程和线程之间的区别。
- en: 'If you lack the necessary background, I recommend reading the following three
    books prior to this one, or just keeping them around as references:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您缺乏必要的背景知识，我建议在阅读这本书之前先阅读以下三本书，或者只是将它们作为参考资料保留：
- en: The *C Programming Language*, by Brian W. Kernighan and Dennis M. Ritchie (Prentice
    Hall PTR, 1988)
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 《*C程序设计语言*》，作者：Brian W. Kernighan 和 Dennis M. Ritchie（Prentice Hall PTR，1988年）
- en: '*Expert C Programming*, by Peter van der Linden (Prentice Hall, 1994)'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 《*专家C编程*》，作者：Peter van der Linden（Prentice Hall，1994年）
- en: '*The Design and Implementation of the FreeBSD Operating System*, by Marshall
    Kirk McKusick and George V. Neville-Neil (Addison-Wesley Professional, 2005)'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 《*FreeBSD操作系统的设计和实现*》，作者：Marshall Kirk McKusick 和 George V. Neville-Neil（Addison-Wesley
    Professional，2005年）
- en: Contents at a Glance
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 概述内容
- en: '*FreeBSD Device Drivers* contains the following chapters.'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 《*FreeBSD设备驱动程序*》包含以下章节。
- en: '[Chapter 1](ch01.html "Chapter 1. Building and Running Modules")'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '[第1章](ch01.html "第1章。模块构建和运行")'
- en: Provides an overview and introduction to basic device driver programming concepts
    and terminology.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 提供了基本设备驱动程序编程概念和术语的概述和介绍。
- en: '[Chapter 2](ch02.html "Chapter 2. Allocating Memory")'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '[第2章](ch02.html "第2章。内存分配")'
- en: Describes FreeBSD’s kernel memory management routines.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 描述了FreeBSD内核内存管理例程。
- en: '[Chapter 3](ch03.html "Chapter 3. Device Communication and Control")'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '[第3章](ch03.html "第3章。设备通信和控制")'
- en: Teaches you how to communicate with and control your device drivers from user
    space.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 教您如何从用户空间与设备驱动程序进行通信和控制。
- en: '[Chapter 4](ch04.html "Chapter 4. Thread Synchronization")'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '[第4章](ch04.html "第4章。线程同步")'
- en: Discusses the problems and solutions associated with multithreaded programming
    and concurrent execution.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 讨论了与多线程编程和并发执行相关的问题和解决方案。
- en: '[Chapter 5](ch05.html "Chapter 5. Delaying Execution")'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '[第5章](ch05.html "第5章。延迟执行")'
- en: Describes delaying code execution and asynchronous code execution, and explains
    why these tasks are needed.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 描述了延迟代码执行和异步代码执行，并解释了为什么这些任务是必要的。
- en: '[Chapter 6](ch06.html "Chapter 6. Case Study: Virtual Null Modem")'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '[第6章](ch06.html "第6章。案例研究：虚拟Null Modem")'
- en: Contains the first of several occasions where I walk you through a real-world
    device driver.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 包含了几个场合中的第一个，我在这些场合中会向您介绍一个真实的设备驱动程序。
- en: '[Chapter 7](ch07.html "Chapter 7. Newbus and Resource Allocation")'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '[第7章](ch07.html "第7章。Newbus和资源分配")'
- en: Covers the infrastructure used by FreeBSD to manage the hardware devices on
    the system. From here on, I deal exclusively with real hardware.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 介绍了FreeBSD用于管理系统硬件设备的底层基础设施。从现在开始，我将专门处理真实硬件。
- en: '[Chapter 8](ch08.html "Chapter 8. Interrupt Handling")'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '[第8章](ch08.html "第8章。中断处理")'
- en: Discusses interrupt handling in FreeBSD.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 讨论了FreeBSD中的中断处理。
- en: '[Chapter 9](ch09.html "Chapter 9. Case Study: Parallel Port Printer Driver")'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '[第9章](ch09.html "第9章。案例研究：并行端口打印机驱动程序")'
- en: Walks through `lpt(4)`, the parallel port printer driver, in its entirety.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 完整地介绍了`lpt(4)`，并行端口打印机驱动程序。
- en: '[Chapter 10](ch10.html "Chapter 10. Managing and Using Resources")'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '[第10章](ch10.html "第10章. 管理和使用资源")'
- en: Covers port-mapped I/O and memory-mapped I/O.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 涵盖了端口映射I/O和内存映射I/O。
- en: '[Chapter 11](ch11.html "Chapter 11. Case Study: Intelligent Platform Management
    Interface Driver")'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: '[第11章](ch11.html "第11章. 案例研究：智能平台管理接口驱动程序")'
- en: Reviews the parts of `ipmi(4)`, the Intelligent Platform Management Interface
    driver, which uses port-mapped I/O and memory-mapped I/O.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 审查了`ipmi(4)`，智能平台管理接口驱动程序的部分，它使用端口映射I/O和内存映射I/O。
- en: '[Chapter 12](ch12.html "Chapter 12. Direct Memory Access")'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: '[第12章](ch12.html "第12章. 直接内存访问")'
- en: Explains how to use Direct Memory Access (DMA) in FreeBSD.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 解释了如何在FreeBSD中使用直接内存访问（DMA）。
- en: '[Chapter 13](ch13.html "Chapter 13. Storage Drivers")'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '[第13章](ch13.html "第13章. 存储驱动程序")'
- en: Teaches you how to manage storage devices, such as disk drives, flash memory,
    and so on.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 教您如何管理存储设备，例如硬盘驱动器、闪存等。
- en: '[Chapter 14](ch14.html "Chapter 14. Common Access Method")'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: '[第14章](ch14.html "第14章. 常见访问方法")'
- en: Provides an overview and introduction to Common Access Method (CAM), which you’ll
    use to manage host bus adapters.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 提供了关于常见访问方法（CAM）的概述和介绍，您将使用它来管理主机总线适配器。
- en: '[Chapter 15](ch15.html "Chapter 15. USB Drivers")'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '[第15章](ch15.html "第15章. USB 驱动程序")'
- en: Teaches you how to manage USB devices. It also walks through `ulpt(4)`, the
    USB printer driver, in its entirety.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 教您如何管理USB设备。还完整地介绍了`ulpt(4)`，USB打印机驱动程序。
- en: '[Chapter 16](ch16.html "Chapter 16. Network Drivers, Part 1: Data Structures")'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '[第16章](ch16.html "第16章. 网络驱动程序，第一部分：数据结构")'
- en: Describes the data structures used by network drivers. It also goes over Message
    Signaled Interrupts (MSI).
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 描述了网络驱动程序使用的数据结构。还介绍了消息信号中断（MSI）。
- en: '[Chapter 17](ch17.html "Chapter 17. Network Drivers, Part 2: Packet Reception
    and Transmission")'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '[第17章](ch17.html "第17章. 网络驱动程序，第二部分：包接收和传输")'
- en: Examines the packet reception and transmission components of `em(4)`, the Intel
    PCI Gigabit Ethernet adapter driver.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 分析了`em(4)`，英特尔PCI千兆以太网适配器驱动程序的包接收和传输组件。
- en: Welcome Aboard!
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 欢迎加入！
- en: I hope you find this book useful and entertaining. As always, I welcome feedback
    with comments or bug fixes to [joe@thestackframe.org](mailto:joe@thestackframe.org).
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 希望您觉得这本书有用且有趣。一如既往，我欢迎您通过评论或错误修复提供反馈，发送至[joe@thestackframe.org](mailto:joe@thestackframe.org)。
- en: Okay, enough with the introductory stuff. Let’s begin.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 好的，介绍性的内容就到这里。让我们开始吧。
