- en: '![](../images/85-1.jpg)'
  id: totrans-0
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/85-1.jpg)'
- en: '[**THE LADDIE ALARM SYSTEM: A SAMPLE APPLIANCE**](toc.html#chapter5)'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '[**LADDIE报警系统：一个示例设备**](toc.html#chapter5)'
- en: '![](../images/as.jpg)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/as.jpg)'
- en: Previous chapters covered how to build and secure a daemon and how to communicate
    with the daemon while it is running. We’ll tie these topics together in this chapter
    by building *Laddie,* a Linux-based alarm system.¹
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 前几章介绍了如何构建和确保守护进程，以及如何在守护进程运行时与其通信。我们将通过构建*Laddie*，一个基于Linux的报警系统，将这些主题结合起来。¹
- en: Laddie uses the five status inputs on a standard PC parallel port as sensor
    inputs to the alarm system. The heart of the Laddie appliance is the *ladd* (pronounced
    *lad-dee)* daemon that polls the status lines and reports input transitions using
    syslog(). An alarm system is a good choice for a sample application since most
    readers will have some familiarity with alarm systems and because an alarm system
    application is simple to write, understand, and modify.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Laddie使用标准PC并行端口上的五个状态输入作为报警系统的传感器输入。Laddie设备的核心是*ladd*（发音为*lad-dee*）守护进程，它轮询状态线并使用syslog()报告输入转换。由于大多数读者对报警系统都有一定的了解，并且报警系统应用程序易于编写、理解和修改，因此报警系统是一个很好的示例应用程序。
- en: 'This chapter includes the following five sections:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 本章包括以下五个部分：
- en: Introduction to alarm systems
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 报警系统简介
- en: A functional specification for Laddie
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Laddie的功能规范
- en: Laddie hardware design
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Laddie硬件设计
- en: Laddie software design
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Laddie软件设计
- en: Building and testing Laddie
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建 和 测试 Laddie
- en: As you read this chapter, keep in mind that the alarm system itself is not as
    important as the techniques used to build it. Don’t let the implementation details
    overshadow the design principles being taught.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在阅读本章时，请记住，报警系统本身并不像构建它的技术那样重要。不要让实现细节掩盖了正在教授的设计原则。
- en: '[**Introduction to Alarm Systems**](toc.html#chapter5.1)'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '[**报警系统简介**](toc.html#chapter5.1)'
- en: This section presents the concepts and definitions used to describe alarm systems
    in general and Laddie in particular.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 本节介绍了用于描述通用报警系统和Laddie特定概念的术语和定义。
- en: '[***Sensors***](toc.html#chapter5.2)'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '[***传感器***](toc.html#chapter5.2)'
- en: An alarm *sensor* is a small device or switch that detects movement in a room
    or activity in an area. An *alarm system* monitors several alarm sensors and reports
    any unexpected activity they pick up. The area that a sensor protects is called
    a *zone.* Zones are given *names* that usually describe the area protected; typical
    zone names might include *Garage, Second Floor Windows,* and *Refrigerator.*
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 报警*传感器*是一个小型设备或开关，用于检测房间内的运动或区域内的活动。报警系统监控多个报警传感器，并报告它们检测到的任何意外活动。传感器保护的区域称为*区域*。区域被赋予*名称*，通常描述受保护的区域；典型的区域名称可能包括*车库、二楼窗户*和*冰箱*。
- en: Figure 5-1 shows an example arrangement of sensors and zones for a small business.
    There are door sensors on the front and back doors and a motion detector that
    looks for movement near the office and storeroom.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 图5-1展示了小型企业中传感器和区域的一个示例配置。前门和后门上都有门传感器，还有一个检测办公室和储藏室附近运动的运动探测器。
- en: '![](../images/86-1.jpg)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/86-1.jpg)'
- en: '*Figure 5-1: An example alarm system*'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '*图5-1：一个示例报警系统*'
- en: '**Types of Sensors**'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: '**传感器类型**'
- en: Since an alarm system can only report what its sensors detect, it is important
    to choose sensors carefully. Let’s consider the types of sensors that are available.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 由于报警系统只能报告其传感器检测到的内容，因此选择传感器非常重要。让我们考虑可用的传感器类型。
- en: '**Magnetic reed switches**'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: '**磁簧开关**'
- en: These are most often used to monitor doors; they are placed with the switch
    on the doorframe and the magnet on the door.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 这些通常用于监控门；它们被放置在门框上带有开关，门上带有磁铁。
- en: '**PIR motion detectors**'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '**PIR运动探测器**'
- en: '*Passive Infrared (PIR)* motion detectors detect minute changes in the movement
    of infrared (heat) sources. A person or animal can set off a PIR motion detector,
    but, for example, a baseball cannot.'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '*被动红外（PIR）*运动探测器检测红外（热量）源运动的微小变化。人或动物可以触发PIR运动探测器，但例如，棒球不能。'
- en: '**Acoustic sensors**'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '**声学传感器**'
- en: Acoustic sensors detect specific sounds. They are often used to detect the sound
    of breaking glass, and are so sensitive that a single acoustic sensor can protect
    all of the windows in a room.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 声学传感器检测特定的声音。它们通常用于检测破碎玻璃的声音，并且非常敏感，以至于单个声学传感器可以保护房间内所有的窗户。
- en: '**Floor mat sensors**'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '**地板垫传感器**'
- en: Floor mat sensors have switches that can detect the weight of a person. They
    are very thin and are usually placed under carpet at entryways.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 地毯传感器具有可以检测人体重量的开关。它们非常薄，通常放置在入口处的地毯下。
- en: '**Vibration sensors**'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: '**振动传感器**'
- en: Vibration sensors can detect very slight physical motion. They are often used
    to protect cars.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 振动传感器可以检测非常微小的物理运动。它们通常用于保护汽车。
- en: '**Smoke and carbon monoxide detectors**'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: '**烟雾和一氧化碳探测器**'
- en: These sensors are used to detect potential fires.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 这些传感器用于检测潜在的火灾。
- en: '**Temperature sensors**'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: '**温度传感器**'
- en: Thermostats and other temperature sensors trip at a certain temperature or simply
    report the current temperature in the zone. They are often used to protect temperature-sensitive
    equipment and supplies.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 温度控制器和其他温度传感器在达到一定温度时触发，或者简单地报告区域内的当前温度。它们通常用于保护对温度敏感的设备和供应。
- en: '**Sensor Contact Type**'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '**传感器接触类型**'
- en: To the alarm system, most sensors look like switches. The switch contacts can
    be either open when not in alarm (called *normally open* or *NO* sensors), or
    closed when not in alarm (*normally closed* or *NC* sensors). When you install
    a sensor, you have to tell the alarm system the *contact type* of the sensor—that
    is, whether the contacts are normally open or normally closed. Most sensors are
    normally closed. A normally closed sensor has the desirable property of triggering
    an alarm if the wires to the sensor are cut.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 对于报警系统来说，大多数传感器看起来像开关。开关触点在没有报警时可以是开路（称为*常开*或*NO*传感器），或者在没有报警时是闭路（称为*常闭*或*NC*传感器）。当你安装传感器时，你必须告诉报警系统传感器的*接触类型*——也就是说，触点是否是常开或常闭。大多数传感器是常闭的。常闭传感器具有在传感器线被切断时触发报警的优良特性。
- en: Another helpful feature of the sensor-and-zone setup is that it is possible
    to cascade sensors within a zone, as long as the cascaded sensors are all of the
    same contact type. Figure 5-2 shows how to cascade normally open sensors and Figure
    5-3 shows how to cascade normally closed sensors.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 传感器和区域设置的另一个有用功能是，只要级联的传感器都是同一接触类型，就可以在区域内级联传感器。图 5-2 展示了如何级联常开传感器，图 5-3 展示了如何级联常闭传感器。
- en: '![](../images/87-1.jpg)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/87-1.jpg)'
- en: '*Figure 5-2: How to cascade normally open sensors*'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 5-2：如何级联常开传感器*'
- en: '![](../images/88-1.jpg)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/88-1.jpg)'
- en: '*Figure 5-3: How to cascade normally closed sensors*'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 5-3：如何级联常闭传感器*'
- en: Logically, the alarm system sees just one sensor in each zone, even if there
    are actually several cascaded sensors there.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 从逻辑上讲，报警系统在每个区域内只看到一个传感器，即使实际上那里有几个级联的传感器。
- en: '**Latching a Sensor**'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: '**保持传感器状态**'
- en: Most sensors return to the non-alarm or normal state when the detected condition
    is removed—for example, when someone closes a door or steps off of a floor mat.
    You usually want to configure the alarm system to latch alarms detected by these
    sensors. *Latched* alarms remain in alarm, even if the detected condition is removed,
    until they are manually cleared by a user.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数传感器在检测到的条件被移除时（例如，有人关闭门或从地毯上走开）会返回非报警或正常状态。你通常希望配置报警系统以保持这些传感器检测到的报警。*保持状态*的报警即使在检测到的条件被移除后也会保持报警状态，直到由用户手动清除。
- en: However, you might not want to latch every sensor. For example, you might want
    to automatically remove an alarm when the temperature in a thermostat-protected
    room returns to normal.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，你可能不希望每个传感器都保持状态。例如，你可能希望在恒温器保护的房间温度恢复正常时自动移除报警。
- en: Think about the type of sensor you’re using and your specific needs when you
    set alarms in a zone to be latching or non-latching.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 当你在区域内设置报警时，考虑你使用的传感器类型和具体需求，以确定报警是保持状态还是非保持状态。
- en: '[***Enabling a Zone***](toc.html#chapter5.3)'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '[**启用区域**](toc.html#chapter5.3)'
- en: Mark zones as *enabled* if the sensors in the zone are working and you want
    to monitor the zone. Unused inputs can be ignored by disabling the zone. Also,
    you may find it convenient to temporarily disable zones when you want to leave
    a door or window open.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 如果区域内的传感器正在工作并且你想监控该区域，请将区域标记为*启用*。未使用的输入可以通过禁用区域来忽略。此外，当你想暂时关闭门或窗户时，你可能发现禁用区域很方便。
- en: '[**A Functional Specification for Laddie**](toc.html#chapter5.4)'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '[**Laddie 的功能规范**](toc.html#chapter5.4)'
- en: 'The Laddie alarm system monitors up to five zones and raises an alarm when
    a change occurs in one of the monitored zones. Alarms are reported to Laddie’s
    five different user interfaces. In addition to being able to view the status of
    the zones that Laddie monitors, the user interfaces allow you to test and clear
    alarms, view logs, and configure zones. Configuration parameters include the following:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: Laddie警报系统最多监控五个区域，当监控区域之一发生变更时，会触发警报。警报报告给Laddie的五个不同用户界面。除了能够查看Laddie监控的区域状态外，用户界面还允许您测试和清除警报、查看日志以及配置区域。配置参数包括以下内容：
- en: Zone name
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 区域名称
- en: Contact type
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 接触类型
- en: Latching or non-latching
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 锁定或非锁定
- en: Enabled or disabled
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启用或禁用
- en: 'Laddie’s functional specification is divided into two parts: one that allows
    users to access alarm configuration and status and another that allows Laddie
    to handle alarms.'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: Laddie的功能规范分为两部分：一部分允许用户访问警报配置和状态，另一部分允许Laddie处理警报。
- en: '**NOTE**'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*As a reminder,* Laddie *refers to the whole appliance, and* ladd *refers just
    to the daemon that monitors the five input pins on the parallel port. It’s easy
    to confuse the two, since they are pronounced the same.*'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '*提醒一下，* Laddie *指的是整个设备，而* ladd *仅指监视并行端口上五个输入引脚的守护进程。由于它们的发音相同，很容易混淆这两个词。*'
- en: '[***ladd’s Configuration and Status***](toc.html#chapter5.5)'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '[***ladd的配置和状态***](toc.html#chapter5.5)'
- en: 'ladd has one configuration and status table, called *Zone*, that is visible
    to all of the user interfaces as an RTA table. The Zone table has five rows, with
    each row defined by the following data structure:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: ladd有一个配置和状态表，称为*Zone*，作为RTA表对所有用户界面可见。Zone表有五行，每行由以下数据结构定义：
- en: '![](../images/89-1.jpg)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/89-1.jpg)'
- en: Let’s consider each of these fields in turn.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们逐一考虑这些字段。
- en: '**id (Configuration)**'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: '**id（配置）**'
- en: Zones are identified by a number between one and five. The id field is initialized
    when ladd starts, and users cannot edit it. You can use the id field in user interface
    programs to uniquely identify a particular zone.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 区域由一个介于一到五之间的数字标识。id字段在ladd启动时初始化，用户无法编辑它。您可以在用户界面程序中使用id字段来唯一标识特定区域。
- en: '**name (Configuration)**'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: '**name（配置）**'
- en: This field stores the brief mnemonic or name that the user assigns to the zone.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 此字段存储用户分配给区域的简短助记符或名称。
- en: '**enabled (Configuration)**'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '**enabled（配置）**'
- en: Only zones marked *enabled* cause the system to enter an alarm state. Zones
    marked *disabled* do not generate log messages or cause alarm states. This field
    holds an integer instead of a boolean, since RTA does not support a boolean data
    type.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 只有标记为*启用*的区域才会使系统进入警报状态。标记为*禁用*的区域不会生成日志消息或导致警报状态。由于RTA不支持布尔数据类型，此字段包含一个整数而不是布尔值。
- en: '**edge (Configuration)**'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: '**边缘（配置）**'
- en: For the hardware described in the next section, a normally closed sensor triggers
    an alarm on a zero-to-one edge on the input pin. Normally open sensors on Laddie
    trigger an alarm on a one-to-zero edge. “Laddie’s Hardware Design” on page 68
    describes open and closed sensors in more detail.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 对于下一节中描述的硬件，一个常闭传感器在输入引脚的零到一电平跳变上触发警报。Laddie上的常开传感器在一到零电平跳变上触发警报。“第68页的Laddie硬件设计”更详细地描述了开和闭传感器。
- en: '**latching (Configuration)**'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '**latching（配置）**'
- en: The user sets this field to 1 to have an alarm persist even after the sensor
    pin returns to its normal state. The user must manually clear latched alarms.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 用户将此字段设置为1，即使传感器引脚返回到正常状态，警报也会持续存在。用户必须手动清除锁定的警报。
- en: '**input (Status)**'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: '**input（状态）**'
- en: This field shows the most recent raw value of the input pin. This is a status
    field, and the user is not able to edit it.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 此字段显示输入引脚的最新原始值。这是一个状态字段，用户无法编辑它。
- en: '**alarm (Status)**'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '**alarm（状态）**'
- en: Each zone is said to be in either an *alarm* condition or in a *safe* condition.
    This field is set by the ladd daemon in response to detected edges on the input
    pin. A write callback on this field lets a user test a zone by writing a 1 to
    it. An alarm is cleared when the user sets this field to 0.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 每个区域要么处于*警报*状态，要么处于*安全*状态。此字段由ladd守护进程根据检测到的输入引脚上的跳变设置。用户可以通过将此字段写入1来测试区域。当用户将此字段设置为0时，警报被清除。
- en: '**count (Status)**'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '**count（状态）**'
- en: This field contains the number of input edges that have caused an alarm. This
    field is incremented only when the zone is marked *enabled*; it is not incremented
    by user-initiated tests of the zone. This is a readonly, statistic field that
    is set to zero when ladd starts.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 此字段包含导致警报的输入边沿的数量。仅在区域标记为 *启用* 时，此字段才会递增；用户对区域进行的测试不会递增。这是一个只读的统计字段，当 ladd 启动时设置为零。
- en: You may recall that the advantage of RTA is that it gives all of the user interfaces
    the same API for daemon configuration, status, and statistics. The API defined
    by RTA is that of a PostgreSQL database. The advantages of PostgreSQL are that
    SQL is widely used and understood and there are many bindings for PostgreSQL,
    including C, PHP, Java, and Perl. Figure 5-4 illustrates Laddie’s use of RTA to
    allow five different UIs to get status and set configuration using only one daemon-side
    protocol.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能还记得，RTA 的优势在于它为所有用户界面提供了相同的 API 来配置、状态和统计信息。RTA 定义的 API 是 PostgreSQL 数据库。PostgreSQL
    的优势在于 SQL 被广泛使用和理解，并且有大量的 PostgreSQL 绑定，包括 C、PHP、Java 和 Perl。图 5-4 展示了 Laddie
    如何使用 RTA 允许五个不同的用户界面使用单个守护进程协议获取状态和设置配置。
- en: '![](../images/90-1.jpg)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/90-1.jpg)'
- en: '*Figure 5-4: One daemon with many user interfaces*'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 5-4：一个守护进程与多个用户界面*'
- en: Let’s look at the SQL for some typical Laddie configuration changes and queries.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看一些典型的 Laddie 配置更改和查询的 SQL。
- en: 'To disable zone 2, type:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 要禁用区域 2，请输入：
- en: UPDATE Zone SET enabled = 0 WHERE id = 2
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: UPDATE Zone SET enabled = 0 WHERE id = 2
- en: 'To find out how many times zone 4 has gone into alarm, type:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 要找出区域 4 进入警报的次数，请输入：
- en: SELECT count FROM Zone WHERE id = 4
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: SELECT count FROM Zone WHERE id = 4
- en: 'To clear all alarms in the system, type:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 要清除系统中的所有警报，请输入：
- en: UPDATE Zone SET alarm = 0
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: UPDATE Zone SET alarm = 0
- en: Any program that can issue commands like these can function as a user interface
    for Laddie. Watch for commands like these later in the book as we go through the
    five user interfaces currently available for Laddie.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 任何可以发出这些命令的程序都可以作为 Laddie 的用户界面。在本书后面的内容中，我们将通过五个当前可用的 Laddie 用户界面来关注这些命令。
- en: '[***ladd’s Alarm Handling***](toc.html#chapter5.6)'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: '[***ladd 的警报处理***](toc.html#chapter5.6)'
- en: 'ladd responds to an alarm by sending a log message using syslog(). The text
    of the log message depends on whether the alarm was detected by the hardware or
    was a test alarm issued by a user. The text also depends on whether the alarm
    was set or cleared. For a zone with ID *n* and the name *zone_name,* the four
    log messages are:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: ladd 通过使用 syslog() 发送日志消息来响应警报。日志消息的文本取决于警报是由硬件检测到的还是由用户发出的测试警报。文本还取决于警报是设置还是清除。对于
    ID 为 *n* 且名称为 *zone_name* 的区域，四个日志消息如下：
- en: Alarm set on zone *n, zone_name*
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在区域 *n, 区域名称* 上设置警报
- en: Alarm cleared on zone *n, zone_name*
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 区域 *n, 区域名称* 上的警报已清除
- en: User set alarm on zone *n, zone_name*
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户在区域 *n, 区域名称* 上设置警报
- en: User cleared alarm on zone *n, zone_name*
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户已清除区域 *n, 区域名称* 的警报
- en: 'Some users do not care *which* zone is in alarm; they just want to know if
    *any* zone is in alarm. To address this need, ladd provides two other log messages:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 一些用户不关心 *哪个* 区域处于警报状态；他们只想知道是否有 *任何* 区域处于警报状态。为了满足这一需求，ladd 提供了另外两个日志消息：
- en: 'Alarm system status: alarm'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 警报系统状态：警报
- en: 'Alarm system status: safe'
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 警报系统状态：安全
- en: These messages are sent when the first zone goes into alarm and after the last
    zone is cleared. Laddie also sets all four control pins on the parallel port to
    1 (see Table 5-1) to indicate any alarm in the system. It sets the control pins
    low when all alarms are cleared.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 这些消息在第一个区域进入警报和最后一个区域清除后发送。Laddie 还将并行端口上的所有四个控制引脚设置为 1（见表 5-1），以指示系统中的任何警报。当所有警报清除时，它将控制引脚设置为低。
- en: One nice aspect of our overall architecture for Laddie is that ladd itself does
    not need to send signals to the UI, send email, or send SNMP traps. We leave all
    of this to a separate process, greatly simplifying the design and implementation
    of the ladd daemon. (The event processor is described in the next chapter.) Syslog-as-output
    not only simplifies ladd, it makes debug and test easier too since we can easily
    examine the log files for the messages we expect and we can use the logger command
    to generate test events for the event processor. The data flow for an alarm response
    is depicted in Figure 5-5.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 我们为 Laddie 的整体架构提供的一个优点是，ladd 本身不需要向 UI 发送信号、发送电子邮件或发送 SNMP 陷阱。我们将所有这些留给一个单独的过程，极大地简化了
    ladd 守护进程的设计和实现。（事件处理器将在下一章中描述。）Syslog-as-output 不仅简化了 ladd，还使调试和测试更容易，因为我们可以轻松地检查我们期望的消息的日志文件，并且我们可以使用
    logger 命令为事件处理器生成测试事件。警报响应的数据流在图 5-5 中表示。
- en: '![](../images/92-1.jpg)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/92-1.jpg)'
- en: '*Figure 5-5: Processing alarm events in Laddie*'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '*图5-5：在Laddie中处理报警事件*'
- en: '[**Laddie’s Hardware Design**](toc.html#chapter5.7)'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: '[**Laddie的硬件设计**](toc.html#chapter5.7)'
- en: This section presents the hardware needed to use Laddie as a real alarm system.
    You can skip over this section if you are uncomfortable with electronic circuits
    or if you aren’t interested in seeing how the hardware works.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 本节介绍了使用Laddie作为实际报警系统所需的硬件。如果您不熟悉电子电路或对硬件的工作原理不感兴趣，可以跳过本节。
- en: 'The pins on the parallel port are divided into three main groups: data lines,
    control lines, and status lines. Each group is controlled using a register, which
    is available at a particular I/O address. The data lines are at the base address
    of the parallel port, the status lines are at the base address plus one, and the
    control lines are at the base address plus two. Table 5-1 shows how the pins on
    a 25-pin parallel port connector relate to the printer port names, to the port
    registers, and to the alarm system.'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 并行端口上的引脚分为三个主要组：数据线、控制线和状态线。每个组都使用一个寄存器进行控制，该寄存器在特定的I/O地址上可用。数据线位于并行端口的基址，状态线位于基址加一，控制线位于基址加二。表5-1显示了25针并行端口连接器上的引脚与打印机端口名称、端口寄存器和报警系统之间的关系。
- en: '**Table 5-1:** Laddie’s Use of the PC Parallel Port'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '**表5-1：Laddie对PC并行端口的利用**'
- en: '![](../images/92-2.jpg)'
  id: totrans-106
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/92-2.jpg)'
- en: The alarm daemon uses the data lines as output and the status lines as input.
    Figure 5-6 shows a schematic for one alarm sensor. The daemon initializes the
    parallel port by setting the output pins to 0xFF, making pin 2 a high level. When
    the sensor S1 is open, no current flows through the 2K ohm resistor R1, and the
    voltage at pin 15 is pulled high. When the sensor is closed, pin 15 is shorted
    to ground through pin 21.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 报警守护进程使用数据线作为输出，状态线作为输入。图5-6显示了一个报警传感器的电路图。守护进程通过将输出引脚设置为0xFF，使引脚2处于高电平来初始化并行端口。当传感器S1打开时，没有电流通过2K欧姆电阻R1，引脚15的电压被拉高。当传感器关闭时，引脚15通过引脚21短路到地。
- en: In other words, pin 15 is biased high when the alarm sensor is open and pulled
    low when the sensor is closed. By reading the status lines, which includes pin
    15, the daemon can detect whether the sensor is open or closed. This description
    applies to all five of the status inputs on the parallel port.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 换句话说，当报警传感器打开时，引脚15被偏置为高电平，当传感器关闭时被拉低。通过读取包括引脚15在内的状态线，守护进程可以检测传感器是打开还是关闭。此描述适用于并行端口上的所有五个状态输入。
- en: '![](../images/93-1.jpg)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/93-1.jpg)'
- en: '*Figure 5-6: A normally open alarm sensor from Laddie*'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: '*图5-6：Laddie的正常开路报警传感器*'
- en: '[**Laddie’s Software Design**](toc.html#chapter5.8)'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '[**Laddie的软件设计**](toc.html#chapter5.8)'
- en: 'We used the empty daemon introduced in Chapter 4 to build the ladd daemon.
    But whether we used the empty daemon, wrote a select()-based program, or wrote
    a threads-based program, there would still be three main subroutines:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用第4章中介绍的空守护进程构建了ladd守护进程。但无论我们使用空守护进程、编写基于select()的程序，还是编写基于线程的程序，都会有三个主要子例程：
- en: '**appInit()** Initialize hardware. Start timer. Register the Zone table with
    RTA.'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: '**appInit()** 初始化硬件。启动定时器。将Zone表注册到RTA。'
- en: '**poll_timeout()** Read the status lines. Log relevant changes.'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: '**poll_timeout()** 读取状态线。记录相关更改。'
- en: '**user_update()** Send logs for user changes to the alarm status.'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: '**user_update()** 向报警状态发送用户更改的日志。'
- en: These routines are described in more detail in the next few sections.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 这些例程将在接下来的几节中详细描述。
- en: '[***The appInit() Callback Subroutine***](toc.html#chapter5.9)'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: '[***appInit()回调子例程***](toc.html#chapter5.9)'
- en: The appInit() subroutine is the first callback subroutine the empty daemon invokes.
    This callback subroutine is responsible for performing any application-specific
    initialization, setting up any timer callback subroutines, and registering any
    RTA tables. In ladd, the appInit() subroutine initializes the Zone array of ZONE
    structures, calls rta_add_table() to register the Zone table with RTA, initializes
    the parallel port, and starts a periodic 100-millisecond timer with poll_timeout()
    as its callback subroutine. Note that once the appInit() subroutine returns, the
    daemon is ready to accept connections from the user interfaces.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: appInit()子例程是空守护进程调用的第一个回调子例程。此回调子例程负责执行任何应用程序特定的初始化，设置任何定时器回调子例程，并注册任何RTA表。在ladd中，appInit()子例程初始化ZONE结构的Zone数组，调用rta_add_table()将Zone表注册到RTA，初始化并行端口，并使用poll_timeout()作为其回调子例程启动一个周期为100毫秒的定时器。请注意，一旦appInit()子例程返回，守护进程就准备好接受用户界面的连接。
- en: Although the COLDEFs or TBLDEF for the Zone array are not shown, Table 5-2 should
    give you an idea of what they contain.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然没有显示 Zone 数组的 COLDEFs 或 TBLDEF，但表 5-2 应该能让你了解它们包含的内容。
- en: '**Table 5-2:** The Columns in Laddie’s Zone Table'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: '**表 5-2:** Laddie 区域表的列'
- en: '![](../images/94-1.jpg)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/94-1.jpg)'
- en: All of the initialization code for ladd is in the appInit() routine given below.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: ladd 的所有初始化代码都在下面的 appInit() 例程中。
- en: '![](../images/94-2.jpg)'
  id: totrans-123
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/94-2.jpg)'
- en: '![](../images/95-1.jpg)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/95-1.jpg)'
- en: '[***The poll_timeout() Callback Subroutine***](toc.html#chapter5.10)'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: '[***poll_timeout() 回调子例程***](toc.html#chapter5.10)'
- en: The poll_timeout() subroutine performs the bulk of the alarm daemon’s functions.
    This subroutine reads the parallel port, processes the input pins, and modifies
    the state of the appropriate ZONE data structure. This subroutine is invoked every
    100 milliseconds, as specified by the call to add_timer(). Note the following
    salient features of the poll_timeout() subroutine.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: poll_timeout() 子例程执行警报守护进程的大部分功能。此子例程读取并行端口，处理输入引脚，并修改适当的 ZONE 数据结构的状态。此子例程每
    100 毫秒被调用一次，如 add_timer() 调用所指定。注意 poll_timeout() 子例程的以下显著特征。
- en: The main responsibility of poll_timeout() is to set the alarm field for each
    zone in the Zone table. As mentioned above, the alarm field shows whether or not
    a particular zone is in an alarm condition.
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: poll_timeout() 的主要责任是设置 Zone 表中每个区域的警报字段。如上所述，警报字段显示特定区域是否处于警报状态。
- en: The subroutine treats each zone independently of the other zones. That is, one
    zone can be in alarm condition while another is in the safe condition.
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 该子例程独立于其他区域处理每个区域。也就是说，一个区域可以处于警报状态，而另一个区域处于安全状态。
- en: The alarm field for a particular zone is modified only if the enabled field
    is nonzero. This feature allows a user to disable a zone in cases where there
    is either no sensor or where the user wishes to ignore a sensor.
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 只有当启用字段非零时，才会修改特定区域的警报字段。此功能允许用户在没有任何传感器或用户希望忽略传感器的情况下禁用区域。
- en: When poll_timeout() detects that the zone has entered the alarm condition, it
    sets the alarm field to 1 and sends a syslog message. In a later chapter, we’ll
    show you how to convert syslog messages into email and SNMP traps.
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当 poll_timeout() 检测到区域进入警报状态时，它将警报字段设置为 1 并发送一个 syslog 消息。在后面的章节中，我们将向您展示如何将
    syslog 消息转换为电子邮件和 SNMP 陷阱。
- en: Similarly, when this subroutine detects that the input pin transitions back
    to the normal state, it clears the alarm variable, and, if the latching field
    is set to zero, it sends a syslog message. This mechanism allows the user to configure
    a zone so that once it enters the alarm condition, it must be cleared manually.
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 类似地，当此子例程检测到输入引脚返回到正常状态时，它清除警报变量，如果滞后字段设置为 0，则发送一个 syslog 消息。这种机制允许用户配置区域，一旦进入警报状态，就必须手动清除。
- en: The poll_alarm() subroutine also maintains a global alarm variable, GlobalAlarm,
    which is set to one if any zone is in alarm condition and is set to zero if all
    zones are safe. The subroutine tracks when this GlobalAlarm variable changes states.
    When the GlobalAlarm variable is set, the control pins of the parallel port are
    set high. When the GlobalAlarm variable changes state, then an appropriate syslog
    message is sent.
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: poll_alarm() 子例程还维护一个全局警报变量 GlobalAlarm，如果任何区域处于警报状态，则将其设置为 1，如果所有区域都安全，则将其设置为
    0。该子例程跟踪 GlobalAlarm 变量状态的变化。当 GlobalAlarm 变量被设置时，并行端口的控制引脚被设置为高电平。当 GlobalAlarm
    变量状态改变时，则发送一个适当的 syslog 消息。
- en: All of the polling for new alarms is done in the poll_timeout() routine given
    below.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 所有新的警报轮询都在下面的 poll_timeout() 例程中完成。
- en: '![](../images/96-1.jpg)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/96-1.jpg)'
- en: '![](../images/96-2.jpg)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/96-2.jpg)'
- en: '![](../images/97-1.jpg)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/97-1.jpg)'
- en: '[***The user_update() Callback Subroutine***](toc.html#chapter5.11)'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: '[***用户更新() 回调子例程***](toc.html#chapter5.11)'
- en: The user_update() callback subroutine is invoked whenever the user manually
    modifies the alarm field in a ZONE data structure. This callback subroutine is
    responsible for sending a syslog message whenever the user manually clears the
    alarm condition (for latched zones) or manually sets the alarm condition. In Chapter
    7, we’ll show you how to use the syslog message to update the user interfaces.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户手动修改 ZONE 数据结构中的警报字段时，将调用 user_update() 回调子例程。此回调子例程负责在用户手动清除（对于滞后区域）或手动设置警报状态时发送一个
    syslog 消息。在第 7 章中，我们将向您展示如何使用 syslog 消息更新用户界面。
- en: This callback subroutine is included in the RTA COLDEF structure for our alarm
    daemon. Take a look at the snippet of source code below, and you’ll see that the
    user_update subroutine is included in the write callback entry. The user_update
    subroutine is invoked whenever the user writes to the alarm variable in a ZONE
    data structure.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 这个回调子例程包含在我们的警报守护进程的RTA COLDEF结构中。看看下面的源代码片段，你会看到user_update子例程包含在写入回调条目中。每当用户在区域数据结构中写入警报变量时，user_update子例程就会被调用。
- en: '![](../images/97-2.jpg)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/97-2.jpg)'
- en: The user_update() subroutine shown below checks to see if a user has set the
    alarm variable and caused it to change. If the alarm variable has changed, the
    user_update() subroutine writes a syslog message.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的user_update()子例程检查是否有用户设置了警报变量并导致其改变。如果警报变量已更改，user_update()子例程将写入syslog消息。
- en: '![](../images/98-1.jpg)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/98-1.jpg)'
- en: In the last two sections, we showed you the alarm daemon source code and explained
    how the source code works. Did you notice how easy it was to implement the alarm
    daemon? The next section shows you how to build and test the alarm daemon.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 在最后两个部分中，我们向您展示了警报守护进程的源代码，并解释了源代码是如何工作的。您注意到实现警报守护进程有多容易吗？下一节将向您展示如何构建和测试警报守护进程。
- en: '[**Building and Testing ladd**](toc.html#chapter5.12)'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: '[**构建和测试ladd**](toc.html#chapter5.12)'
- en: 'You don’t need to install a whole set of alarm sensors to run this daemon—all
    you need is a standard PC with a parallel port. Before running the daemon, you
    must create the directory /opt/laddie/ladd/, because the alarm daemon creates
    a PID file in this directory. Use these commands to create this directory as root:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 你不需要安装一套完整的警报传感器来运行这个守护进程——你只需要一个带有并行端口的普通PC。在运行守护进程之前，你必须创建目录/opt/laddie/ladd/，因为警报守护进程会在这个目录中创建一个PID文件。使用以下命令以root用户创建此目录：
- en: mkdir /opt/laddie/ladd
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: mkdir /opt/laddie/ladd
- en: 'The source code for ladd is on the companion CD in /Code/src/ladd. Compile
    the alarm daemon and then run the daemon as root, as shown in the following commands:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: ladd的源代码位于配套CD上的/Code/src/ladd目录中。编译警报守护进程，然后以root用户身份运行守护进程，如下所示：
- en: cd /Code/src/ladd
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: cd /Code/src/ladd
- en: make
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: make
- en: su
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: su
- en: ./ladd
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: ./ladd
- en: To make sure that the alarm daemon is running and responding to user requests,
    invoke the psql SQL command shown below, and verify that the Zone table is displayed.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 为了确保警报守护进程正在运行并响应用户请求，调用以下psql SQL命令，并验证区域表是否显示。
- en: '![](../images/99-1.jpg)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/99-1.jpg)'
- en: Typically, you would add hardware sensors to your alarm appliance, but you can
    simulate an alarm without the hardware sensors.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，你会在警报设备上添加硬件传感器，但你也可以在没有硬件传感器的情况下模拟警报。
- en: 'Consider zone 1\. Our approach is to invoke the alarm write callback using
    this command:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑区域1。我们的方法是使用以下命令调用警报写入回调：
- en: UPDATE Zone SET name = "BackDoor", enabled=1, edge=0, WHERE id=1;
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: UPDATE Zone SET name = "BackDoor", enabled=1, edge=0, WHERE id=1;
- en: 'Next, we’ll simulate an alarm on the input of zone 1 with the following command:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将使用以下命令在区域1的输入上模拟警报：
- en: UPDATE Zone SET alarm=1 WHERE id=1;
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: UPDATE Zone SET alarm=1 WHERE id=1;
- en: 'Verify that ladd generated a log saying *User set alarm on zone 1.* Then manually
    clear the alarm, as such:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 验证ladd是否生成了一个日志消息，表明*用户在区域1上设置了警报*。然后手动清除警报，如下所示：
- en: UPDATE Zone SET alarm=0 WHERE id=1;
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: UPDATE Zone SET alarm=0 WHERE id=1;
- en: Again verify that ladd generates a message for syslog. We’ll show you how to
    build more accessible user interfaces to the alarm daemon in future chapters.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 再次验证ladd是否为syslog生成了消息。我们将在未来的章节中向您展示如何构建更易于访问的警报守护进程用户界面。
- en: '[**Summary**](toc.html#chapter5.13)'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: '[**总结**](toc.html#chapter5.13)'
- en: This chapter tied the previous chapters together by showing you how to build
    ladd, a simple alarm daemon, using RTA and the empty daemon. You saw the design
    of ladd’s RTA table, the control point by which the user interfaces manage the
    alarm daemon. You also saw the alarm daemon’s source code, including the three
    subroutines used by the empty daemon to implement the alarm daemon’s run-time
    behavior. Finally, you saw how to configure the alarm daemon and how to manually
    set and clear an alarm from the command line.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 本章通过向您展示如何使用RTA和空守护进程构建简单的警报守护进程ladd，将前几章的内容串联起来。您看到了ladd的RTA表的设计，这是用户界面管理警报守护进程的控制点。您还看到了警报守护进程的源代码，包括空守护进程用来实现警报守护进程运行时行为的三个子例程。最后，您还看到了如何配置警报守护进程，以及如何从命令行手动设置和清除警报。
- en: The next chapter continues to develop Laddie’s design by showing you how to
    handle events on an appliance, including events such as ladd sending messages
    to syslog.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 下一章将继续发展 Laddie 的设计，通过向您展示如何处理设备上的事件，包括例如 ladd 向 syslog 发送消息的事件。
- en: __________________
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: __________________
- en: ¹ Laddie is a sample appliance used to illustrate the techniques and software
    presented in this book. Laddie is *not* a commercially viable alarm system and
    should never be used in place of a real alarm system.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: ¹ Laddie 是一种示例设备，用于说明本书中介绍的技术和软件。Laddie **并非**一种商业可行的报警系统，并且绝不应该用来替代真正的报警系统。
