- en: '![](../images/247-1.jpg)'
  id: totrans-0
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/247-1.jpg)'
- en: '[**HANDS-ON INTRODUCTION TO SNMP**](toc.html#chapter13)'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '[**SNMP实践入门**](toc.html#chapter13)'
- en: '![](../images/as.jpg)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/as.jpg)'
- en: We like to say that the difference between a hobby and a commercial network
    appliance is SNMP. Any corporation with a large network will use Simple Network
    Management Protocol (SNMP) as part of its network- and system-management solution.
    You simply cannot sell into the large enterprise and telecommunications carrier
    markets without SNMP support on your appliance.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 我们常说，业余爱好和商业网络设备之间的区别在于SNMP。任何拥有大型网络的公司都会使用简单网络管理协议（SNMP）作为其网络和系统管理解决方案的一部分。没有你的设备上提供SNMP支持，你根本无法进入大型企业和电信运营商市场。
- en: If your target market includes companies with large networks and you are not
    confident in your knowledge of SNMP, this chapter is for you. If, however, you
    will be targeting the home or small business market (or your appliance will not
    be networked at all), you can safely skip this and the SNMP chapters that follow.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的目标市场包括拥有大型网络的公司，而你对自己的SNMP知识不够自信，那么这一章节就是为你准备的。然而，如果你将针对家庭或小型商业市场（或者你的设备根本不联网），你可以安全地跳过这一章以及随后的SNMP章节。
- en: 'This chapter will introduce SNMP and provide you with an appreciation of some
    of the things SNMP can do. The topics covered in this chapter are:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将介绍SNMP，并使您了解SNMP能做的一些事情。本章涵盖的主题包括：
- en: A brief introduction to SNMP terminology
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SNMP术语简介
- en: Finding the software
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查找软件
- en: Installing the software
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装软件
- en: Starting the agent
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启动代理
- en: Exploring with SNMP
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用SNMP进行探索
- en: Writing values with SNMP
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用SNMP写入值
- en: SNMP traps
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SNMP陷阱
- en: '[**A Quick Note on Terminology**](toc.html#chapter13.1)'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '[**术语快速说明**](toc.html#chapter13.1)'
- en: Here is a quick tour of the most basic concepts and terms you will need in order
    to understand the material in this chapter. For a complete introduction to SNMP
    concepts and terminology, see Appendix B.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是对您理解本章内容所需的最基本概念和术语的快速浏览。要了解SNMP概念和术语的完整介绍，请参阅附录B。
- en: '*SNMP is* a protocol designed to facilitate the reading and writing of small
    amounts of information over a network, like single numbers and character strings.
    You would not use SNMP for large volumes of data, like file transfer.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '*SNMP*是一种设计用于在网络中读取和写入少量信息的协议，如单个数字和字符串。你不会使用SNMP进行大量数据，如文件传输。'
- en: A read operation in SNMP is called a GET, while a write is called a SET. The
    target of a SET or GET operation is called an object. An *object* is like a field
    in a database record.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 在SNMP中，读操作称为GET，而写操作称为SET。SET或GET操作的目标称为对象。*对象*就像数据库记录中的一个字段。
- en: SNMP treats objects as if they were organized into a single large database called
    the *Management Information Base (MIB).* It may be helpful to think of SNMP as
    an API to the information on a device. It hides the details of object retrieval
    beneath an organized hierarchical namespace. An SNMP agent on each system provides
    this API. The *agent is* a background (daemon) process listening for SNMP requests
    on UDP port 161\. Beneath the API, the agent may interact with the kernel or some
    application process running on the system; it may also read several pieces of
    information from different sources and apply a mathematical formula to furnish
    the value defined in a MIB. An object in the MIB may also represent functionality
    rather than data; for example, setting a MIB object to a particular value might
    trigger a reboot or the restarting of a service.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: SNMP将对象视为组织在一个称为*管理信息库（MIB）*的单个大数据库中。将SNMP视为设备信息的API可能有所帮助。它隐藏了对象检索的细节，并在一个有组织的分层命名空间下。每个系统上的SNMP代理提供这个API。*代理*是一个在后台（守护进程）中监听UDP端口161上的SNMP请求的过程。在API之下，代理可能与内核或系统上运行的某些应用程序进程交互；它也可能从不同的来源读取几条信息，并应用数学公式来提供MIB中定义的值。MIB中的对象也可能代表功能而不是数据；例如，将MIB对象设置为特定值可能会触发重启或服务的重新启动。
- en: 'The MIB hierarchical namespace is much like the Unix filesystem, but it uses
    numbers instead of directory and filenames, and it uses the . character instead
    of the / directory separator. So, whereas a file path may look like this:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: MIB分层命名空间与Unix文件系统非常相似，但它使用数字而不是目录和文件名，并使用.字符而不是/目录分隔符。因此，文件路径可能看起来像这样：
- en: /usr/sbin/ifconfig
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/ifconfig
- en: 'the name (called an *Object Identifier,* or *OID)* for an object in the MIB
    might look like this:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: MIB中对象的名称（称为*对象标识符*，或*OID*）可能看起来像这样：
- en: .1.3.6.1.2.1.1.1
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: .1.3.6.1.2.1.1.1
- en: MIB files describe portions of the complete MIB database. Typically, each MIB
    file describes a *MIB module,* which is a subtree of the overall database. MIB
    files are both human readable and program readable. They document the MIB for
    humans, and they provide a means for programs to translate between these number
    strings and their human-readable names. Although we have talked about *the MIB*
    as the SNMP-addressable universe, the more common use of the term *MIB* is for
    one of these named subtrees. For example, you will hear talk of the *Host Resources
    MIB,* or the *HP Printer MIB,* or *MIB-2.* These are all subtrees, but they are
    also all addressable within the overall namespace.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: MIB 文件描述了完整的 MIB 数据库的部分内容。通常，每个 MIB 文件描述一个 *MIB 模块*，它是整体数据库的一个子树。MIB 文件既可由人类阅读，也可由程序阅读。它们为人类记录了
    MIB，并为程序提供了一种在数字字符串和人类可读名称之间进行转换的手段。尽管我们谈论 *MIB* 时指的是可由 SNMP 地址访问的宇宙，但 *MIB* 这个术语更常见的用法是指这些命名子树中的一个。例如，你可能会听到关于
    *主机资源 MIB*、*HP 打印机 MIB* 或 *MIB-2* 的讨论。这些都是子树，但它们都在整体命名空间内可寻址。
- en: First and foremost among MIBs is the cryptically named *MIB-II.* When SNMP was
    first created, the SNMP working group of the IETF defined a core set of information.
    This was the first MIB, or *MIB-I.* A few years later, the SNMP WG revised this
    core set and it became *MIB-II.* We use *MIB-2,* rather than MIB-II, in this chapter
    to match the name used in the MIB file that defines this MIB.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在所有 MIB 中，最著名的是名为 *MIB-II* 的神秘名称。当 SNMP 首次创建时，IETF 的 SNMP 工作组定义了一组核心信息。这是第一个
    MIB，或称 *MIB-I*。几年后，SNMP 工作组修订了这个核心集，它变成了 *MIB-II*。我们在这个章节中使用 *MIB-2*，而不是 MIB-II，以匹配定义此
    MIB 的 MIB 文件中使用的名称。
- en: 'Once you have the right MIB files installed (you’ll see how to do this later),
    you can use the snmptranslate command to give you the human-readable names for
    a numeric ID (more on this later, too). For example:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦安装了正确的 MIB 文件（你稍后会看到如何做这件事），你就可以使用 snmptranslate 命令来为数字 ID 提供人类可读的名称（关于这一点稍后还会详细介绍）。例如：
- en: $snmptranslate -Of .1.3.6.1.2.1.1.1
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: $snmptranslate -Of .1.3.6.1.2.1.1.1
- en: .iso.org.dod.internet.mgmt.mib-2.system.sysDescr
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: .iso.org.dod.internet.mgmt.mib-2.system.sysDescr
- en: $
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: $
- en: This should be enough terminology to get started.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 这应该足够你开始学习了。
- en: '[**The Software**](toc.html#chapter13.2)'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: '[**软件**](toc.html#chapter13.2)'
- en: The Net-SNMP is an excellent free package containing all you’ll need to follow
    along in this chapter. Net-SNMP will provide you with commands (snmpget, snmpset,
    snmpwalk, snmptrap), an SNMP agent, and the standard MIB files. Normally, the
    commands and agent would be running on different systems, but for simplicity you’ll
    be running both on the same system. If you have two systems available, you can
    perform the full installation on both systems; then you can run snmpget, for example,
    on one system, and talk to the agent on the other. If you use two systems, remember
    to change all instances of localhost or 127.0.0.1 in this chapter’s code to the
    name or address of the system running the SNMP agent.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: Net-SNMP 是一个优秀的免费软件包，包含了你在本章中需要的一切。Net-SNMP 将为你提供命令（snmpget、snmpset、snmpwalk、snmptrap）、一个
    SNMP 代理和标准 MIB 文件。通常，命令和代理会在不同的系统上运行，但为了简单起见，你将在同一系统上运行它们。如果你有两个系统可用，你可以在两个系统上执行完整的安装；然后你可以在一个系统上运行
    snmpget，例如，并在另一个系统上与代理通信。如果你使用两个系统，请记住在本章代码中更改所有 localhost 或 127.0.0.1 的实例，以匹配运行
    SNMP 代理的系统名称或地址。
- en: '[**Installing SNMP**](toc.html#chapter13.3)'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: '[**安装 SNMP**](toc.html#chapter13.3)'
- en: Before installing, check to see if Net-SNMP is already installed on your system—many
    common Linux distributions provide some version of it. If you have a very old
    Linux distribution (like Red Hat 7.*x*) you may find UCD-SNMP instead; this is
    an older version—or parent—of Net-SNMP. Although its behavior is very similar
    to that of Net-SNMP, there are enough differences to confuse someone trying to
    follow this tutorial; you should remove it, and follow the instructions here to
    install Net-SNMP. If you find some other package installed, definitely remove
    it before continuing.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 在安装之前，检查你的系统上是否已经安装了 Net-SNMP——许多常见的 Linux 发行版都提供了一些版本的 Net-SNMP。如果你有一个非常旧的
    Linux 发行版（如 Red Hat 7.*x*），你可能会发现 UCD-SNMP；这是 Net-SNMP 的一个较旧版本或父版本。尽管它的行为与 Net-SNMP
    非常相似，但差异足以让试图遵循本教程的人感到困惑；你应该将其删除，并按照这里的说明安装 Net-SNMP。如果你发现安装了其他包，在继续之前一定要将其删除。
- en: Even if Net-SNMP is not currently installed on your system, it may be packaged
    with your Linux distribution, so check your CDs. Be aware, though, that various
    Linux distributions may have modified Net-SNMP to comply with their own ideas
    of default file locations and it may include different patches. Naturally, the
    closer your version of Net-SNMP is to the one used in this chapter (version 5.2.1),
    the closer your results will be to the ones shown here.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 即使 Net-SNMP 目前没有安装在你的系统上，它可能包含在你的 Linux 发行版中，所以检查你的光盘。不过，请注意，不同的 Linux 发行版可能已经修改了
    Net-SNMP 以符合它们自己对默认文件位置的看法，并且可能包含不同的补丁。自然地，你的 Net-SNMP 版本越接近本章中使用的版本（版本 5.2.1），你的结果就越接近这里显示的结果。
- en: '[***Download and Install***](toc.html#chapter13.4)'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: '[***下载和安装***](toc.html#chapter13.4)'
- en: If Net-SNMP is not included with your Linux distribution, you can download it
    from [http://net-snmp.sourceforge.net](http://net-snmp.sourceforge.net/). You
    can install either from RPM (assuming you are running an RPM-based distribution
    like Fedora) or source, but for now let’s install the binary RPM. (By the way,
    if rpm complains about missing dependencies, you may have to take care of them
    first and then retry this command.)
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 Net-SNMP 没有包含在你的 Linux 发行版中，你可以从 [http://net-snmp.sourceforge.net](http://net-snmp.sourceforge.net/)
    下载它。你可以从 RPM（假设你正在运行基于 RPM 的发行版，如 Fedora）或源代码安装，但为了现在，让我们安装二进制的 RPM。顺便说一句，如果 rpm
    抱怨缺少依赖项，你可能必须先处理它们，然后重试此命令。)
- en: '![](../images/250-1.jpg)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/250-1.jpg)'
- en: '[***Check the Installation***](toc.html#chapter13.5)'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: '[***检查安装***](toc.html#chapter13.5)'
- en: Now test that it worked. First, test the agent.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 现在测试它是否工作。首先，测试代理。
- en: '![](../images/250-2.jpg)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/250-2.jpg)'
- en: Now check the tools. Use which to find out where they were installed, then list
    all the commands in that directory that start with *snmp*.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 现在检查工具。使用哪个工具来找出它们安装的位置，然后列出该目录中以 *snmp* 开头的所有命令。
- en: '![](../images/250-3.jpg)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/250-3.jpg)'
- en: We’ll only use a handful of these commands, but feel free to explore others
    once you’ve mastered the basics.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 我们只会使用其中的一小部分命令，但一旦你掌握了基础知识，你可以自由探索其他命令。
- en: Now let’s check the version to make sure it is what we just installed and not
    some older version that’s lurking on your path.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们检查版本，以确保它是我们刚刚安装的版本，而不是潜伏在你路径上的某个旧版本。
- en: $ snmpwalk --version
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: $ snmpwalk --version
- en: 'NET-SNMP version: 5.2.1'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: NET-SNMP 版本：5.2.1
- en: $
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: $
- en: '[***Configure the Agent***](toc.html#chapter13.6)'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '[***配置代理***](toc.html#chapter13.6)'
- en: So far, so good—you have the client-side programs. Now you need to get the agent
    running so these programs have something to query.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，一切顺利——你已经有了客户端程序。现在你需要让代理程序运行，这样这些程序才有东西可以查询。
- en: The agent runs as a daemon and listens for incoming SNMP requests on UDP port
    161, by default. It requires some configuration information that it normally picks
    up from the file snmpd.conf in the directory /etc/snmp. (Note the *d* in snmpd.conf;
    it indicates *daemon*—our agent. Do not confuse this with snmp.conf, which we
    will introduce later on.) Snmpd.conf tells the agent how to authenticate incoming
    requests, where to send traps (which are SNMP alarm notifications), and so forth.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 代理程序作为守护进程运行，默认情况下监听 UDP 端口 161 上的传入 SNMP 请求。它需要一些配置信息，它通常从 /etc/snmp 目录中的 snmpd.conf
    文件中获取。（注意 snmpd.conf 中的 *d*；它表示 *daemon*——我们的代理。不要与稍后将要介绍的 snmp.conf 混淆。）Snmpd.conf
    告诉代理如何验证传入的请求，将陷阱（SNMP 报警通知）发送到何处，等等。
- en: 'Net-SNMP provides a program called snmpconf that generates the snmpd.conf file
    from the answers to a series of questions, but because your needs here are pretty
    simple, you can generate the configuration by hand. Your snmpd.conf file should
    contain:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: Net-SNMP 提供了一个名为 snmpconf 的程序，它可以从一系列问题的答案中生成 snmpd.conf 文件，但由于你的需求非常简单，你可以手动生成配置。你的
    snmpd.conf 文件应包含：
- en: '![](../images/251-1.jpg)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/251-1.jpg)'
- en: The rocommunity macro sets your read-only community string, which for now you
    can think of as something like a password. Net-SNMP gives you much more precise
    access control than this, but that’s beyond our needs right now.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: rocommunity 宏设置你的只读共同体字符串，现在你可以将其视为类似密码的东西。Net-SNMP 提供比这更精确的访问控制，但这超出了我们现在的需求。
- en: The syslocation and syscontact lines set the values for the sysLocation and
    sysContact objects in the MIB-2 system group. When you are managing only a small
    set of systems all in one location, this information may not be very interesting,
    but in a large corporate network with multiple sites, it may be invaluable to
    know how to locate a system and find out who is in charge of it. (A little later
    in this chapter, you’ll see how to access this information across the network
    with SNMP queries.)
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: syslocation和syscontact行设置了MIB-2系统组中sysLocation和sysContact对象的值。当您只管理位于同一位置的一小套系统时，这些信息可能并不很有趣，但在拥有多个站点的庞大企业网络中，了解如何定位系统以及找出谁负责它可能非常有价值。（在本章稍后，您将看到如何使用SNMP查询通过网络访问此信息。）
- en: Place this snmpd.conf file into the /etc/snmp directory. The three lines above
    are all you’ll need to get started.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 将此snmpd.conf文件放入/etc/snmp目录。上面的三行就是您开始所需的所有内容。
- en: '[***Start the Agent***](toc.html#chapter13.7)'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: '[***启动代理**](toc.html#chapter13.7)'
- en: 'Start the agent, and put it into the background. The agent listens on port
    161, so you’ll need to be logged in as root to issue this command:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 启动代理，并将其放入后台。代理监听端口161，因此您需要以root身份登录才能执行此命令：
- en: /usr/sbin/snmpd -c /etc/snmp/snmpd.conf -C &
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/snmpd -c /etc/snmp/snmpd.conf -C &
- en: The -c /etc/snmp/snmpd.conf tells the agent to use the given configuration file,
    and -C tells the agent to use only this configuration file.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: -c /etc/snmp/snmpd.conf告诉代理使用给定的配置文件，而-C告诉代理只使用此配置文件。
- en: For now, you can just type the above command (as root), but on your appliance
    you’ll want the SNMP agent to start up with the system.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您只需输入上述命令（作为root），但在您的设备上，您希望SNMP代理与系统一起启动。
- en: '[**Exploring with SNMP**](toc.html#chapter13.8)'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '[**使用SNMP探索**](toc.html#chapter13.8)'
- en: Now let’s turn our attention to the client side. The commands snmpget, snmpwalk,
    and snmpset are all SNMP client commands, or *SNMP management applications,* in
    SNMP-speak. SNMP uses the term *manager* or *management application* for the client
    side and *agent* for the server side. The agent serves up the data on the appliance,
    and the SNMP manager is the client requesting the appliance’s information. You
    won’t need to be logged in as root to use these client commands.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们将注意力转向客户端。snmpget、snmpwalk和snmpset都是SNMP客户端命令，或者称为*SNMP管理应用程序*。在SNMP术语中，*管理器*或*管理应用程序*用于客户端，而*代理*用于服务器端。代理在设备上提供数据，而SNMP管理器是请求设备信息的客户端。您不需要以root身份登录即可使用这些客户端命令。
- en: Let’s use snmpget to test our agent install.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们使用snmpget来测试我们的代理安装。
- en: $ snmpget -v2c -c public localhost sysLocation.0
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: $ snmpget -v2c -c public localhost sysLocation.0
- en: 'SNMPv2-MIB::sysLocation.0 = STRING: "my den"³'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 'SNMPv2-MIB::sysLocation.0 = STRING: "my den"³'
- en: $
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: $
- en: You’ve told snmpget to use SNMPv2c (community-based SNMP version 2) and the
    community string public to send a query to the local machine asking for the value
    of the sysLocation variable, which you configured in your snmpd.conf file. The
    .0 appended to the sysLocation name is SNMP’s way of indicating that you want
    the *instance* of this variable. In object-oriented language, think of sysLocation
    as a class that has one instance. If this were an array (table) of locations,
    the .0 would be replaced by the row number of the variable (.1, .2, .3, and so
    on). Row numbers always start with 1, so there is no confusion between a row index
    and a scalar indicator.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 您已告诉snmpget使用SNMPv2c（基于社区的SNMP版本2）和社区字符串public向本地机器发送查询，请求sysLocation变量的值，该值您已在snmpd.conf文件中配置。sysLocation名称后附加的.0是SNMP表示您想要此变量的*实例*的方式。在面向对象的语言中，将sysLocation视为一个只有一个实例的类。如果这是一个位置（表）数组，则.0将被变量的行号（.1、.2、.3等）替换。行号始终从1开始，因此行索引和标量指示器之间不会混淆。
- en: You need to tell the snmpget command to use SNMPv2c, because it defaults to
    SNMPv3; you can change that by generating an snmp.conf file with a different default.
    You could use snmpconf to generate the file, this time selecting snmp.conf (no
    *d)*, but you can also just create the snmp.conf file by hand with this single
    command (run as root).
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要告诉snmpget命令使用SNMPv2c，因为它默认为SNMPv3；您可以通过生成具有不同默认值的snmp.conf文件来更改它。您可以使用snmpconf生成文件，这次选择snmp.conf（没有*d），但您也可以通过以下单个命令（以root身份运行）手动创建snmp.conf文件。
- en: echo "defversion 2c" > /etc/snmp/snmp.conf
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: echo "defversion 2c" > /etc/snmp/snmp.conf
- en: Now you can stop typing the -v2c with each command.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你可以停止在每个命令中输入-v2c了。
- en: 'If you have access to any other networked devices, you might try querying them.
    For example, here’s the snmpwalk command run against an Apple AirPort Base Station:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你可以访问任何其他网络设备，你可以尝试查询它们。例如，这里是对Apple AirPort基站运行的snmpwalk命令：
- en: '![](../images/253-1.jpg)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/253-1.jpg)'
- en: Clearly, the device’s sysDescr.0 (system description) identifies this as an
    Apple Base Station. You’ll also recognize the sysLocation and sysContact information
    for this device. This device doesn’t offer up a lot of information, but there
    is enough to identify what it is, where it is, and who to contact about any issues
    you have with this box, should you discover that it’s misbehaving. Of course,
    the availability of the system contact and location both rely on the administrator
    of that system, who is configuring these values on the target device. An inattentive
    system administrator may leave you little to work with.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，设备的sysDescr.0（系统描述）将其识别为Apple基站。你也会认出这个设备的sysLocation和sysContact信息。这个设备提供的信息不多，但足以确定它是什么，在哪里，以及如果你发现它表现不佳，应该联系谁。当然，系统联系人和位置的可用性都依赖于该系统的管理员，他们会在目标设备上配置这些值。一个粗心的系统管理员可能让你没有太多可以工作的。
- en: Notice that for this query we used snmpwalk instead of snmpget because we wanted
    to see what other information might be furnished by this device. The snmpget command
    retrieves a single object instance using an SNMP GET protocol data unit, while
    snmpwalk uses multiple SNMP GETNEXT PDUs to “walk” an entire MIB. You pick a starting
    point, and snmpwalk asks for the lexically next object instance; the agent returns
    that object and its OID, and snmpwalk asks for the next object instance after
    the new OID. Eventually, the agent responds that there is nothing more to return,
    and the walk terminates.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，对于这个查询，我们使用了snmpwalk而不是snmpget，因为我们想看看这个设备可能提供哪些其他信息。snmpget命令使用SNMP GET协议数据单元检索单个对象实例，而snmpwalk使用多个SNMP
    GETNEXT PDUs来“遍历”整个MIB。你选择一个起点，snmpwalk会请求下一个对象实例；代理返回该对象及其OID，然后snmpwalk会请求新OID之后的下一个对象实例。最终，代理会响应说没有更多可以返回的信息，遍历结束。
- en: '[***MIB Files for Readable Names***](toc.html#chapter13.9)'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '[***可读名称的MIB文件***](toc.html#chapter13.9)'
- en: 'The display of nice, readable names for OIDs—like *sysDescr* and *sysLocation*—depends
    on having the right MIB files registered on your client system. In the case of
    Net-SNMP, *registration* simply means putting these files in the right directory
    and telling the SNMP commands (like snmpget and snmpwalk) to use them. You can
    set a few environment variables to do this job for you. Just put these lines in
    your shell startup file (e.g., .bashrc):'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: OIDs的可读、易读名称（如*sysDescr*和*sysLocation*）取决于在你的客户端系统上注册了正确的MIB文件。在Net-SNMP的情况下，“注册”只是意味着将这些文件放在正确的目录中，并告诉SNMP命令（如snmpget和snmpwalk）使用它们。你可以设置一些环境变量来自动完成这项工作。只需将这些行放入你的shell启动文件中（例如，.bashrc）：
- en: export MIBS=ALL
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: export MIBS=ALL
- en: export MIBDIRS=/usr/share/snmp/mibs
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: export MIBDIRS=/usr/share/snmp/mibs
- en: When you installed Net-SNMP, it placed a set of standard MIB files in /usr/share/snmp/mibs,
    as you can see in the list below. These are all plaintext files written using
    a human-readable and machine-parseable syntax.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 当你安装Net-SNMP时，它将一组标准MIB文件放置在/usr/share/snmp/mibs中，如下面的列表所示。这些都是使用人类可读和机器可解析的语法编写的纯文本文件。
- en: Some of these actually describe MIBs. Others are support files that define information
    needed by the files that describe the MIBs, just as header files are used in the
    C language.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 其中一些实际上描述了MIB。其他是一些支持文件，它们定义了描述MIB的文件所需的信息，就像C语言中使用头文件一样。
- en: '![](../images/254-1.jpg)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/254-1.jpg)'
- en: 'Without these MIB files, the display of the Apple Base Station system group
    would have looked like this:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 没有这些MIB文件，Apple基站系统组的显示将如下所示：
- en: '![](../images/254-2.jpg)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/254-2.jpg)'
- en: You can still tell a lot about the device just from examining the responses,
    but it’s nice to know what the OIDs mean.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 仅通过检查响应，你仍然可以了解很多关于设备的信息，但了解OID的含义会更好。
- en: '[***A Networked Printer***](toc.html#chapter13.10)'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: '[***网络打印机***](toc.html#chapter13.10)'
- en: 'Let’s try another query against a different kind of device:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们尝试对另一种类型的设备进行另一个查询：
- en: '![](../images/255-1.jpg)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/255-1.jpg)'
- en: 'This time, the administrator has not set sysContact and sysLocation. However,
    we can at least determine the type of device being used. One clue is in the sysDescr
    field: *HP ETHERNET . . . JETDIRECT. . . .* This is a networked HPJetdirect printer.'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 这次，管理员没有设置 sysContact 和 sysLocation。然而，我们至少可以确定正在使用的设备类型。一个线索在 sysDescr 字段中：*HP
    ETHERNET . . . JETDIRECT. . . .* 这是一个网络化的 HPJetdirect 打印机。
- en: Another clue, though one much harder for a novice to read, is in the *sysObjectID*—the
    OID in this field indicates the type of device. This OID starts with enterprises,
    indicating that the next number (11) is the enterprise number of the manufacturer;
    you can find a list of manufacturers’ enterprise numbers at [http://www.iana.org/assignments/enterprise-numbers](http://www.iana.org/assignments/enterprise-numbers).
    Here you will find that 11 is registered to Hewlett Packard. The rest of the OID
    (.2.3.9.1) would identify the type of device, if you had the right MIB file on
    your system.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个线索，虽然对于一个新手来说很难读懂，但它在 *sysObjectID* 中——该字段中的 OID 表示设备的类型。这个 OID 以 enterprises
    开头，表示下一个数字（11）是制造商的企业编号；您可以在 [http://www.iana.org/assignments/enterprise-numbers](http://www.iana.org/assignments/enterprise-numbers)
    找到制造商企业编号的列表。在这里，您会发现 11 被注册给了惠普。如果您的系统上有正确的 MIB 文件，OID 的其余部分（.2.3.9.1）将确定设备的类型。
- en: '[***The snmptable Command***](toc.html#chapter13.11)'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: '[***snmptable 命令***](toc.html#chapter13.11)'
- en: This printer’s SNMP agent offers much more information than just the system
    group, giving us a chance to illustrate another command, snmptable. This command
    behaves much like snmpwalk, but it formats the output differently. We use it here
    to look at the TCP Connection Table on the same HP Jetdirect printer.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 这个打印机的 SNMP 代理提供了比系统组多得多的信息，给我们一个机会展示另一个命令，snmptable。这个命令的行为与 snmpwalk 类似，但输出格式不同。我们在这里使用它来查看同一
    HP Jetdirect 打印机的 TCP 连接表。
- en: '![](../images/255-2.jpg)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/255-2.jpg)'
- en: From this table you can see the TCP ports on which the printer is listening.
    You can also see that two connections are in *timeWait* state, one between the
    printer (10.0.0.183, port 80) and a remote system (10.0.1.3, port 19333), and
    another between two TCP ports on the local system itself.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 从这张表中，您可以查看打印机正在监听的 TCP 端口。您还可以看到有两个连接处于 *timeWait* 状态，一个是打印机（10.0.0.183，端口
    80）与远程系统（10.0.1.3，端口 19333）之间的连接，另一个是本地系统自身两个 TCP 端口之间的连接。
- en: '[***MIB-2: The TCP Connection Table***](toc.html#chapter13.12)'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '[***MIB-2: TCP 连接表***](toc.html#chapter13.12)'
- en: 'Now we’ll take a look at our own system. Here is the TCP Connection Table from
    our local system:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将查看我们的系统。以下是本地系统的 TCP 连接表：
- en: '![](../images/256-1.jpg)'
  id: totrans-95
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/256-1.jpg)'
- en: 'Compare this to the information about our TCP listening habits from the output
    of netstat:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 将其与 netstat 输出的我们的 TCP 监听习惯信息进行比较：
- en: '![](../images/256-2.jpg)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/256-2.jpg)'
- en: It is clearly the same information, right? SNMP lets you access this information
    not only on your local system, but on other systems across the network, as well.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 很明显，这是相同的信息，对吧？SNMP 允许您不仅在本地系统上，而且在网络上的其他系统上访问这些信息。
- en: 'Now open Firefox, point your browser to [http://www.cnn.com](http://www.cnn.com/),
    and then look at the TCP Connection Table again:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 现在打开 Firefox，将浏览器指向 [http://www.cnn.com](http://www.cnn.com/)，然后再次查看 TCP 连接表：
- en: '![](../images/256-3.jpg)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/256-3.jpg)'
- en: '![](../images/257-1.jpg)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/257-1.jpg)'
- en: Several connections have been added to the table, all from ephemeral ports on
    your local system to port 80 on several remote systems. These are the connections
    used by the browser to fetch the various parts of the CNN main page.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 表中已添加了几个连接，所有这些连接都是从本地系统的临时端口到几个远程系统的端口 80。这些是浏览器用来获取 CNN 主页各个部分的连接。
- en: '[***MIB-2: The UDP Table***](toc.html#chapter13.13)'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '[***MIB-2: UDP 表***](toc.html#chapter13.13)'
- en: Another table from MIB-2 that might be of interest is the UDP table.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: MIB-2 中另一个可能感兴趣的表是 UDP 表。
- en: '![](../images/257-2.jpg)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/257-2.jpg)'
- en: This table shows the open UDP ports on your system, that is, the ports where
    some application on your system is listening. (The SNMP agent itself is listening
    on port 161.) For reference, the address of *this* system is 10.0.1.5.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 此表显示了系统上打开的 UDP 端口，即系统中某些应用程序正在监听的端口。（SNMP 代理本身正在端口 161 上监听。）为了参考，本系统的地址是 10.0.1.5。
- en: Compare this with the netstat output. You’ll have to run netstat as root to
    get the program names.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 将其与 netstat 输出进行比较。您必须以 root 用户运行 netstat 来获取程序名称。
- en: '![](../images/257-3.jpg)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/257-3.jpg)'
- en: '[***MIB-2 Contents***](toc.html#chapter13.14)'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: '[***MIB-2 内容***](toc.html#chapter13.14)'
- en: In SNMP, the term *group* refers to a subdivision of a MIB consisting of a collection
    of objects or tables that are related in some way. For example, MIB-2’s UPD and
    TCP groups are all about UDP and TCP traffic, respectively. The Net-SNMP agent
    can be built to support a variety of MIBs, but you can always expect to find the
    MIB-2 groups system, interfaces, ip, icmp, tcp, udp, and snmp. These are not all
    of the groups defined in MIB-2, but they are the ones most likely to be supported
    by any SNMP agent. Figure 13-1 shows the location of MIB-2 in the overall MIB
    address space and breaks out some of the groups that comprise MIB-2\. Also notice
    the location of the private.enterprises branch. That’s where you can find the
    HP Printer MIB objects you saw earlier.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 在SNMP中，术语*group*指的是MIB的一个子集，由一些以某种方式相关的对象或表组成。例如，MIB-2的UPD和TCP组都是关于UDP和TCP流量的。Net-SNMP代理可以构建以支持各种MIB，但你可以始终期待找到MIB-2组system、interfaces、ip、icmp、tcp、udp和snmp。这些并不是MIB-2中定义的所有组，但它们是任何SNMP代理最有可能支持的那些组。图13-1显示了MIB-2在整体MIB地址空间中的位置，并分解了组成MIB-2的一些组。同时注意private.enterprises分支的位置。那里你可以找到之前看到的HP打印机MIB对象。
- en: '![](../images/258-1.jpg)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/258-1.jpg)'
- en: '*Figure 13-1: MIB-2*'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: '*图13-1: MIB-2*'
- en: 'Try walking these groups:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 尝试遍历这些组：
- en: '![](../images/258-2.jpg)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/258-2.jpg)'
- en: If you feel up to a challenge, try comparing the output of the above commands
    with the contents of the MIB files.⁶ The output of the snmpwalk commands listed
    here will indicate, at the beginning of each output line, the MIB file where you
    can find the definition of the object displayed.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你愿意接受挑战，尝试比较上述命令的输出与MIB文件的内容。⁶这里列出的snmpwalk命令的输出将在每行输出的开头指示可以找到显示的对象定义的MIB文件。
- en: 'SNMPv2-MIB::snmpInPkts.0 = Counter32: 5998'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 'SNMPv2-MIB::snmpInPkts.0 = Counter32: 5998'
- en: 'SNMPv2-MIB::snmpOutPkts.0 = Counter32: 5998'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 'SNMPv2-MIB::snmpOutPkts.0 = Counter32: 5998'
- en: 'SNMPv2-MIB::snmpInBadVersions.0 = Counter32: 0'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 'SNMPv2-MIB::snmpInBadVersions.0 = Counter32: 0'
- en: These lines indicate that you can find these definitions in the MIB file SNMPv2-MIB.txt.
    For help interpreting what you find in the MIB file, you can read Appendix B.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 这些行表示你可以在MIB文件SNMPv2-MIB.txt中找到这些定义。为了帮助解释你在MIB文件中找到的内容，你可以阅读附录B。
- en: 'You are also likely to find that your SNMP agent has been built to include
    the Host Resources MIB, the UCDavis MIB, and the newer Net-SNMP MIB. Try walking
    these with the following commands:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可能会发现你的SNMP代理被构建为包括主机资源MIB、UCDavis MIB和较新的Net-SNMP MIB。尝试使用以下命令遍历这些MIB：
- en: snmpwalk -c public localhost enterprises ucdavis
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: snmpwalk -c public localhost enterprises ucdavis
- en: snmpwalk -c public localhost enterprises netSnmp
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: snmpwalk -c public localhost enterprises netSnmp
- en: One of the objects that might interest you is the version of your own agent.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 可能会令你感兴趣的对象之一是你的代理的版本。
- en: $snmpget -c public localhost versionTag.0
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: $snmpget -c public localhost versionTag.0
- en: 'UCD-SNMP-MIB::versionTag.0 = STRING: 5.2.1'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 'UCD-SNMP-MIB::versionTag.0 = STRING: 5.2.1'
- en: '[**Writing Values with SNMP**](toc.html#chapter13.15)'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: '[**使用SNMP写入值**](toc.html#chapter13.15)'
- en: As well as reading information from an agent, SNMP can be used to set the values
    of objects on a remote system. Let’s pick an object that is defined to have read-write
    access and experiment with it a little.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 除了从代理读取信息外，SNMP还可以用来设置远程系统上对象的值。让我们选择一个定义为具有读写访问权限的对象，并对其进行一些实验。
- en: '[***Setting sysContact***](toc.html#chapter13.16)'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '[***设置sysContact***](toc.html#chapter13.16)'
- en: 'Look through the MIB defining the system group in MIB-2\. Remember that when
    we accessed the system group, the resulting display contained lines that looked
    like this:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 查看定义MIB-2中系统组的MIB。记住，当我们访问系统组时，结果显示包含看起来像这样的行：
- en: 'SNMPv2-MIB::sysContact.0 = STRING: [me@myaddr.com](mailto:me@myaddr.com)'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 'SNMPv2-MIB::sysContact.0 = STRING: [me@myaddr.com](mailto:me@myaddr.com)'
- en: 'SNMPv2-MIB::sysName.0 = STRING: localhost.localdomain'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 'SNMPv2-MIB::sysName.0 = STRING: localhost.localdomain'
- en: 'SNMPv2-MIB::sysLocation.0 = STRING: "the den"'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 'SNMPv2-MIB::sysLocation.0 = STRING: "the den"'
- en: 'See the SNMPV2-MIB at the start of each line? That indicates that these objects
    are defined in the file SNMPv2-MIB.txt. If you look at the definitions of these
    objects in that file, you’ll see this snippet:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 每行开头看到的是SNMPV2-MIB吗？这表示这些对象定义在SNMPv2-MIB.txt文件中。如果你查看该文件中这些对象的定义，你会看到以下片段：
- en: '![](../images/259-1.jpg)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/259-1.jpg)'
- en: '![](../images/260-1.jpg)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/260-1.jpg)'
- en: 'You can see from this snippet that the MIB file defines the three objects we
    read the values of above: sysContact, sysName, and sysLocation. Each of these
    is described as an OBJECT-TYPE with a syntax of DisplayString, read-write access,
    and a status of current. Each object has a description and a line starting with
    :: =, meaning *is defined as. System* is a group in MIB-2 that has an OID of {
    .1.3.6.1.2.1.1 }. These lines in the MIB file indicate that these three object
    types are defined as objects 4, 5, and 6 following system (.1.3.6.1.2.1.1), so
    their OIDs are:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: '您可以从这个片段中看到，MIB 文件定义了我们读取上述值的三个对象：sysContact、sysName 和 sysLocation。每个对象都描述为具有
    DisplayString 语法、可读写访问权限和当前状态的对象类型。每个对象都有一个描述和以 :: = 开头的行，表示“定义为”。System 是 MIB-2
    中的一个组，其 OID 为 { .1.3.6.1.2.1.1 }。MIB 文件中的这些行表明，这三个对象类型被定义为系统 (.1.3.6.1.2.1.1)
    之后的对象 4、5 和 6，因此它们的 OID 为：'
- en: '![](../images/260-2.jpg)'
  id: totrans-137
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/260-2.jpg)'
- en: Notice that these are OIDs of the OBJECT-TYPE definitions, not their instances.
    Remember, if you want to use snmpget to read the value of the instance, you need
    to add a .0 to the end of the type OID.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，这些是 OBJECT-TYPE 定义的对象标识符，而不是它们的实例。记住，如果您想使用 snmpget 读取实例的值，您需要在类型 OID 的末尾添加
    .0。
- en: Enough of reading MIBs—we just want to find a read-write type so we can try
    a SET. Let’s try setting sysContact.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 足够阅读 MIB 文件了——我们只想找到一个可读写类型，以便我们可以尝试设置。让我们尝试设置 sysContact。
- en: $ snmpset -c public localhost sysContact.0 s "[me@myself.com](mailto:me@myself.com)"
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: $ snmpset -c public localhost sysContact.0 s "[me@myself.com](mailto:me@myself.com)"
- en: 'snmpset: Unknown host (Permission denied)⁸'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 'snmpset: 未知主机（权限拒绝）⁸'
- en: $
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: $
- en: The agent refused the request. Why? Remember your configuration file?
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 代理拒绝请求。为什么？还记得您的配置文件吗？
- en: '![](../images/261-1.jpg)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/261-1.jpg)'
- en: 'You set a read-only community string, but not a read-write one, so you don’t
    have permission to set any values. You’ll have to configure a read-write community
    name. Add the following line to your snmpd.conf file to configure a read-write
    community string writer:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 您设置了一个只读的团体字符串，但没有设置可读写的团体字符串，因此您没有权限设置任何值。您必须配置一个可读写的团体名称。将以下行添加到您的 snmpd.conf
    文件中，以配置可读写的团体字符串写入者：
- en: rwcommunity writer
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: rwcommunity writer
- en: 'Now you’ll need to bring this change to the attention of the SNMP agent. Send
    the agent a SIGHUP signal to make it re-read its configuration. You will have
    to do this as root:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您需要将此更改通知 SNMP 代理。向代理发送 SIGHUP 信号以使其重新读取其配置。您必须以 root 身份执行此操作：
- en: killall -s HUP snmpd
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 杀死 snmpd 进程，发送 HUP 信号：
- en: Now try snmpset again.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 现在再次尝试运行 snmpset。
- en: $ snmpset -c writer localhost sysContact.0 s "[me@myself.com](mailto:me@myself.com)"
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: $ snmpset -c writer localhost sysContact.0 s "[me@myself.com](mailto:me@myself.com)"
- en: Error in packet.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 数据包错误。
- en: 'Reason: notWritable (that object does not support modification)'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 原因：不可写入（该对象不支持修改）
- en: 'Failed object: SNMPv2-MB::sysContact.0'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 失败的对象：SNMPv2-MB::sysContact.0
- en: The agent refused again! This time, the reason is a little less obvious. The
    Net-SNMP agent will refuse requests to set new values if the object’s value has
    been configured in the snmpd.conf file. This is not part of the SNMP standard,
    it’s just how Net-SNMP works. It presumes that since you configured these values
    through the snmpd.conf file, you probably don’t want someone else changing them
    remotely. If you want these values to be writable, you need to set their values
    using local snmpset commands, rather than by using the configuration file.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 代理再次拒绝！这次，原因稍微不那么明显。如果对象值已在 snmpd.conf 文件中配置，Net-SNMP 代理将拒绝设置新值的请求。这不是 SNMP
    标准的一部分，这只是 Net-SNMP 的工作方式。它假设您通过 snmpd.conf 文件配置了这些值，您可能不希望其他人远程更改它们。如果您想使这些值可写，您需要使用本地
    snmpset 命令设置它们的值，而不是使用配置文件。
- en: '**NOTE**'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*Apologies for leading you astray here. Our intent was to highlight this non-obvious
    behavior of Net-SNMP and possibly save you some time later.*'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '*对此造成的误导表示歉意。我们的目的是强调 Net-SNMP 的这种不明显的行为，并可能为您节省一些时间。*'
- en: '[***Setting sysName***](toc.html#chapter13.17)'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: '[设置 sysName](toc.html#chapter13.17)'
- en: Now that you know sysContact and sysLocation are not writable for you because
    of their definitions in the configuration file, try sysName. You haven’t configured
    a value for that.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您知道 sysContact 和 sysLocation 由于配置文件中的定义，您无法写入它们，尝试 sysName。您还没有为该值配置任何值。
- en: $ snmpset -c writer localhost sysName.0 s "NewName"
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: $ snmpset -c writer localhost sysName.0 s "NewName"
- en: 'SNMPv2-MIB::sysName.0 = STRING: NewName'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 'SNMPv2-MIB::sysName.0 = STRING: NewName'
- en: The snmpset command requires that you use the read-write community string and
    that you specify the name of the object instance, the type, and the new value.
    The s indicates that you are writing a string value. This tells the snmpset command
    how to format the SET packet. Had you written an integer variable, the type would
    have been i. For a full list of types, read the man page for snmpset. The type
    of the value you set, of course, must match the type of the object you are setting.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: snmpset 命令要求您使用读/写共同体字符串，并指定对象实例的名称、类型和新的值。s 表示您正在写入一个字符串值。这告诉 snmpset 命令如何格式化
    SET 数据包。如果您写入了一个整型变量，类型将是 i。关于类型的完整列表，请阅读 snmpset 的 man 页面。当然，您设置的值的类型必须与您正在设置的对象的类型相匹配。
- en: 'Here’s what sysContact, sysName, and sysLocation look like now:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 这是 sysContact、sysName 和 sysLocation 现在的样子：
- en: $ snmpget -c public localhost sysContact.0 sysName.0 sysLocation.0
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: $ snmpget -c public localhost sysContact.0 sysName.0 sysLocation.0
- en: 'SNMPv2-MIB::sysContact.0 = STRING: [me@myaddr.com](mailto:me@myaddr.com)'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 'SNMPv2-MIB::sysContact.0 = STRING: [me@myaddr.com](mailto:me@myaddr.com)'
- en: 'SNMPv2-MIB::sysName.0 = STRING: NewName'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 'SNMPv2-MIB::sysName.0 = STRING: NewName'
- en: 'SNMPv2-MIB::sysLocation.0 = STRING: "the den"'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 'SNMPv2-MIB::sysLocation.0 = STRING: "the den"'
- en: $
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: $
- en: '[**SNMP Traps**](toc.html#chapter13.18)'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: '[**SNMP 陷阱**](toc.html#chapter13.18)'
- en: As well as responding to SNMP requests like SET and GET, SNMP-enabled devices
    in the network can send out spontaneous notifications of local events. These notifications
    are sent either as SNMP traps or informs. *Traps* are datagrams sent without the
    expectation of a response. *Informs* are an improvement over traps because they
    expect a confirmation response and are re-sent when the trap receiver does not
    confirm them in a timely fashion. The time-out and the number of retries can be
    set by the trap sender as parameters to the snmptrap command.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 除了响应 SET 和 GET 等 SNMP 请求外，网络中启用了 SNMP 的设备还可以发送本地事件的即时通知。这些通知要么作为 SNMP 陷阱发送，要么作为
    informs 发送。*陷阱* 是不需要响应的报文。*informs* 相比陷阱是一个改进，因为它们期望一个确认响应，如果陷阱接收器没有及时确认，则会重新发送。超时和重试次数可以由陷阱发送者作为
    snmptrap 命令的参数设置。
- en: '[***Receiving Traps with snmptrapd***](toc.html#chapter13.19)'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: '[***使用 snmptrapd 接收陷阱**](toc.html#chapter13.19)'
- en: 'You can use snmptrapd to receive traps. In the 5.2.1 release of Net-SNMP, which
    we have been using in this chapter, all you have to do is open a separate terminal
    window and execute the following command as root:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用 snmptrapd 接收陷阱。在 Net-SNMP 的 5.2.1 版本中，这是我们本章中使用的版本，您只需打开一个单独的终端窗口并以 root
    身份执行以下命令：
- en: snmptrapd -Os -Le -f
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: snmptrapd -Os -Le -f
- en: 'As of the 5.3 release, however, the security of snmptrapd was tightened so
    that it no longer defaults to accepting traps with any community name. In later
    versions, you need to create an snmptrapd.conf file in the /etc/snmp directory
    and include a line telling it which communities to accept. We will be using *public,*
    so our snmptrapd.conf file would contain the following:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，从 5.3 版本开始，snmptrapd 的安全性得到了加强，它不再默认接受任何共同体名称的陷阱。在后续版本中，您需要在 /etc/snmp 目录中创建一个
    snmptrapd.conf 文件，并包含一行告诉它接受哪些共同体。我们将使用 *public*，因此我们的 snmptrapd.conf 文件将包含以下内容：
- en: authCommunity log public
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: authCommunity log public
- en: Now you can issue the snmptrapd command described above to view the traps you
    receive.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您可以通过运行上面描述的 snmptrapd 命令来查看您接收到的陷阱。
- en: This command normally runs in the background where it can receive traps, format
    them, and write them to a log file. However, you are using the -f parameter here
    to tell snmptrapd to stay in the foreground and the -Le parameter to send its
    output to stderr. You can also use the -Os parameter to tell snmptrapd to print
    only the last symbolic part of the OID, which will save space and make the output
    more readable.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令通常在后台运行，以便接收陷阱、格式化它们并将它们写入日志文件。但是，您在这里使用 -f 参数来告诉 snmptrapd 保持前台运行，并使用 -Le
    参数将输出发送到 stderr。您还可以使用 -Os 参数来告诉 snmptrapd 只打印 OID 的最后一个符号部分，这将节省空间并使输出更易于阅读。
- en: 'Use a separate command window for sending traps using the snmptrap command.
    You’ll need to run snmptrapd as root, because it wants to listen on UDP port 162\.
    To give it a quick try, run either of the following as root:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 使用单独的命令窗口通过 snmptrap 命令发送陷阱。您需要以 root 身份运行 snmptrapd，因为它想要监听 UDP 端口 162。为了快速尝试，作为
    root 运行以下任一命令：
- en: snmptrap -c public localhost "" coldStart
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: snmptrap -c public localhost "" coldStart
- en: or
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 或者
- en: snmptrap -c public localhost "" .1.3.6.1.6.3.1.1.5.1
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: snmptrap -c public localhost "" .1.3.6.1.6.3.1.1.5.1
- en: 'You can change the format of the output to be much more readable than we show
    below, but that would require formatting instructions that are beyond what you
    need here. The default format for output from snmptrapd looks like this:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以将输出格式改为比我们下面显示的更易于阅读，但这将需要超出这里所需的格式化指令。snmptrapd输出的默认格式如下：
- en: '2007-02-14 20:43:26 localhost.localdomain [127.0.0.1]:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: '2007-02-14 20:43:26 localhost.localdomain [127.0.0.1]:'
- en: 'sysUpTimeInstance = Timeticks: (4694125) 13:02:21.25'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 'sysUpTimeInstance = Timeticks: (4694125) 13:02:21.25'
- en: 'snmpTrapOID.0 = OID: cold Start'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 'snmpTrapOID.0 = OID: cold Start'
- en: Keep in mind that you are using SNMPv2\. The format for sending an SNMPv1 trap
    is different and a bit more complicated.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，你正在使用SNMPv2。发送SNMPv1陷阱的格式不同，而且稍微复杂一些。
- en: 'A coldStart trap technically means the network management software has restarted
    with no change in configuration. Typically, this only happens when the system
    running the agent has rebooted, so many users think of coldStart as a reboot indicator;
    however, it will also be sent any time the agent restarts. If you configure a
    trap target in the snmpd.conf file and restart the agent, your snmptrapd will
    receive a trap from it. Give it a try—add the following line to your snmpd.conf
    file:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: coldStart陷阱在技术上意味着网络管理软件已重新启动，配置没有变化。通常，这仅在运行代理的操作系统重新启动时发生，因此许多用户将coldStart视为重启指示器；然而，它也会在任何代理重新启动时发送。如果你在snmpd.conf文件中配置了陷阱目标并重新启动代理，你的snmptrapd将收到来自它的陷阱。试试看——将以下行添加到你的snmpd.conf文件中：
- en: trap2sink localhost public
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: trap2sink localhost public
- en: 'Now kill the agent and restart it, or send it another SIGHUP; snmptrapd will
    indicate that it has received a coldStart trap. Now that the agent has the trap
    target configured, restart it again. Here’s what snmptrapd will display this time:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 现在杀死代理并重新启动它，或者发送另一个SIGHUP；snmptrapd将指示它已收到coldStart陷阱。现在代理已经配置了陷阱目标，再次重新启动它。这次snmptrapd将显示以下内容：
- en: '2007-02-14 12:06:17 localhost.localdomain [127.0.0.1]:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: '2007-02-14 12:06:17 localhost.localdomain [127.0.0.1]:'
- en: 'sysUpTimeInstance = Timeticks: (33324) 0:05:33.24 snmpTrapOID.0 = OID:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 'sysUpTimeInstance = Timeticks: (33324) 0:05:33.24 snmpTrapOID.0 = OID:'
- en: nsNotifyShutdown
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: nsNotifyShutdown
- en: '2007-02-14 12:06:37 localhost.localdomain [127.0.0.1]:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: '2007-02-14 12:06:37 localhost.localdomain [127.0.0.1]:'
- en: 'sysUpTimeInstance = Timeticks: (36) 0:00:00.36 snmpTrapOID.0 = OID: coldStart'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 'sysUpTimeInstance = Timeticks: (36) 0:00:00.36 snmpTrapOID.0 = OID: coldStart'
- en: 'snmpTrapEnterprise.0 = OID: netSnmpAgentOIDs.10'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 'snmpTrapEnterprise.0 = OID: netSnmpAgentOIDs.10'
- en: 'This is a bit of a jumble, but you can find the beginning of each trap by looking
    for the time stamp. You will have received two traps: nsNotifyShutdown and coldStart.
    The agent had the trap target configured at the time it was shut down, so it sent
    out a trap indicating it was going away. When we started it again (20 seconds
    later, by the time stamp in this example) it sent a coldStart.'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 这有点混乱，但你可以通过查找时间戳来找到每个陷阱的开始。你将收到两个陷阱：nsNotifyShutdown和coldStart。代理在关闭时配置了陷阱目标，因此它发送了一个表示它即将离开的陷阱。当我们再次启动它时（在这个例子中的时间戳是20秒后）它发送了一个coldStart。
- en: Unlike the coldStart, nsNotifyShutdown is not a trap defined in the SNMP specification,
    but rather in the NET-SNMP-AGENT-MIB.txt file. It is one of the Net-SNMP enterprise
    traps, meaning it has OIDs under the private.enterprises section of the MIB tree.
    This is where you will define your traps when you develop your own MIB in the
    next chapter.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 与coldStart不同，nsNotifyShutdown不是在SNMP规范中定义的陷阱，而是在NET-SNMP-AGENT-MIB.txt文件中定义的。它是Net-SNMP企业陷阱之一，这意味着它在MIB树中的private.enterprises部分下有OID。这就是你在下一章开发自己的MIB时定义陷阱的地方。
- en: '[***Traps That Carry Data: linkUp and linkDown***](toc.html#chapter13.20)'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: '[**携带数据的陷阱：linkUp和linkDown**](toc.html#chapter13.20)'
- en: 'The traps you’ve seen here, coldStart and nsNotifyShutdown, do not carry any
    extra data. They only tell you that a shutdown or startup happened. The generic
    traps linkDown and linkUp are different; they contain extra information as specified
    in the OBJECTS line of their definitions:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 你在这里看到的陷阱，coldStart和nsNotifyShutdown，不携带任何额外数据。它们只告诉你发生了关闭或启动。通用的陷阱linkDown和linkUp不同；它们包含在其定义的OBJECTS行中指定的额外信息：
- en: '![](../images/264-1.jpg)'
  id: totrans-199
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/264-1.jpg)'
- en: The OBJECTS line in each trap definition is the list of parameters that will
    be sent in the trap. The first is ifIndex, which is the index into the interface
    table in the interfaces section under MIB-2\. The others define the administrative
    and operational status of the interface. Try viewing this table on your own system.
    It is a little wide to display with the snmptable command, so here’s an snmpwalk
    of ifTable.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 每个陷阱定义中的OBJECTS行是将在陷阱中发送的参数列表。第一个是ifIndex，它是MIB-2中接口部分接口表中的索引。其他参数定义了接口的管理和操作状态。试着在你自己的系统上查看这个表。由于snmptable命令显示时有点宽，所以这里提供了一个ifTable的snmpwalk。
- en: '![](../images/264-2.jpg)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/264-2.jpg)'
- en: '![](../images/265-1.jpg)'
  id: totrans-202
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/265-1.jpg)'
- en: This trap shows that interface 2 (which you can see is eth0, from the walk of
    ifTable above) is administratively up but operationally down. Since this machine
    only has a single Ethernet interface, you’re unlikely to see any traps of this
    kind (you can’t send a trap from an interface that’s offline), but you would see
    the linkUp trap when the interface comes back up.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 这个陷阱表明接口2（你可以从上面的ifTable遍历中看到它是eth0）在管理上是开启的，但在操作上是关闭的。由于这台机器只有一个以太网接口，你不太可能看到这种类型的陷阱（你不能从离线的接口发送陷阱），但当接口恢复时，你会看到linkUp陷阱。
- en: '![](../images/266-1.jpg)'
  id: totrans-204
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/266-1.jpg)'
- en: By this time, you should be able to figure out how to send the trap that generated
    this output. Give it a try.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 到现在为止，你应该能够弄清楚如何发送产生这个输出的陷阱。试一试吧。
- en: '[**Summary**](toc.html#chapter13.21)'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: '[**总结**](toc.html#chapter13.21)'
- en: This chapter has given you a taste of what SNMP can do. You have installed,
    configured, and started the Net-SNMP agent on your own computer. You have explored
    what SNMP can tell you about a networked machine using the snmpget, snmpwalk,
    and snmptable commands provided by Net-SNMP. You have modified one of the settings
    on your system (sysName) with SNMP. You have also sent and received some traps.
    Except for the brief probes of a wireless access point and networked printer,
    we have limited ourselves to the local machine so that even readers not currently
    on a network can still have some fun exploring.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 本章让你领略了SNMP的功能。你已经在自己的计算机上安装、配置并启动了Net-SNMP代理。你使用Net-SNMP提供的snmpget、snmpwalk和snmptable命令探索了SNMP可以告诉你关于网络机器的哪些信息。你使用SNMP修改了系统中的一个设置（sysName）。你还发送和接收了一些陷阱。除了对无线接入点和网络打印机的简要探测外，我们只限于本地机器，以便即使不在网络上的读者也能有所乐趣地探索。
- en: We have also limited our tools to those which come with the Net-SNMP package.
    The nice thing about standard protocols is that software from multiple sources
    can interoperate. You might try taking a look at a MIB browser from another source.
    MIB browsers walk a MIB for you and give you a graphical view of the MIB tree
    offered by the target system. You can find one such browser at [http://www.mibble.org](http://www.mibble.org/).
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也将工具限制在Net-SNMP包自带的部分。标准协议的好处是，来自多个来源的软件可以互操作。你可以尝试查看来自其他来源的MIB浏览器。MIB浏览器会为你遍历MIB，并给出目标系统提供的MIB树的图形视图。你可以在[http://www.mibble.org](http://www.mibble.org/)找到一个这样的浏览器。
- en: We hope this chapter has given you a taste for how useful SNMP can be to a network
    manager or IT professional. SNMP can be used to discover devices on a network,
    identify the type of device based on its IP address, or even reconfigure options
    on a device. This perspective will be helpful when it comes to designing your
    own MIB in the next chapter.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 我们希望这一章能让你领略到SNMP对于网络管理员或IT专业人员是多么有用。SNMP可以用来发现网络上的设备，根据其IP地址识别设备类型，甚至可以重新配置设备上的选项。这种观点在下一章设计自己的MIB时将非常有帮助。
- en: __________________
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: __________________
- en: ¹ The Internet Engineering Task Force (IETF), started in 1986, is the principle
    standards organization for the Internet. Participation is voluntary and open to
    anyone. Most of its work is performed in *working groups (WGs),* which are ad
    hoc groups composed of parties interested in some specific topic.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: ¹ 互联网工程任务组（IETF）成立于1986年，是互联网的主要标准组织。参与是自愿的，对任何人开放。它的大部分工作是在*工作组（WGs）*中完成的，这些是针对某些特定主题感兴趣各方组成的临时小组。
- en: ² In the parlance of the CLI chapter, snmpconf would be called a *wizard.*
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: ² 在CLI章节的术语中，snmpconf会被称作一个*向导*。
- en: '³ If you get the message Timeout: No Response from localhost instead, you may
    have something blocking UDP requests to port 161\. Check your firewall settings
    and your /etc/hosts.deny file. If you find ALL:ALL in your hosts.deny file, comment
    it out and try the snmpget again.'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: '³ 如果您收到消息 Timeout: No Response from localhost，那么可能是有东西阻止了对端口 161 的 UDP 请求。检查您的防火墙设置和
    /etc/hosts.deny 文件。如果您在 hosts.deny 文件中找到 ALL:ALL，请将其注释掉并再次尝试 snmpget。'
- en: ⁴ SNMPv2c is called “community-based” because it retains the use of SNMPv1 community
    strings (think of these as passwords) for authentication. There was disagreement
    about the new security framework that was intended for SNMPv2, so SNMPv2c was
    released without it. When it was ready, the new security framework was released
    in SNMPv3.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: ⁴ SNMPv2c 被称为“基于社区的”，因为它保留了使用 SNMPv1 社区字符串（可以将其视为密码）进行认证。关于 SNMPv2 的新安全框架存在分歧，因此
    SNMPv2c 在没有它的情况下发布。当它准备好时，新的安全框架在 SNMPv3 中发布。
- en: ⁵ Notice that the MIB object is sysLocation, but the command in the snmpd.conf
    file is syslocation. There is no significance to this; it was just the implementer’s
    design choice to use all lowercase letters for the key words in the configuration
    file.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: ⁵ 注意，MIB 对象是 sysLocation，但在 snmpd.conf 文件中的命令是 syslocation。这并没有什么意义；这只是实现者为了在配置文件中使用全部小写字母作为关键字的设计选择。
- en: ⁶ In case you’ve forgotten, the MIB files are in the directory /usr/share/snmp/mibs.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: ⁶ 如果您已经忘记了，MIB 文件位于目录 /usr/share/snmp/mibs 中。
- en: ⁷ The term *current* means that it’s an active type in the MIB, and you can
    expect to get a value back for it.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: ⁷ 术语 *current* 表示它是在 MIB 中的一个活动类型，并且您可以期望得到它的值。
- en: ⁸ Your error message may be different depending on your version of Net-SNMP
    and whether you are using SNMPv1 or SNMPv2, but you will get an error in any case.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: ⁸ 您的错误信息可能因 Net-SNMP 的版本以及您是否使用 SNMPv1 或 SNMPv2 而有所不同，但无论如何您都会得到一个错误。
- en: ⁹ You need to be logged in as root because the command will want to write to
    /var/net-snmp/ snmpapp.conf, which is the persistent data storage. As of Net-SNMP
    5.3, it appears to want to write an SNMPv3 engine ID there, even though we are
    not using SNMPv3 here. (SNMPv3 is not covered in this book.)
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: ⁹ 您需要以 root 用户登录，因为命令将想要写入到 /var/net-snmp/ snmpapp.conf，这是持久数据存储。截至 Net-SNMP
    5.3，它似乎想要在那里写入一个 SNMPv3 引擎 ID，尽管我们在这里并没有使用 SNMPv3。（SNMPv3 在本书中未涉及。）
