- en: '![](../images/361-1.jpg)'
  id: totrans-0
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/361-1.jpg)'
- en: '[**THE LADDIE APPLIANCE BOOTABLE CD**](toc.html#app5)'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '[**LADDIE设备可引导CD**](toc.html#app5)'
- en: '![](../images/as.jpg)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/as.jpg)'
- en: The CD accompanying this book serves two purposes. First, it allows you to demonstrate
    the techniques described in this book by turning your x86 PC into a working appliance.
    Second, it allows you to study, in as much detail as you care to, the source code
    that implements this appliance. In this appendix, we show you how to boot and
    run the Laddie appliance CD, and we provide a tour of the CD’s contents. We also
    provide a simple example of how the CD supports modifying, rebuilding, and reinstalling
    the appliance.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 伴随这本书的CD有两个用途。首先，它允许你通过将你的x86 PC变成一个工作设备来演示这本书中描述的技术。其次，它允许你尽可能详细地研究实现此设备的源代码。在本附录中，我们向你展示如何引导和运行Laddie设备CD，并提供CD内容的导游。我们还提供了一个简单的例子，说明CD如何支持修改、重建和重新安装设备。
- en: '[**Running the Laddie Appliance**](toc.html#app5.1)'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '[**运行Laddie设备**](toc.html#app5.1)'
- en: The Laddie CD doesn’t require that your machine be running a specific operating
    system, you don’t need to install anything, and the CD won’t place anything on
    your hard drive. In fact, you don’t even need a hard drive. The CD creates a ramdisk
    for the root filesystem with links back to the CD, and in this context it runs
    the Laddie appliance. When you’re finished using the CD, simply remove it and
    reboot your original operating system. You’ll find that nothing has changed.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: Laddie CD不需要你的机器运行特定的操作系统，你不需要安装任何东西，CD也不会在你的硬盘上放置任何东西。实际上，你甚至不需要硬盘。CD为根文件系统创建了一个ramdisk，并通过链接回CD，在这个上下文中运行Laddie设备。当你完成CD的使用后，只需将其取出并重新启动你的原始操作系统即可。你会发现没有任何变化。
- en: What you do need in order to run the Laddie appliance is an x86-based PC with
    at least 64 megabytes of system memory, a VESA-compliant video card (if you wish
    to run the framebuffer user interface), and a BIOS that is configured to boot
    from a CD-ROM.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 为了运行Laddie设备，你需要一台基于x86的PC，至少有64MB的系统内存，一个符合VESA规范的显卡（如果你希望运行帧缓冲用户界面），以及配置为从CD-ROM引导的BIOS。
- en: In this section we’ll explain how to boot the CD, show you how to verify that
    the framebuffer and web interfaces are working, and then explain how to access
    the other user interfaces. We’ll also explain how to shut down the appliance.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将解释如何引导CD，向您展示如何验证帧缓冲和Web界面是否正常工作，然后解释如何访问其他用户界面。我们还将解释如何关闭设备。
- en: '[***Booting the CD***](toc.html#app5.2)'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '[***引导CD***](toc.html#app5.2)'
- en: 'With the Laddie CD in the drive, reboot your computer. If the CD boots successfully,
    you’ll be greeted with a message like the following:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 将Laddie CD放入驱动器中，重新启动你的计算机。如果CD成功引导，你会看到一个类似以下的消息：
- en: '![](../images/362-1.jpg)'
  id: totrans-10
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/362-1.jpg)'
- en: At this point, you should press ENTER or wait six seconds to continue the boot
    sequence.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在此阶段，你应该按ENTER键或等待六秒钟以继续引导序列。
- en: A commercial appliance would typically hide boot messages from the user. Since
    this is an educational system, we want you to see them. A commercial appliance
    designed for a specific hardware configuration would also boot up more quickly.
    But this CD is designed to work with a broad range of hardware configurations
    and provide a flexible environment for users to experiment with and build from,
    so the process takes a little longer. In particular, the startup scripts load
    drivers for any hardware the system recognizes, even hardware that isn’t required
    for the Laddie appliance.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 商业设备通常会隐藏引导消息给用户。由于这是一个教育系统，我们希望你能看到它们。为特定硬件配置设计的商业设备也会更快地启动。但这个CD旨在与广泛的硬件配置一起工作，并为用户提供一个灵活的环境来实验和构建，因此这个过程会稍微长一些。特别是，启动脚本会加载系统识别的任何硬件的驱动程序，即使是Laddie设备不需要的硬件。
- en: '[***Navigating the Framebuffer User Interface***](toc.html#app5.3)'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '[***导航帧缓冲用户界面***](toc.html#app5.3)'
- en: Once the CD boots successfully, the system will present you with the main screen
    for the Laddie framebuffer user interface (see Figure E-1). If you see this screen,
    you’ve succeeded in running the appliance and you should now be able to use your
    keyboard’s arrow keys and enter key to navigate the Laddie framebuffer user interface.
    (If your keyboard doesn’t have arrow keys, use **i** for up, **j** for left, **k**
    for down, and **l** for right.)
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦CD成功启动，系统将显示Laddie帧缓冲区用户界面的主屏幕（见图E-1）。如果你看到这个屏幕，说明你已经成功运行了设备，你现在应该能够使用键盘的方向键和回车键来导航Laddie帧缓冲区用户界面。（如果你的键盘没有方向键，可以使用**i**向上，**j**向左，**k**向下，**l**向右。）
- en: '**NOTE**'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*If the boot up process completes and a login prompt appears instead of the
    screen shown in Figure E-1, your video card is probably not VESA-compliant. In
    that case, the Laddie appliance will still run, but you won’t be able to experiment
    with the framebuffer interface.*'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '*如果启动过程完成并且出现登录提示符而不是图E-1所示的屏幕，那么你的显卡可能不是VESA兼容的。在这种情况下，Laddie设备仍然可以运行，但你将无法实验帧缓冲区界面。*'
- en: '![](../images/363-1.jpg)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/363-1.jpg)'
- en: '*Figure E-1: The Laddie framebuffer user interface*'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '*图E-1：Laddie帧缓冲区用户界面*'
- en: '[***Accessing the Web Interface***](toc.html#app5.4)'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: '[***访问Web界面***](toc.html#app5.4)'
- en: The Laddie appliance boots up with the static IP address 192.168.1.11\. If your
    PC is connected to a local area network with an Ethernet card recognized by Laddie’s
    operating system, the appliance will serve web pages that allow you to monitor
    and control the appliance (see Figure E-2). You can access this web interface
    with a browser on the local network by using the URL [http://192.168.1.11](http://192.168.1.11/).
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: Laddie设备以静态IP地址192.168.1.11启动。如果你的PC连接到Laddie操作系统识别的以太网卡所连接的局域网，该设备将提供网页，允许你监控和控制设备（见图E-2）。你可以通过本地网络上的浏览器使用URL
    [http://192.168.1.11](http://192.168.1.11/) 访问此Web界面。
- en: '![](../images/363-2.jpg)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/363-2.jpg)'
- en: '*Figure E-2: The Laddie web interface*'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '*图E-2：Laddie Web界面*'
- en: '**NOTE**'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*You can also use the text-based web browser Lynx to access the Laddie web
    pages. Type **lynx** at a command prompt, and then navigate by following the instructions
    at the bottom of the display.*'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '*你还可以使用基于文本的Web浏览器Lynx访问Laddie网页。在命令提示符中键入**lynx**，然后按照显示底部的说明进行导航。*'
- en: '[***Experimenting with the Linux Shell and Other User Interfaces***](toc.html#app5.5)'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '[***实验Linux Shell和其他用户界面***](toc.html#app5.5)'
- en: In addition to the framebuffer and web interfaces, the Laddie appliance supports
    a command line interface, a front panel interface, and an SNMP interface. When
    experimenting with these other interfaces, you will find it useful to have a Linux
    shell so that you can interact directly with the operating system. If the Laddie
    appliance is on a network, you can access a login shell using telnet (i.e., telnet
    192.168.1.11). To log in, enter the username root and an empty password. You can
    also switch from the framebuffer user interface to a login prompt by pressing
    ctrl-alt-F1\. (If you want to return to the framebuffer interface later, press
    ctrl-alt-F7.)
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 除了帧缓冲区和Web界面之外，Laddie设备还支持命令行界面、前面板界面和SNMP界面。在尝试这些其他界面时，拥有一个Linux shell会很有用，这样你可以直接与操作系统交互。如果Laddie设备在网络上，你可以使用telnet（即telnet
    192.168.1.11）访问登录shell。要登录，输入用户名root和空密码。你还可以通过按ctrl-alt-F1从帧缓冲区用户界面切换到登录提示符。（如果你想稍后返回帧缓冲区界面，请按ctrl-alt-F7。）
- en: Please see the appropriate chapters for instructions on accessing the CLI, front
    panel, and SNMP interfaces.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 请参阅相应的章节，了解如何访问CLI、前面板和SNMP界面。
- en: '[***Shutting Down the Laddie Appliance***](toc.html#app5.6)'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '[***关闭Laddie设备***](toc.html#app5.6)'
- en: The Laddie operating system will not eject the CD while the system is running
    because it relies on the CD for necessary system files. To eject the CD and return
    to your original operating system, reboot your computer by typing reboot in a
    Linux shell. When you see the Laddie boot prompt (as shown in “Booting the CD”
    on page 338), press the spacebar to interrupt the automatic boot, eject the CD,
    then press CTRL-ALT-DEL to reboot your computer with your original operating system.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: Laddie操作系统在系统运行时不会弹出CD，因为它依赖于CD上的必要系统文件。要弹出CD并返回到原始操作系统，请在Linux shell中键入reboot重新启动计算机。当你看到Laddie引导提示符（如第338页上的“引导CD”所示）时，按空格键中断自动引导，弹出CD，然后按CTRL-ALT-DEL重新启动计算机以使用原始操作系统。
- en: '[**Exploring the CD Contents**](toc.html#app5.7)'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '[**探索CD内容**](toc.html#app5.7)'
- en: If you boot the Laddie appliance and then explore the root filesystem from a
    Linux shell, you’ll find that most of the top-level directories exist in the ramdisk,
    and only the /bin, /lib, /sbin, and /usr directories are linked back to the CD.
    In particular, all the directories related to the Laddie appliance are read-write,
    so you can use the CD to experiment with, rebuild, and reinstall the appliance.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您启动 Laddie 设备，然后从 Linux shell 中探索根文件系统，您会发现大多数顶级目录存在于 ramdisk 中，只有 /bin、/lib、/sbin
    和 /usr 目录链接回 CD。特别是，与 Laddie 设备相关的所有目录都是可读写的，因此您可以使用 CD 来实验、重建和重新安装设备。
- en: '[***Laddie Appliance Source Code***](toc.html#app5.8)'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '[***Laddie 设备源代码***](toc.html#app5.8)'
- en: The Laddie Appliance software is provided in /Code/src and is partitioned into
    packages corresponding to the various user interfaces and services. The binaries
    and related files are installed in /opt/laddie. Table E-1 identifies the source
    and install directories for each of the Laddie appliance components.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: Laddie 设备软件位于 /Code/src，并划分为与各种用户界面和服务对应的包。二进制文件和相关文件安装于 /opt/laddie。表 E-1 识别了
    Laddie 设备组件的源代码和安装目录。
- en: '**Table E-1:** Source and Install Directories for Laddie Appliance Components'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: '**表 E-1：Laddie 设备组件的源代码和安装目录**'
- en: '![](../images/364-1.jpg)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/364-1.jpg)'
- en: In addition to these components, the /Code/src directory contains the buildapp
    subdirectory, which contains scripts and files that support building the appliance.
    This subdirectory also contains an examples subdirectory that includes the example
    programs we discuss in the text.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 除了这些组件外，/Code/src 目录还包含 buildapp 子目录，其中包含支持构建设备的脚本和文件。此子目录还包含一个 examples 子目录，其中包含我们在文本中讨论的示例程序。
- en: 'Where appropriate, component subdirectories include Makefiles. There is also
    a top-level Makefile in /Code/src that allows you to build and re-install the
    entire appliance with these commands:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在适当的位置，组件子目录包含 Makefiles。在 /Code/src 中还有一个顶级 Makefile，允许您使用以下命令构建和重新安装整个设备：
- en: laddie:~# make
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: laddie:~# make
- en: laddie:~# rm -rf /opt/laddie
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: laddie:~# rm -rf /opt/laddie
- en: laddie:~# make install
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: laddie:~# make install
- en: If you’d like to study the source code, a good place to start is the alarm code
    in the /Code/src/ladd subdirectory. This is a simple application, but it demonstrates
    both the empty daemon and the RTA library. The entry point for this service is
    in /Code/src/empd/main.c. The function main calls appInit in ladd.c, which uses
    RTA to publish a table of alarm zones.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想研究源代码，一个好的起点是 /Code/src/ladd 子目录中的警报代码。这是一个简单的应用程序，但它演示了空守护进程和 RTA 库。此服务的入口点位于
    /Code/src/empd/main.c。main 函数在 ladd.c 中调用 appInit，它使用 RTA 发布警报区域表。
- en: '[***Laddie Appliance Libraries***](toc.html#app5.9)'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '[***Laddie 设备库***](toc.html#app5.9)'
- en: The Laddie appliance uses several libraries. The RTA library source is provided
    in the /usr/src/packages/rta-0.7.5.tgz tarball, and it is installed in /usr/local/lib
    and /usr/local/include.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: Laddie 设备使用多个库。RTA 库源代码包含在 /usr/src/packages/rta-0.7.5.tgz 归档文件中，并安装于 /usr/local/lib
    和 /usr/local/include。
- en: 'The PostgreSQL client, the lighttpd daemon, and the SNMP utilities are well-documented
    open-source projects that we have compiled and installed without patches. The
    source code for the versions we use is provided in /usr/src/packages:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: PostgreSQL 客户端、lighttpd 守护进程和 SNMP 工具是经过良好文档记录的开源项目，我们已编译并安装，未应用任何补丁。我们使用的版本源代码位于
    /usr/src/packages：
- en: postgresql-base-8.0.1.tar.bz2
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: postgresql-base-8.0.1.tar.bz2
- en: lighttpd-1.4.10.tar.gz
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: lighttpd-1.4.10.tar.gz
- en: net-snmp-5.1.3.1.tar.gz
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: net-snmp-5.1.3.1.tar.gz
- en: The RTA library and PostgreSQL client do not have configuration files. The lighttpd
    daemon uses the configuration file /etc/lighttpd.conf. PHP’s configuration file
    is in /etc/php.ini.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: RTA 库和 PostgreSQL 客户端没有配置文件。lighttpd 守护进程使用配置文件 /etc/lighttpd.conf。PHP 的配置文件位于
    /etc/php.ini。
- en: '[***Startup Scripts***](toc.html#app5.10)'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '[***启动脚本***](toc.html#app5.10)'
- en: In order to launch the appliance at system startup, we add scripts to the /etc/rc.d/init.d
    directory. We also provide links from /etc/rc.d/rc3.d so that these scripts will
    be invoked in runlevel 3\. The Laddie startup scripts include ladd, logmuxd, networkd,
    snmpd, and tbl2filed. Each of these scripts also provides for the graceful termination
    of the appliance when the operating system shuts down. The framebuffer user interface
    is launched at startup using the fbmenuctl script, but because the console must
    be launched first, we invoke it from the /etc/inittab file.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 为了在系统启动时启动设备，我们在 /etc/rc.d/init.d 目录中添加脚本。我们还从 /etc/rc.d/rc3.d 提供链接，以便这些脚本在运行级别
    3 时被调用。Laddie 启动脚本包括 ladd、logmuxd、networkd、snmpd 和 tbl2filed。每个脚本还提供了在操作系统关闭时优雅地终止设备的功能。使用
    fbmenuctl 脚本在启动时启动帧缓冲区用户界面，但由于控制台必须首先启动，所以我们从 /etc/inittab 文件中调用它。
- en: For convenience when testing, we provide the laddie script in /opt/ laddie/bin.
    This script invokes all of the startup scripts specific to the appliance.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 为了方便测试，我们在 /opt/laddie/bin 中提供了 laddie 脚本。此脚本调用所有特定于设备的启动脚本。
- en: '[***The Linux From-Scratch Distribution and Additional Packages***](toc.html#app5.11)'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '[***Linux From-Scratch 发行版和额外软件包***](toc.html#app5.11)'
- en: Had this been a real Linux appliance, we might have opted for a simpler Linux
    environment. We might have used a smaller kernel, BusyBox utilities, and uclibc
    libraries, for example. But our emphasis is not embedded Linux, and we feel a
    more generic Linux environment keeps the focus on the appliance architecture.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 如果这是一个真正的 Linux 设备，我们可能会选择一个更简单的 Linux 环境。例如，我们可能会使用更小的内核、BusyBox 工具和 uclibc
    库。但我们的重点是嵌入式 Linux，我们觉得一个更通用的 Linux 环境有助于将重点放在设备架构上。
- en: 'As a starting point, we used Linux From Scratch ([http://www.linuxfromscratch.org](http://www.linuxfromscratch.org)),
    a distribution that includes most of the tools we needed to build our appliance,
    and does not include the X Window System (which we didn’t need). All the packages
    required to rebuild the Laddie appliance are included in the /usr/src/packages
    directory. Most of these packages were installed according to instructions from
    the Linux From Scratch documentation, which is also included in the usr/src/packages
    directory as LFS-BOOK-6.0.pdf. Additional packages include the following:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 作为起点，我们使用了 Linux From Scratch ([http://www.linuxfromscratch.org](http://www.linuxfromscratch.org))，这是一个包含我们构建设备所需的大部分工具的发行版，并且不包括
    X Window 系统（我们不需要）。所有重新构建 Laddie 设备所需的软件包都包含在 /usr/src/packages 目录中。大多数这些软件包都是根据
    Linux From Scratch 文档中的说明安装的，该文档也包含在 usr/src/packages 目录中的 LFS-BOOK-6.0.pdf 文件中。额外的软件包包括以下内容：
- en: '![](../images/366-1.jpg)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/366-1.jpg)'
- en: See the file /usr/src/packages/HISTORY for detailed installation notes for these
    additional packages.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 请参阅 /usr/src/packages/HISTORY 文件以获取这些额外软件包的详细安装说明。
- en: '[**Rebuilding the Laddie Appliance**](toc.html#app5.12)'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '[**重新构建 Laddie 设备**](toc.html#app5.12)'
- en: As a quick illustration of the CD’s filesystem structure, let’s modify and reinstall
    a portion of the Laddie appliance. This won’t be permanent; we won’t create a
    new CD. We’ll just add a line to a .c file in the alarm daemon, recompile it at
    the Linux shell prompt, reinstall it, and run it.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 为了快速展示 CD 的文件系统结构，让我们修改并重新安装 Laddie 设备的一部分。这不会是永久的；我们不会创建一个新的 CD。我们只需在警报守护进程的
    .c 文件中添加一行，然后在 Linux shell 提示符下重新编译它，重新安装并运行它。
- en: If you’d like to follow along, boot up an x86 PC using the Laddie CD and bring
    up a shell console. See “Booting the CD” on page 338 for instructions.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想跟随操作，请使用 Laddie CD 启动一个 x86 PC 并打开一个 shell 控制台。请参阅第 338 页的“启动 CD”部分以获取说明。
- en: '**NOTE**'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*This exercise assumes you can use the vi editor. If you’re not familiar with
    vi, you can get up to speed quickly with vimtutor, which is also provided on the
    CD.*'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '*本练习假设您可以使用 vi 编辑器。如果您不熟悉 vi，可以通过 CD 上提供的 vimtutor 快速熟悉它。*'
- en: '1\. Since the alarm daemon will already be running, kill it with this command:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 1. 由于警报守护进程已经正在运行，请使用以下命令将其终止：
- en: laddie:~# laddie stop
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: laddie:~# laddie stop
- en: '2\. Then use the following commands to enter the alarm daemon source directory
    and open the ladd.c file for editing:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 2. 然后使用以下命令进入警报守护进程源目录并打开 ladd.c 文件进行编辑：
- en: laddie:~# cd /Code/src/ladd
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: laddie:~# cd /Code/src/ladd
- en: laddie:~# vi ladd.c
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: laddie:~# vi ladd.c
- en: '3\. In the function user_update() at the end of the file, find the following
    lines:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 3. 在文件末尾的 user_update() 函数中，找到以下行：
- en: syslog(LOG_ALERT, "User set alarm on zone %d, %s",
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: syslog(LOG_ALERT, "用户在区域 %d 上设置了警报，%s",
- en: Zone[rowid].id, Zone[rowid].name);
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: Zone[rowid].id, Zone[rowid].name);
- en: '4\. Immediately after these lines, insert the following:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 4. 在这些行之后立即插入以下内容：
- en: syslog(LOG_ALERT, "Hello, world! I've modified the alarm daemon!");
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: syslog(LOG_ALERT, "Hello, world! I've modified the alarm daemon!");
- en: '5\. Save the file and then quit vi. Build and reinstall ladd with the commands:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 5. 保存文件然后退出 vi。使用以下命令构建和重新安装 ladd：
- en: laddie:~# export DEF_APPDIR=/opt/laddie
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: laddie:~# export DEF_APPDIR=/opt/laddie
- en: laddie:~# make -e
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: laddie:~# make -e
- en: laddie:~# make -e install
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: laddie:~# make -e install
- en: '**NOTE**'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*The Laddie appliance components use the environment variable DEF_APPDIR to
    specify the install location. The default is the more conventional location /usr/local,
    but we use /opt/laddie instead to make it easier for you to identify the components
    that are specific to the appliance. The -e option tells the make utility to let
    environment variables override variables that occur in the Makefiles.*'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: '*Laddie 设备组件使用环境变量 DEF_APPDIR 来指定安装位置。默认位置是更传统的 /usr/local，但我们使用 /opt/laddie
    以便您更容易识别特定于设备的组件。-e 选项告诉 make 工具让环境变量覆盖 Makefiles 中出现的变量。* '
- en: 'This will create a new executable and install it in /opt/laddie/bin. Then start
    the alarm daemon by entering this command:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 这将创建一个新的可执行文件并将其安装到 /opt/laddie/bin 目录下。然后通过输入以下命令启动警报守护进程：
- en: laddie:~# laddie start
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: laddie:~# laddie start
- en: '6\. Press ESC to exit the framebuffer user interface. Then monitor the system
    logs with this command:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 6. 按 ESC 退出帧缓冲区用户界面。然后使用以下命令监控系统日志：
- en: laddie:~# cat /var/log/messages
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: laddie:~# cat /var/log/messages
- en: Log messages are routed to the pipe /var/log/messages by the logmuxd event handler.
    Using cat, we can display these messages at the console. The command will do nothing
    until an event occurs.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 日志消息通过 logmuxd 事件处理器被路由到 /var/log/messages 管道。使用 cat 命令，我们可以在控制台显示这些消息。该命令在发生事件之前不会做任何事情。
- en: '7\. To create a user update event, use ctrl-alt-F2 to switch to console 2,
    and then run the command line interface:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 7. 要创建一个用户更新事件，使用 Ctrl-Alt-F2 切换到控制台 2，然后运行命令行界面：
- en: laddie:~# cli
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: laddie:~# cli
- en: '8\. Create an update event with the following commands:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 8. 使用以下命令创建一个更新事件：
- en: clear all
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 清除所有内容
- en: test 1
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 测试 1
- en: quit
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 退出
- en: 9\. Now use ctrl-alt-F1 to switch back to the original console. If your reinstall
    worked, the displayed log messages will contain a time-stamped entry with your
    new “Hello, world!” message.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 9. 现在，使用 Ctrl-Alt-F1 切换回原始控制台。如果重新安装成功，显示的日志消息将包含带有时戳的新“Hello, world!”消息条目。
- en: 10\. Use ctrl-C to terminate the logging display.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 10. 使用 Ctrl-C 终止日志显示。
