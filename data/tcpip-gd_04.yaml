- en: Part II-1. TCP/IP NETWORK INTERFACE LAYER PROTOCOLS
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第二部分-1. TCP/IP 网络接口层协议
- en: TCP/IP LOWER-LAYER CORE PROTOCOLS
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: TCP/IP 底层核心协议
- en: 'The TCP/IP protocol suite is largely defined in terms of the protocols that
    constitute it, and several dozen are covered in this book. Most of the critical
    protocols of the suite function at the lower layers of the OSI Reference Model
    (covered in [Part I-2](pt02.html "Part I-2. THE OPEN SYSTEMS INTERCONNECTION (OSI)
    REFERENCE MODEL")): layers 2, 3 and 4, which correspond to the network interface,
    Internet, and transport layers in the TCP/IP model architecture (described in
    [Part I-3](pt03.html "Part I-3. TCP/IP PROTOCOL SUITE AND ARCHITECTURE")). Included
    here are the all-important Internet Protocol (IP) at layer 3 and Transmission
    Control Protocol (TCP) at layer 4, which combine to give TCP/IP its name.'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: TCP/IP 协议套件在很大程度上是通过其构成的协议来定义的，本书涵盖了数十个协议。套件中的大多数关键协议都位于 OSI 参考模型的底层（在[第一部分-2](pt02.html
    "第一部分-2. 开放系统互联 (OSI) 参考模型")中介绍）：第2层、第3层和第4层，这对应于 TCP/IP 模型架构中的网络接口、互联网和传输层（在[第一部分-3](pt03.html
    "第一部分-3. TCP/IP 协议套件和架构")中描述）。这里包括至关重要的第3层互联网协议（IP）和第4层的传输控制协议（TCP），它们共同构成了 TCP/IP
    的名称。
- en: 'Due to the importance of these and other TCP/IP protocols at the lower layers,
    this is the largest of the three sections of this book. It contains eight parts.
    The first describes the two TCP/IP protocols that reside at the network interface
    layer (layer 2 of the OSI Reference Model): the Point-to-Point Protocol (PPP)
    and the Serial Line Interface Protocol (SLIP). The second part describes a couple
    of special protocols that reside architecturally between layers 2 and 3: the Address
    Resolution Protocol (ARP) and the Reverse Address Resolution Protocol (RARP).
    The third and fourth parts describe the IP versions 4 and 6 (IPv4 and IPv6). The
    fifth and sixth parts discuss IP-related feature and support protocols, and the
    seventh part describes IP routing protocols. Finally, the eighth part covers the
    two TCP/IP transport layer protocols, the Transmission Control Protocol (TCP)
    and the User Datagram Protocol (UDP), and related topics such as the use of TCP/IP
    ports.'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 由于这些和其他 TCP/IP 协议在底层的重要性，这是本书三个部分中最大的一个。它包含八个部分。第一部分描述了位于网络接口层（OSI参考模型的第2层）的两个
    TCP/IP 协议：点对点协议（PPP）和串行线路接口协议（SLIP）。第二部分描述了位于第2层和第3层之间架构上的几个特殊协议：地址解析协议（ARP）和反向地址解析协议（RARP）。第三和第四部分描述了
    IP 版本 4 和 6（IPv4 和 IPv6）。第五和第六部分讨论与 IP 相关的功能和支持协议，第七部分描述 IP 路由协议。最后，第八部分涵盖了两个
    TCP/IP 传输层协议：传输控制协议（TCP）和用户数据报协议（UDP），以及相关的主题，例如 TCP/IP 端口的使用。
- en: '[Chapter 9](ch09.html "Chapter 9. TCP/IP SERIAL LINE INTERNET PROTOCOL (SLIP)
    AND POINT-TO-POINT PROTOCOL (PPP) OVERVIEW AND FUNDAMENTALS")'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '[第9章](ch09.html "第9章. TCP/IP 串行线路互联网协议 (SLIP) 和点对点协议 (PPP) 概述和基础")'
- en: '[Chapter 10](ch10.html "Chapter 10. PPP CORE PROTOCOLS: LINK CONTROL, NETWORK
    CONTROL, AND AUTHENTICATION")'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '[第10章](ch10.html "第10章. PPP 核心协议：链路控制、网络控制和认证")'
- en: '[Chapter 12](ch12.html "Chapter 12. PPP PROTOCOL FRAME FORMATS")'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '[第12章](ch12.html "第12章. PPP 协议帧格式")'
- en: The lowest layer of the OSI Reference Model is the physical layer, which is
    responsible for the nitty-gritty details of transmitting information from one
    place to another on a network. The layer just above the physical layer is the
    *data link layer*, called the *network interface layer*, or just the *link layer*,
    in the TCP/IP architectural model. Its primary jobs are to implement networks
    at the local level and to interface between the hardware-oriented physical layer
    and the more abstract, software-oriented functions of the network layer and the
    layers above it.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: OSI 参考模型的最底层是物理层，它负责在网络上从一处传输信息到另一处的细节。物理层之上的层是 *数据链路层*，在 TCP/IP 架构模型中被称为 *网络接口层*，或简称为
    *链路层*。其主要任务是实施本地网络，并在以硬件为导向的物理层和更抽象的、以软件为导向的网络层及其以上各层之间进行接口。
- en: In the case of TCP/IP, the Internet Protocol (IP) is the main protocol at layer
    3, and it serves as the foundation of the whole TCP/IP protocol suite. IP is designed
    to be layered on top of any number of layer 2 technologies. However, some types
    of connections do not include a layer 2 protocol over which IP can run. To enable
    TCP/IP to operate on these kinds of links, two special TCP/IP protocols operate
    at the network interface layer, connecting IP to the physical layer below.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 在TCP/IP的情况下，互联网协议（IP）是第3层的核心协议，它是整个TCP/IP协议套件的基础。IP被设计成可以建立在任何数量的第2层技术之上。然而，某些类型的连接不包括IP可以运行的第2层协议。为了使TCP/IP能够在这些类型的链路上运行，有两种特殊的TCP/IP协议在网络接口层运行，将IP连接到下面的物理层。
- en: In this part, I provide a description of the two protocols that reside at the
    data link, or network interface layer, in the TCP/IP protocol suite. These are
    the older, simple Serial Line Interface Protocol (SLIP) and the newer, more capable
    Point-to-Point Protocol (PPP). I begin with a chapter that provides a brief overview
    of SLIP and PPP, showing how they fit into the TCP/IP protocol suite as a whole
    and describing them in general terms.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在本部分，我提供了关于TCP/IP协议套件中位于数据链路或网络接口层的两个协议的描述。这些是较旧的简单串行线路接口协议（SLIP）和较新的、功能更强大的点对点协议（PPP）。我首先用一个章节简要概述SLIP和PPP，展示它们如何融入整个TCP/IP协议套件，并以一般术语描述它们。
- en: The rest of this part contains three chapters that describe the more important
    of the two protocols, PPP, in more detail. The first of these three explains the
    core protocols that are responsible for setting up PPP links and basic operation.
    The second covers the protocols used to implement various special features in
    PPP, such as compression and encryption. The last chapter on PPP provides detailed
    information about the various frame formats used by PPP protocols.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 本部分其余部分包含三个章节，详细描述了两个协议中更为重要的PPP协议。这三个章节中的第一个解释了负责设置PPP链路和基本操作的核心理议。第二个章节涵盖了用于实现PPP中各种特殊功能的协议，例如压缩和加密。PPP的最后一章提供了关于PPP协议使用的各种帧格式的详细信息。
- en: Chapter 9. TCP/IP SERIAL LINE INTERNET PROTOCOL (SLIP) AND POINT-TO-POINT PROTOCOL
    (PPP) OVERVIEW AND FUNDAMENTALS
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第9章：TCP/IP串行线路互联网协议（SLIP）和点对点协议（PPP）概述和基础
- en: '![image with no caption](httpatomoreillycomsourcenostarchimages287681.png.jpg)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![无标题图片](httpatomoreillycomsourcenostarchimages287681.png.jpg)'
- en: 'TCP/IP''s core protocols operate at layers 3 and 4 of the OSI model, corresponding
    to the Internet layer and host-to-host transport layer of the TCP/IP architectural
    model (introduced in [Chapter 8](ch08.html "Chapter 8. TCP/IP PROTOCOL SUITE AND
    ARCHITECTURE")). That model also defines the network interface layer, which corresponds
    to the data link layer. However, in most network implementations, TCP/IP doesn''t
    define any protocols operating at this layer. Instead, TCP/IP assumes that layer
    2 functionality is provided by a wide area network (WAN) or local area network
    (LAN) technology like Ethernet, Token Ring, or IEEE 802.11\. These technologies
    are responsible for the classic layer 2 functions: physical layer addressing,
    media access control, and especially, layer 2 framing of datagrams received from
    layer 3.'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: TCP/IP的核心协议在OSI模型的第3层和第4层运行，对应于TCP/IP架构模型中的互联网层和主机到主机的传输层（在第8章中介绍）。该模型还定义了网络接口层，对应于数据链路层。然而，在大多数网络实现中，TCP/IP没有定义在这一层运行的任何协议。相反，TCP/IP假设第2层功能由广域网（WAN）或局域网（LAN）技术，如以太网、令牌环或IEEE
    802.11提供。这些技术负责经典的第2层功能：物理层寻址、媒体访问控制，特别是，从第3层接收的数据报的第2层帧格式。
- en: 'There''s a problem with the assumption that Internet Protocol (IP) can run
    on top of an existing layer 2 protocol because sometimes there isn''t one. Certain
    technologies, such as a simple serial connection between two devices, establish
    only a basic, low-level connection at the physical layer. And, of course, one
    type of serial connection is still *very* popular: serial dial-up networking.
    When you connect with a dial-up modem to your ISP, the modems negotiate a connection
    that architecturally exists only at the physical layer.'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 假设互联网协议（IP）可以建立在现有的第2层协议之上是有问题的，因为有时并不存在这样的协议。某些技术，如两个设备之间简单的串行连接，仅在物理层建立基本、低级的连接。当然，一种串行连接仍然非常流行：串行拨号网络。当你通过拨号调制解调器连接到你的ISP时，调制解调器协商的连接在架构上仅存在于物理层。
- en: Since IP assumes certain services will be provided at layer 2, there is no way
    to make it operate directly over a serial line or other physical layer connection.
    At a minimum, the most important layer 2 function that is required is some mechanism
    for framing the IP datagram for transmission; that is, a mechanism that provides
    the necessary data packaging to let datagrams be transmitted over the physical
    layer network. Without this, IP datagrams cannot be sent over the link.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 由于IP假设某些服务将在第2层提供，因此无法使其直接在串行线或其他物理层连接上运行。至少，最重要的第2层功能是需要某种机制来对IP数据报进行封装以进行传输；也就是说，提供必要的数据封装机制，以便数据报能够在物理层网络上传输。没有这个机制，IP数据报就无法在链路上发送。
- en: SLIP versus PPP
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: SLIP与PPP的比较
- en: To fill the gap between IP at layer 3 and the physical connection at layer 1,
    two protocols operate at layer 2 and provide the services that IP requires to
    function. One protocol is *Serial Line Internet Protocol* (SLIP), a very simple
    layer 2 protocol that provides only basic framing for IP. The other is *Point-to-Point
    Protocol* (PPP), a more complex, full-featured data link layer protocol that provides
    framing as well as many additional features that improve security and performance.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 为了填补第3层的IP和第1层的物理连接之间的差距，有两个协议在第2层运行并提供IP运行所需的服务。一个协议是*串行线互联网协议*（SLIP），一个非常简单的第2层协议，只为IP提供基本的封装。另一个是*点对点协议*（PPP），一个更复杂、功能更全面的链路层协议，提供封装以及许多其他改进安全和性能的功能。
- en: SLIP is extremely simple and easy to implement but lacks certain features of
    PPP (like authentication, compression, and error detection), which is full featured
    but more complicated. To draw an analogy, SLIP is a mostly sturdy, ten-year-old
    compact sedan, while PPP is a shiny, new luxury SUV. Both will get you from here
    to grandma's house, but the SUV is going to be safer, more comfortable, and better
    able to deal with problems that might crop up on the road. If they cost the same
    to buy and operate, you'd probably choose the SUV. Both SLIP and PPP cost about
    the same, and unlike an SUV, PPP causes no air pollution and doesn't guzzle gas.
    For this reason, PPP is the choice of most serial line connections today and has
    all but replaced SLIP.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: SLIP非常简单且易于实现，但缺乏PPP（如认证、压缩和错误检测）的一些功能，而PPP功能全面但更复杂。为了进行类比，SLIP就像一辆结实、十年级的紧凑型轿车，而PPP则像一辆闪亮的、全新的豪华SUV。两者都能让你从这里到奶奶家，但SUV将更安全、更舒适，并能更好地处理路上可能出现的问题。如果它们购买和运营成本相同，你可能会选择SUV。SLIP和PPP的成本大致相同，而且与SUV不同，PPP不会造成空气污染，也不会大量消耗汽油。因此，PPP是今天大多数串行线连接的选择，几乎取代了SLIP。
- en: Tip
  id: totrans-19
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: '**KEY CONCEPT** *SLIP* and *PPP* provide layer 2 connectivity for TCP/IP implementations
    that run directly over a physical layer link without a layer 2 technology. While
    SLIP is simpler, PPP is favored due to its many features and capabilities.'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '**关键概念** *SLIP* 和 *PPP* 为直接在物理层链路上运行而没有第2层技术的TCP/IP实现提供第2层连接。虽然SLIP更简单，但由于其许多功能和能力，PPP更受欢迎。'
- en: 'Both SLIP and PPP are designed for connections between just two devices; thus,
    the name point-to-point protocol. Since there are only two devices, A and B, communication
    is straightforward: A sends to B and B sends to A, and since both deal only with
    simple two-device connections, they do not have to manage complexities like media
    access control, collisions, and unique addressing schemes in the way that technologies
    like Ethernet must.'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: SLIP和PPP都是为了连接仅两个设备而设计的；因此，称为点对点协议。由于只有两个设备，A和B，通信是直接的：A发送给B，B发送给A，由于它们只处理简单的两设备连接，因此它们不需要像以太网等技术那样管理媒体访问控制、冲突和独特的寻址方案等复杂性。
- en: Note
  id: totrans-22
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*Some people don''t consider SLIP and PPP to be part of the true TCP/IP protocol
    suite. They argue that TCP/IP is defined at layers 3 and higher on the OSI model,
    that IP is the basis of TCP/IP at layer 3, and that SLIP and PPP are just extra
    protocols that can be used under TCP/IP. To support their argument, they note
    that PPP can be used for protocols other than IP, which is true*.'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '*有些人不认为SLIP和PPP是真正的TCP/IP协议套件的一部分。他们认为TCP/IP在OSI模型的第3层及以上被定义，IP是TCP/IP在第3层的基础，而SLIP和PPP只是可以在TCP/IP下使用的额外协议。为了支持他们的论点，他们指出PPP可以用于除了IP之外的协议，这是事实*。'
- en: Serial Line Internet Protocol (SLIP)
  id: totrans-24
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 串行线互联网协议（SLIP）
- en: The need for a data link layer protocol to allow IP to operate over serial links
    was identified very early on in the development of TCP/IP. Engineers working on
    IP needed a way to send IP datagrams over serial links. To solve the problem,
    they created the very simple protocol SLIP to frame IP messages for transmission
    across the serial line.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 在TCP/IP的开发早期就确定了需要一个数据链路层协议，以便IP能够在串行链路上运行。在IP上工作的工程师需要一种方法来通过串行链路发送IP数据报。为了解决这个问题，他们创建了一个非常简单的协议SLIP，用于在串行线上传输IP消息的帧。
- en: 'Unlike most TCP/IP protocols, SLIP has never been defined as a formalized standard.
    It was created informally in the early 1980s, and it became the de facto standard
    before it was ever described in a Request for Comment (RFC). When it was published
    in 1988 (RFC 1055, "A Nonstandard for Transmission of IP Datagrams over Serial
    Lines: SLIP"), the decision was made to designate it a "nonstandard protocol."'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 与大多数TCP/IP协议不同，SLIP从未被定义为正式标准。它是在20世纪80年代初非正式创建的，在它被描述在请求评论（RFC）之前就已经成为事实上的标准。当它在1988年发布（RFC
    1055，“在串行线上传输IP数据报的非标准：SLIP”）时，决定将其指定为“非标准协议”。
- en: SLIP was designated nonstandard because it was developed as a very rudimentary,
    stopgap measure to provide layer 2 framing when needed. SLIP is so simple that
    there really isn't much to standardize. Too, it has so many deficiencies that
    the Internet Engineering Task Force (IETF) apparently didn't want to formalize
    it as a standard. RFC 1055 specifically mentions various problems with SLIP (as
    I'll discuss later in this chapter) and the fact that work was already under way
    to define PPP as a more capable successor to SLIP.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: SLIP被指定为非标准，因为它被开发为一个非常原始的临时措施，以在需要时提供第2层帧。SLIP非常简单，以至于实际上没有什么可以标准化的。此外，它有太多的缺陷，以至于互联网工程任务组（IETF）显然不想将其正式化为标准。RFC
    1055特别提到了SLIP的各种问题（我将在本章后面讨论），以及已经开始定义PPP作为SLIP更强大的继任者的工作。
- en: Tip
  id: totrans-28
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: '**KEY CONCEPT** SLIP provides a *layer 2 framing service* for IP datagrams
    but no other features or capabilities.'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: '**关键概念** SLIP为IP数据报提供*第2层帧服务*，但没有其他功能或能力。'
- en: SLIP Data Framing Method and General Operation
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SLIP数据帧方法及一般操作
- en: 'SLIP performs only one function: the framing of data for transmission. Here''s
    how SLIP framing works. An IP datagram is passed down to SLIP, which breaks it
    into bytes and sends those bytes one at a time over the link. After the last byte
    of the datagram is sent, a special byte value is sent that tells the receiving
    device that the datagram has ended. This is called the SLIP *END character*, and
    it has a byte value of 192 in decimal numbers (C0 in hexadecimal and 11000000
    binary). That''s basically SLIP framing in a nutshell: Take the whole datagram,
    send it one byte at a time, and then send the byte 192 to delimit the end of the
    datagram.'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: SLIP只执行一个功能：为传输数据帧。以下是SLIP帧的工作方式。一个IP数据报被传递到SLIP，它将其分解成字节，并将这些字节逐个发送到链路上。在发送完数据报文的最后一个字节后，发送一个特殊的字节值，告诉接收设备数据报文已经结束。这被称为SLIP的*END字符*，其十进制值为192（十六进制为C0，二进制为11000000）。这就是SLIP帧的精髓：将整个数据报文发送，一次发送一个字节，然后发送字节192来界定数据报文的结束。
- en: 'One minor enhancement to SLIP''s basic operation is to *precede* the datagram
    with an *END* character as well, thus clearly separating the start of the datagram
    from anything that precedes it. To see why this might be needed, you can imagine
    that at a particular time you have only one datagram to send: datagram 1\. You
    send 1, and then send the *END* character to delimit it. Now, suppose there is
    a pause before the next datagram shows up. During that time, you aren''t transmitting,
    but if there is line noise, the other device might pick up spurious bytes here
    and there. If you later receive datagram 2 and just start sending it, the receiving
    device might think the noise bytes were part of datagram 2.'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 对SLIP基本操作的一个小改进是在数据报文前也加上一个*END*字符，从而清楚地分隔数据报文的开始和它之前的内容。为了理解为什么可能需要这样做，你可以想象在某个特定时间你只有一个数据报文要发送：数据报文1。你发送1，然后发送*END*字符来界定它。现在，假设在下一个数据报文出现之前有一个暂停。在这段时间里，你没有传输，但如果有线噪声，另一台设备可能会在这里和那里接收到虚假的字节。如果你后来收到数据报文2并且开始发送它，接收设备可能会认为噪声字节是数据报文2的一部分。
- en: Starting datagram 2 off with an *END* character tells the recipient that anything
    received between this *END* character and the previous one is a separate datagram.
    If that's just noise, then this "noise datagram" is just gibberish that will be
    rejected at the IP layer. Meanwhile, it doesn't corrupt the real datagram you
    wish to send. If no noise occurred on the line between datagrams, then the recipient
    will just see the *END* at the start of datagram 2 right after the one at the
    end of datagram 1 and will ignore the "null datagram" between the two.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 从数据报2开始使用*END*字符告诉接收方，在此*END*字符和前一个*END*字符之间接收到的任何内容都是单独的数据报。如果这只是噪音，那么这个“噪音数据报”只是无意义的文本，将在IP层被拒绝。同时，它不会破坏你希望发送的真实数据报。如果在数据报之间的线路上没有发生噪音，那么接收方将只看到数据报2开始处的*END*字符，紧随数据报1结束处的*END*字符之后，并忽略两者之间的“空数据报”。
- en: But what if the *END* character is 192 in decimal numbers; what happens if the
    byte value 192 appears in the datagram itself? Transmitting it as is would fool
    the recipient into thinking that the datagram ended prematurely. To avoid this,
    an *Escape character* (*ESC*) is defined, which has a decimal value of 219 (DB
    in hex, 11011011 in binary). This symbol means that "this byte and the next are
    special." When a value of 192 appears in the datagram, the sending device replaces
    it with the ESC character followed by the value 220 decimal. Thus, a single 192
    becomes 219 220 (or DB DC in hexadecimal). The recipient translates back from
    219 220 to 192.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 但如果*END*字符的十进制值为192；如果数据报本身出现字节值192，会发生什么？按原样传输它会让接收方误以为数据报提前结束。为了避免这种情况，定义了一个*转义字符*
    (*ESC*)，其十进制值为219（十六进制DB，二进制11011011）。这个符号意味着“这个字节和下一个字节是特殊的。”当数据报中出现192的值时，发送设备将其替换为ESC字符后跟十进制值220。因此，单个192变为219
    220（或十六进制的DB DC）。接收方将219 220转换回192。
- en: Note
  id: totrans-35
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*The SLIP* ESC *character is not the same as the ASCII* ESC *character. They
    both perform an "escaping" operation but are otherwise unrelated. If the ESC character
    itself is in the original datagram—that is, if there''s a byte value of 219 in
    the IP datagram to be sent—the device uses 219 221 instead of just 219*.'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: '*SLIP* ESC *字符与ASCII* ESC *字符不同。它们都执行一个“转义”操作，但除此之外没有其他关联。如果ESC字符本身就在原始数据报中——也就是说，如果IP数据报中要发送的字节值为219——则设备使用219
    221而不是仅仅使用219。'
- en: 'To summarize, SLIP does the following:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，SLIP执行以下操作：
- en: Breaks an IP datagram into bytes
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将IP数据报拆分为字节
- en: Sends the *END* character (value 192) after the last byte of the datagram; in
    better implementations, it sends the *END* character before the first byte as
    well
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在数据报的最后一个字节之后发送*END*字符（值为192）；在更好的实现中，它还在第一个字节之前发送*END*字符
- en: Replaces any byte to be sent in the datagram that is 192 with 219 220
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将数据报中要发送的任何字节值为192的字节替换为219 220
- en: Replaces any byte to be sent that is 219 with 219 221
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将要发送的任何字节值为219的字节替换为219 221
- en: '[Figure 9-1](ch09s02.html#operation_of_the_serial_line_internet_pr "Figure 9-1. Operation
    of the Serial Line Internet Protocol (SLIP) SLIP''s only function is to frame
    data from layer 3 (usually IP datagrams) by surrounding them with END characters
    and replacing special characters as needed.") shows an example of how this is
    done with a sample IP datagram. IP datagrams are passed down to the SLIP software
    at layer 2 (a simplified one with only five bytes is shown here). There, they
    are framed by surrounding them with *END* characters (hexadecimal value C0h, shown
    with diagonal hatching). Special characters with hexadecimal values DBh and C0h
    are replaced by two-byte sequences. Note that the presence of the bracketing *END*
    characters forces the receiving device to see the noise byte (03h, in black) as
    a separate IP datagram, rather than part of either of the real ones. It will be
    rejected when passed up to the IP layer.'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '[图9-1](ch09s02.html#operation_of_the_serial_line_internet_pr "图9-1. Serial
    Line Internet Protocol (SLIP)的操作。SLIP的唯一功能是通过在数据报周围添加END字符并替换所需的特殊字符来封装来自第3层（通常是IP数据报）的数据。")展示了如何使用示例IP数据报来完成这一操作。IP数据报在第二层（这里显示的是一个简化的版本，只有五个字节）传递到SLIP软件。在那里，它们被封装，通过在它们周围添加*END*字符（十六进制值C0h，以斜线阴影显示）。具有十六进制值DBh和C0h的特殊字符被替换为双字节序列。请注意，括号*END*字符的存在迫使接收设备将噪音字节（03h，黑色）视为单独的IP数据报，而不是真实数据报的一部分。当它被传递到IP层时将被拒绝。'
- en: Problems and Limitations of SLIP
  id: totrans-43
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SLIP的问题和局限性
- en: 'SLIP''s simplicity does not come without costs. SLIP simply doesn''t provide
    many of the features and capabilities you really need on modern serial links.
    SLIP is most deficient in the following areas:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: SLIP的简单性并非没有代价。SLIP简单地没有提供你在现代串行链路上真正需要的许多功能和能力。SLIP在以下方面最缺乏：
- en: '**Standardized Datagram Size Specification** SLIP''s maximum supported datagram
    size is not standardized and depends on each implementation. The usual default
    is 1,006 bytes, which becomes the maximum transmission unit (MTU) for the link
    (see [Chapter 27](ch27.html "Chapter 27. IPV6 DATAGRAM SIZE, FRAGMENTATION, REASSEMBLY,
    AND ROUTING")). If a different size is used, you must program this into the IP
    layer.'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '**标准化的数据报大小规范** SLIP支持的最大数据报大小没有标准化，并且取决于每个实现。通常的默认值是1,006字节，这成为链路的最大传输单元（MTU）（见[第27章](ch27.html
    "第27章. IPV6 数据报大小、分片、重组和路由"））。如果使用不同的尺寸，你必须将其编程到IP层。'
- en: '![Operation of the Serial Line Internet Protocol (SLIP) SLIP''s only function
    is to frame data from layer 3 (usually IP datagrams) by surrounding them with
    END characters and replacing special characters as needed.](httpatomoreillycomsourcenostarchimages287725.png.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![串行线路互联网协议（SLIP）的操作 SLIP的唯一功能是通过围绕它们放置END字符并根据需要替换特殊字符来封装来自第三层（通常是IP数据报）的数据。](httpatomoreillycomsourcenostarchimages287725.png.jpg)'
- en: Figure 9-1. Operation of the Serial Line Internet Protocol (SLIP) SLIP's only
    function is to frame data from layer 3 (usually IP datagrams) by surrounding them
    with END characters and replacing special characters as needed.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 图9-1. 串行线路互联网协议（SLIP）的操作 SLIP的唯一功能是通过围绕它们放置END字符并根据需要替换特殊字符来封装来自第三层（通常是IP数据报）的数据。
- en: '**Error Detection and Correction Mechanism** SLIP doesn''t provide any way
    of detecting or correcting errors in transmissions. While such protection is provided
    at higher layers through IP header checksums and other mechanisms, it is a job
    traditionally also done at layer 2\. The reason is that relying on those higher
    layers means that errors are detected only after an entire datagram has been sent
    and passed back up the stack at the recipient. Error correction can come only
    in the form of resending any datagrams that were corrupted. This is inefficient,
    especially because serial links are generally much slower than normal LAN links.'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: '**错误检测和纠正机制** SLIP不提供任何检测或纠正传输中错误的方法。虽然通过IP头部校验和等机制在高层提供了这样的保护，但这项工作传统上也在第二层完成。原因是依赖于那些高层意味着错误只有在整个数据报发送并返回到接收方的堆栈后才会被检测到。错误纠正只能通过重新发送任何损坏的数据报来实现。这效率低下，尤其是在串行链路通常比普通局域网链路慢得多的情况下。'
- en: '**Control Messaging** SLIP offers no way for the two devices to communicate
    control information that may be required to manage the link.'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '**控制信息** SLIP没有提供两种设备之间通信可能需要的管理链路控制信息的方法。'
- en: '**Type Identification** Since SLIP includes no headers of its own, it is not
    possible to identify that SLIP is being used. While developed for IP, there is
    no reason why other layer 3 protocols could not be sent using SLIP (if you were
    running more than one internetworking protocol at the higher layers). However,
    without type identification, there is no way to mix datagrams from two or more
    layer 3 protocols on the same link.'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '**类型识别** 由于SLIP没有自己的头部信息，因此无法识别正在使用SLIP。虽然它是为IP设计的，但没有理由其他第三层协议不能使用SLIP（如果你在高层运行多个互连网络协议）。然而，没有类型识别，就没有办法在同一个链路上混合来自两个或更多第三层协议的数据报。'
- en: '**Address Discovery Method** Addressing isn''t needed at layer 2 because there
    are only two devices in a point-to-point connection, so each device is obviously
    only sending to the other one. However, devices do need some way of learning each
    other''s IP addresses for routing at layer 3\. SLIP provides no method for this.'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '**地址发现方法** 在第二层不需要寻址，因为在点对点连接中只有两个设备，所以每个设备显然只向另一个设备发送数据。然而，设备确实需要某种方式来学习彼此的IP地址以在第三层进行路由。SLIP没有提供这种方法。'
- en: '**Support for Compression** Compression would improve performance over serial
    lines that are otherwise slow compared to other technologies. SLIP provides no
    compression features. (Note, however, that modems usually do support compression
    at layer 1 for serial connections that use them.) A variant on SLIP called *Compressed
    SLIP* or *CSLIP* was created in the late 1980s, but it was not as widely deployed
    as regular SLIP.'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '**压缩支持** 压缩可以提高与其他技术相比本来较慢的串行线路的性能。SLIP没有提供压缩功能。（然而，请注意，调制解调器通常在第一层支持使用它们的串行连接的压缩。）在20世纪80年代末，创建了一个名为*压缩SLIP*或*CSLIP*的SLIP变体，但它并没有像常规SLIP那样得到广泛部署。'
- en: '**Security Features** SLIP lacks even basic security features, with no means
    for authenticating connections or encrypting data.'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '**安全特性** SLIP缺乏甚至基本的安全特性，没有认证连接或加密数据的方法。'
- en: 'SLIP''s many shortcomings have led most implementations to move from SLIP to
    the PPP, which is a much richer data link protocol for direct connections that
    resolves SLIP''s problems. SLIP is now outdated. Still, SLIP continues to be used
    in many places. Simplicity is attractive, and people are famous for their inertia:
    If something is implemented and is working well, many will refuse to change unless
    they are forced to do so.'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: SLIP的许多缺点导致大多数实现从SLIP迁移到PPP，PPP是一个更丰富的数据链路协议，用于直接连接，解决了SLIP的问题。SLIP现在已经过时。尽管如此，SLIP仍然在许多地方被使用。简单性很有吸引力，人们以其惯性而闻名：如果某事物被实施并且运行良好，许多人会拒绝改变，除非他们被迫这样做。
- en: Point-to-Point Protocol (PPP) Overview and Fundamentals
  id: totrans-55
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 点对点协议（PPP）概述和基础
- en: Even as SLIP was being documented, work was underway on a newer protocol that
    would provide full-featured IP transmission over direct links between pairs of
    devices. The result is *PPP*, which defines a complete method for robust data
    link connectivity between devices using serial lines or other physical layers.
    It includes numerous capabilities and features, including error detection, compression,
    authentication, and encryption.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 即使SLIP正在被记录，关于一种新协议的工作也在进行中，该协议将在成对的设备之间的直接链路上提供全功能的IP传输。结果是*PPP*，它定义了使用串行线路或其他物理层设备之间稳健数据链路连接的完整方法。它包括许多功能和特性，包括错误检测、压缩、认证和加密。
- en: The proliferation of serial links, especially for dial-up Internet access, has
    led to the widespread use of PPP. PPP is now one of the most popular layer 2 WAN
    technologies in the networking world, and has replaced SLIP as the standard for
    serial connections on all but legacy implementations. While most often associated
    with dial-up modem use, PPP can run across any similar type of physical layer
    link. For example, it is often used to provide layer 2 functionality on Integrated
    Services Digital Network (ISDN).
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 串行链路的激增，尤其是对于拨号互联网接入，导致了PPP的广泛应用。PPP现在是网络世界中最受欢迎的第2层广域网技术之一，并已取代SLIP，成为除了旧实现之外所有串行连接的标准。虽然PPP通常与拨号调制解调器的使用相关联，但它可以跨越任何类似类型的物理层链路运行。例如，它通常用于在综合业务数字网络（ISDN）上提供第2层功能。
- en: Note
  id: totrans-58
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*Although PPP is called a protocol and is usually considered part of TCP/IP,
    it is really more a protocol suite, since its operation is based on procedures
    defined in many individual protocols. Alternatively, its components can be viewed
    as subprotocols within PPP, even though they are not usually called that in the
    standards*.'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '*尽管PPP被称为协议，通常被认为是TCP/IP的一部分，但它实际上更像是一个协议套件，因为它的操作基于许多单个协议中定义的程序。或者，其组件可以被视为PPP内的子协议，尽管在标准中通常不这样称呼它们*。'
- en: Development and Standardization
  id: totrans-60
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 开发和标准化
- en: Unlike SLIP, PPP was developed to be a complete protocol suite that would enable
    fully functional layer 2 connectivity to support not just IP, but the transmission
    of other network layer protocols as well.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 与SLIP不同，PPP的开发是为了成为一个完整的协议套件，它将能够支持完全功能的第2层连接，不仅支持IP，还支持其他网络层协议的传输。
- en: PPP's history goes back to the late 1980s, when SLIP was the de facto standard
    for serial IP implementations. The first formal IETF document related to PPP was
    RFC 1134 (1989). This RFC was not the standard itself, but a proposal for what
    would eventually be defined as the first main PPP standard, RFC 1171 (1990). RFC
    1171 was revised several times, and several other documents were added to it to
    define the various protocols that compose the entire PPP suite.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: PPP的历史可以追溯到20世纪80年代末，当时SLIP是串行IP实现的既定标准。与PPP相关的第一个正式的IETF文档是RFC 1134（1989年）。这个RFC本身并不是标准，而是一个提案，最终被定义为第一个主要PPP标准RFC
    1171（1990年）。RFC 1171经过多次修订，并添加了几个其他文档来定义构成整个PPP套件的各个协议。
- en: Note
  id: totrans-63
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注
- en: '*Rather than try to develop PPP from scratch, the IETF decided to base it on
    the ISO High-Level Data Link Control (HDLC) protocol, which was initially developed
    by IBM. HDLC is a derivative of the Synchronous Data Link Control (SDLC) Protocol.
    PPP''s developers adapted its framing structure and some of its general operation
    from HDLC*.'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: '*与其从头开始开发PPP，IETF决定基于IBM最初开发的ISO高级数据链路控制（HDLC）协议，该协议是同步数据链路控制（SDLC）协议的衍生品。PPP的开发者从HDLC中采用了其帧结构及其一些通用操作*。'
- en: Function and Architecture
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 功能和架构
- en: PPP is a connection-oriented protocol that enables layer 2 links over a variety
    of different physical layer connections. It is supported on both synchronous and
    asynchronous lines and can operate in half-duplex or full-duplex mode. It was
    designed to carry IP traffic, but is general enough to allow any type of network
    layer datagram to be sent over a PPP connection. As its name implies, PPP is designed
    for point-to-point connections between two devices, and it assumes that frames
    are sent and received in the same order.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: PPP是一种面向连接的协议，它能够在各种不同的物理层连接上建立第2层链路。它支持同步和异步线路，可以在半双工或全双工模式下操作。它被设计用来携带IP流量，但足够通用，允许任何类型的网络层数据报通过PPP连接发送。正如其名称所暗示的，PPP是为两个设备之间的点对点连接而设计的，并且它假定帧是按照相同的顺序发送和接收的。
- en: PPP fits into TCP/IP in the network interface layer (link layer), as shown in
    [Figure 9-2](ch09s03.html#ppp_location_in_the_tcpip_architecture_p "Figure 9-2. PPP
    location in the TCP/IP architecture PPP is the interface between the IP and a
    physical link such as a serial line or dial-up networking connection. This corresponds
    to layer 2 in the OSI Reference Model."). PPP's operation follows a specific sequence,
    including a multistep Link Establishment phase that may include optional authentication.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: PPP在网络接口层（链路层）中与TCP/IP相匹配，如图[图9-2](ch09s03.html#ppp_location_in_the_tcpip_architecture_p
    "图9-2. PPP在TCP/IP架构中的位置 PPP是IP与物理链路（如串行线或拨号网络连接）之间的接口。这对应于OSI参考模型中的第2层。")所示。PPP的操作遵循一个特定的顺序，包括一个可能包含可选认证的多步骤链路建立阶段。
- en: '![PPP location in the TCP/IP architecture PPP is the interface between the
    IP and a physical link such as a serial line or dial-up networking connection.
    This corresponds to layer 2 in the OSI Reference Model.](httpatomoreillycomsourcenostarchimages287727.png.jpg)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![PPP在TCP/IP架构中的位置 PPP是IP与物理链路（如串行线或拨号网络连接）之间的接口。这对应于OSI参考模型中的第2层。](httpatomoreillycomsourcenostarchimages287727.png.jpg)'
- en: Figure 9-2. PPP location in the TCP/IP architecture PPP is the interface between
    the IP and a physical link such as a serial line or dial-up networking connection.
    This corresponds to layer 2 in the OSI Reference Model.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 图9-2. PPP在TCP/IP架构中的位置 PPP是IP与物理链路（如串行线或拨号网络连接）之间的接口。这对应于OSI参考模型中的第2层。
- en: Advantages and Benefits
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 优点和好处
- en: 'A list of PPP''s strengths reads very much like a list of SLIP''s weaknesses,
    as explained earlier in this chapter. Some of PPP''s specific benefits include
    the following:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: PPP的优点列表在很大程度上类似于SLIP的弱点列表，如本章前面所述。PPP的一些具体好处包括以下内容：
- en: A more comprehensive framing mechanism compared to the single *END* character
    in SLIP
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与SLIP中的单个*END*字符相比，更全面的帧机制
- en: Specification of the encapsulated protocol to allow multiple layer 3 protocols
    to be multiplexed on a single link
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 封装协议的规范，以允许多个第3层协议在单个链路上复用
- en: Error detection for each transmitted frame through the use of a cyclic redundancy
    check (CRC) code in each frame header
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过在每个帧的帧头中使用循环冗余检查（CRC）代码来检测每个传输帧的错误
- en: A robust mechanism for negotiating link parameters, including the maximum frame
    size permitted
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一种强大的协商链路参数的机制，包括允许的最大帧大小
- en: A method for testing links before datagram transmission takes place and for
    monitoring link quality
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在数据报传输之前测试链路的方法以及监控链路质量的方法
- en: Support for authentication of the connection using multiple authentication protocols
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 支持使用多个认证协议对连接进行认证
- en: Support for additional optional features, including compression, encryption,
    and link aggregation (allowing two devices to use multiple physical links as if
    they were a single, higher-performance link)
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 支持额外的可选功能，包括压缩、加密和链路聚合（允许两个设备使用多个物理链路，就像它们是一个单一的高性能链路一样）
- en: The proliferation of serial links, especially for dial-up Internet access, has
    led to widespread use of PPP. It is now one of the most popular layer 2 WAN technologies
    in the networking world, and it has replaced SLIP as the standard for serial connections
    on all but legacy implementations. While most often associated with dial-up modem
    use, PPP can run across any similar type of physical layer link. For example,
    it is often used to provide layer 2 functionality on ISDN.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 串行链路的激增，尤其是对于拨号互联网访问，导致了PPP的广泛应用。现在，它是网络世界中最受欢迎的第2层广域网技术之一，并且已经取代了SLIP，成为除了旧实现之外所有串行连接的标准。虽然PPP通常与拨号调制解调器的使用相关联，但它可以运行在任何类似的物理层链路上。例如，它通常用于在ISDN上提供第2层功能。
- en: Tip
  id: totrans-80
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: '**KEY CONCEPT** PPP is a complete link layer protocol suite for devices using
    TCP/IP. It provides framing, encapsulation, authentication, quality monitoring,
    and other features that enable robust operation of TCP/IP over a variety of physical
    layer connections.'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: '**关键概念** PPP是为使用TCP/IP的设备提供的完整的链路层协议套件。它提供了帧定界、封装、认证、质量监控和其他功能，这些功能使得TCP/IP能够在各种物理层连接上稳健运行。'
- en: One key advantage of PPP is that it is *extensible*. Over the years, new protocols
    have been added to the suite in order to provide additional features or capabilities.
    For example, PPP is designed not to use just a single authentication protocol,
    but to allow a choice.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: PPP的一个关键优势是它具有**可扩展性**。多年来，为了提供额外的功能或能力，已经向该套件中添加了新的协议。例如，PPP设计为不仅仅使用单个认证协议，而是允许选择。
- en: PPP's success has even led to the development of derivative protocols like PPP
    over Ethernet (PPPoE) and PPP over ATM (PPPoA). These derivatives actually layer
    PPP over existing data link layer technologies, which demonstrates how valued
    PPP's features are. Even when a layer 2 technology is already in use, you can
    apply PPP on top to provide authentication and management benefits for services
    like Digital Subscriber Line (DSL).
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: PPP的成功甚至导致了派生协议的发展，如以太网上的PPP（PPPoE）和ATM上的PPP（PPPoA）。这些派生协议实际上是在现有的数据链路层技术之上叠加PPP，这证明了PPP功能的价值。即使已经使用了第2层技术，也可以在顶部应用PPP，为数字用户线路（DSL）等服务提供认证和管理优势。
- en: PPP Main Components
  id: totrans-84
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PPP主要组件
- en: 'At the highest level, PPP''s functions can be broken down into several components.
    Each encompasses a general class of PPP functionality and is represented by either
    one protocol in the suite or a set of protocols. The PPP standard describes three
    main components of PPP:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 在最高级别，PPP的功能可以分为几个组件。每个组件都包含PPP功能的一般类别，并由套件中的一个协议或一组协议表示。PPP标准描述了PPP的三个主要组件：
- en: '**PPP Encapsulation Method** The primary job of PPP is to take higher-layer
    messages, such as IP datagrams, and encapsulate them for transmission over the
    underlying physical layer link. To this end, PPP defines a special frame format
    for encapsulating data for transmission, based on the framing used in HDLC. The
    PPP frame was designed to be small and contain only simple fields in order to
    maximize bandwidth efficiency and speed in processing.'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: '**PPP封装方法** PPP的主要任务是取更高层的消息，例如IP数据报，并将它们封装以通过底层物理层链路进行传输。为此，PPP定义了一种特殊的帧格式，用于封装数据以进行传输，该格式基于HDLC中使用的帧定界。PPP帧被设计得小巧，只包含简单的字段，以最大限度地提高带宽效率和处理速度。'
- en: '**Link Control Protocol (LCP)** LCP is responsible for setting up, maintaining,
    and terminating the link between devices. It is a flexible, extensible protocol
    that allows many configuration parameters to be exchanged to ensure that both
    devices agree on how the link will be used.'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: '**链路控制协议（LCP）** LCP负责设置、维护和终止设备之间的链路。它是一种灵活、可扩展的协议，允许交换许多配置参数，以确保两个设备就如何使用链路达成一致。'
- en: '**Network Control Protocols (NCPs)** PPP supports the encapsulation of many
    different layer 3 datagram types. Some of these require additional setup before
    the link can be activated. Once the general link setup is completed with LCP,
    control is passed to the NCP that is specific to the layer 3 protocol being carried
    on the PPP link. For example, when IP is carried over PPP, the NCP used is the
    PPP Internet Protocol Control Protocol (IPCP). Other NCPs are defined for supporting
    the Internetworking Packet Exchange (IPX) protocol, the NetBIOS Frames (NBF) protocol,
    and so forth.'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '**网络控制协议 (NCPs)** PPP 支持封装多种不同的第三层数据报类型。其中一些在激活链路之前需要额外的设置。一旦使用 LCP 完成了一般的链路设置，控制权就传递给特定于
    PPP 链路上传输的第三层协议的 NCP。例如，当 IP 通过 PPP 传输时，使用的 NCP 是 PPP 互联网协议控制协议 (IPCP)。其他 NCPs
    定义用于支持互联网包交换 (IPX) 协议、NetBIOS 数据包 (NBF) 协议等。'
- en: The PPP encapsulation method and LCP are defined in the main PPP standard and
    some support standards; the NCPs are described in separate standard documents,
    one per NCP.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: PPP 封装方法和 LCP 定义在主要的 PPP 标准和一些支持标准中；NCPs 在单独的标准文档中描述，每个 NCP 一个文档。
- en: PPP Functional Groups
  id: totrans-90
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PPP 功能组
- en: 'While PPP''s main components constitute much of the total package, I would
    add two additional functional groups. These represent some of the many extra protocols
    that have been added to the suite over time to support or enhance its basic operation:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然PPP的主要组件构成了总包的大部分，但我还会添加两个额外的功能组。这些代表了随着时间的推移添加到套件中的许多额外协议，以支持或增强其基本操作：
- en: '**LCP Support Protocols** Several protocols in the PPP suite are used during
    the link negotiation process, either to manage it or to configure options. Examples
    include the authentication protocols Challenge Handshake Authentication Protocol
    (CHAP) and Password Authentication Protocol (PAP), which are used by LCP during
    the optional Authentication phase. These are discussed in [Chapter 10](ch10.html
    "Chapter 10. PPP CORE PROTOCOLS: LINK CONTROL, NETWORK CONTROL, AND AUTHENTICATION").'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '**LCP 支持协议** PPP 套件中的几个协议在链路协商过程中使用，用于管理或配置选项。例如，挑战握手认证协议 (CHAP) 和密码认证协议 (PAP)
    是在可选的认证阶段由 LCP 使用的认证协议。这些内容在[第 10 章](ch10.html "第 10 章。PPP 核心协议：链路控制、网络控制和认证")中有讨论。'
- en: '**LCP Optional Feature Protocols** A number of protocols have been added to
    the basic PPP suite over the years to enhance its operation once a link has been
    set up and datagrams are being passed between devices. For example, the PPP Compression
    Control Protocol (CCP) allows compression of PPP data; the PPP Encryption Control
    Protocol (ECP) enables datagrams to be encrypted for security; and the PPP Multilink
    Protocol (PPP MP) allows a single PPP link to be operated over multiple physical
    links. These protocols often also require additional setup during link negotiation,
    so many of them define extensions (such as extra configuration options) that are
    negotiated as part of LCP.'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '**LCP 可选功能协议**多年来，许多协议被添加到基本的 PPP 套件中，以增强链路设置后和设备之间传输数据报的操作。例如，PPP 压缩控制协议 (CCP)
    允许压缩 PPP 数据；PPP 加密控制协议 (ECP) 允许对数据报进行加密以提高安全性；PPP 多链路协议 (PPP MP) 允许单个 PPP 链路在多个物理链路上运行。这些协议通常在链路协商期间也需要额外的设置，因此许多它们定义了扩展（例如额外的配置选项），这些扩展作为
    LCP 协商的一部分。'
- en: Note
  id: totrans-94
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*Each optional protocol is defined by a specific standards document, as you
    will see later in this chapter*.'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: '*每个可选协议都由一个特定的标准文档定义，正如你将在本章后面看到的那样*。'
- en: General Operation
  id: totrans-96
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 一般操作
- en: 'Although the PPP suite includes dozens of protocols, its general operation
    is really quite straightforward. Essentially, PPP involves the following three
    basic steps (see [Figure 9-3](ch09s03.html#overview_of_ppp_operation_in_simplest_te
    "Figure 9-3. Overview of PPP operation In simplest terms, PPP consists of only
    three basic steps: link setup, link operation, and link termination.")):'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然PPP套件包括数十个协议，但其一般操作实际上非常简单。基本上，PPP涉及以下三个基本步骤（参见[图 9-3](ch09s03.html#overview_of_ppp_operation_in_simplest_te
    "图 9-3。以最简单的术语概述PPP操作，PPP仅由三个基本步骤组成：链路设置、链路操作和链路终止."))：
- en: '**Link Setup and Configuration** Before the two devices can exchange information,
    they must make contact and set up a link between them. During link setup, the
    devices agree on all the parameters needed to manage the operation of the link.
    LCP begins this process and invokes the help of support protocols as needed, for
    options like authentication. Once the link is set up, in order to complete link
    setup, the appropriate NCP is called for whatever layer 3 technology is being
    carried on the link.'
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**链路设置和配置** 在两个设备可以交换信息之前，它们必须相互联系并设置它们之间的链路。在链路设置过程中，设备就管理链路操作所需的所有参数达成一致。LCP开始这个过程，并在需要时调用支持协议，例如身份验证。一旦链路建立，为了完成链路设置，将调用适当的NCP来处理链路上传输的任何第三层技术。'
- en: '**Link Operation** The devices use the link to send datagrams. Each device
    transmits by encapsulating layer 3 datagrams and sending them down to layer 1
    to be transmitted. Each device receives by taking PPP frames sent up from its
    own physical layer, stripping off the PPP header and passing the datagram up to
    layer 3\. Where appropriate, optional protocols are used at this stage to offer
    features such as compression (CCP).'
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**链路操作** 设备使用链路发送数据报。每个设备通过封装第三层数据报并将其发送到第1层进行传输来传输。每个设备通过从自己的物理层接收发送上来的PPP帧，移除PPP头部并将数据报传递到第3层来接收。在适当的情况下，使用可选协议提供如压缩（CCP）等功能。'
- en: '**Link Termination** When either device decides that it no longer wants to
    communicate, it terminates the link.'
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**链路终止** 当任一设备决定不再想要通信时，它会终止链路。'
- en: '![Overview of PPP operation In simplest terms, PPP consists of only three basic
    steps: link setup, link operation, and link termination.](httpatomoreillycomsourcenostarchimages287729.png.jpg)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
  zh: '![PPP操作的概述 以最简单的术语来说，PPP只包含三个基本步骤：链路设置、链路操作和链路终止。](httpatomoreillycomsourcenostarchimages287729.png.jpg)'
- en: 'Figure 9-3. Overview of PPP operation In simplest terms, PPP consists of only
    three basic steps: link setup, link operation, and link termination.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 图9-3. PPP操作的概述 以最简单的术语来说，PPP只包含三个基本步骤：链路设置、链路操作和链路终止。
- en: Link setup is by far the most complicated of these general steps, because it
    involves several substeps used to negotiate link parameters and options.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 链路设置是这些一般步骤中最复杂的，因为它涉及几个子步骤，用于协商链路参数和选项。
- en: PPP Link Setup and Phases
  id: totrans-104
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PPP链路设置和阶段
- en: Before data can be exchanged on a PPP connection, a link must be set up between
    the two devices. As part of this setup task, a configuration process is undertaken
    whereby the devices configure the link and agree on the parameters for how data
    should be passed between them. Only when this is completed can frames actually
    pass over the link.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 在PPP连接上交换数据之前，必须在两个设备之间建立链路。作为此设置任务的一部分，进行配置过程，其中设备配置链路并就数据如何在他们之间传输的参数达成一致。只有完成这一步骤后，帧才能实际通过链路传输。
- en: LCP is generally in charge of setting up and maintaining PPP links. LCP may
    invoke an authentication protocol (PAP or CHAP) when PPP is configured to use
    authentication. Once an LCP link has been opened, PPP invokes one or more NCPs
    for the layer 3 protocol being carried on the link. These perform any network-layer-specific
    configuration needed before the link can carry that particular network layer protocol.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: LCP通常负责设置和维护PPP链路。当PPP配置为使用身份验证时，LCP可能会调用一个身份验证协议（PAP或CHAP）。一旦LCP链路已打开，PPP将调用一个或多个NCP来处理链路上传输的第三层协议。这些NCP执行在链路能够携带特定网络层协议之前所需的任何网络层特定配置。
- en: 'The operation of a PPP link can be described as having a life of sorts: A PPP
    link is established, configured, used, and eventually terminated. The process
    of setting up, using, and closing a PPP link is described in the PPP standard
    as a series of *phases* or *states*. This is a type of *finite state machine (FSM)*,
    which is a tool used to explain the operation of protocols. The general concept
    behind an FSM is described in the section discussing the finite state machine
    of the Transmission Control Protocol (TCP), in [Chapter 47](ch47.html "Chapter 47. TCP
    BASIC OPERATION: CONNECTION ESTABLISHMENT, MANAGEMENT, AND TERMINATION").'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: PPP链路的操作可以描述为具有一定的生命周期：PPP链路建立、配置、使用，最终终止。设置、使用和关闭PPP链路的过程在PPP标准中被描述为一系列*阶段*或*状态*。这是一种*有限状态机（FSM）*，它是用来解释协议操作的工具。有限状态机背后的基本概念在讨论传输控制协议（TCP）的有限状态机的章节中描述，见[第47章](ch47.html
    "第47章。TCP基本操作：连接建立、管理和终止")。
- en: To better understand how PPP works, let's look at these phases and how the transition
    is made from one to the next during the lifetime of the link. For the sake of
    clarity, this description is based on an example for which Device A is a PC connecting
    via dial-up networking to Remote Host B (see [Figure 9-4](ch09s03.html#ppp_phases_a_ppp_connection_follows_a_ma
    "Figure 9-4. PPP phases A PPP connection follows a mainly linear sequence of transitions
    from the Link Dead Phase through the Link Open Phase.")).
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更好地理解PPP是如何工作的，让我们看看这些阶段，以及链路生命周期中从一个阶段过渡到下一个阶段是如何进行的。为了清晰起见，这个描述基于一个例子，其中设备A是通过拨号网络连接到远程主机B的PC（参见[图9-4](ch09s03.html#ppp_phases_a_ppp_connection_follows_a_ma
    "图9-4。PPP阶段A PPP连接遵循从链路死亡阶段通过链路打开阶段的主要线性序列转换。")）。
- en: Note
  id: totrans-109
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*When we talk about a PPP link overall, we are talking about the status of
    the LCP connection between the two devices. Once an LCP link has been opened,
    each of the NCPs used on the link can be opened or closed independently of the
    overall PPP (LCP) link. You''ll see how this works momentarily*.'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: '*当我们总体上谈论PPP链路时，我们是在谈论两个设备之间的LCP连接状态。一旦打开了一个LCP链路，链路上的每个NCP都可以独立于整体的PPP（LCP）链路打开或关闭。你很快就会看到这是如何工作的*。'
- en: Link Dead Phase
  id: totrans-111
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 链路死亡阶段
- en: By design, the PPP link always begins and ends in the *Link Dead* phase. This
    phase represents the situation in which there is no physical layer link established
    between the two devices. The link remains here until the physical layer link is
    set up, at which point it proceeds to the *Link Establishment* phase.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 设计上，PPP链路始终从*链路死亡*阶段开始和结束。这个阶段表示两个设备之间没有建立物理层链路的情况。链路将保持在这个阶段，直到物理层链路建立，此时它将进入*链路建立*阶段。
- en: In this example, when Device A is first turned on, there is no physical layer
    connection (modem connection) between it and Device B. Once the connection is
    made, the link can proceed to phase 2.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，当设备A首次开启时，它与设备B之间没有物理层连接（调制解调器连接）。一旦建立连接，链路就可以进入第2阶段。
- en: Note
  id: totrans-114
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*In a direct connection, such as a serial cable linking two PCs, the link may
    stay in the Link Dead phase for only a fraction of a second, until the physical
    layer connection is detected*.'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: '*在直接连接中，例如通过串行电缆连接两个PC，链路可能只保持在链路死亡阶段几秒钟，直到检测到物理层连接*。'
- en: Link Establishment Phase
  id: totrans-116
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 链路建立阶段
- en: 'The physical layer is now connected and LCP performs the basic setup of the
    link. Device A sends an LCP configuration request message to Device B over the
    physical link, specifying the parameters it wishes to use. If Device B agrees,
    it replies with an acknowledgment. If Device B doesn''t agree, it returns a negative
    acknowledgment or rejection, telling Device A what it won''t accept. Device A
    can then try a different configuration request with new parameters that Device
    B may accept. (This process is described in more detail in [Chapter 10](ch10.html
    "Chapter 10. PPP CORE PROTOCOLS: LINK CONTROL, NETWORK CONTROL, AND AUTHENTICATION").)'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 物理层现在已连接，LCP执行链路的基本设置。设备A通过物理链路向设备B发送一个LCP配置请求消息，指定它希望使用的参数。如果设备B同意，它将回复一个确认。如果设备B不同意，它将返回一个否定确认或拒绝，告诉设备A它不接受什么。然后设备A可以尝试使用设备B可能接受的新的参数的不同配置请求。（这个过程在[第10章](ch10.html
    "第10章。PPP核心协议：链路控制、网络控制和认证")中有更详细的描述。）
- en: If Device A and Device B eventually come to agreement, the link status is considered
    *LCP open* and will proceed to the *Authentication* phase. If they cannot agree,
    the physical link is terminated, and it returns to the Link Dead phase.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 如果设备A和设备B最终达成一致，链路状态被认为是*LCP打开*，并将进入*认证*阶段。如果它们无法达成一致，物理链路将被终止，并返回到链路死亡阶段。
- en: Authentication Phase
  id: totrans-119
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 认证阶段
- en: In many cases, a device may require authentication before it will permit another
    device to connect. (This is usually the case when PPP is used for dial-up.) Authentication
    is not mandatory in PPP, however. When it is used, the appropriate authentication
    protocol (CHAP or PAP) is employed.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多情况下，设备可能需要在允许另一个设备连接之前进行认证。（这通常是在使用PPP进行拨号时的情况。）然而，在PPP中认证不是强制的。当使用时，将采用适当的认证协议（CHAP或PAP）。
- en: After successful authentication, the link proceeds to the *Network Layer Protocol*
    phase. If authentication is not successful, the link fails and transitions to
    the *Link Termination* phase.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 在认证成功后，链路将进入*网络层协议*阶段。如果认证不成功，链路将失败并过渡到*链路终止*阶段。
- en: Network Layer Protocol Phase
  id: totrans-122
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 网络层协议阶段
- en: Once the basic link has been configured and authentication has completed, the
    general setup of the LCP link is complete. Now, the specific configuration of
    the appropriate network layer protocol is performed by invoking the appropriate
    NCP, such as IPCP, IPXCP, and so forth.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦基本链路配置完成并且认证完成，LCP链路的一般设置就完成了。现在，通过调用适当的NCP，如IPCP、IPXCP等，执行适当的网络层协议的具体配置。
- en: Each particular network layer protocol whose NCP is successfully configured
    is considered to be open on the LCP link. More than one NCP can be open on a particular
    PPP link, and each can be closed independently when it is no longer needed. Once
    all necessary NCPs have been invoked, the link proceeds to the *Link Open* state,
    even if none of the NCPs were successfully opened.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 每个成功配置了NCP的特定网络层协议被认为在LCP链路上是开启的。一个PPP链路上可以开启多个NCP，并且当不再需要时，每个都可以独立关闭。一旦所有必要的NCP都已被调用，链路将进入*链路开启*状态，即使没有任何NCP成功开启。
- en: Note
  id: totrans-125
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*Some PPP features require the negotiation of additional options between the
    two devices, which may perform their own link establishment process during the*
    Network Layer Protocol *phase. The PPP Compression Control Protocol (CCP) sets
    up data compression in this manner*.'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: '*某些PPP特性需要在两个设备之间协商额外的选项，这些设备在*网络层协议*阶段可能会执行自己的链路建立过程。PPP压缩控制协议（CCP）以这种方式设置数据压缩*。'
- en: Link Open Phase
  id: totrans-127
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 链路开启阶段
- en: In the Link Open state, the LCP link and one or more NCP links are open and
    operational. Data can be passed for each NCP that has been successfully set up.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 在链路开启状态下，LCP链路和一个或多个NCP链路是开启并操作的。对于每个成功设置的NCP，都可以传递数据。
- en: The link can be terminated at any time by either device for a variety of reasons.
    These may include a user request (you click Disconnect when you want to log off
    your dial-up session); link quality problems (the modem hangs up on you due to
    line noise); or some other cause (you spend too much time in the bathroom and
    your ISP's idle timer logs you out). When any of these occur, the LCP link is
    broken, and the link transitions to the *Link Termination* phase.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 链路可以因各种原因在任何时间由任一设备终止。这些原因可能包括用户请求（当你想要断开拨号会话时，你点击断开连接）；链路质量问题（由于线路噪音，调制解调器挂断）；或其它原因（你在洗手间花费了太多时间，你的ISP的闲置计时器将你登出）。当这些情况中的任何一种发生时，LCP链路被中断，链路进入*链路终止*阶段。
- en: Link Termination Phase
  id: totrans-130
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 链路终止阶段
- en: The device terminating the link sends a special LCP termination frame, and the
    other device acknowledges it. The link then returns to the Link Dead phase. If
    the termination was by request and the physical layer connection is still active,
    the PPP implementation should specifically signal the physical layer to terminate
    the layer 1 connection.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 终止链路的设备发送一个特殊的LCP终止帧，另一个设备确认它。然后链路返回到链路死亡阶段。如果终止是请求的，并且物理层连接仍然活跃，PPP实现应该特别向物理层发出信号以终止第1层连接。
- en: You should remember that the basic link is established by LCP, and NCP links
    are set up within the LCP link. Closing an NCP link does not cause the LCP link
    to be closed. Even if all NCPs are closed, the LCP link remains open. (Of course,
    no data can be passed until an appropriate NCP link is reestablished; a device
    is required to discard frames received that contain any layer 3 protocol that
    does not have an open NCP.) To terminate a PPP connection, only the LCP link needs
    to be terminated in the *Link Termination* phase; the NCPs do not need to be explicitly
    closed.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该记住，基本链路是由LCP建立的，NCP链路是在LCP链路内设置的。关闭NCP链路不会导致LCP链路关闭。即使所有NCP都关闭，LCP链路仍然保持开启状态。（当然，在适当的NCP链路重新建立之前，无法传递数据；需要设备丢弃包含任何没有开启NCP的第3层协议的帧。）要终止PPP连接，只需要在*链路终止*阶段终止LCP链路；NCP不需要显式关闭。
- en: '[Figure 9-4](ch09s03.html#ppp_phases_a_ppp_connection_follows_a_ma "Figure 9-4. PPP
    phases A PPP connection follows a mainly linear sequence of transitions from the
    Link Dead Phase through the Link Open Phase.") shows the PPP phases and the circumstances
    under which transitions occur between them. The PPP connection between two devices
    begins in the Link Dead state and proceeds through three intermediate phases until
    the link is fully opened. It remains in the stable Link Open phase until terminated.
    The lighter boxes show the corresponding change in the status of the PPP link
    as transitions are made between phases.'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: '[图9-4](ch09s03.html#ppp_phases_a_ppp_connection_follows_a_ma "图9-4. PPP阶段 一个PPP连接遵循从链接失效阶段通过链接开启阶段的主要线性转换序列。")展示了PPP阶段及其之间转换发生的情况。两个设备之间的PPP连接从链接失效状态开始，经过三个中间阶段，直到链接完全开启。它保持在稳定的链接开启阶段，直到终止。较浅的框显示了在阶段之间转换时PPP链接状态的相应变化。'
- en: '![PPP phases A PPP connection follows a mainly linear sequence of transitions
    from the Link Dead Phase through the Link Open Phase.](httpatomoreillycomsourcenostarchimages287731.png.jpg)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![PPP阶段 一个PPP连接遵循从链接失效阶段通过链接开启阶段的主要线性转换序列。](httpatomoreillycomsourcenostarchimages287731.png.jpg)'
- en: Figure 9-4. PPP phases A PPP connection follows a mainly linear sequence of
    transitions from the Link Dead Phase through the Link Open Phase.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 图9-4. PPP阶段 一个PPP连接遵循从链接失效阶段通过链接开启阶段的主要线性转换序列。
- en: '[Table 9-1](ch09s03.html#ppp_phases "Table 9-1. PPP Phases") summarizes the
    PPP phases; the LCP Link Status and NCP Link Status columns show the status of
    the link as the phase starts.'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: '[表9-1](ch09s03.html#ppp_phases "表9-1. PPP阶段")总结了PPP阶段；LCP链接状态和NCP链接状态列显示了阶段开始时链接的状态。'
- en: PPP Standards
  id: totrans-137
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PPP标准
- en: While it makes sense for different parts of PPP to be covered in different standards,
    this does make it much harder to learn how PPP works. Also, literally *dozens*
    of RFCs cover PPP's main operation, its various protocols, and other related issues.
    You can find most of them by consulting a master list of RFCs and searching for
    the string "PPP," but you will find them in numerical (RFC number) order, which
    isn't very meaningful in terms of how the protocols are used. You also have to
    differentiate between the ones that are current and those that are obsolete.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然PPP的不同部分由不同的标准覆盖是有意义的，但这确实使得学习PPP的工作原理变得更加困难。此外，确实有数十个RFC涵盖了PPP的主要操作、其各种协议和其他相关问题。您可以通过查阅RFC的主列表并搜索字符串“PPP”来找到它们，但您将按数字顺序（RFC编号）找到它们，这在协议的使用方面意义不大。您还必须区分当前的和过时的RFC。
- en: Table 9-1. PPP Phases
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 表9-1. PPP阶段
- en: '| Phase/State | Phase Summary | LCP Link Status Upon Entry to Phase | NCP Link
    Status Upon Entry to Phase | Transition Requirement | Transition to Phase |'
  id: totrans-140
  prefs: []
  type: TYPE_TB
  zh: '| 阶段/状态 | 阶段摘要 | 进入阶段时的LCP链接状态 | 进入阶段时的NCP链接状态 | 转换要求 | 转换到阶段 |'
- en: '| --- | --- | --- | --- | --- | --- |'
  id: totrans-141
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- |'
- en: '| Link Dead | Default state; physical layer not connected. | Closed | Closed
    | Successful physical layer connection | Link establishment |'
  id: totrans-142
  prefs: []
  type: TYPE_TB
  zh: '| 链接失效 | 默认状态；物理层未连接。 | 关闭 | 关闭 | 成功的物理层连接 | 链接建立 |'
- en: '| Link Establishment | Physical layer connected, basic configuration of link
    performed by LCP. | Closed | Closed | Successful negotiation | Authentication
    |'
  id: totrans-143
  prefs: []
  type: TYPE_TB
  zh: '| 链接建立 | 物理层已连接，链路的基本配置由LCP执行。 | 关闭 | 关闭 | 成功协商 | 认证 |'
- en: '|   |   |   |   | Unsuccessful negotiation | Link dead |'
  id: totrans-144
  prefs: []
  type: TYPE_TB
  zh: '|   |   |   |   | 未成功的谈判 | 链接失效 |'
- en: '| Authentication | Basic link is now opened, and optional authentication of
    device is performed. | Open | Closed | Successful authentication or no authentication
    required | Network layer protocol |'
  id: totrans-145
  prefs: []
  type: TYPE_TB
  zh: '| 认证 | 基本链接现在已开启，并执行设备可选认证。 | 开启 | 关闭 | 成功认证或无需认证 | 网络层协议 |'
- en: '|   |   |   |   | Unsuccessful authentication | Link termination |'
  id: totrans-146
  prefs: []
  type: TYPE_TB
  zh: '|   |   |   |   | 认证失败 | 链接终止 |'
- en: '| Network Layer Protocol | One or more NCPs open an NCP link within the LCP
    link. | Open | Closed | All NCPs opened | Link open |'
  id: totrans-147
  prefs: []
  type: TYPE_TB
  zh: '| 网络层协议 | 一个或多个NCP在LCP链接内打开NCP链接。 | 开启 | 关闭 | 所有NCP已开启 | 链接开启 |'
- en: '| Link Open | Link is open and operating normally. | Open | Open | Link failure
    or close request | Link termination |'
  id: totrans-148
  prefs: []
  type: TYPE_TB
  zh: '| 链接开启 | 链接开启并正常运行。 | 开启 | 开启 | 链接故障或关闭请求 | 链接终止 |'
- en: '| Link Termination | LCP link is shut down. | Open | Open |   | Link dead |'
  id: totrans-149
  prefs: []
  type: TYPE_TB
  zh: '| 链接终止 | LCP链接关闭。 | 开启 | 开启 |   | 链接失效 |'
- en: '[Table 9-2](ch09s03.html#ppp_standards-id001 "Table 9-2. PPP Standards") lists
    the most important and interesting PPP-related RFCs. To make it easier to see
    what the RFCs are about, I have organized them into five groups, as follows:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: '[表9-2](ch09s03.html#ppp_standards-id001 "表9-2. PPP标准")列出了最重要的和有趣的PPP相关RFC。为了更容易地了解RFC的内容，我已经将它们组织成五个组，如下所示：'
- en: '**Core** These are PPP''s main documents. They cover the basic operation of
    PPP including the PPP LCP and encapsulation of datagrams.'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: '**核心** 这些是PPP的主要文档。它们涵盖了PPP的基本操作，包括PPP LCP和数据报封装。'
- en: '**LCP Support** These protocols support the basic operation of LCP. I''ve only
    included the ones that provide authentication services during link startup.'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: '**LCP支持** 这些协议支持LCP的基本操作。我只包括在链路启动期间提供认证服务的那些协议。'
- en: '**NCPs** These protocols negotiate parameters specific to various layer 3 protocols
    carried over PPP.'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '**NCPs** 这些协议协商PPP承载的各种第3层协议的特定参数。'
- en: '**Features** These protocols define optional features used with PPP, such as
    compression and encryption.'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: '**功能** 这些协议定义了与PPP一起使用的可选功能，例如压缩和加密。'
- en: '**Applications and Miscellaneous** These are the protocols that describe how
    PPP can be adapted to run over particular types of links or that don''t really
    fit into any of the previous groups.'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '**应用和杂项** 这些是描述PPP如何适应在特定类型的链路上运行或实际上不适合任何前述组的协议。'
- en: Within each group, the RFCs are listed in numerical order, which is also date
    order. Only the most recent RFC is listed, not earlier ones that were made obsolete
    (with the exception of RFC 1334, which, despite being made obsolete, is still
    important).
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 在每个组内，RFC按数字顺序列出，也就是日期顺序。只列出最新的RFC，不包括已被废弃的较早的RFC（除了RFC 1334，尽管已被废弃，但仍然很重要）。
- en: Table 9-2. PPP Standards
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 表9-2. PPP标准
- en: '| Group | RFC Number | Standard Name | Description |'
  id: totrans-158
  prefs: []
  type: TYPE_TB
  zh: '| 组 | RFC编号 | 标准名称 | 描述 |'
- en: '| --- | --- | --- | --- |'
  id: totrans-159
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| Core | 1570 | PPP LCP Extensions | Defines two features for LCP that allow
    devices to identify each other and for each device to tell the other how much
    time remains in the current session. |'
  id: totrans-160
  prefs: []
  type: TYPE_TB
  zh: '| 核心 | 1570 | PPP LCP扩展 | 定义了两个LCP功能，允许设备相互识别，并让每个设备告诉对方当前会话剩余多少时间。|'
- en: '|   | 1661 | The Point-to-Point Protocol (PPP) | Base standard for PPP. Describes
    PPP architecture, general operation (including the process of link establishment,
    maintenance, and termination), and details of LCP. |'
  id: totrans-161
  prefs: []
  type: TYPE_TB
  zh: '|   | 1661 | 点对点协议（PPP） | PPP的基本标准。描述了PPP架构、一般操作（包括链路建立、维护和终止的过程）以及LCP的详细信息。|'
- en: '|   | 1662 | PPP in HDLC-like Framing | Defines the specific framing method
    for PPP frames, based on that used in HDLC. This standard can be considered a
    companion to the main PPP standard, RFC 1661. |'
  id: totrans-162
  prefs: []
  type: TYPE_TB
  zh: '|   | 1662 | 类似于HDLC的PPP帧 | 定义了PPP帧的具体帧格式，基于在HDLC中使用的格式。这个标准可以被认为是主要PPP标准RFC
    1661的补充。|'
- en: '| LCP Support | 1334 | PPP Authentication Protocols | Defines the two PPP authentication
    protocols: PAP and CHAP. Note that RFC 1994 obsoletes RFC 1334, but does not discuss
    the PAP. (That tells you that the IETF doesn''t think highly of PAP; see [Chapter 10](ch10.html
    "Chapter 10. PPP CORE PROTOCOLS: LINK CONTROL, NETWORK CONTROL, AND AUTHENTICATION")
    for more on this.) |'
  id: totrans-163
  prefs: []
  type: TYPE_TB
  zh: '| LCP支持 | 1334 | PPP认证协议 | 定义了两个PPP认证协议：PAP和CHAP。请注意，RFC 1994废弃了RFC 1334，但没有讨论PAP。（这表明IETF对PAP的看法不高；有关更多信息，请参阅[第10章](ch10.html
    "第10章. PPP核心协议：链路控制、网络控制和认证")。）|'
- en: '|   | 1994 | PPP Challenge Handshake Authentication Protocol (CHAP) | Updates
    the information about CHAP provided in RFC 1334. |'
  id: totrans-164
  prefs: []
  type: TYPE_TB
  zh: '|   | 1994 | PPP挑战握手认证协议（CHAP） | 更新了RFC 1334中提供的CHAP信息。|'
- en: '| NCPs | 1332 | The PPP Internet Protocol Control Protocol (IPCP) | The NCP
    for IP. |'
  id: totrans-165
  prefs: []
  type: TYPE_TB
  zh: '| NCPs | 1332 | PPP互联网协议控制协议（IPCP） | IP的NCP。|'
- en: '|   | 1377 | The PPP OSI Network Layer Control Protocol (OSINLCP) | The NCP
    for OSI protocol suite network layer protocols, such as CNLP, ES-IS, and IS-IS.
    |'
  id: totrans-166
  prefs: []
  type: TYPE_TB
  zh: '|   | 1377 | PPP OSI网络层控制协议（OSINLCP） | OSI协议套件网络层协议（如CNLP、ES-IS和IS-IS）的NCP。|'
- en: '|   | 1378 | The PPP AppleTalk Control Protocol (ATCP) | The NCP for the AppleTalk
    protocol. |'
  id: totrans-167
  prefs: []
  type: TYPE_TB
  zh: '|   | 1378 | PPP AppleTalk控制协议（ATCP） | AppleTalk协议的NCP。|'
- en: '|   | 1552 | The PPP Internetworking Packet Exchange Control Protocol (IPXCP)
    | The NCP for the Novell IPX protocol. |'
  id: totrans-168
  prefs: []
  type: TYPE_TB
  zh: '|   | 1552 | PPP互连包交换控制协议（IPXCP） | Novell IPX协议的NCP。|'
- en: '|   | 2043 | The PPP SNA Control Protocol (SNACP) | The NCP for IBM''s Systems
    Network Architecture (SNA). |'
  id: totrans-169
  prefs: []
  type: TYPE_TB
  zh: '|   | 2043 | PPP SNA控制协议（SNACP） | IBM系统网络架构（SNA）的NCP。|'
- en: '|   | 2097 | The PPP NetBIOS Frames Control Protocol (NBFCP) | The NCP for
    NetBIOS Frames (NBF, also commonly called NetBEUI). |'
  id: totrans-170
  prefs: []
  type: TYPE_TB
  zh: '|   | 2097 | PPP NetBIOS帧控制协议（NBFCP） | NetBIOS帧（NBF，也常称为NetBEUI）的NCP。|'
- en: '|   | 2472 | IP Version 6 over PPP | The NCP for IPv6: the IPv6 Control Protocol
    (IPv6CP). |'
  id: totrans-171
  prefs: []
  type: TYPE_TB
  zh: '|   | 2472 | PPP上的IPv6版本 | IPv6的NCP：IPv6控制协议（IPv6CP）。|'
- en: '| Features | 1962 | The PPP Compression Control Protocol (CCP) | Defines a
    mechanism for compressing data sent over PPP links to improve performance. This
    standard describes how compression is negotiated between two devices on a PPP
    link. It is used in conjunction with several compression algorithms that actually
    do the compression of data. |'
  id: totrans-172
  prefs: []
  type: TYPE_TB
  zh: '| 功能 | 1962 | PPP压缩控制协议（CCP） | 定义了一种压缩通过PPP链路发送的数据的机制，以提高性能。本标准描述了如何在PPP链路上的两个设备之间协商压缩。它与几个实际执行数据压缩的压缩算法一起使用。|'
- en: '|   | 1968 | The PPP Encryption Control Protocol (ECP) | Defines a mechanism
    for encrypting data sent over PPP links to improve performance. This standard
    describes how encryption is negotiated between two devices. It is used with several
    encryption algorithms. |'
  id: totrans-173
  prefs: []
  type: TYPE_TB
  zh: '|   | 1968 | PPP加密控制协议（ECP） | 定义了一种加密通过PPP链路发送的数据的机制，以提高性能。本标准描述了如何在两个设备之间协商加密。它与几个加密算法一起使用。|'
- en: '|   | 1989 | PPP Link Quality Monitoring | Defines a protocol that lets PPP
    devices generate reports to each other about the quality of the link. |'
  id: totrans-174
  prefs: []
  type: TYPE_TB
  zh: '|   | 1989 | PPP链路质量监控 | 定义了一种协议，允许PPP设备相互生成关于链路质量的报告。|'
- en: '|   | 1990 | The PPP Multilink Protocol (MP) | Defines a method for running
    PPP over a set of aggregated links, thereby allowing two devices to use multiple
    low-bandwidth links as a single, high-bandwidth virtual link. |'
  id: totrans-175
  prefs: []
  type: TYPE_TB
  zh: '|   | 1990 | PPP多链路协议（MP） | 定义了在一系列聚合链路上运行PPP的方法，从而允许两个设备将多个低带宽链路作为一个单一的高带宽虚拟链路使用。|'
- en: '|   | 2125 | The PPP Bandwidth Allocation Protocol (BAP)/The PPP Bandwidth
    Allocation Control Protocol (BACP) | Defines two support protocols that manage
    the allocation of bandwidth in links aggregated using PPP MP. |'
  id: totrans-176
  prefs: []
  type: TYPE_TB
  zh: '|   | 2125 | PPP带宽分配协议（BAP）/PPP带宽分配控制协议（BACP） | 定义了两个支持协议，用于管理使用PPP MP聚合的链路上的带宽分配。|'
- en: '| Applications and Miscellaneous | 1618 | PPP over ISDN | Describes application
    particulars for running PPP over ISDN links. |'
  id: totrans-177
  prefs: []
  type: TYPE_TB
  zh: '| 应用和杂项 | 1618 | PPP over ISDN | 描述了在ISDN链路上运行PPP的应用特定细节。|'
- en: '|   | 1973 | PPP in Frame Relay | Describes how PPP may be modified to run
    over Frame Relay at layer 2. |'
  id: totrans-178
  prefs: []
  type: TYPE_TB
  zh: '|   | 1973 | PPP在帧中继上 | 描述了如何修改PPP以在第二层上通过帧中继运行。|'
- en: '|   | 2290 | Mobile-IPv4 Configuration Option for PPP IPCP | Defines changes
    to the PPP Internet Protocol Control Protocol (IPCP) to support Mobile IP. |'
  id: totrans-179
  prefs: []
  type: TYPE_TB
  zh: '|   | 2290 | PPP IPCP的移动IPv4配置选项 | 定义了对PPP互联网协议控制协议（IPCP）的更改，以支持移动IP。|'
- en: '|   | 2364 | PPP over AAL5 | Defines a method for sending PPP frames over AAL5
    (ATM), commonly called PPPoA. |'
  id: totrans-180
  prefs: []
  type: TYPE_TB
  zh: '|   | 2364 | PPP over AAL5 | 定义了一种在AAL5（ATM）上发送PPP帧的方法，通常称为PPPoA。|'
- en: '|   | 2516 | A Method for Transmitting PPP over Ethernet (PPPoE) | Defines
    a technique for encapsulating PPP frames over Ethernet (PPPoE). |'
  id: totrans-181
  prefs: []
  type: TYPE_TB
  zh: '|   | 2516 | 通过以太网（PPPoE）传输PPP的方法 | 定义了一种封装PPP帧通过以太网（PPPoE）的技术。|'
- en: '|   | 2615 | PPP over SONET/SDH | Discusses how to encapsulate PPP frames over
    SONET/SDH links. |'
  id: totrans-182
  prefs: []
  type: TYPE_TB
  zh: '|   | 2615 | PPP over SONET/SDH | 讨论了如何在SONET/SDH链路上封装PPP帧。|'
- en: 'Chapter 10. PPP CORE PROTOCOLS: LINK CONTROL, NETWORK CONTROL, AND AUTHENTICATION'
  id: totrans-183
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第10章. PPP核心协议：链路控制、网络控制和认证
- en: '![image with no caption](httpatomoreillycomsourcenostarchimages287681.png.jpg)'
  id: totrans-184
  prefs: []
  type: TYPE_IMG
  zh: '![无标题图片](httpatomoreillycomsourcenostarchimages287681.png.jpg)'
- en: This chapter describes the protocols responsible for PPP link setup and basic
    operation, including Link Control Protocol (LCP) and the Network Control Protocols
    (NCPs) used to configure PPP for different layer 3 protocols. I also discuss the
    two PPP authentication protocols, Password Authentication Protocol (PAP) and Challenge
    Handshake Authentication Protocol (CHAP), which are used to provide authentication
    during link setup.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 本章描述了负责PPP链路设置和基本操作的协议，包括链路控制协议（LCP）和用于配置PPP以适应不同第3层协议的网络控制协议（NCPs）。我还讨论了两个PPP认证协议，密码认证协议（PAP）和挑战握手认证协议（CHAP），它们用于在链路设置期间提供认证。
- en: Link Control Protocol (LCP)
  id: totrans-186
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 链路控制协议（LCP）
- en: 'Of all the PPP suite protocols, LCP is the most important. It is responsible
    for PPP''s overall successful operation, and plays a key role in each PPP link
    stage: configuration, maintenance, and termination (as discussed in [Chapter 9](ch09.html
    "Chapter 9. TCP/IP SERIAL LINE INTERNET PROTOCOL (SLIP) AND POINT-TO-POINT PROTOCOL
    (PPP) OVERVIEW AND FUNDAMENTALS")). Link configuration is performed during the
    initial link establishment phase; link maintenance occurs while the link is open,
    and link termination happens in the link termination phase.'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 在所有PPP套件协议中，LCP是最重要的。它负责PPP的整体成功运行，并在每个PPP链路阶段（配置、维护和终止，如第9章所述）中发挥关键作用（[第9章](ch09.html
    "第9章。TCP/IP串行线路互联网协议（SLIP）和点对点协议（PPP）概述和基础")）。链路配置在初始链路建立阶段执行；链路维护在链路开启期间进行；链路终止发生在链路终止阶段。
- en: '[Figure 10-1](ch10.html#ppp_link_control_protocol_lcp_message_ex "Figure 10-1. PPP
    Link Control Protocol (LCP) message exchanges This diagram shows the different
    message exchanges performed by LCP during link configuration, maintenance, and
    termination.") provides an overview of many of the message exchanges performed
    by LCP during different phases of a PPP connection. Link configuration is shown
    here as a simple exchange of a Configure-Request and Configure-Ack. After subsequent
    exchanges using other PPP protocols to authenticate and configure one or more
    NCPs, the link enters the link open phase. In this example, Echo-Request and Echo-Reply
    messages are first used to test the link, followed by the sending and receiving
    of data by both devices. One Data message is shown being rejected due to an invalid
    Code field. Finally, the link is terminated using Terminate-Request and Terminate-Ack
    messages.'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: '[图10-1](ch10.html#ppp_link_control_protocol_lcp_message_ex "图10-1。PPP链路控制协议（LCP）消息交换
    此图显示了LCP在链路配置、维护和终止期间执行的不同消息交换")概述了LCP在PPP连接的不同阶段执行的大多数消息交换。链路配置在此显示为简单的配置请求和配置确认的交换。在随后的交换中使用其他PPP协议进行身份验证和配置一个或多个NCP之后，链路进入链路开启阶段。在此示例中，首先使用Echo-Request和Echo-Reply消息来测试链路，然后是两个设备发送和接收数据。显示了一个数据消息因代码字段无效而被拒绝。最后，使用终止请求和终止确认消息终止链路。'
- en: '![PPP Link Control Protocol (LCP) message exchanges This diagram shows the
    different message exchanges performed by LCP during link configuration, maintenance,
    and termination.](httpatomoreillycomsourcenostarchimages287733.png.jpg)'
  id: totrans-189
  prefs: []
  type: TYPE_IMG
  zh: '![PPP链路控制协议（LCP）消息交换 此图显示了LCP在链路配置、维护和终止期间执行的不同消息交换](httpatomoreillycomsourcenostarchimages287733.png.jpg)'
- en: Figure 10-1. PPP Link Control Protocol (LCP) message exchanges This diagram
    shows the different message exchanges performed by LCP during link configuration,
    maintenance, and termination.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 图10-1。PPP链路控制协议（LCP）消息交换 此图显示了LCP在链路配置、维护和终止期间执行的不同消息交换
- en: LCP Packets
  id: totrans-191
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: LCP数据包
- en: Devices use LCP to control the PPP link by sending LCP messages across the physical
    link between them. These messages are called both *LCP packets* and *LCP frames*.
    Although the standard uses *packet*, the term *frame* is preferred because layer
    2 messages are normally called frames. The main PPP document defines 11 different
    LCP frames, which are divided into three groups that correspond to the three link
    stages. Four LCP frame types are used for link configuration, five for maintenance,
    and two for termination.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 设备使用LCP通过在它们之间的物理链路上发送LCP消息来控制PPP链路。这些消息被称为*LCP数据包*和*LCP帧*。尽管标准使用*数据包*，但术语*帧*更受欢迎，因为第2层消息通常被称为帧。主要PPP文档定义了11种不同的LCP帧，这些帧分为三个组，分别对应三个链路阶段。四种LCP帧类型用于链路配置，五种用于维护，两种用于终止。
- en: In the following section I'll discuss each of the three major functions of LCP
    and how the frames are used in each. ([Chapter 12](ch12.html "Chapter 12. PPP
    PROTOCOL FRAME FORMATS") describes the frame formats for the packets themselves.)
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我将讨论LCP的三个主要功能以及在每个功能中如何使用帧。([第12章](ch12.html "第12章。PPP协议帧格式")描述了数据包本身的帧格式。)
- en: LCP Link Configuration
  id: totrans-194
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: LCP链路配置
- en: Link configuration is arguably LCP's most important job in PPP. During the link
    establishment phase, the two physically connected devices exchange LCP frames
    that help them negotiate the conditions under which the link will operate. [Figure 10-2](ch10.html#ppp_lcp_link_configuration_process_the_n
    "Figure 10-2. PPP LCP link configuration process The negotiation process undertaken
    to configure the link by LCP. This process begins when the PPP link enters the
    link establishment phase. After successful configuration, the connection transitions
    to the authentication phase.") shows the entire procedure.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 链路配置可以说是LCP在PPP中最重要的工作。在链路建立阶段，两个物理连接的设备交换LCP帧，以帮助它们协商链路将运行的条件。[图10-2](ch10.html#ppp_lcp_link_configuration_process_the_n
    "图10-2。PPP LCP链路配置过程 LCP配置链路所进行的协商过程。此过程从PPP链路进入链路建立阶段开始。配置成功后，连接过渡到认证阶段。")显示了整个过程。
- en: The process begins with the initiating device (Device A) creating a Configure-Request
    frame that contains a variable number of configuration options that it wants to
    see set up on the link. This is basically Device A's "wish list" for how it wants
    the link created.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 此过程从发起设备（设备 *A*）创建一个包含它希望设置在链路上的配置选项的可变数量的配置请求帧开始。这基本上是设备 *A* 的“愿望清单”，说明了它希望如何创建链路。
- en: '![PPP LCP link configuration process The negotiation process undertaken to
    configure the link by LCP. This process begins when the PPP link enters the link
    establishment phase. After successful configuration, the connection transitions
    to the authentication phase.](httpatomoreillycomsourcenostarchimages287735.png.jpg)'
  id: totrans-197
  prefs: []
  type: TYPE_IMG
  zh: '![PPP LCP链路配置过程 LCP配置链路所进行的协商过程。此过程从PPP链路进入链路建立阶段开始。配置成功后，连接过渡到认证阶段。](httpatomoreillycomsourcenostarchimages287735.png.jpg)'
- en: Figure 10-2. PPP LCP link configuration process The negotiation process undertaken
    to configure the link by LCP. This process begins when the PPP link enters the
    link establishment phase. After successful configuration, the connection transitions
    to the authentication phase.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 图10-2。PPP LCP链路配置过程 LCP配置链路所进行的协商过程。此过程从PPP链路进入链路建立阶段开始。配置成功后，连接过渡到认证阶段。
- en: 'RFC 1661, the main PPP document, defines a number of different configuration
    options that the initiator can specify in this request. Any one of these can be
    included and if so, filled in with the value corresponding to what Device A wants
    for that option. If absent, Device A isn''t requesting that option. The six options
    are as follows:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: RFC 1661，主要的PPP文档，定义了发起者可以在该请求中指定的多个不同配置选项。这些选项中的任何一个都可以包含在内，如果包含，则用与设备 *A*
    对该选项所希望值相对应的值填写。如果不存在，则设备 *A* 不请求该选项。这六个选项如下：
- en: '**Maximum Receive Unit (MRU)** Lets Device *A* specify the maximum size datagram
    it wants the link to be able to carry.'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: '**最大接收单元 (MRU)** 允许设备 *A* 指定它希望链路能够携带的最大数据报大小。'
- en: '**Authentication Protocol** Device *A* can indicate the type of authentication
    protocol it wishes to use (if any).'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: '**认证协议** 设备 *A* 可以指示它希望使用的认证协议类型（如果有的话）。'
- en: '**Quality Protocol** If Device *A* wants to enable quality monitoring on the
    link, what quality monitoring protocol to use (though there is only one currently
    defined: LQR).'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: '**质量协议** 如果设备 *A* 希望在链路上启用质量监控，则应使用哪种质量监控协议（尽管目前只定义了一种：LQR）。'
- en: '**Magic Number** Used to detect looped-back links or other anomalies in the
    connection.'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: '**魔法数字** 用于检测回环链接或其他连接中的异常。'
- en: '**Protocol Field Compression** Allows Device *A* to specify that it wants to
    use "compressed" (8-bit) Protocol fields in PPP data frames instead of the normal
    16-bit Protocol field. This provides a small (one byte) but free savings on each
    PPP frame. (Note that this has nothing to do with the compression feature offered
    by Compression Control Protocol, or CCP; see the PPP general frame format discussion
    in [Chapter 12](ch12.html "Chapter 12. PPP PROTOCOL FRAME FORMATS") for more on
    this feature.)'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: '**协议字段压缩** 允许设备 *A* 指定它希望使用“压缩”的（8位）协议字段，而不是PPP数据帧中的正常16位协议字段。这为每个PPP帧提供了一小（一个字节）但免费的节省。（注意，这与压缩控制协议（CCP）提供的压缩功能无关；有关此功能的更多信息，请参阅[第12章](ch12.html
    "第12章。PPP协议帧格式")中PPP通用帧格式的讨论。）'
- en: '**Address and Control Field Compression (ACFC)** The same as Protocol Field
    Compression, but used to compress the Address and Control fields for small bandwidth
    savings. (See the PPP general frame format topic in [Chapter 12](ch12.html "Chapter 12. PPP
    PROTOCOL FRAME FORMATS") for more.)'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: '**地址和控制字段压缩（ACFC）** 与协议字段压缩相同，但用于压缩地址和控制字段以节省少量带宽。（有关更多信息，请参阅[第12章](ch12.html
    "第12章。PPP协议帧格式"）中的PPP通用帧格式主题。）'
- en: Other options may also be added to this list by optional feature protocols.
    For example, Multilink PPP ([Chapter 11](ch11.html "Chapter 11. PPP FEATURE PROTOCOLS"))
    adds several options that must be negotiated during link setup.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 还可以通过可选功能协议将其他选项添加到该列表中。例如，多链路PPP（[第11章](ch11.html "第11章。PPP功能协议"））在链路设置期间必须协商的几个选项。
- en: 'The other device (Device B) receives the Configure-Request and processes it.
    It then has the following three choices of how to respond:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 另一设备（设备B）接收配置请求并处理它。然后，它有以下三种响应选择：
- en: If every option in it is acceptable, Device B sends back a Configure-Ack (acknowledge)
    frame. The negotiation is complete.
  id: totrans-208
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果其中的每个选项都是可接受的，设备B将发送配置-确认（确认）帧。协商完成。
- en: If Device B recognizes all the options that Device A sent as valid and is capable
    of negotiating, but it doesn't accept the values, Device B returns a Configure-Nak
    (negative acknowledge) frame. This message includes a copy of each configuration
    option that Device B found unacceptable.
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果设备B识别了设备A发送的所有选项作为有效选项，并且能够进行协商，但它不接受这些值，设备B将返回配置-否定（否定确认）帧。此消息包括设备B发现不可接受的每个配置选项的副本。
- en: If any of the options that Device A sent were either unrecognized by Device
    B or represent ways of using the link that Device B considers not only unacceptable,
    but not even subject to negotiation, it returns a Configure-Reject containing
    each of the objectionable options.
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果设备A发送的任何选项既不被设备B识别，也不代表设备B认为不仅不可接受，甚至不适用于协商的方式，它将返回包含每个令人反感的选项的配置-拒绝。
- en: The difference between a Configure-Nak and a Configure-Reject is that the former
    is like Device B saying, "I don't accept your terms, but I'll discuss," while
    the latter is Device B basically saying, "No way Jose!" For example, if Device
    A tries to request PAP as the authentication protocol, but Device B wants to use
    CHAP, it will send a Configure-Nak. If Device B doesn't support authentication
    at all, it will send a Configure-Reject.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 配置-否定（Configure-Nak）和配置-拒绝（Configure-Reject）之间的区别在于，前者类似于设备B说：“我不接受你的条款，但我愿意讨论”，而后者则是设备B基本上说：“不可能，老兄！”例如，如果设备A试图请求PAP作为认证协议，但设备B想使用CHAP，它将发送配置-否定。如果设备B根本不支持认证，它将发送配置-拒绝。
- en: Note
  id: totrans-212
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*Even after receiving a rejection, Device A can retry the negotiation with
    a new Configure-Request*.'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: '*即使收到拒绝，设备A也可以使用新的配置请求重新尝试协商*。'
- en: LCP Link Maintenance
  id: totrans-214
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: LCP链路维护
- en: 'Once the link has been negotiated, LCP passes control to the appropriate authentication
    and NCP protocols (as discussed below). Eventually the link setup will complete
    and go into the open state, at which point, LCP messages can then be used by either
    device to manage or debug the link, as follows:'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦链路协商完成，LCP将控制权传递给适当的认证和NCP协议（如下文所述）。最终，链路设置将完成并进入开放状态，此时，LCP消息可以由任一设备用于管理或调试链路，如下所述：
- en: '**Code-Reject and Protocol-Reject** These frame types are used to provide feedback
    when one device receives an invalid frame due to either an unrecognized LCP code
    (LCP frame type) or a bad protocol identifier.'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: '**代码-拒绝和协议-拒绝** 这些帧类型用于在设备由于未识别的LCP代码（LCP帧类型）或不良的协议标识符而收到无效帧时提供反馈。'
- en: '**Echo-Request, Echo-Reply, and Discard-Request** These frames can be used
    for testing the link.'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: '**回显请求、回显应答和丢弃请求** 这些帧可用于测试链路。'
- en: LCP Link Termination
  id: totrans-218
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: LCP链路终止
- en: When the link is ready to be shut down, LCP terminates it. The device initiating
    the shutdown (which may not be the one that initiated the link in the first place)
    sends a Terminate-Request message. The other device replies with a Terminate-Ack
    message. A termination request indicates that the device sending it needs to close
    the link. This is a request that cannot be denied.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 当链路准备关闭时，LCP将其终止。启动关闭操作的设备（可能不是最初启动链路的设备）发送终止请求消息。另一设备以终止确认消息回复。终止请求表示发送该请求的设备需要关闭链路。这是一个无法拒绝的请求。
- en: Other LCP Messages
  id: totrans-220
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 其他LCP消息
- en: The standard RFC 1570, "PPP LCP Extensions," also defines two new LCP message
    types. The Identification message is used to allow a device to identify itself
    to its peer on the link. The Time-Remaining message lets one device tell the other
    how much time remains in the current session.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 标准RFC 1570，"PPP LCP扩展"，还定义了两种新的LCP消息类型。标识消息用于允许设备向链路上的对等设备标识自己。剩余时间消息允许一个设备告诉另一个设备当前会话中剩余多少时间。
- en: Many of the other protocols used in PPP are modeled after LCP. They use the
    same basic techniques for establishing protocol connections, and send and receive
    a subset of LCP message types. They also exchange configuration options in a similar
    manner.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: PPP中使用的许多其他协议都是基于LCP构建的。它们使用相同的基本技术来建立协议连接，并发送和接收LCP消息类型的一个子集。它们还以类似的方式交换配置选项。
- en: The Network Control Protocols (IPCP, IPXCP, NBFCP, and Others)
  id: totrans-223
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网络控制协议（IPCP、IPXCP、NBFCP以及其他）
- en: Although PPP was originally created to carry IP datagrams, its designers realized
    that it could easily carry data from many types of network layer protocols, and
    that, on some networks, it might even be advantageous to let it carry datagrams
    from different layer 3 protocols simultaneously.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然PPP最初是为了携带IP数据报而创建的，但其设计者意识到它很容易携带来自许多类型的网络层协议的数据，并且在某些网络上，让它同时携带来自不同第3层协议的数据报甚至可能是有利的。
- en: Allowing PPP to support multiple network layer protocols would require it to
    have knowledge of each one's idiosyncrasies. If you used only LCP for link configuration,
    the device would need to know all the unique requirements of each layer 3 protocol.
    This would also require you to update LCP constantly as new layer 3 protocols
    were defined and as new parameters were defined for existing ones.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 允许PPP支持多个网络层协议将需要它了解每个协议的独特之处。如果你只使用LCP进行链路配置，设备就需要知道每个第3层协议的独特要求。这还要求你不断更新LCP，因为新的第3层协议被定义，以及为现有协议定义了新的参数。
- en: To eliminate this potential issue, PPP takes a modular approach to link establishment.
    LCP performs the basic link setup, and after (optional) authentication, invokes
    an *NCP* that is specific to each layer 3 protocol that is to be carried over
    the link. The NCP negotiates any parameters that are unique to the particular
    network layer protocol, and more than one NCP can be run for each LCP link (see
    the discussion of PPP link setup and phases in [Chapter 9](ch09.html "Chapter 9. TCP/IP
    SERIAL LINE INTERNET PROTOCOL (SLIP) AND POINT-TO-POINT PROTOCOL (PPP) OVERVIEW
    AND FUNDAMENTALS")).
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 为了消除这种潜在问题，PPP在链路建立上采用了一种模块化方法。LCP执行基本的链路设置，并在（可选的）认证之后调用一个针对要通过链路传输的每个第3层协议特定的*NCP*。NCP协商特定于特定网络层协议的任何参数，并且可以为每个LCP链路运行多个NCP（参见第9章中关于PPP链路设置和阶段的讨论[Chapter 9](ch09.html
    "Chapter 9. TCP/IP SERIAL LINE INTERNET PROTOCOL (SLIP) AND POINT-TO-POINT PROTOCOL
    (PPP) OVERVIEW AND FUNDAMENTALS")）。
- en: Each of the common network layer technologies has a PPP NCP defined for it in
    a separate RFC. The most common ones, "The PPP Internet Protocol Control Protocol
    (IPCP)," "The PPP Internetworking Packet Exchange Control Protocol (IPXCP)," and
    "The PPP NetBIOS Frames Control Protocol (NBFCP)," are NCPs for IP, IPX, and NBF
    (also called NetBEUI), respectively. A separate NCP is also defined for IP version
    6, the "PPP IP Version 6 Control Protocol (IPv6CP)."
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 对于每种常见的网络层技术，都在单独的RFC中为其定义了一个PPP NCP。"PPP互联网协议控制协议(IPCP)"、"PPP互连包交换控制协议(IPXCP)"和"PPP
    NetBIOS帧控制协议(NBFCP)"分别是IP、IPX和NBF（也称为NetBEUI）的NCP。还定义了一个单独的NCP用于IP版本6，即"PPP IP版本6控制协议(IPv6CP)"。
- en: Operation of NCPs
  id: totrans-228
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: NCP的操作
- en: 'Each NCP operates very much like a light version of LCP, as you can see in
    [Figure 10-3](ch10s02.html#ppp_ip_control_protocol_ipcp_message_exc "Figure 10-3. PPP
    IP Control Protocol (IPCP) message exchanges The message exchanges, performed
    to configure and terminate IPCP, are quite similar to those used for LCP."). (To
    see the similarities, you should compare [Figure 10-3](ch10s02.html#ppp_ip_control_protocol_ipcp_message_exc
    "Figure 10-3. PPP IP Control Protocol (IPCP) message exchanges The message exchanges,
    performed to configure and terminate IPCP, are quite similar to those used for
    LCP.") to [Figure 10-1](ch10.html#ppp_link_control_protocol_lcp_message_ex "Figure 10-1. PPP
    Link Control Protocol (LCP) message exchanges This diagram shows the different
    message exchanges performed by LCP during link configuration, maintenance, and
    termination."), which shows the messaging for LCP.) Like LCP, each NCP performs
    functions for link setup, maintenance, and termination, except that it deals only
    with its particular type of NCP link and not the overall LCP link. Each NCP uses
    a subset of the following seven of the message types defined in LCP in very much
    the same way that LCP uses each message type of the same name, as shown for each
    of these three main link activities:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 每个NCP的操作非常类似于LCP的一个轻量级版本，正如您可以在[图10-3](ch10s02.html#ppp_ip_control_protocol_ipcp_message_exc
    "图10-3. PPP IP控制协议（IPCP）消息交换 配置和终止IPCP所执行的消息交换与用于LCP的交换非常相似。")中看到的那样。（为了看到相似之处，您应该将[图10-3](ch10s02.html#ppp_ip_control_protocol_ipcp_message_exc
    "图10-3. PPP IP控制协议（IPCP）消息交换 配置和终止IPCP所执行的消息交换与用于LCP的交换非常相似。")与[图10-1](ch10.html#ppp_link_control_protocol_lcp_message_ex
    "图10-1. PPP链路控制协议（LCP）消息交换 此图显示了LCP在链路配置、维护和终止期间执行的不同消息交换。")进行比较，后者显示了LCP的消息。）像LCP一样，每个NCP执行链路设置、维护和终止的功能，但它只处理其特定的NCP链接，而不是整个LCP链接。每个NCP使用LCP中定义的以下七个消息类型的一个子集，其方式与LCP使用相同名称的消息类型非常相似，正如在每个主要链路活动中的示例所示：
- en: '**Link Configuration** The process of setting up and negotiating the parameters
    of a particular NCP link (once an LCP link is established) is accomplished using
    Configure-Request, Configure-Ack, Configure-Nak, and Configure-Reject messages
    as discussed for LCP (except that these are particular to each NCP). The configuration
    options are the network layer protocol parameters being negotiated.'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: '**链路配置** 一旦建立了LCP链接，就会使用配置请求、配置确认、配置否定和配置拒绝消息来设置和协商特定NCP链接的参数（如LCP中讨论的那样）（但这些都是针对每个NCP特定的）。配置选项是正在协商的网络层协议参数。'
- en: '**Link Maintenance** Code-Reject messages can be sent to indicate invalid code
    values (NCP frame types).'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: '**链路维护** 可以发送代码拒绝消息来指示无效的代码值（NCP帧类型）。'
- en: '**Link Termination** An NCP link can be terminated using Terminate-Request
    and Terminate-Ack messages. But remember that NCP links are set up within an LCP
    link, and that there can be more than one NCP link open. Closing NCP links doesn''t
    terminate the LCP link. (NCP links do not need to be closed when an LCP link is
    terminated.)'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: '**链路终止** 可以使用终止请求和终止确认消息来终止NCP链接。但请记住，NCP链接是在LCP链接内设置的，并且可以打开多个NCP链接。关闭NCP链接不会终止LCP链接。（当终止LCP链接时，不需要关闭NCP链接。）'
- en: '[Figure 10-3](ch10s02.html#ppp_ip_control_protocol_ipcp_message_exc "Figure 10-3. PPP
    IP Control Protocol (IPCP) message exchanges The message exchanges, performed
    to configure and terminate IPCP, are quite similar to those used for LCP.") shows
    how the overall operation of the NCPs, such as IPCP, is very similar to that of
    LCP. Once LCP configuration (including authentication) is complete, IPCP Configure-Request
    and Configure-Ack messages are used to establish an IPCP link. IP data can then
    be sent over the link. If the IPCP connection is no longer needed, it may be terminated,
    after which the LCP link remains open for other types of data to be transmitted.
    It is not necessary, however, to explicitly terminate the IPCP link before terminating
    the LCP connection.'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: '[图10-3](ch10s02.html#ppp_ip_control_protocol_ipcp_message_exc "图10-3. PPP IP控制协议（IPCP）消息交换
    配置和终止IPCP所执行的消息交换与用于LCP的交换非常相似。")展示了NCP（如IPCP）的整体操作与LCP非常相似。一旦LCP配置（包括认证）完成，就会使用配置请求和配置确认消息来建立IPCP链接。然后可以通过该链接发送IP数据。如果不再需要IPCP连接，它可以被终止，之后LCP链接仍然保持开启状态，以便传输其他类型的数据。然而，在终止LCP连接之前，没有必要明确终止IPCP链接。'
- en: '![PPP IP Control Protocol (IPCP) message exchanges The message exchanges, performed
    to configure and terminate IPCP, are quite similar to those used for LCP.](httpatomoreillycomsourcenostarchimages287737.png.jpg)'
  id: totrans-234
  prefs: []
  type: TYPE_IMG
  zh: '![PPP IP控制协议（IPCP）消息交换 配置和终止IPCP所执行的消息交换与用于LCP的相当相似。](httpatomoreillycomsourcenostarchimages287737.png.jpg)'
- en: Figure 10-3. PPP IP Control Protocol (IPCP) message exchanges The message exchanges,
    performed to configure and terminate IPCP, are quite similar to those used for
    LCP.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 图10-3. PPP IP控制协议（IPCP）消息交换 配置和终止IPCP所执行的消息交换与用于LCP的相当相似。
- en: Tip
  id: totrans-236
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: '**KEY CONCEPT** Once the primary PPP link is established using LCP, each network
    layer protocol to be carried over the link requires the establishment of the appropriate
    NCP link. The most important of these is the *PPP Internet Protocol Control Protocol
    (IPCP)*, which allows IP datagrams to be carried over PPP.'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: '**关键概念** 一旦使用LCP建立了主要的PPP链路，每个要携带通过链路的网络层协议都需要建立适当的NCP链路。其中最重要的是*PPP互联网协议控制协议（IPCP）*，它允许IP数据报通过PPP传输。'
- en: 'The Internet Protocol Control Protocol (IPCP): An Example NCP'
  id: totrans-238
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 互联网协议控制协议（IPCP）：一个示例NCP
- en: 'Let''s look at the NCP for IP: IPCP. When PPP is set up to carry IP datagrams,
    IPCP is invoked in the network layer protocol phase to set up an IP NCP link between
    the two devices. The setup is carried out using the four Configure- messages.
    For IP, two configuration options can be specified in an IPCP Configure-Request
    message:'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看IP的NCP：IPCP。当PPP被设置为携带IP数据报时，IPCP在网络层协议阶段被调用，以在两个设备之间建立IP NCP链路。设置是通过使用四个配置消息来完成的。对于IP，可以在IPCP配置请求消息中指定两个配置选项：
- en: '**IP Compression Protocol** Allows devices to negotiate the use of Van Jacobson
    TCP/IP header compression, which shrinks the size of TCP and IP headers to save
    bandwidth. This is similar in concept to the Protocol-Field-Compression and ACFC
    options in LCP.'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: '**IP压缩协议** 允许设备协商使用Van Jacobson TCP/IP头部压缩，这缩小了TCP和IP头部的大小以节省带宽。在概念上，这与LCP中的协议字段压缩和ACFC选项类似。'
- en: '**IP Address** Allows the device sending the Configure-Request message either
    to specify an IP address it wants to use for routing IP over the PPP link or to
    request that the other device supply it with one. This is most commonly used for
    dial-up networking links.'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: '**IP地址** 允许发送配置请求消息的设备指定它想要用于通过PPP链路路由IP的IP地址，或者请求另一台设备提供IP地址。这通常用于拨号网络链路。'
- en: Once configuration is complete, data can be sent for the layer 3 protocol corresponding
    to the NCP negotiated. This is indicated by using the appropriate value for the
    Protocol field in PPP data frames containing that layer 3 data.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦配置完成，就可以发送对应于协商的NCP的第三层协议的数据。这通过在包含该第三层数据的PPP数据帧中使用适当的协议字段值来指示。
- en: 'PPP Authentication Protocols: PAP and CHAP'
  id: totrans-243
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PPP认证协议：PAP和CHAP
- en: PPP was designed to provide layer 2 connectivity over a variety of serial links
    and other physical layer technologies, some of which introduce more security concerns
    than others. For example, suppose you connect two machines in your office with
    a serial cable and want to run PPP between them. When one of these initiates a
    PPP link with the other, you don't really need to worry about who's calling. On
    the other hand, consider an Internet service provider (ISP) using PPP for remote
    dial-in users. They generally want to allow only their customers to connect.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: PPP被设计为在各种串行链路和其他物理层技术上提供第二层连接性，其中一些比其他技术引入了更多的安全担忧。例如，假设你用串行电缆连接办公室中的两台机器，并想在它们之间运行PPP。当其中一台机器与另一台机器建立PPP链路时，你实际上不需要担心是谁在打电话。另一方面，考虑一个使用PPP为远程拨入用户提供服务的互联网服务提供商（ISP）。他们通常只想允许他们的客户连接。
- en: 'The PPP protocol suite allows for the use of an optional authentication protocol
    when devices negotiate the basic link setup. The PPP suite initially defined two
    such protocols: PAP and CHAP. Once an LCP link is set up between two devices,
    a series of authentication messages are sent using these protocols to verify the
    identity of the device initiating the link. Only if authentication is successful
    can the link configuration proceed.'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: PPP协议集允许在设备协商基本链路设置时使用可选的认证协议。PPP套件最初定义了两个这样的协议：PAP和CHAP。一旦在两个设备之间建立LCP链路，就使用这些协议发送一系列认证消息来验证发起链路的设备的身份。只有认证成功，链路配置才能继续。
- en: PAP
  id: totrans-246
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PAP
- en: PAP is a very straightforward authentication scheme, consisting of only two
    basic steps, as shown in [Figure 10-4](ch10s03.html#pap_authentication_pap_uses_a_simple_exc
    "Figure 10-4. PAP authentication PAP uses a simple exchange of a request containing
    name and password information and a reply indicating whether or not authentication
    was successful.").
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: PAP 是一个非常直接的认证方案，只包含两个基本步骤，如图 [图 10-4](ch10s03.html#pap_authentication_pap_uses_a_simple_exc
    "图 10-4. PAP 认证 PAP 使用包含用户名和密码信息的请求以及指示认证是否成功的回复的简单交换。") 所示。
- en: '**Authentication Request** The initiating device sends an Authenticate-Request
    message that contains a name and a password.'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: '**认证请求** 发起设备发送一个包含用户名和密码的 Authenticate-Request 消息。'
- en: '**Authentication Reply** The responding device looks at the name and password
    and decides whether to accept the initiating device and continue setting up the
    link. If so, it sends back an Authenticate-Ack message. Otherwise, it sends an
    Authenticate-Nak message.'
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: '**认证回复** 响应设备查看用户名和密码，并决定是否接受发起设备并继续设置链路。如果是这样，它将发送一个 Authenticate-Ack 消息。否则，它将发送一个
    Authenticate-Nak 消息。'
- en: PAP is another example of something that is just too simple for its own good.
    Chief among its flaws is that it transmits the user name and password in clear
    text across the link. This is a big "no-no" because eavesdroppers can get the
    password.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: PAP 是一个例子，它过于简单，以至于不利于自身。其主要缺陷之一是它在链路中明文传输用户名和密码。这是一个大忌，因为窃听者可以获取密码。
- en: PAP also provides no protection against various security attacks. For example,
    an unauthorized user could try different passwords indefinitely until he discovered
    the correct one. PAP also puts control of the authentication squarely on the shoulders
    of the initiating device (usually a client machine), which is not considered desirable,
    because this is normally a server function that administrators prefer to manage.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: PAP 也不能提供针对各种安全攻击的保护。例如，未经授权的用户可能会尝试不同的密码，直到发现正确的密码。PAP 还将认证控制完全放在发起设备（通常是客户端机器）的肩上，这通常不被认为是理想的，因为这是管理员更喜欢管理的服务器功能。
- en: '![PAP authentication PAP uses a simple exchange of a request containing name
    and password information and a reply indicating whether or not authentication
    was successful.](httpatomoreillycomsourcenostarchimages287739.png.jpg)'
  id: totrans-252
  prefs: []
  type: TYPE_IMG
  zh: '![PAP 认证 PAP 使用包含用户名和密码信息的请求以及指示认证是否成功的回复的简单交换。](httpatomoreillycomsourcenostarchimages287739.png.jpg)'
- en: Figure 10-4. PAP authentication PAP uses a simple exchange of a request containing
    name and password information and a reply indicating whether or not authentication
    was successful.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10-4. PAP 认证 PAP 使用包含用户名和密码信息的请求以及指示认证是否成功的回复的简单交换。
- en: CHAP
  id: totrans-254
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CHAP
- en: The most important difference between PAP and CHAP is that CHAP doesn't transmit
    the password across the link. When using PAP, the initiator (calling client) sends
    the authenticator (generally the server that is deciding whether to grant authentication)
    a message saying essentially, "Here's the password I know; see if it matches yours."
    Each device uses the password to perform a cryptographic computation, and then
    checks to see if it gets the same result. If so, they know they have the same
    password.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: PAP 和 CHAP 之间最重要的区别在于 CHAP 不会在链路中传输密码。当使用 PAP 时，发起者（调用客户端）向认证者（通常是决定是否授予认证的服务器）发送一条消息，其大意是：“这是我知道的密码；看看它是否与你的匹配。”每个设备使用密码执行加密计算，然后检查是否得到相同的结果。如果是这样，它们就知道它们有相同的密码。
- en: In CHAP, a basic LCP link is first set up between the initiator and authenticator.
    The authenticator then takes charge of the authentication process, using a technique
    called a *three-way handshake*.
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 在 CHAP 中，首先在发起者和认证者之间建立一个基本的 LCP 链路。然后，认证者负责认证过程，使用一种称为“三次握手”的技术。
- en: Note
  id: totrans-257
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*Three-way handshakes are a fairly common general authentication procedure.
    The same basic technique is used, for example, in shared key authentication on
    IEEE 802.11 wireless networking*.'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: '**三次握手是一种相当常见的通用认证程序。例如，在 IEEE 802.11 无线网络中的共享密钥认证中也使用了相同的基本技术**。'
- en: 'The three-way handshake steps are as follows (see [Figure 10-5](ch10s03.html#ppp_challenge_handshake_authentication_p
    "Figure 10-5. PPP Challenge Handshake Authentication Protocol (CHAP) authentication
    CHAP uses a three-way handshake beginning with a Challenge from the authenticating
    device. This message is encrypted and returned to the authenticating device, which
    checks to see if the device trying to authenticate used the correct password (or
    other shared secret).")):'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 三路握手步骤如下（参见[图 10-5](ch10s03.html#ppp_challenge_handshake_authentication_p "图
    10-5. PPP 挑战握手认证协议 (CHAP) 认证 CHAP 使用一个三路握手，从认证设备发出的挑战开始。此消息被加密并返回给认证设备，认证设备检查尝试进行认证的设备是否使用了正确的密码（或其他共享秘密）"))）：
- en: '**Challenge** The authenticator generates a frame called a Challenge and sends
    it to the initiator. This frame contains a simple text message (sometimes called
    the *challenge text*). The message has no inherent special meaning, so it doesn''t
    matter if anyone intercepts it. The important thing is that after receipt of the
    Challenge, both devices have the same Challenge message.'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: '**挑战** 认证器生成一个称为挑战的帧并发送给发起者。此帧包含一个简单的文本消息（有时称为*挑战文本*）。消息没有固有的特殊含义，所以如果有人拦截它，也没有关系。重要的是在收到挑战后，两个设备都有相同的挑战消息。'
- en: '**Response** The initiator uses its password (or some other shared secret that
    the authenticators also know) to encrypt the challenge text. It then sends the
    encrypted challenge text as a Response back to the authenticator.'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: '**响应** 发起者使用其密码（或认证者也知道的其他共享秘密）来加密挑战文本。然后，它将加密的挑战文本作为响应发送回认证器。'
- en: '**Success or Failure** The authenticator performs the same encryption on the
    challenge text that the initiator did. If the authenticator gets the same result
    that the initiator sent it in the Response, it knows that the initiator had the
    right password when it did its encryption, so the authenticator returns a Success
    message. Otherwise, it sends a Failure message.'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: '**成功或失败** 认证器对挑战文本执行与发起者相同的加密操作。如果认证器收到与发起者在响应中发送的相同结果，它就知道发起者在进行加密时拥有正确的密码，因此认证器返回一个成功消息。否则，它发送一个失败消息。'
- en: '![PPP Challenge Handshake Authentication Protocol (CHAP) authentication CHAP
    uses a three-way handshake beginning with a Challenge from the authenticating
    device. This message is encrypted and returned to the authenticating device, which
    checks to see if the device trying to authenticate used the correct password (or
    other shared secret).](httpatomoreillycomsourcenostarchimages287741.png.jpg)'
  id: totrans-263
  prefs: []
  type: TYPE_IMG
  zh: '![PPP 挑战握手认证协议 (CHAP) 认证 CHAP 使用一个三路握手，从认证设备发出的挑战开始。此消息被加密并返回给认证设备，认证设备检查尝试进行认证的设备是否使用了正确的密码（或其他共享秘密）](httpatomoreillycomsourcenostarchimages287741.png.jpg)'
- en: Figure 10-5. PPP Challenge Handshake Authentication Protocol (CHAP) authentication
    CHAP uses a three-way handshake beginning with a Challenge from the authenticating
    device. This message is encrypted and returned to the authenticating device, which
    checks to see if the device trying to authenticate used the correct password (or
    other shared secret).
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10-5. PPP 挑战握手认证协议 (CHAP) 认证 CHAP 使用一个三路握手，从认证设备发出的挑战开始。此消息被加密并返回给认证设备，认证设备检查尝试进行认证的设备是否使用了正确的密码（或其他共享秘密）。
- en: The beauty of this is that it verifies that the two devices have the same shared
    secret, but it doesn't require them to send the secret over the link. The Response
    is calculated based on the password, but the content of the Response is encrypted,
    and thus it's much harder to derive the password from. CHAP also provides protection
    against replay attacks, whereby an unauthorized user captures a message and tries
    to send it again later on. This is done by changing an identifier in each message
    and varying the challenge text. Also, in CHAP, the server controls the authentication
    process, not the client that is initiating the link.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 这的好处在于它验证了两个设备具有相同的共享秘密，但不需要它们通过链路发送秘密。响应是根据密码计算的，但响应的内容被加密，因此从响应中推导密码要困难得多。CHAP
    还提供了对重放攻击的保护，其中未经授权的用户捕获一条消息并试图稍后再次发送。这是通过在每个消息中更改一个标识符并改变挑战文本来实现的。此外，在 CHAP 中，服务器控制认证过程，而不是发起链路的客户端。
- en: Tip
  id: totrans-266
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: '**KEY CONCEPT** PPP supports two authentication protocols: *PAP* and *CHAP*.
    PAP is a simple request-and-reply authentication protocol that is widely considered
    to be inadequate because it sends the user name and password in clear text and
    provides little protection against many security concerns. CHAP uses a three-way
    handshake procedure and is preferred over PAP in most implementations.'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: '**关键概念** PPP 支持两种认证协议：*PAP* 和 *CHAP*。PAP 是一种简单的请求和回复认证协议，因为它以明文形式发送用户名和密码，并且对许多安全问题的保护很少，所以普遍被认为是不够的。CHAP
    使用三次握手过程，在大多数实现中比 PAP 更受欢迎。'
- en: CHAP is not perfect, but it's much better than PAP. In fact, the IETF made a
    rather strong statement in this regard when it revised the original RFC that described
    PAP and CHAP to include only CHAP in the new standard. Despite this, PAP is still
    used in some applications because it is simple. PAP can suffice in situations
    where security is not a big deal, but CHAP is a much better choice.
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: CHAP 并不完美，但比 PAP 好得多。事实上，IETF 在修订描述 PAP 和 CHAP 的原始 RFC 时，对此做出了相当强烈的声明，将新标准中仅包括
    CHAP。尽管如此，PAP 仍然在一些应用中使用，因为它很简单。在安全不是大问题的情况下，PAP 就足够了，但 CHAP 是一个更好的选择。
- en: Note
  id: totrans-269
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*Incidentally, in addition to PAP and CHAP, it is possible to use proprietary
    authentication schemes. This requires that the appropriate configuration option
    values be programmed into LCP for placement in the Authentication Protocol configuration
    option*.'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: '*顺便说一下，除了 PAP 和 CHAP，还可能使用专有认证方案。这需要将适当的配置选项值编程到 LCP 中，以便放置在认证协议配置选项中*。'
- en: Chapter 11. PPP FEATURE PROTOCOLS
  id: totrans-271
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第 11 章。PPP 功能协议
- en: '![image with no caption](httpatomoreillycomsourcenostarchimages287681.png.jpg)'
  id: totrans-272
  prefs: []
  type: TYPE_IMG
  zh: '![无标题图片](httpatomoreillycomsourcenostarchimages287681.png.jpg)'
- en: 'Point-to-Point Protocol (PPP) is the standard for data link layer connectivity
    over serial links because its core protocols provide a solid operational foundation,
    as you saw in [Chapter 10](ch10.html "Chapter 10. PPP CORE PROTOCOLS: LINK CONTROL,
    NETWORK CONTROL, AND AUTHENTICATION"). However, PPP''s popularity is based not
    just on its highly capable link establishment and management features, but it
    also has a number of very useful features that provide important security and
    performance benefits to network users.'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 点对点协议（PPP）是串行链路上的数据链路层连接标准，因为其核心协议提供了一个坚实的基础操作基础，正如你在 [第 10 章](ch10.html "第
    10 章。PPP 核心协议：链路控制、网络控制和认证") 中所看到的。然而，PPP 的流行并不仅仅基于其高度强大的链路建立和管理功能，它还拥有许多非常有用的功能，为网络用户提供了重要的安全和性能优势。
- en: In this chapter, I describe the protocols that implement several of the most
    common extra features in PPP. I begin with a discussion of PPP link quality monitoring.
    I describe the sets of protocols used to configure and implement data compression
    and data encryption. I then discuss the PPP Multilink Protocol (MP, MLPPP), which
    allows PPP to bundle multiple low-speed links into a single high-speed link. I
    also cover the *Bandwidth Allocation Protocol (BAP)* and *Bandwidth Allocation
    Control Protocol (BACP)*, which are used to manage the operation of MLPPP.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我描述了实现 PPP 中一些最常见额外功能的协议。我首先讨论 PPP 链路质量监控。我描述了用于配置和实现数据压缩和数据加密的协议集。然后，我讨论
    PPP 多链接协议（MP，MLPPP），它允许 PPP 将多个低速链路捆绑成一个高速链路。我还涵盖了 *带宽分配协议（BAP）* 和 *带宽分配控制协议（BACP）*，它们用于管理
    MLPPP 的操作。
- en: PPP Link Quality Monitoring and Reporting (LQM, LQR)
  id: totrans-275
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PPP 链路质量监控和报告（LQM，LQR）
- en: PPP includes optional authentication in recognition of the varying *security*
    needs of the many different kinds of links over which PPP may operate. These links
    also differ greatly in terms of their *quality*. Just as you don't need to worry
    about authentication much when two machines are linked with a short cable, you
    also can feel pretty confident that data sent between them is going to arrive
    intact. Now contrast that with a PPP session established over a long-distance
    telephone call. For that matter, how about PPP over a dial-up call using an analog
    cellular phone?
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: PPP 包括可选认证，以适应 PPP 可能运行的许多不同类型链路的不同的 *安全* 需求。这些链路在 *质量* 方面也有很大的差异。正如你不需要过多担心认证，当两台机器通过短电缆连接时，你同样可以相当有信心地认为它们之间发送的数据将会完整到达。现在，将这一点与通过长途电话建立的
    PPP 会话进行对比。至于使用模拟蜂窝电话拨号连接的 PPP 会话呢？
- en: PPP includes in its basic package a provision for detecting errors in sent frames,
    and higher-layer protocols like TCP also include methods of providing robustness
    on noisy lines. These techniques allow a link to tolerate problems, but provide
    little in the way of useful information about what the status of the link is.
    In some situations, devices may want to be able to keep track of how well the
    link is working, and perhaps take action on it. For example, a device experiencing
    too many errors on a dial-up connection might want to cut off and retry a new
    call. In some cases, a device might want to try an alternate method of attachment
    if the current physical link is not working well.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: PPP 在其基本包中包括检测发送帧中错误的规定，而像 TCP 这样的高层协议也包含在嘈杂线路上提供鲁棒性的方法。这些技术允许链路容忍问题，但提供了很少有关链路状态的有用信息。在某些情况下，设备可能希望能够跟踪链路的工作情况，并可能采取行动。例如，在拨号连接上遇到太多错误的设备可能想要切断并重试新的呼叫。在某些情况下，如果当前物理链路工作不佳，设备可能希望尝试另一种连接方法。
- en: Recognizing this need, the PPP suite includes a feature that allows devices
    to analyze the quality of the link between them. This is called *PPP Link Quality
    Monitoring* or *LQM*. PPP is set up generically to allow any number of different
    monitoring functions to be used, but at present, there is only one, called *Link
    Quality Reporting (LQR)*. LQR allows a device to request that its peer (the other
    device on the link) keep track of statistics about the link and send periodic
    reports about them.
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 认识到这一需求，PPP 套件包括一个功能，允许设备分析它们之间链路的质量。这被称为 *PPP 链路质量监控* 或 *LQM*。PPP 以通用方式设置，以允许使用任意数量的不同监控功能，但目前在现有情况下，只有一个，称为
    *链路质量报告 (LQR)*。LQR 允许设备请求其对等方（链路上的另一台设备）跟踪有关链路的统计信息，并定期发送关于它们的报告。
- en: LQR Setup
  id: totrans-279
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: LQR 设置
- en: 'Before LQR can be used, it must be set up, which is done by LCP as part of
    the negotiation of basic link parameters in the Link Establishment phase (see
    [Chapter 10](ch10.html "Chapter 10. PPP CORE PROTOCOLS: LINK CONTROL, NETWORK
    CONTROL, AND AUTHENTICATION")). The device opening the link requests link monitoring
    by including the Quality Protocol configuration option in its Configure-Request
    frame. The configuration option also specifies a *reporting period* that indicates
    the longest period of time that the requesting device wants to go between receiving
    reports.'
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 在可以使用 LQR 之前，必须设置它，这是通过 LCP 在链路建立阶段协商基本链路参数时完成的（参见 [第 10 章](ch10.html "第 10
    章。PPP 核心协议：链路控制、网络控制和认证"））。打开链路的设备通过在其 Configure-Request 帧中包含质量协议配置选项来请求链路监控。配置选项还指定了一个
    *报告周期*，该周期指示请求设备希望接收报告之间的最长时间间隔。
- en: Assuming that the negotiation is successful, LQR will be enabled. A number of
    counters are set up that keep track of various link statistics, and a timer is
    used to regulate the sending of quality reports over the link. Each time the timer
    expires, a link quality report is generated and sent in a PPP frame over the link
    using the special PPP Protocol field hexadecimal value 0xC025.
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 假设协商成功，LQR 将被启用。将设置一些计数器来跟踪各种链路统计信息，并使用计时器来调节通过链路发送质量报告。每当计时器到期时，就会生成一个链路质量报告，并通过链路上的
    PPP 帧，使用特殊的 PPP 协议字段十六进制值 0xC025 发送。
- en: 'Each counter holds information about a different statistic regarding the use
    of the link. Each counter is reset to zero when LQR is set up and then incremented
    each time a transmission is made or an event occurs that is relevant to the counter.
    The statistics tracked include the following:'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 每个计数器都包含有关链路使用不同统计信息的信息。每当设置 LQR 时，每个计数器都会重置为零，然后在每次进行传输或发生与计数器相关的事件时递增。跟踪的统计信息包括以下内容：
- en: The number of frames sent or received
  id: totrans-283
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发送或接收的帧数
- en: The number of octets (bytes) in all frames sent or received
  id: totrans-284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 所有发送或接收的帧中的字节数（字节）
- en: The number of errors that have occurred
  id: totrans-285
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发生的错误数量
- en: The number of frames that had to be discarded
  id: totrans-286
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 必须丢弃的帧数
- en: The number of link quality reports generated
  id: totrans-287
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 生成的链路质量报告数量
- en: These counters are reset only at the start of the link, so they contain figures
    that are kept cumulatively over the life of the connection. The counters can be
    used in the absolute sense, meaning that the counter value itself is reported.
    Alternatively, they can be expressed as relative (or *delta*) values, which represent
    the change since the last report. This is done when a report is received, simply
    by subtracting the previous report's numbers from the ones in the current report.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 这些计数器仅在链路开始时重置，因此它们包含在整个连接生命周期中累积的数字。计数器可以用绝对意义使用，即报告计数器的值本身被报告。或者，它们可以表示为相对（或*增量*）值，这代表自上次报告以来的变化。这是在收到报告时完成的，只需从当前报告中的数字中减去上次报告中的数字即可。
- en: Using Link Quality Reports
  id: totrans-289
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用链路质量报告
- en: 'LQR specifies the quality reporting mechanism, but not specific standards for
    link quality, since these are so implementation-dependent. Based on the numbers
    in these reports, a device can decide for itself what conclusions to draw about
    link quality and what action to take, if any. Here are some possible behaviors:'
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: LQR指定了质量报告机制，但没有指定链路质量的具体标准，因为这些标准与实现高度相关。根据这些报告中的数字，设备可以自行决定关于链路质量的结论以及采取什么行动（如果有的话）。以下是一些可能的行为：
- en: Some devices might decide to shut down a link if the absolute number of errors
    seen in any report reaches a certain threshold.
  id: totrans-291
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一些设备可能会决定关闭链路，如果任何报告中看到的错误绝对数量达到某个阈值。
- en: Some might look at the trend in successive reporting periods and take action
    if they detect certain trends, such as an increase in the rate of discarded frames.
  id: totrans-292
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一些可能会查看连续报告期中的趋势，并在检测到某些趋势（如丢弃帧速率的增加）时采取行动。
- en: Some devices might just log the information and take no action at all.
  id: totrans-293
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一些设备可能会记录信息，但不会采取任何行动。
- en: Note
  id: totrans-294
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*LQR aggregates its statistics for all higher-layer protocols transmitted over
    a particular link. It doesn''t keep track of statistics for different higher-layer
    protocols separately, which makes sense, since the quality of the link shouldn''t
    vary from one higher-layer protocol to the next*.'
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: '*LQR聚合了所有通过特定链路传输的更高层协议的统计数据。它不会分别跟踪不同更高层协议的统计数据，这是有道理的，因为链路的质量不应该从一个更高层协议变化到下一个更高层协议*。'
- en: PPP Compression Control Protocol (CCP) and Compression Algorithms
  id: totrans-296
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PPP压缩控制协议（CCP）和压缩算法
- en: PPP is primarily used to provide data link layer connectivity to physical serial
    links. One of the biggest problems with serial links compared to many other types
    of layer 1 connections is that they are relatively slow. Consider that while 10
    Mbps regular Ethernet is considered sluggish by modern LAN standards, it is actually
    much faster than most serial lines used for WAN connectivity, which can be ten,
    one hundred, or even one thousand times slower.
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: PPP主要用于为物理串行链路提供数据链路层连接。与许多其他类型的第1层连接相比，串行链路的一个最大问题是它们相对较慢。考虑到虽然10 Mbps的常规以太网在现代局域网标准中被认为是缓慢的，但实际上它比用于WAN连接的大多数串行线路要快得多。
- en: One way to improve performance over serial links is to compress the data sent
    over the line. Depending on the data transferred, this can double the performance
    compared to uncompressed transmissions, and can, in some cases, do even better
    than that. For this reason, many hardware devices include the ability to compress
    the data stream at the physical layer. The best example of this is probably the
    set of compression protocols used on analog modems.
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 提高串行链路性能的一种方法是在线路上压缩发送的数据。根据传输的数据，这可以将性能提高一倍，与未压缩传输相比，在某些情况下甚至可以做得更好。因此，许多硬件设备都包括在物理层压缩数据流的能力。这最好的例子可能是用于模拟调制解调器的压缩协议集。
- en: 'Some physical links don''t provide any compression capabilities, but could
    still benefit from it. To this end, an optional compression feature was created
    for PPP. It is implemented using the following two distinct protocol components:'
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 一些物理链路不提供任何压缩功能，但仍然可以从中受益。为此，为PPP创建了一个可选的压缩功能。它是通过以下两个不同的协议组件实现的：
- en: '**PPP Compression Control Protocol (CCP)** This protocol is responsible for
    negotiating and managing the use of compression on a PPP link.'
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: '**PPP压缩控制协议（CCP）** 此协议负责协商和管理PPP链路上的压缩使用。'
- en: '**PPP Compression Algorithms** A set of compression algorithms that perform
    the actual compression and decompression of data. Several of these are defined
    in RFCs. In addition, it is possible for two devices to negotiate the use of a
    proprietary compression method if they want to use one that isn''t defined by
    a public standard.'
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: '**PPP压缩算法** 一组执行实际压缩和解压缩数据的压缩算法。其中一些在RFCs中定义。此外，如果两个设备想要使用未由公共标准定义的压缩方法，它们可以协商使用专有压缩方法。'
- en: Tip
  id: totrans-302
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: '**KEY CONCEPT** PPP includes an optional compression feature that can improve
    performance over slow physical links. A variety of different compression algorithms
    are supported. To enable compression, both devices on a PPP link use the *PPP
    Compression Control Protocol (CCP)* to negotiate a compression algorithm to use.
    The compression algorithm is then used to compress and decompress PPP data frames.'
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: '**关键概念** PPP包括一个可选的压缩功能，可以提高慢速物理链路上的性能。支持多种不同的压缩算法。要启用压缩，PPP链路上的两个设备使用*PPP压缩控制协议（CCP）*协商要使用的压缩算法。然后使用该压缩算法来压缩和解压缩PPP数据帧。'
- en: 'CCP Operation: Compression Setup'
  id: totrans-304
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CCP操作：压缩设置
- en: When most people talk about compression in PPP, they mention CCP, which is considered
    "the" compression protocol for PPP. However, CCP is actually used only to configure
    and control the use of compression; in fact, the algorithms do the real work of
    compressing and decompressing. This separation of powers provides flexibility,
    because it allows each implementation to choose what type of compression it wants
    to use.
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 当大多数人谈论PPP中的压缩时，他们会提到CCP，这被认为是“PPP的”压缩协议。然而，实际上CCP仅用于配置和控制压缩的使用；实际上，算法执行真正的压缩和解压缩工作。这种权力的分离提供了灵活性，因为它允许每个实现选择它想要使用的压缩类型。
- en: CCP is analogous to the Network Control Protocols (NCPs) that negotiate parameters
    specific to a network layer protocol sent on the link. An NCP lets two devices
    decide how they will carry layer 3 traffic, such as how Internet Protocol Control
    Protocol (IPCP) lets the devices determine how to carry IP. CCP lets two devices
    decide how they will compress data, in the same basic way.
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: CCP类似于在链路上发送特定于网络层协议的参数的网络控制协议（NCPs）。一个NCP允许两个设备决定它们将如何携带第3层流量，例如，如何Internet协议控制协议（IPCP）允许设备确定如何携带IP。CCP允许两个设备以相同的基本方式决定它们将如何压缩数据。
- en: Similarly, just as each NCP is like a "light" version of LCP, CCP is like a
    light version of LCP. It is used to set up a compression connection called a *CCP
    link* within an LCP link between two devices. Once established, compressed frames
    can be sent between the two devices. CCP also provides messaging capabilities
    for managing and eventually terminating a CCP link. Again, this is very similar
    to how each network layer protocol sets up an NCP link within LCP. A CCP link
    is maintained independently of any NCP links.
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，就像每个NCP是LCP的“轻量”版本一样，CCP也是LCP的轻量版本。它用于在两个设备之间的LCP链路内设置一个称为*CCP链路*的压缩连接。一旦建立，两个设备之间就可以发送压缩帧。CCP还提供了用于管理和最终终止CCP链路的消息功能。再次强调，这与每个网络层协议在LCP内设置NCP链路的方式非常相似。CCP链路是独立于任何NCP链路维护的。
- en: 'CCP uses the same subset of seven LCP message types that the NCPs use, and
    it adds two additional ones. The use of these messages for each of the life stages
    of a CCP link is as follows (this should look familiar if you''ve read about how
    the NCPs and LCP work in [Chapter 10](ch10.html "Chapter 10. PPP CORE PROTOCOLS:
    LINK CONTROL, NETWORK CONTROL, AND AUTHENTICATION")):'
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: CCP使用与NCPs相同的七个LCP消息类型的子集，并增加了两个额外的类型。这些消息在每个CCP链路的生命周期中的使用如下（如果你阅读过关于NCPs和LCP在[第10章](ch10.html
    "第10章。PPP核心协议：链路控制、网络控制和认证")中如何工作的内容，这应该看起来很熟悉）：
- en: '**Link Configuration** Like the NCPs, compression configuration is done once
    CCP reaches the *network layer protocol* phase. The process of setting up compression
    and negotiating parameters is accomplished using Configure-Request, Configure-Ack,
    Configure-Nak, and Configure-Reject messages, just as it is for LCP, except the
    configuration options are particular to CCP.'
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: '**链路配置** 与NCPs一样，压缩配置是在CCP达到*网络层协议*阶段时完成的。设置压缩和协商参数的过程是通过使用配置请求、配置确认、配置拒绝和配置拒绝消息来完成的，就像LCP一样，只是配置选项是针对CCP特定的。'
- en: '**Link Maintenance** Code-Reject messages can be sent to indicate invalid code
    values in CCP frames. The two new message types are Reset-Request and Reset-Ack,
    which are used to reset the compression (the CCP link) in the event of a detected
    failure in decompression.'
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: '**链路维护** 可以发送 Code-Reject 消息来指示 CCP 帧中的无效代码值。两种新的消息类型是 Reset-Request 和 Reset-Ack，它们用于在检测到解压缩失败时重置压缩（CCP
    链路）。'
- en: '**Link Termination** A CCP link can be terminated using Terminate-Request and
    Terminate-Ack. Again, remember that, like the NCP links, the CCP link is set up
    within an LCP link, and closing it doesn''t terminate the LCP link, which controls
    PPP overall.'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: '**链路终止** 可以使用 Terminate-Request 和 Terminate-Ack 来终止 CCP 链路。再次提醒，与 NCP 链路一样，CCP
    链路是在 LCP 链路内设置的，关闭它不会终止控制 PPP 总体的 LCP 链路。'
- en: CCP Configuration Options and Compression Algorithms
  id: totrans-312
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CCP 配置选项和压缩算法
- en: CCP configuration options are used only to negotiate the type of compression
    to be used by the two devices, and to acquire the specifics of how that algorithm
    is to be employed. The device initiating the negotiation sends a Configure-Request
    with one option for each of the compression algorithms it supports. The other
    device compares this list of options to the algorithms it understands. It also
    checks for any specific details relevant to the option to see if it agrees on
    how that algorithm should be used. It then sends back the appropriate reply (Ack,
    Nak, or Reject), and a negotiation ensues until the two devices come up with a
    common algorithm that both understand. If so, compression is turned on; otherwise,
    it is not enabled.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: CCP 配置选项仅用于协商两个设备将使用的压缩类型，以及获取该算法如何使用的具体细节。发起协商的设备会发送一个包含它支持的每个压缩算法的一个选项的 Configure-Request。另一个设备会将此选项列表与它理解的算法进行比较。它还会检查与选项相关的任何特定细节，以查看是否同意如何使用该算法。然后，它会发送适当的回复（Ack,
    Nak 或 Reject），并开始协商，直到两个设备找到一个双方都理解的共同算法。如果是这样，则启用压缩；否则，不启用。
- en: The CCP configuration options begin with a Type value that indicates the compression
    algorithm. When the Type value is 0, this indicates that the option contains information
    about a special, proprietary compression algorithm that isn't covered by any RFC
    standards. This information can be used if both devices understand it. Values
    from 1 to 254 indicate compression algorithms that have been defined for use with
    CCP. [Table 11-1](ch11s02.html#ppp_compression_control_protocol_ccp_com "Table 11-1. PPP
    Compression Control Protocol (CCP) Compression Algorithms") shows the most common
    values of the Type field, including the compression algorithm each corresponds
    to and the number of the RFC that defines it.
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: CCP 配置选项以类型值开始，该值指示压缩算法。当类型值为 0 时，这表示该选项包含有关特殊、专有压缩算法的信息，该算法不受任何 RFC 标准的覆盖。如果两个设备都理解它，则可以使用此信息。从
    1 到 254 的值表示为 CCP 使用而定义的压缩算法。[表 11-1](ch11s02.html#ppp_compression_control_protocol_ccp_com
    "表 11-1. PPP 压缩控制协议 (CCP) 压缩算法") 显示了类型字段的最常见值，包括每个类型值对应的压缩算法以及定义它的 RFC 编号。
- en: Table 11-1. PPP Compression Control Protocol (CCP) Compression Algorithms
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 表 11-1. PPP 压缩控制协议 (CCP) 压缩算法
- en: '| CCP Option Type Value | Defining RFC | Compression Algorithm (As Given in
    RFC Title) |'
  id: totrans-316
  prefs: []
  type: TYPE_TB
  zh: '| CCP 选项类型值 | 定义 RFC | 压缩算法（如 RFC 标题所示） |'
- en: '| --- | --- | --- |'
  id: totrans-317
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| 0 | — | Proprietary |'
  id: totrans-318
  prefs: []
  type: TYPE_TB
  zh: '| 0 | — | 专有 |'
- en: '| 1 and 2 | 1978 | PPP Predictor Compression Protocol |'
  id: totrans-319
  prefs: []
  type: TYPE_TB
  zh: '| 1 和 2 | 1978 | PPP 预测器压缩协议 |'
- en: '| 17 | 1974 | PPP Stac LZS Compression Protocol |'
  id: totrans-320
  prefs: []
  type: TYPE_TB
  zh: '| 17 | 1974 | PPP Stac LZS 压缩协议 |'
- en: '| 18 | 2118 | Microsoft Point-to-Point Compression (MPPC) Protocol |'
  id: totrans-321
  prefs: []
  type: TYPE_TB
  zh: '| 18 | 2118 | 微软点对点压缩 (MPPC) 协议 |'
- en: '| 19 | 1993 | PPP Gandalf FZA Compression Protocol |'
  id: totrans-322
  prefs: []
  type: TYPE_TB
  zh: '| 19 | 1993 | PPP Gandalf FZA 压缩协议 |'
- en: '| 21 | 1977 | PPP BSD Compression Protocol |'
  id: totrans-323
  prefs: []
  type: TYPE_TB
  zh: '| 21 | 1977 | PPP BSD 压缩协议 |'
- en: '| 23 | 1967 | PPP LZS-DCP Compression Protocol (LZS-DCP) |'
  id: totrans-324
  prefs: []
  type: TYPE_TB
  zh: '| 23 | 1967 | PPP LZS-DCP 压缩协议 (LZS-DCP) |'
- en: '| 26 | 1979 | PPP Deflate Protocol |'
  id: totrans-325
  prefs: []
  type: TYPE_TB
  zh: '| 26 | 1979 | PPP Deflate 协议 |'
- en: 'Compression Algorithm Operation: Compressing and Decompressing Data'
  id: totrans-326
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 压缩算法操作：压缩和解压缩数据
- en: 'Once an algorithm has been successfully negotiated, the compression algorithm
    is used to compress data before transmission and to decompress it once received.
    To compress, the transmitting device takes the data that would normally be put
    in the Information field of an uncompressed PPP frame and runs it through the
    compression algorithm. To indicate that a frame has been compressed, the special
    value 0x00FD (hexadecimal) is placed in the PPP Protocol field. When compression
    is used with multiple links and the links are compressed independently, a different
    value is used: 0x00FB.'
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦成功协商了算法，压缩算法就会在传输前压缩数据，并在接收后解压缩数据。为了压缩，发送设备会取通常放在未压缩PPP帧信息字段中的数据，并通过压缩算法进行处理。为了指示一个帧已被压缩，特殊的值0x00FD（十六进制）被放置在PPP协议字段中。当与多个链路一起使用压缩，并且链路独立压缩时，使用不同的值：0x00FB。
- en: You'll recall that in a regular uncompressed frame, the Protocol field indicates
    which layer 3 protocol the data comes from. Since you still need to know this,
    the original Protocol value is actually prepended to the data before compression.
    When the data is decompressed, this value is used to restore the original Protocol
    field, so the receiving device knows to which higher layer the data belongs.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 你会记得，在一个常规未压缩帧中，协议字段指示数据来自哪个第3层协议。由于你仍然需要知道这一点，原始的协议值实际上是在压缩之前附加到数据之前的。当数据解压缩时，这个值被用来恢复原始的协议字段，以便接收设备知道数据属于哪个高层。
- en: For example, if you use IPCP to encapsulate IP data in PPP, the uncompressed
    frame would have a value of 0x8021 in the Protocol field. This value (0x8021)
    would be placed at the start of the data to be compressed. The compressed data
    would be put in a PPP frame with a Protocol value of 0x00FD. The receiving device
    would see the value 0x00FD in the Protocol field, recognize the frame as compressed,
    decompress it, and restore the original frame with 0x8021 as the Protocol value.
    The discussion of the PPP general frame format in [Chapter 12](ch12.html "Chapter 12. PPP
    PROTOCOL FRAME FORMATS") covers this in more detail.
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果你使用IPCP在PPP中封装IP数据，未压缩帧的协议字段将具有0x8021的值。这个值（0x8021）将被放置在要压缩的数据的开始处。压缩数据将被放入一个协议值为0x00FD的PPP帧中。接收设备会在协议字段看到0x00FD的值，识别帧为压缩帧，解压缩它，并恢复原始帧，其中协议值为0x8021。第12章中关于PPP通用帧格式的讨论更详细地介绍了这一点。
- en: In theory, a compression algorithm can put more than one PPP data frame into
    a compressed PPP data frame. Despite this, many, if not most, of the algorithms
    maintain a one-to-one correspondence, putting each PPP data frame into one compressed
    frame. Note that LCP frames are not compressed, nor are the control frames used
    for other protocols. For example, a data frame carrying IP traffic would be compressed,
    but a control frame for IPCP (the NCP for IP) would not be.
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 理论上，压缩算法可以将多个PPP数据帧放入一个压缩PPP数据帧中。尽管如此，许多，如果不是大多数算法，保持一对一的对应关系，将每个PPP数据帧放入一个压缩帧中。请注意，LCP帧不压缩，也不用于其他协议的控制帧。例如，携带IP流量的数据帧会被压缩，但用于IPCP（IP的NCP）的控制帧则不会。
- en: Compression can be combined with encryption. In this case, compression is done
    before encryption.
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 压缩可以与加密结合使用。在这种情况下，压缩是在加密之前进行的。
- en: Note
  id: totrans-332
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*The compression performed by CCP has nothing to do with the header compression
    options that can be negotiated as part of LCP. That type of compression doesn''t
    involve compressing a data stream using a compression algorithm, but rather a
    simple way of saving space in headers when both ends of a link agree to do so*.'
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: '*CCP执行的压缩与可以作为LCP一部分协商的头部压缩选项无关。这种类型的压缩不涉及使用压缩算法压缩数据流，而是一种在链路两端同意这样做时简化头部空间占用的一种简单方法*。'
- en: PPP Encryption Control Protocol (ECP) and Encryption Algorithms
  id: totrans-334
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PPP加密控制协议（ECP）和加密算法
- en: The PPP authentication protocols Password Authentication Protocol (PAP) and
    Challenge Handshake Authentication Protocol (CHAP) can be used to ensure that
    only authorized devices can establish a PPP connection. Once that is done, PPP
    normally provides no other security to the data being transmitted. In particular,
    all data is normally sent in the clear (unencrypted), thereby making it easy for
    someone who intercepts it to read.
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: PPP认证协议密码认证协议（PAP）和挑战握手认证协议（CHAP）可用于确保只有授权设备才能建立PPP连接。一旦完成，PPP通常不会为传输的数据提供其他安全措施。特别是，所有数据通常都是明文（未加密）发送的，这使得拦截它的人很容易阅读。
- en: 'For important data that must be kept secure, encryption prior to transmission
    is a good idea. This can be done at higher layers using something like IPsec,
    but PPP also provides an optional feature that allows data to be encrypted and
    decrypted at the data link layer itself using two protocol components:'
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 对于必须保持安全的重要数据，传输前的加密是一个好主意。这可以在更高层使用类似 IPsec 的方法来完成，但 PPP 也提供了一个可选功能，允许在数据链路层本身使用两个协议组件来加密和解密数据：
- en: '**PPP Encryption Control Protocol (ECP)** This protocol is responsible for
    negotiating and managing the use of encryption on a PPP link.'
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: '**PPP 加密控制协议 (ECP)** 该协议负责协商和管理 PPP 链路上的加密使用。'
- en: '**PPP Encryption Algorithms** A family of encryption algorithms that perform
    the actual encryption and decryption of data. Several of these are defined in
    RFCs, and two devices can also negotiate a proprietary encryption method if they
    want to use one that isn''t defined by a public standard.'
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: '**PPP 加密算法** 是一组执行实际数据加密和解密的加密算法。其中一些在 RFCs 中定义，如果两个设备想要使用未由公共标准定义的加密方法，它们也可以协商一个专有加密方法。'
- en: Tip
  id: totrans-339
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: '**KEY CONCEPT** PPP includes an optional encryption feature that provides privacy
    for data transported over PPP. A number of encryption algorithms are supported.
    To enable encryption, both devices on a PPP link use the *PPP Encryption Control
    Protocol (ECP)* to negotiate which algorithm to use. The selected algorithm is
    then used to encrypt and decrypt PPP data frames.'
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: '**关键概念** PPP 包含一个可选的加密功能，为通过 PPP 传输的数据提供隐私。支持多种加密算法。要启用加密，PPP 链路上的两个设备都使用 *PPP
    加密控制协议 (ECP)* 来协商使用哪种算法。然后使用选定的算法来加密和解密 PPP 数据帧。'
- en: 'ECP Operation: Encryption Setup'
  id: totrans-341
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ECP 操作：加密设置
- en: ECP is usually the only part mentioned when encryption in PPP is discussed,
    but it is actually used only to configure and control the use of encryption; the
    algorithms do the real work. This technique allows each implementation to choose
    which type of encryption it wishes to use.
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 当讨论 PPP 中的加密时，通常只提到 ECP 的这一部分，但实际上它只用于配置和控制加密的使用；算法做实际的工作。这种技术允许每个实现选择它希望使用的加密类型。
- en: The original ECP defined only a single encryption method, and a couple of others
    have since been added. Like CCP, ECP is analogous to the NCPs that negotiate parameters
    specific to a network layer protocol sent on the link, but it deals with how devices
    encrypt data, rather than how they transport layer 3 traffic. This also means
    that like the NCPs, ECP is a light version of LCP and works in the same basic
    way. Once an ECP link is negotiated, devices can send encrypted frames between
    each other. When no longer needed, the ECP link can be terminated.
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 原始的 ECP 只定义了一种加密方法，后来又增加了一些。像 CCP 一样，ECP 类似于 NCPs，它们协商特定于在链路上发送的网络层协议的参数，但它处理的是设备如何加密数据，而不是如何传输第
    3 层流量。这也意味着，像 NCPs 一样，ECP 是 LCP 的轻量级版本，并以相同的基本方式工作。一旦协商了 ECP 链路，设备就可以相互发送加密帧。当不再需要时，可以终止
    ECP 链路。
- en: 'ECP uses the same subset of seven LCP message types that the NCPs use, and
    it adds two more. The use of these messages for each of the life stages of an
    ECP link is as follows:'
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: ECP 使用与 NCPs 相同的七个 LCP 消息类型的子集，并增加了两个。以下是对 ECP 链路每个生命阶段使用这些消息的说明：
- en: '**Link Configuration** Like the NCPs (and also like CCP, of course), encryption
    configuration is done once ECP reaches the *network layer protocol* phase. The
    process of setting up encryption and negotiating parameters is accomplished using
    Configure-Request, Configure-Ack, Configure-Nak, and Configure-Reject messages,
    as I explained in the description of LCP in [Chapter 10](ch10.html "Chapter 10. PPP
    CORE PROTOCOLS: LINK CONTROL, NETWORK CONTROL, AND AUTHENTICATION"), except the
    configuration options are particular to ECP.'
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: '**链路配置** 与 NCPs（当然，也像 CCP 一样），加密配置是在 ECP 达到 *网络层协议* 阶段时完成的。设置加密和协商参数的过程是通过使用
    Configure-Request、Configure-Ack、Configure-Nak 和 Configure-Reject 消息来完成的，正如我在 [第
    10 章](ch10.html "第 10 章。PPP 核心协议：链路控制、网络控制和认证") 中对 LCP 的描述中解释的那样，除了配置选项是特定于 ECP
    的。'
- en: '**Link Maintenance** Code-Reject messages can be sent to indicate invalid code
    values in ECP frames. The two new message types are Reset-Request and Reset-Ack,
    which are used to reset the encryption (the ECP link) in the event of a detected
    failure in decryption.'
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: '**链路维护** 可以发送 Code-Reject 消息来指示 ECP 帧中的无效代码值。两种新的消息类型是 Reset-Request 和 Reset-Ack，它们用于在检测到解密失败时重置加密（ECP
    链路）。'
- en: '**Link Termination** An ECP link can be terminated using Terminate-Request
    and Terminate-Ack. Again, remember that like the NCP links, the ECP link is set
    up within an LCP link, so closing it doesn''t terminate the LCP link.'
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: '**链路终止** 使用 Terminate-Request 和 Terminate-Ack 可以终止 ECP 链路。再次提醒，与 NCP 链路一样，ECP
    链路是在 LCP 链路内设置的，因此关闭它不会终止 LCP 链路。'
- en: ECP Configuration Options and Encryption Algorithms
  id: totrans-348
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ECP 配置选项和加密算法
- en: ECP configuration options are used solely to negotiate the type of encryption
    algorithm that will be used by the two devices and the specifics of how that algorithm
    will be employed. The device initiating the negotiation sends a Configure-Request
    with one option for each of the encryption algorithms it supports. The other device
    compares this list of options to the algorithms it understands. It also checks
    for any details relevant to the option to see if it agrees on how that algorithm
    should be used. It then sends back the appropriate reply (Ack, Nak, or Reject),
    and a negotiation ensues until the two devices come up with a common algorithm
    that they both understand. If so, encryption is enabled; otherwise, it is turned
    off.
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: ECP 配置选项仅用于协商两个设备将使用的加密算法类型以及该算法的具体应用方式。发起协商的设备会发送一个包含它支持的每个加密算法的一个选项的 Configure-Request。另一个设备会将此选项列表与它理解的算法进行比较。它还会检查与选项相关的任何细节，以查看是否同意如何使用该算法。然后，它会发送适当的回复（Ack,
    Nak 或 Reject），并开始协商，直到两个设备找到一个它们都理解的共同算法。如果找到了，则启用加密；否则，关闭加密。
- en: The ECP configuration options begin with a Type value that indicates the encryption
    algorithm. When the Type value is 0, this indicates that the option contains information
    about a special, proprietary encryption method that isn't covered by any RFC standards,
    which can be used if both devices understand it. Values in the range from 1 to
    254 indicate encryption algorithms that have been defined for use with ECP; at
    present, only two are defined. [Table 11-2](ch11s03.html#ppp_encryption_control_protocol_ecp_comp
    "Table 11-2. PPP Encryption Control Protocol (ECP) Compression Algorithms") shows
    the values of the Type field, including the encryption algorithm each corresponds
    to and the number of the RFC that defines it.
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: ECP 配置选项以一个表示加密算法的类型值开始。当类型值为 0 时，这表示选项包含有关特殊专有加密方法的信息，该方法不受任何 RFC 标准的覆盖，如果两个设备都理解它，则可以使用。范围从
    1 到 254 的值表示为 ECP 定义了用于加密的加密算法；目前，只定义了两个。[表 11-2](ch11s03.html#ppp_encryption_control_protocol_ecp_comp
    "表 11-2. PPP 加密控制协议 (ECP) 压缩算法") 显示了类型字段的值，包括每个类型值对应的加密算法以及定义它的 RFC 编号。
- en: Table 11-2. PPP Encryption Control Protocol (ECP) Compression Algorithms
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 表 11-2. PPP 加密控制协议 (ECP) 压缩算法
- en: '| ECP Option Type Value | Defining RFC | Encryption Algorithm (As Given in
    RFC Title) |'
  id: totrans-352
  prefs: []
  type: TYPE_TB
  zh: '| ECP 选项类型值 | 定义 RFC | 加密算法（如 RFC 标题中所示） |'
- en: '| --- | --- | --- |'
  id: totrans-353
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| 0 | — | Proprietary |'
  id: totrans-354
  prefs: []
  type: TYPE_TB
  zh: '| 0 | — | 专有 |'
- en: '| 2 | 2420 | The PPP Triple-DES Encryption Protocol (3DESE) |'
  id: totrans-355
  prefs: []
  type: TYPE_TB
  zh: '| 2 | 2420 | PPP 三重 DES 加密协议 (3DESE) |'
- en: '| 3 | 2419 | The PPP DES Encryption Protocol, Version 2 (DESE-bis) |'
  id: totrans-356
  prefs: []
  type: TYPE_TB
  zh: '| 3 | 2419 | PPP DES 加密协议，版本 2 (DESE-bis) |'
- en: Note
  id: totrans-357
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*Type value 1 was for the original DES algorithm, which was defined in RFC
    1969\. It was superseded by DES version 2 in RFC 2419*.'
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: '*类型值 1 用于原始 DES 算法，该算法在 RFC 1969 中定义。它已被 RFC 2419 中的 DES 版本 2 取代*。'
- en: 'Encryption Algorithm Operation: Encrypting and Decrypting Data'
  id: totrans-359
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 加密算法操作：加密和解密数据
- en: 'Once an encryption algorithm has been successfully negotiated, it is used to
    encrypt data before transmission and to decrypt data that has been received. To
    encrypt, the transmitting device takes the data that would normally be put in
    the Information field of an unencrypted PPP frame and runs it through the encryption
    algorithm. To indicate that a frame has been encrypted, the special value 0x0053
    (hexadecimal) is placed in the PPP Protocol field. When encryption is used with
    multiple links and the links are encrypted independently, a different value is
    used: 0x0055.'
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦成功协商了加密算法，它就会用于在传输前加密数据以及解密接收到的数据。为了加密，发送设备会将通常放入未加密 PPP 数据帧信息字段中的数据通过加密算法处理。为了指示帧已被加密，将特殊值
    0x0053（十六进制）放入 PPP 协议字段。当使用多个链路进行加密且链路独立加密时，使用不同的值：0x0055。
- en: You'll recall that in a regular unencrypted frame, the Protocol field indicates
    which layer 3 protocol the data comes from. Since you still need to know this,
    the original Protocol value is actually prepended to the data before encryption.
    When the data is decrypted, this value is used to restore the original Protocol
    field, so the receiving device knows which higher layer the data belongs to.
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 你会记得，在一个常规未加密的帧中，协议字段指示数据来自哪个第3层协议。由于你仍然需要知道这一点，原始的协议值实际上是在加密之前附加到数据之前的。当数据被解密时，这个值被用来恢复原始的协议字段，这样接收设备就知道数据属于哪个高层。
- en: For example, if you use IPCP to encapsulate IP data in PPP, the unencrypted
    frame would have a value of 0x8021 (hex) in the Protocol field. This value (0x8021)
    would be placed at the start of the data to be encrypted. The encrypted data would
    be put in a PPP frame with a Protocol value of 0x0053\. The receiving device would
    see the value 0x0053 in the Protocol field, recognize the frame as encrypted,
    decrypt it, and restore the original frame with 0x8021 as the Protocol value.
    The discussion of the PPP general frame format in [Chapter 12](ch12.html "Chapter 12. PPP
    PROTOCOL FRAME FORMATS") covers this more completely.
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果你使用IPCP将IP数据封装在PPP中，未加密的帧在协议字段中的值为0x8021（十六进制）。这个值（0x8021）将被放置在要加密的数据的开始处。加密的数据将被放入一个协议值为0x0053的PPP帧中。接收设备会在协议字段中看到0x0053的值，将其识别为加密帧，解密它，并恢复原始帧，其协议值为0x8021。第12章中关于PPP通用帧格式的讨论更全面地涵盖了这一点。
- en: Each encrypted PPP data frame carries exactly one PPP data frame. Note that,
    unlike what you saw in compression, LCP frames and the control frames used for
    other protocols *can* be encrypted. Compression can be combined with encryption;
    in this case, compression is done before encryption.
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: 每个加密的PPP数据帧恰好携带一个PPP数据帧。请注意，与你在压缩中看到的不同，LCP帧以及用于其他协议的控制帧**可以**被加密。压缩可以与加密结合使用；在这种情况下，压缩是在加密之前进行的。
- en: PPP Multilink Protocol (MP, MLP, MLPPP)
  id: totrans-364
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PPP多链路协议（MP，MLP，MLPPP）
- en: Most of the time, there is only a single physical layer link between two devices.
    However, there are some situations for which there may actually be two layer 1
    connections between the same pair of devices. This may seem strange. Why would
    there be more than one link between any pair of machines?
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数情况下，两个设备之间只有一个物理层链路。然而，有些情况下，实际上可能存在两个层1连接在同一对设备之间。这看起来可能有些奇怪。为什么任何一对机器之间会有多个链路？
- en: There are a number of situations in which this can occur. A common one is when
    two links are intentionally placed between a pair of devices. This is often done
    to increase performance by widening the pipe between two devices, without going
    to a newer, more expensive technology. For example, if two machines are connected
    to each other using a regular analog modem that's too slow, a relatively simple
    solution is to use two analog modem pairs connecting the machines to double bandwidth.
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 有许多情况下可能会发生这种情况。一个常见的情况是在一对设备之间故意放置两个链路。这通常是为了通过扩大两个设备之间的管道来提高性能，而不必采用更新、更昂贵的技术。例如，如果两台机器通过一个速度太慢的常规模拟调制解调器相互连接，一个相对简单的解决方案是使用两个模拟调制解调器对来连接机器，以加倍带宽。
- en: A slightly different situation occurs when multiplexing creates the equivalent
    of several physical layer channels between two devices, even if they have only
    one hardware link between them. Consider ISDN, for example. The most common form
    of ISDN service (ISDN basic rate interface or BRI) creates two 64,000 bps *B channels*
    between a pair of devices. These B channels are time division multiplexed and
    carried along with a D channel on a single pair of copper wire, but to the devices,
    they appear *as if* there were two physical layer links between devices, each
    of which carries 64 Kbps of data. And the ISDN primary rate interface (PRI) actually
    creates 23 or more channels, all between the same pair of hardware devices.
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: 当多路复用在两个设备之间创建相当于几个物理层通道时，会出现一种稍微不同的情况，即使它们之间只有一个硬件链路。以ISDN为例。ISDN服务最常见的形式（ISDN基本速率接口或BRI）在两个设备之间创建两个64,000
    bps的*B通道*。这些B通道是时分复用，并携带在单一对铜线上，但对于设备来说，它们看起来*就像*有两条物理层链路，每条链路都携带64 Kbps的数据。而ISDN主速率接口（PRI）实际上创建了23个或更多的通道，所有这些通道都在同一对硬件设备之间。
- en: In a situation where you have multiple links, you could just establish PPP over
    each connection independently. However, this is far from an ideal solution, because
    you would then have to manually distribute the traffic over the two (or more)
    channels or links that connect them. If you wanted to connect to the Internet,
    you would need to make separate connections and then choose which one to use for
    each action. That isn't exactly a recipe for fun, and what's worse is that you
    could never use all the bandwidth for a single purpose, such as downloading the
    latest 100 MB Microsoft security patch.
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 在你有多个链路的情况下，你可以在每个连接上独立建立PPP。然而，这远非一个理想的解决方案，因为你将不得不手动在连接它们的两个（或更多）通道或链路上分配流量。如果你想连接到互联网，你需要建立单独的连接，然后选择每个动作使用哪一个。这并不
    exactly 是一件有趣的事情，更糟糕的是，你永远无法将所有带宽用于单一目的，例如下载最新的100 MB微软安全补丁。
- en: What you really want is a solution that will let you combine multiple links
    and use them as if they were one high-performance link. Some hardware devices
    actually allow thisto be done at the hardware level itself. In ISDN, this technology
    is sometimes called *bonding* when done at layer 1\. For those hardware units
    that don't provide this capability, PPP makes it available in the form of the
    PPP Multilink Protocol (MP). This protocol was originally described in RFC 1717
    and was updated in RFC 1990.
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: 你真正想要的是一个能够让你结合多个链路并将它们用作一个高性能链路的解决方案。一些硬件设备实际上允许在硬件级别本身执行此操作。在ISDN中，当在第一层执行时，这项技术有时被称为*bonding*。对于那些不提供此功能的硬件单元，PPP通过PPP多链路协议（MP）的形式提供这项功能。该协议最初在RFC
    1717中描述，并在RFC 1990中进行了更新。
- en: Note
  id: totrans-370
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*The PPP Multilink Protocol is properly abbreviated MP, but it is common to
    see any of a multitude of other abbreviations used for it. Many of these are actually
    derived from changing the order of the words in the name into Multilink PPP, so
    you will frequently see this called ML PPP, MLPPP, MPPP, MLP, and so forth. These
    are technically incorrect, but widely used, especially MLPPP. I use the correct
    abbreviation in this book*.'
  id: totrans-371
  prefs: []
  type: TYPE_NORMAL
  zh: '*PPP多链路协议正确缩写为MP，但经常看到许多其他缩写被用来指代它。其中许多实际上是从将名称中的单词顺序改变为Multilink PPP中派生出来的，所以你经常会看到它被称为ML
    PPP、MLPPP、MPPP、MLP等等。这些在技术上是不正确的，但被广泛使用，尤其是MLPPP。我在这本书中使用正确的缩写*。'
- en: PPP Multilink Protocol Architecture
  id: totrans-372
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PPP多链路协议架构
- en: MP is an optional feature of PPP, so it must be designed to integrate seamlessly
    into regular PPP operation. To accomplish this, MP is implemented as a new architectural
    sublayer within PPP. In essence, an MP sublayer is inserted between the regular
    PPP mechanism and any network layer protocols using PPP, as shown in [Figure 11-1](ch11s04.html#multilink_ppp_architecture_when_multilin
    "Figure 11-1. Multilink PPP architecture When Multilink PPP is used to combine
    two or more physical links, it sits architecturally above the PPP layers that
    operate on each physical link."). This allows MP to take all network layer data
    to be sent over the PPP link and spread it over multiple physical connections,
    without causing either the normal PPP mechanisms or the network layer protocol
    interfaces to PPP to break.
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: MP是PPP的一个可选特性，因此它必须被设计成能够无缝地集成到常规PPP操作中。为了实现这一点，MP被实现为PPP内部的一个新的架构子层。本质上，一个MP子层被插入到常规PPP机制和任何使用PPP的网络层协议之间，如图[图11-1](ch11s04.html#multilink_ppp_architecture_when_multilin
    "图11-1. 当使用多链路PPP结合两个或更多物理链路时，它在架构上位于每个物理链路上运行的PPP层之上。")所示。这使得MP能够将所有要发送到PPP链路上的网络层数据分散到多个物理连接上，而不会导致常规PPP机制或网络层协议接口与PPP之间的中断。
- en: The column on the left in [Figure 11-1](ch11s04.html#multilink_ppp_architecture_when_multilin
    "Figure 11-1. Multilink PPP architecture When Multilink PPP is used to combine
    two or more physical links, it sits architecturally above the PPP layers that
    operate on each physical link.") shows the TCP/IP model architecture with corresponding
    OSI Reference Model layer numbers. The center column shows the normal PPP layer
    architecture. When MP is used, there are separate PPP implementations running
    over each of two or more physical links. MP sits, architecturally, between these
    links and any network layer protocols that will be transported over those links.
    (In this diagram, only IP is shown because it is most common, but MP can work
    with multiple network layer protocols, each of which are being sent over each
    physical link.)
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: '[图11-1](ch11s04.html#multilink_ppp_architecture_when_multilin "图11-1. 多链路PPP架构
    当多链路PPP用于组合两个或更多物理链路时，它位于架构上位于每个物理链路上运行的PPP层之上。")左边的列显示了带有相应OSI参考模型层号的TCP/IP模型架构。中间的列显示了正常的PPP层架构。当使用MP时，有两个或更多物理链路上的单独PPP实现。MP在架构上位于这些链路和将通过这些链路传输的任何网络层协议之间。（在此图中，只显示了IP，因为它最常见，但MP可以与多个网络层协议一起工作，每个协议都通过每个物理链路发送。）'
- en: '![Multilink PPP architecture When Multilink PPP is used to combine two or more
    physical links, it sits architecturally above the PPP layers that operate on each
    physical link.](httpatomoreillycomsourcenostarchimages287743.png.jpg)'
  id: totrans-375
  prefs: []
  type: TYPE_IMG
  zh: '![多链路PPP架构 当多链路PPP用于组合两个或更多物理链路时，它位于架构上位于每个物理链路上运行的PPP层之上。](httpatomoreillycomsourcenostarchimages287743.png.jpg)'
- en: Figure 11-1. Multilink PPP architecture When Multilink PPP is used to combine
    two or more physical links, it sits architecturally above the PPP layers that
    operate on each physical link.
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: 图11-1. 多链路PPP架构 当使用多链路PPP来组合两个或更多物理链路时，它在架构上位于每个物理链路上运行的PPP层之上。
- en: Tip
  id: totrans-377
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: '**KEY CONCEPT** The *PPP Multilink Protocol (MP)* allows PPP to bundle multiple
    physical links and use them like a single, high-capacity link. It must be enabled
    during link configuration. Once operational, it works by fragmenting whole PPP
    frames and sending the fragments over different physical links.'
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: '**关键概念**PPP 多链路协议（MP）允许PPP将多个物理链路捆绑在一起，并像使用单个高容量链路一样使用它们。在链路配置期间必须启用它。一旦运行，它通过分割整个PPP帧并将碎片通过不同的物理链路发送来工作。'
- en: PPP Multilink Protocol Setup and Configuration
  id: totrans-379
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PPP多链路协议设置和配置
- en: 'To use MP, both devices must have it implemented as part of their PPP software
    and must negotiate its use. This is done by LCP as part of the negotiation of
    basic link parameters in the *link establishment* phase (just like LQR, as described
    earlier in this chapter). Three new configuration options are defined to be negotiated
    to enable MP:'
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用MP，两个设备都必须将其作为PPP软件的一部分实现，并且必须协商其使用。这是通过LCP作为*链路建立*阶段中基本链路参数协商的一部分来完成的（就像本章前面描述的LQR一样）。定义了三个新的配置选项，用于协商以启用MP：
- en: '**Multilink Maximum Received Reconstructed Unit** Provides the basic indication
    that the device starting the negotiation supports MP and wants to use it. The
    option contains a value specifying the maximum size of the PPP frame it supports.
    If the device receiving this option does not support MP, it must respond with
    a Configure-Reject LCP message.'
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: '**多链路最大接收重构单元**提供了基本指示，表明开始协商的设备支持MP并希望使用它。该选项包含一个指定它支持的PPP帧最大大小的值。如果接收此选项的设备不支持MP，则必须以Configure-Reject
    LCP消息响应。'
- en: '**Multilink Short Sequence Number Header Format** Allows devices to negotiate
    the use of a shorter sequence number field for MP frames, for efficiency. (See
    the section on MP frames in [Chapter 12](ch12.html "Chapter 12. PPP PROTOCOL FRAME
    FORMATS") for a full discussion.)'
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: '**多链路短序列号头部格式**允许设备协商使用较短的序列号字段来提高MP帧的效率。（有关MP帧的完整讨论，请参阅[第12章](ch12.html "第12章。PPP协议帧格式")。）'
- en: '**Endpoint Discriminator** Uniquely identifies the system. It is used to allow
    devices to determine which links go to which other devices.'
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: '**端点区分器**唯一地标识系统。它用于允许设备确定哪些链路连接到哪些其他设备。'
- en: Before MP can be used, a successful negotiation of at least the Multilink Maximum
    Received Reconstructed Unit option must be performed on each of the links between
    the two devices. Once this is done and an LCP link exists for each of the physical
    links, a virtual *bundle* is made of the LCP links, and MP is enabled.
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: 在可以使用 MP 之前，必须在两个设备之间的每个链路上进行至少 Multilink 最大接收重建单元选项的成功协商。一旦完成，并且每个物理链路都存在一个
    LCP 链路，就会从 LCP 链路制作一个虚拟 *包*，并启用 MP。
- en: PPP Multilink Protocol Operation
  id: totrans-385
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PPP 多链路协议操作
- en: 'As mentioned previously, MP basically sits between the network layer and the
    regular PPP links and acts as a middleman. Here is what it does for each direction
    of communication:'
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，MP 基本上位于网络层和常规 PPP 链路之间，充当中间人。以下是它在通信每个方向上所做的工作：
- en: '**Transmission** MP accepts datagrams received from any of the network layer
    protocols configured using appropriate NCPs. It first encapsulates them into a
    modified version of the regular PPP frame, and then takes that frame and decides
    how to transmit it over the multiple physical links. Typically, this is done by
    dividing the frame into *fragments* that are evenly spread out over the set of
    links. These are then encapsulated and sent over the physical links. However,
    you can also implement an alternative strategy as well, such as alternating full-sized
    frames between the links. Also, smaller frames typically aren''t fragmented, and
    neither are control frames such as the ones used for link configuration.'
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: '**传输** MP 接受通过适当的 NCP 配置的网络层协议接收到的数据报。它首先将它们封装成修改后的常规 PPP 帧，然后决定如何通过多个物理链路传输该帧。通常，这是通过将帧分成均匀分布在链路集合上的
    *片段* 来实现的。然后，这些片段被封装并通过物理链路发送。然而，你也可以实现一种替代策略，例如在链路之间交替发送完整大小的帧。此外，通常较小的帧不会被分段，控制帧（如用于链路配置的帧）也不会。'
- en: '**Reception** MP takes the fragments received from all physical links and reassembles
    them into the original PPP frame. That frame is then processed like any PPP frame
    by looking at its Protocol field and passing it to the appropriate network layer
    protocol.'
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: '**接收** MP 接收来自所有物理链路的片段，并将它们重新组装成原始的 PPP 帧。然后，该帧就像任何 PPP 帧一样被处理，通过查看其协议字段并将其传递到适当的网络层协议。'
- en: The fragments used in MP are similar in concept to IP fragments, but of course
    these are different protocols running at different layers. To PPP or MP, an IP
    fragment is just an IP datagram like any other.
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: MP 中使用的片段在概念上类似于 IP 片段，但当然这些是运行在不同层的不同协议。对于 PPP 或 MP 来说，一个 IP 片段就像任何其他 IP 数据报一样。
- en: The fragmenting of data in MP introduces a number of complexities that the protocol
    must handle. For example, since fragments are being sent roughly concurrently,
    you need to identify them with a sequence number to facilitate reassembly. You
    also need some control information to identify the first and last fragments. A
    special frame format is used for MP fragments to carry this extra information.
    I describe this in [Chapter 12](ch12.html "Chapter 12. PPP PROTOCOL FRAME FORMATS"),
    which also contains more information about how fragmenting is accomplished, as
    well as an illustration that demonstrates how it works.
  id: totrans-390
  prefs: []
  type: TYPE_NORMAL
  zh: MP 中数据分片引入了协议必须处理的许多复杂性。例如，由于片段大致是并发发送的，你需要用序列号来标识它们以方便重新组装。你还需要一些控制信息来标识第一个和最后一个片段。MP
    片段使用特殊的帧格式来携带这些额外信息。我在 [第 12 章](ch12.html "第 12 章。PPP 协议帧格式") 中描述了这一点，该章还包含了更多关于如何实现分片的信息，以及一个演示其工作原理的插图。
- en: PPP Bandwidth Allocation Protocol (BAP) and Bandwidth Allocation Control Protocol
    (BACP)
  id: totrans-391
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PPP 带宽分配协议（BAP）和带宽分配控制协议（BACP）
- en: The PPP MP allows multiple links between a pair of devices, whether physical
    or in the form of virtual channels, to be combined into a fat pipe (high-capacity
    channel). This offers tremendous advantages to many PPP users, because it lets
    them make optimal use of all their bandwidth, especially for applications such
    as Internet connectivity. It's no surprise, then, that MP has become one of the
    most popular features of PPP.
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: PPP MP 允许一对设备之间（无论是物理的还是虚拟通道的形式）的多个链路组合成一个宽管道（高容量通道）。这对许多 PPP 用户来说提供了巨大的优势，因为它让他们能够充分利用所有带宽，特别是对于互联网连接等应用。因此，MP
    成为 PPP 最受欢迎的功能之一，也就不足为奇了。
- en: The original standard defining MP basically assumed that multiple links would
    be combined into a single bundle. For example, if you had two modem links, they
    would both be connected and then combined, or two B channels in an ISDN link would
    be combined. After MP was set up, the bundle would be available for either device
    to use in its entirety.
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
  zh: 定义MP的原标准基本上假设多个链路将组合成一个单一的束。例如，如果您有两个调制解调器链路，它们都会连接并合并，或者ISDN链路中的两个B通道会合并。在MP设置之后，束将可供任何设备完全使用。
- en: 'There''s one drawback to this system: The fat pipe is always enabled, and in
    many cases, it is expensive to have this set up all the time. It often costs more
    to connect two or more layer 1 links than a single one, and it''s not always needed.
    For example, some ISDN services charge per minute for calls on either of the B
    channels. In the case of modem dial-up, there are per-minute charges in some parts
    of the world. Even where regular phone calls are free, there is a cost in the
    form of tying up a phone line. Consider that in many applications, the amount
    of bandwidth needed varies over time.'
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: 这个系统的缺点之一是：粗管道始终处于启用状态，在许多情况下，始终设置这种配置是昂贵的。连接两个或更多层1链路通常比单个链路更昂贵，而且并不总是需要。例如，一些ISDN服务对B通道的通话按分钟收费。在调制解调器拨号的情况下，世界上某些地区的通话也按分钟收费。即使在常规电话免费的地方，也存在占用电话线的成本。考虑到在许多应用中，所需的带宽量会随时间变化。
- en: 'It would be better if you could set up MP so that it could dynamically add
    links to the bundle when needed (such as when you decided to download some large
    files), and then automatically drop them when no longer required. This enhancement
    to the basic MP package was provided in the form of a pair of new protocols described
    in RFC 2125:'
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您能设置MP，使其能够在需要时动态地将链路添加到束中（例如，当您决定下载一些大文件时），然后在不再需要时自动删除它们，那就更好了。这种对基本MP包的增强是以RFC
    2125中描述的一对新的协议的形式提供的：
- en: '**Bandwidth Allocation Protocol (BAP)** Describes a mechanism where either
    device communicating over an MP bundle of layer 1 links may request that a link
    be added to the bundle or removed from it.'
  id: totrans-396
  prefs: []
  type: TYPE_NORMAL
  zh: '**带宽分配协议（BAP）** 描述了一种机制，其中在层1链路束中通信的任一设备都可以请求将链路添加到束中或从其中删除。'
- en: '**Bandwidth Allocation Control Protocol (BACP)** Allows devices to configure
    how they want to use BAP.'
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: '**带宽分配控制协议（BACP）** 允许设备配置它们想要如何使用BAP。'
- en: Tip
  id: totrans-398
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: '**KEY CONCEPT** *BAP* and *BACP* are used to provide dynamic control over how
    PPP MP functions.'
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: '**关键概念** *BAP* 和 *BACP* 用于提供对PPP MP功能的动态控制。'
- en: 'BACP Operation: Configuring the Use of BAP'
  id: totrans-400
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: BACP操作：配置BAP的使用
- en: Let's start with BACP, since it is the protocol used for the initial setup of
    the feature. BACP is very similar conceptually to all those other PPP protocols
    with "Control" in their names, such as LCP, the NCP family, CCP, and ECP, but
    is actually even simpler. It is used only during link configuration to set up
    BAP. This is done using Configure-Request, Configure-Ack, Configure-Nak, and Configure-Reject
    messages, just as described in the LCP topic.
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从BACP开始，因为它是用于该功能初始设置的协议。从概念上讲，BACP与其他所有名称中带有“控制”（Control）的PPP协议非常相似，例如LCP、NCP家族、CCP和ECP，但实际上它更加简单。它仅在链路配置期间使用，用于设置BAP。这是通过使用配置请求（Configure-Request）、配置确认（Configure-Ack）、配置拒绝（Configure-Nak）和配置拒绝（Configure-Reject）消息来完成的，正如在LCP主题中所描述的那样。
- en: The only configuration option that is negotiated in BACP is one called Favored-Peer,
    which is used to ensure that a problem does not occur if the two devices on the
    link try to send the same request at the same time. If both devices support BAP,
    then the BACP negotiation will succeed and BAP will be activated.
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
  zh: 在BACP中协商的唯一配置选项是称为“首选对等方”（Favored-Peer）的选项，它用于确保当链路上的两个设备同时尝试发送相同的请求时不会出现问题。如果两个设备都支持BAP，那么BACP协商将成功，并将激活BAP。
- en: 'BAP Operation: Adding and Removing Links'
  id: totrans-403
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: BAP操作：添加和删除链路
- en: BAP defines a set of messages that can be sent between devices to add or drop
    links to and from the current PPP bundle. What's particularly interesting about
    BAP is that it includes the tools necessary to have a device actually initiate
    different types of physical layer connections (such as dialing a modem for bundled
    analog links or enabling an extra ISDN channel) when more bandwidth is required.
    It then shuts them down when they're no longer needed.
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: BAP定义了一组可以在设备之间发送的消息，用于向当前PPP束中添加或删除链路。BAP特别有趣的是，它包括在需要更多带宽时实际启动不同类型的物理层连接（例如，为捆绑的模拟链路拨打电话调制解调器或启用额外的ISDN通道）所需的工具。然后，当不再需要时，它们会关闭这些连接。
- en: 'Here''s a brief description of the BAP message types:'
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是BAP消息类型的简要描述：
- en: '**Call-Request and Call-Response** When one device on the link wants to add
    a link to the bundle and initiate the new physical layer link itself, it sends
    a Call-Request frame to tell the other device, which replies with a Call-Response.'
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
  zh: '**呼叫请求和呼叫响应** 当链路上的一个设备想要将链路添加到捆绑中并自己启动新的物理层链路时，它向另一台设备发送一个呼叫请求帧来告知，该设备则以呼叫响应进行回复。'
- en: '**Callback-Request and Callback-Response** These are just like the two previous
    message types, except that they''re used when a device wants its peer (the other
    device on the link) to initiate the call to add a new link. So, if Device A says,
    "I need more bandwidth but I want you to call me, instead of me calling you,"
    it sends Device B a Callback-Request.'
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
  zh: '**回调请求和回调响应** 这些与前面两种消息类型类似，但它们是在设备想要其对等方（链路上的另一台设备）发起调用以添加新链路时使用的。所以，如果设备A说，“我需要更多的带宽，但我想让你打电话给我，而不是我打电话给你，”它就会向设备B发送一个回调请求。'
- en: '**Call-Status-Indication and Call-Status-Response** After a device attempts
    to add a new link to the bundle (after sending a Call-Request or receiving a Callback-Request),
    it reports the status of the new link using the Call-Status-Indication frame.
    The other device then replies with a Call-Status-Response.'
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
  zh: '**呼叫状态指示和呼叫状态响应** 在设备尝试向捆绑中添加新链路（在发送呼叫请求或接收回调请求后）后，它使用呼叫状态指示帧报告新链路的状态。然后，另一台设备以呼叫状态响应进行回复。'
- en: '**Link-Drop-Query-Request and Link-Drop-Query-Response** One device uses these
    messages to request that a link be dropped, and the other uses them to respond
    to that request.'
  id: totrans-409
  prefs: []
  type: TYPE_NORMAL
  zh: '**链路删除查询请求和链路删除查询响应** 一台设备使用这些消息请求删除链路，而另一台设备则使用它们来响应这个请求。'
- en: Note that the decision of when to add or remove links is not made by these protocols.
    It is left up to the particular implementation.
  id: totrans-410
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，何时添加或删除链路的决定不是由这些协议做出的。这取决于特定的实现。
- en: Chapter 12. PPP PROTOCOL FRAME FORMATS
  id: totrans-411
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第12章。PPP协议帧格式
- en: '![image with no caption](httpatomoreillycomsourcenostarchimages287681.png.jpg)'
  id: totrans-412
  prefs: []
  type: TYPE_IMG
  zh: '![无标题图片](httpatomoreillycomsourcenostarchimages287681.png.jpg)'
- en: The Point-to-Point Protocol (PPP) protocol suite includes a number of different
    protocols used to send both data and control information in different ways. Each
    of these packages information into messages called *frames*, each of which follows
    a particular *frame format*. PPP starts with a general frame format that encompasses
    all frames sent on the link and then includes more specific formats for different
    purposes. Understanding these formats not only makes diagnosing PPP issues easier,
    but also helps make more clear how the key PPP protocols function.
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: 点对点协议（PPP）协议套件包括许多不同的协议，用于以不同的方式发送数据和控制信息。每个协议都将信息打包成称为*帧*的消息，每个帧都遵循特定的*帧格式*。PPP从一个通用帧格式开始，涵盖链路上发送的所有帧，然后包括用于不同目的的更具体格式。理解这些格式不仅使诊断PPP问题更容易，而且有助于更清楚地了解关键PPP协议的功能。
- en: In this chapter, I illustrate the most common frame formats used for sending
    both data and control information over PPP. I begin with an explanation of the
    overall format used for all PPP frames. I also describe the general format used
    for the various control protocols and the option format that most of them use.
    (One of the nice things about PPP is that so many of the protocols use control
    frames with a common format.)
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我展示了用于在PPP上发送数据和控制信息的最常见帧格式。我首先解释了用于所有PPP帧的整体格式。我还描述了用于各种控制协议的一般格式以及它们大多数使用的选项格式。（PPP的一个优点是，许多协议使用具有共同格式的控制帧。）
- en: I then specifically list the frames used for Link Control Protocol (LCP) and
    the authentication protocols (PAP and CHAP). I also describe the special format
    used by the PPP Multilink Protocol (MP) to transport fragments of data over bundled
    links.
  id: totrans-415
  prefs: []
  type: TYPE_NORMAL
  zh: 我随后具体列出了用于链路控制协议（LCP）和身份验证协议（PAP和CHAP）的帧。我还描述了PPP多链路协议（MP）用于在捆绑链路上传输数据片段的特殊格式。
- en: Note
  id: totrans-416
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*Due to the sheer number of different protocols in PPP (dozens) and the fact
    that many have their own unique options, I won''t describe all the specific frame
    formats and option formats for every protocol in detail here. Please refer to
    the appropriate RFCs (listed in [Chapter 9](ch09.html "Chapter 9. TCP/IP SERIAL
    LINE INTERNET PROTOCOL (SLIP) AND POINT-TO-POINT PROTOCOL (PPP) OVERVIEW AND FUNDAMENTALS")
    for more detail).*'
  id: totrans-417
  prefs: []
  type: TYPE_NORMAL
  zh: '*由于PPP（点对点协议）中有大量不同的协议（数十种）以及许多协议都有其独特的选项，我无法在此详细描述每个协议的所有特定帧格式和选项格式。请参阅相应的RFC（列于[第9章](ch09.html
    "第9章。TCP/IP串行线路互联网协议（SLIP）和点对点协议（PPP）概述和基础")以获取更多详细信息)。*'
- en: PPP General Frame Format
  id: totrans-418
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PPP通用帧格式
- en: All messages sent using PPP can be considered either *data* or *control information*.
    The word *data* describes the higher-layer datagrams you are trying to transport
    here at layer 2\. This is what our "customers" are giving us to send. Control
    information is used to manage the operation of the various protocols within PPP
    itself. Even though different protocols in the PPP suite use many types of frames,
    at the highest level, they all fit into a single, *general* frame format.
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: 使用PPP发送的所有消息都可以被认为是*数据*或*控制信息*。单词*数据*描述了你在第二层尝试传输的更高层数据报。这是我们“客户”给我们发送的内容。控制信息用于管理PPP内部的各种协议的操作。尽管PPP套件中的不同协议使用许多类型的帧，但在最高层，它们都符合一个单一的、*通用*的帧格式。
- en: You'll recall that the basic operation of the PPP suite is based on the ISO
    High-Level Data Link Control (HDLC) protocol. This becomes very apparent when
    you look at the structure of PPP frames overall—they use the same basic format
    as HDLC, even to the point of including certain fields that aren't strictly necessary
    for PPP itself. The only major change is the addition of a new field to specify
    the protocol of the encapsulated data. The general structure of PPP frames is
    defined in RFC 1662, a companion to the main PPP standard RFC 1661.
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: 你会记得，PPP套件的基本操作基于ISO高级数据链路控制（HDLC）协议。当你查看PPP帧的整体结构时，这一点变得非常明显——它们使用与HDLC相同的基本格式，甚至包括某些对于PPP本身并非严格必要的字段。唯一的重大变化是添加了一个新字段来指定封装数据的协议。PPP帧的一般结构在RFC
    1662中定义，它是PPP主要标准RFC 1661的配套文件。
- en: The general frame format for PPP, showing how the HDLC framing is applied to
    PPP, is described in [Table 12-1](ch12.html#ppp_general_frame_format-id001 "Table 12-1. PPP
    General Frame Format") and illustrated in [Figure 12-1](ch12.html#ppp_general_frame_format-id002
    "Figure 12-1. PPP general frame format").
  id: totrans-421
  prefs: []
  type: TYPE_NORMAL
  zh: PPP的通用帧格式，展示了如何将HDLC帧格式应用于PPP，在[表12-1](ch12.html#ppp_general_frame_format-id001
    "表12-1。PPP通用帧格式")中描述，并在[图12-1](ch12.html#ppp_general_frame_format-id002 "图12-1。PPP通用帧格式")中展示。
- en: Table 12-1. PPP General Frame Format
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: 表12-1. PPP通用帧格式
- en: '| Field Name | Size (Bytes) | Description |'
  id: totrans-423
  prefs: []
  type: TYPE_TB
  zh: '| 字段名称 | 大小（字节） | 描述 |'
- en: '| --- | --- | --- |'
  id: totrans-424
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Flag | 1 | Indicates the start of a PPP frame. Always has the value 01111110
    binary (0x7E hexadecimal, or 126 decimal). |'
  id: totrans-425
  prefs: []
  type: TYPE_TB
  zh: '| 标志 | 1 | 表示PPP帧的开始。始终具有二进制值01111110（十六进制0x7E，或十进制126）。|'
- en: '| Address | 1 | In HDLC this is the address of the destination of the frame.
    But in PPP you are dealing with a direct link between two devices, so this field
    has no real meaning. It is thus always set to 11111111 (0xFF or 255 decimal),
    which is equivalent to a broadcast (it means "all stations"). |'
  id: totrans-426
  prefs: []
  type: TYPE_TB
  zh: '| 地址 | 1 | 在HDLC中，这是帧的目标地址。但在PPP中，你处理的是两个设备之间的直接连接，因此该字段没有实际意义。因此，它始终设置为11111111（十六进制0xFF或十进制255），这相当于广播（意味着“所有站”）。|'
- en: '| Control | 1 | This field is used in HDLC for various control purposes, but
    in PPP it is set to 00000011 (3 decimal). |'
  id: totrans-427
  prefs: []
  type: TYPE_TB
  zh: '| 控制 | 1 | 此字段在HDLC中用于各种控制目的，但在PPP中设置为00000011（十进制3）。|'
- en: '| Protocol | 2 | Identifies the protocol of the datagram encapsulated in the
    Information field of the frame. See the "Protocol Field Ranges" section for more
    information on the Protocol field. |'
  id: totrans-428
  prefs: []
  type: TYPE_TB
  zh: '| 协议 | 2 | 识别帧信息字段中封装的数据报的协议。有关协议字段更多信息，请参阅“协议字段范围”部分。|'
- en: '| Information | Variable | Zero or more bytes of payload that contain either
    data or control information, depending on the frame type. For regular PPP data
    frames, the network layer datagram is encapsulated here. For control frames, the
    control information fields are placed here instead. |'
  id: totrans-429
  prefs: []
  type: TYPE_TB
  zh: '| 信息 | 可变 | 包含数据或控制信息的零个或多个负载字节，具体取决于帧类型。对于常规PPP数据帧，网络层数据报封装在这里。对于控制帧，控制信息字段放置在这里。|'
- en: '| Padding | Variable | In some cases, additional dummy bytes may be added to
    pad out the size of the PPP frame. |'
  id: totrans-430
  prefs: []
  type: TYPE_TB
  zh: '| 填充 | 可变 | 在某些情况下，可能需要添加额外的空字节来填充PPP帧的大小。|'
- en: '| Frame Check Sequence | 2 (or 4) | A checksum computed over the frame to provide
    basic protection against errors in transmission. This is a CRC similar to the
    one used for other layer 2 protocol error-protection schemes such as the one used
    in Ethernet. It can be either 16 bits or 32 bits in size (the default is 16 bits).
    The FCS is calculated over the Address, Control, Protocol, Information, and Padding
    fields. |'
  id: totrans-431
  prefs: []
  type: TYPE_TB
  zh: '| 帧校验序列 | 2 (或 4) | 对帧进行校验和计算，以提供对传输错误的基本保护。这是一个类似于在以太网中使用的其他层2协议错误保护方案（如）的CRC。它可以是16位或32位大小（默认为16位）。FCS是在地址、控制、协议、信息和填充字段上计算的。|'
- en: '| Flag | 1 | Indicates the end of a PPP frame. Always has the value 01111110
    binary (0x7E hexadecimal, or 126 decimal). |'
  id: totrans-432
  prefs: []
  type: TYPE_TB
  zh: '| 标志 | 1 | 表示PPP帧的结束。始终具有二进制值01111110（十六进制0x7E，或十进制126）。|'
- en: '![PPP general frame format](httpatomoreillycomsourcenostarchimages287745.png.jpg)'
  id: totrans-433
  prefs: []
  type: TYPE_IMG
  zh: '![PPP通用帧格式](httpatomoreillycomsourcenostarchimages287745.png.jpg)'
- en: Figure 12-1. PPP general frame format
  id: totrans-434
  prefs: []
  type: TYPE_NORMAL
  zh: 图12-1. PPP通用帧格式
- en: Protocol Field Ranges
  id: totrans-435
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 协议字段范围
- en: The Protocol field is the main frame type indicator for the device receiving
    the frame. For data frames, this is normally the network layer protocol that created
    the datagram; for control frames, it is usually the PPP protocol that created
    the control message. In the case of protocols that modify data such as when compression
    (CCP) or encryption (ECP) are used (as explained in the previous chapter), this
    field identifies the data as being either compressed or encrypted, and the original
    Protocol value is extracted after the Information field is decompressed/decrypted.
  id: totrans-436
  prefs: []
  type: TYPE_NORMAL
  zh: 协议字段是接收帧的设备的主要帧类型指示器。对于数据帧，这通常是创建数据报的网络层协议；对于控制帧，通常是创建控制消息的PPP协议。在修改数据（如前一章中解释的压缩（CCP）或加密（ECP））的情况下，此字段标识数据是压缩的还是加密的，并在信息字段解压缩/解密后提取原始协议值。
- en: All PPP frames are built on the general format shown in [Figure 12-1](ch12.html#ppp_general_frame_format-id002
    "Figure 12-1. PPP general frame format"). The first three bytes are fixed in value,
    followed by a two-byte Protocol field that indicates the frame type. The variable-length
    Information field is formatted in a variety of ways, depending on the PPP frame
    type. Padding may be applied to the frame, which concludes with an FCS field of
    either two or four bytes (two bytes shown here) and a trailing Flag value of 0x7E.
    (See [Figure 12-2](ch12.html#sample_ppp_data_frame_an_example_of_a_pp "Figure 12-2. Sample
    PPP data frame An example of a PPP data frame containing an abbreviated 23-byte
    IP datagram.") for an example of how this format is applied.)
  id: totrans-437
  prefs: []
  type: TYPE_NORMAL
  zh: 所有PPP帧都是基于[图12-1](ch12.html#ppp_general_frame_format-id002 "图12-1. PPP通用帧格式")中所示的一般格式构建的。前三个字节是固定的，后面跟着一个两字节的协议字段，表示帧类型。可变长度的信息字段根据PPP帧类型以多种方式格式化。可以对帧应用填充，以一个两字节或四字节的FCS字段（此处显示为两字节）和一个尾随的标志值0x7E结束。（参见[图12-2](ch12.html#sample_ppp_data_frame_an_example_of_a_pp
    "图12-2. 样本PPP数据帧一个包含缩写23字节IP数据报的PPP数据帧示例.")了解此格式如何应用。）
- en: There are dozens of network layer protocols and PPP control protocols, and a
    correspondingly large number of Protocol values. The main PPP standard defines
    four ranges for organizing these values, as shown in [Table 12-2](ch12.html#ppp_protocol_field_ranges
    "Table 12-2. PPP Protocol Field Ranges").
  id: totrans-438
  prefs: []
  type: TYPE_NORMAL
  zh: 网络层协议和PPP控制协议有数十种，相应地，协议值也有大量。主要PPP标准定义了四个范围来组织这些值，如[表12-2](ch12.html#ppp_protocol_field_ranges
    "表12-2. PPP协议字段范围")所示。
- en: The standard also specifies that the Protocol value must be assigned so that
    the first octet is even and the second octet is odd. So, for example, 0x0021 is
    a valid value, but 0x0121 and 0x0120 are not. (The reason for this will become
    apparent shortly.) There are also certain blocks that are reserved and not used.
  id: totrans-439
  prefs: []
  type: TYPE_NORMAL
  zh: 标准还规定，协议值必须分配，以便第一个字节是偶数，第二个字节是奇数。例如，0x0021是一个有效值，但0x0121和0x0120则不是。（原因将在稍后变得明显。）还有一些特定的块是保留的，不使用。
- en: '[Figure 12-2](ch12.html#sample_ppp_data_frame_an_example_of_a_pp "Figure 12-2. Sample
    PPP data frame An example of a PPP data frame containing an abbreviated 23-byte
    IP datagram.") shows one common application of the PPP general frame format: carrying
    data. The value 0x0021 in the *Protocol* field marks this as an IPv4 datagram.
    This sample has 1 byte of *Padding* and a 2-byte *FCS* as well. (Obviously real
    IP datagrams are longer than the 23 bytes shown here! These bytes are arbitrary
    and don''t represent a real datagram.) See [Figure 12-12](ch12s05.html#ppp_mp_fragmentation_this_diagram_shows_
    "Figure 12-12. PPP MP fragmentation This diagram shows how a single PPP frame
    is fragmented into three smaller ones.") for an illustration of how this same
    data frame is formatted and then fragmented for transmission over multiple links
    using the PPP Multilink Protocol (MP).'
  id: totrans-440
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 12-2](ch12.html#sample_ppp_data_frame_an_example_of_a_pp "图 12-2. 样本 PPP
    数据帧 包含缩略 23 字节 IP 数据报的 PPP 数据帧。") 展示了 PPP 通用帧格式的常见应用之一：携带数据。协议字段中的值 0x0021 标识这是一个
    IPv4 数据报。此示例有 1 字节填充和 2 字节帧校验序列（FCS）。（显然，真实的 IP 数据报比这里显示的 23 字节要长！这些字节是任意的，并不代表一个真实的数据报。）请参阅
    [图 12-12](ch12s05.html#ppp_mp_fragmentation_this_diagram_shows_ "图 12-12. PPP
    MP 分片 此图展示了如何使用 PPP 多链接协议（MP）将单个 PPP 帧分片成三个较小的帧。") 以了解如何格式化和分片此相同的数据帧，以便通过多个链路进行传输。'
- en: Table 12-2. PPP Protocol Field Ranges
  id: totrans-441
  prefs: []
  type: TYPE_NORMAL
  zh: 表 12-2. PPP 协议字段范围
- en: '| Protocol Field Range (Hexadecimal) | Description |'
  id: totrans-442
  prefs: []
  type: TYPE_TB
  zh: '| 协议字段范围（十六进制） | 描述 |'
- en: '| --- | --- |'
  id: totrans-443
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| **0000–3FFF** | Encapsulated network layer datagrams that have an associated
    NCP (see [Chapter 10](ch10.html "Chapter 10. PPP CORE PROTOCOLS: LINK CONTROL,
    NETWORK CONTROL, AND AUTHENTICATION")). In this case, control frames from the
    corresponding NCP use a Protocol field value that is computed by adding 8 to the
    first octet of the network layer Protocol value. For example, for IP the Protocol
    value is 0021, and control frames from the IP Control Protocol (IPCP) use Protocol
    value 8021\. This range also includes several values used for specially processed
    encapsulated datagrams, such as when compression or encryption is employed. |'
  id: totrans-444
  prefs: []
  type: TYPE_TB
  zh: '| **0000–3FFF** | 与 NCP（见 [第 10 章](ch10.html "第 10 章. PPP 核心协议：链路控制、网络控制和认证")）关联的封装网络层数据报。在这种情况下，对应
    NCP 的控制帧使用通过将网络层协议值的第一字节加 8 计算出的协议字段值。例如，对于 IP，协议值是 0021，而 IP 控制协议（IPCP）的控制帧使用协议值
    8021。此范围还包括用于特殊处理封装数据报的几个值，例如在采用压缩或加密时。 |'
- en: '| **4000–7FFF** | Encapsulated datagrams from "low-volume" protocols. These
    are protocols that do not have an associated NCP. |'
  id: totrans-445
  prefs: []
  type: TYPE_TB
  zh: '| **4000–7FFF** | 来自“低流量”协议的封装数据报。这些是没有关联 NCP 的协议。 |'
- en: '| **8000–BFFF** | NCP control frames that correspond to the network layer Protocol
    values in the 0000–3FFF range. |'
  id: totrans-446
  prefs: []
  type: TYPE_TB
  zh: '| **8000–BFFF** | 与 0000–3FFF 范围内的网络层协议值相对应的 NCP 控制帧。 |'
- en: '| **C000–FFFF** | Control frames used by LCP and LCP support protocols such
    as PAP and CHAP. Some miscellaneous protocol values are included here as well.
    |'
  id: totrans-447
  prefs: []
  type: TYPE_TB
  zh: '| **C000–FFFF** | LCP 和 LCP 支持的协议（如 PAP 和 CHAP）使用的控制帧。这里也包括了一些杂项协议值。 |'
- en: '![Sample PPP data frame An example of a PPP data frame containing an abbreviated
    23-byte IP datagram.](httpatomoreillycomsourcenostarchimages287747.png)'
  id: totrans-448
  prefs: []
  type: TYPE_IMG
  zh: '![样本 PPP 数据帧 包含缩略 23 字节 IP 数据报的 PPP 数据帧。](httpatomoreillycomsourcenostarchimages287747.png)'
- en: Figure 12-2. Sample PPP data frame An example of a PPP data frame containing
    an abbreviated 23-byte IP datagram.
  id: totrans-449
  prefs: []
  type: TYPE_NORMAL
  zh: 图 12-2. 样本 PPP 数据帧 包含缩略 23 字节 IP 数据报的 PPP 数据帧。
- en: Protocol Field Values
  id: totrans-450
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 协议字段值
- en: The full list of PPP Protocol values is maintained by the Internet Assigned
    Numbers Authority (IANA), along with all the other different reserved numbers
    for Internet standards. [Table 12-3](ch12.html#common_protocols_carried_in_ppp_frames_a
    "Table 12-3. Common Protocols Carried in PPP Frames and Protocol Field Values")
    shows some of the more common values.
  id: totrans-451
  prefs: []
  type: TYPE_NORMAL
  zh: PPP 协议值的完整列表由互联网数字分配机构（IANA）维护，包括所有其他用于互联网标准的保留数字。 [表 12-3](ch12.html#common_protocols_carried_in_ppp_frames_a
    "表 12-3. 在 PPP 帧中携带的常见协议及其协议字段值") 展示了一些更常见的值。
- en: Table 12-3. Common Protocols Carried in PPP Frames and Protocol Field Values
  id: totrans-452
  prefs: []
  type: TYPE_NORMAL
  zh: 表 12-3. 在 PPP 帧中携带的常见协议及其协议字段值
- en: '| Protocol Type | Protocol Field Value (Hex) | Protocol |'
  id: totrans-453
  prefs: []
  type: TYPE_TB
  zh: '| 协议类型 | 协议字段值（十六进制） | 协议 |'
- en: '| --- | --- | --- |'
  id: totrans-454
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Encapsulated Network Layer Datagrams | 0021 | Internet Protocol version 4
    (IPv4) |'
  id: totrans-455
  prefs: []
  type: TYPE_TB
  zh: '| 封装的网络层数据报 | 0021 | Internet 协议版本 4 (IPv4) |'
- en: '|   | 0023 | OSI Network Layer |'
  id: totrans-456
  prefs: []
  type: TYPE_TB
  zh: '|   | 0023 | OSI 网络层 |'
- en: '|   | 0029 | AppleTalk |'
  id: totrans-457
  prefs: []
  type: TYPE_TB
  zh: '|   | 0029 | AppleTalk |'
- en: '|   | 002B | Novell Internetworking Packet Exchange (IPX) |'
  id: totrans-458
  prefs: []
  type: TYPE_TB
  zh: '|   | 002B | Novell 互连网络数据包交换 (IPX) |'
- en: '|   | 003D | PPP Multilink Protocol (MP) fragment |'
  id: totrans-459
  prefs: []
  type: TYPE_TB
  zh: '|   | 003D | PPP 多链接协议 (MP) 片段 |'
- en: '|   | 003F | NetBIOS Frames (NBF/NetBEUI) |'
  id: totrans-460
  prefs: []
  type: TYPE_TB
  zh: '|   | 003F | NetBIOS 帧（NBF/NetBEUI） |'
- en: '|   | 004D | IBM Systems Network Architecture (SNA) |'
  id: totrans-461
  prefs: []
  type: TYPE_TB
  zh: '|   | 004D | IBM 系统网络架构 (SNA) |'
- en: '|   | 0053 | Encrypted Data (using ECP and a PPP encryption algorithm) |'
  id: totrans-462
  prefs: []
  type: TYPE_TB
  zh: '|   | 0053 | 使用 ECP 和 PPP 加密算法的加密数据 |'
- en: '|   | 0055 | Individual Link Encrypted Data under PPP Multilink |'
  id: totrans-463
  prefs: []
  type: TYPE_TB
  zh: '|   | 0055 | PPP 多链接下的单个链路加密数据 |'
- en: '|   | 0057 | Internet Protocol version 6 (IPv6) |'
  id: totrans-464
  prefs: []
  type: TYPE_TB
  zh: '|   | 0057 | 互联网协议版本 6 (IPv6) |'
- en: '|   | 00FB | Individual Link Compressed Data under PPP Multilink |'
  id: totrans-465
  prefs: []
  type: TYPE_TB
  zh: '|   | 00FB | PPP 多链接下的单个链路压缩数据 |'
- en: '|   | 00FD | Compressed Data (using CCP and a PPP compression algorithm) |'
  id: totrans-466
  prefs: []
  type: TYPE_TB
  zh: '|   | 00FD | 使用 CCP 和 PPP 压缩算法的压缩数据 |'
- en: '| Low-Volume Encapsulated Protocols | 4003 | CDPD Mobile Network Registration
    Protocol |'
  id: totrans-467
  prefs: []
  type: TYPE_TB
  zh: '| 低流量封装协议 | 4003 | CDPD 移动网络注册协议 |'
- en: '|   | 4025 | Fibre Channel |'
  id: totrans-468
  prefs: []
  type: TYPE_TB
  zh: '|   | 4025 | 光纤通道 |'
- en: '| Network Control Protocol (NCP) Control Frames | 8021 | PPP Internet Protocol
    Control Protocol |'
  id: totrans-469
  prefs: []
  type: TYPE_TB
  zh: '| 网络控制协议 (NCP) 控制帧 | 8021 | PPP 互联网协议控制协议 |'
- en: '|   | 8023 | PPP OSI Network Layer Control Protocol |'
  id: totrans-470
  prefs: []
  type: TYPE_TB
  zh: '|   | 8023 | PPP OSI 网络层控制协议 |'
- en: '|   | 8029 | PPP AppleTalk Control Protocol |'
  id: totrans-471
  prefs: []
  type: TYPE_TB
  zh: '|   | 8029 | PPP AppleTalk 控制协议 |'
- en: '|   | 802B | PPP IPX Control Protocol |'
  id: totrans-472
  prefs: []
  type: TYPE_TB
  zh: '|   | 802B | PPP IPX 控制协议 |'
- en: '|   | 803F | PPP NetBIOS Frames Control Protocol |'
  id: totrans-473
  prefs: []
  type: TYPE_TB
  zh: '|   | 803F | PPP NetBIOS 帧控制协议 |'
- en: '|   | 804D | PPP SNA Control Protocol |'
  id: totrans-474
  prefs: []
  type: TYPE_TB
  zh: '|   | 804D | PPP SNA 控制协议 |'
- en: '|   | 8057 | PPP IPv6 Control Protocol |'
  id: totrans-475
  prefs: []
  type: TYPE_TB
  zh: '|   | 8057 | PPP IPv6 控制协议 |'
- en: '| LCP and Other Control Frames | C021 | PPP Link Control Protocol (LCP) |'
  id: totrans-476
  prefs: []
  type: TYPE_TB
  zh: '| LCP 和其他控制帧 | C021 | PPP 链路控制协议 (LCP) |'
- en: '|   | C023 | PPP Password Authentication Protocol (PAP) |'
  id: totrans-477
  prefs: []
  type: TYPE_TB
  zh: '|   | C023 | PPP 密码认证协议 (PAP) |'
- en: '|   | C025 | PPP Link Quality Report (LQR) |'
  id: totrans-478
  prefs: []
  type: TYPE_TB
  zh: '|   | C025 | PPP 链路质量报告 (LQR) |'
- en: '|   | C02B | PPP Bandwidth Allocation Control Protocol (BACP) |'
  id: totrans-479
  prefs: []
  type: TYPE_TB
  zh: '|   | C02B | PPP 带宽分配控制协议 (BACP) |'
- en: '|   | C02D | PPP Bandwidth Allocation Protocol (BAP) |'
  id: totrans-480
  prefs: []
  type: TYPE_TB
  zh: '|   | C02D | PPP 带宽分配协议 (BAP) |'
- en: '|   | C223 | PPP Challenge Handshake Authentication Protocol (CHAP) |'
  id: totrans-481
  prefs: []
  type: TYPE_TB
  zh: '|   | C223 | PPP 挑战握手认证协议 (CHAP) |'
- en: PPP Field Compression
  id: totrans-482
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PPP 字段压缩
- en: PPP uses the HDLC basic framing structure, which includes two fields that are
    needed in HDLC but aren't in PPP due to how the latter operates. The fields are
    the Address and Control fields. Why bother sending two bytes that have the same
    value for every frame and aren't used for anything? Originally, they were maintained
    for compatibility, but this reduces efficiency.
  id: totrans-483
  prefs: []
  type: TYPE_NORMAL
  zh: PPP 使用 HDLC 基本帧结构，该结构包括两个在 HDLC 中需要但在 PPP 中不需要的字段，因为 PPP 的操作方式。这些字段是地址和控制字段。为什么要在每个帧中发送两个具有相同值的字节，而这些字节又没有用于任何目的？最初，它们是为了兼容性而保留的，但这降低了效率。
- en: To avoid wasting two bytes in every frame, it is possible during initial link
    setup using the Link Control Protocol (LCP) for the two devices on the link to
    negotiate a feature called *Address and Control Field Compression (ACFC)* using
    the LCP option by that same name. When enabled, this feature simply causes these
    two fields not to be sent for most PPP frames (but not for LCP control frames).
    In fact, the feature would be better named *Address and Control Field Suppression*,
    because the fields are just suppressed and compressed down to nothing.
  id: totrans-484
  prefs: []
  type: TYPE_NORMAL
  zh: 为了避免在每个帧中浪费两个字节，在初始链路设置期间可以使用链路控制协议 (LCP) 通过该名称相同的 LCP 选项协商一个称为 *地址和控制字段压缩 (ACFC)*
    的功能。启用此功能后，它将简单地导致这些两个字段不发送在大多数 PPP 帧中（但不包括 LCP 控制帧）。实际上，这个功能最好命名为 *地址和控制字段抑制*，因为字段只是被抑制并压缩到无。
- en: Even when devices agree to use field compression, they must still be capable
    of receiving both compressed and uncompressed frames. They differentiate one from
    the other by looking at the first two bytes after the initial Flag field. If they
    contain the value 0xFF03, they must be the Address and Control fields; otherwise,
    those fields were suppressed. (The value 0xFF03 is not a valid Protocol field
    value, so there is no chance of ambiguity.)
  id: totrans-485
  prefs: []
  type: TYPE_NORMAL
  zh: 即使设备同意使用字段压缩，它们仍然必须能够接收压缩和非压缩的帧。它们通过查看初始标志字段之后的第一个字节来区分这两种帧。如果它们包含值 0xFF03，则它们必须是地址和控制字段；否则，这些字段被抑制。（值
    0xFF03 不是一个有效的协议字段值，因此不存在歧义的机会。）
- en: Similarly, it is also possible for the two devices on the link to negotiate
    compression of the Protocol field, so it takes only one byte instead of two. This
    is done generally by dropping the first byte if it is zero, a process called *Protocol
    Field Compression (PFC)*. Recall that the first byte must be even and the second
    odd. Thus, a receiving device examines the evenness of the first byte of the Protocol
    field in each frame. If it is odd, this means that a leading byte of zeros in
    the Protocol field has been suppressed, because the first byte of a full two-byte
    Protocol value must be even.
  id: totrans-486
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，链路上的两个设备也可以协商对协议字段的压缩，使其只占用一个字节而不是两个字节。这通常是通过丢弃第一个字节（如果它是零）来完成的，这个过程称为*协议字段压缩（PFC）*。回想一下，第一个字节必须是偶数，第二个字节是奇数。因此，接收设备检查每个帧中协议字段的第一个字节的偶数性。如果它是奇数，这意味着协议字段中前导零字节已被抑制，因为完整的两个字节协议值的第一个字节必须是偶数。
- en: Note
  id: totrans-487
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*This field compression (really suppression) has nothing to do with data compression
    using PPP''s Compression Control Protocol (CCP) and compression algorithms.*'
  id: totrans-488
  prefs: []
  type: TYPE_NORMAL
  zh: '*此字段压缩（实际上是抑制）与PPP压缩控制协议（CCP）和压缩算法进行的数据压缩无关。*'
- en: PPP General Control Protocol Frame Format and Option Format
  id: totrans-489
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PPP通用控制协议帧格式和选项格式
- en: The general frame format you just saw is used for all of the many frame types
    defined in the PPP protocol suite. Within that format, the Information field carries
    either encapsulated layer 3 user data or encapsulated control messages. These
    control messages contain specific information that is used to configure, manage,
    and discontinue PPP links, and to implement the various features that comprise
    PPP.
  id: totrans-490
  prefs: []
  type: TYPE_NORMAL
  zh: 你刚才看到的通用帧格式用于PPP协议集中定义的所有许多帧类型。在该格式中，信息字段携带封装的第三层用户数据或封装的控制消息。这些控制消息包含用于配置、管理和断开PPP链路以及实现PPP所包含的各种特性的特定信息。
- en: There are many different PPP control protocols that usually can be distinguished
    by the word *Control* appearing their names. These include the main PPP Link Control
    Protocol (LCP); a family of Network Control Protocols (NCPs) such as IPCP, IPXCP,
    and so forth; and also control protocols for implementing features, such as the
    Compression Control Protocol (CCP) and the Encryption Control Protocol (ECP).
    The authentication protocols Password Authentication Protocol (PAP) and Challenge
    Handshake Authentication Protocol (CHAP) lack Control in the name but also fall
    into this category.
  id: totrans-491
  prefs: []
  type: TYPE_NORMAL
  zh: 存在许多不同的PPP控制协议，通常可以通过其名称中出现的单词*控制*来区分。这些包括主要的PPP链路控制协议（LCP）；一系列网络控制协议（NCPs），如IPCP、IPXCP等；以及实现特性的控制协议，如压缩控制协议（CCP）和加密控制协议（ECP）。密码认证协议（PAP）和挑战握手认证协议（CHAP）名称中缺少控制，但也属于这一类别。
- en: The control protocols each use control messages in a slightly different way,
    but there is also a great deal of commonality between the messages. This is because,
    as I explained in my discussions of the PPP protocols, most of the control protocols—such
    as the NCP family, CCP, and ECP—are implemented as subsets of the functionality
    of the LCP. They perform many of the same functions, so the PPP designers wisely
    adapted the LCP messaging system for these other control protocols.
  id: totrans-492
  prefs: []
  type: TYPE_NORMAL
  zh: 每个控制协议都以略微不同的方式使用控制消息，但消息之间也存在许多共性。这是因为，正如我在PPP协议讨论中解释的那样，大多数控制协议——如NCP家族、CCP和ECP——都是作为LCP功能子集实现的。它们执行许多相同的功能，因此PPP设计者明智地采用了LCP消息系统来适应这些其他控制协议。
- en: This all means that control protocol frames have a common format that fits within
    the overall general frame format in PPP. Even protocols like PAP and CHAP, which
    aren't based on LCP, use this general control frame format, which is described
    in [Table 12-4](ch12s02.html#ppp_control_message_format "Table 12-4. PPP Control
    Message Format").
  id: totrans-493
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着控制协议帧具有一个共同的格式，该格式适合PPP中的整体通用帧格式。即使像PAP和CHAP这样的协议不是基于LCP，也使用这种通用控制帧格式，该格式在[表12-4](ch12s02.html#ppp_control_message_format
    "表12-4. PPP控制消息格式")中描述。
- en: Table 12-4. PPP Control Message Format
  id: totrans-494
  prefs: []
  type: TYPE_NORMAL
  zh: 表12-4. PPP控制消息格式
- en: '| Field Name | Size (Bytes) | Description |'
  id: totrans-495
  prefs: []
  type: TYPE_TB
  zh: '| 字段名称 | 大小（字节） | 描述 |'
- en: '| --- | --- | --- |'
  id: totrans-496
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Code (Type) | 1 | A single byte value that indicates what type of control
    message is in this control frame. It is sometimes instead called Type in certain
    PPP standards. |'
  id: totrans-497
  prefs: []
  type: TYPE_TB
  zh: '| Code (类型) | 1 | 一个单字节值，指示此控制帧中控制消息的类型。在某些PPP标准中，有时也称为类型。 |'
- en: '| Identifier | 1 | This is a label field that''s used to match up requests
    with replies. When a request is sent, a new Identifier is generated. When a reply
    is created, the value from the Identifier field in the request that prompted the
    reply is used for the reply''s Identifier field. |'
  id: totrans-498
  prefs: []
  type: TYPE_TB
  zh: '| 标识符 | 1 | 这是一个标签字段，用于将请求与回复匹配。当发送请求时，会生成一个新的标识符。当创建回复时，使用请求中标识符字段的值作为回复的标识符字段。|'
- en: '| Length | 2 | Specifies the length of the control frame. This is needed because
    the Data field is variable in length. The Length field is specified in bytes and
    includes all the fields in the control frame including the Code, Identifier, Length,
    and Data fields. |'
  id: totrans-499
  prefs: []
  type: TYPE_TB
  zh: '| 长度 | 2 | 指定控制帧的长度。这是必需的，因为数据字段长度是可变的。长度字段以字节为单位指定，包括控制帧中的所有字段，包括代码、标识符、长度和数据字段。|'
- en: '| Data | Variable | Contains information specific to the message type. The
    different uses of this field are described later in this chapter. |'
  id: totrans-500
  prefs: []
  type: TYPE_TB
  zh: '| 数据 | 可变 | 包含特定于消息类型的信息。此字段的不同用途将在本章后面进行描述。|'
- en: This entire structure becomes the payload of a PPP frame, meaning that it fits
    into the Information field of a PPP frame, as shown in [Figure 12-3](ch12s02.html#ppp_control_message_format-id001
    "Figure 12-3. PPP control message format"). The four fields of the PPP control
    message format fit within the Information field of the PPP general frame format.
    The Data field is subsequently filled in with data specific to the control message
    type. Thus, the Length field is equal in size to that of the Information field
    in the PPP frame. The Protocol field of a control frame is set to match the protocol
    that generated the control frame. For example, it would be 0xC021 for an LCP frame.
  id: totrans-501
  prefs: []
  type: TYPE_NORMAL
  zh: 整个结构成为 PPP 帧的有效负载，这意味着它适合 PPP 帧的信息字段，如图 [图 12-3](ch12s02.html#ppp_control_message_format-id001
    "图 12-3. PPP 控制消息格式") 所示。PPP 控制消息格式的四个字段适合 PPP 通用帧格式的信息字段。数据字段随后填充与控制消息类型特定的数据。因此，长度字段的大小等于
    PPP 帧中信息字段的大小。控制帧的协议字段设置为与生成控制帧的协议匹配。例如，对于 LCP 帧将是 0xC021。
- en: '![PPP control message format](httpatomoreillycomsourcenostarchimages287749.png.jpg)'
  id: totrans-502
  prefs: []
  type: TYPE_IMG
  zh: '![PPP 控制消息格式](httpatomoreillycomsourcenostarchimages287749.png.jpg)'
- en: Figure 12-3. PPP control message format
  id: totrans-503
  prefs: []
  type: TYPE_NORMAL
  zh: 图 12-3. PPP 控制消息格式
- en: PPP Control Messages and Code Values
  id: totrans-504
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PPP 控制消息和代码值
- en: The Code field indicates the type of control frame within the particular control
    protocol. Some protocols have a unique set of codes used only by that particular
    protocol; examples include the authentication protocols (PAP and CHAP) and the
    Bandwidth Allocation Protocol (BAP). Since the NCPs and many of the feature control
    protocols like CCP and ECP are based on LCP, they use a common set of message
    codes and types. [Table 12-5](ch12s02.html#ppp_control_messages_code_values_and_ppp
    "Table 12-5. PPP Control Messages, Code Values, and PPP Protocol Usage") shows
    these common message codes and indicates which control protocols use them.
  id: totrans-505
  prefs: []
  type: TYPE_NORMAL
  zh: 代码字段指示特定控制协议中的控制帧类型。某些协议有一组独特的代码，仅由该特定协议使用；例如，身份验证协议（PAP 和 CHAP）和带宽分配协议（BAP）。由于
    NCPs 和许多功能控制协议（如 CCP 和 ECP）基于 LCP，它们使用一组通用的消息代码和类型。[表 12-5](ch12s02.html#ppp_control_messages_code_values_and_ppp
    "表 12-5. PPP 控制消息、代码值和 PPP 协议使用") 显示了这些通用消息代码，并指出了哪些控制协议使用它们。
- en: Table 12-5. PPP Control Messages, Code Values, and PPP Protocol Usage
  id: totrans-506
  prefs: []
  type: TYPE_NORMAL
  zh: 表 12-5. PPP 控制消息、代码值和 PPP 协议使用
- en: '| Code Value | Control Message | LCP | NCPs | CCP and ECP |'
  id: totrans-507
  prefs: []
  type: TYPE_TB
  zh: '| 代码值 | 控制消息 | LCP | NCPs | CCP 和 ECP |'
- en: '| --- | --- | --- | --- | --- |'
  id: totrans-508
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- |'
- en: '| **1** | Configure-Request | ⅳ | ⅳ | ⅳ |'
  id: totrans-509
  prefs: []
  type: TYPE_TB
  zh: '| **1** | 配置请求 | ⅳ | ⅳ | ⅳ |'
- en: '| **2** | Configure-Ack | ⅳ | ⅳ | ⅳ |'
  id: totrans-510
  prefs: []
  type: TYPE_TB
  zh: '| **2** | 配置确认 | ⅳ | ⅳ | ⅳ |'
- en: '| **3** | Configure-Nak | ⅳ | ⅳ | ⅳ |'
  id: totrans-511
  prefs: []
  type: TYPE_TB
  zh: '| **3** | 配置拒绝 | ⅳ | ⅳ | ⅳ |'
- en: '| **4** | Configure-Reject | ⅳ | ⅳ | ⅳ |'
  id: totrans-512
  prefs: []
  type: TYPE_TB
  zh: '| **4** | 配置拒绝 | ⅳ | ⅳ | ⅳ |'
- en: '| **5** | Terminate-Request | ⅳ | ⅳ | ⅳ |'
  id: totrans-513
  prefs: []
  type: TYPE_TB
  zh: '| **5** | 终止请求 | ⅳ | ⅳ | ⅳ |'
- en: '| **6** | Terminate-Ack | ⅳ | ⅳ | ⅳ |'
  id: totrans-514
  prefs: []
  type: TYPE_TB
  zh: '| **6** | 终止确认 | ⅳ | ⅳ | ⅳ |'
- en: '| **7** | Code-Reject | ⅳ | ⅳ | ⅳ |'
  id: totrans-515
  prefs: []
  type: TYPE_TB
  zh: '| **7** | 代码拒绝 | ⅳ | ⅳ | ⅳ |'
- en: '| **8** | Protocol-Reject | ⅳ |   |   |'
  id: totrans-516
  prefs: []
  type: TYPE_TB
  zh: '| **8** | 协议拒绝 | ⅳ |   |   |'
- en: '| **9** | Echo-Request | ⅳ |   |   |'
  id: totrans-517
  prefs: []
  type: TYPE_TB
  zh: '| **9** | 回显请求 | ⅳ |   |   |'
- en: '| **10** | Echo-Reply | ⅳ |   |   |'
  id: totrans-518
  prefs: []
  type: TYPE_TB
  zh: '| **10** | 回显回复 | ⅳ |   |   |'
- en: '| **11** | Discard-Request | ⅳ |   |   |'
  id: totrans-519
  prefs: []
  type: TYPE_TB
  zh: '| **11** | 丢弃请求 | ⅳ |   |   |'
- en: '| **12** | Identification | ⅳ |   |   |'
  id: totrans-520
  prefs: []
  type: TYPE_TB
  zh: '| **12** | 识别 | ⅳ |   |   |'
- en: '| **13** | Time-Remaining | ⅳ |   |   |'
  id: totrans-521
  prefs: []
  type: TYPE_TB
  zh: '| **13** | 剩余时间 | ⅳ |   |   |'
- en: '| **14** | Reset-Request |   |   | ⅳ |'
  id: totrans-522
  prefs: []
  type: TYPE_TB
  zh: '| **14** | 重置请求 |   |   | ⅳ |'
- en: '| **15** | Reset-Ack |   |   | ⅳ |'
  id: totrans-523
  prefs: []
  type: TYPE_TB
  zh: '| **15** | 重置确认 |   |   | ⅳ |'
- en: Note
  id: totrans-524
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*I describe the specific ways these frame types are used in the individual
    topics on LCP, the NCPs, CCP, and ECP in Chapters [Chapter 10](ch10.html "Chapter 10. PPP
    CORE PROTOCOLS: LINK CONTROL, NETWORK CONTROL, AND AUTHENTICATION") and [Chapter 11](ch11.html
    "Chapter 11. PPP FEATURE PROTOCOLS").*'
  id: totrans-525
  prefs: []
  type: TYPE_NORMAL
  zh: 我在[第10章](ch10.html "第10章。PPP 核心协议：链路控制、网络控制和认证")和[第11章](ch11.html "第11章。PPP
    功能协议")中描述了这些帧类型在LCP、NCP、CCP和ECP各个独立主题中的具体使用方式。
- en: The contents of the Data field depend entirely on the type of control message.
    In some cases, no extra data needs to be sent at all, in which case the Data field
    may be omitted. In other control messages, it carries information relevant to
    the message type. For example, a *Code-Reject* message carries in the Data field
    a copy of the frame that was rejected.
  id: totrans-526
  prefs: []
  type: TYPE_NORMAL
  zh: 数据字段的内容完全取决于控制消息的类型。在某些情况下，可能根本不需要发送额外数据，这种情况下可以省略数据字段。在其他控制消息中，它携带与消息类型相关的信息。例如，*代码拒绝*消息在数据字段中包含被拒绝的帧的副本。
- en: PPP Control Message Option Format
  id: totrans-527
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PPP控制消息选项格式
- en: The various *Configure*- messages are used to negotiate configuration options
    in LCP and the other control protocols. In their Data fields, they carry one or
    more options that are, again, specific to the protocol using them. For example,
    LCP uses one set of configuration options for the link as a whole, CCP uses options
    to negotiate a compression algorithm, MP uses it to set up multilink bundles,
    and so on. [Figure 12-4](ch12s02.html#ppp_control_message_carrying_options "Figure 12-4. PPP
    control message carrying options") shows how these options, which can vary in
    length, are placed in the Data field of a PPP control message (which is nested
    inside the general PPP frame format). This diagram shows a sample PPP control
    message carrying options in its Data field. Any number of options can be included
    and mixed with other data, depending on the needs of the message.
  id: totrans-528
  prefs: []
  type: TYPE_NORMAL
  zh: 不同的*配置*消息用于在LCP和其他控制协议中协商配置选项。在它们的数据字段中，它们携带一个或多个选项，这些选项再次是特定于使用它们的协议的。例如，LCP使用一组配置选项来配置整个链路，CCP使用选项来协商压缩算法，MP使用它来设置多链路捆绑，等等。[图12-4](ch12s02.html#ppp_control_message_carrying_options
    "图12-4。PPP 控制消息携带选项")显示了这些选项（其长度可能不同）如何放置在PPP控制消息的数据字段中（该字段嵌套在一般的PPP帧格式中）。此图显示了在数据字段中携带选项的示例PPP控制消息。可以根据消息的需求包含任意数量的选项，并与其他数据混合。
- en: '![PPP control message carrying options](httpatomoreillycomsourcenostarchimages287751.png.jpg)'
  id: totrans-529
  prefs: []
  type: TYPE_IMG
  zh: '![PPP控制消息携带选项](httpatomoreillycomsourcenostarchimages287751.png.jpg)'
- en: Figure 12-4. PPP control message carrying options
  id: totrans-530
  prefs: []
  type: TYPE_NORMAL
  zh: 图12-4。PPP控制消息携带选项
- en: Again, there is commonality here. While every option is different, they all
    use the same basic format. Each option that appears in any of the many PPP control
    message types consists of the triplet of Type, Length, and Data, as shown in [Table 12-6](ch12s02.html#ppp_control_message_option_format-id001
    "Table 12-6. PPP Control Message Option Format") and illustrated in [Figure 12-5](ch12s02.html#ppp_control_message_option_format-id002
    "Figure 12-5. PPP control message option format").
  id: totrans-531
  prefs: []
  type: TYPE_NORMAL
  zh: 再次，这里也有共性。虽然每个选项都不同，但它们都使用相同的基本格式。任何出现在众多PPP控制消息类型中的选项都由类型、长度和数据的三元组组成，如[表12-6](ch12s02.html#ppp_control_message_option_format-id001
    "表12-6。PPP 控制消息选项格式")所示，并在[图12-5](ch12s02.html#ppp_control_message_option_format-id002
    "图12-5。PPP 控制消息选项格式")中说明。
- en: Table 12-6. PPP Control Message Option Format
  id: totrans-532
  prefs: []
  type: TYPE_NORMAL
  zh: 表12-6。PPP控制消息选项格式
- en: '| Field Name | Size (Bytes) | Description |'
  id: totrans-533
  prefs: []
  type: TYPE_TB
  zh: '| 字段名称 | 大小（字节） | 描述 |'
- en: '| --- | --- | --- |'
  id: totrans-534
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| **Type** | 1 | A type value that indicates the option type. The set of Type
    values is unique to each protocol. So, for example, LCP has one set of Type values
    corresponding to its configuration options, each NCP has a different set, CCP
    has its own set, and so on. |'
  id: totrans-535
  prefs: []
  type: TYPE_TB
  zh: '| **类型** | 1 | 指示选项类型的类型值。类型值的集合对每个协议是唯一的。例如，LCP有一组与配置选项对应的类型值，每个NCP有不同的类型值，CCP有自己的类型值，等等。
    |'
- en: '| **Length** | 1 | Specifies the length of the option in bytes. |'
  id: totrans-536
  prefs: []
  type: TYPE_TB
  zh: '| **长度** | 1 | 指定选项的长度（字节）。 |'
- en: '| **Data** | Variable | Contains the specific data for the configuration option.
    |'
  id: totrans-537
  prefs: []
  type: TYPE_TB
  zh: '| **数据** | 可变 | 包含配置选项的特定数据。 |'
- en: The configuration options are described briefly in the individual protocol topics.
    I am not showing the specific contents of each option because there are just too
    many of them. These are in the RFCs.
  id: totrans-538
  prefs: []
  type: TYPE_NORMAL
  zh: 配置选项在各个协议主题中简要描述。我没有展示每个选项的具体内容，因为它们的数量实在太多。这些内容在RFC中。
- en: '![PPP control message option format](httpatomoreillycomsourcenostarchimages287753.png)'
  id: totrans-539
  prefs: []
  type: TYPE_IMG
  zh: '![PPP控制消息选项格式](httpatomoreillycomsourcenostarchimages287753.png)'
- en: Figure 12-5. PPP control message option format
  id: totrans-540
  prefs: []
  type: TYPE_NORMAL
  zh: 图12-5. PPP控制消息选项格式
- en: Summary of PPP Control Message Formatting
  id: totrans-541
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PPP控制消息格式总结
- en: 'My intention here has been to show you the general format used for the different
    control protocols because they are so similar and I don''t have the time or space
    to describe each protocol''s frames individually. Here''s a quick summary:'
  id: totrans-542
  prefs: []
  type: TYPE_NORMAL
  zh: 我的意图是向您展示不同控制协议使用的通用格式，因为它们非常相似，我没有时间或空间逐一描述每个协议的帧。以下是一个简要总结：
- en: The PPP general frame format is used for all frames, including all control frames.
    Its Information field contains the payload, which carries the entire control message
    within it for control frames.
  id: totrans-543
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PPP的通用帧格式用于所有帧，包括所有控制帧。其信息字段包含有效载荷，对于控制帧，它携带了整个控制消息。
- en: The control frame is structured using the general format I gave at the start
    of this topic. The Code value indicates the type of control frame for each control
    protocol. The Data field is variable in length, and contains data for that control
    frame, which in some cases may include one or more configuration options.
  id: totrans-544
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 控制帧的结构是使用我在本主题开头给出的通用格式构建的。代码值表示每个控制协议的控制帧类型。数据字段长度可变，包含该控制帧的数据，在某些情况下可能包括一个或多个配置选项。
- en: For configuration control frames like *Configure-Request* and *Configure-Ack*,
    the Data field contains an encapsulated set of options using the general structure
    in the second table in this topic. Each option has its own Data subfield that
    contains data specific to that option.
  id: totrans-545
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于像*配置请求*和*配置确认*这样的配置控制帧，数据字段包含使用本主题第二表中通用结构封装的选项集。每个选项都有自己的数据子字段，包含特定于该选项的数据。
- en: To help make this more clear, the next two sections provide more specific examples
    of frame formats for LCP and the authentication protocols.
  id: totrans-546
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使这一点更加清晰，接下来的两个部分提供了LCP和认证协议的帧格式的更具体示例。
- en: PPP Link Control Protocol (LCP) Frame Formats
  id: totrans-547
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PPP链路控制协议（LCP）帧格式
- en: You just explored the general format used by the various protocols in PPP that
    exchange control messages. Of the many control protocols in PPP, LCP is the most
    important, because it is responsible for basic PPP link setup and operation. It
    is also the protocol used as a template for many of the other control protocols.
  id: totrans-548
  prefs: []
  type: TYPE_NORMAL
  zh: 您刚刚探索了PPP协议中用于交换控制消息的各种协议所使用的通用格式。在PPP的众多控制协议中，LCP（链路控制协议）是最重要的，因为它负责基本的PPP链路设置和操作。它也是用作许多其他控制协议模板的协议。
- en: Since it is so central to PPP, and since many of the other protocols use a similar
    messaging system, let's make the general frame format (shown in [Figure 12-5](ch12s02.html#ppp_control_message_option_format-id002
    "Figure 12-5. PPP control message option format")) more concrete by showing the
    specific frame formats used for each of the LCP control frames. There are 13 different
    frame formats, however, and since they have many fields in common I've combined
    them into a single large summary table. [Table 12-7](ch12s03.html#ppp_link_control_protocol_lcp_frame_type
    "Table 12-7. PPP Link Control Protocol (LCP) Frame Types and Fields") shows the
    contents and meaning for each of the fields in the 13 LCP frame types.
  id: totrans-549
  prefs: []
  type: TYPE_NORMAL
  zh: 由于它在PPP中如此核心，并且许多其他协议使用类似的消息系统，让我们通过展示用于每个LCP控制帧的具体帧格式来使一般的帧格式（如图12-5所示）更加具体。[表12-7](ch12s03.html#ppp_link_control_protocol_lcp_frame_type
    "表12-7. PPP链路控制协议（LCP）帧类型和字段")显示了13种LCP帧类型中每个字段的含义和内容。
- en: Note
  id: totrans-550
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*LCP frame types 5, 6, 9, 10, 11, 12, and 13 allow an additional amount of
    data to be included in the Data field in a manner not strictly described by the
    protocol. The PPP standard says that there may be zero or more octets that "contain
    uninterpreted data for use by the sender" and "may consist of any binary value"
    (RFC 1661). The inclusion of this uninterpreted data is left as an implementation-dependent
    option.*'
  id: totrans-551
  prefs: []
  type: TYPE_NORMAL
  zh: '*LCP帧类型5、6、9、10、11、12和13允许在数据字段中包含额外的数据量，其方式不是严格由协议描述的。PPP标准表示可能有零个或多个字节“包含由发送方使用的未解释数据”并且“可能由任何二进制值组成”（RFC
    1661）。包含这些未解释数据的选择留给了实现者。*'
- en: 'All LCP control frames are encapsulated into a PPP frame by placing the frame
    structure into its Information field, as you saw earlier. The Protocol field is
    set to 0xC021 for LCP. (For an explanation of how the frames are used, see the
    operational description of LCP in [Chapter 10](ch10.html "Chapter 10. PPP CORE
    PROTOCOLS: LINK CONTROL, NETWORK CONTROL, AND AUTHENTICATION").)'
  id: totrans-552
  prefs: []
  type: TYPE_NORMAL
  zh: 所有LCP控制帧都通过将帧结构放入其信息字段中封装到PPP帧中，正如你之前所看到的。协议字段设置为0xC021以表示LCP。（有关帧的使用说明，请参阅第10章中LCP的操作描述[Chapter 10](ch10.html
    "第10章。PPP核心协议：链路控制、网络控制和认证")。）
- en: Table 12-7. PPP Link Control Protocol (LCP) Frame Types and Fields
  id: totrans-553
  prefs: []
  type: TYPE_NORMAL
  zh: 表12-7. PPP链路控制协议（LCP）帧类型和字段
- en: '| Frame Type | Code Field | Identifier Field | Length Field | Data Field |'
  id: totrans-554
  prefs: []
  type: TYPE_TB
  zh: '| 帧类型 | 代码字段 | 标识符字段 | 长度字段 | 数据字段 |'
- en: '| --- | --- | --- | --- | --- |'
  id: totrans-555
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- |'
- en: '| Configure-Request | 1 | New value generated for each frame | 4 + length of
    all included configuration options | Configuration options to be negotiated by
    the two peers on a link. (The previous section in this chapter describes the general
    format of configuration options.) |'
  id: totrans-556
  prefs: []
  type: TYPE_TB
  zh: '| Configure-Request | 1 | 为每个帧生成的新值 | 4 + 所有包含的配置选项的长度 | 两个对等体在链路上协商的配置选项。（本章前面的部分描述了配置选项的一般格式。）
    |'
- en: '| Configure-Ack | 2 | Copied from the Identifier field of the Configure-Request
    frame for which this Configure-Ack is a reply | 4 + length of all included configuration
    options | Configuration options being positively acknowledged (accepted during
    negotiation of the link). |'
  id: totrans-557
  prefs: []
  type: TYPE_TB
  zh: '| Configure-Ack | 2 | 从对应Configure-Ack回复的Configure-Request帧的标识符字段复制而来 | 4 +
    所有包含的配置选项的长度 | 被积极确认的配置选项（在链路协商期间接受）。 |'
- en: '| Configure-Nak | 3 | Copied from the Identifier field of the Configure-Request
    frame for which this Configure-Nak is a reply | 4 + length of all included configuration
    options | Configuration options being negatively acknowledged (renegotiation requested).
    |'
  id: totrans-558
  prefs: []
  type: TYPE_TB
  zh: '| Configure-Nak | 3 | 从对应Configure-Nak回复的Configure-Request帧的标识符字段复制而来 | 4 +
    所有包含的配置选项的长度 | 被否定确认的配置选项（请求重新协商）。 |'
- en: '| Configure-Reject | 4 | Copied from the Identifier field of the Configure-Request
    frame for which this Configure-Reject is a reply | 4 + length of all included
    configuration options | Configuration options being rejected (since the device
    cannot negotiate them). |'
  id: totrans-559
  prefs: []
  type: TYPE_TB
  zh: '| Configure-Reject | 4 | 从对应Configure-Reject回复的Configure-Request帧的标识符字段复制而来
    | 4 + 所有包含的配置选项的长度 | 被拒绝的配置选项（因为设备无法协商它们）。 |'
- en: '| Terminate-Request | 5 | New value generated for each frame | 4 (or more if
    extra data is included) | Not required. See note preceding this table. |'
  id: totrans-560
  prefs: []
  type: TYPE_TB
  zh: '| Terminate-Request | 5 | 为每个帧生成的新值 | 4（如果包含额外数据，则更多） | 不需要。请参阅本表之前的说明。 |'
- en: '| Terminate-Ack | 6 | Copied from the Identifier field of the matching Terminate-Request
    | 4 (or more if extra data is included) | Not required. See note preceding this
    table. |'
  id: totrans-561
  prefs: []
  type: TYPE_TB
  zh: '| Terminate-Ack | 6 | 从匹配的Terminate-Request帧的标识符字段复制而来 | 4（如果包含额外数据，则更多） |
    不需要。请参阅本表之前的说明。 |'
- en: '| Code-Reject | 7 | New value generated for each frame | 4 + length of rejected
    frame | A copy of the LCP frame that was rejected. This is not the complete PPP
    frame, just the LCP control portion from its Information field. |'
  id: totrans-562
  prefs: []
  type: TYPE_TB
  zh: '| Code-Reject | 7 | 为每个帧生成的新值 | 4 + 被拒绝帧的长度 | 被拒绝的LCP帧的副本。这不是完整的PPP帧，只是从其信息字段中的LCP控制部分。
    |'
- en: '| Protocol-Reject | 8 | New value generated for each frame | 6 + length of
    rejected frame | The first two bytes contain the Protocol value of the frame rejected.
    The rest contains a copy of the Information field from the frame rejected. |'
  id: totrans-563
  prefs: []
  type: TYPE_TB
  zh: '| Protocol-Reject | 8 | 为每个帧生成的新值 | 6 + 被拒绝帧的长度 | 前两个字节包含被拒绝帧的协议值。其余部分包含被拒绝帧的信息字段的副本。
    |'
- en: '| Echo-Request | 9 | New value generated for each frame | 8 (or more if extra
    data is included) | Contains a four-byte "magic number" used to detect looped-back
    links, if the appropriate configuration option has been negotiated; otherwise,
    set to zero. May also contain additional uninterpreted data; see note preceding
    this table. |'
  id: totrans-564
  prefs: []
  type: TYPE_TB
  zh: '| Echo-Request | 9 | 为每个帧生成的新值 | 8（如果包含额外数据，则更多） | 包含一个用于检测回环链路的四字节“魔术数字”，如果已协商适当的配置选项；否则，设置为0。也可能包含其他未解释的数据；请参阅本表之前的说明。
    |'
- en: '| Echo-Reply | 10 | Copied from the Identifier field of the matching Echo-Request
    | 8 (or more if extra data is included) | Contains a four-byte "magic number"
    used to detect looped-back links, if the appropriate configuration option has
    been negotiated; otherwise, set to zero. May also contain additional uninterpreted
    data; see note preceding this table. |'
  id: totrans-565
  prefs: []
  type: TYPE_TB
  zh: '| 回显回复 | 10 | 从匹配的回显请求的标识符字段复制 | 8（或更多，如果包含额外数据）| 包含一个四字节的“魔法数字”，用于检测已协商适当配置选项的回环链路；否则，设置为0。也可能包含其他未解释的数据；请参阅此表之前的说明。|'
- en: '| Discard-Request | 11 | New value generated for each frame | 8 (or more if
    extra data is included) | Contains a four-byte "magic number" used to detect looped-back
    links, if the appropriate configuration option has been negotiated; otherwise,
    set to zero. May also contain additional uninterpreted data; see note preceding
    this table. |'
  id: totrans-566
  prefs: []
  type: TYPE_TB
  zh: '| 丢弃请求 | 11 | 为每个帧生成的新值 | 8（或更多，如果包含额外数据）| 包含一个四字节的“魔法数字”，用于检测已协商适当配置选项的回环链路；否则，设置为0。也可能包含其他未解释的数据；请参阅此表之前的说明。|'
- en: '| Identification | 12 | New value generated for each frame | 8 (or more if
    extra data is included) | Contains a four-byte "magic number" used to detect looped-back
    links, if the appropriate configuration option has been negotiated; otherwise,
    set to zero. May also contain additional uninterpreted data; see note preceding
    this table. |'
  id: totrans-567
  prefs: []
  type: TYPE_TB
  zh: '| 标识 | 12 | 为每个帧生成的新值 | 8（或更多，如果包含额外数据）| 包含一个四字节的“魔法数字”，用于检测已协商适当配置选项的回环链路；否则，设置为0。也可能包含其他未解释的数据；请参阅此表之前的说明。|'
- en: '| Time-Remaining | 13 | New value generated for each frame | 12 (or more if
    extra data is included) | Contains a four-byte "magic number" used to detect looped-back
    links, if the appropriate configuration option has been negotiated; otherwise,
    set to zero. Also contains a four-byte value indicating the number of seconds
    remaining in the current session. A value of all ones in this field is interpreted
    as forever, meaning the session will not expire. May also contain additional uninterpreted
    data; see note preceding this table. |'
  id: totrans-568
  prefs: []
  type: TYPE_TB
  zh: '| 剩余时间 | 13 | 为每个帧生成的新值 | 12（或更多，如果包含额外数据）| 包含一个四字节的“魔法数字”，用于检测已协商适当配置选项的回环链路；否则，设置为0。还包含一个四字节的值，表示当前会话剩余的秒数。此字段中全为1的值表示永远，意味着会话不会过期。也可能包含其他未解释的数据；请参阅此表之前的说明。|'
- en: PAP and CHAP Frame Formats
  id: totrans-569
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PAP和CHAP帧格式
- en: For links where security is important, PPP provides two optional authentication
    protocols, PAP and CHAP. These are used during initial link setup by the LCP to
    deny PPP connections to unauthorized devices.
  id: totrans-570
  prefs: []
  type: TYPE_NORMAL
  zh: 对于安全重要的链路，PPP提供了两种可选的认证协议，即PAP和CHAP。这些协议在LCP进行初始链路设置时使用，以拒绝未经授权的设备建立PPP连接。
- en: PAP and CHAP are control protocols and thus use the same basic control protocol
    frame format described earlier in this section. However, since they have a very
    different purpose than LCP and many of the other control protocols, they use a
    distinct set of frames with their own unique set of Code values. PAP uses three
    different control frame types, and CHAP uses four. Let's look at how PAP and CHAP
    frames are constructed.
  id: totrans-571
  prefs: []
  type: TYPE_NORMAL
  zh: PAP和CHAP是控制协议，因此使用本节前面描述的相同基本控制协议帧格式。然而，由于它们与LCP和其他许多控制协议的目的非常不同，它们使用一组独特的帧，并具有自己独特的代码值集。PAP使用三种不同的控制帧类型，而CHAP使用四种。让我们看看PAP和CHAP帧是如何构建的。
- en: PPP PAP Control Frame Formats
  id: totrans-572
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PPP PAP控制帧格式
- en: PAP's three control frames are constructed as shown in Tables [Table 12-8](ch12s04.html#ppp_password_authentication_protocol_pap
    "Table 12-8. PPP Password Authentication Protocol (PAP) Frame Formats") and [Table 12-9](ch12s04.html#ppp_pap_authenticate-request_frame_subfi
    "Table 12-9. PPP PAP Authenticate-Request Frame Subfields"). The *Authenticate-Request*
    uses one format, as illustrated in [Figure 12-6](ch12s04.html#ppp_pap_authenticate-request_frame_forma
    "Figure 12-6. PPP PAP Authenticate-Request frame format"), while the other two
    frame types use a different format, as shown in [Figure 12-7](ch12s04.html#ppp_pap_authenticate-ack_and_authenticat
    "Figure 12-7. PPP PAP Authenticate-Ack and Authenticate-Nak frame format").
  id: totrans-573
  prefs: []
  type: TYPE_NORMAL
  zh: PAP的三个控制帧的构建方式如表[表12-8](ch12s04.html#ppp_password_authentication_protocol_pap
    "表12-8. PPP密码认证协议(PAP)帧格式")和[表12-9](ch12s04.html#ppp_pap_authenticate-request_frame_subfi
    "表12-9. PPP PAP认证请求帧子字段")所示。*认证请求*使用一种格式，如图[图12-6](ch12s04.html#ppp_pap_authenticate-request_frame_forma
    "图12-6. PPP PAP认证请求帧格式")所示，而其他两种帧类型使用不同的格式，如图[图12-7](ch12s04.html#ppp_pap_authenticate-ack_and_authenticat
    "图12-7. PPP PAP认证确认和认证拒绝帧格式")所示。
- en: Table 12-8. PPP Password Authentication Protocol (PAP) Frame Formats
  id: totrans-574
  prefs: []
  type: TYPE_NORMAL
  zh: 表12-8. PPP密码认证协议（PAP）帧格式
- en: '| Frame Type | Code Field | Identifier Field | Length Field | Data Field |'
  id: totrans-575
  prefs: []
  type: TYPE_TB
  zh: '| 帧类型 | 代码字段 | 标识符字段 | 长度字段 | 数据字段 |'
- en: '| --- | --- | --- | --- | --- |'
  id: totrans-576
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- |'
- en: '| Authenticate-Request | 1 | New value generated for each frame | 6 + length
    of Peer-ID + length of password | Contains the user name and password for authentication.
    This is carried in four subfields and arranged as shown in [Table 12-9](ch12s04.html#ppp_pap_authenticate-request_frame_subfi
    "Table 12-9. PPP PAP Authenticate-Request Frame Subfields"). |'
  id: totrans-577
  prefs: []
  type: TYPE_TB
  zh: '| Authenticate-Request | 1 | 每个帧生成的新值 | 6 + Peer-ID长度 + 密码长度 | 包含用于认证的用户名和密码。这包含在四个子字段中，并按[表12-9](ch12s04.html#ppp_pap_authenticate-request_frame_subfi
    "表12-9. PPP PAP Authenticate-Request帧子字段")中所示排列。 |'
- en: '| Authenticate-Ack | 2 | Copied from the Identifier field of the Authenticate-Request
    frame for which this is a reply | 5 + length of included Message | Contains a
    one-byte Msg-Length subfield that specifies the length of the Message subfield
    that follows it. The Message subfield contains an arbitrary string of data whose
    use is implementation- dependent. It may be used to provide an indication of authentication
    success or failure to the user. If not used, the Msg-Length field is still included,
    but its value is set to zero. |'
  id: totrans-578
  prefs: []
  type: TYPE_TB
  zh: '| Authenticate-Ack | 2 | 从Authenticate-Request帧的标识符字段复制而来，作为回复 | 5 + 包含消息的长度
    | 包含一个指定其后消息子字段长度的单字节Msg-Length子字段。消息子字段包含任意字符串数据，其用途取决于实现。它可以用来向用户指示认证成功或失败。如果没有使用，Msg-Length字段仍然包含，但其值设置为零。
    |'
- en: '| Authenticate-Nak | 3 |   |   |   |'
  id: totrans-579
  prefs: []
  type: TYPE_TB
  zh: '| Authenticate-Nak | 3 |   |   |   |'
- en: '![PPP PAP Authenticate-Request frame format](httpatomoreillycomsourcenostarchimages287755.png.jpg)'
  id: totrans-580
  prefs: []
  type: TYPE_IMG
  zh: '![PPP PAP Authenticate-Request帧格式](httpatomoreillycomsourcenostarchimages287755.png.jpg)'
- en: Figure 12-6. PPP PAP Authenticate-Request frame format
  id: totrans-581
  prefs: []
  type: TYPE_NORMAL
  zh: 图12-6. PPP PAP Authenticate-Request帧格式
- en: '![PPP PAP Authenticate-Ack and Authenticate-Nak frame format](httpatomoreillycomsourcenostarchimages287757.png.jpg)'
  id: totrans-582
  prefs: []
  type: TYPE_IMG
  zh: '![PPP PAP Authenticate-Ack和Authenticate-Nak帧格式](httpatomoreillycomsourcenostarchimages287757.png.jpg)'
- en: Figure 12-7. PPP PAP Authenticate-Ack and Authenticate-Nak frame format
  id: totrans-583
  prefs: []
  type: TYPE_NORMAL
  zh: 图12-7. PPP PAP Authenticate-Ack和Authenticate-Nak帧格式
- en: Table 12-9. PPP PAP Authenticate-Request Frame Subfields
  id: totrans-584
  prefs: []
  type: TYPE_NORMAL
  zh: 表12-9. PPP PAP Authenticate-Request帧子字段
- en: '| Subfield Name | Size (Bytes) | Description |'
  id: totrans-585
  prefs: []
  type: TYPE_TB
  zh: '| 子字段名称 | 大小（字节） | 描述 |'
- en: '| --- | --- | --- |'
  id: totrans-586
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Peer-ID Length | 1 | Length of the Peer-ID field, in bytes |'
  id: totrans-587
  prefs: []
  type: TYPE_TB
  zh: '| Peer-ID长度 | 1 | Peer-ID字段的长度，以字节为单位 |'
- en: '| Peer-ID | Variable | Name of the device to be authenticated; equivalent in
    concept to a user name |'
  id: totrans-588
  prefs: []
  type: TYPE_TB
  zh: '| Peer-ID | 可变 | 要认证的设备名称；在概念上等同于用户名 |'
- en: '| Passwd-Length | 1 | Length of the Password field, in bytes |'
  id: totrans-589
  prefs: []
  type: TYPE_TB
  zh: '| Passwd-Length | 1 | 密码字段的长度，以字节为单位 |'
- en: '| Password | Variable | Password corresponding to the name being authenticated
    |'
  id: totrans-590
  prefs: []
  type: TYPE_TB
  zh: '| Password | 可变 | 与正在认证的名称对应的密码 |'
- en: PPP CHAP Control Frame Formats
  id: totrans-591
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PPP CHAP控制帧格式
- en: The four CHAP frame types are formatted as shown in Tables [Table 12-10](ch12s04.html#ppp_challenge_handshake_authentica-id001
    "Table 12-10. PPP Challenge Handshake Authentication Protocol (CHAP) Formats")
    and [Table 12-11](ch12s04.html#chap_challenge_and_response_frame_subfie "Table 12-11. CHAP
    Challenge and Response Frame Subfields"). The Challenge and Response frames use
    one message format, as illustrated in [Figure 12-8](ch12s04.html#ppp_chap_challenge_and_response_frame_fo
    "Figure 12-8. PPP CHAP Challenge and Response frame format"), while the Success
    and Failure frames use a different one, as shown in [Figure 12-9](ch12s04.html#ppp_chap_success_and_failure_frame_forma
    "Figure 12-9. PPP CHAP Success and Failure frame format").
  id: totrans-592
  prefs: []
  type: TYPE_NORMAL
  zh: 四种CHAP帧类型格式如表[表12-10](ch12s04.html#ppp_challenge_handshake_authentica-id001
    "表12-10. PPP挑战握手认证协议（CHAP）格式")和[表12-11](ch12s04.html#chap_challenge_and_response_frame_subfie
    "表12-11. CHAP挑战和响应帧子字段")所示。挑战和响应帧使用一种消息格式，如图[图12-8](ch12s04.html#ppp_chap_challenge_and_response_frame_fo
    "图12-8. PPP CHAP挑战和响应帧格式")所示，而成功和失败帧使用不同的格式，如图[图12-9](ch12s04.html#ppp_chap_success_and_failure_frame_forma
    "图12-9. PPP CHAP成功和失败帧格式")所示。
- en: Table 12-10. PPP Challenge Handshake Authentication Protocol (CHAP) Formats
  id: totrans-593
  prefs: []
  type: TYPE_NORMAL
  zh: 表12-10. PPP挑战握手认证协议（CHAP）格式
- en: '| Frame Type | Code Field | Identifier Field | Length Field | Data Field |'
  id: totrans-594
  prefs: []
  type: TYPE_TB
  zh: '| 帧类型 | 代码字段 | 标识符字段 | 长度字段 | 数据字段 |'
- en: '| --- | --- | --- | --- | --- |'
  id: totrans-595
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- |'
- en: '| Challenge | 1 | New value generated for each frame | 5 + length of challenge
    text + length of Name | Carries the challenge text or response text and a system
    identifier. This information is carried in three subfields, as shown in [Table 12-11](ch12s04.html#chap_challenge_and_response_frame_subfie
    "Table 12-11. CHAP Challenge and Response Frame Subfields"). |'
  id: totrans-596
  prefs: []
  type: TYPE_TB
  zh: '| 挑战 | 1 | 每个帧生成的新值 | 5 + 挑战文本的长度 + 名称的长度 | 载有挑战文本或响应文本和系统标识符。此信息在[表12-11](ch12s04.html#chap_challenge_and_response_frame_subfie
    "表12-11。CHAP 挑战和响应帧子字段")中所示的三个子字段中传输。|'
- en: '| Response | 2 | Copied from the Identifier field of the Challenge frame for
    which this is a reply | 5 + length of Value + length of Name |   |'
  id: totrans-597
  prefs: []
  type: TYPE_TB
  zh: '| 响应 | 2 | 从此响应的挑战帧的标识符字段复制 | 5 + 值的长度 + 名称的长度 |   |'
- en: '| Success | 3 | Copied from the Identifier field of the Response frame for
    which this is a reply | 4 (or more if extra data is included) | May contain an
    arbitrary, implementation-dependent Message field to indicate to the user whether
    authentication was successful or failed. |'
  id: totrans-598
  prefs: []
  type: TYPE_TB
  zh: '| 成功 | 3 | 从此响应的响应帧的标识符字段复制 | 4（或更多，如果包含额外数据）| 可能包含一个任意、实现相关的消息字段，以指示用户身份验证是否成功或失败。|'
- en: '| Failure | 4 |   |   |   |'
  id: totrans-599
  prefs: []
  type: TYPE_TB
  zh: '| 失败 | 4 |   |   |   |'
- en: Table 12-11. CHAP Challenge and Response Frame Subfields
  id: totrans-600
  prefs: []
  type: TYPE_NORMAL
  zh: 表12-11。CHAP 挑战和响应帧子字段
- en: '| Subfield Name | Size (Bytes) | Description |'
  id: totrans-601
  prefs: []
  type: TYPE_TB
  zh: '| 子字段名称 | 大小（字节） | 描述 |'
- en: '| --- | --- | --- |'
  id: totrans-602
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Value-Size | 1 | Length of the Value subfield that follows, in bytes |'
  id: totrans-603
  prefs: []
  type: TYPE_TB
  zh: '| 值大小 | 1 | 后续值子字段的长度，以字节为单位 |'
- en: '| Value | Variable | For a Challenge frame, contains the challenge text used
    in the initial challenge; for a Response frame, contains the encrypted challenge
    text being returned to the authenticator |'
  id: totrans-604
  prefs: []
  type: TYPE_TB
  zh: '| 值 | 变量 | 对于挑战帧，包含初始挑战中使用的挑战文本；对于响应帧，包含返回给验证器的加密挑战文本 |'
- en: '| Name | Variable | One or more bytes of text used to identify the device that
    sent the frame |'
  id: totrans-605
  prefs: []
  type: TYPE_TB
  zh: '| 名称 | 可变 | 用来标识发送帧的设备的文本字节 |'
- en: '![PPP CHAP Challenge and Response frame format](httpatomoreillycomsourcenostarchimages287759.png.jpg)'
  id: totrans-606
  prefs: []
  type: TYPE_IMG
  zh: '![PPP CHAP 挑战和响应帧格式](httpatomoreillycomsourcenostarchimages287759.png.jpg)'
- en: Figure 12-8. PPP CHAP Challenge and Response frame format
  id: totrans-607
  prefs: []
  type: TYPE_NORMAL
  zh: 图12-8。PPP CHAP 挑战和响应帧格式
- en: '![PPP CHAP Success and Failure frame format](httpatomoreillycomsourcenostarchimages287761.png.jpg)'
  id: totrans-608
  prefs: []
  type: TYPE_IMG
  zh: '![PPP CHAP 成功和失败帧格式](httpatomoreillycomsourcenostarchimages287761.png.jpg)'
- en: Figure 12-9. PPP CHAP Success and Failure frame format
  id: totrans-609
  prefs: []
  type: TYPE_NORMAL
  zh: 图12-9。PPP CHAP 成功和失败帧格式
- en: PPP Multilink Protocol (MP) Frame Format
  id: totrans-610
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PPP多链路协议（MP）帧格式
- en: Some devices are connected not by a single physical layer link but by two or
    more. These may be either multiple physical connections, such as two connected
    pairs of modems, or multiplexed virtual layer 1 connections like ISDN B channels.
    In either case, PPP MP can be used to aggregate the bandwidth of these physical
    links to create a single, high-speed *bundle*. I describe how this is done in
    [Chapter 11](ch11.html "Chapter 11. PPP FEATURE PROTOCOLS").
  id: totrans-611
  prefs: []
  type: TYPE_NORMAL
  zh: 一些设备不是通过单个物理层链路连接，而是通过两个或更多。这些可能是多个物理连接，例如两个连接的调制解调器对，或者像ISDN B通道这样的复用虚拟层1连接。在任一情况下，PPP
    MP都可以用来聚合这些物理链路的带宽，创建一个单一的、高速的*捆绑*。我在[第11章](ch11.html "第11章。PPP特性协议")中描述了如何实现这一点。
- en: After MP is configured and starts working, it operates by employing a strategy
    for dividing up regular PPP frames among the many individual physical links that
    compose the MP bundle. This is usually accomplished by chopping up the PPP frames
    into pieces called *fragments* and spreading them across the physical links. This
    allows the traffic on the physical links to be easily balanced.
  id: totrans-612
  prefs: []
  type: TYPE_NORMAL
  zh: 在MP配置并开始工作后，它通过在组成MP捆绑的许多单个物理链路之间分配常规PPP帧的策略来运行。这通常是通过将PPP帧切割成称为*片段*的块，并将它们分散在物理链路上来实现的。这允许物理链路上的流量容易平衡。
- en: PPP MP Frame Fragmentation Process
  id: totrans-613
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PPP MP帧分片过程
- en: 'To accomplish this fragmentation process, the device must follow this three-step
    process:'
  id: totrans-614
  prefs: []
  type: TYPE_NORMAL
  zh: 要完成此分片过程，设备必须遵循以下三个步骤：
- en: '**Original PPP Frame Creation** The data or other information to be sent is
    first formatted as a whole PPP frame, but in a modified form, as we will see momentarily.'
  id: totrans-615
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**原始PPP帧创建** 要发送的数据或其他信息首先被格式化为一个完整的PPP帧，但将以修改后的形式，正如我们马上将看到的。'
- en: '**Fragmentation** The full-sized PPP frame is chopped into fragments by MP.'
  id: totrans-616
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**分片** MP将完整大小的PPP帧切割成片段。'
- en: '**Encapsulation** Each fragment is encapsulated in the Information field of
    a new PPP MP fragment frame, along with control information that allows the fragments
    to be reassembled by the recipient.'
  id: totrans-617
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**封装** 每个分片都封装在新的PPP MP分片帧的信息字段中，以及允许接收方重新组装分片的控制信息。'
- en: 'Several of the fields that normally appear in a whole PPP frame aren''t needed
    if that frame is going to then be divided and placed into other PPP MP frames,
    so when fragmentation is to occur, they are omitted when the original PPP frame
    is constructed for efficiency''s sake. These are fields that are not used when
    MP is employed:'
  id: totrans-618
  prefs: []
  type: TYPE_NORMAL
  zh: 如果该帧将被分割并放置到其他PPP MP帧中，则通常出现在整个PPP帧中的几个字段就不需要了，因此当进行分片时，为了提高效率，在构建原始PPP帧时会省略这些字段。这些是在使用MP时未使用的字段：
- en: The Flag fields at the start and end are used only for framing for transmission
    and aren't needed in the logical frame being fragmented.
  id: totrans-619
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 起始和结束处的标志字段仅用于传输的帧定界，在逻辑分片帧中不需要。
- en: The FCS field is not needed, because each fragment has its own FCS field.
  id: totrans-620
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: FCS字段不需要，因为每个分片都有自己的FCS字段。
- en: The special compression options that are possible for any PPP frame are used
    when creating this original frame—that is, the Address and Control Field Compression
    (APCP) and Protocol Field Compression (PFC). This means that there are no Address
    or Control fields in the frame, and the Protocol field is only one byte in size.
    Note that this inherently restricts fragments to carrying only certain types of
    information.
  id: totrans-621
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于任何PPP帧可能使用的特殊压缩选项，在创建此原始帧时都会使用——即地址和控制字段压缩（APCP）和协议字段压缩（PFC）。这意味着帧中不包含地址或控制字段，而协议字段的大小仅为一个字节。请注意，这本质上限制了分片只能携带某些类型的信息。
- en: Tip
  id: totrans-622
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: '**KEY CONCEPT** The PPP Multilink Protocol (MP) normally divides data among
    physical links by creating an original PPP frame with unnecessary headers removed,
    and then dividing it into fragment frames. Each fragment includes special headers
    that allow for the reassembly of the original frame by the recipient device.'
  id: totrans-623
  prefs: []
  type: TYPE_NORMAL
  zh: '**关键概念** PPP多链路协议（MP）通常通过创建一个移除不必要的头部的原始PPP帧，并在物理链路之间分配数据，然后将它分成分片帧。每个分片包含特殊的头部，允许接收设备重新组装原始帧。'
- en: These changes save a full eight bytes on each PPP frame that will be fragmented.
    As a result, the original PPP frame has a very small header, consisting of only
    a one-byte Protocol field. The Protocol value of each fragment is set to 0x003D
    to indicate a MP fragment, while the Protocol field of the original frame becomes
    the first byte of data in the first fragment.
  id: totrans-624
  prefs: []
  type: TYPE_NORMAL
  zh: 这些更改在每个将被分片的PPP帧上节省了完整的八个字节。因此，原始PPP帧具有一个非常小的头部，仅由一个字节的协议字段组成。每个分片的协议值设置为0x003D，以指示一个MP分片，而原始帧的协议字段变为第一个分片中的数据的第一字节。
- en: PPP MP Fragment Frame Format
  id: totrans-625
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PPP MP分片帧格式
- en: The Information field of each fragment uses a substructure that contains a four-field
    *MP header* along with one fragment of the original PPP frame, as shown in [Table 12-12](ch12s05.html#ppp_multilink_protocol_fragment_frame_fo
    "Table 12-12. PPP Multilink Protocol Fragment Frame Format").
  id: totrans-626
  prefs: []
  type: TYPE_NORMAL
  zh: 每个分片的信息字段使用一个包含四个字段*MP头部*以及原始PPP帧的一个分片的子结构，如[表12-12](ch12s05.html#ppp_multilink_protocol_fragment_frame_fo
    "表12-12. PPP多链路协议分片帧格式")所示。
- en: Table 12-12. PPP Multilink Protocol Fragment Frame Format
  id: totrans-627
  prefs: []
  type: TYPE_NORMAL
  zh: 表12-12. PPP多链路协议分片帧格式
- en: '| Field Name | Size (Bytes) | Description |'
  id: totrans-628
  prefs: []
  type: TYPE_TB
  zh: '| 字段名称 | 大小（字节） | 描述 |'
- en: '| --- | --- | --- |'
  id: totrans-629
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| B | 1/8 (1 bit) | Beginning Fragment Flag: When set to 1, flags this fragment
    as the first of the split-up PPP frame. It is set to 0 for other fragments. |'
  id: totrans-630
  prefs: []
  type: TYPE_TB
  zh: '| B | 1/8 (1 bit) | 开始分片标志：当设置为1时，将该分片标记为拆分PPP帧的第一个分片。对于其他分片，设置为0。 |'
- en: '| E | 1/8 (1 bit) | Ending Fragment Flag: When set to 1, flags this fragment
    as the last of the split-up PPP frame. It is set to 0 for other fragments. |'
  id: totrans-631
  prefs: []
  type: TYPE_TB
  zh: '| E | 1/8 (1 bit) | 结束分片标志：当设置为1时，将该分片标记为拆分PPP帧的最后一个分片。对于其他分片，设置为0。 |'
- en: '| Reserved | 2/8 (2 bits) or 6/8 (6 bits) | Not used; set to 0. |'
  id: totrans-632
  prefs: []
  type: TYPE_TB
  zh: '| 保留 | 2/8 (2 bits) 或 6/8 (6 bits) | 未使用；设置为0。 |'
- en: '| Sequence Number | 1 1/2 (12 bits) or 3 (24 bits) | When a frame is split
    up, the fragments are given consecutive sequence numbers so the receiving device
    can properly reassemble them. |'
  id: totrans-633
  prefs: []
  type: TYPE_TB
  zh: '| 序列号 | 1 1/2 (12 bits) 或 3 (24 bits) | 当一个帧被拆分时，分片被赋予连续的序列号，以便接收设备可以正确地重新组装它们。
    |'
- en: '| Fragment Data | Variable | The actual fragment from the original PPP frame.
    |'
  id: totrans-634
  prefs: []
  type: TYPE_TB
  zh: '| 分片数据 | 可变 | 原始PPP帧的实际分片。 |'
- en: 'As you can see, the MP frame format comes in two versions: the long format
    uses a four-byte header, while the short format requires only four bytes. The
    default MP header format uses a 24-bit Sequence Number and has 6 reserved bits,
    as shown in [Figure 12-10](ch12s05.html#ppp_mp_long_fragment_frame_format_the_lo
    "Figure 12-10. PPP MP long fragment frame format The long PPP MP frame format
    uses a full byte for flags and a 24-bit Sequence Number."). When MP is set up,
    it is possible for devices to negotiate the Multilink Short Sequence Number Header
    Format configuration option. If this is done successfully, shorter 12-bit Sequence
    Numbers are used instead. Four of the reserved bits are also truncated, to save
    two bytes on each frame, as illustrated in [Figure 12-11](ch12s05.html#ppp_mp_short_fragment_frame_format_the_s
    "Figure 12-11. PPP MP short fragment frame format The short version of the PPP
    MP format uses 4 bits for flags and a 12-bit Sequence Number."). (Considering
    that 12 bits still allows for over 4,000 fragments per PPP frame, this is usually
    more than enough!)'
  id: totrans-635
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，MP帧格式有两种版本：长格式使用四个字节的头，而短格式只需要四个字节。默认的MP头格式使用24位序列号和6个保留位，如[图12-10](ch12s05.html#ppp_mp_long_fragment_frame_format_the_lo
    "图12-10. PPP MP长片段帧格式 PPP MP的长帧格式使用一个完整的字节用于标志位和一个24位的序列号。")所示。当设置MP时，设备可以协商Multilink
    Short Sequence Number Header Format配置选项。如果成功完成，则使用较短的12位序列号。还有四个保留位被截断，每个帧节省两个字节，如[图12-11](ch12s05.html#ppp_mp_short_fragment_frame_format_the_s
    "图12-11. PPP MP短片段帧格式 PPP MP格式的简版使用4位用于标志位和一个12位的序列号。")所示。（考虑到12位仍然允许每个PPP帧有超过4000个片段，这通常已经足够了！）
- en: '![PPP MP long fragment frame format The long PPP MP frame format uses a full
    byte for flags and a 24-bit Sequence Number.](httpatomoreillycomsourcenostarchimages287763.png.jpg)'
  id: totrans-636
  prefs: []
  type: TYPE_IMG
  zh: '![PPP MP长片段帧格式 PPP MP的长帧格式使用一个完整的字节用于标志位和一个24位的序列号。](httpatomoreillycomsourcenostarchimages287763.png.jpg)'
- en: Figure 12-10. PPP MP long fragment frame format The long PPP MP frame format
    uses a full byte for flags and a 24-bit Sequence Number.
  id: totrans-637
  prefs: []
  type: TYPE_NORMAL
  zh: 图12-10. PPP MP长片段帧格式 PPP MP的长帧格式使用一个完整的字节用于标志位和一个24位的序列号。
- en: '![PPP MP short fragment frame format The short version of the PPP MP format
    uses 4 bits for flags and a 12-bit Sequence Number.](httpatomoreillycomsourcenostarchimages287765.png.jpg)'
  id: totrans-638
  prefs: []
  type: TYPE_IMG
  zh: '![PPP MP短片段帧格式 PPP MP格式的简版使用4位用于标志位和一个12位的序列号。](httpatomoreillycomsourcenostarchimages287765.png.jpg)'
- en: Figure 12-11. PPP MP short fragment frame format The short version of the PPP
    MP format uses 4 bits for flags and a 12-bit Sequence Number.
  id: totrans-639
  prefs: []
  type: TYPE_NORMAL
  zh: 图12-11. PPP MP短片段帧格式 PPP MP格式的简版使用4位用于标志位和一个12位的序列号。
- en: The Fragment Data field contains the actual fragment to be sent. Since the original
    PPP header (including the Protocol field) is at the start of the original PPP
    frame, this will appear at the start of the first fragment. The remaining fragments
    will have just portions of the Information field of the original PPP frame. The
    last fragment will end with the last bytes of the original PPP frame.
  id: totrans-640
  prefs: []
  type: TYPE_NORMAL
  zh: 片段数据字段包含要发送的实际片段。由于原始PPP头（包括协议字段）位于原始PPP帧的开始处，因此它将出现在第一个片段的开始处。其余的片段将包含原始PPP帧信息字段的片段。最后一个片段将以原始PPP帧的最后几个字节结束。
- en: The receiving device will collect all the fragments for each PPP frame and extract
    the fragment data and MP headers from each. It will use the Sequence Numbers to
    reassemble the fragments and then process the resulting PPP frame.
  id: totrans-641
  prefs: []
  type: TYPE_NORMAL
  zh: 接收设备将收集每个PPP帧的所有片段，并从每个片段中提取片段数据和MP头。它将使用序列号重新组装片段，然后处理生成的PPP帧。
- en: PPP MP Fragmentation Demonstration
  id: totrans-642
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PPP MP分片演示
- en: '[Figure 12-12](ch12s05.html#ppp_mp_fragmentation_this_diagram_shows_ "Figure 12-12. PPP
    MP fragmentation This diagram shows how a single PPP frame is fragmented into
    three smaller ones.") shows a demonstration of fragmenting a PPP data frame. At
    the top is the same PPP data frame shown in [Figure 12-2](ch12.html#sample_ppp_data_frame_an_example_of_a_pp
    "Figure 12-2. Sample PPP data frame An example of a PPP data frame containing
    an abbreviated 23-byte IP datagram.") earlier in the chapter.'
  id: totrans-643
  prefs: []
  type: TYPE_NORMAL
  zh: '[图12-12](ch12s05.html#ppp_mp_fragmentation_this_diagram_shows_ "图12-12. PPP
    MP分片演示 此图展示了如何将单个PPP数据帧分片成三个较小的帧。")展示了PPP数据帧分片的演示。顶部是本章前面[图12-2](ch12.html#sample_ppp_data_frame_an_example_of_a_pp
    "图12-2. 样本PPP数据帧 包含缩写23字节IP数据报的PPP数据帧示例。")中显示的相同PPP数据帧。'
- en: The eight grayed-out bytes are the ones not used when a frame is to be fragmented.
    Thus, the PPP frame used for MP is 24 bytes long. This frame is split into eight-byte
    chunks, each of which is carried in the Fragment Data fields of an MP fragment.
    Note the consecutive Sequence Number values in the fragment frames. Also note
    that the Beginning Fragment field is set only for the first fragment, and the
    Ending Fragment is set only for the last one.
  id: totrans-644
  prefs: []
  type: TYPE_NORMAL
  zh: 这八个被灰显的字节是在帧需要分片时未使用的字节。因此，用于MP的PPP帧长度为24字节。此帧被分割成8字节的块，每个块都包含在MP分片的片段数据字段中。注意片段帧中的连续序列号值。另外，请注意，开始片段字段仅对第一个片段进行设置，而结束片段仅对最后一个进行设置。
- en: '![PPP MP fragmentation This diagram shows how a single PPP frame is fragmented
    into three smaller ones.](httpatomoreillycomsourcenostarchimages287767.png.jpg)'
  id: totrans-645
  prefs: []
  type: TYPE_IMG
  zh: '![PPP MP分片 此图展示了单个PPP帧如何被分成三个更小的帧。](httpatomoreillycomsourcenostarchimages287767.png.jpg)'
- en: Figure 12-12. PPP MP fragmentation This diagram shows how a single PPP frame
    is fragmented into three smaller ones.
  id: totrans-646
  prefs: []
  type: TYPE_NORMAL
  zh: 图12-12. PPP MP分片 此图展示了单个PPP帧如何被分成三个更小的帧。
