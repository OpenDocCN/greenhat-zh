- en: Chapter 9 -
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第九章 -
- en: Sneaking in the Back Door
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 悄悄进入后门
- en: The full range of viable attacks on the Xbox are too numerous to describe in
    this book. The Xbox is based on the PC architecture, a complex, evolved architecture
    originally designed with no thought for security. Many of the classic hardware
    security holes exploited by smart card hackers, such as power supply modulation,
    sideband attacks, and clock glitching have not even been touched on the Xbox,
    to the best of my knowledge. (You can find more information on these security
    weaknesses in the proceedings of the Cryptographic Hardware in Embedded Systems
    (CHES) conference, in the Lecture Notes in Computer Science series (Springer-Verlag).
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在这本书中描述Xbox可行的攻击范围太多，无法一一列举。Xbox基于PC架构，这是一个复杂、演化的架构，最初设计时没有考虑到安全性。据我所知，许多被智能卡黑客利用的经典硬件安全漏洞，如电源调制、旁路攻击和时钟故障，在Xbox上甚至都没有触及。关于这些安全弱点，你可以在密码学硬件在嵌入式系统（CHES）会议的论文集、计算机科学系列讲座笔记（Springer-Verlag）中找到更多信息。
- en: Unfortunately, console and secure PC manufacturers are not concerned about hardware
    security weaknesses, because hardware attacks are “too difficult for the average
    consumer to execute” and therefore of little threat. While it is true that researching
    an attack requires a skilled hacker with the correct tools, implementing an attack
    can be very cheap and easy. I’m reminded of the parable where a mechanic, called
    in to fix an important piece of broken machinery, spends an hour looking at the
    situation and repairs the machine by tapping on it at just the right spot. Upon
    receiving a bill for $1,000, the machine’s owners demand to know why a tap costs
    so much. The mechanic responds with, “The tap costs a dime. Knowing where to tap
    costs $999.90.” The corollary to this parable is that anyone could have executed
    the tap to repair the machine, given specific instructions.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 很不幸，控制台和安全的PC制造商并不关心硬件安全弱点，因为硬件攻击“对普通消费者来说太难执行”因此威胁很小。虽然研究攻击确实需要一位熟练的黑客和正确的工具，但实施攻击可能非常便宜且容易。我想起了这样一个寓言：一位机械师被叫来修理一台重要的损坏机器，他花了一个小时观察情况，然后只通过在正确的位置敲击一下就修复了机器。当收到1000美元的账单时，机器的所有者要求知道为什么敲击一下要花这么多钱。机械师回答说：“敲击一下只需要一角钱。知道在哪里敲击需要999.90美元。”这个寓言的推论是，如果给出具体的指示，任何人都可以执行敲击来修复机器。
- en: 'Security attacks are often the same: difficult to figure out; easy to share
    and implement. Secure hardware manufacturers should also be concerned about adopting
    mainly reactive policies to hacker intrusions. Many hackers work in secret, and
    keep their methods and results quiet so that vendors cannot develop proper countermeasures.
    These hackers also maintain a library of known attacks and back doors, disclosing
    only one at a time, so that vendors with reactive hardware security policies are
    always playing catchup.'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 安全攻击通常是相同的：难以弄清楚；容易分享和实施。安全的硬件制造商也应该关注采用主要针对黑客入侵的被动政策。许多黑客在秘密中进行工作，并保持他们的方法和结果低调，以便供应商不能开发出适当的对策。这些黑客还维护一个已知攻击和后门的库，一次只公开一个，这样具有被动硬件安全政策的供应商总是处于追赶状态。
- en: '**A Commentary on Naming** **Conventions**'
  id: totrans-5
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**命名约定**的评论'
- en: Hacking communities often invent their own terminology for important concepts,
    which can vary from community to community and from industry standard terminology.
    The following is the list of terminologies accepted by the Xbox-Linux community.
    Any deviations from the terminology I use in this book are noted.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 黑客社区经常为重要概念发明自己的术语，这些术语可能因社区而异，也可能与行业标准术语不同。以下是由Xbox-Linux社区接受的术语列表。本书中使用的术语与我使用的任何偏差都将被注明。
- en: '**X-code:** Jam table opcodes; the opcodes used by the secret Southbridge (MCPX)
    boot ROM to initialize the Xbox hardware'
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**X-code**：跳转表操作码；秘密南桥（MCPX）引导ROM用于初始化Xbox硬件的操作码'
- en: '**2BL:** Second boot loader. This is the code that is decrypted by the secret
    boot ROM. It is called the second boot loader because this code’s primary responsibility
    is to decrypt and decompress a kernel image.'
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**2BL**：第二个引导加载程序。这是由秘密引导ROM解密的代码。它被称为第二个引导加载程序，因为该代码的主要责任是解密和解压缩内核映像。'
- en: '**Flash Boot Loader**: In version 1.1 security, this is an intermediate boot
    loader in between the secret boot ROM and the 2BL. The FBL is verified by a lightweight
    hash against a hard-coded value within the secret boot ROM. As a result, the FBL
    cannot be changed without changing the MCPX silicon. The FBL is responsible for
    verifying the digital signature on all critical portions of the FLASH ROM.'
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Flash Boot Loader**：在版本 1.1 安全性中，这是在秘密启动 ROM 和 2BL 之间的一个中间启动加载程序。FBL 通过对秘密启动
    ROM 内部的一个硬编码值进行轻量级哈希验证。因此，如果不更改 MCPX 硅片，则无法更改 FBL。FBL 负责验证 FLASH ROM 所有关键部分的数字签名。'
- en: '**Kernel:** The Xbox kernel code. It is stored compressed and encrypted in
    the FLASH ROM.'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**内核**：Xbox 内核代码。它以压缩和加密的形式存储在 FLASH ROM 中。'
- en: V**ersion 1.0 security:** The original Xbox security system using RC-4 encryption
    on the 2BL.
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**版本 1.0 安全性**：原始 Xbox 安全系统使用 RC-4 加密在 2BL 上。'
- en: '**Version 1.1 security:** The second Xbox security system using the TEA hash
    to verify regions of the FLASH ROM. The earliest manufacturing date seen on boxes
    with version 1.1 security is around August 2002.'
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**版本 1.1 安全性**：第二个使用 TEA 哈希验证 FLASH ROM 区域的 Xbox 安全系统。带有版本 1.1 安全性的盒子最早的生产日期大约在
    2002 年 8 月。'
- en: The previous chapter described my eavesdropping attack on the Xbox security
    mechanism that eventually yielded the RC-4 key hidden in a block of secret code.
    This chapter describes a few of the other attacks available on the Xbox that were
    devised by my colleagues, as well as the attack that was mounted on the revised
    Xbox security scheme, herein referred to as security version 1.1.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 上一章描述了我对 Xbox 安全机制的监听攻击，最终得到了隐藏在一段秘密代码块中的 RC-4 密钥。本章描述了由我的同事设计的其他一些 Xbox 攻击，以及针对修订后的
    Xbox 安全方案（在此称为安全版本 1.1）发起的攻击。
- en: '**Back Doors and Security Holes**'
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**后门和安全漏洞**'
- en: A class of back door attacks on the Xbox leverage a fundamental weakness in
    the way the hardware is initialized by the secret boot code. This weakness stems
    from the fact that hardware initialization is accomplished by way of a powerful
    jam table opcode interpreter that stores its commands in unverified cleartext.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 一类针对 Xbox 的后门攻击利用了秘密启动代码初始化硬件的基本弱点。这种弱点源于硬件初始化是通过一个强大的干扰表指令解释器完成的，该解释器以未经验证的明文形式存储其命令。
- en: '**Visor Jam Table Attacks**'
  id: totrans-16
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**Visor 干扰表攻击**'
- en: One class of attacks on the Xbox involves modifying the hardware initialization
    sequence. Recall that hardware initialization of the Xbox is accomplished by means
    of an opcode interpreter that retrieves its commands from an unencrypted portion
    of the FLASH ROM called the “jam table.” The relationship of the jam table entries
    to the rest of FLASH ROM is illustrated in Figure 9-1\. Jam table entries are
    stored as <opcode, arg1, arg2> tuples near the lowest FLASH ROM addresses. The
    available opcodes include memory read and write functions to all the address spaces
    in the x86 architecture. Since the jam tables are stored unencrypted and never
    checked for modification, opcodes can be inserted into the jam table that can
    “seed” the Xbox memory with rogue instructions or modified hardware state *before*
    the RC-4 decryption of the FLASH ROM 2BL.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 对 Xbox 的一种攻击涉及修改硬件初始化序列。回想一下，Xbox 的硬件初始化是通过一个指令解释器完成的，该解释器从未加密的 FLASH ROM 的一部分（称为“干扰表”）检索其命令。干扰表条目与
    FLASH ROM 其余部分的关系如图 9-1 所示。干扰表条目以 <opcode, arg1, arg2> 元组的形式存储在最低 FLASH ROM 地址附近。可用的指令包括对
    x86 架构中所有地址空间的内存读和写函数。由于干扰表以未加密的形式存储，并且从未检查过修改，因此可以在干扰表中插入指令，这些指令可以在 FLASH ROM
    2BL 的 RC-4 解密之前“播种” Xbox 内存中的恶意指令或修改后的硬件状态。
- en: 'One application of jam table modification is to recover the plaintext of the
    kernel without knowledge of the RC-4 key. A hacker, known only as Visor, first
    described this approach to me. Here is a summary of Visor’s approach:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 干扰表修改的一个应用是恢复内核的明文，而不需要知道 RC-4 密钥。一位名叫 Visor 的黑客首先向我描述了这种方法。以下是 Visor 方法的总结：
- en: Boot the Xbox normally. Part of the normal boot process will place a decrypted
    kernel image into main memory.
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 正常启动 Xbox。正常启动过程中的一部分会将解密后的内核映像放入主内存。
- en: While maintaining power to the Xbox, switch the contents of the FLASH ROM’s
    jam table to an alternate table that copies regions of main memory to an easily
    monitored location, such as the FLASH ROM’s bus.
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在保持 Xbox 电源供电的情况下，将 FLASH ROM 的干扰表内容切换到另一个表，该表将主内存的区域复制到易于监控的位置，例如 FLASH ROM
    的总线。
- en: Perform a soft-reset of the Xbox CPU. This forces a hardware re-initialization
    without erasing the main memory.
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对Xbox CPU执行软重置。这会强制硬件重新初始化，但不会擦除主内存。
- en: Record the contents of main memory as the modified jam table program is executed.
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在修改后的jam表程序执行时记录主内存的内容。
- en: '![figure_9-1](../Images/figure_9-1.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![figure_9-1](../Images/figure_9-1.png)'
- en: '**Figure 9-1**: Jam table opcodes in relation to the rest of FLASH ROM.'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '**图9-1**：与FLASH ROM其余部分的jam表操作码。'
- en: Dynamic switchover of the FLASH ROM contents, required in step 2, can be accomplished
    by means of a ROM emulator, or by using an oversized ROM with the excess address
    bits wired to a bank of switches.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 在步骤2中，动态切换FLASH ROM内容可以通过ROM模拟器或使用带有额外地址位连接到开关组的超大规模ROM来完成。
- en: Visor also described how the jam table can be used as part of an elaborate hack
    to gain control over the Xbox’s instruction pointer (IP). To better understand
    this hack, we will further investigate how the secret boot code handles the case
    of an invalid FLASH ROM image.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: Visor还描述了如何将jam表用作复杂破解的一部分，以控制Xbox的指令指针（IP）。为了更好地理解这个破解，我们将进一步调查秘密引导代码如何处理无效FLASH
    ROM镜像的情况。
- en: After decrypting the 2BL in the FLASH ROM image, the secret boot code checks
    for a magic number at a location near the end of the 2BL. For an invalid FLASH
    ROM image, this number does not match, and causes the CPU to jump to a short sequence
    of instructions located at 0xFFFF.FFFA. This set of instructions continues all
    the way to the very last addressable location in physical memory, location 0xFFFF.FFFF.
    Once the CPU executes this last instruction of the invalid ROM image, it should
    crash and halt execution due to a code segment boundary error when the IP rolls
    over from 0xFFFF.FFFF to 0x0000.0000\. However, this does not happen; rather,
    the CPU happily attempts to execute whatever instruction, valid or invalid, is
    located at location 0x0000.0000\. Nominally, this instruction is invalid and the
    CPU halts anyway due to an instruction fault. However, a valid instruction can
    be placed there during the Xbox jam table initialization sequence using a jam
    table memory write opcode. Thus, by corrupting or erasing the encrypted FLASH
    ROM image and by modifying the jam tables to insert a jump instruction to your
    own unencrypted code in FLASH ROM, you can gain control of the Xbox CPU IP without
    ever touching a cipher or any similar technological measure that effectively controls
    access to a copyrighted work. Hence, this hack might be legal under the DMCA.
    I say *might* because the DMCA is an oftentimes vague piece of legislation, and
    there is little court precedent to clarify the ambiguities. The argument for the
    legality of this approach lies in the fact that no significant Microsoft copyrighted
    code is ever decrypted or executed. The only exception is the portion of the secret
    boot ROM that must execute because they are hardwired into the Southbridge’s silicon.
    See Chapter 12, “Caveat Hacker,” for a more in-depth discussion of the legal issues
    that are facing the hacking community today.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在解密FLASH ROM镜像中的2BL之后，秘密引导代码会在2BL末尾附近的位置检查一个魔数。对于无效的FLASH ROM镜像，这个数字不匹配，会导致CPU跳转到位于0xFFFF.FFFA的短指令序列。这组指令一直持续到物理内存中的最后一个可寻址位置，即位置0xFFFF.FFFF。一旦CPU执行了无效ROM镜像的最后一个指令，它应该因为代码段边界错误而崩溃并停止执行，当IP从0xFFFF.FFFF翻转到0x0000.0000时。然而，这并没有发生；相反，CPU愉快地尝试执行位于位置0x0000.0000的任何指令，无论有效还是无效。理论上，这个指令是无效的，CPU仍然会因为指令故障而停止。然而，可以在Xbox
    jam表初始化序列中使用jam表内存写入操作码将有效指令放置在那里。因此，通过破坏或擦除加密的FLASH ROM镜像，并修改jam表以插入跳转到您自己的未加密FLASH
    ROM代码中的跳转指令，您可以在不接触任何加密或类似技术措施的情况下控制Xbox CPU的IP。因此，这种破解可能符合DMCA的规定。我说“可能”，因为DMCA是一部经常含糊不清的法律，而且很少有法院先例来澄清这些含糊之处。这种方法的合法性论据在于，从未解密或执行过任何重要的微软版权代码。唯一的例外是必须执行的秘密引导ROM的部分，因为它们是硬连接到南桥的硅芯片上的。参见第12章“警告黑客”，以更深入地讨论当今黑客社区面临的合法问题。
- en: '**MIST Premature Unmap Attack¹**'
  id: totrans-28
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**MIST提前取消映射攻击¹**'
- en: In order to protect the secret boot code in the event that a hacker gains control
    of the Xbox, the secret boot code in the Southbridge chip unmaps itself shortly
    before it exits. In other words, it hides itself permanently from the system when
    it is finished executing. Thus, a user program attempting to access any of the
    top 512 bytes in memory will see the decoy block in FLASH memory instead of the
    secret boot code. Michael Steil, the lead of the Xbox-Linux project, discovered
    a way to leverage this feature.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 为了防止黑客控制Xbox时泄露秘密引导代码，南桥芯片中的秘密引导代码在退出前会自行解映射。换句话说，它在执行完毕后永久隐藏自己。因此，尝试访问内存中任何顶部512个字节的用户程序将看到FLASH内存中的诱饵块而不是秘密引导代码。Xbox-Linux项目的负责人迈克尔·斯蒂尔发现了一种利用这一功能的方法。
- en: The unmapping process is accomplished by writing to 0x8000.8008, a hardware
    register in the PCI configuration space. The basic strategy is to include a jam
    table opcode that writes to 0x8000.8008 and unmaps the secret boot code before
    the initialization sequence is finished. Since the caches are off at this time,
    the processor will start fetching and executing instructions from the decoy block.
    Fortunately, since the decoy block can be freely modified since it is part of
    the FLASH ROM. The catch, however, is that the jam table interpreter blocks writes
    to location 0x8000.8008, so this shouldn’t work. However, a bug in the decoding
    of the PCI configuration space in the Southbridge chipset makes the unmap instruction
    respond to multiple aliased addresses. In particular, the “function” bitfield
    is ignored. Thus, a write to 0x8000.8X08 where X is not equal to 0 also does the
    trick, and these writes are *not* blocked by the jam table interpreter. Therefore,
    to gain control of the CPU IP using the MIST hack, you must modify the decoy block
    in FLASH to contain your code, then add the appropriate jam table opcode to unmap
    the secret boot ROM during hardware initialization.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 解映射过程是通过写入0x8000.8008完成的，这是PCI配置空间中的一个硬件寄存器。基本策略是包含一个写入0x8000.8008并解映射秘密引导代码的干扰表操作码，在初始化序列完成之前。由于此时缓存已关闭，处理器将开始从诱饵块中获取和执行指令。幸运的是，由于诱饵块是FLASH
    ROM的一部分，因此可以自由修改。然而，干扰表解释器阻止了对位置0x8000.8008的写入，所以这不应该起作用。然而，南桥芯片组中PCI配置空间解码中的一个错误使得解映射指令对多个别名地址做出响应。特别是，“功能”位字段被忽略。因此，写入0x8000.8X08（其中X不等于0）也有效，并且这些写入不会被干扰表解释器阻止。因此，要使用MIST黑客技术控制CPU
    IP，你必须修改FLASH中的诱饵块以包含你的代码，然后添加适当的干扰表操作码，在硬件初始化期间解映射秘密引导ROM。
- en: '**Microsoft Retaliates**'
  id: totrans-31
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**微软反击**'
- en: 'The discovery of security holes prompted many to speculate that Microsoft would
    be swift to rotate its security scheme. In August 2002, Xboxes with a new motherboard
    quietly started to appear in Australia. The first official word of the new security
    system came from an unlikely source: nVidia, the producer of the chipsets used
    in the Xbox. Following an unspectacular second quarter in 2002, an nVidia spokesperson
    cited this as the last of a few reasons why the quarter went poorly:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 安全漏洞的发现促使许多人猜测微软会迅速更换其安全方案。2002年8月，配备了新主板的Xbox在澳大利亚悄然出现。关于新安全系统的第一条官方消息来自一个不太可能的消息来源：Xbox所使用的芯片组的生产商nVidia。在2002年第二季度表现平平之后，nVidia的一位发言人将此作为季度表现不佳的几个原因之一：
- en: “What we said about Xbox was that we reached a volume discount milestone, further
    reducing the margins. And that we will be taking an inventory write off in Q2
    related to the amount of Xbox MCPs that were made obsolete when MSFT transitioned
    to a new security code (by way of the MIT hacker) and excess in nForce chipsets
    that we built in anticipation of higher demand of Athlon-based PCs.” — Derek Perez,
    PR Director, nVidia ²
  id: totrans-33
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: “我们关于Xbox的说法是，我们已经达到了批量折扣的里程碑，进一步降低了利润率。并且我们将在第二季度进行库存减记，这与MSFT过渡到新的安全代码（通过MIT黑客）时变得过时的Xbox
    MCP数量以及我们为满足基于Athlon的PC更高需求而构建的nForce芯片组过剩有关。” —— 德雷克·佩雷斯，nVidia公关总监²
- en: '**Reverse Engineering v1.1 Security³**'
  id: totrans-34
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**逆向工程v1.1安全³**'
- en: 'The specifics of the security code changes were not revealed until October
    2002, when a hacker named Andy Green began investigating the first version 1.1
    Xboxes available in the United Kingdom. The outward physical differences between
    Xbox version 1.1 and 1.0 on the motherboard were subtle: the GPU traded its fan
    for a larger heat sink, the USB daughtercard was merged into the motherboard,
    and a PLL clock synthesizer chip was missing. Also missing were filter capacitors
    here and there, but nothing significant seemed to have changed. Further probing
    revealed that the hole leveraged by the MIST attack was patched, but the jam table
    opcodes were unchanged. The LPC bus, a key vector for gaining access to the Xbox,
    was also present and unchanged.'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 安全代码变更的具体细节直到2002年10月才被揭露，当时一名叫Andy Green的黑客开始调查在英国可用的第一版1.1 Xbox。Xbox 1.1和1.0版本在主板上的外观物理差异细微：GPU将其风扇换成了更大的散热片，USB子卡被合并到主板上，并且缺少了一个PLL时钟合成芯片。此外，还缺少了这里的滤波电容器，但似乎没有发生任何重大的变化。进一步的探测发现，MIST攻击所利用的漏洞已被修补，但中断表操作码没有改变。LPC总线，获取Xbox访问权限的关键向量，也存在且没有改变。
- en: Andy was able to extract the MCPX ROM in one day using a procedure thought up
    by a fellow hacker named Asterisk. The procedure leveraged an undisclosed combination
    of previously identified security holes and back doors. The initial analysis of
    the ROM contents revealed that the security was implemented in a radically different
    fashion. A cursory overview of the version 1.1 Xbox revealed that the old security
    through obscurity scheme was tossed out, and replaced with a scheme that nominally
    gets its security from the strength of public-key ciphers.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: Andy使用一名名叫Asterisk的同行黑客想出的程序，在一天内提取了MCPX ROM。该程序利用了之前已识别的安全漏洞和后门的未公开组合。对ROM内容的初步分析显示，安全措施是以一种截然不同的方式实施的。对版本1.1
    Xbox的初步概述表明，旧的通过隐蔽实现的安全方案已被抛弃，取而代之的是一种名义上从公钥密码的强度中获得安全性的方案。
- en: '![figure_9-2](../Images/figure_9-2.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![figure_9-2](../Images/figure_9-2.png)'
- en: '**Figure 9-2:** Xbox Security Version 1.1\. Regions that cannot be changed
    without replacing the MCPX silicon are shaded gray.'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '**图9-2：Xbox安全版本1.1。不能不更换MCPX硅片而更改的区域被阴影灰色覆盖**。'
- en: Microsoft’s implementation of the new security scheme was a bit counter-intuitive,
    though. Because the secret boot ROM within the MCPX remained the same size, 512
    bytes, they could not fit the full public-key digital signature algorithm within
    the secret boot ROM. Instead, they chose to use a lightweight hash in the secret
    boot ROM to verify a region of FLASH ROM dubbed the Flash Boot Loader (FBL). The
    FBL contains the code (RSA cipher, SHA-1 hash, Microsoft’s public key, and the
    driver program) for digital signature verification of the FLASH ROM. The FBL is
    executed only if the FBL’s hash can be verified against a constant stored within
    the secret boot ROM. Thus, the FBL is in theory as immutable as the secret boot
    ROM, even though it is stored in the mutable FLASH ROM.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 微软对新的安全方案的实施有点反直觉。因为MCPX内部的秘密引导ROM大小保持不变，为512字节，所以他们无法在秘密引导ROM中容纳完整的公钥数字签名算法。相反，他们选择在秘密引导ROM中使用轻量级的散列值来验证一个被称为Flash
    Boot Loader（FBL）的FLASH ROM区域。FBL包含用于数字签名验证FLASH ROM的代码（RSA密码、SHA-1散列、微软的公钥和驱动程序）。只有当FBL的散列值可以与存储在秘密引导ROM中的常数进行验证时，FBL才会执行。因此，从理论上讲，FBL与秘密引导ROM一样不可变，尽管它存储在可变的FLASH
    ROM中。
- en: Although this scheme sounded fairly bulletproof, the hacking community did not
    give up so easily. They examined the secret boot ROM’s hash in detail and discovered
    that it is based on TEA, a Tiny Encryption Algorithm by David Wheeler and Roger
    Needham at the Computer Laboratory of Cambridge University. Franz Lehner, a collaborator
    in the effort, sent a query to the newsgroup sci.crypt regarding weaknesses in
    the TEA hash.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管这个方案听起来相当坚不可摧，但黑客社区并没有轻易放弃。他们详细检查了秘密引导ROM的散列值，并发现它基于David Wheeler和Roger Needham在剑桥大学计算机实验室开发的Tiny
    Encryption Algorithm（TEA）。努力中的合作者Franz Lehner向新闻组sci.crypt发送了一个关于TEA散列弱点的查询。
- en: 'On Friday afternoon, October 11th, their query was answered. A paper written
    by John Kelsey, Bruce Schneier, and David Wagner, presented in CRYPTO 1996 pointed
    out that the TEA cipher has a weakness in its key scheduler where every key has
    three related keys that can be generated by inverting certain pairs of bits (this
    weakness, along with the TEA cipher, is discussed in more detail in Chapter 7).
    On Saturday, Andy Green posted this to XboxHacker.net:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 在10月11日星期五下午，他们的查询得到了回答。John Kelsey、Bruce Schneier和David Wagner在CRYPTO 1996上发表的一篇论文指出，TEA加密算法在其密钥调度器中存在弱点，每个密钥都有三个相关密钥，可以通过反转某些比特对来生成（这个弱点以及TEA加密算法在第七章中进行了更详细的讨论）。在周六，Andy
    Green将此信息发布到了XboxHacker.net：
- en: '[PRE0]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: In other words, the related-key weakness of the TEA cipher means that every
    adjacent pair of double words in the FBL can be modified by one bit, the most
    significant bit, without any change to the resulting hash. This weakness gave
    Andy and his team enough breathing room to modify the target of a single jump
    instruction to point to a location in main memory.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 换句话说，TEA加密算法的相关键弱点意味着FBL中每对相邻的双字都可以通过改变一个比特，即最重要的比特，来修改，而不影响生成的哈希值。这种弱点给了Andy和他的团队足够的空间来修改单个跳转指令的目标，使其指向主内存中的某个位置。
- en: '**Profile: Andy Green**'
  id: totrans-44
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**个人简介：Andy Green**'
- en: '**Can you tell us a little bit more about yourself, and how you got into hacking?**'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '**你能告诉我们更多关于你自己的信息，以及你是如何开始黑客生涯的吗？**'
- en: I am 37, living in England, near Kettering in the East Midlands, with my wife,
    our four children and two cats.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 我现在37岁，住在英格兰，东米德兰地区的凯特林附近，和我的妻子、我们的四个孩子和两只猫一起生活。
- en: 'I have been interested in computers from the age of 12 or so, when my brother
    bought a Commodore Pet. This 1MHz 6502 kept me occupied for months and months
    trying to write first BASIC code typed in from magazines, then games for it; eventually
    I wrote a fantastic character-cell Space Invaders thing in machine code. Machine
    code is where you are actually programming the CPU directly in hex; I still remember
    the common 6502 opcodes in hex now. This was such a dificult effort that I decided
    my next project would be an assembler written in machine code. 1978 was before
    the days of the Internet: I couldn''t afford the commercial assemblers because
    I was just a kid and there weren''t any people around us that I knew to warez
    a copy from.'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 我从大约12岁开始对计算机产生兴趣，那时我的哥哥买了一台Commodore Pet。这台1MHz的6502让我忙了好几个月，试图从杂志上输入BASIC代码，然后为它编写游戏；最终我用机器码编写了一个非常棒的字符单元格太空侵略者游戏。机器码就是你在直接用十六进制编程CPU；我现在还能记得常见的6502操作码的十六进制表示。这是一项如此困难的努力，以至于我决定我的下一个项目将是一个用机器码编写的汇编器。1978年是在互联网出现之前：我买不起商业汇编器，因为我只是个孩子，我们周围也没有人知道从哪里盗版一个副本。
- en: This was fairly pathetic as assemblers go, but it worked fine. I learned from
    this the value of having the right tools, I could write far faster in Assembler,
    and whole kinds of errors miscomputing relative branches by hand, for example)
    went completely away. Next I had a BBC Model B computer, and again I was interested
    to make tools and games. I was offered a scholarship at a public school, but turned
    it down and instead left school at 16 with no further education. I was quite content
    to teach myself anything that interested me.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 这在汇编器中相当可怜，但它确实工作得很好。我从中学到了正确工具的价值，我可以用汇编器写得更快，而且整个种类的错误，比如手动计算相对分支的错误，都完全消失了。接下来我有了BBC
    Model B电脑，我又对制作工具和游戏产生了兴趣。我得到了一所公立学校的奖学金，但我拒绝了，并在16岁时辍学，没有接受进一步的教育。我对自学任何感兴趣的东西感到非常满足。
- en: I sold a few games for this and another 6502 platform called the Oric, and with
    that money started up a company making Assemblers and other development tools.
    On the way I learned C and C++, and each time I stepped up whole rafts of bugs
    and timewasting miseries disappeared.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 我为这个和另一个名为Oric的6502平台出售了一些游戏，并用那些钱成立了一家制作汇编器和其它开发工具的公司。在这个过程中，我学习了C和C++，每次我都能解决一大堆的bug和浪费时间的问题。
- en: Its like that picture on the “Ascent of Man,” from Nethanderal relative branch
    computation through to Homo Erectus with his virtual functions.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 这就像“人类简史”中的那张图片，从Nethanderal的相对分支计算到直立人及其虚拟函数。
- en: 'Alongside this I began to explore digital hardware design, again teaching myself
    from experience. I discovered that hardware and software are two sides of the
    same coin, although they are treated completely separately in education. It’s
    really an implementation detail whether you choose to make your logical function
    in software or in hardware, or some mixture of the two. Having a foot in both
    camps gives greater insight into the nature of design: for example, C++ can be
    said to borrow many concepts from electronics in terms of the importance of interfaces.'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 在此同时，我开始探索数字硬件设计，再次通过经验自学。我发现硬件和软件是同一枚硬币的两面，尽管在教育中它们被完全分开对待。你选择在软件中还是硬件中实现你的逻辑功能，或者两者的混合，这实际上是一个实现细节。在两个领域都有立足点，能更深入地了解设计的本质：例如，可以说C++在接口的重要性方面借鉴了许多电子学的概念。
- en: Recently before becoming interested in the Xbox I had been working for a US-owned
    company with an office in Oxford, doing many jobs but the last one was designing
    smartcard silicon. Although the design was interesting and there were some great
    people working in the trenches there, I became increasingly despondent about the
    politics and problems with the management. Nor did it help that despite being
    spread across several projects, I was paid 2/3rds the salary of staff in San Jose
    simply because I was based in the UK. And don't get me started about the patents
    they had from me with no reward. In December 2001 I discovered that integrity
    was more important than money, resigned, and decided to go back to working for
    myself.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 在对Xbox产生兴趣之前，我曾在一家美国公司工作，该公司在牛津设有办公室，做过很多工作，但最后一个是设计智能卡硅片。尽管设计很有趣，那里也有一些出色的人在工作，但我对政治和管理问题越来越感到沮丧。而且，尽管我参与了几个项目，但由于我基于英国，我的薪水只有圣何塞员工的2/3。更别提他们从我这里获得的专利，而我却没有任何回报。2001年12月，我发现诚信比金钱更重要，于是辞职，决定重新开始自己工作。
- en: I had been rather tenderized by some unpleasant experiences on leaving this
    company, while digesting these I found myself snagged by the vast difference in
    outlook between the ugly, grabbing, controlling instincts of your average company
    involved in Intellectual Property, and the nature of GPL projects and the people
    involved in encouraging a reduction in the severity of patent and copyright laws.
    As time went on I increasingly came to see Microsoft, and the previous company
    I was working for in the same light.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 离开这家公司时，我经历了一些不愉快的经历，这使得我感到有些脆弱。在消化这些经历的过程中，我发现自己在丑陋、贪婪、控制的本能与涉及知识产权的普通公司的观点之间，以及GPL项目的性质和参与鼓励减少专利和版权法严厉程度的人之间存在着巨大的差异。随着时间的推移，我越来越看到微软和我在前一家公司工作的公司是同样的光景。
- en: It was after this that I read about bunnie's hack on Slashdot. I read about
    bunnie's methods with some tart emotions. My main thoughts were that this was
    something that I could have done, since I have been using the FPGAs that bunnie
    used since 1989, admiration for the conciseness of the attack, and dismay with
    myself that I had not been doing something equally cool and interesting — and
    that matched with my philosophical predilictions — with my time. Instead I was
    sitting there reading Slashdot, drinking coffee, contributing nothing. (An aside,
    I think this is a fairly common experience for many Slashdot readers, to be a
    little jealous and challenged when they read about someone else's cool hacks.
    I think it explains the constant background noise there of jeering and questioning
    why someone would want to do such a thing.)
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 之后，我在Slashdot上读到了bunnie的破解文章。我带着一些尖锐的情感阅读了bunnie的方法。我主要的想法是，这本来是我可以做的事情，因为我从1989年开始就使用bunnie使用的FPGA，对攻击的简洁性表示钦佩，对自己没有做同样酷和有趣的事情——并且与我哲学上的偏好相匹配——感到沮丧。相反，我坐在那里阅读Slashdot，喝咖啡，没有做出任何贡献。（顺便说一句，我认为这是许多Slashdot读者的常见经历，当他们读到别人的酷破解时，会感到一丝嫉妒和挑战。我认为这解释了那里持续的背景噪音，嘲笑和质疑为什么有人会想这样做。）
- en: Over the next few weeks I gathered as much information as I could on the internals
    of the Xbox; Xboxhacker.net was crucial for this. It’s also where I met Michael
    Steil as the Xbox Linux project was starting. Pretty soon I was able to identify
    interesting projects that I could contribute to, for example the Milksop project.
    Again from this, with Surferdude's help, it became possible for me to put together
    the very first clean ROM which was able to boot and keep up the Xbox without being
    reset. This later became the basis of the crom 1MB Linux and cromwell, the Xbox
    Linux clean ROM. After the initial hacks and designs, I decided to work almost
    entirely towards the Xbox Linux goal.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的几周里，我尽可能地收集了有关Xbox内部的信息；Xboxhacker.net对这一点至关重要。这也是我遇到Michael Steil的地方，因为Xbox
    Linux项目刚开始。很快，我就能够确定我可以贡献的有趣项目，例如Milksop项目。再次通过这个，在Surferdude的帮助下，我能够组装出第一个能够启动并保持Xbox运行而不需要重置的干净ROM。这后来成为了crom
    1MB Linux和cromwell，Xbox Linux干净ROM的基础。在最初的破解和设计之后，我决定几乎完全致力于Xbox Linux的目标。
- en: '**Can you tell us why you hack the Xbox?**'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: '**你能告诉我们你为什么破解Xbox吗？**'
- en: Why? Everyone has different reasons, but for me it was my comprehension of Microsoft's
    outrageous antitrust behaviour — deny everything, appeal everything, delay everything,
    and in the meanwhile, create and dump (for they are sold at below cost) on the
    market millions of Microsoft-only PCs — the Xbox. Since our representatives here
    in Europe and the U.S. don't seem to care (perhaps, as was the case recently in
    the EU, because they plan to go work for Microsoft and take their silver pieces),
    it would be an honour to be part of pricking this evil plan of a bloated monopoly
    using the weapons of the GPL and Linux. I know that people shut their eyes and
    think of their share options, but it must be hard for decent people — and surely
    most of the people working there are this — to work for such a monster.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 为什么？每个人都有不同的理由，但对我来说，是我对微软无理取闹的反垄断行为的理解——否认一切，上诉一切，拖延一切，同时，在市场上创造和倾销（因为它们以低于成本的价格出售）数百万台仅适用于微软的PC——Xbox。由于我们这里的欧洲和美国代表似乎并不关心（也许，就像最近在欧盟发生的那样，因为他们计划去微软工作并拿走他们的银色股份），能够成为揭露这个庞大垄断的邪恶计划的一部分，使用GPL和Linux的武器，将是一种荣誉。我知道人们闭上眼睛，想着他们的股票期权，但这对正派的人来说——当然，那里的大部分人都是这样——为这样一个怪物工作肯定很难。
- en: I was lucky enough to get a couple of contracts through 2002 that allowed me
    to spend the latter part of the year working exclusively on getting the first
    Linux kernel up in crom and bringing Cromwell up so it was able to control the
    main peripherals of the box and boot Linux from HDD or CD. Since then my share
    of the Project A prize money (thanks to donor Michael Robertson) wil allow me
    to continue working full time, for the next few months at least.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 我很幸运，在2002年得到了几个合同，让我能够全年专注于将第一个Linux内核放入crom，并将Cromwell提升到能够控制盒子的主要外围设备，并从HDD或CD启动Linux。从那时起，我的Project
    A奖金份额（多亏了捐赠者Michael Robertson）将允许我继续全职工作，至少在接下来的几个月里。
- en: '**Do you have any advice you’d like to share?**'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '**你有什么建议想要分享吗？**'
- en: My final thought is to encourage people, especially young people, to listen
    to their brain when it comes to things that interest them. Don't be afraid to
    dig around and try to learn about things that snag your attention. That feeling
    you get when you wish you understood something, a kind of yearning, is your brain's
    way of telling you that it thinks the knowledge might be useful later. If you
    listen to it enough, you stand a good chance of knowing the right thing at the
    right time to make some small difference.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 我的最后想法是鼓励人们，尤其是年轻人，在遇到自己感兴趣的事情时，要听从自己的大脑。不要害怕去挖掘和尝试了解那些吸引你注意的事物。当你渴望理解某件事时，那种渴望，是你大脑告诉你，它认为这些知识将来可能有用。如果你足够听从它，你就有很大机会在正确的时间知道正确的事情，从而产生一些小的影响。
- en: That single location can be pre-loaded with a follow-up jump instruction back
    into any piece of user code using the previously discussed jam table codes. The
    Xbox hacking community had come together in a heroic effort and cracked Xbox security
    version 1.1 in three days. A separate effort, no less valiant, by Xecuter had
    also cracked the security in the same time frame.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 那个单一位置可以预先加载一个后续跳转指令，回到任何使用之前讨论的jam表代码的用户代码。Xbox破解社区团结起来，进行了英勇的努力，三天内破解了Xbox安全版本1.1。Xecuter的另一个同样英勇的努力也在相同的时间内破解了安全系统。
- en: 'The first moral of this story is that security is only as strong as its weakest
    link. While there is little doubt about the robustness of the RSA cipher and the
    SHA-1 hash for digital signature purposes, these were not the only elements of
    the security system. The TEA cipher used to extend the secure boot ROM’s trust
    sphere into the FLASH ROM had flaws that allowed hackers to walk around the strong
    digital signature algorithms. This leads us to our second moral: complexity breeds
    weaknesses. Complex systems are difficult to design, test, and analyze. The version
    1.1 security for the Xbox was probably implemented on a short fuse, so there was
    insufficient time to analyze the system for weaknesses. Either that, or Microsoft
    knew about the TEA weakness and designed this back door into the system to mitigate
    the risk of locking their FBL into silicon. It seems rather doubtful that Microsoft
    intentionally included this back door, since modifying the MCPX silicon is a very
    expensive proposition (although the expense ended up on nVidia’s books). On the
    other hand, complexity is hard to avoid. My advisor at MIT, Tom Knight, once told
    me, “There are two kinds of designs in this world: those that are useful, and
    those that you can formally prove to be correct.” To some extent, the only way
    to ensure the security of a real-world system is to make its details open (no
    security through obscurity!) and subject the system to analysis from all angles.
    In a way, a thorough analysis of Xbox security is being conducted at no expense
    to Microsoft, thanks to the hacker community.'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 这个故事的第一条道德准则是，安全性的强弱取决于其最薄弱的环节。虽然对于RSA密码和SHA-1散列在数字签名方面的鲁棒性几乎没有疑问，但这些并不是安全系统的唯一元素。用于扩展安全引导ROM信任域到FLASH
    ROM的TEA密码存在缺陷，这允许黑客绕过强大的数字签名算法。这引出了我们的第二条道德准则：复杂性滋生弱点。复杂的系统难以设计、测试和分析。Xbox的1.1版本安全可能是在时间紧迫的情况下实施的，因此没有足够的时间分析系统中的弱点。要么是这样，要么是微软知道TEA的弱点，并故意将这个后门设计进系统中以减轻将FBL锁定在硅中的风险。微软故意包含这个后门似乎相当可疑，因为修改MCPX硅片是一个非常昂贵的提议（尽管最终费用落在了英伟达的账上）。另一方面，复杂性难以避免。我在麻省理工学院的导师汤姆·奈特曾告诉我：“在这个世界上有两种设计：那些有用的，以及那些你可以形式化证明是正确的。”在某种程度上，确保现实世界系统安全性的唯一方法就是使其细节公开（不要通过神秘来保证安全！）并从所有角度对系统进行分析。从某种意义上说，由于黑客社区的帮助，对Xbox安全性的彻底分析正在进行，而微软无需承担任何费用。
- en: Even if Microsoft had used a stronger hash function in the secret boot ROM,
    there are still a number of viable attacks on the Xbox that have yet to be tried.
    One can mount a man-in-the-middle attack on the HyperTransport bus (see Chapter
    8) by overdriving the signals with carefully timed pulses. This attack is fairly
    simple to implement, since each HyperTransport bus trace has a test point visible
    from the component side of the motherboard. A complete hardware solution would
    involve an FPGA on a board with “pogo pin” bed-of-nails style test connectors.
    This board can be impressed upon these test points without any solder. Another
    attack, suggested by Adi Shamir to me at the CHES conference, is to employ a timed
    glitch in the CPU clock or power supply to upset the calculation of a jump target
    address. This kind of attack has been applied with success to the processors in
    cryptographic smart cards. Again, this kind of attack can be implemented fairly
    easily and cheaply as a user-installable module. (Keep in mind that a much broader
    range of attacks is available to hackers if the goal is a onetime defeat of the
    security to recover, for example, a secret key or a block of critical code.)
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 即使微软在秘密引导ROM中使用了更强的散列函数，仍然有许多针对Xbox的有效攻击尚未尝试。可以通过对HyperTransport总线进行中间人攻击（见第8章），通过精心定时脉冲过载信号来实现。这种攻击的实现相当简单，因为每个HyperTransport总线轨迹都有从主板组件侧可见的测试点。一个完整的硬件解决方案将涉及一个带有“弹跳针”床钉式测试连接器的板上的FPGA。这个板可以压在这些测试点上而无需焊接。另一种攻击，由Adi
    Shamir在CHES会议上建议，是在CPU时钟或电源供应中引入定时故障，以干扰跳转目标地址的计算。这种攻击已经在加密智能卡的处理器上成功应用。同样，这种攻击可以相当容易且便宜地作为用户可安装的模块实现。（记住，如果目标是一次性破坏安全以恢复，例如，一个秘密密钥或一段关键代码，黑客有更广泛的攻击范围。）
- en: '**The Threat of Back Doors**'
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**后门威胁**'
- en: As this chapter has demonstrated, searching for back doors is a practical method
    for attacking cryptographically secured hardware. The relatively high success
    rate of finding back doors in the Xbox is partially because the Xbox represents
    the first significant attempt made by a vendor to cryptographically secure a PC.
    Despite the lessons learned from the Xbox experience, future secure PC implementations
    are still at risk of having hardware security weaknesses, since the legacy of
    the PC is an open and unsecured hardware architecture.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 正如本章所证明的，寻找后门是一种攻击加密保护硬件的实际方法。在Xbox中找到后门的高成功率部分是因为Xbox是第一个尝试对PC进行加密保护的重要尝试。尽管从Xbox的经验中吸取了教训，但未来的安全PC实现仍然面临硬件安全弱点的风险，因为PC的传统是一个开放且未受保护的硬件架构。
- en: '**Profile: Franz Lehner**'
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**个人简介：Franz Lehner**'
- en: Franz Lehner, 29, lives in Austria with his girlfriend. He studied Electrical
    Engineering for 5 years. Now, he programs “automated solutions” while running
    an ISP. In his spare time, he searches for projects that are fun and educational.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: Franz Lehner，29岁，住在奥地利，与他的女朋友一起生活。他学习了5年的电气工程。现在，他在运营ISP的同时编写“自动化解决方案”。在他的业余时间，他寻找有趣且具有教育意义的工程项目。
- en: After finding bunnie’s Xbox hacking document, he met the Xbox-Linux team on
    sourceforge.net. He joined the Xbox-Linux project to learn about team programming,
    Linux kernel hacking and debugging, and cryptographic systems. He also joined
    the Xbox-Linux project to develop a better understanding of related systems, such
    as Palladium.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 在找到bunnie的Xbox破解文档后，他在sourceforge.net上遇到了Xbox-Linux团队。他加入了Xbox-Linux项目，以学习团队编程、Linux内核破解和调试以及加密系统。他还加入了Xbox-Linux项目，以更好地理解相关系统，例如Palladium。
- en: PC hardware is complex yet fragile, and building a chain of trust out of it
    is difficult because of this brittleness. Fundamentally, each component in a PC
    is designed to be “trusting” of its physical environment. The specifications for
    any commercial integrated circuit component clearly state that the IC is guaranteed
    to operate over a bounded range of temperatures, voltages, frequencies, and other
    conditions. If these maximum ratings are violated, then the behavior of the device
    is “undefined,” and al bets are off. Most chip engineers do not even consider
    trying to make their circuits recover gracefully from an out-of-range condition,
    as it is already hard enough to get a chip to work under the specified operating
    conditions. Furthermore, most consumer applications are very cost-sensitive, and
    the overhead of building in robust fault tolerance measures results in a product
    that is not price-competitive.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: PC硬件复杂且脆弱，由于这种脆弱性，从其中构建信任链是困难的。从根本上讲，PC中的每个组件都是设计为对其物理环境“信任”的。任何商业集成电路组件的规格都明确指出，该IC保证在一定的温度、电压、频率和其他条件下运行。如果违反了这些最大额定值，则设备的行为将是“未定义的”，所有赌注都无效。大多数芯片工程师甚至不考虑尝试使他们的电路从超出范围的条件下优雅地恢复，因为这已经足够困难，要使芯片在指定的操作条件下工作。此外，大多数消费类应用对成本非常敏感，构建健壮的容错措施的开销导致产品不具备价格竞争力。
- en: Thus, chips are typically implemented with no internal error-checking. If, for
    some reason, the Arithmetic Logic Unit (ALU, the computational “brains” of a CPU)
    adds two numbers incorrectly, the problem will only manifest itself symptomatically;
    you can observe only the effects of such an error, sometimes long after the error-causing
    event. One can think of attacks that take advantage of faults induced by out-of-range
    conditions as the analogy of buffer overruns in the software world.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，芯片通常没有内部错误检查。如果由于某种原因，算术逻辑单元（ALU，CPU的计算“大脑”）错误地加上了两个数字，问题将只会以症状的形式表现出来；你只能观察到这种错误的效应，有时是在错误事件发生很长时间之后。人们可以将利用超出范围条件引起的故障的攻击视为软件世界中缓冲区溢出的类比。
- en: Another problem with the PC architecture is that the processor is too trusting
    of its code environment. The Pentium processor architecture has no provision in
    hardware for discriminating between code that is insecure or secure. If the instruction
    pointer happens to find its way into an insecure code segment through a bug or
    an induced failure, the processor will happily execute this code.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: PC架构的另一个问题是处理器对其代码环境过于信任。奔腾处理器架构在硬件上没有提供区分不安全或安全代码的机制。如果指令指针偶然通过一个错误或诱导的故障进入了一个不安全的代码段，处理器将愉快地执行这段代码。
- en: Note
  id: totrans-72
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '![](../Images/index-167_1.png)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/index-167_1.png)'
- en: '**Code compartmentalization based on hardware security** **levels is a different
    technique from sand-boxing. Sand****boxing does not provide an adequate solution
    for situa****tions where a user program requires direction from or in****teraction
    with secret or protected code or data. Lately,** **new processor architectures
    have been proposed that can** **solve this problem through the use of data tags
    that embed** **a sort of security audit log.⁵**'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '**基于硬件安全级别的代码隔离** **是一种不同于沙箱的技术。沙箱技术无法为需要从或与秘密或受保护代码或数据进行方向指引或交互的用户程序提供充分的解决方案。最近，**
    **一些新的处理器架构被提出，可以通过使用嵌入某种安全审计日志的数据标签来解决这一问题。⁵**'
- en: Another source of back doors are the design bugs that exist in every complex
    chip. It is common practice to ship chips with plenty of known bugs, also known
    as errata. For example, the Intel i860 XP processor (first released in 1991, not
    to be confused with the recently released i860 chipset for the Pentium4 processor)
    shipped with a book of errata that was comparable in size to the processor’s data
    sheet. Another example closer to home is the bug in the nVidia MCPX’s address
    space decoder that made the MIST Premature Unmap attack possible. Most of these
    errata have simple work-arounds or have minor implications for the functionality
    of the chip under nominal conditions. However, some errata, such as those dealing
    with cache coherence, address decoding, and memory management can result in major
    *software* security holes.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个后门来源是每个复杂芯片中存在的设计缺陷。将带有大量已知缺陷的芯片发货是一种常见做法，这些缺陷也被称为错误。例如，1991年首次发布的Intel i860
    XP处理器（不要与最近发布的用于Pentium4处理器的i860芯片组混淆）附带的错误列表与处理器数据表的大小相当。另一个更贴近的例子是nVidia MCPX地址空间解码器中的错误，这使得MIST提前取消映射攻击成为可能。大多数这些错误都有简单的解决方案，或者在正常条件下对芯片的功能影响很小。然而，一些错误，如涉及缓存一致性、地址解码和内存管理的错误，可能导致重大的*软件*安全漏洞。
- en: In the case of the Xbox, the business impact of a hardware back door is probably
    small. Perhaps Microsoft loses some small fraction of game sales revenue, but
    the losses due to piracy are dwarfed by the losses Microsoft takes on hardware
    sales. Also, the Xbox is just a game console — grandma’s bank account is not being
    tapped dry or credit card numbers stolen as a result of security weaknesses in
    the Xbox. However, more than game revenues will be at risk with the trusted PC.
    Unless the trusted PC architecture is a fundamental change from legacy PCs, people
    will be blindly trusting financial secrets and personal data security to untrustworthy
    hardware.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 在Xbox的情况下，硬件后门的商业影响可能很小。也许微软会损失一些游戏销售收入的微小部分，但与微软在硬件销售上的损失相比，盗版造成的损失微不足道。此外，Xbox只是一个游戏机——奶奶的银行账户并没有因为Xbox的安全漏洞而被耗尽，或者信用卡号码被盗。然而，对于受信任的PC来说，风险将不仅仅是游戏收入。除非受信任的PC架构与旧PC有根本性的改变，否则人们将盲目地将财务秘密和个人数据安全托付给不可信的硬件。
- en: Like most things in life, the first step is education. The more we learn about
    hardware security, even if it involves poking around a game console, the better
    our security systems will be tomorrow. Now, on with the lesson . . .
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 就像生活中的大多数事情一样，第一步是教育。我们了解的硬件安全越多，即使这涉及到在游戏机上摸索，我们的安全系统明天就会越好。现在，继续上课吧……
- en: '* * *'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: ¹ From Andy Green’s 19th Annual Chaos Communication Congress presentation on
    Xbox security hacking.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: ¹ 来自Andy Green在第19届混沌通信大会关于Xbox安全黑客攻击的演讲。
- en: ² From an article by the Inquirer, http://www.theinquirer.net/?article=4735
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: ² 来自《询问者》杂志的文章，http://www.theinquirer.net/?article=4735
- en: ³ From Andy Green’s 19th Annual Chaos Communication Congress presentation on
    Xbox security hacking.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: ³ 来自Andy Green在第19届混沌通信大会关于Xbox安全黑客攻击的演讲。
- en: ⁴ Posting from www.xboxhacker.net under the Xbox Hacker BBS- > Xbox Hacking
    (TECHNICAL) -> BIOS/Flash ROM/Firmware -> News from the Xbox Linux Team, MS ‘made
    a hash of it,’ guts exposed.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: ⁴ 来自www.xboxhacker.net的帖子，在Xbox Hacker BBS下的Xbox Hacking (TECHNICAL) -> BIOS/Flash
    ROM/Firmware -> Xbox Linux Team的新闻，MS“搞砸了”，内部结构暴露。
- en: ⁵ http://www.ai.mit.edu/projects/aries/Documents/Memos/ARIES-15.pdf. “A Minimal
    Trusted Computing Base for Dynamically Ensuring Secure Information Flow,” by Tom
    Knight and Jeremy Brown.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: ⁵ http://www.ai.mit.edu/projects/aries/Documents/Memos/ARIES-15.pdf. “通过动态确保安全信息流的最低可信计算基础，”由Tom
    Knight和Jeremy Brown撰写。
