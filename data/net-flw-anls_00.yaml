- en: INTRODUCTION
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**引言**'
- en: '![image with no caption](httpatomoreillycomsourcenostarchimages651574.png.jpg)'
  id: totrans-1
  prefs: []
  type: TYPE_IMG
  zh: '![无标题图片](httpatomoreillycomsourcenostarchimages651574.png.jpg)'
- en: 'Network administrators of all backgrounds share one underlying, overwhelming
    desire. It doesn''t matter if you manage a network with 400 separate manufacturing
    plants connected by a global MPLS mesh or if you''re responsible for three computers
    and an elderly printer. Network administrators all share an abiding and passionate
    desire for just one thing: We want our users to shut up.'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 所有背景的网络管理员都有一个共同的、压倒性的愿望。无论你管理的是一个通过全球MPLS网状连接的400个独立的制造工厂的网络，还是负责三台计算机和一台老式的打印机，网络管理员都共同拥有一个持久而强烈的愿望：我们希望我们的用户闭嘴。
- en: Blaming the network is easy. The network touches everything. Businesses assume
    that the network will work perfectly and make decisions accordingly. A user can't
    open that 900MB Excel spreadsheet on the file server on another continent from
    his 20th-century PC? Network problem. A website in Farawayistan is slow? Network
    problem. A user can't get a faster response over a 33.6Kbps modem? Network problem.
    In general, users don't care about trivialities such as the cost of bandwidth,
    the physical layout of transcontinental fiber, or the speed of light. They want
    the network to work the way they think it should.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 将问题归咎于网络很容易。网络无处不在。企业假设网络将完美运行，并据此做出决策。一个用户不能从他的20世纪PC打开另一个大陆上的文件服务器上的900MB
    Excel电子表格吗？网络问题。在遥远的Farawayistan的网站运行缓慢吗？网络问题。一个用户不能通过33.6Kbps的调制解调器获得更快的响应吗？网络问题。总的来说，用户不关心诸如带宽成本、跨大陆光纤的物理布局或光速这样的琐事。他们希望网络按他们想象的方式工作。
- en: This problem is exacerbated by the network's invisibility. Routers and switches
    are black boxes. You feed cables to the network, and it gives connectivity back.
    Traditionally, servers have much better activity logging and reporting than network
    devices. Sysadmins can write scripts to announce when a server process fails and
    try to remedy the situation, but very few network administrators have equipment
    that can monitor or repair itself. The usage information stored on a network device
    shows only the last few minutes at best. When a user reports an application failure,
    many systems administrators check their logs and report, "I have no problems.
    It must be the network." More sophisticated network administrators have traffic
    measurement tools such as MRTG, CiscoWorks, or OpenView, but these don't prove
    a network has no problems. They merely show whether the network has or lacks the
    particular set of problems that the software can report. The lack of media errors
    on a switch's uplink port says nothing about TCP/IP errors or firewall issues.
    With such minimal logging, blaming the network becomes very easy and hard to disprove.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 这个问题因网络的不可见性而加剧。路由器和交换机是黑盒子。你向网络提供电缆，它就提供连接。传统上，服务器在活动日志和报告方面比网络设备要好得多。系统管理员可以编写脚本，在服务器进程失败时发出通知并尝试解决问题，但很少网络管理员拥有可以自我监控或修复的设备。存储在网络设备上的使用信息最多只能显示最后几分钟。当用户报告应用程序失败时，许多系统管理员检查他们的日志并报告，“我没有问题。一定是网络的问题。”更复杂的网络管理员有如MRTG、CiscoWorks或OpenView等流量测量工具，但这些并不能证明网络没有问题。它们仅仅显示网络是否具有或缺乏软件可以报告的特定问题集。交换机上行链路端口上没有媒体错误，并不能说明TCP/IP错误或防火墙问题。在这样的最小化日志记录下，将问题归咎于网络变得非常容易，而且很难反驳。
- en: In addition, modern-day network administrators typically have no formal certification
    or training process. The days of needing a computer science degree to manage a
    network are long gone. What network administration certifications exist are frequently
    for systems administration. An "operating system vendor-certified" network administrator
    is actually certified in the services that the operating system offers to the
    network, not the network itself. When you study for a Microsoft DHCP Server certification,
    for example, you learn some things about networking but a whole lot more about
    that particular DHCP implementation. Network service management is a useful skill,
    mind you, but it's not the same as managing the lowest level of the network. Network
    administrators learn the hard way—and it's a very hard way indeed.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，现代网络管理员通常没有正式的认证或培训过程。需要计算机科学学位来管理网络的日子已经一去不复返了。现有的网络管理认证通常是为系统管理员准备的。一个“操作系统供应商认证”的网络管理员实际上是在认证操作系统提供给网络的各项服务，而不是网络本身。例如，当你为微软DHCP服务器认证学习时，你会学到一些关于网络的知识，但更多的是关于那个特定的DHCP实现。网络服务管理是一项有用的技能，但与网络底层管理并不相同。网络管理员只能通过艰难的方式学习——而且确实非常艰难。
- en: This is a shame, because network administrators can claim a powerful role in
    any organization. The network administrator can help resolve almost every technical
    issue. The network administrator can make himself an invaluable, indispensable,
    and irreplaceable component of the organization. A network administrator who masters
    the tools, understands the protocols, and restrains his natural contempt for the
    lesser minds surrounding him will not be fired until the company dissolves around
    him.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一件遗憾的事情，因为网络管理员可以在任何组织中扮演一个强大的角色。网络管理员可以帮助解决几乎每一个技术问题。网络管理员可以让自己成为组织中无价、不可或缺且不可替代的组成部分。一个掌握了工具、理解了协议并抑制了对周围人智力轻视的自然情感的网络管理员，除非公司在他周围解散，否则不会被解雇。
- en: Some network administrators understand this and are always ready to help. If
    a user or sysadmin reports an issue, this network admin is always ready to leap
    in with a packet analyzer or firewall log and offer insights. This is great customer
    service, *if* the user can replicate the problem at the time the network administrator
    is watching. Replicating problems consumes endless time and makes everyone involved
    testy.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 一些网络管理员理解这一点，并且总是乐于助人。如果一个用户或系统管理员报告了一个问题，这个网络管理员总是准备好跳进来，使用数据包分析器或防火墙日志并提供见解。这是出色的客户服务，*如果*用户能在网络管理员观察的时候复制出问题。复制问题会消耗无尽的时间，让所有相关人员都变得焦躁不安。
- en: What if you had a tool that could tell you specifically what happened on the
    network yesterday or last week or last year? Imagine being able to precisely identify
    the network impact of server and hardware changes. Suppose you could tell systems
    administrators exactly what bogus traffic their new server transmitted? Just for
    a moment, dream about being able to categorically and without risk of repudiation
    state, "That problem was not the network." Then think about doing all that by
    taking advantage of your existing equipment.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你有一个工具，可以具体告诉你昨天、上周或去年网络发生了什么？想象一下能够精确识别服务器和硬件变更对网络的影响。假设你能告诉系统管理员新服务器传输了哪些虚假流量？就让我们暂时梦想一下，能够明确且没有否认风险地声明，“那个问题不是网络问题。”然后想想，通过利用现有的设备来完成所有这些。
- en: Network flow analysis lets you do exactly that. Perhaps you won't completely
    silence your users—nothing short of divine intervention can manage that. But you
    can identify problems on your network before they happen. You can answer questions
    authoritatively, definitively, and decisively. People will no longer automatically
    blame the network. Your work will become less stressful because you will no longer
    *think* you know what happened. You'll *know*.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 网络流量分析让你能够做到这一点。也许你不会完全平息你的用户——没有神圣干预是无法做到的。但你可以在问题发生之前识别出你的网络上的问题。你可以权威、明确和果断地回答问题。人们将不再自动责怪网络。你的工作将变得不那么有压力，因为你将不再*认为*你知道发生了什么。你将*知道*。
- en: This book will take network administrators through building a flow-based network
    management system out of any free Unix-like operating system, freely available
    software, and existing network hardware.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 本书将引导网络管理员利用任何免费的类Unix操作系统、免费软件和现有的网络硬件构建一个基于流的网络管理系统。
- en: Network Administration and Network Management
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网络管理和网络管理
- en: What's the difference between a network administrator and a network manager?
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 网络管理员和网络经理之间有什么区别？
- en: '*Network administration* involves configuring hardware, phoning tech support,
    and running cables. *Network management* involves making decisions about the network.
    Network managers usually start off as network administrators and may still perform
    network administration duties, but their technical knowledge guides managerial
    decisions.'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '*网络管理* 包括配置硬件、联系技术支持和布线。*网络管理* 涉及对网络的决策。网络经理通常从网络管理员起步，并且可能仍然执行网络管理任务，但他们的技术知识指导管理决策。'
- en: Although changing your job title requires intervention from management, any
    network administrator can transform into a network manager by doing the work required.
    You're in charge of your equipment, and you can probably scrounge up access to
    some computing resources somewhere. The most difficult investment will be your
    time. Once you start providing fact-based answers and diagnoses, however, people
    will notice the change. Over time, company management will start involving you
    in decisions about the network or even seek your advice about business processes
    built on top of the network, making you the de facto network manager no matter
    what your business card says.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然改变你的职位名称需要管理层的干预，但任何网络管理员都可以通过完成所需的工作转变为网络经理。你负责你的设备，并且你可能在某个地方能够找到一些计算资源的访问权限。最困难的投入将是你的时间。然而，一旦你开始提供基于事实的回答和诊断，人们就会注意到这种变化。随着时间的推移，公司管理层将开始让你参与关于网络的决策，甚至可能寻求你关于建立在网络之上的业务流程的建议，无论你的名片上写着什么，你都将成为事实上的网络经理。
- en: Network Management Tools
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网络管理工具
- en: These are some pretty heady claims for a network management system, especially
    if you are familiar with existing network management tools. Many people are justifiably
    proud of their extensive network management systems. Let's take a look at some
    of the popular free network management tools and see how they fit together and
    how flow analysis can improve on them.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 对于一个网络管理系统来说，这些说法相当令人印象深刻，尤其是如果你熟悉现有的网络管理工具。许多人对自己广泛使用的网络管理系统感到自豪。让我们来看看一些流行的免费网络管理工具，看看它们是如何相互配合的，以及流量分析如何改进它们。
- en: MRTG, Cricket, and Cacti
  id: totrans-17
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: MRTG、Cricket 和 Cacti
- en: MRTG, Cricket, and Cacti use SNMP to generate graphs of network traffic across
    device interfaces and store the results in a fixed-size database. Knowing how
    much traffic crosses your network at any time is an absolute necessity, and I
    make heavy use of such tools myself. The fixed-size databases mean that you don't
    need to worry about database administration; they're easy to set up, and they
    quickly produce useful information.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: MRTG、Cricket 和 Cacti 使用 SNMP 在设备接口上生成网络流量的图表，并将结果存储在固定大小的数据库中。知道在任何时候有多少流量穿过你的网络是绝对必要的，我自己也大量使用这类工具。固定大小的数据库意味着你不需要担心数据库管理；它们易于设置，并能快速产生有用的信息。
- en: Knowing that your circuits are full explains why connectivity is slow, but the
    obvious next question is "full of what?" MRTG-style tools cannot answer that question.
    Flows can. Also, these tools normally use five-minute averages of traffic. They
    obscure brief spikes and valleys. Finally, these tools compress historical data
    into long-term averages. If you want to know the details of traffic six months
    ago, you must either extensively reconfigure these tools or use another tool.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 知道你的电路已满可以解释为什么连接速度慢，但接下来的明显问题是“满的是什么？”MRTG 风格的工具无法回答这个问题。流量可以。此外，这些工具通常使用五分钟的流量平均值。它们掩盖了短暂的峰值和低谷。最后，这些工具将历史数据压缩为长期平均值。如果你想了解六个月前的流量细节，你必须重新配置这些工具或使用另一个工具。
- en: RTG
  id: totrans-20
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: RTG
- en: Like the previous tools, RTG uses SNMP to measure network traffic crossing device
    interfaces and graphs the data. Unlike MRTG and its descendants, RTG measures
    much briefer intervals of traffic and stores each individual result in a database.
    It provides much more detailed visibility into traffic congestion. If you want
    to see how traffic has varied on a network interface throughout a single minute,
    RTG is your friend. You can also perform detailed comparisons with historical
    data.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 与之前的工具类似，RTG 使用 SNMP 来测量穿过设备接口的网络流量，并绘制数据图表。与 MRTG 及其衍生工具不同，RTG 测量更短的流量间隔，并将每个单独的结果存储在数据库中。它提供了对流量拥堵的更多详细可见性。如果你想查看网络接口在单分钟内的流量变化，RTG
    就是你的朋友。你还可以与历史数据进行详细比较。
- en: The presence of a database means that you must either know something about databases
    or have an infinite amount of disk space. Also, RTG can't show you the contents
    of the traffic, only how much there was. It resolves one problem with MRTG-style
    tools but not the others.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 数据库的存在意味着你必须对数据库有所了解，或者拥有无限的磁盘空间。此外，RTG 不能显示流量的内容，只能显示流量的数量。它解决了 MRTG 风格工具的一个问题，但不是其他问题。
- en: Nagios and Big Brother
  id: totrans-23
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Nagios 和 Big Brother
- en: If you step away from measuring the quantity of traffic, you also need to check
    the health of your network gear. Free software such as Nagios and Big Brother
    is very useful in this regard; you can get an alarm when a switch's redundant
    power supply fails, when a port starts spewing CRC errors, or when a switch reboots
    itself. You must have this information to maintain a reliable network.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你不再关注流量数量，你还需要检查你的网络设备的健康状况。Nagios 和 Big Brother 等免费软件在这方面非常有用；当交换机的冗余电源失败、端口开始产生
    CRC 错误或交换机自行重启时，你都可以得到警报。你必须有这些信息来维护一个可靠的网络。
- en: Knowing that your hardware is operating correctly is vital, but the fact that
    a switch is operating correctly doesn't mean that the traffic passing through
    it isn't having trouble. A functional switch or router will transmit undesirable
    traffic just as reliably as desirable traffic.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 知道你的硬件正在正常运行是至关重要的，但一个交换机运行正常并不意味着通过它的流量没有遇到麻烦。一个功能正常的交换机或路由器会像期望的流量一样可靠地传输不期望的流量。
- en: CiscoWorks, OpenView, and More
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CiscoWorks、OpenView 以及更多
- en: Then you have the commercial network management suites. Most of these products
    are either tool kits with pretty frontends or limited to simple networks. These
    tools are seductive. They look like anyone can use them. But these tools often
    want to control your entire computing infrastructure, from router to desktop,
    and attempts to deploy them in production usually fail.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 然后是你拥有的商业网络管理套件。这些产品中的大多数要么是带有漂亮界面的工具包，要么仅限于简单的网络。这些工具很有吸引力。它们看起来任何人都可以使用。但这些工具往往想要控制你的整个计算基础设施，从路由器到桌面，而在生产环境中部署它们通常都会失败。
- en: What most people don't realize is that by the time you've set up these software
    suites to work the way you need, you've done just as much work as you would through
    building your own flow analysis system. You have had the satisfaction of giving
    some other company money that rightfully belongs in your pocket, however. (It's
    the boss's money, you say? Get a price quote for the commercial stuff. During
    your performance review, tell your manager that you got the same results without
    spending that cash and you'd like a slice of it. It's more likely to work than
    asking for a raise after spending that money.)
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数人没有意识到的是，当你设置好这些软件套件以符合你的需求时，你所做的工作与构建自己的流量分析系统所做的工作一样多。然而，你确实有满足感，那就是把本应属于你口袋里的钱给了其他公司。
    （你说那是老板的钱？为商业产品获取报价。在绩效评估时，告诉你的经理你没有花那笔钱就得到了相同的结果，并希望分得一杯羹。这样做比花完钱后要求加薪更有可能成功。）
- en: 'Enough Griping: What''s the Solution?'
  id: totrans-29
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 足够抱怨了：解决方案是什么？
- en: 'Resolved: Network administration sucks. The tools are all inadequate, expensive,
    or both. How do you escape this pit? *You record the traffic that passes across
    your network*.'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：网络管理很糟糕。工具都不够好，或者又贵又不好。你如何摆脱这个困境？*你记录通过你的网络传输的流量*。
- en: Yes, this is a tall order. Fortunately, you don't have to record the entire
    contents of every network transaction. For a moment, think about the duties of
    a network administrator. Part of your responsibilities include providing network
    services, such as DNS and DHCP. You probably have to feed your proxy server every
    few days and dust the script kiddies out of the intrusion detection system each
    Monday morning. But set aside the services that run on the network for a moment,
    and consider the base network.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 是的，这是一个很高的要求。幸运的是，你不需要记录每个网络事务的全部内容。暂时想想网络管理员的职责。你的部分责任包括提供网络服务，如 DNS 和 DHCP。你可能每隔几天就要给你的代理服务器喂食，并在每周一早上清理入侵检测系统中的脚本小子。但暂时把运行在网络上的服务放在一边，考虑一下基础网络。
- en: The network exists to carry traffic from one host to another. That's it. The
    network administrator makes that happen.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 网络的存在就是为了将流量从一个主机传输到另一个主机。仅此而已。网络管理员负责实现这一点。
- en: Perhaps you're the only IT person at your company, and you are also responsible
    for everything else. Most of the time, however, network administrators work on
    a team with system administrators, a database administrator or two, a help desk,
    and other IT professionals. In this case, the network administrator's responsibility
    is to deliver packets in a timely manner. Successful delivery of those packets
    completes your responsibilities.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 也许您是公司唯一的IT人员，并且还负责其他所有事情。然而，大多数时候，网络管理员与系统管理员、一两个数据库管理员、帮助台和其他IT专业人员一起工作。在这种情况下，网络管理员的职责是及时交付数据包。这些数据包的成功交付完成了您的职责。
- en: Being able to prove that packets arrived at their destination and were accepted
    will completely change your relationship with your co-workers. All of a sudden,
    you have *proof*. The network is no longer something that indiscriminately accepts
    the blame whenever something goes askew. Some of the errors will be your responsibility,
    of course. But many won't, and there's nothing like the glorious feeling of conclusively
    demonstrating for the very first time that not only is a problem not yours, but
    you can rigorously demonstrate where the problem lies. (The trick here lies in
    not alienating those same co-workers with said proof, but I'll talk about that
    later.)
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 能够证明数据包已到达目的地并被接受将彻底改变您与同事的关系。突然之间，您有了*证据*。网络不再是每当出现问题就无差别地承担责任的实体。当然，其中一些错误将是您的责任。但许多错误不是，没有什么比第一次彻底证明问题不是您的，而且您可以严格证明问题所在的感觉更令人欣慰。（这里的技巧在于不要用这个证据疏远那些同事，但我稍后会谈到这一点。）
- en: You don't need a complete record of the contents of traffic to demonstrate your
    point. All you need is proof that successful network-level communication occurred
    between hosts. If a user cannot display a page on your internal web server, for
    example, you don't need a full record of the contents of the network connections
    between the user's desktop and the server. You only need a record that a network
    conversation occurred between the client and the server, that the network carried
    data between the two, and that the conversation concluded normally and without
    error at the network level. You don't need to record every individual image or
    chunk of text in that conversation. That's not the network administrator's responsibility.
    Proving that the network carried web traffic between the client and the server
    demonstrates that the network functioned correctly. Mind you, as the network administrator,
    you're still on the hook for helping solve the problem; it's just that nobody
    will be blaming you as you work.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 您不需要记录流量内容的完整记录来证明您的观点。您只需要证明主机之间成功发生了网络级通信。例如，如果用户无法显示您内部Web服务器上的页面，您不需要记录用户桌面和服务器之间网络连接内容的完整记录。您只需要记录客户端和服务器之间发生了网络对话，网络在两者之间传输了数据，并且网络层上对话正常且无错误地结束。您不需要记录对话中的每个单独的图像或文本块。这不是网络管理员的职责。证明网络在客户端和服务器之间传输了Web流量，证明了网络正常工作。请注意，作为网络管理员，您仍然有责任帮助解决问题；只是没有人会在您工作时责怪您。
- en: Flow-Tools and Its Prerequisites
  id: totrans-36
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Flow-Tools及其先决条件
- en: Flow-tools is the standard freely available flow management and analysis tool
    kit. Although you can find many other tools for flow management, flow-tools has
    been around for the longest time and is the most widely deployed free toolkit.
    Many people have written flow analysis interfaces based on flow-tools, and I'll
    cover several of them in this book.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: Flow-tools是标准可免费获得的流量管理和分析工具包。尽管您可以找到许多其他流量管理工具，但Flow-tools存在时间最长，并且是最广泛部署的免费工具包。许多人基于Flow-tools编写了流量分析接口，本书将介绍其中几个。
- en: Flow-tools is written for Unix-like systems such as Linux, OpenSolaris, various
    BSDs, commercial options such as AIX, and many others. My reference platform is
    FreeBSD, but everything in this book also works on Linux. You might have difficulties
    using more challenging or unique platforms. This book provides examples of the
    commands for the flow management tools, but you must know how to invoke superuser
    privilege, navigate the file system, and so on.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: Flow-tools是为Unix-like系统编写的，例如Linux、OpenSolaris、各种BSD、商业选项如AIX等，以及许多其他系统。我的参考平台是FreeBSD，但本书中的所有内容在Linux上也能正常工作。您可能会在使用更具挑战性或独特的平台时遇到困难。本书提供了流量管理工具的命令示例，但您必须知道如何调用超级用户权限、导航文件系统等。
- en: Much of this software uses Perl. You don't need to write your own Perl, but
    you'll need to edit Perl scripts to set variables such as your company name and
    your IP addresses. Some flow software includes specific Perl hooks, and I'll cover
    them for Perl aficionados.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 这部分软件大多使用Perl。你不需要编写自己的Perl，但你需要编辑Perl脚本来设置诸如公司名称和IP地址之类的变量。一些流量软件包括特定的Perl钩子，我将为Perl爱好者介绍它们。
- en: If you want to perform ad hoc reporting of flow data with flow-tools, you'll
    want a plotting program. I discuss `gnuplot`. You'll be most comfortable using
    `gnuplot` if you have an X server installed on your desktop, but that's not mandatory.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想要使用flow-tools执行流量数据的即兴报告，你需要一个绘图程序。我讨论了`gnuplot`。如果你在桌面上安装了X服务器，你将最舒适地使用`gnuplot`，但这不是强制性的。
- en: In addition, to use flow-tools, you must understand Unix epoch time. Epoch time
    is the number of seconds since 00:00:00 on January 1, 1970, in the UTC time zone.
    Any number of websites offer epoch-to-date converters. You can convert epoch seconds
    to a date on the command line with the `date` command, but the syntax varies among
    Unix-like operating systems.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，要使用flow-tools，你必须理解Unix纪元时间。纪元时间是自1970年1月1日00:00:00起，在UTC时区内的秒数。许多网站提供纪元到日期的转换器。你可以在命令行中使用`date`命令将纪元秒转换为日期，但语法在不同的类Unix操作系统中有所不同。
- en: Speaking of time, having good time on your network will enhance your network
    management capabilities. Therefore, I recommend installing and using Network Time
    Protocol. Use authoritative time sources for your network. If the timestamps in
    your server logs match the timestamps in your network traffic records, your analysis
    will be much easier.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 谈到时间，在你的网络中拥有良好的时间管理将增强你的网络管理能力。因此，我建议安装并使用网络时间协议。为你的网络使用权威的时间源。如果你的服务器日志中的时间戳与你的网络流量记录中的时间戳相匹配，你的分析将会容易得多。
- en: Flows can include Border Gateway Protocol (BGP) information. I discuss how to
    manage flow BGP data, but those explanations assume basic BGP knowledge. If you
    don't use BGP, your flow data will not contain any BGP data. You can safely skip
    discussions of BGP-based flow data.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 流量可以包括边界网关协议（BGP）信息。我讨论了如何管理流量BGP数据，但这些解释假设了基本的BGP知识。如果你不使用BGP，你的流量数据将不包含任何BGP数据。你可以安全地跳过基于BGP的流量数据的讨论。
- en: Finally, you must understand networking. If you don't have a strong grip on
    networking fundamentals now, however, you'll have one by the time you finish your
    flow management implementation.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，你必须理解网络。如果你现在对网络基础知识没有牢固的掌握，但在完成你的流量管理实现时，你将会有。
- en: Flows and This Book
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 流量和本书
- en: Before you can manage your network with flow information, you must understand
    how flows work, where the data comes from, how it is gathered and processed, and
    the strengths and limitations of flow-based management. [Chapter 1](ch01.html
    "Chapter 1. FLOW FUNDAMENTALS") introduces flows.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 在你能够使用流量信息管理网络之前，你必须理解流量是如何工作的，数据来自哪里，它是如何收集和处理的，以及基于流量的管理的优势和局限性。[第1章](ch01.html
    "第1章。流量基础")介绍了流量。
- en: Many routers and switches can perform *flow export*, where the hardware tracks
    flow data and transmits it to a management system. If your hardware cannot export
    flows, you can perform flow export in software. [Chapter 2](ch02.html "Chapter 2. COLLECTORS
    AND SENSORS") discusses flow export and how to configure it in both hardware and
    software, as well as how to collect those flow records from many different network
    devices using the industry-standard flow-tools software package.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 许多路由器和交换机可以执行*流量导出*，其中硬件跟踪流量数据并将其传输到管理系统。如果你的硬件不能导出流量，你可以在软件中执行流量导出。[第2章](ch02.html
    "第2章。收集器和传感器")讨论了流量导出以及如何在硬件和软件中配置它，以及如何使用行业标准流量工具软件包从许多不同的网络设备中收集那些流量记录。
- en: '[Chapter 3](ch03.html "Chapter 3. VIEWING FLOWS") teaches you how to view the
    flow records you''ve gathered. Flow records contain vast amounts of information,
    and choosing the proper viewing format will help you get the insight you need.'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: '[第3章](ch03.html "第3章。查看流量")教你如何查看你收集的流量记录。流量记录包含大量信息，选择合适的查看格式将帮助你获得所需的认识。'
- en: Flow records include all the traffic that passes over your network, but you'll
    often be interested only in very specific information, such as the traffic over
    a particular circuit or to a certain host. [Chapter 4](ch04.html "Chapter 4. FILTERING
    FLOWS") demonstrates filtering flows to display only interesting data.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 流量记录包括通过网络传输的所有流量，但你通常只对非常具体的信息感兴趣，例如特定电路或特定主机的流量。[第4章](ch04.html "第4章。过滤流量")演示了如何过滤流量以仅显示有趣的数据。
- en: At times you'll be interested in reporting on the aggregated flow data rather
    than individual flows. What hosts sent the most traffic? What are the most popular
    UDP ports on your network? Which hosts connect to the most other hosts? Flow-tools
    supports a wide variety of reports, which I'll cover in [Chapter 5](ch05.html
    "Chapter 5. REPORTING AND FOLLOW-UP ANALYSIS").
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 有时你可能更感兴趣于报告汇总的流量数据，而不是单个流量。哪些主机发送了最多的流量？你网络中最受欢迎的UDP端口是什么？哪些主机连接到最多的其他主机？Flow-tools支持广泛的报告，我将在[第5章](ch05.html
    "第5章。报告和后续分析")中介绍。
- en: Another common requirement is for simple visualization of network traffic; in
    other words, presenting the flow records in graphical format. [Chapter 6](ch06.html
    "Chapter 6. PERL, FLOWSCAN, AND CFLOW.PM") covers FlowScan, web-based software
    that offers traffic graphs to your users. It also covers the `Cflow.pm` Perl module
    used to write FlowScan so you can write your own flow analysis software if you're
    so inclined.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个常见的需求是简单可视化网络流量；换句话说，以图形格式展示流量记录。[第6章](ch06.html "第6章。Perl、FlowScan和CFLOW.PM")介绍了FlowScan，这是一款基于Web的软件，为用户提供流量图表。它还介绍了用于编写FlowScan的`Cflow.pm`
    Perl模块，如果你有兴趣，你可以用它来编写自己的流量分析软件。
- en: Although FlowScan works well for users, network administrators need something
    more powerful. [Chapter 7](ch07.html "Chapter 7. FLOWVIEWER") covers FlowViewer,
    another web-based tool that lets you deeply dissect your traffic.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然FlowScan对用户来说效果很好，但网络管理员需要更强大的工具。[第7章](ch07.html "第7章。FlowViewer")介绍了FlowViewer，这是一个基于Web的工具，允许你深入分析你的流量。
- en: Web-based software can handle many network visualization tasks, but automating
    visuals and graphing ad hoc data aren't among them. At times, you'll need to prepare
    graphs that show today's traffic compared to last week's or last year's. In [Chapter 8](ch08.html
    "Chapter 8. AD HOC FLOW VISUALIZATION"), you'll use `gnuplot` to create graphs
    of truly arbitrary flow data.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 基于Web的软件可以处理许多网络可视化任务，但自动化可视化和图形化临时数据并不在其中。有时，你需要准备图表来显示今天的流量与上周或去年相比的情况。在[第8章](ch08.html
    "第8章。临时流量可视化")中，你将使用`gnuplot`创建任意流量数据的图表。
- en: Finally, [Chapter 9](ch09.html "Chapter 9. EDGES AND ANALYSIS") discusses some
    flow collection edge cases and talks about how you can use flow records to proactively
    improve your network.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，[第9章](ch09.html "第9章。边缘和数据分析")讨论了一些流量收集的边缘情况，并讨论了如何使用流量记录主动改进你的网络。
- en: Before doing all the advanced stuff, however, let's take a deep, hard look at
    flows in [Chapter 1](ch01.html "Chapter 1. FLOW FUNDAMENTALS").
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，在进行所有高级操作之前，让我们先深入、仔细地看看[第1章](ch01.html "第1章。流量基础")中的流量。
