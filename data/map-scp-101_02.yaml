- en: Chapter 2. PLOTTING MARKERS AND MESSAGE BOXES
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第二章. 绘制标记和消息框
- en: '![image with no caption](httpatomoreillycomsourcenostarchimages671943.png.jpg)'
  id: totrans-1
  prefs: []
  type: TYPE_IMG
  zh: '![无标题图片](httpatomoreillycomsourcenostarchimages671943.png.jpg)'
- en: Creating simple maps is a cool and useful way to see the area around a location,
    but you'll find creating maps even more fun and useful when you plot your own
    points on a map. Using mapping APIs you can overlay small graphics to call attention
    to locations (determined by latitude and longitude coordinates). Optionally, you
    can create messages that describe a location when the marker is clicked.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 创建简单的地图是查看某个位置周围区域的一种酷炫且实用的方式，但您会发现，当您在地图上绘制自己的点时，创建地图会更加有趣和实用。使用地图API，您可以在地图上叠加小图形来引起对位置的注意（由纬度和经度坐标确定）。可选地，当点击标记时，您可以创建描述位置的文本消息。
- en: You've seen these principles in action on just about any chain store's website,
    among many others. If you're looking to shop in person, you've probably used the
    Find a Store link. From there, you enter your city, ZIP Code, address, or some
    other determination of your location. Then a map appears showing the closest stores,
    with each store's location marked, often with a number that matches a results
    list. If the number is clickable, you will likely find that store's address, telephone
    number, or other information.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 您几乎在任何连锁店的网站上都能看到这些原则的应用，以及其他许多地方。如果您打算亲自购物，您可能已经使用了“查找商店”链接。从那里，您输入您的城市、ZIP代码、地址或其他确定您位置的信息。然后出现一个地图，显示最近的商店，每个商店的位置都有标记，通常有一个与结果列表匹配的数字。如果数字是可点击的，您很可能会找到该商店的地址、电话号码或其他信息。
- en: This chapter will get you started creating tools like store locators. You will
    learn to add markers, create custom icons, show messages in hovering boxes, and
    more. Mapping providers implement similar, but slightly different ways, of plotting
    markers on your map. Mapstraction wrangles these differences into a single set
    of functions that can add markers and message boxes no matter the underlying map
    type.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将指导您开始创建类似商店定位器这样的工具。您将学习如何添加标记、创建自定义图标、在悬停框中显示消息等。地图提供商实现了类似但略有不同的方式，在您的地图上绘制标记。Mapstraction将这些差异整合成一组函数，无论底层地图类型如何，都可以添加标记和消息框。
- en: '#1: Add a Marker to Your Map'
  id: totrans-5
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '#1: 在您的地图上添加标记'
- en: The basic marker is a staple of web maps. Markers bring the user's attention
    to one or more points on the map. For many projects, you won't need to get any
    more complicated than a map and a handful of basic markers.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 基本标记是网络地图的必备元素。标记将用户的注意力吸引到地图上的一个或多个点上。对于许多项目来说，您可能不需要比地图和一些基本标记更复杂的元素。
- en: 'Although we''ll be using Mapstraction to produce our markered maps, the underlying
    work is being done by whichever mapping service we''re using. Just like the look
    of the map is determined by the provider, so will the default style of the basic
    marker. [Figure 2-1](ch02.html#default_markers_from_different_providers "Figure 2-1. Default
    markers from different providers: Google, Yahoo!, and Microsoft") shows the differences
    among the markers from major map services.'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然我们将使用Mapstraction来生成我们的标记地图，但底层工作是由我们使用的任何地图服务完成的。就像地图的外观由提供商决定一样，基本标记的默认样式也将由提供商决定。[图2-1](ch02.html#default_markers_from_different_providers
    "图2-1. 来自不同提供商的默认标记：Google、Yahoo! 和 Microsoft")显示了主要地图服务之间标记的差异。
- en: '![Default markers from different providers: Google, Yahoo!, and Microsoft](httpatomoreillycomsourcenostarchimages671967.png.jpg)'
  id: totrans-8
  prefs: []
  type: TYPE_IMG
  zh: '![来自不同提供商的默认标记：Google、Yahoo! 和 Microsoft](httpatomoreillycomsourcenostarchimages671967.png.jpg)'
- en: 'Figure 2-1. Default markers from different providers: Google, Yahoo!, and Microsoft'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 图2-1. 来自不同提供商的默认标记：Google、Yahoo! 和 Microsoft
- en: To add a simple marker to your map, you just need to use two Mapstraction functions.
    First, create the marker. Next, add it to the map. The reason for these two distinct
    steps will become clear in further projects when we start to use advanced options,
    such as custom marker icons.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 要在您的地图上添加一个简单的标记，您只需要使用两个Mapstraction函数。首先，创建标记。然后，将其添加到地图上。为什么需要这两个不同的步骤将在后续项目中变得清晰，当我们开始使用高级选项，如自定义标记图标时。
- en: 'Let''s see what creating the marker looks like in code. Start with the basic
    Mapstraction map you created in [Create a Mapstraction Map](ch01s03.html#create_a_mapstraction_map
    "Create a Mapstraction Map") in [Create a Mapstraction Map](ch01s03.html#create_a_mapstraction_map
    "Create a Mapstraction Map"), and add these lines to the `create_map()` function:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看在代码中创建标记的样子。从你在[创建Mapstraction地图](ch01s03.html#create_a_mapstraction_map
    "创建Mapstraction地图")中创建的基本Mapstraction地图开始，并在`create_map()`函数中添加以下行：
- en: '[PRE0]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: The first line creates a marker object, passing latitude/longitude coordinates
    for the No Starch Press offices in San Francisco. Remember this is the same point
    we used as the center of our map in [Chapter 1](ch01.html "Chapter 1. MAPPING
    BASICS"). By drawing attention to the graphical marker, we are essentially marking
    that spot as important.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 第一行创建了一个标记对象，传递了旧金山No Starch Press办公室的纬度/经度坐标。记住这是我们[第1章](ch01.html "第1章. 地图基础")中用作地图中心的同一个点。通过引起对图形标记的注意，我们实际上是在标记这个位置很重要。
- en: The second line is a placeholder for any marker options we want to add later.
    (Any JavaScript line that begins with two slashes is a comment, and the browser
    ignores them.) The marker options are where we tell Mapstraction which icon to
    use or add a message to be displayed when the marker is clicked.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 第二行是用于稍后添加的任何标记选项的占位符。（任何以两个斜杠开头的JavaScript行都是注释，浏览器会忽略它们。）标记选项是我们告诉Mapstraction使用哪个图标或添加在点击标记时显示的消息的地方。
- en: Finally, the third line adds the marker to the map. Once this happens, no additional
    options can be added. The reason is that the marker object is used only by Mapstraction.
    Once the marker is added to the map, however, Mapstraction makes the appropriate
    calls to the mapping provider. Mapstraction plots the marker based on all options
    set beforehand. In this case, we don't have options to add, but we'll add to this
    map in future projects.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，第三行将标记添加到地图上。一旦发生这种情况，就无法再添加其他选项。原因是标记对象仅由Mapstraction使用。然而，一旦标记被添加到地图上，Mapstraction就会调用映射提供者进行适当的调用。Mapstraction根据事先设置的所有选项绘制标记。在这种情况下，我们没有要添加的选项，但我们将在这个地图的后续项目中添加。
- en: If you're using Google as your mapping provider, your new map will look like
    [Figure 2-2](ch02.html#google_map_with_a_simple_marker "Figure 2-2. Google map
    with a simple marker"). The default Google icon sits in the center of the map.
    Although the marker is clickable, this marker is very simple and nothing actually
    happens if you click it. Read on to learn other cool things you can do with markers.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用Google作为你的映射提供者，你的新地图将看起来像[图2-2](ch02.html#google_map_with_a_simple_marker
    "图2-2. 带有简单标记的Google地图")。默认的Google图标位于地图中心。尽管标记是可点击的，但这个标记非常简单，如果你点击它实际上不会发生任何事情。继续阅读以了解你可以用标记做的其他酷事情。
- en: '![Google map with a simple marker](httpatomoreillycomsourcenostarchimages671969.png.jpg)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![带有简单标记的Google地图](httpatomoreillycomsourcenostarchimages671969.png.jpg)'
- en: Figure 2-2. Google map with a simple marker
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 图2-2. 带有简单标记的Google地图
- en: '#2: Remove or Hide a Marker'
  id: totrans-19
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '#2: 移除或隐藏标记'
- en: Once your map has markers, you may wish to remove them from the map selectively.
    You might replace the current markers with new results. Or maybe the user added
    a filter that does not include the current marker. Mapstraction provides three
    functions to make markers disappear and reappear. Though *removing* and *hiding*
    may sound like similar terms, understanding the differences between them is important.
    Removing a marker from a map means the marker is gone for good. Simply hiding
    the marker allows you to make it visible again.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你的地图上有标记，你可能希望选择性地从地图中移除它们。你可能想用新的结果替换当前的标记。或者，用户可能添加了一个不包括当前标记的过滤器。Mapstraction提供了三个函数来使标记消失和再次出现。尽管*移除*和*隐藏*听起来像相似术语，但理解它们之间的区别很重要。从地图中移除标记意味着标记永远消失了。简单地隐藏标记允许你再次使其可见。
- en: To use the functions to remove, hide, and show markers, you need access to Mapstraction
    and marker objects. These objects are generated when you create your new map and
    whenever you create a new marker. Whether they become available to the rest of
    your script, however, depends on the variable's scope.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用移除、隐藏和显示标记的函数，你需要访问Mapstraction和标记对象。这些对象在你创建新地图以及每次创建新标记时生成。然而，它们是否可供脚本的其他部分使用，则取决于变量的作用域。
- en: '*Scope* refers to the parts of code where a variable can be accessed. Any variable
    created inside the `create_map` function can only be used inside that function.
    To remove or hide markers, we need to make our Mapstraction and marker objects
    global. To do this, add this declaration right above the `create_map` function:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '*作用域*指的是可以访问变量的代码部分。在`create_map`函数内部创建的任何变量只能在该函数内部使用。为了删除或隐藏标记，我们需要使我们的Mapstraction和标记对象全局化。为此，在`create_map`函数上方添加此声明：'
- en: '[PRE1]'
  id: totrans-23
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'These two variables now have a global scope, meaning we can use the variables
    outside of the `create_map` function. To remove a marker, you call the `removeMarker`
    function on the Mapstraction object:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 这两个变量现在具有全局作用域，这意味着我们可以在`create_map`函数外部使用这些变量。要删除标记，你需要在Mapstraction对象上调用`removeMarker`函数：
- en: '[PRE2]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'To simply hide a marker, you call the `hide` function on the marker object:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 要简单地隐藏一个标记，你需要在标记对象上调用`hide`函数：
- en: '[PRE3]'
  id: totrans-27
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'To make a hidden marker reappear, you call the `show` function on the marker
    object:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 要使隐藏的标记重新出现，你需要在标记对象上调用`show`函数：
- en: '[PRE4]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Where do you call these functions? Anywhere they''re needed. For testing purposes,
    create a link anywhere after the `<body>` tag. For example, here is a link that
    will hide your marker:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 你在哪里调用这些函数？任何需要的地方。为了测试目的，在`<body>`标签后的任何地方创建一个链接。例如，这里有一个将隐藏你的标记的链接：
- en: '[PRE5]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Again, this location is just for testing. You want unobtrusive JavaScript that
    isn't called from a link's `href`. One barrier to using all three of these functions
    is having access to the marker object.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 再次强调，这个位置只是为了测试。你想要不干扰的JavaScript，它不会被链接的`href`调用。使用这三个函数的一个障碍是访问标记对象。
- en: This single marker example only requires the variable be within a global scope.
    As you've seen, that's easy enough. When you start using many markers, you'll
    need a way to organize them beyond declaring dozens of variables.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 这个单个标记示例只需要变量在全局范围内。正如你所看到的，这很容易。当你开始使用许多标记时，你需要一种方法来组织它们，而不仅仅是声明几十个变量。
- en: 'Mapstraction''s built-in ability to filter out certain markers (see [#9: Filter
    Out Certain Markers](ch02s09.html "#9: Filter Out Certain Markers") in [#9: Filter
    Out Certain Markers](ch02s09.html "#9: Filter Out Certain Markers")) may be the
    easiest solution. If it does not provide all the features you need, you can always
    access all the markers that Mapstraction has added:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 'Mapstraction内置的过滤特定标记的能力（参见[第9节：过滤特定标记](ch02s09.html "#9: Filter Out Certain
    Markers")）可能是最简单的解决方案。如果它没有提供你需要的所有功能，你总是可以访问Mapstraction添加的所有标记：'
- en: '[PRE6]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Mapstraction's `markers` object gives you an array of markers. From here, you
    can remove, hide, or show them as you wish.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: Mapstraction的`markers`对象为你提供了一个标记数组。从这里，你可以根据需要删除、隐藏或显示它们。
- en: '#3: Show a Message Box When Your Marker Is Clicked'
  id: totrans-37
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '#3: 当你的标记被点击时显示消息框'
- en: Markers alone are useful because they identify spots on the map. Once your map
    has more than one, viewers will start wondering what each marker means. Sure,
    you could use custom icons to differentiate markers and we'll see how to do that
    shortly. But you can provide more information by showing descriptive text when
    the user clicks a marker.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 标记本身很有用，因为它们可以标识地图上的位置。一旦你的地图有多个标记，观众就会开始想知道每个标记代表什么。当然，你可以使用自定义图标来区分标记，我们很快就会看到如何做到这一点。但你可以通过在用户点击标记时显示描述性文本来提供更多信息。
- en: Each mapping provider has a way to show a message box. Like markers themselves,
    the box looks different depending on the provider. [Figure 2-3](ch02s03.html#message_boxes_from_different_providers
    "Figure 2-3. Message boxes from different providers") shows the differences among
    the message boxes from the major map services.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 每个映射提供商都有一种显示消息框的方式。就像标记本身一样，根据提供商的不同，框的外观也不同。[图2-3](ch02s03.html#message_boxes_from_different_providers
    "图2-3. 来自不同提供商的消息框")显示了主要地图服务消息框之间的差异。
- en: '![Message boxes from different providers](httpatomoreillycomsourcenostarchimages671971.png.jpg)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![来自不同提供商的消息框](httpatomoreillycomsourcenostarchimages671971.png.jpg)'
- en: Figure 2-3. Message boxes from different providers
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 图2-3. 来自不同提供商的消息框
- en: 'Mapstraction provides an interface, called an *InfoBubble*, that works with
    all providers. To create an InfoBubble for a marker, you add a marker option like
    so:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: Mapstraction提供了一个名为*InfoBubble*的接口，它与所有提供商一起工作。要为标记创建一个InfoBubble，你可以添加一个标记选项，如下所示：
- en: '[PRE7]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The `setInfoBubble` function takes a string of text (HTML works, too) and saves
    it in connection with the marker. The line must be inserted after the marker object
    is created but before the marker is added to the map. If you have the code from
    creating a basic marker ([#1: Add a Marker to Your Map](ch02.html#number_symble_1_colon_add_a_marker_to
    "#1: Add a Marker to Your Map") in [#1: Add a Marker to Your Map](ch02.html#number_symble_1_colon_add_a_marker_to
    "#1: Add a Marker to Your Map")), you can just add the `setInfoBubble` line in
    place of the comment about marker options.'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '`setInfoBubble` 函数接受一个文本字符串（HTML 也同样适用）并将其与标记关联保存。该行必须在创建标记对象之后但在将其添加到地图之前插入。如果您有创建基本标记的代码（在[第1章：向地图添加标记](ch02.html#number_symble_1_colon_add_a_marker_to
    "#1: Add a Marker to Your Map")中），您只需将 `setInfoBubble` 行添加到关于标记选项的注释处即可。'
- en: 'For clarification, here are the commands necessary to create a brand new marker,
    include an InfoBubble, and place the marker on the map:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 为了澄清，以下是创建全新标记、包含信息气泡并将其放置在地图上的必要命令：
- en: '[PRE8]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Great! Now if you load this file, you see a basic marker in the No Starch Press
    neighborhood. Where is the InfoBubble? Click the marker, and you see something
    similar to [Figure 2-4](ch02s03.html#message_box_with_message_displayed "Figure 2-4. Message
    box with message displayed"). Mapstraction and the mapping provider do all the
    work of capturing the click event and displaying the InfoBubble. All you need
    to do is provide the content. If you're hoping to open the InfoBubble automatically
    or from code, read on; I'll show you how to display a message box without making
    the user click in the next project.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 太好了！现在如果您加载此文件，您将在 No Starch Press 社区看到基本标记。信息气泡在哪里？点击标记，您将看到类似于[图2-4](ch02s03.html#message_box_with_message_displayed
    "图2-4. 显示消息的消息框")的内容。Mapstraction 和地图服务提供商会完成捕获点击事件和显示信息气泡的所有工作。您需要做的只是提供内容。如果您希望自动打开信息气泡或从代码中打开，请继续阅读；我将在下一个项目中向您展示如何在不让用户点击的情况下显示消息框。
- en: '![Message box with message displayed](httpatomoreillycomsourcenostarchimages671973.png.jpg)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![显示消息的消息框](httpatomoreillycomsourcenostarchimages671973.png.jpg)'
- en: Figure 2-4. Message box with message displayed
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 图2-4. 显示消息的消息框
- en: '#4: Show and Hide Message Boxes Without Clicking the Marker'
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '#4: 不点击标记显示和隐藏消息框'
- en: Maps let users click around and interact with a location. You've seen how you
    can add clickable markers that provide more information about the spots you've
    plotted. But sometimes you want a little bit more control. Sometimes you want
    to open up that InfoBubble *without* the user's permission.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 地图允许用户点击并交互位置。您已经看到了如何添加可点击标记，这些标记提供了关于您所绘制位置更多信息的功能。但有时您想要更多控制。有时您想在用户没有权限的情况下打开信息气泡。
- en: For example, if your map shows search results, you might duplicate the locations
    in a list format beside the map. Then users can choose a location from the list
    and its corresponding marker opens a message box on the map.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果您的地图显示搜索结果，您可以在地图旁边以列表格式复制位置。然后用户可以从列表中选择位置，相应的标记将在地图上打开消息框。
- en: 'The basic setup for displaying a message box from code is the same as a standard
    clickable marker. You can just set some text as a marker option:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 从代码中显示消息框的基本设置与标准可点击标记相同。您只需将一些文本设置为标记选项：
- en: '[PRE9]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'This ensures that a clicked marker will still show your message. Then, from
    elsewhere in your code (such as when the user clicks one of the search results),
    you can tell the marker to open the InfoBubble:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 这样确保了点击的标记仍然会显示您的信息。然后，在您的代码的其他地方（例如当用户点击搜索结果之一时），您可以告诉标记打开信息气泡：
- en: '[PRE10]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'You can close the InfoBubble with a similar command:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用类似的命令关闭信息气泡：
- en: '[PRE11]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: The `openBubble` and `closeBubble` functions require the marker variable to
    be accessible globally. That is, the marker object needs to be declared at the
    top of your code, or you need to find another way to access it. In [Functions](apas05.html
    "Functions") in [Functions](apas05.html "Functions"), I describe variable scope
    and how to declare variables so they can be accessed anywhere in your code.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '`openBubble` 和 `closeBubble` 函数需要标记变量全局可访问。也就是说，标记对象需要在代码顶部声明，或者您需要找到另一种方法来访问它。在[函数](apas05.html
    "函数")中，我描述了变量作用域以及如何声明变量以便在代码的任何地方访问。'
- en: '#5: Create a Custom Icon Marker'
  id: totrans-60
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '#5: 创建自定义图标标记'
- en: The quickest way to make a map feel like your own is to change the default icon
    used for markers. Mapstraction has simple marker options that make the technical
    process of using custom icons a cinch. The more laborious part may be creating
    the icon file itself. To avoid this, you can find icons others have made online
    for free. I list several resources at [http://mapscripting.com/download-custom-markers/](http://mapscripting.com/download-custom-markers/).
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 要让地图感觉像是自己的，最快的方法就是更改用于标记的默认图标。Mapstraction 提供简单的标记选项，使得使用自定义图标的技术过程变得非常简单。可能更费力的部分是创建图标文件本身。为了避免这个问题，你可以在网上找到其他人免费制作的图标。我在[http://mapscripting.com/download-custom-markers/](http://mapscripting.com/download-custom-markers/)列出了几个资源。
- en: Still want to create your own? Read on.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 还想自己创建吗？继续阅读。
- en: Get Out the Image Editor
  id: totrans-63
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 拿出图像编辑器
- en: To create your own marker icon, you just need to have a graphics program that
    can save a transparent *.png* file. The icon can be whatever size you want, but
    keeping each dimension between 20 and 50 pixels is probably best. If the icon
    is too small, clicking it becomes difficult; too big, and the icon obscures the
    location you're attempting to call out.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 要创建自己的标记图标，你只需要有一个可以保存透明 *.png* 文件的图形程序。图标可以是任何大小，但保持每个维度在 20 到 50 像素之间可能是最好的。如果图标太小，点击它变得困难；太大，图标会遮挡你试图指出的位置。
- en: If you're using Google as your mapping provider, you also want to create an
    image to use as your marker's shadow. This step isn't necessary if your marker
    is a similar shape to the Google default or if you're using another provider.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用 Google 作为你的地图提供商，你还需要创建一个图像作为标记的阴影。如果你的标记形状与 Google 默认形状相似或如果你使用其他提供商，这一步是不必要的。
- en: Note
  id: totrans-66
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Not much of an image magician? You can find an online service to create a shadow
    at [http://www.cycloloco.com/shadowmaker/](http://www.cycloloco.com/shadowmaker/).
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 不是很好的图像魔术师？你可以在[http://www.cycloloco.com/shadowmaker/](http://www.cycloloco.com/shadowmaker/)找到一个在线服务来创建阴影。
- en: Add Your Icon to the Map
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将您的图标添加到地图中
- en: Now that you have an icon, the easy part is adding it to the marker options.
    All it takes is setting a few values to tell Mapstraction where the icon image
    files resides. Your best bet is to keep custom marker icons in a special directory
    on your server. If you're testing locally, you can use local copies, accessed
    by their location relative to the page containing the map. For simplicity, I have
    the HTML file and the icon files in the same directory in this example. In reality,
    you might prefer to be more organized.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你有了图标，添加到标记选项的部分就简单了。只需设置几个值来告诉 Mapstraction 图标图像文件的位置。你最好的选择是将自定义标记图标保存在服务器上的一个特殊目录中。如果你在本地测试，你可以使用本地副本，通过它们相对于包含地图的页面的位置来访问。为了简单起见，我在这个例子中将
    HTML 文件和图标文件放在同一个目录中。实际上，你可能更喜欢更有组织。
- en: I decided to use a teensy No Starch Press logo for my custom icon. It's 27 pixels
    wide by 31 pixels high. Like I said, the icon is teensy. Then, I used a shadow-maker
    service to create a file that is 43×31 including the marker's shadow.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 我决定使用一个微小的 No Starch Press 标志作为我的自定义图标。它宽 27 像素，高 31 像素。就像我说的，图标非常小。然后，我使用阴影制作服务创建了一个包括标记阴影的
    43×31 像素的文件。
- en: 'Finally, it''s time to code. Add these lines as marker options. These lines
    are inserted after a marker has been created but before the marker has been added
    to the map:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，是时候编码了。将这些行作为标记选项添加。这些行是在创建标记之后但在将标记添加到地图之前插入的：
- en: '[PRE12]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: The only parameter that you need to include is the path to the image ❶ for both
    the icon and the shadow. Notice that the dimensions of each graphic get passed
    as an inline array ❷. This parameter is optional but recommended. If you leave
    it out, some providers will assume the dimensions of the default marker, which
    could mean a poorly scaled graphic.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要包含的唯一参数是图标和阴影的图像路径 ❶。注意，每个图形的尺寸都作为内联数组 ❷传递。此参数是可选的，但建议使用。如果你省略它，一些提供商将假设默认标记的尺寸，这可能导致图形缩放不良。
- en: The results of the custom marker code are shown in [Figure 2-5](ch02s05.html#custom_marker_shows_the_no_starch_press
    "Figure 2-5. Custom marker shows the No Starch Press logo"). The No Starch Press
    office is marked by the company's logo, a little iron icon. Notice the shadow,
    as well, which makes the graphic pop out from the map.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 自定义标记代码的结果显示在[图 2-5](ch02s05.html#custom_marker_shows_the_no_starch_press "图
    2-5. 自定义标记显示了 No Starch Press 的标志")中。No Starch Press 的办公室用公司的标志，一个小铁图标标记。注意，还有阴影，这使得图形从地图中突出出来。
- en: 'Omit the shadow icon at your own risk. Some mapping providers will assume the
    default shadow, which might look silly with your icon. Not every mapping provider
    uses shadows, but planning for one is good. If you really don''t want a shadow,
    consider using a completely transparent graphic. I show an example of shadowless
    icons in [#69: Create a Weather Map](ch10s02.html "#69: Create a Weather Map")
    in [#69: Create a Weather Map](ch10s02.html "#69: Create a Weather Map").'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '在自己的风险下省略阴影图标。一些地图提供者将假设默认的阴影，这可能与你的图标看起来很傻。并非每个地图提供者都使用阴影，但计划一个阴影是好的。如果你真的不想有阴影，考虑使用完全透明的图形。我在[#69:
    创建天气地图](ch10s02.html "#69: 创建天气地图")中展示了无阴影图标的示例。'
- en: '![Custom marker shows the No Starch Press logo](httpatomoreillycomsourcenostarchimages671975.png.jpg)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![自定义标记显示了No Starch Press的标志](httpatomoreillycomsourcenostarchimages671975.png.jpg)'
- en: Figure 2-5. Custom marker shows the No Starch Press logo
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 图2-5. 自定义标记显示了No Starch Press的标志
- en: '#6: Create Numbered Markers'
  id: totrans-78
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '#6: 创建编号标记'
- en: When you have a list of locations on your web page that you also want to plot
    on a map, provide users with numbered markers. For example, when displaying search
    results, you want a matching label both on and off the map so users can easily
    identify what's what.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 当你在网页上有一系列位置信息，并且希望将这些位置也绘制到地图上时，为用户提供带编号的标记。例如，在显示搜索结果时，你希望在地图上和地图外都显示匹配的标签，以便用户能够轻松识别。
- en: Numbered markers are not any different from any other custom marker. You'll
    need to create a graphic icon for each number you want. Numerous icon sets are
    available online that you can use, or you can create them dynamically with the
    Google Charts API.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 编号标记与其他自定义标记没有区别。你需要为每个数字创建一个图形图标。网上有大量的图标集可供使用，或者你可以使用Google Charts API动态创建它们。
- en: Generate the Numbered Icon
  id: totrans-81
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 生成编号图标
- en: The Google Charts API generates reverse teardrop–style pins that look like the
    default Google marker. Using these Google-generated icons does not mean you have
    to use Google Maps. Mapstraction will add the icon for any provider to your map.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: Google Charts API生成反向泪滴风格的图钉，看起来像默认的Google标记。使用这些由Google生成的图标并不意味着你必须使用Google
    Maps。Mapstraction将为任何提供者添加图标到你的地图上。
- en: 'You control the marker''s background and border color, as well as what the
    label reads. The criteria you require are sent in the URL of the icon itself.
    For example, here is the URL for a red marker labeled with a number one:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以控制标记的背景和边框颜色，以及标签的读取内容。你需要的标准通过图标本身的URL发送。例如，这是一个带有数字一的红色标记的URL：
- en: '[PRE13]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The final argument of the URL contains all the important information for the
    marker: the label text ❶ (in this case, the number one), the background color,
    ❷ and the border ❸ color. The colors are represented as hex values, similar to
    how colors are declared in CSS.'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: URL的最后一个参数包含了标记的所有重要信息：标签文本❶（在这种情况下，数字一），背景颜色❷以及边框❸颜色。颜色以十六进制值表示，类似于CSS中颜色的声明方式。
- en: The individual pieces of the `chld` argument are separated by the pipe character,
    `|`. In a way, the final argument is really three arguments with its own way of
    segmenting the values.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: '`chld`参数的各个部分由管道字符`|`分隔。从某种意义上说，最后的参数实际上是三个参数，它们各自以自己的方式分割值。'
- en: 'Custom markers added to a map when using Google as a mapping provider also
    require a shadow. Because the shapes of these dynamic markers are all the same,
    the shadow can be static. The Google Charts API provides this URL:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 当使用Google作为地图提供者时，添加到地图上的自定义标记也需要一个阴影。因为这些动态标记的形状都是相同的，所以阴影可以是静态的。Google Charts
    API提供了这个URL：
- en: '[PRE14]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Now that you can generate the icons, you need to place them on the map. To do
    this, we'll call these Google Charts URLs on the fly.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经可以生成图标了，你需要将它们放置到地图上。为此，我们将实时调用这些Google Charts URL。
- en: Add the Icon to the Map
  id: totrans-90
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将图标添加到地图
- en: 'Armed with dynamically generated marker URLs from Google Charts, the process
    of adding these numbered markers to a map is much like adding any custom icon.
    Here is the code listing that creates five random points within San Francisco.
    Each marker is given an icon with a label numbered one through five based on the
    order that it is created:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 带着由Google Charts动态生成的标记URL，将这些编号标记添加到地图上的过程与添加任何自定义图标的过程非常相似。以下是在旧金山内部创建五个随机点的代码示例。每个标记都根据创建的顺序分配了一个从一到五的编号标签：
- en: '[PRE15]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'The lines in bold set the generated icon and its shadow. The rest either sets
    up the map or creates the random points. For the code to work, you need a JavaScript
    function, `get_random_by_bounds`, which is discussed in [Chapter 6](ch06.html
    "Chapter 6. EXPLORE PROXIMITY") but which I have reprinted next. Put the previous
    code inside the `create_map` function used in all examples so far, and then make
    sure the following function is included somewhere in the JavaScript (but outside
    of other functions):'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 加粗的行设置了生成的图标及其阴影。其余的行要么设置地图，要么创建随机点。为了使代码正常工作，您需要一个名为 `get_random_by_bounds`
    的 JavaScript 函数，该函数在 [第 6 章](ch06.html "第 6 章。探索邻近性") 中讨论，但我将其重新打印如下。将前面的代码放入迄今为止所有示例中使用的
    `create_map` 函数中，然后确保以下函数包含在 JavaScript 中（但不在其他函数中）：
- en: '[PRE16]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Save your file. You'll see a map like the one shown in [Figure 2-6](ch02s06.html#numbered_markers_comma_randomly_plotted
    "Figure 2-6. Numbered markers, randomly plotted") (marker locations vary—remember,
    they're random).
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 保存您的文件。您将看到一个类似于 [图 2-6](ch02s06.html#numbered_markers_comma_randomly_plotted
    "图 2-6. 编号标记，随机绘制")（标记位置可能不同——请记住，它们是随机的）所示的地图。
- en: '![Numbered markers, randomly plotted](httpatomoreillycomsourcenostarchimages671977.png.jpg)'
  id: totrans-96
  prefs: []
  type: TYPE_IMG
  zh: '![编号标记，随机绘制](httpatomoreillycomsourcenostarchimages671977.png.jpg)'
- en: Figure 2-6. Numbered markers, randomly plotted
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2-6. 编号标记，随机绘制
- en: Use numbered markers when the order matters, such as when displaying nearby
    locations. Numbering is also helpful when users will match search results or another
    list from outside the map to the individual markers.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 当顺序很重要时，例如在显示附近位置时，请使用编号标记。当用户将搜索结果或其他列表与地图上的单个标记匹配时，编号也很有帮助。
- en: '#7: Loop Through All Markers'
  id: totrans-99
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '#7：遍历所有标记'
- en: When you've added a bunch of markers to the map, you may want a way to access
    them all. For example, you might be looking for outliers or determining which
    marker is the farthest north.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 当您向地图添加了大量标记后，您可能希望有一种方法来访问它们。例如，您可能正在寻找异常值或确定哪个标记是最北边的。
- en: Mapstraction provides a property that holds an array of every marker plotted
    on the map. You can then reference an individual marker from within that array
    using standard JavaScript code to pull out a value at a specific index. Doing
    this for each marker on the map lets you loop through and perform an action on
    all the markers.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: Mapstraction 提供了一个属性，它包含地图上绘制的每个标记的数组。然后，您可以使用标准的 JavaScript 代码从该数组中引用单个标记，以在特定索引处提取值。对地图上的每个标记执行此操作可以让您遍历并执行所有标记上的操作。
- en: 'Add these lines to your code wherever you need to do something to each marker:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 将这些行添加到您的代码中，您需要为每个标记执行某些操作的地方：
- en: '[PRE17]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: The first thing we do is reference the array of all markers from Mapstraction
    ❶ with a new variable name, `allm`. The saves us some typing, as we'll need to
    use the marker variable several times. Next, we use JavaScript's `for` statement
    ❷ to loop through the array. A temporary variable, `i`, keeps track of the index,
    as we count from zero (the first element in an array is at zero) up to the total
    number of markers.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先使用一个新的变量名 `allm` 引用 Mapstraction ❶ 中所有标记的数组。这节省了我们一些打字，因为我们还需要多次使用标记变量。接下来，我们使用
    JavaScript 的 `for` 语句 ❷ 遍历数组。一个临时变量 `i` 跟踪索引，因为我们从零（数组中的第一个元素位于零）计数到标记总数。
- en: As each marker becomes available, we place a reference to it inside the temporary
    `thism` variable ❸, a name I chose because it describes "this marker," as in the
    marker we are currently utilizing. Anything within the braces, `{` and `}`, of
    the `for` loop now has access to this new variable.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 随着每个标记变得可用，我们在临时变量 `thism` ❸ 中放置对该标记的引用，我选择这个名字是因为它描述了“这个标记”，即我们目前正在使用的标记。现在，`for`
    循环的大括号 `{` 和 `}` 中的任何内容都可以访问这个新变量。
- en: We can look up marker options or call functions on the marker (such as `showBubble`
    or `hide`, for example). In most cases, we cannot *add* options because options
    need to be added before the marker is added to the map. For example, we cannot
    change the marker's icon without removing and re-adding the marker.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以查找标记选项或在标记上调用函数（例如，`showBubble` 或 `hide` 等）。在大多数情况下，我们无法 *添加* 选项，因为选项需要在标记添加到地图之前添加。例如，我们不能更改标记的图标，除非移除并重新添加标记。
- en: Despite these few limitations, looping through the markers is a useful trick
    to add to your mapping tool bag. Many of Mapstraction's functions, such as filtering
    or autocentering, use a loop internally.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管有这些限制，但遍历标记是将有用的技巧添加到您的制图工具包中的好方法。Mapstraction 的许多函数，如过滤或自动居中，都使用循环作为内部操作。
- en: '#8: Determine the Correct Zoom Level to Use Based on Markers'
  id: totrans-108
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '#8：根据标记确定正确的缩放级别'
- en: 'Once your map has several markers, ensuring that all of them can be viewed
    becomes a chore. This is especially true when your locations are being served
    up by a database ([#66: Plot Locations from a Database](ch09s08.html "#66: Plot
    Locations from a Database") in [#66: Plot Locations from a Database](ch09s08.html
    "#66: Plot Locations from a Database")). Markers start to fall outside of your
    manually set center and zoom levels.'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: '当你的地图上有几个标记点时，确保所有标记点都可以被查看变成了一项繁琐的工作。这尤其在你从数据库中获取位置信息时（见[第66节：从数据库中绘制位置](ch09s08.html
    "#66: Plot Locations from a Database")）更是如此。标记点开始超出你手动设置的中心和缩放级别。'
- en: You may have tried to fix this on your own by changing the zoom level. If you
    zoom out, your markers can end up scrunched together, with lots of room to zoom
    in. The only way to achieve a good zoom level for any marker is to determine it
    programmatically after all the markers are added to the map.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能已经尝试通过更改缩放级别来解决这个问题。如果你缩小缩放级别，你的标记点可能会挤在一起，留有足够的空间进行放大。要为任何标记点达到一个良好的缩放级别，唯一的方法是在所有标记点都添加到地图后，通过编程方式确定它。
- en: 'Mapstraction makes setting the zoom level as easy as one function call. Add
    the following line to the `create_map` function from the basic map after you have
    added some markers:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: Mapstraction将设置缩放级别简化为一个函数调用。在你添加了一些标记点后，将以下行添加到基本地图的`create_map`函数中：
- en: '[PRE18]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'You can also use a similar function that only works on displayed markers. That
    is, if you''ve hidden or filtered out some markers, you will probably want to
    zoom in to the ones that are still on the map. Instead of the previous function,
    use this:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以使用一个类似的功能，它只适用于显示的标记点。也就是说，如果你隐藏或过滤掉了一些标记点，你可能希望放大到仍然在地图上的那些标记点。而不是使用之前的函数，使用以下函数：
- en: '[PRE19]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'If these functions feel like magic, that''s okay. Mapstraction makes it easy,
    but a lot is going on behind the curtain. Here''s the run-down of how Mapstraction
    makes auto-zooming happen:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 如果这些功能感觉像是魔法，那也没关系。Mapstraction使这变得简单，但幕后有很多事情在进行。以下是Mapstraction如何实现自动缩放的概述：
- en: Loops through all the markers (or just the visible ones), and determines the
    maximum and minimum latitude and longitude of the markers. This measurement is
    called the *bounding box* and consists of four numbers that describe each edge
    of the box.
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 遍历所有标记点（或仅遍历可见的标记点），并确定标记点的最大和最小纬度和经度。这个测量值被称为*边界框*，由四个数字组成，描述了框的每一边。
- en: Finds the center of the bounding box by averaging the two latitudes and the
    two longitudes.
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过平均两个纬度和两个经度来找到边界框的中心。
- en: Checks zoom levels until it finds one that displays the entire bounding box.
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查缩放级别，直到找到可以显示整个边界框的一个。
- en: Actually, Mapstraction does not need to perform the last two steps for very
    many mapping providers. Most already have something that does the auto-zooming
    work within their own library. That wasn't always the case, however, and it points
    to the power of Mapstraction. Mapstraction is able to add these indispensable
    functions before they're available in all map APIs.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，Mapstraction不需要为许多地图服务提供商执行最后两个步骤。大多数地图服务提供商的库中已经有一些可以自动缩放的功能。然而，情况并非总是如此，这也指向了Mapstraction的力量。Mapstraction能够在所有地图API可用之前添加这些不可或缺的功能。
- en: 'To get a feel for how auto-zooming works, insert this code in the basic map''s
    `create_map` function to add random markers:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 为了了解自动缩放是如何工作的，将以下代码插入基本地图的`create_map`函数中，以添加随机标记点：
- en: '[PRE20]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: This code chooses five random markers, but you can change the first variable
    ❶ to any number you want. I've also created a bounding box ❷ that is larger than
    the basic map's visible area (you can learn more about bounds in [Chapter 6](ch06.html
    "Chapter 6. EXPLORE PROXIMITY")). These bounds are used to produce a new random
    point for each of my markers. You actually need to include a special function
    ❸ to create the point. We'll get to that in a moment.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 此代码选择了五个随机标记点，但你可以将第一个变量❶更改为任何你想要的数字。我还创建了一个比基本地图可见区域更大的边界框❷（你可以在[第6章](ch06.html
    "第6章. 探索邻近性")中了解更多关于边界的信息）。这些边界用于为我的每个标记点生成一个新的随机点。实际上，你需要包含一个特殊函数❸来创建这个点。我们稍后会讨论这个问题。
- en: First, note the last line ❹, the one that auto-zooms. Try commenting it out
    by placing a `//` at the front of the line to see how the markers look without
    auto-zooming. Reload the map a few times with and without the comment slashes.
    [Figure 2-7](ch02s08.html#difference_between_markers_without_and_w "Figure 2-7. Difference
    between markers without and with automatic centering and zooming") shows an example
    comparison of the maps in each of these situations.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，注意最后一行❹，自动缩放的行。尝试通过在行首放置`//`来注释掉它，看看没有自动缩放时标记器看起来如何。多次重新加载地图，带有和没有注释斜杠的情况。[图2-7](ch02s08.html#difference_between_markers_without_and_w
    "图2-7. 无自动居中和缩放与有自动居中和缩放的标记器之间的差异")显示了在这些情况下每种情况的地图示例比较。
- en: '![Difference between markers without and with automatic centering and zooming](httpatomoreillycomsourcenostarchimages671979.png.jpg)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![无自动居中和缩放与有自动居中和缩放的标记器之间的差异](httpatomoreillycomsourcenostarchimages671979.png.jpg)'
- en: Figure 2-7. Difference between markers without and with automatic centering
    and zooming
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 图2-7. 无自动居中和缩放与有自动居中和缩放的标记器之间的差异
- en: 'Of course, you need that special function, `get_random_by_bounds`. Unlike in
    the previous code, add this outside of the `create_map` function but within the
    JavaScript section:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，你需要那个特殊函数，`get_random_by_bounds`。与之前的代码不同，将此函数添加到`create_map`函数外部，但仍在JavaScript部分内部：
- en: '[PRE21]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'This function is described in detail in [#44: Get a Random Point in a Bounding
    Box](ch06s09.html "#44: Get a Random Point in a Bounding Box") in [#44: Get a
    Random Point in a Bounding Box](ch06s09.html "#44: Get a Random Point in a Bounding
    Box").'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '这个函数在[#44: 在边界框中获取随机点](ch06s09.html "#44: 在边界框中获取随机点")中有详细描述。'
- en: As for the automatic centering and zooming, now that you can do it in a single
    function call, you'll likely include it for all but the simplest maps—it's really
    that useful.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 关于自动居中和缩放，现在你可以在一个函数调用中完成它，你可能会将其包含在除了最简单的地图之外的所有地图中——它真的非常有用。
- en: '#9: Filter Out Certain Markers'
  id: totrans-130
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '#9: 过滤掉某些标记器'
- en: You must have a map with a whole bunch of markers by now, right? That means
    you're getting the hang of this mapping stuff. With a full screen of markers,
    users will likely want to way to see only what they care about. That's where you'll
    find Mapstraction's filtering options handy.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 到现在为止，你肯定有一大堆标记器，对吧？这意味着你正在掌握这种映射技术。当有满屏的标记器时，用户可能会想要看到他们关心的内容。这就是Mapstraction的过滤选项变得方便的地方。
- en: Keeping track of many markers without the filtering options is a pain. You need
    to maintain global arrays or make use of the `mapstraction.markers` object. In
    either case, you need a way to distinguish the type of marker or some data associated
    with it.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 在没有过滤选项的情况下跟踪许多标记器是一件痛苦的事情。你需要维护全局数组或使用`mapstraction.markers`对象。在两种情况下，你都需要一种方法来区分标记器的类型或与之相关的某些数据。
- en: 'The first step in filtering is to create a new attribute and add it to your
    new marker. You do this by adding some marker options, which has to happen after
    a marker is created but before you add it to the map. Here, I''ll set the price
    to be 1000—maybe the marker represents an apartment and this attribute is its
    rent:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 过滤的第一步是创建一个新的属性并将其添加到你的新标记器中。你是通过添加一些标记器选项来做到这一点的，这必须在创建标记之后但在将其添加到地图之前完成。在这里，我将价格设置为1000——也许这个标记代表一个公寓，而这个属性是它的租金：
- en: '[PRE22]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: If you'd like to add more attributes, such as number of bedrooms, you can do
    that with additional `setAttribute` lines. Once you've added the data for several
    markers, you can move on to filtering.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想要添加更多属性，比如卧室数量，你可以通过额外的`setAttribute`行来实现。一旦你为几个标记器添加了数据，你就可以继续进行过滤。
- en: Filters are applied after the markers have been added to the map. In fact, filtering
    usually happens in response to user behavior, such as when a user clicks a filter
    button or enters search terms.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 过滤是在标记器添加到地图之后应用的。实际上，过滤通常是在用户行为（如用户点击过滤器按钮或输入搜索词）之后发生的。
- en: 'To show only markers with a price attribute greater than or equal to 1000,
    use this code:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 要显示具有大于或等于1000的价格属性的标记器，请使用此代码：
- en: '[PRE23]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: First, use `removeAllFilters` unless you know no filters are applied. The reason
    is that filters are additive, meaning a second filter does not remove the first.
    You could end up with fewer results than you expect because of a previously applied
    filter.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，使用`removeAllFilters`，除非你知道没有应用任何过滤器。原因是过滤器是累加的，这意味着第二个过滤器不会删除第一个。由于之前应用的过滤器，你可能会得到比你预期的更少的结果。
- en: 'Once filters are removed, you can continue. To add the filter requires three
    parameters: the attribute name ❶, the operator (in this case **g**reater than
    or **e**qual to) ❷, and the number ❸ to use as a comparison. Finally, the map
    will not change at all unless you apply the filter ❹.'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦移除了过滤器，你可以继续。要添加过滤器需要三个参数：属性名称 ❶、操作符（在这种情况下为 **g**reater than 或 **e**qual
    to） ❷，以及用作比较的数字 ❸。最后，除非你应用了过滤器 ❹，否则地图将不会发生任何变化。
- en: Table 2-1. Filtering Operators
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 表 2-1. 过滤运算符
- en: '| Operator | Description |'
  id: totrans-142
  prefs: []
  type: TYPE_TB
  zh: '| 操作符 | 描述 |'
- en: '| --- | --- |'
  id: totrans-143
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `ge` | Greater than or equal to—use on numbers. |'
  id: totrans-144
  prefs: []
  type: TYPE_TB
  zh: '| `ge` | 大于或等于——用于数字。 |'
- en: '| `le` | Less than or equal to—use on numbers. |'
  id: totrans-145
  prefs: []
  type: TYPE_TB
  zh: '| `le` | 小于或等于——用于数字。 |'
- en: '| `eq` | Equal to—use on numbers or with words (such as tags or types). |'
  id: totrans-146
  prefs: []
  type: TYPE_TB
  zh: '| `eq` | 等于——用于数字或与单词（如标签或类型）一起使用。 |'
- en: Once a filter is applied, the markers that *don't* match the filter will disappear.
    In our example, anything with a price attribute less than 1000 (or without a price
    attribute) will be removed. Thus, filtering can be thought of as filtering *in*
    rather than *out*.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦应用了过滤器，不符合过滤器的标记将消失。在我们的例子中，任何价格属性小于 1000（或没有价格属性）的物品都将被移除。因此，过滤可以被视为过滤“内”而不是“外”。
- en: Mapstraction provides three operators to use to filter markers, as seen in [Table 2-1](ch02s09.html#filtering_operators
    "Table 2-1. Filtering Operators"). You can combine filters to achieve more granular
    results. Sticking with the apartment search theme, you might add a neighborhood
    attribute, so users can view apartments in a certain neighborhood that are below
    a certain price, for example.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: Mapstraction 提供了三个操作符用于过滤标记，如 [表 2-1](ch02s09.html#filtering_operators "表 2-1.
    过滤运算符") 所示。你可以组合过滤器以实现更精细的结果。继续以公寓搜索为主题，你可能添加一个区域属性，这样用户就可以查看某个区域价格低于某个水平的公寓，例如。
- en: 'Mapstraction filters are a speedy way to show only a subset of markers based
    on simple criteria. They do not require any additional communication with the
    server because Mapstraction stores information about every marker in memory. For
    an example of filtering used in a real project, see [#71: Search Music Events
    by Location](ch10s04.html "#71: Search Music Events by Location") in [#71: Search
    Music Events by Location](ch10s04.html "#71: Search Music Events by Location").'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 'Mapstraction 过滤器是一种快速显示基于简单标准的一组标记子集的方法。它们不需要与服务器进行任何额外的通信，因为 Mapstraction
    将每个标记的信息存储在内存中。有关在真实项目中使用过滤器的示例，请参阅 [#71: 通过位置搜索音乐活动](ch10s04.html "#71: 通过位置搜索音乐活动")
    在 [#71: 通过位置搜索音乐活动](ch10s04.html "#71: 通过位置搜索音乐活动")。'
- en: '#10: Remove or Hide All Markers'
  id: totrans-150
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '#10: 删除或隐藏所有标记'
- en: Need to start fresh, or want to show a clear map in some situations? We all
    can use a little spring cleaning from time to time. I've already shown how to
    remove or hide a single marker in this chapter. Now we'll get rid of them all.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 需要重新开始，或者在某些情况下想要显示一个清晰的地图？我们时不时都可以用一点春季大扫除。我已经在本章中展示了如何删除或隐藏单个标记。现在我们将摆脱它们所有。
- en: Again, make sure you understand that when you remove a marker it is gone forever.
    Removing a marker is sometimes desired, such as when the user activates a new
    search. Mapstraction has a function to achieve a clean slate. A hidden marker,
    on the other hand, can always be shown again. We'll have to write our own function
    to hide all markers and make the slate *appear* clean.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 再次确保你明白，当你删除一个标记时，它将永远消失。有时删除标记是希望的行为，例如当用户激活新的搜索时。Mapstraction 有一个功能可以做到从零开始。另一方面，隐藏的标记总是可以再次显示。我们将不得不编写自己的函数来隐藏所有标记并使画板看起来干净。
- en: 'First, let''s be destructive and remove all the markers from our map. Add this
    line wherever you want to axe all the markers:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们来点破坏性的，从我们的地图中删除所有标记。在任何你想砍掉所有标记的地方添加此行：
- en: '[PRE24]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'That''s it—they''re gone. [#71: Search Music Events by Location](ch10s04.html
    "#71: Search Music Events by Location") in [#71: Search Music Events by Location](ch10s04.html
    "#71: Search Music Events by Location") shows an example of this function in use
    every time a user starts a search. By removing the markers, we ensure the previous
    search results don''t get mixed up with the new ones.'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '就这样——它们消失了。[#71: 通过位置搜索音乐活动](ch10s04.html "#71: 通过位置搜索音乐活动") 在 [#71: 通过位置搜索音乐活动](ch10s04.html
    "#71: 通过位置搜索音乐活动") 中展示了每次用户开始搜索时使用此函数的示例。通过删除标记，我们确保之前的搜索结果不会与新结果混淆。'
- en: 'If we only want to hide all markers, we need to write our own function. To
    do this, we need to loop through all markers (described in detail in [#7: Loop
    Through All Markers](ch02s07.html "#7: Loop Through All Markers") in [#7: Loop
    Through All Markers](ch02s07.html "#7: Loop Through All Markers")) and hide each
    one.'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '如果我们只想隐藏所有标记，我们需要编写自己的函数。为此，我们需要遍历所有标记（在[#7: 遍历所有标记](ch02s07.html "#7: 遍历所有标记")中详细描述），并隐藏每一个。'
- en: '[PRE25]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: So far, much of our code has been used inside the `create_map` function. Because
    `hideAllMarkers` is a new function, we need to add it in its own place outside
    of other functions but still in the JavaScript section of the page.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们的大部分代码都是在`create_map`函数内部使用的。因为`hideAllMarkers`是一个新函数，所以我们需要在它的位置添加它，但不在其他函数之外，仍然在页面的JavaScript部分。
- en: The function itself is straightforward. It first grabs a reference to the marker
    object ❶ from Mapstraction, which holds an array of every marker added to the
    map. Then, using that array of markers, the function goes through them one by
    one. Each time through the loop, the function takes another marker and puts it
    in a temporary variable named `thism` ❷ (for "this marker"). Finally, it calls
    the `hide` function ❸ on this marker.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 函数本身很简单。它首先从Mapstraction获取标记对象的引用❶，该对象包含添加到地图上的所有标记的数组。然后，使用这个标记数组，函数逐个遍历它们。每次循环中，函数都会取另一个标记并将其放入一个名为`thism`❷的临时变量中（代表“这个标记”）。最后，它在这个标记上调用`hide`函数❸。
- en: By the end of the function, no markers will be displayed on the map. We've looped
    through every marker and hidden them one at a time.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 到函数结束时，地图上不会显示任何标记。我们已经遍历了每个标记，并逐个隐藏了它们。
- en: 'To write the function is not enough. We need to call the function from somewhere
    else in our code:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 编写函数还不够。我们需要在代码的其他地方调用这个函数：
- en: '[PRE26]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Notice that this call looks very similar to the call for removing all the markers.
    One major difference is that `removeAllMarkers` was called on the Mapstraction
    object. This new function is merely called on its own. The difference is that
    we wrote `hideAllMarkers` in our own code, whereas Mapstraction's functions are
    part if its package.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，这个调用看起来与移除所有标记的调用非常相似。一个主要区别是`removeAllMarkers`是在Mapstraction对象上被调用的。这个新函数仅仅是独立调用的。区别在于我们自己在代码中编写了`hideAllMarkers`，而Mapstraction的函数是其包的一部分。
- en: Writing utility functions, as we did here to hide every marker, is an important
    part of programming. Now that we've written the function once, we can call it
    any time we need it.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 编写实用函数，就像我们在这里隐藏每个标记一样，是编程的重要部分。现在我们已经编写了这个函数一次，我们可以在需要时随时调用它。
- en: '#11: Handle Clusters of Markers'
  id: totrans-165
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '#11: 处理标记簇'
- en: This chapter has already covered several ways to make sense of a map with many
    markers plotted. You can number them and filter them. You can automatically zoom
    to show all the markers within the visible portion of the map. These tools are
    all good to have, but you'll find that sometimes your markers are still scrunched
    together and overlapping. You can't avoid it, but you can make it less of a problem.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 本章已经介绍了几种理解带有许多标记的地图的方法。你可以对它们进行编号和筛选。你可以自动缩放以显示地图可见部分内的所有标记。这些工具都很有用，但你可能会发现有时你的标记仍然挤在一起并重叠。这是不可避免的，但你可以使这个问题不那么严重。
- en: Instead of showing every single marker, you can use a special icon to represent
    a cluster of markers. Then, when users zoom in, the cluster will disappear and
    be replaced by the actual markers. You can see an example of many markers, with
    and without clustering, in [Figure 2-8](ch02s11.html#difference_between_markers_with_and_with
    "Figure 2-8. Difference between markers with and without clustering").
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 而不是显示每一个单独的标记，你可以使用一个特殊的图标来代表一组标记。然后，当用户放大查看时，该组标记将消失，并被实际的标记所取代。你可以在[图2-8](ch02s11.html#difference_between_markers_with_and_with
    "图2-8. 带和不带聚类的标记差异")中看到一个带有和没有聚类的许多标记的例子。
- en: '![Difference between markers with and without clustering](httpatomoreillycomsourcenostarchimages671981.png.jpg)'
  id: totrans-168
  prefs: []
  type: TYPE_IMG
  zh: '![带和不带聚类的标记差异](httpatomoreillycomsourcenostarchimages671981.png.jpg)'
- en: Figure 2-8. Difference between markers with and without clustering
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 图2-8. 带和不带聚类的标记差异
- en: The code behind marker clustering is surprisingly complicated, but the concept
    is simple. Although many approaches exist, commonly the map is divided into a
    grid. If one *cell* of the map contains more than one marker (or more than a certain
    number—you may prefer a cutoff of five markers per cell), they're replaced by
    a cluster.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 标记聚类的代码背后非常复杂，但概念很简单。尽管存在许多方法，但通常地图被分成一个网格。如果一个地图的*单元*包含一个以上的标记（或者超过一定数量——你可能更喜欢每个单元五个标记的截止值），它们将被一个聚类替换。
- en: Rather than write this algorithm ourselves, we'll use a utility that is already
    written to work directly with Google Maps, called *ClusterMarker*. You can download
    the code from [http://www.acme.com/javascript/](http://www.acme.com/javascript/)
    and save it in a file named *clusterer2.js*.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 我们不会自己编写这个算法，而是会使用一个已经编写好并可以直接与谷歌地图一起工作的实用工具，称为*ClusterMarker*。你可以从[http://www.acme.com/javascript/](http://www.acme.com/javascript/)下载代码，并将其保存为名为*clusterer2.js*的文件。
- en: 'Unlike most examples in this book, you''ll work with Google Maps directly,
    as you did in [Create a Google Map](ch01s03.html#create_a_google_map "Create a
    Google Map") in [Create Your First Map](ch01s03.html "Create Your First Map").
    In addition to including the Google Maps API JavaScript in the header, you also
    need to reference the new cluster file. Add this to the header section of your
    HTML:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 与本书中的大多数示例不同，你将直接与谷歌地图（Google Maps）工作，就像你在[创建谷歌地图](ch01s03.html#create_a_google_map
    "创建谷歌地图")中做的那样，在[创建你的第一张地图](ch01s03.html "创建你的第一张地图")。除了在页眉中包含谷歌地图API JavaScript之外，你还需要引用新的聚类文件。将以下内容添加到HTML的页眉部分：
- en: '[PRE27]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'The cluster code is similar to Mapstraction in that it wraps itself around
    Google Maps. The code to add markers will go through the cluster functions and
    then be routed to Google Maps. Replace your `create_map` function with this one,
    which will place 100 random markers on the map and cluster where necessary:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 聚类代码与Mapstraction类似，因为它将自己包裹在谷歌地图周围。添加标记的代码将通过聚类函数进行，然后被路由到谷歌地图。用这个函数替换你的`create_map`函数，它将在地图上放置100个随机标记并在必要时进行聚类：
- en: '[PRE28]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: I've centered this map roughly in the middle of the United States (hello, Kansas!).
    Once the basic map has been created, we need to tell the cluster code where to
    find it ❶, which creates an object that is put into a variable named `clustobj`.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 我将这个地图大致定位在美国中部（嗨，堪萨斯州！）。一旦创建了基本地图，我们需要告诉聚类代码在哪里可以找到它❶，这将创建一个对象，并将其放入名为`clustobj`的变量中。
- en: Before we add any markers, we want to reset some properties of the clusterer.
    The first ❷ sets the number of markers when the cluster code will begin clustering.
    The default is 150, which means every single one of our 100 markers will be shown
    without clustering if we don't change this setting. The next setting ❸ declares
    how many markers need to occupy a grid cell before clustering takes over. The
    default is 5 and, for our example, seems a little too crowded. Experiment with
    what works best for your map.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们添加任何标记之前，我们希望重置聚类器的一些属性。第一个❷设置当聚类代码开始聚类时的标记数量。默认值是150，这意味着如果我们不更改此设置，我们所有的100个标记将不会进行聚类而全部显示。下一个设置❸声明在聚类接管之前需要多少个标记占据一个网格单元。默认值是5，对于我们的示例来说似乎有点拥挤。尝试找出最适合你地图的设置。
- en: Now we're ready to add markers to the map. I wrote a `for` loop that creates
    100 markers at random points near the center of our map. Then, instead of adding
    them directly to the map, we add them to the clusterer ❹.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经准备好向地图添加标记。我编写了一个`for`循环，在地图中心附近随机生成100个标记。然后，我们不是直接将它们添加到地图上，而是将它们添加到聚类器❹中。
- en: Save your file, and load it in a browser to see the large clustered markers.
    You may also see a few stray normal markers—these markers didn't need to be clustered
    because other markers weren't nearby. The map looks a whole lot cleaner, doesn't
    it? Zoom in and some of the clusters will disappear, as the map is able to display
    the actual markers without crowding them.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 保存你的文件，并在浏览器中打开它以查看大型的聚类标记。你也可能看到一些散乱的普通标记——这些标记不需要聚类，因为其他标记附近没有标记。地图看起来整洁多了，不是吗？放大一些，一些聚类将消失，因为地图能够显示实际的标记而不使它们拥挤。
- en: Change the Cluster Icon
  id: totrans-180
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更改聚类图标
- en: Out of the box, your cluster code uses a large, blue icon for cluster markers.
    If you have another graphic you would rather use, you can include it instead.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，你的聚类代码使用一个大的蓝色图标作为聚类标记。如果你有其他你更愿意使用的图形，你可以包含它。
- en: 'Add the following code after your other cluster settings but before you start
    adding markers:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 在你的其他集群设置之后，但在你开始添加标记之前，添加以下代码：
- en: '[PRE29]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Clustering icons solves the marker overload problem, in which the markers are
    so numerous they become meaningless. Clustering is also a quick way to still show
    everything without overwhelming your users.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 聚类图标解决了标记过载问题，其中标记数量如此之多以至于变得没有意义。聚类也是一种快速的方法，仍然可以展示所有内容，而不会让你的用户感到不知所措。
