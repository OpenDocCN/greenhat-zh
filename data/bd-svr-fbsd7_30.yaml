- en: Chapter 11\. ISC DHCP SERVER 3.0.5
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第 11 章\. ISC DHCP 服务器 3.0.5
- en: '[HTTP://WWW.ISC.ORG/SW/DHCP](HTTP://WWW.ISC.ORG/SW/DHCP)'
  id: totrans-1
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[HTTP://WWW.ISC.ORG/SW/DHCP](HTTP://WWW.ISC.ORG/SW/DHCP)'
- en: 11.1\. SUMMARY
  id: totrans-2
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 11.1\. 摘要
- en: DHCP (Dynamic Host Configuration Protocol) provides network clients with an
    automated method of obtaining the configuration parameters necessary to communicate
    with other systems in an IP (Internet Protocol) based network. The parameters
    a DHCP server commonly provides to clients include IP address assignments, DNS
    server addresses, and default routers or gateway addresses.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: DHCP（动态主机配置协议）为网络客户端提供了一种自动获取与基于 IP（互联网协议）网络的其它系统通信所需配置参数的方法。DHCP 服务器通常提供给客户端的参数包括
    IP 地址分配、DNS 服务器地址以及默认路由器或网关地址。
- en: When a client system first joins a network using DHCP, it broadcasts a request
    to the local network for configuration information. The DHCP server then answers
    this request with the parameters set in the DHCP server configuration file. The
    client system applies this assigned configuration to its network interface in
    order to communicate with the network.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 当客户端系统首次使用 DHCP 加入网络时，它会向本地网络广播一个请求以获取配置信息。然后 DHCP 服务器用 DHCP 服务器配置文件中设置的参数回答此请求。客户端系统将此分配的配置应用到其网络接口，以便与网络通信。
- en: 'DHCP servers generally assign IP addresses in one of two ways: statically or
    dynamically. The static method allocates an IP address to a client based on the
    client''s hardware MAC (Media Access Control) address. This IP address will not
    change. A dynamic IP address assignment is a leased address. The DHCP server assigns
    these addresses from a pool or range set by the administrator. Dynamic IP addresses
    are returned to the pool when a client disconnects from the network. If the same
    client rejoins the network, it may be assigned a different IP address if the previously
    assigned address is unavailable.'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: DHCP 服务器通常以两种方式之一分配 IP 地址：静态或动态。静态方法根据客户端的硬件 MAC（媒体访问控制）地址分配 IP 地址给客户端。这个 IP
    地址不会改变。动态 IP 地址分配是一个租用地址。DHCP 服务器从管理员设置的池或范围内分配这些地址。当客户端从网络断开连接时，动态 IP 地址会返回到池中。如果相同的客户端重新连接到网络，如果之前分配的地址不可用，它可能会被分配一个不同的
    IP 地址。
- en: DHCP first appeared in October 1993 as a replacement for BOOTP (Bootstrap Protocol).
    Version 1 of ISC's DHCP server was released by Ted Lemon in December 1997\. ISC's
    DHCP implementation remains one of the most popular and robust open source DHCP
    solutions.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: DHCP 首次于 1993 年 10 月作为 BOOTP（引导协议）的替代品出现。ISC 的 DHCP 服务器 1.0 版本由 Ted Lemon 于
    1997 年 12 月发布。ISC 的 DHCP 实现仍然是最受欢迎和最稳健的开源 DHCP 解决方案之一。
- en: 11.2\. RESOURCES
  id: totrans-7
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 11.2\. 资源
- en: Ted Lemon's Paper on the ISC DHCP Distribution (dated 1998)
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: Ted Lemon 关于 ISC DHCP 分发的论文（日期为 1998 年）
- en: '[http://www.isc.org/sw/dhcp/dhcp-freenix.php](http://www.isc.org/sw/dhcp/dhcp-freenix.php)'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://www.isc.org/sw/dhcp/dhcp-freenix.php](http://www.isc.org/sw/dhcp/dhcp-freenix.php)'
- en: ISC DHCP Version 3 README
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: ISC DHCP 版本 3 README
- en: http://www.isc.org/sw/dhcp/dhcpv3-README.php
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: http://www.isc.org/sw/dhcp/dhcpv3-README.php
- en: RFC 1541 - Dynamic Host Configuration Protocol
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: RFC 1541 - 动态主机配置协议
- en: http://tools.ietf.org/html/rfc1541
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: http://tools.ietf.org/html/rfc1541
- en: The FreeBSD Handbook
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: FreeBSD 手册
- en: '[http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/network-dhcp.html](http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/network-dhcp.html)'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/network-dhcp.html](http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/network-dhcp.html)'
- en: 11.3\. REQUIRED
  id: totrans-16
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 11.3\. 必需
- en: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) FreeBSD 7.0-RELEASE
    (see "[FreeBSD 7.0](freebsd_7.0_split_000.html#freebsd_7.0)")'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) FreeBSD 7.0-RELEASE（见
    "[FreeBSD 7.0](freebsd_7_0_split_000.html#freebsd_7_0)"）'
- en: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) Updated ports
    collection (see "[FreeBSD Ports Collection](freebsd_ports_collection.html#freebsd_ports_collection)")'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
  zh: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) 更新的端口集合（见
    "[FreeBSD 端口集合](freebsd_ports_collection.html#freebsd_ports_collection)"）'
- en: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) Internet
    connection'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) 互联网连接'
- en: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) Your ISP''s
    DNS server addresses'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) 您的 ISP 的
    DNS 服务器地址'
- en: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) IP address
    of your router or default gateway; to find this information:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) 路由器或默认网关的
    IP 地址；要查找此信息：'
- en: '[PRE0]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 11.4\. OPTIONAL
  id: totrans-23
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 11.4\. 可选
- en: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) Authoritative
    BIND DNS server, if you wish to enable dynamic DNS updates (see "[ISC BIND DNS
    Server 9.4.2](isc_bind_dns_server_9.4.2.html#isc_bind_dns_server_9.4.2)")'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) 如果您希望启用动态
    DNS 更新（请参阅 "[ISC BIND DNS Server 9.4.2](isc_bind_dns_server_9.4.2.html#isc_bind_dns_server_9.4.2)")'
- en: 11.5\. PREPARATION
  id: totrans-25
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 11.5\. 准备
- en: If you plan on running your own DNS server, install and configure it prior to
    starting this guide. Become the superuser.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您计划运行自己的 DNS 服务器，请在开始本指南之前安装和配置它。成为超级用户。
- en: 11.6\. INSTALL
  id: totrans-27
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 11.6\. 安装
- en: 'To begin the ISC DHCP server installation process, enter the following commands:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始 ISC DHCP 服务器安装过程，请输入以下命令：
- en: '[PRE1]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: A menu of options will appear. Leave these options at their defaults (unless
    you have a specific need to change them), press [tab] to highlight OK, and then
    press [enter].
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 将出现一个选项菜单。保留这些选项的默认设置（除非您有特殊需求需要更改它们），按 [tab] 键高亮显示“确定”，然后按 [enter] 键。
- en: 11.7\. CONFIGURE
  id: totrans-31
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 11.7\. 配置
- en: Once the installation process is complete, it's time to configure DHCP for use
    on your system.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 安装过程完成后，是时候配置 DHCP 以在您的系统上使用了。
- en: 'We need to copy the default configuration file dhcpd.conf.sample to a new file
    named dhcpd.conf. Then we''ll open it and customize the DHCP server''s configuration.
    Enter the following commands to make the copy and open the file for editing:'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们需要将默认配置文件 dhcpd.conf.sample 复制到名为 dhcpd.conf 的新文件中。然后我们将打开它并自定义 DHCP 服务器的配置。输入以下命令以进行复制并打开文件进行编辑：
- en: '[PRE2]'
  id: totrans-34
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Scroll down to the `domain-name` option and replace [example.org](http://example.org)
    with your domain name. Replace [ns1.example.org](http://ns1.example.org) and [ns2.example.org](http://ns2.example.org)
    with the IP addresses of the DNS servers you''d like the DHCP server to assign
    to clients. You may use your own DNS server IPs here, or those of your ISP. The
    two lines (~7) would appear as follows if your domain name was [example.com](http://example.com)
    and your DNS server IPs were `*192.168.1.11*` and `*61.32.24.84*`:'
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 滚动到 `domain-name` 选项，将 [example.org](http://example.org) 替换为您的域名。将 [ns1.example.org](http://ns1.example.org)
    和 [ns2.example.org](http://ns2.example.org) 替换为您希望 DHCP 服务器分配给客户端的 DNS 服务器 IP
    地址。您可以使用自己的 DNS 服务器 IP 地址，或使用您的 ISP 的 IP 地址。如果您的域名是 [example.com](http://example.com)
    且您的 DNS 服务器 IP 地址是 `*192.168.1.11*` 和 `*61.32.24.84*`，则这两行（约第 7 行）将如下所示：
- en: '[PRE3]'
  id: totrans-36
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Scroll down and uncomment the `authoritative` directive by removing the leading
    hash mark (`#`) to make the DHCP server authoritative. The line (~15) should look
    like this:'
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 滚动并取消注释 `authoritative` 指令，通过删除前面的井号（`#`）使其成为权威的 DHCP 服务器。该行（约第 15 行）应如下所示：
- en: '[PRE4]'
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '* * *'
  id: totrans-39
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: '***Note:*** Make sure no other DHCP server is on the network. Most routers
    have a built-in DHCP server; disable it before starting "[Testing](testing-id7.html#testing-id7)".'
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '***注意：*** 确保网络上没有其他 DHCP 服务器。大多数路由器都内置了 DHCP 服务器；在开始 "[Testing](testing-id7.html#testing-id7)"
    之前将其禁用。'
- en: '* * *'
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: 'Scroll down to the `ddns-update-style` option and change `ad-hoc` to `none`
    to disable dynamic DNS updates. To enable dynamic DNS updates, change this to
    `interim` (you must have a local BIND DNS server with dynamic DNS updates configured
    for this to work). The line (~18) should look like this if dynamic DNS updates
    are enabled:'
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 滚动到 `ddns-update-style` 选项，将 `ad-hoc` 更改为 `none` 以禁用动态 DNS 更新。要启用动态 DNS 更新，请将其更改为
    `interim`（您必须有一个配置了动态 DNS 更新的本地 BIND DNS 服务器才能使此选项生效）。如果启用了动态 DNS 更新，该行（约第 18
    行）应如下所示：
- en: '[PRE5]'
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Scroll down to the second subnet declaration (~32). You should see the following:'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 滚动到第二个子网声明（约第 32 行）。您应该看到以下内容：
- en: '[PRE6]'
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'These lines specify the IP address subnet, netmask, range, and routers that
    will be assigned to DHCP clients. Modify these lines to fit your desired network
    setup. As an example, we will use the `subnet` `*192.168.1.0*` and `netmask` `*255.255.255.0*`.
    We''ll set the DHCP IP `range` from `*192.168.1.12*` to `*192.168.1.62*`. We will
    assume the router''s (default gateway) IP address is `*192.168.1.1*`. After modifying
    the lines above, we now have the following:'
  id: totrans-46
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这些行指定了将分配给 DHCP 客户端的 IP 地址子网、子网掩码、范围和路由器。修改这些行以适应您希望的网络设置。例如，我们将使用 `subnet`
    `*192.168.1.0*` 和 `netmask` `*255.255.255.0*`。我们将设置 DHCP IP `range` 从 `*192.168.1.12*`
    到 `*192.168.1.62*`。我们将假设路由器（默认网关）的 IP 地址是 `*192.168.1.1*`。修改上述行后，我们现在有以下内容：
- en: '[PRE7]'
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: By default, the dhcpd.conf file contains numerous lines of examples that should
    be commented out or removed. For simplicity, remove all subsequent lines following
    the subnet declaration mentioned above.
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 默认情况下，dhcpd.conf 文件包含许多示例行，应将其注释掉或删除。为了简化，请删除上述子网声明之后的所有后续行。
- en: The next two sections are optional. The first explains how to set static IP
    addresses so certain DHCP clients will always receive the same IP address; the
    second enables dynamic DNS updates. In order for the latter to work, ensure the
    BIND DNS server is configured for dynamic DNS updates. See "ISC BINDDNS Server
    9.4.2" on page 73 for details. You may skip to the appropriate section or save,
    exit, and proceed to "See [Testing](testing-id7.html#testing-id7)" if you do not
    wish to configure either of these options.
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下两个部分是可选的。第一个解释了如何设置静态IP地址，以便某些DHCP客户端始终接收相同的IP地址；第二个启用动态DNS更新。为了使后者生效，请确保BIND
    DNS服务器已配置为动态DNS更新。有关详细信息，请参阅第73页的“ISC BINDDNS Server 9.4.2”。如果您不想配置这些选项中的任何一个，可以跳到相应的部分或保存、退出并继续到“[测试](testing-id7.html#testing-id7)”。
- en: 11.7.1\. Static IP Assignments
  id: totrans-50
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 11.7.1\. 静态IP地址分配
- en: This section shows how to assign a static IP address to a DHCP client. This
    is useful for devices like network-attached printers.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 本节展示了如何将静态IP地址分配给DHCP客户端。这对于像网络连接打印机这样的设备很有用。
- en: To assign a static (or fixed) IP address assignment to a host (computer) via
    DHCP, obtain its hardware MAC address. The MAC address can be obtained a number
    of different ways. On FreeBSD and Macintosh OS X systems, use the `ifconfig` command
    (on Macintosh, launch the Terminal program and type `**ifconfig**` at the prompt).
    The MAC address of each interface will follow the `ether` statement. On a Windows
    system, use the command `ipconfig /all` at the command prompt; the MAC address
    of each respective interface will be listed following `Physical Address`.
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要通过DHCP将静态（或固定）IP地址分配给主机（计算机），请获取其硬件MAC地址。MAC地址可以通过多种方式获取。在FreeBSD和Macintosh
    OS X系统上，使用`ifconfig`命令（在Macintosh上，启动终端程序并在提示符下输入`**ifconfig**`）。每个接口的MAC地址将跟随`ether`语句。在Windows系统上，在命令提示符下使用`ipconfig
    /all`命令；每个相应接口的MAC地址将列在`Physical Address`之后。
- en: 'Add the following lines to the end of the dhcpd.conf file. Replace [desktop01.example.com](http://desktop01.example.com)
    with the target system''s hostname, its MAC address, and the IP address you wish
    to assign. The static IP declaration should appear like this:'
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将以下行添加到dhcpd.conf文件的末尾。将[desktop01.example.com](http://desktop01.example.com)替换为目标系统的主机名、其MAC地址以及您希望分配的IP地址。静态IP声明应如下所示：
- en: '[PRE8]'
  id: totrans-54
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '* * *'
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: '***Note:*** The `fixed-address` can also be an FQDN if you have an authoritative
    DNS server with an appropriate entry in the zone''s DNS lookup file. Do not assign
    IP addresses that fall within the range of IPs used for dynamically assigned IPs.
    In the sample configuration above, the declared range is from 192.168.1.12 to
    192.168.1.62; thus 192.168.1.10 would be acceptable while 192.168.1.13 would not.'
  id: totrans-56
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '***注意：*** 如果您有一个具有区域DNS查找文件中适当条目的授权DNS服务器，`fixed-address`也可以是一个FQDN。不要分配属于动态分配IP地址范围内IP地址的IP地址。在上面的示例配置中，声明的范围是从192.168.1.12到192.168.1.62；因此192.168.1.10是可以接受的，而192.168.1.13则不行。'
- en: '* * *'
  id: totrans-57
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: You may add multiple static IP address assignments using the same format as
    above. To enable dynamic DNS updates, proceed to the next section; otherwise save,
    exit, and skip to "[Testing](testing-id7.html#testing-id7)".
  id: totrans-58
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您可以使用与上面相同的格式添加多个静态IP地址分配。要启用动态DNS更新，请继续下一节；否则保存、退出并跳转到“[测试](testing-id7.html#testing-id7)”。
- en: 11.7.2\. Dynamic DNS Updates
  id: totrans-59
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 11.7.2\. 动态DNS更新
- en: This section shows how to enable dynamic DNS updates with the ISC BIND DNS server.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 本节展示了如何使用ISC BIND DNS服务器启用动态DNS更新。
- en: 'Copy the contents of the rndc.key file into the dhcpd.conf file. This will
    allow the DHCP daemon to encrypt communications with the DNS server when updates
    are necessary. The following commands will append the contents of rndc.key to
    dhcpd.conf, assuming the rndc.key file is in its default location:'
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将rndc.key文件的内容复制到dhcpd.conf文件中。这将允许DHCP守护进程在需要更新时加密与DNS服务器的通信。以下命令将rndc.key的内容追加到dhcpd.conf中，假设rndc.key文件位于其默认位置：
- en: '[PRE9]'
  id: totrans-62
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Add two zone declarations to the bottom of the dhcpd.conf file. If dhcpd.conf
    isn''t already open, type:'
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将两个区域声明添加到dhcpd.conf文件的底部。如果dhcpd.conf尚未打开，请输入：
- en: '[PRE10]'
  id: totrans-64
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Scroll down to the bottom of the dhcpd.conf file using [ctrl-U] and add the
    following lines:'
  id: totrans-65
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使用[ctrl-U]滚动到dhcpd.conf文件的底部并添加以下行：
- en: '[PRE11]'
  id: totrans-66
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Replace [example.com](http://example.com). and `*1.168.192.in-addr.arpa.*` with
    the names of your forward and reverse lookup zone files. The IP addresses above
    should point to your BIND DNS server (you may use 127.0.0.1 if your DNS server
    exists on the same computer). If you did not create a reverse lookup zone file,
    then simply omit the reverse zone declaration.
  id: totrans-67
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将[example.com](http://example.com)和`*1.168.192.in-addr.arpa.*`替换为您正向和反向查找区域文件的名称。上述IP地址应指向您的BIND
    DNS服务器（如果DNS服务器位于同一计算机上，您可以使用127.0.0.1）。如果您没有创建反向查找区域文件，则只需省略反向区域声明。
- en: Add the following line to dhcpd.conf if you set up any static IP assignments.
    This will allow DHCP to update DNS with static assignments.
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您设置了任何静态IP分配，请将以下行添加到dhcpd.conf中。这将允许DHCP更新DNS以静态分配。
- en: '[PRE12]'
  id: totrans-69
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Save and exit.
  id: totrans-70
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 保存并退出。
- en: 11.8\. TESTING
  id: totrans-71
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 11.8\. 测试
- en: In this section, we'll perform some basic tests to confirm that the DHCP server
    answers DHCP requests properly.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将执行一些基本测试以确认DHCP服务器正确响应DHCP请求。
- en: If you have an existing DHCP server on your network, disable it before proceeding.
    Most consumer NAT routers have one built in and turned on by default. The following
    command will start the DHCP server in debug mode; this allows you to see DHCP
    messages in real time.
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您的网络中已存在DHCP服务器，请在继续之前将其禁用。大多数消费级NAT路由器都内置了DHCP服务器，并且默认开启。以下命令将以调试模式启动DHCP服务器；这允许您实时查看DHCP消息。
- en: '[PRE13]'
  id: totrans-74
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Power on and connect a client system to the network and watch for a `DHCPREQUEST`
    followed by a `DHCPACK`. You should see real-time DHCP requests and acknowledgments.
    If a client system is already running, you can force a DHCP renewal by rebooting.
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 打开并连接一个客户端系统到网络，并注意查看`DHCPREQUEST`后跟`DHCPACK`。您应该看到实时的DHCP请求和确认。如果客户端系统已经运行，您可以通过重启来强制DHCP更新。
- en: Because the `DHCPREQUEST` and `DHCPACK` responses contain both assigned IPs
    and MAC addresses, you should be able to verify static IP assignments, if you
    configured any. To quit this mode, press [ctrl-C].
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 由于`DHCPREQUEST`和`DHCPACK`响应包含分配的IP地址和MAC地址，因此如果您配置了静态IP分配，您应该能够验证它们。要退出此模式，请按[ctrl-C]。
- en: 'If you enabled dynamic DNS updates, try using the `host` command to resolve
    client IP addresses with their hostnames. Assuming a computer named `*desktop01*`
    is not declared in a DNS zone file previously, you could use the following command
    to resolve its IP address:'
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您启用了动态DNS更新，请尝试使用`host`命令使用主机名解析客户端IP地址。假设名为`*desktop01*`的计算机之前未在DNS区域文件中声明，您可以使用以下命令解析其IP地址：
- en: '[PRE14]'
  id: totrans-78
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: If you get a `host not found` message, verify you have renewed that computer's
    DHCP lease by rebooting it or forcing a renewal with the operating system specific
    utility. Also, check the messages log file (located in /var/log) for errors from
    named or dhcpd when troubleshooting.
  id: totrans-79
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果您收到“找不到主机”的消息，请验证通过重启计算机或使用操作系统特定的实用程序强制续订来更新该计算机的DHCP租约。此外，在排除故障时，请检查位于/var/log的消息日志文件中named或dhcpd的错误。
- en: 'Configure the DHCP server to start automatically at boot time. To do this,
    open the rc.conf file in /etc:'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置DHCP服务器在启动时自动启动。为此，打开位于/etc的rc.conf文件：
- en: '[PRE15]'
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'and add the following line:'
  id: totrans-82
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 并添加以下行：
- en: '[PRE16]'
  id: totrans-83
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Save, exit, and start DHCP with this command:'
  id: totrans-84
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使用此命令保存、退出并启动DHCP：
- en: '[PRE17]'
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 11.9\. CONFIG FILES
  id: totrans-86
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 11.9\. 配置文件
- en: /usr/local/etc/dhcpd.conf
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/local/etc/dhcpd.conf
- en: Main configuration file for dhcpd
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: dhcpd的主配置文件
- en: 11.10\. LOG FILES
  id: totrans-89
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 11.10\. 日志文件
- en: /var/db/dhcpd.leases
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: /var/db/dhcpd.leases
- en: A database of leases dhcpd has issued
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: dhcpd已分配的租约数据库
- en: /var/log/messages
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: /var/log/messages
- en: Contains error and status messages from the dhcpd daemon
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 包含dhcpd守护进程的错误和状态消息
