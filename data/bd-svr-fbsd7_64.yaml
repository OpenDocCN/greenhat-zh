- en: Chapter 28\. SPAMASSASSIN 3.2.4
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第 28 章。SPAMASSASSIN 3.2.4
- en: '[HTTP://SPAMASSASSIN.APACHE.ORG](HTTP://SPAMASSASSIN.APACHE.ORG)'
  id: totrans-1
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[HTTP://SPAMASSASSIN.APACHE.ORG](HTTP://SPAMASSASSIN.APACHE.ORG)'
- en: 28.1\. SUMMARY
  id: totrans-2
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 28.1. 摘要
- en: SpamAssassin is a highly effective open source email classifier. It is designed
    to examine email using a diverse set of tests to determine if a message is spam.
    Messages are scored using keywords, historical data (e.g., Bayesian filtering),
    and fingerprinting methods (e.g., Vipul's Razor and DCC databases) to maximize
    effectiveness by leveraging the benefits of each type of test. SpamAssassin stores
    the results of these tests in each email's header. Mail Delivery Agents (MDA)
    like Procmail (see "[Procmail 3.22](procmail_3.22.html#procmail_3.22)") can use
    these headers to route or perform further processing of the message.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: SpamAssassin 是一个高度有效的开源电子邮件分类器。它通过使用一系列不同的测试来检查电子邮件，以确定一条消息是否为垃圾邮件。通过使用关键词、历史数据（例如，贝叶斯过滤）和指纹识别方法（例如，Vipul
    的 Razor 和 DCC 数据库）来评分消息，以最大化每种测试类型的好处。SpamAssassin 将这些测试的结果存储在每个电子邮件的标题中。邮件投递代理（MDA）如
    Procmail（参见 "[Procmail 3.22](procmail_3.22.html#procmail_3.22)"）可以使用这些标题来路由或对消息进行进一步处理。
- en: Typically, SpamAssassin is invoked as a daemon or background process. A mail
    transfer agent like Postfix is configured to pipe email through SpamAssassin for
    analysis. If a message is determined to be spam, SpamAssassin can be configured
    to modify the message in a number of ways. By default, spam is re-encoded as an
    attachment and the body of the message displays the list of tests that triggered
    the positive result. Spam and ham (legitimate email) are then delivered to users'
    mailboxes.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，SpamAssassin 以守护进程或后台进程的方式调用。邮件传输代理（如 Postfix）被配置为将电子邮件通过 SpamAssassin 进行分析。如果确定一条消息是垃圾邮件，SpamAssassin
    可以配置为以多种方式修改该消息。默认情况下，垃圾邮件被重新编码为附件，并且消息正文显示触发阳性结果的测试列表。垃圾邮件和正常邮件（合法电子邮件）随后被投递到用户的邮箱中。
- en: Many commercially available anti-spam packages incorporate SpamAssassin in their
    products. These include SpamKiller by McAfee, Kerio MailServer by Kerio, and SmarterMail
    by SmarterTools.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 许多商业可用的反垃圾邮件软件包在其产品中集成了 SpamAssassin。这些包括 McAfee 的 SpamKiller、Kerio 的 Kerio
    MailServer 和 SmarterTools 的 SmarterMail。
- en: SpamAssassin was written in 2001 by Justin Mason, an Irish software developer.
    It is based on filter.plx, a spam filter written in Perl by Mark Jeftovic in 1997\.
    Justin contributed patches to Jeftovic's filter.plx and later decided to rewrite
    the code (also in Perl) from scratch. This recode became SpamAssassin and is now
    a project of the Apache Software Foundation. Mason currently directs SpamAssassin
    development as a vice president of the Apache Software Foundation.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: SpamAssassin 由爱尔兰软件开发者 Justin Mason 在 2001 年编写。它基于 Mark Jeftovic 在 1997 年用 Perl
    编写的垃圾邮件过滤器 filter.plx。Justin 为 Jeftovic 的 filter.plx 贡献了补丁，后来决定从头开始重写代码（同样是用 Perl）。这次重写成为了
    SpamAssassin，现在它是 Apache 软件基金会的一个项目。Mason 目前作为 Apache 软件基金会的副总裁负责 SpamAssassin
    的发展。
- en: 28.2\. RESOURCES
  id: totrans-7
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 28.2. 资源
- en: Official SpamAssassin Documentation
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 官方 SpamAssassin 文档
- en: '[http://spamassassin.apache.org/doc.html](http://spamassassin.apache.org/doc.html)'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://spamassassin.apache.org/doc.html](http://spamassassin.apache.org/doc.html)'
- en: SpamAssassin Test Descriptions and Scores
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: SpamAssassin 测试描述和评分
- en: '[http://spamassassin.apache.org/tests_3_2_x.html](http://spamassassin.apache.org/tests_3_2_x.html)'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://spamassassin.apache.org/tests_3_2_x.html](http://spamassassin.apache.org/tests_3_2_x.html)'
- en: SpamAssassin Rules Emporium
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: SpamAssassin 规则集市
- en: '[http://www.rulesemporium.com](http://www.rulesemporium.com)'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://www.rulesemporium.com](http://www.rulesemporium.com)'
- en: 28.3\. REQUIRED
  id: totrans-14
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 28.3. 必需的
- en: '![](N2QyLy9jZ3QvODFzcGVtaTlnNTRmOTk1N2kzMWFyczMvZzAwcC5uVQ--.jpg) FreeBSD 7.0-RELEASE
    (see "[FreeBSD 7.0](freebsd_7.0_split_000.html#freebsd_7.0)")'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![](N2QyLy9jZ3QvODFzcGVtaTlnNTRmOTk1N2kzMWFyczMvZzAwcC5uVQ--.jpg) FreeBSD 7.0-RELEASE（参见
    "[FreeBSD 7.0](freebsd_7.0_split_000.html#freebsd_7.0)"）'
- en: '![](N2QyLy9jZ3QvODFzcGVtaTlnNTRmOTk1N2kzMWFyczMvZzAwcC5uVQ--.jpg) Updated ports
    collection (see "[FreeBSD Ports Collection](freebsd_ports_collection.html#freebsd_ports_collection)")'
  id: totrans-16
  prefs: []
  type: TYPE_IMG
  zh: '![](N2QyLy9jZ3QvODFzcGVtaTlnNTRmOTk1N2kzMWFyczMvZzAwcC5uVQ--.jpg) 更新的端口集合（参见
    "[FreeBSD 端口集合](freebsd_ports_collection.html#freebsd_ports_collection)"）'
- en: '![](N2QyLy9jZ3QvODFzcGVtaTlnNTRmOTk1N2kzMWFyczMvZzAwcC5uVQ--.jpg) Postfix SMTP
    server (see "[Postfix SMTP Server 2.5.1](postfix_smtp_server_2.5.1.html#postfix_smtp_server_2.5.1)")'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![](N2QyLy9jZ3QvODFzcGVtaTlnNTRmOTk1N2kzMWFyczMvZzAwcC5uVQ--.jpg) Postfix SMTP
    服务器（参见 "[Postfix SMTP 服务器 2.5.1](postfix_smtp_server_2.5.1.html#postfix_smtp_server_2.5.1)"）'
- en: '![](N2QyLy9jZ3QvODFzcGVtaTlnNTRmOTk1N2kzMWFyczMvZzAwcC5uVQ--.jpg) Internet
    connection'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '![](N2QyLy9jZ3QvODFzcGVtaTlnNTRmOTk1N2kzMWFyczMvZzAwcC5uVQ--.jpg) 互联网连接'
- en: 28.4\. PREPARATION
  id: totrans-19
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 28.4. 准备
- en: Become the superuser.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 成为超级用户。
- en: 28.5\. INSTALL
  id: totrans-21
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 28.5. 安装
- en: Install SpamAssassin and support for DCC tests.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 安装 SpamAssassin 和 DCC 测试支持。
- en: '* * *'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: '***Note:*** DCC (Distributed Checksum Clearinghouse) is a method of sharing
    centralized email fingerprints with a community similar to Vipul''s Razor and
    Pyzor. It is protected by a patent owned by Commtouch Software Ltd. and is free
    to use for non-commercial applications. If you agree to the terms of the license,
    you may install DCC as detailed below; if not, omit `*-D WITH_DCC*` in step 1\.
    The license agreement can be found at [http://www.rhyolite.com/anti-spam/dcc](http://www.rhyolite.com/anti-spam/dcc).'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '***注意：*** DCC（分布式校验和清除屋）是一种与Vipul''s Razor和Pyzor类似的方法，用于与一个社区共享集中式的电子邮件指纹。它由Commtouch
    Software Ltd.拥有的专利保护，并且对于非商业应用是免费的。如果你同意许可协议的条款，你可以按以下详细说明安装DCC；如果不，请省略步骤1中的`*-D
    WITH_DCC*`。许可协议可以在[http://www.rhyolite.com/anti-spam/dcc](http://www.rhyolite.com/anti-spam/dcc)找到。'
- en: '* * *'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: 'Enter the following commands to begin the installation of SpamAssassin:'
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入以下命令以开始安装SpamAssassin：
- en: '[PRE0]'
  id: totrans-27
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: A menu with options for p5-Mail-SpamAssassin should appear. Scroll down to DKIM
    and press [spacebar] to enable DomainKeys support. Continue down to SPF_QUERY
    and press [spacebar] to enable SPF query support as well. We'll leave the other
    options at their defaults. Press [tab] to select OK and then press [enter] to
    begin the build process.
  id: totrans-28
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 应该会显示一个包含p5-Mail-SpamAssassin选项的菜单。向下滚动到DKIM并按[空格键]以启用域名密钥支持。继续向下滚动到SPF_QUERY并按[空格键]以启用SPF查询支持。我们将其他选项保留在默认设置。按[Tab]键选择“确定”，然后按[Enter]键开始构建过程。
- en: 'Enter the following commands to install support for DCC tests:'
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入以下命令以安装DCC测试的支持：
- en: '[PRE1]'
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 28.6\. CONFIGURE
  id: totrans-31
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 28.6\. 配置
- en: Once the installation process completes, it is time to configure SpamAssassin
    for use on your system.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦安装过程完成，就是时候为你的系统配置SpamAssassin了。
- en: Set up two community-based email fingerprinting tests, Vipul's Razor and DCC.
    These spam identification systems vary slightly, but both rely on community input
    to keep their databases current as spam evolves. Vipul's Razor and DCC employ
    a web-of-trust scheme to give more weight to clients that accurately report spam.
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置两个基于社区的电子邮件指纹测试，Vipul's Razor和DCC。这些垃圾邮件识别系统略有不同，但两者都依赖于社区输入以保持其数据库的最新状态，因为垃圾邮件在演变。Vipul's
    Razor和DCC采用信任网络方案，以给准确报告垃圾邮件的客户更多的权重。
- en: 'To set up Vipul''s Razor reporting capabilities, create the default configuration
    file and directory structure and register an identity with the Razor Nomination
    Servers as follows (substitute your domain name for [example.com](http://example.com)):'
  id: totrans-34
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 要设置Vipul's Razor报告功能，创建默认配置文件和目录结构，并在以下Razor提名服务器上注册一个身份（用你的域名替换[example.com](http://example.com)）：
- en: '[PRE2]'
  id: totrans-35
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Create SpamAssassin''s primary configuration file, local.cf:'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建SpamAssassin的主配置文件，local.cf：
- en: '[PRE3]'
  id: totrans-37
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Add the following lines (replace the italicized items with values that match
    your network):'
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加以下行（将斜体项替换为与你的网络匹配的值）：
- en: '[PRE4]'
  id: totrans-39
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '`trusted_networks` specifies an IP or range of IPs for systems that don''t
    relay spam. In other words, you are confident that these computers aren''t compromised
    and the people using them aren''t spammers. In the example above you are vouching
    for your internal network of 192.168.1.xxx, 209.85.146.176-182 (Gmail''s outbound
    mail servers), and 204.13.250.97 (this could be the backup mail server/exchanger
    for your domain). These IPs will be exempt from DNS blacklist checks.'
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`trusted_networks`指定了不转发垃圾邮件的系统的IP或IP范围。换句话说，你确信这些计算机没有被入侵，使用它们的人不是垃圾邮件发送者。在上面的例子中，你正在为192.168.1.xxx、209.85.146.176-182（Gmail的出站邮件服务器）和204.13.250.97（这可能是你域的备份邮件服务器/交换机）的内部网络作担保。这些IP将从DNS黑名单检查中豁免。'
- en: '`internal_networks` specifies an IP or range of IPs for systems that handle
    mail for your domain. In general, you should specify your domain''s mail servers/exchangers
    here. In the example above we are saying that 192.168.1.11 and 204.13.250.97 handle
    mail delivery for our domain. All values of `internal_networks` must also be present
    in the `trusted_networks` statement.'
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`internal_networks`指定了处理你域邮件的系统的IP或IP范围。通常，你应该在这里指定你域的邮件服务器/交换机。在上面的例子中，我们说192.168.1.11和204.13.250.97处理我们域的邮件投递。`internal_networks`的所有值也必须在`trusted_networks`语句中存在。'
- en: 'Save, exit, and test for configuration file syntax errors:'
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存、退出并测试配置文件语法错误：
- en: '[PRE5]'
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: If your configuration file parsed successfully, no message will be displayed.
  id: totrans-44
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果配置文件解析成功，则不会显示任何消息。
- en: '* * *'
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: '***Note:*** For further information on the local.cf file, enter:'
  id: totrans-46
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '***注意：*** 关于local.cf文件的更多信息，请输入：'
- en: '* * *'
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: '[PRE6]'
  id: totrans-48
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Create a short script to be called by Postfix when new email arrives. This
    script will send the email to SpamAssassin for analysis and then redirect the
    result back into the mail system for delivery. Create the script:'
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个简短的脚本，当新电子邮件到达时由Postfix调用。此脚本将发送电子邮件到SpamAssassin进行分析，然后将结果重新定向回邮件系统以进行投递。创建脚本：
- en: '[PRE7]'
  id: totrans-50
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'and add these lines:'
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 并添加以下行：
- en: '[PRE8]'
  id: totrans-52
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Configure Postfix to pipe new email messages through the script you just created.
    First, open the Postfix configuration file, master.cf:'
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置Postfix通过您刚刚创建的脚本将新电子邮件消息通过管道传输。首先，打开Postfix配置文件，master.cf：
- en: '[PRE9]'
  id: totrans-54
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Scroll down and find the `smtp` declaration (~9). Create a new line under the
    `smtp` declaration and add a `content_filter` statement. The `smtp` declaration
    should look like this:'
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 滚动并找到`smtp`声明（约第9行）。在`smtp`声明下创建新行并添加`content_filter`语句。`smtp`声明应如下所示：
- en: '[PRE10]'
  id: totrans-56
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '* * *'
  id: totrans-57
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: '***Note:*** Be sure to leave at least one space at the beginning of the second
    line as shown or Postfix will not parse the file correctly.'
  id: totrans-58
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '***注意：*** 请确保第二行开头至少留有一个空格，如所示，否则Postfix将无法正确解析文件。'
- en: '* * *'
  id: totrans-59
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: 'Add a `spamd` declaration to tell Postfix to call on the spamd.sh script so
    SpamAssassin can process the message. Scroll to the bottom of master.cf and add
    these two lines:'
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加一个`spamd`声明来告诉Postfix调用spamd.sh脚本，以便SpamAssassin可以处理消息。滚动到master.cf的底部并添加以下两行：
- en: '[PRE11]'
  id: totrans-61
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '* * *'
  id: totrans-62
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: '***Note:*** Again, be sure to leave at least one space at the beginning of
    the second and third lines so Postfix will parse the file correctly.'
  id: totrans-63
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '***注意：*** 再次提醒，请确保第二行和第三行开头至少留有一个空格，以便Postfix可以正确解析文件。'
- en: '* * *'
  id: totrans-64
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: 'Save, exit, and reload the Postfix configuration files:'
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存、退出并重新加载Postfix配置文件：
- en: '[PRE12]'
  id: totrans-66
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 28.7\. TESTING
  id: totrans-67
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 28.7\. 测试
- en: In this section, we'll perform some basic tests to confirm that SpamAssassin
    is being called by Postfix and processing messages correctly.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将执行一些基本测试以确认SpamAssassin是否被Postfix调用并正确处理消息。
- en: 'Configure SpamAssassin to start automatically at system startup. Open rc.conf:'
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置SpamAssassin在系统启动时自动启动。打开rc.conf：
- en: '[PRE13]'
  id: totrans-70
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'and add the following lines:'
  id: totrans-71
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 并添加以下行：
- en: '[PRE14]'
  id: totrans-72
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Save and exit.
  id: totrans-73
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 保存并退出。
- en: 'Start the SpamAssassin daemon so it will answer requests submitted by Postfix:'
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动SpamAssassin守护进程，以便它可以响应Postfix提交的请求：
- en: '[PRE15]'
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Send a test spam message into the mail system. First, open a telnet connection:'
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向邮件系统发送测试垃圾邮件消息。首先，打开telnet连接：
- en: '[PRE16]'
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '* * *'
  id: totrans-78
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: '***Note:*** Your hostname should appear instead of [host.example.com](http://host.example.com).'
  id: totrans-79
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '***注意：*** 应该用您的主机名代替[host.example.com](http://host.example.com)。'
- en: '* * *'
  id: totrans-80
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: 'Enter the following (substituting your domain for [example.com](http://example.com)):'
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输入以下内容（将[example.com](http://example.com)替换为您的主域）：
- en: '[PRE17]'
  id: totrans-82
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Then enter the following lines as shown, pressing [enter] after each line.
  id: totrans-83
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 然后按照以下所示输入以下行，每行输入后按[enter]键。
- en: '* * *'
  id: totrans-84
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: '***Note:*** The long string below is known as the GTUBE (Generic Test for Unsolicited
    Bulk Email). It will cause SpamAssassin to flag the message as spam.'
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '***注意：*** 以下长字符串被称为GTUBE（通用未经请求的大批量电子邮件测试）。它将导致SpamAssassin将消息标记为垃圾邮件。'
- en: '* * *'
  id: totrans-86
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: '[PRE18]'
  id: totrans-87
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '* * *'
  id: totrans-88
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: '***Note:*** The italicized ID tag will be different in your output.'
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '***注意：*** 在您的输出中，斜体的ID标签将不同。'
- en: '* * *'
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: 'Finally, close the connection:'
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 最后，关闭连接：
- en: '[PRE19]'
  id: totrans-92
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'Display the contents of spamd''s mailbox:'
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 显示spamd邮箱的内容：
- en: '[PRE20]'
  id: totrans-94
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'If SpamAssassin processed the message successfully, you should see output similar
    to this:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 如果SpamAssassin成功处理了消息，您应该看到类似以下输出：
- en: 'Code View:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 代码视图：
- en: '[PRE21]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 28.8\. UTILITIES
  id: totrans-98
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 28.8\. 工具
- en: Following is brief information on the `sa-update` and `sa-learn` commands.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是`sa-update`和`sa-learn`命令的简要信息。
- en: 28.8.1\. SA-UPDATE
  id: totrans-100
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 28.8.1\. SA-UPDATE
- en: This utility downloads and installs updates and/or custom rules for SpamAssassin.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 此实用程序下载并安装SpamAssassin的更新和/或自定义规则。
- en: Command
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 命令
- en: '`sa-update`'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '`sa-update`'
- en: Syntax
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 语法
- en: '`sa-update` `*options*`'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '`sa-update` `*选项*`'
- en: Options
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 选项
- en: '[PRE22]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Retrieve rule updates from a specified channel.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 从指定的频道检索规则更新。
- en: '[PRE23]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Do not use GPG (GNU Privacy Guard) to ensure authenticity.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 不要使用GPG（GNU隐私守护）来确保真实性。
- en: Examples
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 示例
- en: 'To update SpamAssassin''s default ruleset:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 要更新SpamAssassin的默认规则集：
- en: '[PRE24]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'To install a ruleset that specializes in catching adult-oriented spam:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装一个专门用于捕获成人内容的垃圾邮件规则集：
- en: '[PRE25]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'The channel in italics is from:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 斜体字中的频道来自：
- en: List of channels
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 频道列表
- en: '[http://wiki.apache.org/spamassassin/SareChannels](http://wiki.apache.org/spamassassin/SareChannels)'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://wiki.apache.org/spamassassin/SareChannels](http://wiki.apache.org/spamassassin/SareChannels)'
- en: Channel information
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 频道信息
- en: '[http://www.rulesemporium.com/rules.htm](http://www.rulesemporium.com/rules.htm)'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://www.rulesemporium.com/rules.htm](http://www.rulesemporium.com/rules.htm)'
- en: 28.8.2\. sa-learn
  id: totrans-121
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 28.8.2\. sa-learn
- en: This utility helps the Bayesian classifier learn characteristics of spam and
    ham. Bayesian classification is based on word probabilities and can be highly
    effective if trained properly.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 此实用程序帮助贝叶斯分类器学习垃圾邮件和正常邮件的特征。贝叶斯分类基于单词概率，如果训练得当，可以非常有效。
- en: Command
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 命令
- en: '`sa-learn`'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: '`sa-learn`'
- en: Syntax
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 语法
- en: '`sa-learn` `*options*` `*file*`'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: '`sa-learn` `*options*` `*file*`'
- en: Options
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 选项
- en: '[PRE26]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Learn messages as ham (not spam).
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 将消息作为正常邮件（非垃圾邮件）学习。
- en: '[PRE27]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: Learn messages as spam.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 将消息作为垃圾邮件学习。
- en: '[PRE28]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: Specify the location of the Bayes database files.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 指定贝叶斯数据库文件的位置。
- en: '[PRE29]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Show progress using a progress bar.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 使用进度条显示进度。
- en: '[PRE30]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: Display contents of the Bayes database.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 显示贝叶斯数据库的内容。
- en: Examples
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 示例
- en: 'To teach SpamAssassin that all messages in the current directory are spam:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 要教SpamAssassin当前目录中的所有消息都是垃圾邮件：
- en: '[PRE31]'
  id: totrans-140
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'To teach SpamAssassin that all messages in the /usr/home/john/Maildir/cur directory
    are ham:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 要教SpamAssassin /usr/home/john/Maildir/cur目录中的所有消息都是正常邮件：
- en: '[PRE32]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'To show a content summary of the Bayes database:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 要显示贝叶斯数据库的内容摘要：
- en: '[PRE33]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 28.9\. CONFIG FILES
  id: totrans-145
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 28.9\. 配置文件
- en: 'Use the following files to customize SpamAssassin''s configuration:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下文件来自定义SpamAssassin的配置：
- en: /usr/local/etc/mail/spamassassin/local.cf
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/local/etc/mail/spamassassin/local.cf
- en: SpamAssassin's main configuration file
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: SpamAssassin的主配置文件
- en: /usr/local/etc/mail/spamassassin/init.pre
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/local/etc/mail/spamassassin/init.pre
- en: The plug-in configuration file for 3.0.x releases
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 3.0.x版本发布的插件配置文件
- en: /usr/local/etc/mail/spamassassin/v310.pre
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/local/etc/mail/spamassassin/v310.pre
- en: The plug-in configuration file for the 3.1.0 release
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 3.1.0版本发布的插件配置文件
- en: /usr/local/etc/mail/spamassassin/v312.pre
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/local/etc/mail/spamassassin/v312.pre
- en: The plug-in configuration file for the 3.1.2 release
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 3.1.2版本发布的插件配置文件
- en: /usr/local/etc/mail/spamassassin/v320.pre
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/local/etc/mail/spamassassin/v320.pre
- en: The plug-in configuration file for the 3.2.0 release
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 3.2.0版本发布的插件配置文件
- en: The plug-in configuration files are loaded when SpamAssassin's spamd daemon
    is loaded. Each file contains plug-ins that were specifically added at the time
    of each respective release.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 插件配置文件在SpamAssassin的spamd守护进程加载时加载。每个文件都包含在各自版本发布时特别添加的插件。
- en: 28.10\. LOG FILE
  id: totrans-158
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 28.10\. 日志文件
- en: /var/log/maillog
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: /var/log/maillog
- en: Contains a log of activity and status information for SpamAssassin's spamd daemon
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 包含SpamAssassin的spamd守护进程的活动和状态信息的日志
- en: 28.11\. NOTES
  id: totrans-161
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 28.11\. 注意事项
- en: Using a Mail Delivery Agent SpamAssassin delivers both spam and ham to users'
    default mailboxes; it cannot apply rules to spam. To set rules for handling email
    that is flagged as spam, use a tool like Procmail (see ) to process messages once
    they have been tagged by SpamAssassin.
  id: totrans-162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用邮件投递代理，SpamAssassin将垃圾邮件和正常邮件都投递到用户的默认邮箱中；它不能对垃圾邮件应用规则。要为标记为垃圾邮件的电子邮件设置规则，请使用Procmail（见）等工具处理SpamAssassin标记后的消息。
- en: Whitelisting If there are certain senders or domains that you want to effectively
    exempt from SpamAssassin's array of tests, you can add their email addresses or
    domains to the system whitelist. SpamAssassin will accept whitelist declarations
    in local.cf in /usr/local/etc/mail/spamassassin or user_prefs in /var/spool/spamd/.spamassassin.
    Keeping whitelist entries in user_prefs is preferable because it keeps them separate
    from the primary configuration settings.
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 白名单如果有一些发件人或域名你想从SpamAssassin的测试集中有效豁免，你可以将它们的电子邮件地址或域名添加到系统白名单中。SpamAssassin将接受在/usr/local/etc/mail/spamassassin的local.cf或/var/spool/spamd/.spamassassin中的user_prefs中的白名单声明。在user_prefs中保留白名单条目更可取，因为它将它们与主要配置设置分开。
- en: 'To demonstrate, we''ll add whitelist entries for [vip@example.com](mailto:vip@example.com.html)
    and anyone from [gmail.com](http://gmail.com) to the user_prefs file. Open user_prefs:'
  id: totrans-164
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 为了演示，我们将为[vip@example.com](mailto:vip@example.com.html)和来自[gmail.com](http://gmail.com)的任何人添加白名单条目到user_prefs文件中。打开user_prefs：
- en: '[PRE34]'
  id: totrans-165
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'and add the following lines:'
  id: totrans-166
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 并添加以下行：
- en: '[PRE35]'
  id: totrans-167
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE35]'
- en: The `whitelist_from` statement subtracts 100 points from the spam score on all
    email that claims to be from [vip@example.com](mailto:vip@example.com.html).
  id: totrans-168
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`whitelist_from`语句从所有声称来自[vip@example.com](mailto:vip@example.com.html)的电子邮件的垃圾邮件评分中减去100分。'
- en: The `whitelist_auth` statement subtracts 100 points from the spam score on all
    email verified by SPF, DomainKeys, or DKIM from any [gmail.com](http://gmail.com)
    email address.
  id: totrans-169
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`whitelist_auth`语句从所有由SPF、DomainKeys或DKIM验证的来自任何[gmail.com](http://gmail.com)电子邮件地址的电子邮件的垃圾邮件评分中减去100分。'
- en: If you can confirm that senders employ SPF, DomainKeys, or DKIM on their email
    systems, use `whitelist_auth` instead of `whitelist_from`.
  id: totrans-170
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果你可以确认发件人在他们的电子邮件系统中使用SPF、DomainKeys或DKIM，请使用`whitelist_auth`而不是`whitelist_from`。
- en: 'Reporting Spam to Vipul''s Razor You can report messages to a Razor Nomination
    Server with the razor-report utility. Reporting spam to the Razor system helps
    the community better recognize the ever-changing types of spam in circulation.
    If you have a folder with known spam messages you can submit them to the Razor
    servers like so (replace the italicized path with a path to your spam directory):'
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 向Vipul's Razor报告垃圾邮件 你可以使用razor-report实用工具向Razor提名服务器报告消息。向Razor系统报告垃圾邮件有助于社区更好地识别不断变化的垃圾邮件类型。如果你有一个包含已知垃圾邮件的文件夹，你可以像这样提交给Razor服务器（将斜体路径替换为你垃圾邮件目录的路径）：
- en: '[PRE36]'
  id: totrans-172
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE36]'
- en: Bayesian Classification Tests Bayesian classification tests will not run on
    incoming email until 200 spam and 200 ham messages have been recorded in the database.
    The Bayes system will automatically learn spam and ham messages over time. If
    you have an existing collection of spam and ham, use the sa-learn utility to speed
    up this process. See "[sa-learn](utilities-id10.html#sa-learn)" for examples.
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 贝叶斯分类测试 贝叶斯分类测试将在数据库中记录了200条垃圾邮件和200条正常邮件之前不会在收件箱中运行。贝叶斯系统将自动随着时间的推移学习垃圾邮件和正常邮件。如果你有一个现有的垃圾邮件和正常邮件集合，可以使用sa-learn实用工具来加速此过程。有关示例，请参阅"[sa-learn](utilities-id10.html#sa-learn)"。
