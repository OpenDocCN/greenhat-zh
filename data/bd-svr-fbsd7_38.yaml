- en: Chapter 15\. NTP SERVER 4.2.2
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第 15 章. NTP 服务器 4.2.2
- en: '[HTTP://NTP.ISC.ORG](HTTP://NTP.ISC.ORG)'
  id: totrans-1
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[HTTP://NTP.ISC.ORG](HTTP://NTP.ISC.ORG)'
- en: 15.1\. SUMMARY
  id: totrans-2
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 15.1. 摘要
- en: NTP (Network Time Protocol) is an Internet protocol used for synchronizing the
    clocks of networked computers. Computer clock accuracy is instrumental in providing
    a consistent reference for system log files, email timestamps, time-activated
    scripts, and so on. The NTP system is capable of keeping your computer's clock
    accurate to within a few milliseconds of an accurate time server. Time servers
    are usually connected directly to a source of accurate time (e.g., atomic or GPS
    clocks).
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: NTP（网络时间协议）是一种用于同步网络计算机时钟的互联网协议。计算机时钟的准确性对于提供系统日志文件、电子邮件时间戳、定时脚本等的一致参考至关重要。NTP
    系统能够将您的计算机时钟保持在与准确时间服务器相差几毫秒的准确性。时间服务器通常直接连接到准确时间源（例如，原子钟或 GPS 时钟）。
- en: The NTP system consists of a hierarchy, or strata, of public and private servers.
    A stratum 1 server synchronizes its clock with an accurate external GPS (Global
    Positioning System) clock, radio clock, or other highly accurate time-keeping
    device. A stratum 2 server derives its clock data from one or more stratum 1 servers,
    a stratum 3 server derives its clock data from one or more stratum 2 servers,
    and so on. Servers at the lower stratum levels (numerically speaking) are not
    necessarily more accurate. The accuracy of the time source, geographic location,
    and network latency all contribute to the accuracy of a time server.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: NTP 系统由公共和私有服务器组成的层次结构或层。第 1 层服务器将其时钟与准确的外部 GPS（全球定位系统）时钟、无线电时钟或其他高精度计时设备同步。第
    2 层服务器从一个或多个第 1 层服务器获取其时钟数据，第 3 层服务器从一个或多个第 2 层服务器获取其时钟数据，依此类推。较低层级的服务器（按数字排序）不一定更准确。时间源、地理位置和网络延迟都影响着时间服务器的准确性。
- en: A server running the NTP daemon periodically synchronizes its clock to one or
    more established time servers. Over time, the NTP daemon calculates the system-specific
    clock error. If the system temporarily loses Internet connectivity, the NTP daemon
    will keep the system clock accurate using this error (or clock drift) data until
    it can re-synchronize with a time server.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 运行 NTP 守护进程的服务器会定期将其时钟与一个或多个已建立的时间服务器同步。随着时间的推移，NTP 守护进程会计算系统特定的时钟误差。如果系统暂时失去互联网连接，NTP
    守护进程将使用此误差（或时钟漂移）数据保持系统时钟的准确性，直到它可以重新与时间服务器同步。
- en: David Mills, a professor at the University of Delaware, originally developed
    NTP in the early '80s. NTP was initially named the Internet Clock Service and
    was created to provide clock synchronization for the HELLO routing protocol. These
    early versions of NTP were less accurate than today's because they did not have
    any frequency correction abilities. Mills, along with a team of volunteers, continues
    to develop NTP.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 特拉华大学的教授 David Mills 在 20 世纪 80 年代初期最初开发了 NTP。NTP 最初命名为互联网时钟服务，旨在为 HELLO 路由协议提供时钟同步。这些早期的
    NTP 版本不如今天的准确，因为它们没有频率校正能力。Mills 与一支志愿者团队继续开发 NTP。
- en: 15.2\. RESOURCES
  id: totrans-7
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 15.2. 资源
- en: NTP Documentation Index
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: NTP 文档索引
- en: '[http://ntp.isc.org/bin/view/Main/DocumentationIndex](http://ntp.isc.org/bin/view/Main/DocumentationIndex)'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://ntp.isc.org/bin/view/Main/DocumentationIndex](http://ntp.isc.org/bin/view/Main/DocumentationIndex)'
- en: RFC 4330 - Network Time Protocol Version 4
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: RFC 4330 - 网络时间协议版本 4
- en: '[http://tools.ietf.org/html/rfc4330](http://tools.ietf.org/html/rfc4330)'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://tools.ietf.org/html/rfc4330](http://tools.ietf.org/html/rfc4330)'
- en: 15.3\. REQUIRED
  id: totrans-12
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 15.3. 需要的
- en: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) FreeBSD 7.0-RELEASE
    (see "[FreeBSD 7.0](freebsd_7.0_split_000.html#freebsd_7.0)")'
  id: totrans-13
  prefs: []
  type: TYPE_IMG
  zh: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) FreeBSD 7.0-RELEASE
    (参见 "[FreeBSD 7.0](freebsd_7.0_split_000.html#freebsd_7.0)")'
- en: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) Updated ports
    collection (see "[FreeBSD Ports Collection](freebsd_ports_collection.html#freebsd_ports_collection)")'
  id: totrans-14
  prefs: []
  type: TYPE_IMG
  zh: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) 更新的端口集合（参见
    "[FreeBSD 端口集合](freebsd_ports_collection.html#freebsd_ports_collection)")'
- en: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) Internet
    connection'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) 互联网连接'
- en: 15.4\. OPTIONAL
  id: totrans-16
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 15.4. 可选
- en: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) Registered
    domain name'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: '![](OWlnMmQvN2ZtYXI4dGMvaWVnL3MxOTU5MzE0NTdwc3BuVTAvLjNnMA--.jpg) 注册域名'
- en: 15.5\. PREPARATION
  id: totrans-18
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 15.5. 准备工作
- en: Become the superuser.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 成为超级用户。
- en: 15.6\. INSTALL
  id: totrans-20
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 15.6. 安装
- en: 'Although NTP 4.2.0 is included in the standard FreeBSD 7.0 distribution, we
    will install an updated version of NTP from the ports collection. Enter the following
    commands to begin the installation:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然NTP 4.2.0包含在FreeBSD 7.0标准发行版中，但我们将从ports集合中安装NTP的更新版本。输入以下命令开始安装：
- en: '[PRE0]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 15.7\. CONFIGURE
  id: totrans-23
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 15.7\. 配置
- en: Once the installation process is complete, it's time to configure NTP for use
    on your system.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦安装过程完成，就是时候为你的系统配置NTP了。
- en: Change the default search path. FreeBSD's base version of NTP uses the same
    filenames as the version we installed from the ports system. If the search path
    has not been changed from its default, NTP-related commands will run the FreeBSD
    base version rather than the new version from ports. See "[Default Search Path](configure.html#default_search_path)"
    for details on changing the default search path.
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更改默认的搜索路径。FreeBSD的NTP基本版本使用与从ports系统安装的版本相同的文件名。如果搜索路径未从默认值更改，则NTP相关命令将运行FreeBSD基本版本，而不是ports的新版本。有关更改默认搜索路径的详细信息，请参阅"[默认搜索路径](configure.html#default_search_path)"。
- en: 'Create a drift file for storing clock correction data. The following command
    creates this file in the /etc/ntp directory:'
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个用于存储时钟校正数据的漂移文件。以下命令在/etc/ntp目录中创建此文件：
- en: '[PRE1]'
  id: totrans-27
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Select appropriate time servers for synchronization. Visit [http://ntp.isc.org/bin/view/Servers/StratumTwoTimeServers](http://ntp.isc.org/bin/view/Servers/StratumTwoTimeServers)
    for an updated list of public time servers. Select at least three servers from
    the list. Pick servers that are listed as OpenAccess and located in your geographic
    vicinity.
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择合适的同步时间服务器。访问[http://ntp.isc.org/bin/view/Servers/StratumTwoTimeServers](http://ntp.isc.org/bin/view/Servers/StratumTwoTimeServers)获取公共时间服务器的最新列表。从列表中选择至少三个服务器。选择标记为OpenAccess且位于你地理邻近的服务器。
- en: '* * *'
  id: totrans-29
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: '***Note:*** See NTP''s web page on Rules of Engagement for recommendations
    on selecting time servers: [http://support.ntp.org/bin/view/Servers/RulesOfEngagement](http://support.ntp.org/bin/view/Servers/RulesOfEngagement).'
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '***注意：*** 请参阅NTP的参与规则网页，以获取选择时间服务器的建议：[http://support.ntp.org/bin/view/Servers/RulesOfEngagement](http://support.ntp.org/bin/view/Servers/RulesOfEngagement)。'
- en: '* * *'
  id: totrans-31
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: 'Create a new configuration file named ntp.conf:'
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为ntp.conf的新配置文件：
- en: '[PRE2]'
  id: totrans-33
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'and add the following configuration options:'
  id: totrans-34
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 并添加以下配置选项：
- en: '[PRE3]'
  id: totrans-35
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Replace the hostnames of the servers (in italics) with those you have picked.
    The `iburst` modifier allows the NTP daemon to speed up initial synchronization.
    The `driftfile` statement tells the NTP daemon where to look for the drift file
    (created in step 2). The `logfile` statement directs the NTP daemon to store the
    log file in the /var/log directory. Save and exit.
  id: totrans-36
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将服务器的域名（斜体）替换为你所选择的域名。`iburst`修饰符允许NTP守护进程加快初始同步速度。`driftfile`语句告诉NTP守护进程在哪里查找漂移文件（在步骤2中创建）。`logfile`语句指示NTP守护进程将日志文件存储在/var/log目录中。保存并退出。
- en: 15.8\. TESTING
  id: totrans-37
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 15.8\. 测试
- en: In this section, we'll perform some basic tests to confirm that NTP synchronizes
    time data properly.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将执行一些基本测试以确认NTP正确同步时间数据。
- en: 'To start the NTP daemon automatically at boot time, open /etc/rc.conf:'
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要在启动时自动启动NTP守护进程，打开/etc/rc.conf：
- en: '[PRE4]'
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'and add the following lines:'
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 并添加以下行：
- en: '[PRE5]'
  id: totrans-42
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Start the NTP daemon and begin system time synchronization:'
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动NTP守护进程并开始系统时间同步：
- en: '[PRE6]'
  id: totrans-44
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Wait about 10 minutes, and then execute the following command to check the
    status of the time synchronization:'
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 等待大约10分钟，然后执行以下命令以检查时间同步的状态：
- en: '[PRE7]'
  id: totrans-46
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'You should see results similar to the following:'
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你应该看到类似以下的结果：
- en: '[PRE8]'
  id: totrans-48
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '* * *'
  id: totrans-49
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: '***Note:*** The last line in the above output is an example of a peer that
    is not reachable or is not working properly. The `*jitter*` value will usually
    be 4000.00 and `*stratum*` will be 16, with zeros for `*delay*` and `*offset*`.'
  id: totrans-50
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '***注意：*** 上面的输出中的最后一行是一个不可达或工作不正常的对等体的示例。`*jitter*`值通常为4000.00，`*stratum*`为16，`*delay*`和`*offset*`为零。'
- en: '* * *'
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '* * *'
- en: 'The elements of the above output are described below:'
  id: totrans-52
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 上述输出中的元素如下所述：
- en: '[PRE9]'
  id: totrans-53
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: The hostname of the peer (time server). The hostname preceded by an asterisk
    indicates the server selected for synchronization.
  id: totrans-54
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 对等体（时间服务器）的主机名。以星号开头的主机名表示所选的同步服务器。
- en: '[PRE10]'
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: The type of time-keeping device in use by the corresponding peer. Since the
    time servers above are stratum 2 servers, they list the IP addresses of the servers
    supplying their time.
  id: totrans-56
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 对应对等体使用的时钟维护设备类型。由于上述时间服务器是2层服务器，它们列出了提供时间的服务器IP地址。
- en: '[PRE11]'
  id: totrans-57
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: The stratum of the peer, ranging from 1 to 16.
  id: totrans-58
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 对等体的层级，范围从1到16。
- en: '[PRE12]'
  id: totrans-59
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: The type of peer (`u` = unicast, `m` = multicast).
  id: totrans-60
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 对等方的类型（`u` = 单播，`m` = 多播）。
- en: '[PRE13]'
  id: totrans-61
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: How long ago the peer was heard from in seconds.
  id: totrans-62
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 对等方上次被听到的时间，以秒为单位。
- en: '[PRE14]'
  id: totrans-63
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: The frequency, in seconds, with which the NTP daemon is synchronizing with the
    peer.
  id: totrans-64
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: NTP守护进程与对等方同步的频率，以秒为单位。
- en: '[PRE15]'
  id: totrans-65
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: The status, in octal format, of the reachability register. This value will stabilize
    at 377 if the last 8 attempts to synchronize with each time server were successful
    (it takes about 10 minutes to reach this value).
  id: totrans-66
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 可达性寄存器的状态，以八进制格式表示。如果最后8次尝试与每个时间服务器同步都成功（达到此值需要大约10分钟），则此值将稳定在377。
- en: '[PRE16]'
  id: totrans-67
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: The roundtrip packet delay time in milliseconds (smaller is better).
  id: totrans-68
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 往返包延迟时间，以毫秒为单位（越小越好）。
- en: '[PRE17]'
  id: totrans-69
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: The difference, in milliseconds, between the system time and the remote peer's
    time. A negative value here indicates that the clock of the local system is behind
    that of the remote peer's, while a positive value indicates milliseconds ahead.
  id: totrans-70
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 系统时间与远程对等方时间的差异，以毫秒为单位。负值表示本地系统的时钟落后于远程对等方的时钟，而正值表示领先。
- en: '[PRE18]'
  id: totrans-71
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: The variation, in milliseconds, of the offset (smaller is better).
  id: totrans-72
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 偏移量的变化，以毫秒为单位（越小越好）。
- en: 'Check to make sure your time server is answering NTP requests properly with
    this command:'
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用此命令检查以确保您的时服务器正确响应NTP请求：
- en: 'Code View:'
  id: totrans-74
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 代码视图：
- en: '[PRE19]'
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: If you are synchronizing with stratum 2 servers your server will indicate stratum
    3 as shown.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您正在与第二层服务器同步，您的服务器将显示为第三层，如下所示。
- en: 15.9\. CONFIG FILES
  id: totrans-77
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 15.9. 配置文件
- en: /etc/ntp.conf
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: /etc/ntp.conf
- en: The main configuration file for ntpd
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: ntpd的主要配置文件
- en: 15.10\. LOG FILES
  id: totrans-80
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 15.10. 日志文件
- en: /var/log/ntp.log
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: /var/log/ntp.log
- en: The NTP daemon records time synchronization messages to this file.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: NTP守护进程将时间同步消息记录到该文件。
- en: /var/log/messages
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: /var/log/messages
- en: The NTP daemon records its status in this file.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: NTP守护进程将其状态记录到该文件。
- en: /etc/ntp/drift
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: /etc/ntp/drift
- en: The NTP daemon stores clock correction values to this file.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: NTP守护进程将时钟校正值存储到该文件。
- en: 15.11\. NOTES
  id: totrans-87
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 15.11. 备注
- en: The drift file specified in step 2 of "Configure" (page 108) is automatically
    updated once per hour with the frequency offset (clock error) computed by the
    NTP daemon. It is important that the empty file be created as outlined in step
    2; the NTP daemon will not automatically create the file. If the drift file does
    not exist, the NTP daemon will assume an error of zero and will take about 15
    minutes to complete initial synchronization and enter a stabilized state or normal
    mode.
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “配置”步骤2中指定的漂移文件（第108页）将每小时自动更新一次，更新频率偏移（时钟误差）由NTP守护进程计算。重要的是要按照步骤2中的说明创建空文件；NTP守护进程不会自动创建该文件。如果漂移文件不存在，NTP守护进程将假设误差为零，并需要大约15分钟来完成初始同步并进入稳定状态或正常模式。
- en: 'If you want to synchronize the clock of your server and deny all client requests
    to the NTP server, add the following lines to ntp.conf in /etc:'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果您想同步服务器的时钟并拒绝所有客户端对NTP服务器的请求，请将以下行添加到 /etc 中的 ntp.conf：
- en: '[PRE20]'
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '* * *'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: '***Note:*** Replace the hostnames in italics with the hostnames of the time
    servers you configured in step 4 of "Configure." You cannot use NTP pool servers
    here because pool servers assign NTP server addresses dynamically.'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '***注意：*** 将斜体中的主机名替换为“配置”步骤4中配置的时间服务器的主机名。在这里不能使用NTP池服务器，因为池服务器会动态分配NTP服务器地址。'
- en: '* * *'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: 'If you wish to allow NTP services to the local network only, add this line
    to the ntp.conf file in /etc:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您希望仅允许本地网络使用NTP服务，请将以下行添加到位于 /etc 的 ntp.conf 文件中：
- en: '[PRE21]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '* * *'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: '***Note:*** This line is an addition to the four restrict statements above.'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: '***注意：*** 这一行是上述四个限制语句的补充。'
- en: '* * *'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: Change the IP address and subnet (in italics) to match your network configuration.
    The example above would allow systems with an IP address of 192.168.1.X to synchronize
    with your NTP server.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 将IP地址和子网（斜体）更改为与您的网络配置匹配。上面的示例将允许IP地址为192.168.1.X的系统与您的NTP服务器同步。
